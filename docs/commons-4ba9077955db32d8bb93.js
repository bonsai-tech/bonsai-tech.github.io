/*! For license information please see commons-4ba9077955db32d8bb93.js.LICENSE.txt */
(self.webpackChunkbonsai_web=self.webpackChunkbonsai_web||[]).push([[351],{2048:function(e,t,i){"use strict";i(7294);t.Z="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTM3IiBoZWlnaHQ9IjMyIiB2aWV3Qm94PSIwIDAgMTM3IDMyIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8cGF0aCBkPSJNMTIuMDI4IDMxLjQyQzEwLjY1NiAzMS40MiA5LjM5NiAzMS4xNCA4LjI0OCAzMC41OEM3LjEgMjkuOTkyIDYuMTYyIDI5LjIyMiA1LjQzNCAyOC4yN0M0LjcwNiAyNy4yOSA0LjI4NiAyNi4xOTggNC4xNzQgMjQuOTk0VjE2LjM4NEM0LjI4NiAxNS4xOCA0LjcwNiAxNC4xMTYgNS40MzQgMTMuMTkyQzYuMTYyIDEyLjI0IDcuMSAxMS40OTggOC4yNDggMTAuOTY2QzkuMzk2IDEwLjQzNCAxMC42NTYgMTAuMTY4IDEyLjAyOCAxMC4xNjhDMTMuOTYgMTAuMTY4IDE1LjY2OCAxMC42MyAxNy4xNTIgMTEuNTU0QzE4LjY2NCAxMi40NzggMTkuODQgMTMuNzM4IDIwLjY4IDE1LjMzNEMyMS41NDggMTYuOTMgMjEuOTgyIDE4Ljc1IDIxLjk4MiAyMC43OTRDMjEuOTgyIDIyLjgzOCAyMS41NDggMjQuNjU4IDIwLjY4IDI2LjI1NEMxOS44NCAyNy44NSAxOC42NjQgMjkuMTEgMTcuMTUyIDMwLjAzNEMxNS42NjggMzAuOTU4IDEzLjk2IDMxLjQyIDEyLjAyOCAzMS40MlpNMTAuODk0IDI1LjYyNEMxMS43OSAyNS42MjQgMTIuNTc0IDI1LjQxNCAxMy4yNDYgMjQuOTk0QzEzLjk0NiAyNC41NzQgMTQuNDkyIDI0IDE0Ljg4NCAyMy4yNzJDMTUuMjc2IDIyLjU0NCAxNS40NzIgMjEuNzE4IDE1LjQ3MiAyMC43OTRDMTUuNDcyIDE5Ljg0MiAxNS4yNzYgMTkuMDAyIDE0Ljg4NCAxOC4yNzRDMTQuNDkyIDE3LjU0NiAxMy45NDYgMTYuOTg2IDEzLjI0NiAxNi41OTRDMTIuNTc0IDE2LjE3NCAxMS43OSAxNS45NjQgMTAuODk0IDE1Ljk2NEM5Ljk5OCAxNS45NjQgOS4yIDE2LjE3NCA4LjUgMTYuNTk0QzcuOCAxNi45ODYgNy4yNTQgMTcuNTQ2IDYuODYyIDE4LjI3NEM2LjQ5OCAxOS4wMDIgNi4zMTYgMTkuODQyIDYuMzE2IDIwLjc5NEM2LjMxNiAyMS43NDYgNi41MTIgMjIuNTg2IDYuOTA0IDIzLjMxNEM3LjI5NiAyNC4wNDIgNy44MjggMjQuNjE2IDguNSAyNS4wMzZDOS4yIDI1LjQyOCA5Ljk5OCAyNS42MjQgMTAuODk0IDI1LjYyNFpNMC4yNjggMzFWMC41MDhINi42OTRWMTUuNTg2TDUuNjQ0IDIwLjU0Mkw2LjYxIDI1LjQ5OFYzMUgwLjI2OFpNMzUuMDc0NSAzMS40NjJDMzIuOTc0NSAzMS40NjIgMzEuMDcwNSAzMSAyOS4zNjI1IDMwLjA3NkMyNy42ODI1IDI5LjEyNCAyNi4zNTI1IDI3LjgzNiAyNS4zNzI1IDI2LjIxMkMyNC4zOTI1IDI0LjU4OCAyMy45MDI1IDIyLjc2OCAyMy45MDI1IDIwLjc1MkMyMy45MDI1IDE4LjczNiAyNC4zOTI1IDE2LjkzIDI1LjM3MjUgMTUuMzM0QzI2LjM1MjUgMTMuNzM4IDI3LjY4MjUgMTIuNDc4IDI5LjM2MjUgMTEuNTU0QzMxLjA0MjUgMTAuNjAyIDMyLjk0NjUgMTAuMTI2IDM1LjA3NDUgMTAuMTI2QzM3LjIwMjUgMTAuMTI2IDM5LjEwNjUgMTAuNTg4IDQwLjc4NjUgMTEuNTEyQzQyLjQ2NjUgMTIuNDM2IDQzLjc5NjUgMTMuNzEgNDQuNzc2NSAxNS4zMzRDNDUuNzU2NSAxNi45MyA0Ni4yNDY1IDE4LjczNiA0Ni4yNDY1IDIwLjc1MkM0Ni4yNDY1IDIyLjc2OCA0NS43NTY1IDI0LjU4OCA0NC43NzY1IDI2LjIxMkM0My43OTY1IDI3LjgzNiA0Mi40NjY1IDI5LjEyNCA0MC43ODY1IDMwLjA3NkMzOS4xMDY1IDMxIDM3LjIwMjUgMzEuNDYyIDM1LjA3NDUgMzEuNDYyWk0zNS4wNzQ1IDI1LjYyNEMzNS45OTg1IDI1LjYyNCAzNi44MTA1IDI1LjQyOCAzNy41MTA1IDI1LjAzNkMzOC4yMTA1IDI0LjYxNiAzOC43NDI1IDI0LjA0MiAzOS4xMDY1IDIzLjMxNEMzOS40OTg1IDIyLjU1OCAzOS42OTQ1IDIxLjcwNCAzOS42OTQ1IDIwLjc1MkMzOS42OTQ1IDE5LjggMzkuNDk4NSAxOC45NzQgMzkuMTA2NSAxOC4yNzRDMzguNzE0NSAxNy41NDYgMzguMTY4NSAxNi45ODYgMzcuNDY4NSAxNi41OTRDMzYuNzk2NSAxNi4xNzQgMzUuOTk4NSAxNS45NjQgMzUuMDc0NSAxNS45NjRDMzQuMTc4NSAxNS45NjQgMzMuMzgwNSAxNi4xNzQgMzIuNjgwNSAxNi41OTRDMzEuOTgwNSAxNi45ODYgMzEuNDM0NSAxNy41NDYgMzEuMDQyNSAxOC4yNzRDMzAuNjUwNSAxOS4wMDIgMzAuNDU0NSAxOS44NDIgMzAuNDU0NSAyMC43OTRDMzAuNDU0NSAyMS43MTggMzAuNjUwNSAyMi41NTggMzEuMDQyNSAyMy4zMTRDMzEuNDM0NSAyNC4wNDIgMzEuOTgwNSAyNC42MTYgMzIuNjgwNSAyNS4wMzZDMzMuMzgwNSAyNS40MjggMzQuMTc4NSAyNS42MjQgMzUuMDc0NSAyNS42MjRaTTYyLjkyNzcgMzFWMTkuMzY2QzYyLjkyNzcgMTguMzAyIDYyLjU5MTcgMTcuNDQ4IDYxLjkxOTcgMTYuODA0QzYxLjI3NTcgMTYuMTMyIDYwLjQ0OTcgMTUuNzk2IDU5LjQ0MTcgMTUuNzk2QzU4Ljc0MTcgMTUuNzk2IDU4LjEyNTcgMTUuOTUgNTcuNTkzNyAxNi4yNThDNTcuMDYxNyAxNi41MzggNTYuNjQxNyAxNi45NTggNTYuMzMzNyAxNy41MThDNTYuMDI1NyAxOC4wNSA1NS44NzE3IDE4LjY2NiA1NS44NzE3IDE5LjM2Nkw1My4zOTM3IDE4LjE0OEM1My4zOTM3IDE2LjU1MiA1My43NDM3IDE1LjE1MiA1NC40NDM3IDEzLjk0OEM1NS4xNDM3IDEyLjc0NCA1Ni4xMDk3IDExLjgyIDU3LjM0MTcgMTEuMTc2QzU4LjYwMTcgMTAuNTA0IDYwLjAxNTcgMTAuMTY4IDYxLjU4MzcgMTAuMTY4QzYzLjA5NTcgMTAuMTY4IDY0LjQyNTcgMTAuNTMyIDY1LjU3MzcgMTEuMjZDNjYuNzQ5NyAxMS45NiA2Ny42NzM3IDEyLjg5OCA2OC4zNDU3IDE0LjA3NEM2OS4wMTc3IDE1LjI1IDY5LjM1MzcgMTYuNTM4IDY5LjM1MzcgMTcuOTM4VjMxSDYyLjkyNzdaTTQ5LjQ0NTcgMzFWMTAuNTg4SDU1Ljg3MTdWMzFINDkuNDQ1N1pNODAuOTE0OSAzMS41MDRDNzkuNzEwOSAzMS41MDQgNzguNTIwOSAzMS4zNSA3Ny4zNDQ5IDMxLjA0MkM3Ni4xOTY5IDMwLjczNCA3NS4xMTg5IDMwLjMgNzQuMTEwOSAyOS43NEM3My4xMzA5IDI5LjE1MiA3Mi4yOTA5IDI4LjQ4IDcxLjU5MDkgMjcuNzI0TDc1LjI0NDkgMjQuMDI4Qzc1LjkxNjkgMjQuNzU2IDc2LjcxNDkgMjUuMzMgNzcuNjM4OSAyNS43NUM3OC41NjI5IDI2LjE0MiA3OS41NzA5IDI2LjMzOCA4MC42NjI5IDI2LjMzOEM4MS40MTg5IDI2LjMzOCA4MS45OTI5IDI2LjIyNiA4Mi4zODQ5IDI2LjAwMkM4Mi44MDQ5IDI1Ljc3OCA4My4wMTQ5IDI1LjQ3IDgzLjAxNDkgMjUuMDc4QzgzLjAxNDkgMjQuNTc0IDgyLjc2MjkgMjQuMTk2IDgyLjI1ODkgMjMuOTQ0QzgxLjc4MjkgMjMuNjY0IDgxLjE2NjkgMjMuNDI2IDgwLjQxMDkgMjMuMjNDNzkuNjU0OSAyMy4wMDYgNzguODU2OSAyMi43NjggNzguMDE2OSAyMi41MTZDNzcuMTc2OSAyMi4yNjQgNzYuMzc4OSAyMS45MTQgNzUuNjIyOSAyMS40NjZDNzQuODY2OSAyMS4wMTggNzQuMjUwOSAyMC40MDIgNzMuNzc0OSAxOS42MThDNzMuMjk4OSAxOC44MDYgNzMuMDYwOSAxNy43ODQgNzMuMDYwOSAxNi41NTJDNzMuMDYwOSAxNS4yMzYgNzMuMzk2OSAxNC4xMDIgNzQuMDY4OSAxMy4xNUM3NC43NDA5IDEyLjE3IDc1LjY5MjkgMTEuNCA3Ni45MjQ5IDEwLjg0Qzc4LjE1NjkgMTAuMjggNzkuNTk4OSAxMCA4MS4yNTA5IDEwQzgyLjk4NjkgMTAgODQuNTgyOSAxMC4zMDggODYuMDM4OSAxMC45MjRDODcuNTIyOSAxMS41MTIgODguNzI2OSAxMi4zOTQgODkuNjUwOSAxMy41N0w4NS45OTY5IDE3LjI2NkM4NS4zNTI5IDE2LjUxIDg0LjYyNDkgMTUuOTc4IDgzLjgxMjkgMTUuNjdDODMuMDI4OSAxNS4zNjIgODIuMjU4OSAxNS4yMDggODEuNTAyOSAxNS4yMDhDODAuNzc0OSAxNS4yMDggODAuMjI4OSAxNS4zMiA3OS44NjQ5IDE1LjU0NEM3OS41MDA5IDE1Ljc0IDc5LjMxODkgMTYuMDM0IDc5LjMxODkgMTYuNDI2Qzc5LjMxODkgMTYuODQ2IDc5LjU1NjkgMTcuMTgyIDgwLjAzMjkgMTcuNDM0QzgwLjUwODkgMTcuNjg2IDgxLjEyNDkgMTcuOTEgODEuODgwOSAxOC4xMDZDODIuNjM2OSAxOC4zMDIgODMuNDM0OSAxOC41NCA4NC4yNzQ5IDE4LjgyQzg1LjExNDkgMTkuMSA4NS45MTI5IDE5LjQ3OCA4Ni42Njg5IDE5Ljk1NEM4Ny40MjQ5IDIwLjQzIDg4LjA0MDkgMjEuMDc0IDg4LjUxNjkgMjEuODg2Qzg4Ljk5MjkgMjIuNjcgODkuMjMwOSAyMy43MDYgODkuMjMwOSAyNC45OTRDODkuMjMwOSAyNi45ODIgODguNDc0OSAyOC41NjQgODYuOTYyOSAyOS43NEM4NS40Nzg5IDMwLjkxNiA4My40NjI5IDMxLjUwNCA4MC45MTQ5IDMxLjUwNFpNMTAxLjI0MyAzMS40MkM5OS4zNjcyIDMxLjQyIDk3LjY4NzIgMzAuOTU4IDk2LjIwMzIgMzAuMDM0Qzk0Ljc0NzIgMjkuMTEgOTMuNTg1MiAyNy44NSA5Mi43MTcyIDI2LjI1NEM5MS44NzcyIDI0LjY1OCA5MS40NTcyIDIyLjgzOCA5MS40NTcyIDIwLjc5NEM5MS40NTcyIDE4Ljc1IDkxLjg3NzIgMTYuOTMgOTIuNzE3MiAxNS4zMzRDOTMuNTg1MiAxMy43MzggOTQuNzQ3MiAxMi40NzggOTYuMjAzMiAxMS41NTRDOTcuNjg3MiAxMC42MyA5OS4zNjcyIDEwLjE2OCAxMDEuMjQzIDEwLjE2OEMxMDIuNjE1IDEwLjE2OCAxMDMuODQ3IDEwLjQzNCAxMDQuOTM5IDEwLjk2NkMxMDYuMDU5IDExLjQ5OCAxMDYuOTY5IDEyLjI0IDEwNy42NjkgMTMuMTkyQzEwOC4zNjkgMTQuMTE2IDEwOC43NjEgMTUuMTggMTA4Ljg0NSAxNi4zODRWMjUuMjA0QzEwOC43NjEgMjYuNDA4IDEwOC4zNjkgMjcuNDg2IDEwNy42NjkgMjguNDM4QzEwNi45OTcgMjkuMzYyIDEwNi4xMDEgMzAuMDkgMTA0Ljk4MSAzMC42MjJDMTAzLjg2MSAzMS4xNTQgMTAyLjYxNSAzMS40MiAxMDEuMjQzIDMxLjQyWk0xMDIuNTQ1IDI1LjYyNEMxMDMuOTE3IDI1LjYyNCAxMDUuMDIzIDI1LjE3NiAxMDUuODYzIDI0LjI4QzEwNi43MDMgMjMuMzU2IDEwNy4xMjMgMjIuMTk0IDEwNy4xMjMgMjAuNzk0QzEwNy4xMjMgMTkuODQyIDEwNi45MjcgMTkuMDAyIDEwNi41MzUgMTguMjc0QzEwNi4xNzEgMTcuNTQ2IDEwNS42MzkgMTYuOTg2IDEwNC45MzkgMTYuNTk0QzEwNC4yNjcgMTYuMTc0IDEwMy40ODMgMTUuOTY0IDEwMi41ODcgMTUuOTY0QzEwMS42OTEgMTUuOTY0IDEwMC44OTMgMTYuMTc0IDEwMC4xOTMgMTYuNTk0Qzk5LjUyMTIgMTYuOTg2IDk4Ljk3NTIgMTcuNTQ2IDk4LjU1NTIgMTguMjc0Qzk4LjE2MzIgMTkuMDAyIDk3Ljk2NzIgMTkuODQyIDk3Ljk2NzIgMjAuNzk0Qzk3Ljk2NzIgMjEuNzE4IDk4LjE2MzIgMjIuNTQ0IDk4LjU1NTIgMjMuMjcyQzk4Ljk0NzIgMjQgOTkuNDkzMiAyNC41NzQgMTAwLjE5MyAyNC45OTRDMTAwLjg5MyAyNS40MTQgMTAxLjY3NyAyNS42MjQgMTAyLjU0NSAyNS42MjRaTTEwNi44NzEgMzFWMjUuNDk4TDEwNy44MzcgMjAuNTQyTDEwNi44NzEgMTUuNTg2VjEwLjU4OEgxMTMuMTcxVjMxSDEwNi44NzFaTTExNy42OTYgMzFWMTAuNTg4SDEyNC4xMjJWMzFIMTE3LjY5NlpNMTIwLjkzIDcuNzc0QzExOS45MjIgNy43NzQgMTE5LjA4MiA3LjQzOCAxMTguNDEgNi43NjZDMTE3Ljc2NiA2LjA2NiAxMTcuNDQ0IDUuMjI2IDExNy40NDQgNC4yNDZDMTE3LjQ0NCAzLjIzOCAxMTcuNzY2IDIuMzk4IDExOC40MSAxLjcyNkMxMTkuMDgyIDEuMDU0IDExOS45MjIgMC43MTc5OTkgMTIwLjkzIDAuNzE3OTk5QzEyMS45MzggMC43MTc5OTkgMTIyLjc2NCAxLjA1NCAxMjMuNDA4IDEuNzI2QzEyNC4wNTIgMi4zOTggMTI0LjM3NCAzLjIzOCAxMjQuMzc0IDQuMjQ2QzEyNC4zNzQgNS4yMjYgMTI0LjA1MiA2LjA2NiAxMjMuNDA4IDYuNzY2QzEyMi43NjQgNy40MzggMTIxLjkzOCA3Ljc3NCAxMjAuOTMgNy43NzRaTTEzMi42NzkgMzEuNDYyQzEzMS41ODcgMzEuNDYyIDEzMC42NzcgMzEuMDg0IDEyOS45NDkgMzAuMzI4QzEyOS4yMjEgMjkuNTcyIDEyOC44NTcgMjguNjYyIDEyOC44NTcgMjcuNTk4QzEyOC44NTcgMjYuNDc4IDEyOS4yMjEgMjUuNTU0IDEyOS45NDkgMjQuODI2QzEzMC42NzcgMjQuMDcgMTMxLjU4NyAyMy42OTIgMTMyLjY3OSAyMy42OTJDMTMzLjc5OSAyMy42OTIgMTM0LjcwOSAyNC4wNyAxMzUuNDA5IDI0LjgyNkMxMzYuMTM3IDI1LjU1NCAxMzYuNTAxIDI2LjQ3OCAxMzYuNTAxIDI3LjU5OEMxMzYuNTAxIDI4LjY2MiAxMzYuMTM3IDI5LjU3MiAxMzUuNDA5IDMwLjMyOEMxMzQuNzA5IDMxLjA4NCAxMzMuNzk5IDMxLjQ2MiAxMzIuNjc5IDMxLjQ2MloiIGZpbGw9IiMxNDFFMzAiLz4KPC9zdmc+Cg=="},2845:function(e,t,i){"use strict";i.d(t,{l:function(){return n},o:function(){return r}});var s=i(7818);class n{constructor(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],l=arguments.length>7?arguments[7]:void 0;this._isAlreadyOwned=!1,e.getScene?this._engine=e.getScene().getEngine():this._engine=e,this._updatable=i,this._instanced=a,this._divisor=l||1,t instanceof s.h?(this._data=null,this._buffer=t):(this._data=t,this._buffer=null),this.byteStride=o?n:n*Float32Array.BYTES_PER_ELEMENT,r||this.create()}createVertexBuffer(e,t,i,s,n){let a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=arguments.length>6?arguments[6]:void 0;const l=a?t:t*Float32Array.BYTES_PER_ELEMENT,h=s?a?s:s*Float32Array.BYTES_PER_ELEMENT:this.byteStride;return new r(this._engine,this,e,this._updatable,!0,h,void 0===n?this._instanced:n,l,i,void 0,void 0,!0,this._divisor||o)}isUpdatable(){return this._updatable}getData(){return this._data}getBuffer(){return this._buffer}getStrideSize(){return this.byteStride/Float32Array.BYTES_PER_ELEMENT}create(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;!e&&this._buffer||(e=e||this._data,e&&(this._buffer?this._updatable&&(this._engine.updateDynamicVertexBuffer(this._buffer,e),this._data=e):this._updatable?(this._buffer=this._engine.createDynamicVertexBuffer(e),this._data=e):this._buffer=this._engine.createVertexBuffer(e)))}_rebuild(){this._buffer=null,this.create(this._data)}update(e){this.create(e)}updateDirectly(e,t,i){let s=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this._buffer&&this._updatable&&(this._engine.updateDynamicVertexBuffer(this._buffer,e,s?t:t*Float32Array.BYTES_PER_ELEMENT,i?i*this.byteStride:void 0),this._data=0===t&&void 0===i?e:null)}_increaseReferences(){this._buffer&&(this._isAlreadyOwned?this._buffer.references++:this._isAlreadyOwned=!0)}dispose(){this._buffer&&this._engine._releaseBuffer(this._buffer)&&(this._buffer=null,this._data=null)}}class r{get instanceDivisor(){return this._instanceDivisor}set instanceDivisor(e){const t=0!=e;this._instanceDivisor=e,t!==this._instanced&&(this._instanced=t,this._computeHashCode())}constructor(e,t,i,s,a,o,l,h,c,u){let d=arguments.length>10&&void 0!==arguments[10]&&arguments[10],f=arguments.length>11&&void 0!==arguments[11]&&arguments[11],p=arguments.length>12&&void 0!==arguments[12]?arguments[12]:1,g=arguments.length>13&&void 0!==arguments[13]&&arguments[13];if(t instanceof n?(this._buffer=t,this._ownsBuffer=g):(this._buffer=new n(e,t,s,o,a,l,f),this._ownsBuffer=!0),this.uniqueId=r._Counter++,this._kind=i,null==u){const e=this.getData();this.type=r.FLOAT,e instanceof Int8Array?this.type=r.BYTE:e instanceof Uint8Array?this.type=r.UNSIGNED_BYTE:e instanceof Int16Array?this.type=r.SHORT:e instanceof Uint16Array?this.type=r.UNSIGNED_SHORT:e instanceof Int32Array?this.type=r.INT:e instanceof Uint32Array&&(this.type=r.UNSIGNED_INT)}else this.type=u;const m=r.GetTypeByteLength(this.type);f?(this._size=c||(o?o/m:r.DeduceStride(i)),this.byteStride=o||this._buffer.byteStride||this._size*m,this.byteOffset=h||0):(this._size=c||o||r.DeduceStride(i),this.byteStride=o?o*m:this._buffer.byteStride||this._size*m,this.byteOffset=(h||0)*m),this.normalized=d,this._instanced=void 0!==l&&l,this._instanceDivisor=l?p:0,this._computeHashCode()}_computeHashCode(){this.hashCode=(this.type-5120<<0)+((this.normalized?1:0)<<3)+(this._size<<4)+((this._instanced?1:0)<<6)+(this.byteStride<<12)}_rebuild(){this._buffer&&this._buffer._rebuild()}getKind(){return this._kind}isUpdatable(){return this._buffer.isUpdatable()}getData(){return this._buffer.getData()}getFloatData(e,t){const i=this.getData();if(!i)return null;const s=this.getSize()*r.GetTypeByteLength(this.type),n=e*this.getSize();if(this.type!==r.FLOAT||this.byteStride!==s){const e=new Float32Array(n);return this.forEach(n,((t,i)=>e[i]=t)),e}if(!(i instanceof Array||i instanceof Float32Array)||0!==this.byteOffset||i.length!==n){if(i instanceof Array){const e=this.byteOffset/4;return i.slice(e,e+n)}if(i instanceof ArrayBuffer)return new Float32Array(i,this.byteOffset,n);{let e=i.byteOffset+this.byteOffset;if(t){const t=new Float32Array(n),s=new Float32Array(i.buffer,e,n);return t.set(s),t}const s=e%4;return s&&(e=Math.max(0,e-s)),new Float32Array(i.buffer,e,n)}}return t?i.slice():i}getBuffer(){return this._buffer.getBuffer()}getStrideSize(){return this.byteStride/r.GetTypeByteLength(this.type)}getOffset(){return this.byteOffset/r.GetTypeByteLength(this.type)}getSize(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0]?this._size*r.GetTypeByteLength(this.type):this._size}getIsInstanced(){return this._instanced}getInstanceDivisor(){return this._instanceDivisor}create(e){this._buffer.create(e)}update(e){this._buffer.update(e)}updateDirectly(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this._buffer.updateDirectly(e,t,void 0,i)}dispose(){this._ownsBuffer&&this._buffer.dispose()}forEach(e,t){r.ForEach(this._buffer.getData(),this.byteOffset,this.byteStride,this._size,this.type,e,this.normalized,t)}static DeduceStride(e){switch(e){case r.UVKind:case r.UV2Kind:case r.UV3Kind:case r.UV4Kind:case r.UV5Kind:case r.UV6Kind:return 2;case r.NormalKind:case r.PositionKind:return 3;case r.ColorKind:case r.MatricesIndicesKind:case r.MatricesIndicesExtraKind:case r.MatricesWeightsKind:case r.MatricesWeightsExtraKind:case r.TangentKind:return 4;default:throw new Error("Invalid kind '"+e+"'")}}static GetTypeByteLength(e){switch(e){case r.BYTE:case r.UNSIGNED_BYTE:return 1;case r.SHORT:case r.UNSIGNED_SHORT:return 2;case r.INT:case r.UNSIGNED_INT:case r.FLOAT:return 4;default:throw new Error("Invalid type '".concat(e,"'"))}}static ForEach(e,t,i,s,n,a,o,l){if(e instanceof Array){let n=t/4;const r=i/4;for(let t=0;t<a;t+=s){for(let i=0;i<s;i++)l(e[n+i],t+i);n+=r}}else{const h=e instanceof ArrayBuffer?new DataView(e):new DataView(e.buffer,e.byteOffset,e.byteLength),c=r.GetTypeByteLength(n);for(let e=0;e<a;e+=s){let a=t;for(let t=0;t<s;t++){l(r._GetFloatValue(h,n,a,o),e+t),a+=c}t+=i}}}static _GetFloatValue(e,t,i,s){switch(t){case r.BYTE:{let t=e.getInt8(i);return s&&(t=Math.max(t/127,-1)),t}case r.UNSIGNED_BYTE:{let t=e.getUint8(i);return s&&(t/=255),t}case r.SHORT:{let t=e.getInt16(i,!0);return s&&(t=Math.max(t/32767,-1)),t}case r.UNSIGNED_SHORT:{let t=e.getUint16(i,!0);return s&&(t/=65535),t}case r.INT:return e.getInt32(i,!0);case r.UNSIGNED_INT:return e.getUint32(i,!0);case r.FLOAT:return e.getFloat32(i,!0);default:throw new Error("Invalid component type ".concat(t))}}}r._Counter=0,r.BYTE=5120,r.UNSIGNED_BYTE=5121,r.SHORT=5122,r.UNSIGNED_SHORT=5123,r.INT=5124,r.UNSIGNED_INT=5125,r.FLOAT=5126,r.PositionKind="position",r.NormalKind="normal",r.TangentKind="tangent",r.UVKind="uv",r.UV2Kind="uv2",r.UV3Kind="uv3",r.UV4Kind="uv4",r.UV5Kind="uv5",r.UV6Kind="uv6",r.ColorKind="color",r.ColorInstanceKind="instanceColor",r.MatricesIndicesKind="matricesIndices",r.MatricesWeightsKind="matricesWeights",r.MatricesIndicesExtraKind="matricesIndicesExtra",r.MatricesWeightsExtraKind="matricesWeightsExtra"},7818:function(e,t,i){"use strict";i.d(t,{h:function(){return s}});class s{get underlyingResource(){return null}constructor(){this.references=0,this.capacity=0,this.is32Bits=!1,this.uniqueId=s._Counter++}}s._Counter=0},7337:function(e,t,i){"use strict";i.d(t,{V:function(){return g}});var s=i(9477),n=i(9336),r=i(5934),a=i(8517),o=i(4174),l=i(6900),h=i(1396),c=i(2328),u=i(1704),d=i(5230),f=i(628),p=i(2465);class g extends h.N{get position(){return this._position}set position(e){this._position=e}set upVector(e){this._upVector=e}get upVector(){return this._upVector}get screenArea(){var e,t,i,s;let n=0,r=0;if(this.mode===g.PERSPECTIVE_CAMERA)this.fovMode===g.FOVMODE_VERTICAL_FIXED?(r=2*this.minZ*Math.tan(this.fov/2),n=this.getEngine().getAspectRatio(this)*r):(n=2*this.minZ*Math.tan(this.fov/2),r=n/this.getEngine().getAspectRatio(this));else{const a=this.getEngine().getRenderWidth()/2,o=this.getEngine().getRenderHeight()/2;n=(null!==(e=this.orthoRight)&&void 0!==e?e:a)-(null!==(t=this.orthoLeft)&&void 0!==t?t:-a),r=(null!==(i=this.orthoTop)&&void 0!==i?i:o)-(null!==(s=this.orthoBottom)&&void 0!==s?s:-o)}return n*r}set orthoLeft(e){this._orthoLeft=e;for(const t of this._rigCameras)t.orthoLeft=e}get orthoLeft(){return this._orthoLeft}set orthoRight(e){this._orthoRight=e;for(const t of this._rigCameras)t.orthoRight=e}get orthoRight(){return this._orthoRight}set orthoBottom(e){this._orthoBottom=e;for(const t of this._rigCameras)t.orthoBottom=e}get orthoBottom(){return this._orthoBottom}set orthoTop(e){this._orthoTop=e;for(const t of this._rigCameras)t.orthoTop=e}get orthoTop(){return this._orthoTop}set mode(e){this._mode=e;for(const t of this._rigCameras)t.mode=e}get mode(){return this._mode}constructor(e,t,i){let s=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];super(e,i),this._position=l.P.Zero(),this._upVector=l.P.Up(),this._orthoLeft=null,this._orthoRight=null,this._orthoBottom=null,this._orthoTop=null,this.fov=.8,this.projectionPlaneTilt=0,this.minZ=1,this.maxZ=1e4,this.inertia=.9,this._mode=g.PERSPECTIVE_CAMERA,this.isIntermediate=!1,this.viewport=new f.l(0,0,1,1),this.layerMask=268435455,this.fovMode=g.FOVMODE_VERTICAL_FIXED,this.cameraRigMode=g.RIG_MODE_NONE,this.customRenderTargets=new Array,this.outputRenderTarget=null,this.onViewMatrixChangedObservable=new o.y$,this.onProjectionMatrixChangedObservable=new o.y$,this.onAfterCheckInputsObservable=new o.y$,this.onRestoreStateObservable=new o.y$,this.isRigCamera=!1,this._rigCameras=new Array,this._webvrViewMatrix=l.y3.Identity(),this._skipRendering=!1,this._projectionMatrix=new l.y3,this._postProcesses=new Array,this._activeMeshes=new r.t(256),this._globalPosition=l.P.Zero(),this._computedViewMatrix=l.y3.Identity(),this._doNotComputeProjectionMatrix=!1,this._transformMatrix=l.y3.Zero(),this._refreshFrustumPlanes=!0,this._absoluteRotation=l._f.Identity(),this._isCamera=!0,this._isLeftCamera=!1,this._isRightCamera=!1,this.getScene().addCamera(this),s&&!this.getScene().activeCamera&&(this.getScene().activeCamera=this),this.position=t,this.renderPassId=this.getScene().getEngine().createRenderPassId("Camera ".concat(e))}storeState(){return this._stateStored=!0,this._storedFov=this.fov,this}_restoreStateValues(){return!!this._stateStored&&(this.fov=this._storedFov,!0)}restoreState(){return!!this._restoreStateValues()&&(this.onRestoreStateObservable.notifyObservers(this),!0)}getClassName(){return"Camera"}toString(e){let t="Name: "+this.name;if(t+=", type: "+this.getClassName(),this.animations)for(let i=0;i<this.animations.length;i++)t+=", animation[0]: "+this.animations[i].toString(e);return t}applyVerticalCorrection(){const e=this.absoluteRotation.toEulerAngles();this.projectionPlaneTilt=this._scene.useRightHandedSystem?-e.x:e.x}get globalPosition(){return this._globalPosition}getActiveMeshes(){return this._activeMeshes}isActiveMesh(e){return-1!==this._activeMeshes.indexOf(e)}isReady(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(e)for(const t of this._postProcesses)if(t&&!t.isReady())return!1;return super.isReady(e)}_initCache(){super._initCache(),this._cache.position=new l.P(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),this._cache.upVector=new l.P(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),this._cache.mode=void 0,this._cache.minZ=void 0,this._cache.maxZ=void 0,this._cache.fov=void 0,this._cache.fovMode=void 0,this._cache.aspectRatio=void 0,this._cache.orthoLeft=void 0,this._cache.orthoRight=void 0,this._cache.orthoBottom=void 0,this._cache.orthoTop=void 0,this._cache.renderWidth=void 0,this._cache.renderHeight=void 0}_updateCache(e){e||super._updateCache(),this._cache.position.copyFrom(this.position),this._cache.upVector.copyFrom(this.upVector)}_isSynchronized(){return this._isSynchronizedViewMatrix()&&this._isSynchronizedProjectionMatrix()}_isSynchronizedViewMatrix(){return!!super._isSynchronized()&&(this._cache.position.equals(this.position)&&this._cache.upVector.equals(this.upVector)&&this.isSynchronizedWithParent())}_isSynchronizedProjectionMatrix(){let e=this._cache.mode===this.mode&&this._cache.minZ===this.minZ&&this._cache.maxZ===this.maxZ;if(!e)return!1;const t=this.getEngine();return e=this.mode===g.PERSPECTIVE_CAMERA?this._cache.fov===this.fov&&this._cache.fovMode===this.fovMode&&this._cache.aspectRatio===t.getAspectRatio(this)&&this._cache.projectionPlaneTilt===this.projectionPlaneTilt:this._cache.orthoLeft===this.orthoLeft&&this._cache.orthoRight===this.orthoRight&&this._cache.orthoBottom===this.orthoBottom&&this._cache.orthoTop===this.orthoTop&&this._cache.renderWidth===t.getRenderWidth()&&this._cache.renderHeight===t.getRenderHeight(),e}attachControl(e,t){}detachControl(e){}update(){this._checkInputs(),this.cameraRigMode!==g.RIG_MODE_NONE&&this._updateRigCameras(),this.getViewMatrix(),this.getProjectionMatrix()}_checkInputs(){this.onAfterCheckInputsObservable.notifyObservers(this)}get rigCameras(){return this._rigCameras}get rigPostProcess(){return this._rigPostProcess}_getFirstPostProcess(){for(let e=0;e<this._postProcesses.length;e++)if(null!==this._postProcesses[e])return this._postProcesses[e];return null}_cascadePostProcessesToRigCams(){const e=this._getFirstPostProcess();e&&e.markTextureDirty();for(let t=0,i=this._rigCameras.length;t<i;t++){const e=this._rigCameras[t],i=e._rigPostProcess;if(i){"pass"===i.getEffectName()&&(e.isIntermediate=0===this._postProcesses.length),e._postProcesses=this._postProcesses.slice(0).concat(i),i.markTextureDirty()}else e._postProcesses=this._postProcesses.slice(0)}}attachPostProcess(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return!e.isReusable()&&this._postProcesses.indexOf(e)>-1?(c.Y.Error("You're trying to reuse a post process not defined as reusable."),0):(null==t||t<0?this._postProcesses.push(e):null===this._postProcesses[t]?this._postProcesses[t]=e:this._postProcesses.splice(t,0,e),this._cascadePostProcessesToRigCams(),this._scene.prePassRenderer&&this._scene.prePassRenderer.markAsDirty(),this._postProcesses.indexOf(e))}detachPostProcess(e){const t=this._postProcesses.indexOf(e);-1!==t&&(this._postProcesses[t]=null),this._scene.prePassRenderer&&this._scene.prePassRenderer.markAsDirty(),this._cascadePostProcessesToRigCams()}getWorldMatrix(){return this._isSynchronizedViewMatrix()||this.getViewMatrix(),this._worldMatrix}_getViewMatrix(){return l.y3.Identity()}getViewMatrix(e){return!e&&this._isSynchronizedViewMatrix()||(this.updateCache(),this._computedViewMatrix=this._getViewMatrix(),this._currentRenderId=this.getScene().getRenderId(),this._childUpdateId++,this._refreshFrustumPlanes=!0,this._cameraRigParams&&this._cameraRigParams.vrPreViewMatrix&&this._computedViewMatrix.multiplyToRef(this._cameraRigParams.vrPreViewMatrix,this._computedViewMatrix),this.parent&&this.parent.onViewMatrixChangedObservable&&this.parent.onViewMatrixChangedObservable.notifyObservers(this.parent),this.onViewMatrixChangedObservable.notifyObservers(this),this._computedViewMatrix.invertToRef(this._worldMatrix)),this._computedViewMatrix}freezeProjectionMatrix(e){this._doNotComputeProjectionMatrix=!0,void 0!==e&&(this._projectionMatrix=e)}unfreezeProjectionMatrix(){this._doNotComputeProjectionMatrix=!1}getProjectionMatrix(e){var t,i,s,n,r,a,o,h;if(this._doNotComputeProjectionMatrix||!e&&this._isSynchronizedProjectionMatrix())return this._projectionMatrix;this._cache.mode=this.mode,this._cache.minZ=this.minZ,this._cache.maxZ=this.maxZ,this._refreshFrustumPlanes=!0;const c=this.getEngine(),u=this.getScene(),d=c.useReverseDepthBuffer;if(this.mode===g.PERSPECTIVE_CAMERA){let e;this._cache.fov=this.fov,this._cache.fovMode=this.fovMode,this._cache.aspectRatio=c.getAspectRatio(this),this._cache.projectionPlaneTilt=this.projectionPlaneTilt,this.minZ<=0&&(this.minZ=.1),e=u.useRightHandedSystem?l.y3.PerspectiveFovRHToRef:l.y3.PerspectiveFovLHToRef,e(this.fov,c.getAspectRatio(this),d?this.maxZ:this.minZ,d?this.minZ:this.maxZ,this._projectionMatrix,this.fovMode===g.FOVMODE_VERTICAL_FIXED,c.isNDCHalfZRange,this.projectionPlaneTilt,d)}else{const e=c.getRenderWidth()/2,f=c.getRenderHeight()/2;u.useRightHandedSystem?l.y3.OrthoOffCenterRHToRef(null!==(t=this.orthoLeft)&&void 0!==t?t:-e,null!==(i=this.orthoRight)&&void 0!==i?i:e,null!==(s=this.orthoBottom)&&void 0!==s?s:-f,null!==(n=this.orthoTop)&&void 0!==n?n:f,d?this.maxZ:this.minZ,d?this.minZ:this.maxZ,this._projectionMatrix,c.isNDCHalfZRange):l.y3.OrthoOffCenterLHToRef(null!==(r=this.orthoLeft)&&void 0!==r?r:-e,null!==(a=this.orthoRight)&&void 0!==a?a:e,null!==(o=this.orthoBottom)&&void 0!==o?o:-f,null!==(h=this.orthoTop)&&void 0!==h?h:f,d?this.maxZ:this.minZ,d?this.minZ:this.maxZ,this._projectionMatrix,c.isNDCHalfZRange),this._cache.orthoLeft=this.orthoLeft,this._cache.orthoRight=this.orthoRight,this._cache.orthoBottom=this.orthoBottom,this._cache.orthoTop=this.orthoTop,this._cache.renderWidth=c.getRenderWidth(),this._cache.renderHeight=c.getRenderHeight()}return this.onProjectionMatrixChangedObservable.notifyObservers(this),this._projectionMatrix}getTransformationMatrix(){return this._computedViewMatrix.multiplyToRef(this._projectionMatrix,this._transformMatrix),this._transformMatrix}_updateFrustumPlanes(){this._refreshFrustumPlanes&&(this.getTransformationMatrix(),this._frustumPlanes?p.i.GetPlanesToRef(this._transformMatrix,this._frustumPlanes):this._frustumPlanes=p.i.GetPlanes(this._transformMatrix),this._refreshFrustumPlanes=!1)}isInFrustum(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this._updateFrustumPlanes(),t&&this.rigCameras.length>0){let t=!1;return this.rigCameras.forEach((i=>{i._updateFrustumPlanes(),t=t||e.isInFrustum(i._frustumPlanes)})),t}return e.isInFrustum(this._frustumPlanes)}isCompletelyInFrustum(e){return this._updateFrustumPlanes(),e.isCompletelyInFrustum(this._frustumPlanes)}getForwardRay(){throw(0,d.S)("Ray")}getForwardRayToRef(e){throw(0,d.S)("Ray")}dispose(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];for(this.onViewMatrixChangedObservable.clear(),this.onProjectionMatrixChangedObservable.clear(),this.onAfterCheckInputsObservable.clear(),this.onRestoreStateObservable.clear(),this.inputs&&this.inputs.clear(),this.getScene().stopAnimation(this),this.getScene().removeCamera(this);this._rigCameras.length>0;){const e=this._rigCameras.pop();e&&e.dispose()}if(this._parentContainer){const e=this._parentContainer.cameras.indexOf(this);e>-1&&this._parentContainer.cameras.splice(e,1),this._parentContainer=null}if(this._rigPostProcess)this._rigPostProcess.dispose(this),this._rigPostProcess=null,this._postProcesses.length=0;else if(this.cameraRigMode!==g.RIG_MODE_NONE)this._rigPostProcess=null,this._postProcesses.length=0;else{let e=this._postProcesses.length;for(;--e>=0;){const t=this._postProcesses[e];t&&t.dispose(this)}}let i=this.customRenderTargets.length;for(;--i>=0;)this.customRenderTargets[i].dispose();this.customRenderTargets.length=0,this._activeMeshes.dispose(),this.getScene().getEngine().releaseRenderPassId(this.renderPassId),super.dispose(e,t)}get isLeftCamera(){return this._isLeftCamera}get isRightCamera(){return this._isRightCamera}get leftCamera(){return this._rigCameras.length<1?null:this._rigCameras[0]}get rightCamera(){return this._rigCameras.length<2?null:this._rigCameras[1]}getLeftTarget(){return this._rigCameras.length<1?null:this._rigCameras[0].getTarget()}getRightTarget(){return this._rigCameras.length<2?null:this._rigCameras[1].getTarget()}setCameraRigMode(e,t){if(this.cameraRigMode!==e){for(;this._rigCameras.length>0;){const e=this._rigCameras.pop();e&&e.dispose()}if(this.cameraRigMode=e,this._cameraRigParams={},this._cameraRigParams.interaxialDistance=t.interaxialDistance||.0637,this._cameraRigParams.stereoHalfAngle=a.w1.ToRadians(this._cameraRigParams.interaxialDistance/.0637),this.cameraRigMode!==g.RIG_MODE_NONE){const e=this.createRigCamera(this.name+"_L",0);e&&(e._isLeftCamera=!0);const t=this.createRigCamera(this.name+"_R",1);t&&(t._isRightCamera=!0),e&&t&&(this._rigCameras.push(e),this._rigCameras.push(t))}this._setRigMode(t),this._cascadePostProcessesToRigCams(),this.update()}}_setRigMode(e){}_getVRProjectionMatrix(){return l.y3.PerspectiveFovLHToRef(this._cameraRigParams.vrMetrics.aspectRatioFov,this._cameraRigParams.vrMetrics.aspectRatio,this.minZ,this.maxZ,this._cameraRigParams.vrWorkMatrix,!0,this.getEngine().isNDCHalfZRange),this._cameraRigParams.vrWorkMatrix.multiplyToRef(this._cameraRigParams.vrHMatrix,this._projectionMatrix),this._projectionMatrix}_updateCameraRotationMatrix(){}_updateWebVRCameraRotationMatrix(){}_getWebVRProjectionMatrix(){return l.y3.Identity()}_getWebVRViewMatrix(){return l.y3.Identity()}setCameraRigParameter(e,t){this._cameraRigParams||(this._cameraRigParams={}),this._cameraRigParams[e]=t,"interaxialDistance"===e&&(this._cameraRigParams.stereoHalfAngle=a.w1.ToRadians(t/.0637))}createRigCamera(e,t){return null}_updateRigCameras(){for(let e=0;e<this._rigCameras.length;e++)this._rigCameras[e].minZ=this.minZ,this._rigCameras[e].maxZ=this.maxZ,this._rigCameras[e].fov=this.fov,this._rigCameras[e].upVector.copyFrom(this.upVector);this.cameraRigMode===g.RIG_MODE_STEREOSCOPIC_ANAGLYPH&&(this._rigCameras[0].viewport=this._rigCameras[1].viewport=this.viewport)}_setupInputs(){}serialize(){const e=n.p4.Serialize(this);return e.uniqueId=this.uniqueId,e.type=this.getClassName(),this.parent&&this.parent._serializeAsParent(e),this.inputs&&this.inputs.serialize(e),n.p4.AppendSerializedAnimations(this,e),e.ranges=this.serializeAnimationRanges(),e.isEnabled=this.isEnabled(),e}clone(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const i=n.p4.Clone(g.GetConstructorFromName(this.getClassName(),e,this.getScene(),this.interaxialDistance,this.isStereoscopicSideBySide),this);return i.name=e,i.parent=t,this.onClonedObservable.notifyObservers(i),i}getDirection(e){const t=l.P.Zero();return this.getDirectionToRef(e,t),t}get absoluteRotation(){return this.getWorldMatrix().decompose(void 0,this._absoluteRotation),this._absoluteRotation}getDirectionToRef(e,t){l.P.TransformNormalToRef(e,this.getWorldMatrix(),t)}static GetConstructorFromName(e,t,i){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];const r=h.N.Construct(e,t,i,{interaxial_distance:s,isStereoscopicSideBySide:n});return r||(()=>g._CreateDefaultParsedCamera(t,i))}computeWorldMatrix(){return this.getWorldMatrix()}static Parse(e,t){const i=e.type,s=g.GetConstructorFromName(i,e.name,t,e.interaxial_distance,e.isStereoscopicSideBySide),r=n.p4.Parse(s,e,t);if(void 0!==e.parentId&&(r._waitingParentId=e.parentId),void 0!==e.parentInstanceIndex&&(r._waitingParentInstanceIndex=e.parentInstanceIndex),r.inputs&&(r.inputs.parse(e),r._setupInputs()),e.upVector&&(r.upVector=l.P.FromArray(e.upVector)),r.setPosition&&(r.position.copyFromFloats(0,0,0),r.setPosition(l.P.FromArray(e.position))),e.target&&r.setTarget&&r.setTarget(l.P.FromArray(e.target)),e.cameraRigMode){const t=e.interaxial_distance?{interaxialDistance:e.interaxial_distance}:{};r.setCameraRigMode(e.cameraRigMode,t)}if(e.animations){for(let t=0;t<e.animations.length;t++){const i=e.animations[t],s=(0,u.q)("BABYLON.Animation");s&&r.animations.push(s.Parse(i))}h.N.ParseAnimationRanges(r,e,t)}return e.autoAnimate&&t.beginAnimation(r,e.autoAnimateFrom,e.autoAnimateTo,e.autoAnimateLoop,e.autoAnimateSpeed||1),void 0!==e.isEnabled&&r.setEnabled(e.isEnabled),r}}g._CreateDefaultParsedCamera=(e,t)=>{throw(0,d.S)("UniversalCamera")},g.PERSPECTIVE_CAMERA=0,g.ORTHOGRAPHIC_CAMERA=1,g.FOVMODE_VERTICAL_FIXED=0,g.FOVMODE_HORIZONTAL_FIXED=1,g.RIG_MODE_NONE=0,g.RIG_MODE_STEREOSCOPIC_ANAGLYPH=10,g.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL=11,g.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED=12,g.RIG_MODE_STEREOSCOPIC_OVERUNDER=13,g.RIG_MODE_STEREOSCOPIC_INTERLACED=14,g.RIG_MODE_VR=20,g.RIG_MODE_WEBVR=21,g.RIG_MODE_CUSTOM=22,g.ForceAttachControlToAlwaysPreventDefault=!1,(0,s.gn)([(0,n.hd)("position")],g.prototype,"_position",void 0),(0,s.gn)([(0,n.hd)("upVector")],g.prototype,"_upVector",void 0),(0,s.gn)([(0,n.qC)()],g.prototype,"orthoLeft",null),(0,s.gn)([(0,n.qC)()],g.prototype,"orthoRight",null),(0,s.gn)([(0,n.qC)()],g.prototype,"orthoBottom",null),(0,s.gn)([(0,n.qC)()],g.prototype,"orthoTop",null),(0,s.gn)([(0,n.qC)()],g.prototype,"fov",void 0),(0,s.gn)([(0,n.qC)()],g.prototype,"projectionPlaneTilt",void 0),(0,s.gn)([(0,n.qC)()],g.prototype,"minZ",void 0),(0,s.gn)([(0,n.qC)()],g.prototype,"maxZ",void 0),(0,s.gn)([(0,n.qC)()],g.prototype,"inertia",void 0),(0,s.gn)([(0,n.qC)()],g.prototype,"mode",null),(0,s.gn)([(0,n.qC)()],g.prototype,"layerMask",void 0),(0,s.gn)([(0,n.qC)()],g.prototype,"fovMode",void 0),(0,s.gn)([(0,n.qC)()],g.prototype,"cameraRigMode",void 0),(0,s.gn)([(0,n.qC)()],g.prototype,"interaxialDistance",void 0),(0,s.gn)([(0,n.qC)()],g.prototype,"isStereoscopicSideBySide",void 0)},3541:function(e,t,i){"use strict";i.d(t,{p:function(){return r}});var s=i(6900),n=i(2845);class r{constructor(){this.hit=!1,this.distance=0,this.pickedPoint=null,this.pickedMesh=null,this.bu=0,this.bv=0,this.faceId=-1,this.subMeshFaceId=-1,this.subMeshId=0,this.pickedSprite=null,this.thinInstanceIndex=-1,this.ray=null,this.originMesh=null,this.aimTransform=null,this.gripTransform=null}getNormal(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!this.pickedMesh||t&&!this.pickedMesh.isVerticesDataPresent(n.o.NormalKind))return null;const i=this.pickedMesh.getIndices();if(!i)return null;let r;if(t){const e=this.pickedMesh.getVerticesData(n.o.NormalKind);let t=s.P.FromArray(e,3*i[3*this.faceId]),a=s.P.FromArray(e,3*i[3*this.faceId+1]),o=s.P.FromArray(e,3*i[3*this.faceId+2]);t=t.scale(this.bu),a=a.scale(this.bv),o=o.scale(1-this.bu-this.bv),r=new s.P(t.x+a.x+o.x,t.y+a.y+o.y,t.z+a.z+o.z)}else{const e=this.pickedMesh.getVerticesData(n.o.PositionKind),t=s.P.FromArray(e,3*i[3*this.faceId]),a=s.P.FromArray(e,3*i[3*this.faceId+1]),o=s.P.FromArray(e,3*i[3*this.faceId+2]),l=t.subtract(a),h=o.subtract(a);r=s.P.Cross(l,h)}const a=(e,t)=>{let i=e.getWorldMatrix();e.nonUniformScaling&&(s.jp.Matrix[0].copyFrom(i),i=s.jp.Matrix[0],i.setTranslationFromFloats(0,0,0),i.invert(),i.transposeToRef(s.jp.Matrix[1]),i=s.jp.Matrix[1]),s.P.TransformNormalToRef(t,i,t)};if(e&&a(this.pickedMesh,r),this.ray){const t=s.jp.Vector3[0].copyFrom(r);e||a(this.pickedMesh,t),s.P.Dot(t,this.ray.direction)>0&&r.negateInPlace()}return r.normalize(),r}getTextureCoordinates(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n.o.UVKind;if(!this.pickedMesh||!this.pickedMesh.isVerticesDataPresent(e))return null;const t=this.pickedMesh.getIndices();if(!t)return null;const i=this.pickedMesh.getVerticesData(e);if(!i)return null;let r=s.FM.FromArray(i,2*t[3*this.faceId]),a=s.FM.FromArray(i,2*t[3*this.faceId+1]),o=s.FM.FromArray(i,2*t[3*this.faceId+2]);return r=r.scale(this.bu),a=a.scale(this.bv),o=o.scale(1-this.bu-this.bv),new s.FM(r.x+a.x+o.x,r.y+a.y+o.y)}}},6176:function(e,t,i){"use strict";i.d(t,{e:function(){return s}});class s{}s.UseOpenGLOrientationForUV=!1},9115:function(e,t,i){"use strict";i.d(t,{j:function(){return d}});var s=i(8134),n=i(6900),r=i(3681);class a{constructor(e,t,i){this.vectors=s.B.BuildArray(8,n.P.Zero),this.center=n.P.Zero(),this.centerWorld=n.P.Zero(),this.extendSize=n.P.Zero(),this.extendSizeWorld=n.P.Zero(),this.directions=s.B.BuildArray(3,n.P.Zero),this.vectorsWorld=s.B.BuildArray(8,n.P.Zero),this.minimumWorld=n.P.Zero(),this.maximumWorld=n.P.Zero(),this.minimum=n.P.Zero(),this.maximum=n.P.Zero(),this._drawWrapperFront=null,this._drawWrapperBack=null,this.reConstruct(e,t,i)}reConstruct(e,t,i){const s=e.x,r=e.y,a=e.z,o=t.x,l=t.y,h=t.z,c=this.vectors;this.minimum.copyFromFloats(s,r,a),this.maximum.copyFromFloats(o,l,h),c[0].copyFromFloats(s,r,a),c[1].copyFromFloats(o,l,h),c[2].copyFromFloats(o,r,a),c[3].copyFromFloats(s,l,a),c[4].copyFromFloats(s,r,h),c[5].copyFromFloats(o,l,a),c[6].copyFromFloats(s,l,h),c[7].copyFromFloats(o,r,h),t.addToRef(e,this.center).scaleInPlace(.5),t.subtractToRef(e,this.extendSize).scaleInPlace(.5),this._worldMatrix=i||n.y3.IdentityReadOnly,this._update(this._worldMatrix)}scale(e){const t=a._TmpVector3,i=this.maximum.subtractToRef(this.minimum,t[0]),s=i.length();i.normalizeFromLength(s);const n=s*e,r=i.scaleInPlace(.5*n),o=this.center.subtractToRef(r,t[1]),l=this.center.addToRef(r,t[2]);return this.reConstruct(o,l,this._worldMatrix),this}getWorldMatrix(){return this._worldMatrix}_update(e){const t=this.minimumWorld,i=this.maximumWorld,s=this.directions,r=this.vectorsWorld,a=this.vectors;if(e.isIdentity()){t.copyFrom(this.minimum),i.copyFrom(this.maximum);for(let e=0;e<8;++e)r[e].copyFrom(a[e]);this.extendSizeWorld.copyFrom(this.extendSize),this.centerWorld.copyFrom(this.center)}else{t.setAll(Number.MAX_VALUE),i.setAll(-Number.MAX_VALUE);for(let s=0;s<8;++s){const o=r[s];n.P.TransformCoordinatesToRef(a[s],e,o),t.minimizeInPlace(o),i.maximizeInPlace(o)}i.subtractToRef(t,this.extendSizeWorld).scaleInPlace(.5),i.addToRef(t,this.centerWorld).scaleInPlace(.5)}n.P.FromArrayToRef(e.m,0,s[0]),n.P.FromArrayToRef(e.m,4,s[1]),n.P.FromArrayToRef(e.m,8,s[2]),this._worldMatrix=e}isInFrustum(e){return a.IsInFrustum(this.vectorsWorld,e)}isCompletelyInFrustum(e){return a.IsCompletelyInFrustum(this.vectorsWorld,e)}intersectsPoint(e){const t=this.minimumWorld,i=this.maximumWorld,s=t.x,n=t.y,a=t.z,o=i.x,l=i.y,h=i.z,c=e.x,u=e.y,d=e.z,f=-r.kn;return!(o-c<f||f>c-s)&&(!(l-u<f||f>u-n)&&!(h-d<f||f>d-a))}intersectsSphere(e){return a.IntersectsSphere(this.minimumWorld,this.maximumWorld,e.centerWorld,e.radiusWorld)}intersectsMinMax(e,t){const i=this.minimumWorld,s=this.maximumWorld,n=i.x,r=i.y,a=i.z,o=s.x,l=s.y,h=s.z,c=e.x,u=e.y,d=e.z,f=t.x,p=t.y,g=t.z;return!(o<c||n>f)&&(!(l<u||r>p)&&!(h<d||a>g))}dispose(){var e,t;null===(e=this._drawWrapperFront)||void 0===e||e.dispose(),null===(t=this._drawWrapperBack)||void 0===t||t.dispose()}static Intersects(e,t){return e.intersectsMinMax(t.minimumWorld,t.maximumWorld)}static IntersectsSphere(e,t,i,s){const r=a._TmpVector3[0];n.P.ClampToRef(i,e,t,r);return n.P.DistanceSquared(i,r)<=s*s}static IsCompletelyInFrustum(e,t){for(let i=0;i<6;++i){const s=t[i];for(let t=0;t<8;++t)if(s.dotCoordinate(e[t])<0)return!1}return!0}static IsInFrustum(e,t){for(let i=0;i<6;++i){let s=!0;const n=t[i];for(let t=0;t<8;++t)if(n.dotCoordinate(e[t])>=0){s=!1;break}if(s)return!1}return!0}}a._TmpVector3=s.B.BuildArray(3,n.P.Zero);class o{constructor(e,t,i){this.center=n.P.Zero(),this.centerWorld=n.P.Zero(),this.minimum=n.P.Zero(),this.maximum=n.P.Zero(),this.reConstruct(e,t,i)}reConstruct(e,t,i){this.minimum.copyFrom(e),this.maximum.copyFrom(t);const s=n.P.Distance(e,t);t.addToRef(e,this.center).scaleInPlace(.5),this.radius=.5*s,this._update(i||n.y3.IdentityReadOnly)}scale(e){const t=this.radius*e,i=o._TmpVector3,s=i[0].setAll(t),n=this.center.subtractToRef(s,i[1]),r=this.center.addToRef(s,i[2]);return this.reConstruct(n,r,this._worldMatrix),this}getWorldMatrix(){return this._worldMatrix}_update(e){if(e.isIdentity())this.centerWorld.copyFrom(this.center),this.radiusWorld=this.radius;else{n.P.TransformCoordinatesToRef(this.center,e,this.centerWorld);const t=o._TmpVector3[0];n.P.TransformNormalFromFloatsToRef(1,1,1,e,t),this.radiusWorld=Math.max(Math.abs(t.x),Math.abs(t.y),Math.abs(t.z))*this.radius}}isInFrustum(e){const t=this.centerWorld,i=this.radiusWorld;for(let s=0;s<6;s++)if(e[s].dotCoordinate(t)<=-i)return!1;return!0}isCenterInFrustum(e){const t=this.centerWorld;for(let i=0;i<6;i++)if(e[i].dotCoordinate(t)<0)return!1;return!0}intersectsPoint(e){const t=n.P.DistanceSquared(this.centerWorld,e);return!(this.radiusWorld*this.radiusWorld<t)}static Intersects(e,t){const i=n.P.DistanceSquared(e.centerWorld,t.centerWorld),s=e.radiusWorld+t.radiusWorld;return!(s*s<i)}static CreateFromCenterAndRadius(e,t,i){this._TmpVector3[0].copyFrom(e),this._TmpVector3[1].copyFromFloats(0,0,t),this._TmpVector3[2].copyFrom(e),this._TmpVector3[0].addInPlace(this._TmpVector3[1]),this._TmpVector3[2].subtractInPlace(this._TmpVector3[1]);const s=new o(this._TmpVector3[0],this._TmpVector3[2]);return s._worldMatrix=i||n.y3.Identity(),s}}o._TmpVector3=s.B.BuildArray(3,n.P.Zero);const l={min:0,max:0},h={min:0,max:0},c=(e,t,i)=>{const s=n.P.Dot(t.centerWorld,e),r=Math.abs(n.P.Dot(t.directions[0],e))*t.extendSize.x+Math.abs(n.P.Dot(t.directions[1],e))*t.extendSize.y+Math.abs(n.P.Dot(t.directions[2],e))*t.extendSize.z;i.min=s-r,i.max=s+r},u=(e,t,i)=>(c(e,t,l),c(e,i,h),!(l.min>h.max||h.min>l.max));class d{constructor(e,t,i){this._isLocked=!1,this.boundingBox=new a(e,t,i),this.boundingSphere=new o(e,t,i)}reConstruct(e,t,i){this.boundingBox.reConstruct(e,t,i),this.boundingSphere.reConstruct(e,t,i)}get minimum(){return this.boundingBox.minimum}get maximum(){return this.boundingBox.maximum}get isLocked(){return this._isLocked}set isLocked(e){this._isLocked=e}update(e){this._isLocked||(this.boundingBox._update(e),this.boundingSphere._update(e))}centerOn(e,t){const i=d._TmpVector3[0].copyFrom(e).subtractInPlace(t),s=d._TmpVector3[1].copyFrom(e).addInPlace(t);return this.boundingBox.reConstruct(i,s,this.boundingBox.getWorldMatrix()),this.boundingSphere.reConstruct(i,s,this.boundingBox.getWorldMatrix()),this}encapsulate(e){const t=n.P.Minimize(this.minimum,e),i=n.P.Maximize(this.maximum,e);return this.reConstruct(t,i,this.boundingBox.getWorldMatrix()),this}encapsulateBoundingInfo(e){return this.encapsulate(e.boundingBox.centerWorld.subtract(e.boundingBox.extendSizeWorld)),this.encapsulate(e.boundingBox.centerWorld.add(e.boundingBox.extendSizeWorld)),this}scale(e){return this.boundingBox.scale(e),this.boundingSphere.scale(e),this}isInFrustum(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if((2===t||3===t)&&this.boundingSphere.isCenterInFrustum(e))return!0;if(!this.boundingSphere.isInFrustum(e))return!1;return!(1!==t&&3!==t)||this.boundingBox.isInFrustum(e)}get diagonalLength(){const e=this.boundingBox;return e.maximumWorld.subtractToRef(e.minimumWorld,d._TmpVector3[0]).length()}isCompletelyInFrustum(e){return this.boundingBox.isCompletelyInFrustum(e)}_checkCollision(e){return e._canDoCollision(this.boundingSphere.centerWorld,this.boundingSphere.radiusWorld,this.boundingBox.minimumWorld,this.boundingBox.maximumWorld)}intersectsPoint(e){return!!this.boundingSphere.centerWorld&&(!!this.boundingSphere.intersectsPoint(e)&&!!this.boundingBox.intersectsPoint(e))}intersects(e,t){if(!o.Intersects(this.boundingSphere,e.boundingSphere))return!1;if(!a.Intersects(this.boundingBox,e.boundingBox))return!1;if(!t)return!0;const i=this.boundingBox,s=e.boundingBox;return!!u(i.directions[0],i,s)&&(!!u(i.directions[1],i,s)&&(!!u(i.directions[2],i,s)&&(!!u(s.directions[0],i,s)&&(!!u(s.directions[1],i,s)&&(!!u(s.directions[2],i,s)&&(!!u(n.P.Cross(i.directions[0],s.directions[0]),i,s)&&(!!u(n.P.Cross(i.directions[0],s.directions[1]),i,s)&&(!!u(n.P.Cross(i.directions[0],s.directions[2]),i,s)&&(!!u(n.P.Cross(i.directions[1],s.directions[0]),i,s)&&(!!u(n.P.Cross(i.directions[1],s.directions[1]),i,s)&&(!!u(n.P.Cross(i.directions[1],s.directions[2]),i,s)&&(!!u(n.P.Cross(i.directions[2],s.directions[0]),i,s)&&(!!u(n.P.Cross(i.directions[2],s.directions[1]),i,s)&&!!u(n.P.Cross(i.directions[2],s.directions[2]),i,s))))))))))))))}}d._TmpVector3=s.B.BuildArray(2,n.P.Zero)},9776:function(e,t,i){"use strict";i.d(t,{L:function(){return _}});class s{constructor(){this.children=[]}isValid(e){return!0}process(e,t){var i,s,n,r,a,o;let l="";if(this.line){let h=this.line;const c=t.processor;if(c){c.lineProcessor&&(h=c.lineProcessor(h,t.isFragment,t.processingContext));const l=null!==(s=null===(i=t.processor)||void 0===i?void 0:i.attributeKeywordName)&&void 0!==s?s:"attribute",u=t.isFragment&&(null===(n=t.processor)||void 0===n?void 0:n.varyingFragmentKeywordName)?null===(r=t.processor)||void 0===r?void 0:r.varyingFragmentKeywordName:!t.isFragment&&(null===(a=t.processor)||void 0===a?void 0:a.varyingVertexKeywordName)?null===(o=t.processor)||void 0===o?void 0:o.varyingVertexKeywordName:"varying";if(!t.isFragment&&c.attributeProcessor&&this.line.startsWith(l))h=c.attributeProcessor(this.line,e,t.processingContext);else if(c.varyingProcessor&&this.line.startsWith(u))h=c.varyingProcessor(this.line,t.isFragment,e,t.processingContext);else if(c.uniformProcessor&&c.uniformRegexp&&c.uniformRegexp.test(this.line))t.lookForClosingBracketForUniformBuffer||(h=c.uniformProcessor(this.line,t.isFragment,e,t.processingContext));else if(c.uniformBufferProcessor&&c.uniformBufferRegexp&&c.uniformBufferRegexp.test(this.line))t.lookForClosingBracketForUniformBuffer||(h=c.uniformBufferProcessor(this.line,t.isFragment,t.processingContext),t.lookForClosingBracketForUniformBuffer=!0);else if(c.textureProcessor&&c.textureRegexp&&c.textureRegexp.test(this.line))h=c.textureProcessor(this.line,t.isFragment,e,t.processingContext);else if((c.uniformProcessor||c.uniformBufferProcessor)&&this.line.startsWith("uniform")&&!t.lookForClosingBracketForUniformBuffer){/uniform\s+(?:(?:highp)?|(?:lowp)?)\s*(\S+)\s+(\S+)\s*;/.test(this.line)?c.uniformProcessor&&(h=c.uniformProcessor(this.line,t.isFragment,e,t.processingContext)):c.uniformBufferProcessor&&(h=c.uniformBufferProcessor(this.line,t.isFragment,t.processingContext),t.lookForClosingBracketForUniformBuffer=!0)}t.lookForClosingBracketForUniformBuffer&&-1!==this.line.indexOf("}")&&(t.lookForClosingBracketForUniformBuffer=!1,c.endOfUniformBufferProcessor&&(h=c.endOfUniformBufferProcessor(this.line,t.isFragment,t.processingContext)))}l+=h+"\r\n"}return this.children.forEach((i=>{l+=i.process(e,t)})),this.additionalDefineKey&&(e[this.additionalDefineKey]=this.additionalDefineValue||"true"),l}}class n{constructor(){this._lines=[]}get currentLine(){return this._lines[this.lineIndex]}get canRead(){return this.lineIndex<this._lines.length-1}set lines(e){this._lines.length=0;for(const t of e){if("#"===t[0]){this._lines.push(t);continue}if(t.trim().startsWith("//")){this._lines.push(t);continue}const e=t.split(";");for(let t=0;t<e.length;t++){let i=e[t];i=i.trim(),i&&this._lines.push(i+(t!==e.length-1?";":""))}}}}class r extends s{process(e,t){for(let i=0;i<this.children.length;i++){const s=this.children[i];if(s.isValid(e))return s.process(e,t)}return""}}class a extends s{isValid(e){return this.testExpression.isTrue(e)}}class o{isTrue(e){return!0}static postfixToInfix(e){const t=[];for(const i of e)if(void 0===o._OperatorPriority[i])t.push(i);else{const e=t[t.length-1],s=t[t.length-2];t.length-=2,t.push("(".concat(s).concat(i).concat(e,")"))}return t[t.length-1]}static infixToPostfix(e){const t=[];let i=-1;const s=()=>{h=h.trim(),""!==h&&(t.push(h),h="")},n=e=>{i<o._Stack.length-1&&(o._Stack[++i]=e)},r=()=>o._Stack[i],a=()=>-1===i?"!!INVALID EXPRESSION!!":o._Stack[i--];let l=0,h="";for(;l<e.length;){const c=e.charAt(l),u=l<e.length-1?e.substr(l,2):"";if("("===c)h="",n(c);else if(")"===c){for(s();-1!==i&&"("!==r();)t.push(a());a()}else if(o._OperatorPriority[u]>1){for(s();-1!==i&&o._OperatorPriority[r()]>=o._OperatorPriority[u];)t.push(a());n(u),l++}else h+=c;l++}for(s();-1!==i;)"("===r()?a():t.push(a());return t}}o._OperatorPriority={")":0,"(":1,"||":2,"&&":3},o._Stack=["","","","","","","","","","","","","","","","","","","",""];class l extends o{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(),this.define=e,this.not=t}isTrue(e){let t=void 0!==e[this.define];return this.not&&(t=!t),t}}class h extends o{isTrue(e){return this.leftOperand.isTrue(e)||this.rightOperand.isTrue(e)}}class c extends o{isTrue(e){return this.leftOperand.isTrue(e)&&this.rightOperand.isTrue(e)}}class u extends o{constructor(e,t,i){super(),this.define=e,this.operand=t,this.testValue=i}isTrue(e){let t=e[this.define];void 0===t&&(t=this.define);let i=!1;const s=parseInt(t),n=parseInt(this.testValue);switch(this.operand){case">":i=s>n;break;case"<":i=s<n;break;case"<=":i=s<=n;break;case">=":i=s>=n;break;case"==":i=s===n}return i}}var d=i(5230),f=i(2223);const p=/defined\s*?\((.+?)\)/g,g=/defined\s*?\[(.+?)\]/g,m=/#include\s?<(.+)>(\((.*)\))*(\[(.*)\])*/g;class _{static Initialize(e){e.processor&&e.processor.initializeShaders&&e.processor.initializeShaders(e.processingContext)}static Process(e,t,i,s){var n;(null===(n=t.processor)||void 0===n?void 0:n.preProcessShaderCode)&&(e=t.processor.preProcessShaderCode(e,t.isFragment)),this._ProcessIncludes(e,t,(e=>{t.processCodeAfterIncludes&&(e=t.processCodeAfterIncludes(t.isFragment?"fragment":"vertex",e));const n=this._ProcessShaderConversion(e,t,s);i(n,e)}))}static PreProcess(e,t,i,s){var n;(null===(n=t.processor)||void 0===n?void 0:n.preProcessShaderCode)&&(e=t.processor.preProcessShaderCode(e,t.isFragment)),this._ProcessIncludes(e,t,(e=>{t.processCodeAfterIncludes&&(e=t.processCodeAfterIncludes(t.isFragment?"fragment":"vertex",e));const n=this._ApplyPreProcessing(e,t,s);i(n,e)}))}static Finalize(e,t,i){return i.processor&&i.processor.finalizeShaders?i.processor.finalizeShaders(e,t,i.processingContext):{vertexCode:e,fragmentCode:t}}static _ProcessPrecision(e,t){var i;if(null===(i=t.processor)||void 0===i?void 0:i.noPrecision)return e;const s=t.shouldUseHighPrecisionShader;return-1===e.indexOf("precision highp float")?e=s?"precision highp float;\n"+e:"precision mediump float;\n"+e:s||(e=e.replace("precision highp float","precision mediump float")),e}static _ExtractOperation(e){const t=/defined\((.+)\)/.exec(e);if(t&&t.length)return new l(t[1].trim(),"!"===e[0]);const i=["==",">=","<=","<",">"];let s="",n=0;for(s of i)if(n=e.indexOf(s),n>-1)break;if(-1===n)return new l(e);const r=e.substring(0,n).trim(),a=e.substring(n+s.length).trim();return new u(r,s,a)}static _BuildSubExpression(e){e=e.replace(p,"defined[$1]");const t=o.infixToPostfix(e),i=[];for(const n of t)if("||"!==n&&"&&"!==n)i.push(n);else if(i.length>=2){let e=i[i.length-1],t=i[i.length-2];i.length-=2;const s="&&"==n?new c:new h;"string"==typeof e&&(e=e.replace(g,"defined($1)")),"string"==typeof t&&(t=t.replace(g,"defined($1)")),s.leftOperand="string"==typeof t?this._ExtractOperation(t):t,s.rightOperand="string"==typeof e?this._ExtractOperation(e):e,i.push(s)}let s=i[i.length-1];return"string"==typeof s&&(s=s.replace(g,"defined($1)")),"string"==typeof s?this._ExtractOperation(s):s}static _BuildExpression(e,t){const i=new a,s=e.substring(0,t);let n=e.substring(t);return n=n.substring(0,(n.indexOf("//")+1||n.length+1)-1).trim(),i.testExpression="#ifdef"===s?new l(n):"#ifndef"===s?new l(n,!0):this._BuildSubExpression(n),i}static _MoveCursorWithinIf(e,t,i){let n=e.currentLine;for(;this._MoveCursor(e,i);){n=e.currentLine;const r=n.substring(0,5).toLowerCase();if("#else"===r){const i=new s;return t.children.push(i),void this._MoveCursor(e,i)}if("#elif"===r){const e=this._BuildExpression(n,5);t.children.push(e),i=e}}}static _MoveCursor(e,t){for(;e.canRead;){e.lineIndex++;const i=e.currentLine,n=/(#ifdef)|(#else)|(#elif)|(#endif)|(#ifndef)|(#if)/.exec(i);if(n&&n.length){switch(n[0]){case"#ifdef":{const s=new r;t.children.push(s);const n=this._BuildExpression(i,6);s.children.push(n),this._MoveCursorWithinIf(e,s,n);break}case"#else":case"#elif":return!0;case"#endif":return!1;case"#ifndef":{const s=new r;t.children.push(s);const n=this._BuildExpression(i,7);s.children.push(n),this._MoveCursorWithinIf(e,s,n);break}case"#if":{const s=new r,n=this._BuildExpression(i,3);t.children.push(s),s.children.push(n),this._MoveCursorWithinIf(e,s,n);break}}}else{const e=new s;if(e.line=i,t.children.push(e),"#"===i[0]&&"d"===i[1]){const t=i.replace(";","").split(" ");e.additionalDefineKey=t[1],3===t.length&&(e.additionalDefineValue=t[2])}}}return!1}static _EvaluatePreProcessors(e,t,i){const r=new s,a=new n;return a.lineIndex=-1,a.lines=e.split("\n"),this._MoveCursor(a,r),r.process(t,i)}static _PreparePreProcessors(e,t){var i;const s=e.defines,n={};for(const r of s){const e=r.replace("#define","").replace(";","").trim().split(" ");n[e[0]]=e.length>1?e[1]:""}return(null===(i=e.processor)||void 0===i?void 0:i.shaderLanguage)===f.x.GLSL&&(n.GL_ES="true"),n.__VERSION__=e.version,n[e.platformName]="true",t._getGlobalDefines(n),n}static _ProcessShaderConversion(e,t,i){let s=this._ProcessPrecision(e,t);if(!t.processor)return s;if(t.processor.shaderLanguage===f.x.GLSL&&-1!==s.indexOf("#version 3")&&(s=s.replace("#version 300 es",""),!t.processor.parseGLES3))return s;const n=t.defines,r=this._PreparePreProcessors(t,i);return t.processor.preProcessor&&(s=t.processor.preProcessor(s,n,t.isFragment,t.processingContext)),s=this._EvaluatePreProcessors(s,r,t),t.processor.postProcessor&&(s=t.processor.postProcessor(s,n,t.isFragment,t.processingContext,i)),i._features.needShaderCodeInlining&&(s=i.inlineShaderCode(s)),s}static _ApplyPreProcessing(e,t,i){var s,n;let r=e;const a=t.defines,o=this._PreparePreProcessors(t,i);return(null===(s=t.processor)||void 0===s?void 0:s.preProcessor)&&(r=t.processor.preProcessor(r,a,t.isFragment,t.processingContext)),r=this._EvaluatePreProcessors(r,o,t),(null===(n=t.processor)||void 0===n?void 0:n.postProcessor)&&(r=t.processor.postProcessor(r,a,t.isFragment,t.processingContext,i)),i._features.needShaderCodeInlining&&(r=i.inlineShaderCode(r)),r}static _ProcessIncludes(e,t,i){let s=m.exec(e),n=new String(e),r=!1;for(;null!=s;){let a=s[1];if(-1!==a.indexOf("__decl__")&&(a=a.replace(/__decl__/,""),t.supportsUniformBuffers&&(a=a.replace(/Vertex/,"Ubo"),a=a.replace(/Fragment/,"Ubo")),a+="Declaration"),!t.includesShadersStore[a]){const e=t.shadersRepository+"ShadersInclude/"+a+".fx";return void _._FileToolsLoadFile(e,(e=>{t.includesShadersStore[a]=e,this._ProcessIncludes(n,t,i)}))}{let e=t.includesShadersStore[a];if(s[2]){const t=s[3].split(",");for(let i=0;i<t.length;i+=2){const s=new RegExp(t[i],"g"),n=t[i+1];e=e.replace(s,n)}}if(s[4]){const i=s[5];if(-1!==i.indexOf("..")){const s=i.split(".."),n=parseInt(s[0]);let r=parseInt(s[1]),a=e.slice(0);e="",isNaN(r)&&(r=t.indexParameters[s[1]]);for(let i=n;i<r;i++)t.supportsUniformBuffers||(a=a.replace(/light\{X\}.(\w*)/g,((e,t)=>t+"{X}"))),e+=a.replace(/\{X\}/g,i.toString())+"\n"}else t.supportsUniformBuffers||(e=e.replace(/light\{X\}.(\w*)/g,((e,t)=>t+"{X}"))),e=e.replace(/\{X\}/g,i)}n=n.replace(s[0],e),r=r||e.indexOf("#include<")>=0||e.indexOf("#include <")>=0}s=m.exec(e)}r?this._ProcessIncludes(n.toString(),t,i):i(n)}static _FileToolsLoadFile(e,t,i,s,n,r){throw(0,d.S)("FileTools")}}},938:function(e,t,i){"use strict";i.d(t,{C:function(){return n}});var s=i(2223);class n{constructor(){this.shaderLanguage=s.x.GLSL}attributeProcessor(e){return e.replace("attribute","in")}varyingProcessor(e,t){return e.replace("varying",t?"in":"out")}postProcessor(e,t,i){const s=-1!==e.search(/#extension.+GL_EXT_draw_buffers.+require/);if(e=(e=e.replace(/#extension.+(GL_OVR_multiview2|GL_OES_standard_derivatives|GL_EXT_shader_texture_lod|GL_EXT_frag_depth|GL_EXT_draw_buffers).+(enable|require)/g,"")).replace(/texture2D\s*\(/g,"texture("),i)e=(e=(e=(e=(e=(e=(e=e.replace(/texture2DLodEXT\s*\(/g,"textureLod(")).replace(/textureCubeLodEXT\s*\(/g,"textureLod(")).replace(/textureCube\s*\(/g,"texture(")).replace(/gl_FragDepthEXT/g,"gl_FragDepth")).replace(/gl_FragColor/g,"glFragColor")).replace(/gl_FragData/g,"glFragData")).replace(/void\s+?main\s*\(/g,(s?"":"layout(location = 0) out vec4 glFragColor;\n")+"void main(");else{if(-1!==t.indexOf("#define MULTIVIEW"))return"#extension GL_OVR_multiview2 : require\nlayout (num_views = 2) in;\n"+e}return e}}},6431:function(e,t,i){"use strict";i.d(t,{B:function(){return s}});class s{get underlyingResource(){return this._webGLTexture}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;if(this._MSAARenderBuffer=null,this._context=t,!e&&(e=t.createTexture(),!e))throw new Error("Unable to create webGL texture");this.set(e)}setUsage(){}set(e){this._webGLTexture=e}reset(){this._webGLTexture=null,this._MSAARenderBuffer=null}release(){this._MSAARenderBuffer&&(this._context.deleteRenderbuffer(this._MSAARenderBuffer),this._MSAARenderBuffer=null),this._webGLTexture&&this._context.deleteTexture(this._webGLTexture),this.reset()}}},8099:function(e,t,i){"use strict";i.d(t,{y:function(){return n}});const s=["Int","Int2","Int3","Int4","UInt","UInt2","UInt3","UInt4","Vector2","Vector3","Vector4","Float2","Float","Float3","Float4","Quaternion","Color3","Color4","DirectColor4"];class n{constructor(){this._valueCache={},this.vertexCompilationError=null,this.fragmentCompilationError=null,this.programLinkError=null,this.programValidationError=null;const e=[],t=function(){e.length=0,Array.prototype.push.apply(e,arguments),e[0]=this._uniforms[e[0]]},i=i=>{const n=s.includes(i.substring(3))&&"FloatN";if(n){const s=this["_cache".concat(n)];return function(){const n=this.engine[i];t.apply(this,arguments),s.apply(this,arguments)&&(n.apply(this.engine,e)||(this._valueCache[arguments[0]]=null))}}return function(){const s=this.engine[i];t.apply(this,arguments),void 0!==arguments[1]&&(this._valueCache[arguments[0]]=null,s.apply(this.engine,e))}};["Int?","UInt?","IntArray?","UIntArray?","Array?","Float?","Matrices","Matrix3x3","Matrix2x2"].forEach((e=>{const t="set".concat(e);this[t]||(t.endsWith("?")?["",2,3,4].forEach((e=>{this[t.slice(0,-1)+e]=this[t.slice(0,-1)+e]||i(t.slice(0,-1)+e).bind(this)})):this[t]=this[t]||i(t).bind(this))}))}get isAsync(){return this.isParallelCompiled}get isReady(){return!!this.program&&(!this.isParallelCompiled||this.engine._isRenderingStateCompiled(this))}_handlesSpectorRebuildCallback(e){e&&this.program&&e(this.program)}_fillEffectInformation(e,t,i,s,n,r,a,o){const l=this.engine;if(l.supportsUniformBuffers)for(const c in t)e.bindUniformBlock(c,t[c]);let h;for(this.engine.getUniforms(this,i).forEach(((e,t)=>{s[i[t]]=e})),this._uniforms=s,h=0;h<n.length;h++){null==e.getUniform(n[h])&&(n.splice(h,1),h--)}n.forEach(((e,t)=>{r[e]=t}));for(const c of l.getAttributes(this,a))o.push(c)}dispose(){this._uniforms={}}_cacheMatrix(e,t){const i=this._valueCache[e],s=t.updateFlag;return(void 0===i||i!==s)&&(this._valueCache[e]=s,!0)}_cacheFloatN(e,t,i,s,n){let r=this._valueCache[arguments[0]];if(!r||r.length!==arguments.length-1)return r=Array.prototype.slice.call(arguments,1),this._valueCache[arguments[0]]=r,!0;let a=!1;for(let o=0;o<r.length;++o)r[o]!==arguments[o+1]&&(r[o]=arguments[o+1],a=!0);return a}_cacheFloat2(e,t,i){return this._cacheFloatN(e,t,i)}_cacheFloat3(e,t,i,s){return this._cacheFloatN(e,t,i,s)}_cacheFloat4(e,t,i,s,n){return this._cacheFloatN(e,t,i,s,n)}setMatrix(e,t){this._cacheMatrix(e,t)&&(this.engine.setMatrices(this._uniforms[e],t.toArray())||(this._valueCache[e]=null))}setVector2(e,t){this.setFloat2(e,t.x,t.y)}setVector3(e,t){this.setFloat3(e,t.x,t.y,t.z)}setVector4(e,t){this.setFloat4(e,t.x,t.y,t.z,t.w)}setQuaternion(e,t){this.setFloat4(e,t.x,t.y,t.z,t.w)}setColor3(e,t){this.setFloat3(e,t.r,t.g,t.b)}setColor4(e,t,i){this.setFloat4(e,t.r,t.g,t.b,i)}setDirectColor4(e,t){this.setFloat4(e,t.r,t.g,t.b,t.a)}_getVertexShaderCode(){return this.vertexShader?this.engine._getShaderSource(this.vertexShader):null}_getFragmentShaderCode(){return this.fragmentShader?this.engine._getShaderSource(this.fragmentShader):null}}},970:function(e,t,i){"use strict";i.d(t,{f:function(){return n}});var s=i(2223);class n{constructor(){this.shaderLanguage=s.x.GLSL}postProcessor(e,t,i,s,n){if(!n.getCaps().drawBuffersExtension){const t=/#extension.+GL_EXT_draw_buffers.+(enable|require)/g;e=e.replace(t,"")}return e}}},2977:function(e,t,i){"use strict";i.d(t,{D:function(){return m}});var s=i(4174),n=i(1889),r=i(5092),a=i(4198),o=i(5230),l=i(4796),h=i(2786);class c{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:30;this._enabled=!0,this._rollingFrameTime=new u(e)}sampleFrame(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h.F.Now;if(this._enabled){if(null!=this._lastFrameTimeMs){const t=e-this._lastFrameTimeMs;this._rollingFrameTime.add(t)}this._lastFrameTimeMs=e}}get averageFrameTime(){return this._rollingFrameTime.average}get averageFrameTimeVariance(){return this._rollingFrameTime.variance}get instantaneousFrameTime(){return this._rollingFrameTime.history(0)}get averageFPS(){return 1e3/this._rollingFrameTime.average}get instantaneousFPS(){const e=this._rollingFrameTime.history(0);return 0===e?0:1e3/e}get isSaturated(){return this._rollingFrameTime.isSaturated()}enable(){this._enabled=!0}disable(){this._enabled=!1,this._lastFrameTimeMs=null}get isEnabled(){return this._enabled}reset(){this._lastFrameTimeMs=null,this._rollingFrameTime.reset()}}class u{constructor(e){this._samples=new Array(e),this.reset()}add(e){let t;if(this.isSaturated()){const e=this._samples[this._pos];t=e-this.average,this.average-=t/(this._sampleCount-1),this._m2-=t*(e-this.average)}else this._sampleCount++;t=e-this.average,this.average+=t/this._sampleCount,this._m2+=t*(e-this.average),this.variance=this._m2/(this._sampleCount-1),this._samples[this._pos]=e,this._pos++,this._pos%=this._samples.length}history(e){if(e>=this._sampleCount||e>=this._samples.length)return 0;const t=this._wrapPosition(this._pos-1);return this._samples[this._wrapPosition(t-e)]}isSaturated(){return this._sampleCount>=this._samples.length}reset(){this.average=0,this.variance=0,this._sampleCount=0,this._pos=0,this._m2=0}_wrapPosition(e){const t=this._samples.length;return(e%t+t)%t}}var d=i(2864),f=i(2628),p=i(2328),g=i(6431);l.B.prototype.setAlphaConstants=function(e,t,i,s){this._alphaState.setAlphaBlendConstants(e,t,i,s)},l.B.prototype.setAlphaMode=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this._alphaMode!==e){switch(e){case 0:this._alphaState.alphaBlend=!1;break;case 7:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA,this._gl.ONE,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 8:case 14:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA,this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA),this._alphaState.alphaBlend=!0;break;case 2:this._alphaState.setAlphaBlendFunctionParameters(this._gl.SRC_ALPHA,this._gl.ONE_MINUS_SRC_ALPHA,this._gl.ONE,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 6:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE,this._gl.ONE,this._gl.ZERO,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 1:this._alphaState.setAlphaBlendFunctionParameters(this._gl.SRC_ALPHA,this._gl.ONE,this._gl.ZERO,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 3:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ZERO,this._gl.ONE_MINUS_SRC_COLOR,this._gl.ONE,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 4:this._alphaState.setAlphaBlendFunctionParameters(this._gl.DST_COLOR,this._gl.ZERO,this._gl.ONE,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 5:this._alphaState.setAlphaBlendFunctionParameters(this._gl.SRC_ALPHA,this._gl.ONE_MINUS_SRC_COLOR,this._gl.ONE,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 9:this._alphaState.setAlphaBlendFunctionParameters(this._gl.CONSTANT_COLOR,this._gl.ONE_MINUS_CONSTANT_COLOR,this._gl.CONSTANT_ALPHA,this._gl.ONE_MINUS_CONSTANT_ALPHA),this._alphaState.alphaBlend=!0;break;case 10:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE,this._gl.ONE_MINUS_SRC_COLOR,this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA),this._alphaState.alphaBlend=!0;break;case 11:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE,this._gl.ONE,this._gl.ONE,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 12:this._alphaState.setAlphaBlendFunctionParameters(this._gl.DST_ALPHA,this._gl.ONE,this._gl.ZERO,this._gl.ZERO),this._alphaState.alphaBlend=!0;break;case 13:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE_MINUS_DST_COLOR,this._gl.ONE_MINUS_SRC_COLOR,this._gl.ONE_MINUS_DST_ALPHA,this._gl.ONE_MINUS_SRC_ALPHA),this._alphaState.alphaBlend=!0;break;case 15:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE,this._gl.ONE,this._gl.ONE,this._gl.ZERO),this._alphaState.alphaBlend=!0;break;case 16:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE_MINUS_DST_COLOR,this._gl.ONE_MINUS_SRC_COLOR,this._gl.ZERO,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 17:this._alphaState.setAlphaBlendFunctionParameters(this._gl.SRC_ALPHA,this._gl.ONE_MINUS_SRC_ALPHA,this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA),this._alphaState.alphaBlend=!0}t||(this.depthCullingState.depthMask=0===e),this._alphaMode=e}else if(!t){const t=0===e;this.depthCullingState.depthMask!==t&&(this.depthCullingState.depthMask=t)}},l.B.prototype.getAlphaMode=function(){return this._alphaMode},l.B.prototype.setAlphaEquation=function(e){if(this._alphaEquation!==e){switch(e){case 0:this._alphaState.setAlphaEquationParameters(32774,32774);break;case 1:this._alphaState.setAlphaEquationParameters(32778,32778);break;case 2:this._alphaState.setAlphaEquationParameters(32779,32779);break;case 3:this._alphaState.setAlphaEquationParameters(32776,32776);break;case 4:this._alphaState.setAlphaEquationParameters(32775,32775);break;case 5:this._alphaState.setAlphaEquationParameters(32775,32774)}this._alphaEquation=e}},l.B.prototype.getAlphaEquation=function(){return this._alphaEquation},l.B.prototype._readTexturePixelsSync=function(e,t,i){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,a=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],o=arguments.length>7&&void 0!==arguments[7]&&arguments[7],l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,h=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0;var c,u;const d=this._gl;if(!d)throw new Error("Engine does not have gl rendering context.");if(!this._dummyFramebuffer){const e=d.createFramebuffer();if(!e)throw new Error("Unable to create dummy framebuffer");this._dummyFramebuffer=e}d.bindFramebuffer(d.FRAMEBUFFER,this._dummyFramebuffer),s>-1?d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_CUBE_MAP_POSITIVE_X+s,null===(c=e._hardwareTexture)||void 0===c?void 0:c.underlyingResource,n):d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,null===(u=e._hardwareTexture)||void 0===u?void 0:u.underlyingResource,n);let f=void 0!==e.type?this._getWebGLTextureType(e.type):d.UNSIGNED_BYTE;if(o)r||(r=function(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=arguments.length>3?arguments[3]:void 0;switch(e){case 3:{const e=(ArrayBuffer,new Int8Array(t));return s&&e.set(new Int8Array(s)),e}case 0:{const e=(ArrayBuffer,new Uint8Array(t));return s&&e.set(new Uint8Array(s)),e}case 4:{const e=t instanceof ArrayBuffer?new Int16Array(t):new Int16Array(i?t/2:t);return s&&e.set(new Int16Array(s)),e}case 5:case 8:case 9:case 10:case 2:{const e=t instanceof ArrayBuffer?new Uint16Array(t):new Uint16Array(i?t/2:t);return s&&e.set(new Uint16Array(s)),e}case 6:{const e=t instanceof ArrayBuffer?new Int32Array(t):new Int32Array(i?t/4:t);return s&&e.set(new Int32Array(s)),e}case 7:case 11:case 12:case 13:case 14:case 15:{const e=t instanceof ArrayBuffer?new Uint32Array(t):new Uint32Array(i?t/4:t);return s&&e.set(new Uint32Array(s)),e}case 1:{const e=t instanceof ArrayBuffer?new Float32Array(t):new Float32Array(i?t/4:t);return s&&e.set(new Float32Array(s)),e}}const n=(ArrayBuffer,new Uint8Array(t));return s&&n.set(new Uint8Array(s)),n}(e.type,4*t*i));else if(f===d.UNSIGNED_BYTE)r||(r=new Uint8Array(4*t*i)),f=d.UNSIGNED_BYTE;else r||(r=new Float32Array(4*t*i)),f=d.FLOAT;return a&&this.flushFramebuffer(),d.readPixels(l,h,t,i,d.RGBA,f,r),d.bindFramebuffer(d.FRAMEBUFFER,this._currentFramebuffer),r},l.B.prototype._readTexturePixels=function(e,t,i){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,a=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],o=arguments.length>7&&void 0!==arguments[7]&&arguments[7],l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,h=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0;return Promise.resolve(this._readTexturePixelsSync(e,t,i,s,n,r,a,o,l,h))},l.B.prototype.updateDynamicIndexBuffer=function(e,t){let i;this._currentBoundBuffer[this._gl.ELEMENT_ARRAY_BUFFER]=null,this.bindIndexBuffer(e),i=e.is32Bits?t instanceof Uint32Array?t:new Uint32Array(t):t instanceof Uint16Array?t:new Uint16Array(t),this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,i,this._gl.DYNAMIC_DRAW),this._resetIndexBufferBinding()},l.B.prototype.updateDynamicVertexBuffer=function(e,t,i,s){this.bindArrayBuffer(e),void 0===i&&(i=0);const n=t.byteLength||t.length;void 0===s||s>=n&&0===i?t instanceof Array?this._gl.bufferSubData(this._gl.ARRAY_BUFFER,i,new Float32Array(t)):this._gl.bufferSubData(this._gl.ARRAY_BUFFER,i,t):t instanceof Array?this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,new Float32Array(t).subarray(i,i+s)):(t=t instanceof ArrayBuffer?new Uint8Array(t,i,s):new Uint8Array(t.buffer,t.byteOffset+i,s),this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,t)),this._resetVertexBufferBinding()};class m extends l.B{static get NpmPackage(){return l.B.NpmPackage}static get Version(){return l.B.Version}static get Instances(){return a.l.Instances}static get LastCreatedEngine(){return a.l.LastCreatedEngine}static get LastCreatedScene(){return a.l.LastCreatedScene}_createImageBitmapFromSource(e,t){return new Promise(((i,s)=>{const n=new Image;n.onload=()=>{n.decode().then((()=>{this.createImageBitmap(n,t).then((e=>{i(e)}))}))},n.onerror=()=>{s("Error loading image ".concat(n.src))},n.src=e}))}createImageBitmap(e,t){return createImageBitmap(e,t)}resizeImageBitmap(e,t,i){const s=this.createCanvas(t,i).getContext("2d");if(!s)throw new Error("Unable to get 2d context for resizeImageBitmap");s.drawImage(e,0,0);return s.getImageData(0,0,t,i).data}static MarkAllMaterialsAsDirty(e,t){for(let i=0;i<m.Instances.length;i++){const s=m.Instances[i];for(let i=0;i<s.scenes.length;i++)s.scenes[i].markAllMaterialsAsDirty(e,t)}}static DefaultLoadingScreenFactory(e){throw(0,o.S)("LoadingScreen")}get _supportsHardwareTextureRescaling(){return!!m._RescalePostProcessFactory}get performanceMonitor(){return this._performanceMonitor}get compatibilityMode(){return this._compatibilityMode}set compatibilityMode(e){this._compatibilityMode=!0}getInputElement(){return this._renderingCanvas}constructor(e,t,i){if(super(e,t,i,arguments.length>3&&void 0!==arguments[3]&&arguments[3]),this.enableOfflineSupport=!1,this.disableManifestCheck=!1,this.disableContextMenu=!0,this.scenes=new Array,this._virtualScenes=new Array,this.onNewSceneAddedObservable=new s.y$,this.postProcesses=new Array,this.isPointerLock=!1,this.onResizeObservable=new s.y$,this.onCanvasBlurObservable=new s.y$,this.onCanvasFocusObservable=new s.y$,this.onCanvasPointerOutObservable=new s.y$,this.onBeginFrameObservable=new s.y$,this.customAnimationFrameRequester=null,this.onEndFrameObservable=new s.y$,this.onBeforeShaderCompilationObservable=new s.y$,this.onAfterShaderCompilationObservable=new s.y$,this._deterministicLockstep=!1,this._lockstepMaxSteps=4,this._timeStep=1/60,this._fps=60,this._deltaTime=0,this._drawCalls=new d.z,this.canvasTabIndex=1,this.disablePerformanceMonitorInBackground=!1,this._performanceMonitor=new c,this._compatibilityMode=!0,this.currentRenderPassId=0,this._renderPassNames=["main"],m.Instances.push(this),e){if(this._features.supportRenderPasses=!0,i=this._creationOptions,e.getContext){const t=e;this._sharedInit(t),this._connectVREvents()}this._prepareVRComponent(),i.autoEnableWebVR&&this.initWebVR()}}_initGLContext(){super._initGLContext(),this._rescalePostProcess=null}_sharedInit(e){super._sharedInit(e),this._onCanvasFocus=()=>{this.onCanvasFocusObservable.notifyObservers(this)},this._onCanvasBlur=()=>{this.onCanvasBlurObservable.notifyObservers(this)},this._onCanvasContextMenu=e=>{this.disableContextMenu&&e.preventDefault()},e.addEventListener("focus",this._onCanvasFocus),e.addEventListener("blur",this._onCanvasBlur),e.addEventListener("contextmenu",this._onCanvasContextMenu),this._onBlur=()=>{this.disablePerformanceMonitorInBackground&&this._performanceMonitor.disable(),this._windowIsBackground=!0},this._onFocus=()=>{this.disablePerformanceMonitorInBackground&&this._performanceMonitor.enable(),this._windowIsBackground=!1},this._onCanvasPointerOut=t=>{document.elementFromPoint(t.clientX,t.clientY)!==e&&this.onCanvasPointerOutObservable.notifyObservers(t)};const t=this.getHostWindow();t&&"function"==typeof t.addEventListener&&(t.addEventListener("blur",this._onBlur),t.addEventListener("focus",this._onFocus)),e.addEventListener("pointerout",this._onCanvasPointerOut),this._creationOptions.doNotHandleTouchAction||this._disableTouchAction(),!m.audioEngine&&this._creationOptions.audioEngine&&m.AudioEngineFactory&&(m.audioEngine=m.AudioEngineFactory(this.getRenderingCanvas(),this.getAudioContext(),this.getAudioDestination())),(0,r.n5)()&&(this._onFullscreenChange=()=>{this.isFullscreen=!!document.fullscreenElement,this.isFullscreen&&this._pointerLockRequested&&e&&m._RequestPointerlock(e)},document.addEventListener("fullscreenchange",this._onFullscreenChange,!1),document.addEventListener("webkitfullscreenchange",this._onFullscreenChange,!1),this._onPointerLockChange=()=>{this.isPointerLock=document.pointerLockElement===e},document.addEventListener("pointerlockchange",this._onPointerLockChange,!1),document.addEventListener("webkitpointerlockchange",this._onPointerLockChange,!1)),this.enableOfflineSupport=void 0!==m.OfflineProviderFactory,this._deterministicLockstep=!!this._creationOptions.deterministicLockstep,this._lockstepMaxSteps=this._creationOptions.lockstepMaxSteps||0,this._timeStep=this._creationOptions.timeStep||1/60}_verifyPointerLock(){var e;null===(e=this._onPointerLockChange)||void 0===e||e.call(this)}getAspectRatio(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const i=e.viewport;return this.getRenderWidth(t)*i.width/(this.getRenderHeight(t)*i.height)}getScreenAspectRatio(){return this.getRenderWidth(!0)/this.getRenderHeight(!0)}getRenderingCanvasClientRect(){return this._renderingCanvas?this._renderingCanvas.getBoundingClientRect():null}getInputElementClientRect(){return this._renderingCanvas?this.getInputElement().getBoundingClientRect():null}isDeterministicLockStep(){return this._deterministicLockstep}getLockstepMaxSteps(){return this._lockstepMaxSteps}getTimeStep(){return 1e3*this._timeStep}generateMipMapsForCubemap(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(e.generateMipMaps){const i=this._gl;this._bindTextureDirectly(i.TEXTURE_CUBE_MAP,e,!0),i.generateMipmap(i.TEXTURE_CUBE_MAP),t&&this._bindTextureDirectly(i.TEXTURE_CUBE_MAP,null)}}getDepthWrite(){return this._depthCullingState.depthMask}setDepthWrite(e){this._depthCullingState.depthMask=e}getStencilBuffer(){return this._stencilState.stencilTest}setStencilBuffer(e){this._stencilState.stencilTest=e}getStencilMask(){return this._stencilState.stencilMask}setStencilMask(e){this._stencilState.stencilMask=e}getStencilFunction(){return this._stencilState.stencilFunc}getStencilFunctionReference(){return this._stencilState.stencilFuncRef}getStencilFunctionMask(){return this._stencilState.stencilFuncMask}setStencilFunction(e){this._stencilState.stencilFunc=e}setStencilFunctionReference(e){this._stencilState.stencilFuncRef=e}setStencilFunctionMask(e){this._stencilState.stencilFuncMask=e}getStencilOperationFail(){return this._stencilState.stencilOpStencilFail}getStencilOperationDepthFail(){return this._stencilState.stencilOpDepthFail}getStencilOperationPass(){return this._stencilState.stencilOpStencilDepthPass}setStencilOperationFail(e){this._stencilState.stencilOpStencilFail=e}setStencilOperationDepthFail(e){this._stencilState.stencilOpDepthFail=e}setStencilOperationPass(e){this._stencilState.stencilOpStencilDepthPass=e}setDitheringState(e){e?this._gl.enable(this._gl.DITHER):this._gl.disable(this._gl.DITHER)}setRasterizerState(e){e?this._gl.disable(this._gl.RASTERIZER_DISCARD):this._gl.enable(this._gl.RASTERIZER_DISCARD)}getDepthFunction(){return this._depthCullingState.depthFunc}setDepthFunction(e){this._depthCullingState.depthFunc=e}setDepthFunctionToGreater(){this.setDepthFunction(516)}setDepthFunctionToGreaterOrEqual(){this.setDepthFunction(518)}setDepthFunctionToLess(){this.setDepthFunction(513)}setDepthFunctionToLessOrEqual(){this.setDepthFunction(515)}cacheStencilState(){this._cachedStencilBuffer=this.getStencilBuffer(),this._cachedStencilFunction=this.getStencilFunction(),this._cachedStencilMask=this.getStencilMask(),this._cachedStencilOperationPass=this.getStencilOperationPass(),this._cachedStencilOperationFail=this.getStencilOperationFail(),this._cachedStencilOperationDepthFail=this.getStencilOperationDepthFail(),this._cachedStencilReference=this.getStencilFunctionReference()}restoreStencilState(){this.setStencilFunction(this._cachedStencilFunction),this.setStencilMask(this._cachedStencilMask),this.setStencilBuffer(this._cachedStencilBuffer),this.setStencilOperationPass(this._cachedStencilOperationPass),this.setStencilOperationFail(this._cachedStencilOperationFail),this.setStencilOperationDepthFail(this._cachedStencilOperationDepthFail),this.setStencilFunctionReference(this._cachedStencilReference)}setDirectViewport(e,t,i,s){const n=this._cachedViewport;return this._cachedViewport=null,this._viewport(e,t,i,s),n}scissorClear(e,t,i,s,n){this.enableScissor(e,t,i,s),this.clear(n,!0,!0,!0),this.disableScissor()}enableScissor(e,t,i,s){const n=this._gl;n.enable(n.SCISSOR_TEST),n.scissor(e,t,i,s)}disableScissor(){const e=this._gl;e.disable(e.SCISSOR_TEST)}_reportDrawCall(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this._drawCalls.addCount(e,!1)}initWebVR(){throw(0,o.S)("WebVRCamera")}_prepareVRComponent(){}_connectVREvents(e,t){}_submitVRFrame(){}disableVR(){}isVRPresenting(){return!1}_requestVRFrame(){}_loadFileAsync(e,t,i){return new Promise(((s,n)=>{this._loadFile(e,(e=>{s(e)}),void 0,t,i,((e,t)=>{n(t)}))}))}getVertexShaderSource(e){const t=this._gl.getAttachedShaders(e);return t?this._gl.getShaderSource(t[0]):null}getFragmentShaderSource(e){const t=this._gl.getAttachedShaders(e);return t?this._gl.getShaderSource(t[1]):null}setDepthStencilTexture(e,t,i,s){void 0!==e&&(t&&(this._boundUniforms[e]=t),i&&i.depthStencilTexture?this._setTexture(e,i,!1,!0,s):this._setTexture(e,null,void 0,void 0,s))}setTextureFromPostProcess(e,t,i){var s;let n=null;t&&(t._textures.data[t._currentRenderTextureInd]?n=t._textures.data[t._currentRenderTextureInd]:t._forcedOutputTexture&&(n=t._forcedOutputTexture)),this._bindTexture(e,null!==(s=null==n?void 0:n.texture)&&void 0!==s?s:null,i)}setTextureFromPostProcessOutput(e,t,i){var s,n;this._bindTexture(e,null!==(n=null===(s=null==t?void 0:t._outputTexture)||void 0===s?void 0:s.texture)&&void 0!==n?n:null,i)}_rebuildBuffers(){for(const e of this.scenes)e.resetCachedMaterial(),e._rebuildGeometries(),e._rebuildTextures();for(const e of this._virtualScenes)e.resetCachedMaterial(),e._rebuildGeometries(),e._rebuildTextures();super._rebuildBuffers()}_renderFrame(){for(let e=0;e<this._activeRenderLoops.length;e++){(0,this._activeRenderLoops[e])()}}_renderLoop(){if(!this._contextWasLost){let e=!0;(this.isDisposed||!this.renderEvenInBackground&&this._windowIsBackground)&&(e=!1),e&&(this.beginFrame(),this._renderViews()||this._renderFrame(),this.endFrame())}this._activeRenderLoops.length>0?this.customAnimationFrameRequester?(this.customAnimationFrameRequester.requestID=this._queueNewFrame(this.customAnimationFrameRequester.renderFunction||this._boundRenderFunction,this.customAnimationFrameRequester),this._frameHandler=this.customAnimationFrameRequester.requestID):this.isVRPresenting()?this._requestVRFrame():this._frameHandler=this._queueNewFrame(this._boundRenderFunction,this.getHostWindow()):this._renderingQueueLaunched=!1}_renderViews(){return!1}switchFullscreen(e){this.isFullscreen?this.exitFullscreen():this.enterFullscreen(e)}enterFullscreen(e){this.isFullscreen||(this._pointerLockRequested=e,this._renderingCanvas&&m._RequestFullscreen(this._renderingCanvas))}exitFullscreen(){this.isFullscreen&&m._ExitFullscreen()}enterPointerlock(){this._renderingCanvas&&m._RequestPointerlock(this._renderingCanvas)}exitPointerlock(){m._ExitPointerlock()}beginFrame(){this._measureFps(),this.onBeginFrameObservable.notifyObservers(this),super.beginFrame()}endFrame(){super.endFrame(),this._submitVRFrame(),this.onEndFrameObservable.notifyObservers(this)}resize(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isVRPresenting()||super.resize(e)}setSize(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!this._renderingCanvas)return!1;if(!super.setSize(e,t,i))return!1;if(this.scenes){for(let e=0;e<this.scenes.length;e++){const t=this.scenes[e];for(let e=0;e<t.cameras.length;e++){t.cameras[e]._currentRenderId=0}}this.onResizeObservable.hasObservers()&&this.onResizeObservable.notifyObservers(this)}return!0}_deletePipelineContext(e){const t=e;t&&t.program&&t.transformFeedback&&(this.deleteTransformFeedback(t.transformFeedback),t.transformFeedback=null),super._deletePipelineContext(e)}createShaderProgram(e,t,i,s,n){let r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;n=n||this._gl,this.onBeforeShaderCompilationObservable.notifyObservers(this);const a=super.createShaderProgram(e,t,i,s,n,r);return this.onAfterShaderCompilationObservable.notifyObservers(this),a}_createShaderProgram(e,t,i,s){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;const r=s.createProgram();if(e.program=r,!r)throw new Error("Unable to create program");if(s.attachShader(r,t),s.attachShader(r,i),this.webGLVersion>1&&n){const t=this.createTransformFeedback();this.bindTransformFeedback(t),this.setTranformFeedbackVaryings(r,n),e.transformFeedback=t}return s.linkProgram(r),this.webGLVersion>1&&n&&this.bindTransformFeedback(null),e.context=s,e.vertexShader=t,e.fragmentShader=i,e.isParallelCompiled||this._finalizePipelineContext(e),r}_releaseTexture(e){super._releaseTexture(e)}_releaseRenderTargetWrapper(e){super._releaseRenderTargetWrapper(e),this.scenes.forEach((t=>{t.postProcesses.forEach((t=>{t._outputTexture===e&&(t._outputTexture=null)})),t.cameras.forEach((t=>{t._postProcesses.forEach((t=>{t&&t._outputTexture===e&&(t._outputTexture=null)}))}))}))}getRenderPassNames(){return this._renderPassNames}getCurrentRenderPassName(){return this._renderPassNames[this.currentRenderPassId]}createRenderPassId(e){const t=++m._RenderPassIdCounter;return this._renderPassNames[t]=null!=e?e:"NONAME",t}releaseRenderPassId(e){this._renderPassNames[e]=void 0;for(let t=0;t<this.scenes.length;++t){const i=this.scenes[t];for(let t=0;t<i.meshes.length;++t){const s=i.meshes[t];if(s.subMeshes)for(let t=0;t<s.subMeshes.length;++t){s.subMeshes[t]._removeDrawWrapper(e)}}}}_rescaleTexture(e,t,i,s,n){this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.LINEAR),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl.LINEAR),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE);const r=this.createRenderTargetTexture({width:t.width,height:t.height},{generateMipMaps:!1,type:0,samplingMode:2,generateDepthBuffer:!1,generateStencilBuffer:!1});!this._rescalePostProcess&&m._RescalePostProcessFactory&&(this._rescalePostProcess=m._RescalePostProcessFactory(this)),this._rescalePostProcess&&(this._rescalePostProcess.externalTextureSamplerBinding=!0,this._rescalePostProcess.getEffect().executeWhenCompiled((()=>{this._rescalePostProcess.onApply=function(t){t._bindTexture("textureSampler",e)};let a=i;a||(a=this.scenes[this.scenes.length-1]),a.postProcessManager.directRender([this._rescalePostProcess],r,!0),this._bindTextureDirectly(this._gl.TEXTURE_2D,t,!0),this._gl.copyTexImage2D(this._gl.TEXTURE_2D,0,s,0,0,t.width,t.height,0),this.unBindFramebuffer(r),r.dispose(),n&&n()})))}getFps(){return this._fps}getDeltaTime(){return this._deltaTime}_measureFps(){this._performanceMonitor.sampleFrame(),this._fps=this._performanceMonitor.averageFPS,this._deltaTime=this._performanceMonitor.instantaneousFrameTime||0}wrapWebGLTexture(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3;const s=new g.B(e,this._gl),r=new n.l(this,n.S.Unknown,!0);return r._hardwareTexture=s,r.isReady=!0,r.useMipMaps=t,this.updateTextureSamplingMode(i,r),r}_uploadImageToTexture(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const n=this._gl,r=this._getWebGLTextureType(e.type),a=this._getInternalFormat(e.format),o=this._getRGBABufferInternalSizedFormat(e.type,a),l=e.isCube?n.TEXTURE_CUBE_MAP:n.TEXTURE_2D;this._bindTextureDirectly(l,e,!0),this._unpackFlipY(e.invertY);let h=n.TEXTURE_2D;e.isCube&&(h=n.TEXTURE_CUBE_MAP_POSITIVE_X+i),n.texImage2D(h,s,o,a,r,t),this._bindTextureDirectly(l,null,!0)}updateTextureComparisonFunction(e,t){if(1===this.webGLVersion)return void p.Y.Error("WebGL 1 does not support texture comparison.");const i=this._gl;e.isCube?(this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP,e,!0),0===t?(i.texParameteri(i.TEXTURE_CUBE_MAP,i.TEXTURE_COMPARE_FUNC,515),i.texParameteri(i.TEXTURE_CUBE_MAP,i.TEXTURE_COMPARE_MODE,i.NONE)):(i.texParameteri(i.TEXTURE_CUBE_MAP,i.TEXTURE_COMPARE_FUNC,t),i.texParameteri(i.TEXTURE_CUBE_MAP,i.TEXTURE_COMPARE_MODE,i.COMPARE_REF_TO_TEXTURE)),this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP,null)):(this._bindTextureDirectly(this._gl.TEXTURE_2D,e,!0),0===t?(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_COMPARE_FUNC,515),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_COMPARE_MODE,i.NONE)):(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_COMPARE_FUNC,t),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_COMPARE_MODE,i.COMPARE_REF_TO_TEXTURE)),this._bindTextureDirectly(this._gl.TEXTURE_2D,null)),e._comparisonFunction=t}createInstancesBuffer(e){const t=this._gl.createBuffer();if(!t)throw new Error("Unable to create instance buffer");const i=new f.M(t);return i.capacity=e,this.bindArrayBuffer(i),this._gl.bufferData(this._gl.ARRAY_BUFFER,e,this._gl.DYNAMIC_DRAW),i.references=1,i}deleteInstancesBuffer(e){this._gl.deleteBuffer(e)}_clientWaitAsync(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;const s=this._gl;return new Promise(((n,r)=>{const a=()=>{const o=s.clientWaitSync(e,t,0);o!=s.WAIT_FAILED?o!=s.TIMEOUT_EXPIRED?n():setTimeout(a,i):r()};a()}))}_readPixelsAsync(e,t,i,s,n,r,a){if(this._webGLVersion<2)throw new Error("_readPixelsAsync only work on WebGL2+");const o=this._gl,l=o.createBuffer();o.bindBuffer(o.PIXEL_PACK_BUFFER,l),o.bufferData(o.PIXEL_PACK_BUFFER,a.byteLength,o.STREAM_READ),o.readPixels(e,t,i,s,n,r,0),o.bindBuffer(o.PIXEL_PACK_BUFFER,null);const h=o.fenceSync(o.SYNC_GPU_COMMANDS_COMPLETE,0);return h?(o.flush(),this._clientWaitAsync(h,0,10).then((()=>(o.deleteSync(h),o.bindBuffer(o.PIXEL_PACK_BUFFER,l),o.getBufferSubData(o.PIXEL_PACK_BUFFER,0,a),o.bindBuffer(o.PIXEL_PACK_BUFFER,null),o.deleteBuffer(l),a)))):null}dispose(){for(this.hideLoadingUI(),this.onNewSceneAddedObservable.clear();this.postProcesses.length;)this.postProcesses[0].dispose();for(this._rescalePostProcess&&this._rescalePostProcess.dispose();this.scenes.length;)this.scenes[0].dispose();for(;this._virtualScenes.length;)this._virtualScenes[0].dispose();1===a.l.Instances.length&&m.audioEngine&&(m.audioEngine.dispose(),m.audioEngine=null),this.disableVR();const e=this.getHostWindow();e&&"function"==typeof e.removeEventListener&&(e.removeEventListener("blur",this._onBlur),e.removeEventListener("focus",this._onFocus)),this._renderingCanvas&&(this._renderingCanvas.removeEventListener("focus",this._onCanvasFocus),this._renderingCanvas.removeEventListener("blur",this._onCanvasBlur),this._renderingCanvas.removeEventListener("pointerout",this._onCanvasPointerOut),this._renderingCanvas.removeEventListener("contextmenu",this._onCanvasContextMenu)),(0,r.n5)()&&(document.removeEventListener("fullscreenchange",this._onFullscreenChange),document.removeEventListener("mozfullscreenchange",this._onFullscreenChange),document.removeEventListener("webkitfullscreenchange",this._onFullscreenChange),document.removeEventListener("msfullscreenchange",this._onFullscreenChange),document.removeEventListener("pointerlockchange",this._onPointerLockChange),document.removeEventListener("mspointerlockchange",this._onPointerLockChange),document.removeEventListener("mozpointerlockchange",this._onPointerLockChange),document.removeEventListener("webkitpointerlockchange",this._onPointerLockChange)),super.dispose();const t=a.l.Instances.indexOf(this);t>=0&&a.l.Instances.splice(t,1),m.Instances.length||(a.l.OnEnginesDisposedObservable.notifyObservers(this),a.l.OnEnginesDisposedObservable.clear()),this.onResizeObservable.clear(),this.onCanvasBlurObservable.clear(),this.onCanvasFocusObservable.clear(),this.onCanvasPointerOutObservable.clear(),this.onBeginFrameObservable.clear(),this.onEndFrameObservable.clear()}_disableTouchAction(){this._renderingCanvas&&this._renderingCanvas.setAttribute&&(this._renderingCanvas.setAttribute("touch-action","none"),this._renderingCanvas.style.touchAction="none",this._renderingCanvas.style.webkitTapHighlightColor="transparent")}displayLoadingUI(){if(!(0,r.CG)())return;const e=this.loadingScreen;e&&e.displayLoadingUI()}hideLoadingUI(){if(!(0,r.CG)())return;const e=this._loadingScreen;e&&e.hideLoadingUI()}get loadingScreen(){return!this._loadingScreen&&this._renderingCanvas&&(this._loadingScreen=m.DefaultLoadingScreenFactory(this._renderingCanvas)),this._loadingScreen}set loadingScreen(e){this._loadingScreen=e}set loadingUIText(e){this.loadingScreen.loadingUIText=e}set loadingUIBackgroundColor(e){this.loadingScreen.loadingUIBackgroundColor=e}createVideoElement(e){return document.createElement("video")}static _RequestPointerlock(e){if(e.requestPointerLock){const t=e.requestPointerLock();t instanceof Promise?t.then((()=>{e.focus()})).catch((()=>{})):e.focus()}}static _ExitPointerlock(){document.exitPointerLock&&document.exitPointerLock()}static _RequestFullscreen(e){const t=e.requestFullscreen||e.webkitRequestFullscreen;t&&t.call(e)}static _ExitFullscreen(){const e=document;document.exitFullscreen?document.exitFullscreen():e.webkitCancelFullScreen&&e.webkitCancelFullScreen()}getFontOffset(e){const t=document.createElement("span");t.innerHTML="Hg",t.setAttribute("style","font: ".concat(e," !important"));const i=document.createElement("div");i.style.display="inline-block",i.style.width="1px",i.style.height="0px",i.style.verticalAlign="bottom";const s=document.createElement("div");s.style.whiteSpace="nowrap",s.appendChild(t),s.appendChild(i),document.body.appendChild(s);let n=0,r=0;try{r=i.getBoundingClientRect().top-t.getBoundingClientRect().top,i.style.verticalAlign="baseline",n=i.getBoundingClientRect().top-t.getBoundingClientRect().top}finally{document.body.removeChild(s)}return{ascent:n,height:r,descent:r-n}}}m.ALPHA_DISABLE=0,m.ALPHA_ADD=1,m.ALPHA_COMBINE=2,m.ALPHA_SUBTRACT=3,m.ALPHA_MULTIPLY=4,m.ALPHA_MAXIMIZED=5,m.ALPHA_ONEONE=6,m.ALPHA_PREMULTIPLIED=7,m.ALPHA_PREMULTIPLIED_PORTERDUFF=8,m.ALPHA_INTERPOLATE=9,m.ALPHA_SCREENMODE=10,m.DELAYLOADSTATE_NONE=0,m.DELAYLOADSTATE_LOADED=1,m.DELAYLOADSTATE_LOADING=2,m.DELAYLOADSTATE_NOTLOADED=4,m.NEVER=512,m.ALWAYS=519,m.LESS=513,m.EQUAL=514,m.LEQUAL=515,m.GREATER=516,m.GEQUAL=518,m.NOTEQUAL=517,m.KEEP=7680,m.REPLACE=7681,m.INCR=7682,m.DECR=7683,m.INVERT=5386,m.INCR_WRAP=34055,m.DECR_WRAP=34056,m.TEXTURE_CLAMP_ADDRESSMODE=0,m.TEXTURE_WRAP_ADDRESSMODE=1,m.TEXTURE_MIRROR_ADDRESSMODE=2,m.TEXTUREFORMAT_ALPHA=0,m.TEXTUREFORMAT_LUMINANCE=1,m.TEXTUREFORMAT_LUMINANCE_ALPHA=2,m.TEXTUREFORMAT_RGB=4,m.TEXTUREFORMAT_RGBA=5,m.TEXTUREFORMAT_RED=6,m.TEXTUREFORMAT_R=6,m.TEXTUREFORMAT_RG=7,m.TEXTUREFORMAT_RED_INTEGER=8,m.TEXTUREFORMAT_R_INTEGER=8,m.TEXTUREFORMAT_RG_INTEGER=9,m.TEXTUREFORMAT_RGB_INTEGER=10,m.TEXTUREFORMAT_RGBA_INTEGER=11,m.TEXTURETYPE_UNSIGNED_BYTE=0,m.TEXTURETYPE_UNSIGNED_INT=0,m.TEXTURETYPE_FLOAT=1,m.TEXTURETYPE_HALF_FLOAT=2,m.TEXTURETYPE_BYTE=3,m.TEXTURETYPE_SHORT=4,m.TEXTURETYPE_UNSIGNED_SHORT=5,m.TEXTURETYPE_INT=6,m.TEXTURETYPE_UNSIGNED_INTEGER=7,m.TEXTURETYPE_UNSIGNED_SHORT_4_4_4_4=8,m.TEXTURETYPE_UNSIGNED_SHORT_5_5_5_1=9,m.TEXTURETYPE_UNSIGNED_SHORT_5_6_5=10,m.TEXTURETYPE_UNSIGNED_INT_2_10_10_10_REV=11,m.TEXTURETYPE_UNSIGNED_INT_24_8=12,m.TEXTURETYPE_UNSIGNED_INT_10F_11F_11F_REV=13,m.TEXTURETYPE_UNSIGNED_INT_5_9_9_9_REV=14,m.TEXTURETYPE_FLOAT_32_UNSIGNED_INT_24_8_REV=15,m.TEXTURE_NEAREST_SAMPLINGMODE=1,m.TEXTURE_BILINEAR_SAMPLINGMODE=2,m.TEXTURE_TRILINEAR_SAMPLINGMODE=3,m.TEXTURE_NEAREST_NEAREST_MIPLINEAR=8,m.TEXTURE_LINEAR_LINEAR_MIPNEAREST=11,m.TEXTURE_LINEAR_LINEAR_MIPLINEAR=3,m.TEXTURE_NEAREST_NEAREST_MIPNEAREST=4,m.TEXTURE_NEAREST_LINEAR_MIPNEAREST=5,m.TEXTURE_NEAREST_LINEAR_MIPLINEAR=6,m.TEXTURE_NEAREST_LINEAR=7,m.TEXTURE_NEAREST_NEAREST=1,m.TEXTURE_LINEAR_NEAREST_MIPNEAREST=9,m.TEXTURE_LINEAR_NEAREST_MIPLINEAR=10,m.TEXTURE_LINEAR_LINEAR=2,m.TEXTURE_LINEAR_NEAREST=12,m.TEXTURE_EXPLICIT_MODE=0,m.TEXTURE_SPHERICAL_MODE=1,m.TEXTURE_PLANAR_MODE=2,m.TEXTURE_CUBIC_MODE=3,m.TEXTURE_PROJECTION_MODE=4,m.TEXTURE_SKYBOX_MODE=5,m.TEXTURE_INVCUBIC_MODE=6,m.TEXTURE_EQUIRECTANGULAR_MODE=7,m.TEXTURE_FIXED_EQUIRECTANGULAR_MODE=8,m.TEXTURE_FIXED_EQUIRECTANGULAR_MIRRORED_MODE=9,m.SCALEMODE_FLOOR=1,m.SCALEMODE_NEAREST=2,m.SCALEMODE_CEILING=3,m._RescalePostProcessFactory=null,m._RenderPassIdCounter=0},4198:function(e,t,i){"use strict";i.d(t,{l:function(){return n}});var s=i(4174);class n{static get LastCreatedEngine(){return 0===this.Instances.length?null:this.Instances[this.Instances.length-1]}static get LastCreatedScene(){return this._LastCreatedScene}}n.Instances=new Array,n.OnEnginesDisposedObservable=new s.y$,n._LastCreatedScene=null,n.UseFallbackTexture=!0,n.FallbackTexture=""},6196:function(e,t,i){"use strict";i.d(t,{Z:function(){return s}});class s{static SetMatrixPrecision(e){if(s.MatrixTrackPrecisionChange=!1,e&&!s.MatrixUse64Bits&&s.MatrixTrackedMatrices)for(let t=0;t<s.MatrixTrackedMatrices.length;++t){const e=s.MatrixTrackedMatrices[t],i=e._m;e._m=new Array(16);for(let t=0;t<16;++t)e._m[t]=i[t]}s.MatrixUse64Bits=e,s.MatrixCurrentType=s.MatrixUse64Bits?Array:Float32Array,s.MatrixTrackedMatrices=null}}s.MatrixUse64Bits=!1,s.MatrixTrackPrecisionChange=!0,s.MatrixCurrentType=Float32Array,s.MatrixTrackedMatrices=[]},8084:function(e,t,i){"use strict";i.d(t,{v:function(){return n}});var s=i(2223);class n{static GetShadersRepository(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:s.x.GLSL)===s.x.GLSL?n.ShadersRepository:n.ShadersRepositoryWGSL}static GetShadersStore(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:s.x.GLSL)===s.x.GLSL?n.ShadersStore:n.ShadersStoreWGSL}static GetIncludesShadersStore(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:s.x.GLSL)===s.x.GLSL?n.IncludesShadersStore:n.IncludesShadersStoreWGSL}}n.ShadersRepository="src/Shaders/",n.ShadersStore={},n.IncludesShadersStore={},n.ShadersRepositoryWGSL="src/ShadersWGSL/",n.ShadersStoreWGSL={},n.IncludesShadersStoreWGSL={}},1187:function(e,t,i){"use strict";var s;i.d(t,{G:function(){return n}}),function(e){e[e.PointerMove=0]="PointerMove",e[e.PointerDown=1]="PointerDown",e[e.PointerUp=2]="PointerUp"}(s||(s={}));class n{}n.DOM_DELTA_PIXEL=0,n.DOM_DELTA_LINE=1,n.DOM_DELTA_PAGE=2},3531:function(e,t,i){"use strict";i.d(t,{NG:function(){return n},OG:function(){return s},WZ:function(){return r}});class s{}s.KEYDOWN=1,s.KEYUP=2;class n{constructor(e,t){this.type=e,this.event=t}}class r extends n{get skipOnPointerObservable(){return this.skipOnKeyboardObservable}set skipOnPointerObservable(e){this.skipOnKeyboardObservable=e}constructor(e,t){super(e,t),this.type=e,this.event=t,this.skipOnKeyboardObservable=!1}}},3365:function(e,t,i){"use strict";i.d(t,{FV:function(){return a},R5:function(){return o},kD:function(){return n}});var s=i(6900);class n{}n.POINTERDOWN=1,n.POINTERUP=2,n.POINTERMOVE=4,n.POINTERWHEEL=8,n.POINTERPICK=16,n.POINTERTAP=32,n.POINTERDOUBLETAP=64;class r{constructor(e,t){this.type=e,this.event=t}}class a extends r{constructor(e,t,i,n){super(e,t),this.ray=null,this.originalPickingInfo=null,this.skipOnPointerObservable=!1,this.localPosition=new s.FM(i,n)}}class o extends r{get pickInfo(){return this._pickInfo||this._generatePickInfo(),this._pickInfo}constructor(e,t,i){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super(e,t),this._pickInfo=i,this._inputManager=s}_generatePickInfo(){this._inputManager&&(this._pickInfo=this._inputManager._pickMove(this.event),this._inputManager._setRayOnPointerInfo(this._pickInfo,this.event),this._inputManager=null)}}},1221:function(e,t,i){"use strict";i.d(t,{m:function(){return s}});class s{static CompareLightsPriority(e,t){return e.shadowEnabled!==t.shadowEnabled?(t.shadowEnabled?1:0)-(e.shadowEnabled?1:0):t.renderPriority-e.renderPriority}}s.FALLOFF_DEFAULT=0,s.FALLOFF_PHYSICAL=1,s.FALLOFF_GLTF=2,s.FALLOFF_STANDARD=3,s.LIGHTMAP_DEFAULT=0,s.LIGHTMAP_SPECULAR=1,s.LIGHTMAP_SHADOWSONLY=2,s.INTENSITYMODE_AUTOMATIC=0,s.INTENSITYMODE_LUMINOUSPOWER=1,s.INTENSITYMODE_LUMINOUSINTENSITY=2,s.INTENSITYMODE_ILLUMINANCE=3,s.INTENSITYMODE_LUMINANCE=4,s.LIGHTTYPEID_POINTLIGHT=0,s.LIGHTTYPEID_DIRECTIONALLIGHT=1,s.LIGHTTYPEID_SPOTLIGHT=2,s.LIGHTTYPEID_HEMISPHERICLIGHT=3},6639:function(e,t,i){"use strict";i.d(t,{Z:function(){return s}});class s{static get ForceFullSceneLoadingForIncremental(){return s._ForceFullSceneLoadingForIncremental}static set ForceFullSceneLoadingForIncremental(e){s._ForceFullSceneLoadingForIncremental=e}static get ShowLoadingScreen(){return s._ShowLoadingScreen}static set ShowLoadingScreen(e){s._ShowLoadingScreen=e}static get loggingLevel(){return s._LoggingLevel}static set loggingLevel(e){s._LoggingLevel=e}static get CleanBoneMatrixWeights(){return s._CleanBoneMatrixWeights}static set CleanBoneMatrixWeights(e){s._CleanBoneMatrixWeights=e}}s._ForceFullSceneLoadingForIncremental=!1,s._ShowLoadingScreen=!0,s._CleanBoneMatrixWeights=!1,s._LoggingLevel=0},1889:function(e,t,i){"use strict";i.d(t,{l:function(){return a},S:function(){return s}});var s,n=i(4174);class r{get wrapU(){return this._cachedWrapU}set wrapU(e){this._cachedWrapU=e}get wrapV(){return this._cachedWrapV}set wrapV(e){this._cachedWrapV=e}get wrapR(){return this._cachedWrapR}set wrapR(e){this._cachedWrapR=e}get anisotropicFilteringLevel(){return this._cachedAnisotropicFilteringLevel}set anisotropicFilteringLevel(e){this._cachedAnisotropicFilteringLevel=e}get comparisonFunction(){return this._comparisonFunction}set comparisonFunction(e){this._comparisonFunction=e}get useMipMaps(){return this._useMipMaps}set useMipMaps(e){this._useMipMaps=e}constructor(){this.samplingMode=-1,this._useMipMaps=!0,this._cachedWrapU=null,this._cachedWrapV=null,this._cachedWrapR=null,this._cachedAnisotropicFilteringLevel=null,this._comparisonFunction=0}setParameters(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;return this._cachedWrapU=e,this._cachedWrapV=t,this._cachedWrapR=i,this._cachedAnisotropicFilteringLevel=s,this.samplingMode=n,this._comparisonFunction=r,this}compareSampler(e){return this._cachedWrapU===e._cachedWrapU&&this._cachedWrapV===e._cachedWrapV&&this._cachedWrapR===e._cachedWrapR&&this._cachedAnisotropicFilteringLevel===e._cachedAnisotropicFilteringLevel&&this.samplingMode===e.samplingMode&&this._comparisonFunction===e._comparisonFunction&&this._useMipMaps===e._useMipMaps}}!function(e){e[e.Unknown=0]="Unknown",e[e.Url=1]="Url",e[e.Temp=2]="Temp",e[e.Raw=3]="Raw",e[e.Dynamic=4]="Dynamic",e[e.RenderTarget=5]="RenderTarget",e[e.MultiRenderTarget=6]="MultiRenderTarget",e[e.Cube=7]="Cube",e[e.CubeRaw=8]="CubeRaw",e[e.CubePrefiltered=9]="CubePrefiltered",e[e.Raw3D=10]="Raw3D",e[e.Raw2DArray=11]="Raw2DArray",e[e.DepthStencil=12]="DepthStencil",e[e.CubeRawRGBD=13]="CubeRawRGBD",e[e.Depth=14]="Depth"}(s||(s={}));class a extends r{get useMipMaps(){return this.generateMipMaps}set useMipMaps(e){this.generateMipMaps=e}get uniqueId(){return this._uniqueId}_setUniqueId(e){this._uniqueId=e}getEngine(){return this._engine}get source(){return this._source}constructor(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];super(),this.isReady=!1,this.isCube=!1,this.is3D=!1,this.is2DArray=!1,this.isMultiview=!1,this.url="",this.generateMipMaps=!1,this.samples=0,this.type=-1,this.format=-1,this.onLoadedObservable=new n.y$,this.onErrorObservable=new n.y$,this.onRebuildCallback=null,this.width=0,this.height=0,this.depth=0,this.baseWidth=0,this.baseHeight=0,this.baseDepth=0,this.invertY=!1,this._invertVScale=!1,this._associatedChannel=-1,this._source=s.Unknown,this._buffer=null,this._bufferView=null,this._bufferViewArray=null,this._bufferViewArrayArray=null,this._size=0,this._extension="",this._files=null,this._workingCanvas=null,this._workingContext=null,this._cachedCoordinatesMode=null,this._isDisabled=!1,this._compression=null,this._sphericalPolynomial=null,this._sphericalPolynomialPromise=null,this._sphericalPolynomialComputed=!1,this._lodGenerationScale=0,this._lodGenerationOffset=0,this._useSRGBBuffer=!1,this._lodTextureHigh=null,this._lodTextureMid=null,this._lodTextureLow=null,this._isRGBD=!1,this._linearSpecularLOD=!1,this._irradianceTexture=null,this._hardwareTexture=null,this._maxLodLevel=null,this._references=1,this._gammaSpace=null,this._engine=e,this._source=t,this._uniqueId=a._Counter++,i||(this._hardwareTexture=e._createHardwareTexture())}incrementReferences(){this._references++}updateSize(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;this._engine.updateTextureDimensions(this,e,t,i),this.width=e,this.height=t,this.depth=i,this.baseWidth=e,this.baseHeight=t,this.baseDepth=i,this._size=e*t*i}_rebuild(){var e;if(this.isReady=!1,this._cachedCoordinatesMode=null,this._cachedWrapU=null,this._cachedWrapV=null,this._cachedWrapR=null,this._cachedAnisotropicFilteringLevel=null,this.onRebuildCallback){const e=this.onRebuildCallback(this),t=t=>{t._swapAndDie(this,!1),this.isReady=e.isReady};return void(e.isAsync?e.proxy.then(t):t(e.proxy))}let t;switch(this.source){case s.Temp:break;case s.Url:return void(t=this._engine.createTexture(null!==(e=this._originalUrl)&&void 0!==e?e:this.url,!this.generateMipMaps,this.invertY,null,this.samplingMode,(e=>{e._swapAndDie(this,!1),this.isReady=!0}),null,this._buffer,void 0,this.format,this._extension,void 0,void 0,void 0,this._useSRGBBuffer));case s.Raw:t=this._engine.createRawTexture(this._bufferView,this.baseWidth,this.baseHeight,this.format,this.generateMipMaps,this.invertY,this.samplingMode,this._compression,this.type,void 0,this._useSRGBBuffer),t._swapAndDie(this,!1),this.isReady=!0;break;case s.Raw3D:t=this._engine.createRawTexture3D(this._bufferView,this.baseWidth,this.baseHeight,this.baseDepth,this.format,this.generateMipMaps,this.invertY,this.samplingMode,this._compression,this.type),t._swapAndDie(this,!1),this.isReady=!0;break;case s.Raw2DArray:t=this._engine.createRawTexture2DArray(this._bufferView,this.baseWidth,this.baseHeight,this.baseDepth,this.format,this.generateMipMaps,this.invertY,this.samplingMode,this._compression,this.type),t._swapAndDie(this,!1),this.isReady=!0;break;case s.Dynamic:t=this._engine.createDynamicTexture(this.baseWidth,this.baseHeight,this.generateMipMaps,this.samplingMode),t._swapAndDie(this,!1),this._engine.updateDynamicTexture(this,this._engine.getRenderingCanvas(),this.invertY,void 0,void 0,!0);break;case s.Cube:return void(t=this._engine.createCubeTexture(this.url,null,this._files,!this.generateMipMaps,(()=>{t._swapAndDie(this,!1),this.isReady=!0}),null,this.format,this._extension,!1,0,0,null,void 0,this._useSRGBBuffer));case s.CubeRaw:t=this._engine.createRawCubeTexture(this._bufferViewArray,this.width,this.format,this.type,this.generateMipMaps,this.invertY,this.samplingMode,this._compression),t._swapAndDie(this,!1),this.isReady=!0;break;case s.CubeRawRGBD:return;case s.CubePrefiltered:return t=this._engine.createPrefilteredCubeTexture(this.url,null,this._lodGenerationScale,this._lodGenerationOffset,(e=>{e&&e._swapAndDie(this,!1),this.isReady=!0}),null,this.format,this._extension),void(t._sphericalPolynomial=this._sphericalPolynomial)}}_swapAndDie(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];var i;null===(i=this._hardwareTexture)||void 0===i||i.setUsage(e._source,this.generateMipMaps,this.isCube,this.width,this.height),e._hardwareTexture=this._hardwareTexture,t&&(e._isRGBD=this._isRGBD),this._lodTextureHigh&&(e._lodTextureHigh&&e._lodTextureHigh.dispose(),e._lodTextureHigh=this._lodTextureHigh),this._lodTextureMid&&(e._lodTextureMid&&e._lodTextureMid.dispose(),e._lodTextureMid=this._lodTextureMid),this._lodTextureLow&&(e._lodTextureLow&&e._lodTextureLow.dispose(),e._lodTextureLow=this._lodTextureLow),this._irradianceTexture&&(e._irradianceTexture&&e._irradianceTexture.dispose(),e._irradianceTexture=this._irradianceTexture);const s=this._engine.getLoadedTexturesCache();let n=s.indexOf(this);-1!==n&&s.splice(n,1),n=s.indexOf(e),-1===n&&s.push(e)}dispose(){this._references--,this.onLoadedObservable.clear(),this.onErrorObservable.clear(),0===this._references&&(this._engine._releaseTexture(this),this._hardwareTexture=null)}}a._Counter=0},1401:function(e,t,i){"use strict";function s(e){-1===e.indexOf("vClipPlane")&&e.push("vClipPlane"),-1===e.indexOf("vClipPlane2")&&e.push("vClipPlane2"),-1===e.indexOf("vClipPlane3")&&e.push("vClipPlane3"),-1===e.indexOf("vClipPlane4")&&e.push("vClipPlane4"),-1===e.indexOf("vClipPlane5")&&e.push("vClipPlane5"),-1===e.indexOf("vClipPlane6")&&e.push("vClipPlane6")}function n(e,t,i){var s,n,r,a,l,h;let c=!1,u=null!==(s=e.clipPlane)&&void 0!==s?s:t.clipPlane;return c=o(u,i,"CLIPPLANE","#define CLIPPLANE")||c,u=null!==(n=e.clipPlane2)&&void 0!==n?n:t.clipPlane2,c=o(u,i,"CLIPPLANE2","#define CLIPPLANE2")||c,u=null!==(r=e.clipPlane3)&&void 0!==r?r:t.clipPlane3,c=o(u,i,"CLIPPLANE3","#define CLIPPLANE3")||c,u=null!==(a=e.clipPlane4)&&void 0!==a?a:t.clipPlane4,c=o(u,i,"CLIPPLANE4","#define CLIPPLANE4")||c,u=null!==(l=e.clipPlane5)&&void 0!==l?l:t.clipPlane5,c=o(u,i,"CLIPPLANE5","#define CLIPPLANE5")||c,u=null!==(h=e.clipPlane6)&&void 0!==h?h:t.clipPlane6,c=o(u,i,"CLIPPLANE6","#define CLIPPLANE6")||c,c}function r(e,t,i){var s,n,r,o,l,h;let c=null!==(s=t.clipPlane)&&void 0!==s?s:i.clipPlane;a(e,"vClipPlane",c),c=null!==(n=t.clipPlane2)&&void 0!==n?n:i.clipPlane2,a(e,"vClipPlane2",c),c=null!==(r=t.clipPlane3)&&void 0!==r?r:i.clipPlane3,a(e,"vClipPlane3",c),c=null!==(o=t.clipPlane4)&&void 0!==o?o:i.clipPlane4,a(e,"vClipPlane4",c),c=null!==(l=t.clipPlane5)&&void 0!==l?l:i.clipPlane5,a(e,"vClipPlane5",c),c=null!==(h=t.clipPlane6)&&void 0!==h?h:i.clipPlane6,a(e,"vClipPlane6",c)}function a(e,t,i){i&&e.setFloat4(t,i.normal.x,i.normal.y,i.normal.z,i.d)}function o(e,t,i,s){const n=!!e;let r;if(Array.isArray(t)){const i=t.indexOf(s);r=-1!==i,!r&&e?t.push(s):r&&!e&&t.splice(i,1)}else r=t[i],t[i]=n;return r!==n}i.d(t,{AN:function(){return n},an:function(){return r},qx:function(){return s}})},8618:function(e,t,i){"use strict";i.d(t,{q:function(){return s}});class s{static IsWrapper(e){return void 0===e.getPipelineContext}static GetEffect(e){return void 0===e.getPipelineContext?e.effect:e}constructor(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.effect=null,this.defines=null,this.drawContext=e.createDrawContext(),t&&(this.materialContext=e.createMaterialContext())}setEffect(e,t){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];var s;this.effect=e,void 0!==t&&(this.defines=t),i&&(null===(s=this.drawContext)||void 0===s||s.reset())}dispose(){var e;null===(e=this.drawContext)||void 0===e||e.dispose()}}},8977:function(e,t,i){"use strict";i.d(t,{Q:function(){return h}});var s=i(4174),n=i(5092),r=i(2328),a=i(9776),o=i(8084),l=i(2223);class h{static get ShadersRepository(){return o.v.ShadersRepository}static set ShadersRepository(e){o.v.ShadersRepository=e}get onBindObservable(){return this._onBindObservable||(this._onBindObservable=new s.y$),this._onBindObservable}constructor(e,t,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,c=arguments.length>4?arguments[4]:void 0,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,d=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,f=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,p=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,g=arguments.length>9?arguments[9]:void 0,m=arguments.length>10&&void 0!==arguments[10]?arguments[10]:"",_=arguments.length>11&&void 0!==arguments[11]?arguments[11]:l.x.GLSL;var v,b,E;let y;this.name=null,this.defines="",this.onCompiled=null,this.onError=null,this.onBind=null,this.uniqueId=0,this.onCompileObservable=new s.y$,this.onErrorObservable=new s.y$,this._onBindObservable=null,this._wasPreviouslyReady=!1,this._forceRebindOnNextCall=!1,this._wasPreviouslyUsingInstances=null,this._isDisposed=!1,this._bonesComputationForcedToCPU=!1,this._uniformBuffersNames={},this._multiTarget=!1,this._samplers={},this._isReady=!1,this._compilationError="",this._allFallbacksProcessed=!1,this._uniforms={},this._key="",this._fallbacks=null,this._vertexSourceCodeOverride="",this._fragmentSourceCodeOverride="",this._transformFeedbackVaryings=null,this._pipelineContext=null,this._vertexSourceCode="",this._fragmentSourceCode="",this._vertexSourceCodeBeforeMigration="",this._fragmentSourceCodeBeforeMigration="",this._rawVertexSourceCode="",this._rawFragmentSourceCode="",this.name=e,this._key=m;let M,T,A=null;if(t.attributes){const e=t;if(this._engine=i,this._attributesNames=e.attributes,this._uniformsNames=e.uniformsNames.concat(e.samplers),this._samplerList=e.samplers.slice(),this.defines=e.defines,this.onError=e.onError,this.onCompiled=e.onCompiled,this._fallbacks=e.fallbacks,this._indexParameters=e.indexParameters,this._transformFeedbackVaryings=e.transformFeedbackVaryings||null,this._multiTarget=!!e.multiTarget,this._shaderLanguage=null!==(v=e.shaderLanguage)&&void 0!==v?v:l.x.GLSL,e.uniformBuffersNames){this._uniformBuffersNamesList=e.uniformBuffersNames.slice();for(let t=0;t<e.uniformBuffersNames.length;t++)this._uniformBuffersNames[e.uniformBuffersNames[t]]=t}A=null!==(b=e.processFinalCode)&&void 0!==b?b:null,y=null!==(E=e.processCodeAfterIncludes)&&void 0!==E?E:void 0}else this._engine=c,this.defines=null==u?"":u,this._uniformsNames=i.concat(r),this._samplerList=r?r.slice():[],this._attributesNames=t,this._uniformBuffersNamesList=[],this._shaderLanguage=_,this.onError=p,this.onCompiled=f,this._indexParameters=g,this._fallbacks=d;this._attributeLocationByName={},this.uniqueId=h._UniqueIdSeed++;const S=(0,n.CG)()?this._engine.getHostDocument():null;e.vertexSource?M="source:"+e.vertexSource:e.vertexElement?(M=S?S.getElementById(e.vertexElement):null,M||(M=e.vertexElement)):M=e.vertex||e,e.fragmentSource?T="source:"+e.fragmentSource:e.fragmentElement?(T=S?S.getElementById(e.fragmentElement):null,T||(T=e.fragmentElement)):T=e.fragment||e,this._processingContext=this._engine._getShaderProcessingContext(this._shaderLanguage);let I={defines:this.defines.split("\n"),indexParameters:this._indexParameters,isFragment:!1,shouldUseHighPrecisionShader:this._engine._shouldUseHighPrecisionShader,processor:this._engine._getShaderProcessor(this._shaderLanguage),supportsUniformBuffers:this._engine.supportsUniformBuffers,shadersRepository:o.v.GetShadersRepository(this._shaderLanguage),includesShadersStore:o.v.GetIncludesShadersStore(this._shaderLanguage),version:(100*this._engine.version).toString(),platformName:this._engine.shaderPlatformName,processingContext:this._processingContext,isNDCHalfZRange:this._engine.isNDCHalfZRange,useReverseDepthBuffer:this._engine.useReverseDepthBuffer,processCodeAfterIncludes:y};const C=[void 0,void 0],D=()=>{if(C[0]&&C[1]){I.isFragment=!0;const[t,i]=C;a.L.Process(i,I,((i,s)=>{this._fragmentSourceCodeBeforeMigration=s,A&&(i=A("fragment",i));const n=a.L.Finalize(t,i,I);I=null,this._useFinalCode(n.vertexCode,n.fragmentCode,e)}),this._engine)}};this._loadShader(M,"Vertex","",(e=>{a.L.Initialize(I),a.L.Process(e,I,((t,i)=>{this._rawVertexSourceCode=e,this._vertexSourceCodeBeforeMigration=i,A&&(t=A("vertex",t)),C[0]=t,D()}),this._engine)})),this._loadShader(T,"Fragment","Pixel",(e=>{this._rawFragmentSourceCode=e,C[1]=e,D()}));const P=function(e){return function(){if(this._pipelineContext){this._pipelineContext[e].apply(this._pipelineContext,arguments)}return this}};["Int?","UInt?","IntArray?","UIntArray?","Array?","Color?","Vector?","Float?","Matrices","Matrix","Matrix3x3","Matrix2x2","Quaternion","DirectColor4"].forEach((e=>{const t="set".concat(e);t.endsWith("?")?["",2,3,4].forEach((e=>{this[t.slice(0,-1)+e]=this[t.slice(0,-1)+e]||P(t.slice(0,-1)+e).bind(this)})):this[t]=this[t]||P(t).bind(this)}))}_useFinalCode(e,t,i){if(i){const s=i.vertexElement||i.vertex||i.spectorName||i,n=i.fragmentElement||i.fragment||i.spectorName||i;this._vertexSourceCode=(this._shaderLanguage===l.x.WGSL?"//":"")+"#define SHADER_NAME vertex:"+s+"\n"+e,this._fragmentSourceCode=(this._shaderLanguage===l.x.WGSL?"//":"")+"#define SHADER_NAME fragment:"+n+"\n"+t}else this._vertexSourceCode=e,this._fragmentSourceCode=t;this._prepareEffect()}get key(){return this._key}isReady(){try{return this._isReadyInternal()}catch(e){return!1}}_isReadyInternal(){return!!this._isReady||!!this._pipelineContext&&this._pipelineContext.isReady}getEngine(){return this._engine}getPipelineContext(){return this._pipelineContext}getAttributesNames(){return this._attributesNames}getAttributeLocation(e){return this._attributes[e]}getAttributeLocationByName(e){return this._attributeLocationByName[e]}getAttributesCount(){return this._attributes.length}getUniformIndex(e){return this._uniformsNames.indexOf(e)}getUniform(e){return this._uniforms[e]}getSamplers(){return this._samplerList}getUniformNames(){return this._uniformsNames}getUniformBuffersNames(){return this._uniformBuffersNamesList}getIndexParameters(){return this._indexParameters}getCompilationError(){return this._compilationError}allFallbacksProcessed(){return this._allFallbacksProcessed}executeWhenCompiled(e){this.isReady()?e(this):(this.onCompileObservable.add((t=>{e(t)})),this._pipelineContext&&!this._pipelineContext.isAsync||setTimeout((()=>{this._checkIsReady(null)}),16))}_checkIsReady(e){try{if(this._isReadyInternal())return}catch(t){return void this._processCompilationErrors(t,e)}this._isDisposed||setTimeout((()=>{this._checkIsReady(e)}),16)}_loadShader(e,t,i,s){if("undefined"!=typeof HTMLElement&&e instanceof HTMLElement){return void s((0,n.v)(e))}if("source:"===e.substr(0,7))return void s(e.substr(7));if("base64:"===e.substr(0,7)){return void s(window.atob(e.substr(7)))}const r=o.v.GetShadersStore(this._shaderLanguage);if(r[e+t+"Shader"])return void s(r[e+t+"Shader"]);if(i&&r[e+i+"Shader"])return void s(r[e+i+"Shader"]);let a;a="."===e[0]||"/"===e[0]||e.indexOf("http")>-1?e:o.v.GetShadersRepository(this._shaderLanguage)+e,this._engine._loadFile(a+"."+t.toLowerCase()+".fx",s)}get vertexSourceCode(){var e,t;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._vertexSourceCodeOverride:null!==(t=null===(e=this._pipelineContext)||void 0===e?void 0:e._getVertexShaderCode())&&void 0!==t?t:this._vertexSourceCode}get fragmentSourceCode(){var e,t;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._fragmentSourceCodeOverride:null!==(t=null===(e=this._pipelineContext)||void 0===e?void 0:e._getFragmentShaderCode())&&void 0!==t?t:this._fragmentSourceCode}get vertexSourceCodeBeforeMigration(){return this._vertexSourceCodeBeforeMigration}get fragmentSourceCodeBeforeMigration(){return this._fragmentSourceCodeBeforeMigration}get rawVertexSourceCode(){return this._rawVertexSourceCode}get rawFragmentSourceCode(){return this._rawFragmentSourceCode}_rebuildProgram(e,t,i,s){this._isReady=!1,this._vertexSourceCodeOverride=e,this._fragmentSourceCodeOverride=t,this.onError=(e,t)=>{s&&s(t)},this.onCompiled=()=>{const e=this.getEngine().scenes;if(e)for(let t=0;t<e.length;t++)e[t].markAllMaterialsAsDirty(63);this._pipelineContext._handlesSpectorRebuildCallback(i)},this._fallbacks=null,this._prepareEffect()}_prepareEffect(){const e=this._attributesNames,t=this.defines,i=this._pipelineContext;this._isReady=!1;try{const s=this._engine;this._pipelineContext=s.createPipelineContext(this._processingContext),this._pipelineContext._name=this._key;const n=this._rebuildProgram.bind(this);this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?s._preparePipelineContext(this._pipelineContext,this._vertexSourceCodeOverride,this._fragmentSourceCodeOverride,!0,this._rawVertexSourceCode,this._rawFragmentSourceCode,n,null,this._transformFeedbackVaryings,this._key):s._preparePipelineContext(this._pipelineContext,this._vertexSourceCode,this._fragmentSourceCode,!1,this._rawVertexSourceCode,this._rawFragmentSourceCode,n,t,this._transformFeedbackVaryings,this._key),s._executeWhenRenderingStateIsCompiled(this._pipelineContext,(()=>{if(this._attributes=[],this._pipelineContext._fillEffectInformation(this,this._uniformBuffersNames,this._uniformsNames,this._uniforms,this._samplerList,this._samplers,e,this._attributes),e)for(let t=0;t<e.length;t++){const i=e[t];this._attributeLocationByName[i]=this._attributes[t]}s.bindSamplers(this),this._compilationError="",this._isReady=!0,this.onCompiled&&this.onCompiled(this),this.onCompileObservable.notifyObservers(this),this.onCompileObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh(),i&&this.getEngine()._deletePipelineContext(i)})),this._pipelineContext.isAsync&&this._checkIsReady(i)}catch(s){this._processCompilationErrors(s,i)}}_getShaderCodeAndErrorLine(e,t,i){const s=i?/FRAGMENT SHADER ERROR: 0:(\d+?):/:/VERTEX SHADER ERROR: 0:(\d+?):/;let n=null;if(t&&e){const r=t.match(s);if(r&&2===r.length){const t=parseInt(r[1]),s=e.split("\n",-1);s.length>=t&&(n="Offending line [".concat(t,"] in ").concat(i?"fragment":"vertex"," code: ").concat(s[t-1]))}}return[e,n]}_processCompilationErrors(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;var i,s,n;this._compilationError=e.message;const a=this._attributesNames,o=this._fallbacks;if(r.Y.Error("Unable to compile effect:"),r.Y.Error("Uniforms: "+this._uniformsNames.map((function(e){return" "+e}))),r.Y.Error("Attributes: "+a.map((function(e){return" "+e}))),r.Y.Error("Defines:\r\n"+this.defines),h.LogShaderCodeOnCompilationError){let e=null,t=null,a=null;(null===(i=this._pipelineContext)||void 0===i?void 0:i._getVertexShaderCode())&&([a,e]=this._getShaderCodeAndErrorLine(this._pipelineContext._getVertexShaderCode(),this._compilationError,!1),a&&(r.Y.Error("Vertex code:"),r.Y.Error(a))),(null===(s=this._pipelineContext)||void 0===s?void 0:s._getFragmentShaderCode())&&([a,t]=this._getShaderCodeAndErrorLine(null===(n=this._pipelineContext)||void 0===n?void 0:n._getFragmentShaderCode(),this._compilationError,!0),a&&(r.Y.Error("Fragment code:"),r.Y.Error(a))),e&&r.Y.Error(e),t&&r.Y.Error(t)}r.Y.Error("Error: "+this._compilationError);const l=()=>{this.onError&&this.onError(this,this._compilationError),this.onErrorObservable.notifyObservers(this)};t&&(this._pipelineContext=t,this._isReady=!0,l()),o?(this._pipelineContext=null,o.hasMoreFallbacks?(this._allFallbacksProcessed=!1,r.Y.Error("Trying next fallback."),this.defines=o.reduce(this.defines,this),this._prepareEffect()):(this._allFallbacksProcessed=!0,l(),this.onErrorObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh())):(this._allFallbacksProcessed=!0,t||l())}get isSupported(){return""===this._compilationError}_bindTexture(e,t){this._engine._bindTexture(this._samplers[e],t,e)}setTexture(e,t){this._engine.setTexture(this._samplers[e],this._uniforms[e],t,e)}setDepthStencilTexture(e,t){this._engine.setDepthStencilTexture(this._samplers[e],this._uniforms[e],t,e)}setTextureArray(e,t){const i=e+"Ex";if(-1===this._samplerList.indexOf(i+"0")){const s=this._samplerList.indexOf(e);for(let e=1;e<t.length;e++){const t=i+(e-1).toString();this._samplerList.splice(s+e,0,t)}let n=0;for(const e of this._samplerList)this._samplers[e]=n,n+=1}this._engine.setTextureArray(this._samplers[e],this._uniforms[e],t,e)}setTextureFromPostProcess(e,t){this._engine.setTextureFromPostProcess(this._samplers[e],t,e)}setTextureFromPostProcessOutput(e,t){this._engine.setTextureFromPostProcessOutput(this._samplers[e],t,e)}bindUniformBuffer(e,t){const i=this._uniformBuffersNames[t];void 0===i||h._BaseCache[i]===e&&this._engine._features.useUBOBindingCache||(h._BaseCache[i]=e,this._engine.bindUniformBufferBase(e,i,t))}bindUniformBlock(e,t){this._engine.bindUniformBlock(this._pipelineContext,e,t)}setFloatArray(e,t){return this._pipelineContext.setArray(e,t),this}setFloatArray2(e,t){return this._pipelineContext.setArray2(e,t),this}setFloatArray3(e,t){return this._pipelineContext.setArray3(e,t),this}setFloatArray4(e,t){return this._pipelineContext.setArray4(e,t),this}setBool(e,t){return this._pipelineContext.setInt(e,t?1:0),this}dispose(){var e;null===(e=this._pipelineContext)||void 0===e||e.dispose(),this._engine._releaseEffect(this),this._isDisposed=!0}static RegisterShader(e,t,i){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:l.x.GLSL;t&&(o.v.GetShadersStore(s)["".concat(e,"PixelShader")]=t),i&&(o.v.GetShadersStore(s)["".concat(e,"VertexShader")]=i)}static ResetCache(){h._BaseCache={}}}h.LogShaderCodeOnCompilationError=!0,h._UniqueIdSeed=0,h._BaseCache={},h.ShadersStore=o.v.ShadersStore,h.IncludesShadersStore=o.v.IncludesShadersStore},7823:function(e,t,i){"use strict";i.d(t,{$:function(){return h}});var s=i(9477),n=i(9336),r=i(4174),a=i(8517),o=i(7046);i(4771);class l{constructor(){this._dirty=!0,this._tempColor=new o.HE(0,0,0,0),this._globalCurve=new o.HE(0,0,0,0),this._highlightsCurve=new o.HE(0,0,0,0),this._midtonesCurve=new o.HE(0,0,0,0),this._shadowsCurve=new o.HE(0,0,0,0),this._positiveCurve=new o.HE(0,0,0,0),this._negativeCurve=new o.HE(0,0,0,0),this._globalHue=30,this._globalDensity=0,this._globalSaturation=0,this._globalExposure=0,this._highlightsHue=30,this._highlightsDensity=0,this._highlightsSaturation=0,this._highlightsExposure=0,this._midtonesHue=30,this._midtonesDensity=0,this._midtonesSaturation=0,this._midtonesExposure=0,this._shadowsHue=30,this._shadowsDensity=0,this._shadowsSaturation=0,this._shadowsExposure=0}get globalHue(){return this._globalHue}set globalHue(e){this._globalHue=e,this._dirty=!0}get globalDensity(){return this._globalDensity}set globalDensity(e){this._globalDensity=e,this._dirty=!0}get globalSaturation(){return this._globalSaturation}set globalSaturation(e){this._globalSaturation=e,this._dirty=!0}get globalExposure(){return this._globalExposure}set globalExposure(e){this._globalExposure=e,this._dirty=!0}get highlightsHue(){return this._highlightsHue}set highlightsHue(e){this._highlightsHue=e,this._dirty=!0}get highlightsDensity(){return this._highlightsDensity}set highlightsDensity(e){this._highlightsDensity=e,this._dirty=!0}get highlightsSaturation(){return this._highlightsSaturation}set highlightsSaturation(e){this._highlightsSaturation=e,this._dirty=!0}get highlightsExposure(){return this._highlightsExposure}set highlightsExposure(e){this._highlightsExposure=e,this._dirty=!0}get midtonesHue(){return this._midtonesHue}set midtonesHue(e){this._midtonesHue=e,this._dirty=!0}get midtonesDensity(){return this._midtonesDensity}set midtonesDensity(e){this._midtonesDensity=e,this._dirty=!0}get midtonesSaturation(){return this._midtonesSaturation}set midtonesSaturation(e){this._midtonesSaturation=e,this._dirty=!0}get midtonesExposure(){return this._midtonesExposure}set midtonesExposure(e){this._midtonesExposure=e,this._dirty=!0}get shadowsHue(){return this._shadowsHue}set shadowsHue(e){this._shadowsHue=e,this._dirty=!0}get shadowsDensity(){return this._shadowsDensity}set shadowsDensity(e){this._shadowsDensity=e,this._dirty=!0}get shadowsSaturation(){return this._shadowsSaturation}set shadowsSaturation(e){this._shadowsSaturation=e,this._dirty=!0}get shadowsExposure(){return this._shadowsExposure}set shadowsExposure(e){this._shadowsExposure=e,this._dirty=!0}getClassName(){return"ColorCurves"}static Bind(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"vCameraColorCurvePositive",s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"vCameraColorCurveNeutral",n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"vCameraColorCurveNegative";e._dirty&&(e._dirty=!1,e._getColorGradingDataToRef(e._globalHue,e._globalDensity,e._globalSaturation,e._globalExposure,e._globalCurve),e._getColorGradingDataToRef(e._highlightsHue,e._highlightsDensity,e._highlightsSaturation,e._highlightsExposure,e._tempColor),e._tempColor.multiplyToRef(e._globalCurve,e._highlightsCurve),e._getColorGradingDataToRef(e._midtonesHue,e._midtonesDensity,e._midtonesSaturation,e._midtonesExposure,e._tempColor),e._tempColor.multiplyToRef(e._globalCurve,e._midtonesCurve),e._getColorGradingDataToRef(e._shadowsHue,e._shadowsDensity,e._shadowsSaturation,e._shadowsExposure,e._tempColor),e._tempColor.multiplyToRef(e._globalCurve,e._shadowsCurve),e._highlightsCurve.subtractToRef(e._midtonesCurve,e._positiveCurve),e._midtonesCurve.subtractToRef(e._shadowsCurve,e._negativeCurve)),t&&(t.setFloat4(i,e._positiveCurve.r,e._positiveCurve.g,e._positiveCurve.b,e._positiveCurve.a),t.setFloat4(s,e._midtonesCurve.r,e._midtonesCurve.g,e._midtonesCurve.b,e._midtonesCurve.a),t.setFloat4(n,e._negativeCurve.r,e._negativeCurve.g,e._negativeCurve.b,e._negativeCurve.a))}static PrepareUniforms(e){e.push("vCameraColorCurveNeutral","vCameraColorCurvePositive","vCameraColorCurveNegative")}_getColorGradingDataToRef(e,t,i,s,n){null!=e&&(e=l._Clamp(e,0,360),t=l._Clamp(t,-100,100),i=l._Clamp(i,-100,100),s=l._Clamp(s,-100,100),t=l._ApplyColorGradingSliderNonlinear(t),t*=.5,s=l._ApplyColorGradingSliderNonlinear(s),t<0&&(t*=-1,e=(e+180)%360),l._FromHSBToRef(e,t,50+.25*s,n),n.scaleToRef(2,n),n.a=1+.01*i)}static _ApplyColorGradingSliderNonlinear(e){e/=100;let t=Math.abs(e);return t=Math.pow(t,2),e<0&&(t*=-1),t*=100,t}static _FromHSBToRef(e,t,i,s){let n=l._Clamp(e,0,360);const r=l._Clamp(t/100,0,1),a=l._Clamp(i/100,0,1);if(0===r)s.r=a,s.g=a,s.b=a;else{n/=60;const e=Math.floor(n),t=n-e,i=a*(1-r),o=a*(1-r*t),l=a*(1-r*(1-t));switch(e){case 0:s.r=a,s.g=l,s.b=i;break;case 1:s.r=o,s.g=a,s.b=i;break;case 2:s.r=i,s.g=a,s.b=l;break;case 3:s.r=i,s.g=o,s.b=a;break;case 4:s.r=l,s.g=i,s.b=a;break;default:s.r=a,s.g=i,s.b=o}}s.a=1}static _Clamp(e,t,i){return Math.min(Math.max(e,t),i)}clone(){return n.p4.Clone((()=>new l),this)}serialize(){return n.p4.Serialize(this)}static Parse(e){return n.p4.Parse((()=>new l),e,null,null)}}(0,s.gn)([(0,n.qC)()],l.prototype,"_globalHue",void 0),(0,s.gn)([(0,n.qC)()],l.prototype,"_globalDensity",void 0),(0,s.gn)([(0,n.qC)()],l.prototype,"_globalSaturation",void 0),(0,s.gn)([(0,n.qC)()],l.prototype,"_globalExposure",void 0),(0,s.gn)([(0,n.qC)()],l.prototype,"_highlightsHue",void 0),(0,s.gn)([(0,n.qC)()],l.prototype,"_highlightsDensity",void 0),(0,s.gn)([(0,n.qC)()],l.prototype,"_highlightsSaturation",void 0),(0,s.gn)([(0,n.qC)()],l.prototype,"_highlightsExposure",void 0),(0,s.gn)([(0,n.qC)()],l.prototype,"_midtonesHue",void 0),(0,s.gn)([(0,n.qC)()],l.prototype,"_midtonesDensity",void 0),(0,s.gn)([(0,n.qC)()],l.prototype,"_midtonesSaturation",void 0),(0,s.gn)([(0,n.qC)()],l.prototype,"_midtonesExposure",void 0),n.p4._ColorCurvesParser=l.Parse;class h{constructor(){this.colorCurves=new l,this._colorCurvesEnabled=!1,this._colorGradingEnabled=!1,this._colorGradingWithGreenDepth=!0,this._colorGradingBGR=!0,this._exposure=1,this._toneMappingEnabled=!1,this._toneMappingType=h.TONEMAPPING_STANDARD,this._contrast=1,this.vignetteStretch=0,this.vignetteCenterX=0,this.vignetteCenterY=0,this.vignetteWeight=1.5,this.vignetteColor=new o.HE(0,0,0,0),this.vignetteCameraFov=.5,this._vignetteBlendMode=h.VIGNETTEMODE_MULTIPLY,this._vignetteEnabled=!1,this._ditheringEnabled=!1,this._ditheringIntensity=1/255,this._skipFinalColorClamp=!1,this._applyByPostProcess=!1,this._isEnabled=!0,this.onUpdateParameters=new r.y$}get colorCurvesEnabled(){return this._colorCurvesEnabled}set colorCurvesEnabled(e){this._colorCurvesEnabled!==e&&(this._colorCurvesEnabled=e,this._updateParameters())}get colorGradingTexture(){return this._colorGradingTexture}set colorGradingTexture(e){this._colorGradingTexture!==e&&(this._colorGradingTexture=e,this._updateParameters())}get colorGradingEnabled(){return this._colorGradingEnabled}set colorGradingEnabled(e){this._colorGradingEnabled!==e&&(this._colorGradingEnabled=e,this._updateParameters())}get colorGradingWithGreenDepth(){return this._colorGradingWithGreenDepth}set colorGradingWithGreenDepth(e){this._colorGradingWithGreenDepth!==e&&(this._colorGradingWithGreenDepth=e,this._updateParameters())}get colorGradingBGR(){return this._colorGradingBGR}set colorGradingBGR(e){this._colorGradingBGR!==e&&(this._colorGradingBGR=e,this._updateParameters())}get exposure(){return this._exposure}set exposure(e){this._exposure!==e&&(this._exposure=e,this._updateParameters())}get toneMappingEnabled(){return this._toneMappingEnabled}set toneMappingEnabled(e){this._toneMappingEnabled!==e&&(this._toneMappingEnabled=e,this._updateParameters())}get toneMappingType(){return this._toneMappingType}set toneMappingType(e){this._toneMappingType!==e&&(this._toneMappingType=e,this._updateParameters())}get contrast(){return this._contrast}set contrast(e){this._contrast!==e&&(this._contrast=e,this._updateParameters())}get vignetteCentreY(){return this.vignetteCenterY}set vignetteCentreY(e){this.vignetteCenterY=e}get vignetteCentreX(){return this.vignetteCenterX}set vignetteCentreX(e){this.vignetteCenterX=e}get vignetteBlendMode(){return this._vignetteBlendMode}set vignetteBlendMode(e){this._vignetteBlendMode!==e&&(this._vignetteBlendMode=e,this._updateParameters())}get vignetteEnabled(){return this._vignetteEnabled}set vignetteEnabled(e){this._vignetteEnabled!==e&&(this._vignetteEnabled=e,this._updateParameters())}get ditheringEnabled(){return this._ditheringEnabled}set ditheringEnabled(e){this._ditheringEnabled!==e&&(this._ditheringEnabled=e,this._updateParameters())}get ditheringIntensity(){return this._ditheringIntensity}set ditheringIntensity(e){this._ditheringIntensity!==e&&(this._ditheringIntensity=e,this._updateParameters())}get skipFinalColorClamp(){return this._skipFinalColorClamp}set skipFinalColorClamp(e){this._skipFinalColorClamp!==e&&(this._skipFinalColorClamp=e,this._updateParameters())}get applyByPostProcess(){return this._applyByPostProcess}set applyByPostProcess(e){this._applyByPostProcess!==e&&(this._applyByPostProcess=e,this._updateParameters())}get isEnabled(){return this._isEnabled}set isEnabled(e){this._isEnabled!==e&&(this._isEnabled=e,this._updateParameters())}_updateParameters(){this.onUpdateParameters.notifyObservers(this)}getClassName(){return"ImageProcessingConfiguration"}static PrepareUniforms(e,t){t.EXPOSURE&&e.push("exposureLinear"),t.CONTRAST&&e.push("contrast"),t.COLORGRADING&&e.push("colorTransformSettings"),(t.VIGNETTE||t.DITHER)&&e.push("vInverseScreenSize"),t.VIGNETTE&&(e.push("vignetteSettings1"),e.push("vignetteSettings2")),t.COLORCURVES&&l.PrepareUniforms(e),t.DITHER&&e.push("ditherIntensity")}static PrepareSamplers(e,t){t.COLORGRADING&&e.push("txColorTransform")}prepareDefines(e){if((arguments.length>1&&void 0!==arguments[1]&&arguments[1])!==this.applyByPostProcess||!this._isEnabled)return e.VIGNETTE=!1,e.TONEMAPPING=!1,e.TONEMAPPING_ACES=!1,e.CONTRAST=!1,e.EXPOSURE=!1,e.COLORCURVES=!1,e.COLORGRADING=!1,e.COLORGRADING3D=!1,e.DITHER=!1,e.IMAGEPROCESSING=!1,e.SKIPFINALCOLORCLAMP=this.skipFinalColorClamp,void(e.IMAGEPROCESSINGPOSTPROCESS=this.applyByPostProcess&&this._isEnabled);if(e.VIGNETTE=this.vignetteEnabled,e.VIGNETTEBLENDMODEMULTIPLY=this.vignetteBlendMode===h._VIGNETTEMODE_MULTIPLY,e.VIGNETTEBLENDMODEOPAQUE=!e.VIGNETTEBLENDMODEMULTIPLY,e.TONEMAPPING=this.toneMappingEnabled,this._toneMappingType===h.TONEMAPPING_ACES)e.TONEMAPPING_ACES=!0;else e.TONEMAPPING_ACES=!1;e.CONTRAST=1!==this.contrast,e.EXPOSURE=1!==this.exposure,e.COLORCURVES=this.colorCurvesEnabled&&!!this.colorCurves,e.COLORGRADING=this.colorGradingEnabled&&!!this.colorGradingTexture,e.COLORGRADING?e.COLORGRADING3D=this.colorGradingTexture.is3D:e.COLORGRADING3D=!1,e.SAMPLER3DGREENDEPTH=this.colorGradingWithGreenDepth,e.SAMPLER3DBGRMAP=this.colorGradingBGR,e.DITHER=this._ditheringEnabled,e.IMAGEPROCESSINGPOSTPROCESS=this.applyByPostProcess,e.SKIPFINALCOLORCLAMP=this.skipFinalColorClamp,e.IMAGEPROCESSING=e.VIGNETTE||e.TONEMAPPING||e.CONTRAST||e.EXPOSURE||e.COLORCURVES||e.COLORGRADING||e.DITHER}isReady(){return!this.colorGradingEnabled||!this.colorGradingTexture||this.colorGradingTexture.isReady()}bind(e,t){if(this._colorCurvesEnabled&&this.colorCurves&&l.Bind(this.colorCurves,e),this._vignetteEnabled||this._ditheringEnabled){const i=1/e.getEngine().getRenderWidth(),s=1/e.getEngine().getRenderHeight();if(e.setFloat2("vInverseScreenSize",i,s),this._ditheringEnabled&&e.setFloat("ditherIntensity",.5*this._ditheringIntensity),this._vignetteEnabled){const n=null!=t?t:s/i;let r=Math.tan(.5*this.vignetteCameraFov),o=r*n;const l=Math.sqrt(o*r);o=a.w1.Mix(o,l,this.vignetteStretch),r=a.w1.Mix(r,l,this.vignetteStretch),e.setFloat4("vignetteSettings1",o,r,-o*this.vignetteCenterX,-r*this.vignetteCenterY);const h=-2*this.vignetteWeight;e.setFloat4("vignetteSettings2",this.vignetteColor.r,this.vignetteColor.g,this.vignetteColor.b,h)}}if(e.setFloat("exposureLinear",this.exposure),e.setFloat("contrast",this.contrast),this.colorGradingTexture){e.setTexture("txColorTransform",this.colorGradingTexture);const t=this.colorGradingTexture.getSize().height;e.setFloat4("colorTransformSettings",(t-1)/t,.5/t,t,this.colorGradingTexture.level)}}clone(){return n.p4.Clone((()=>new h),this)}serialize(){return n.p4.Serialize(this)}static Parse(e){const t=n.p4.Parse((()=>new h),e,null,null);return void 0!==e.vignetteCentreX&&(t.vignetteCenterX=e.vignetteCentreX),void 0!==e.vignetteCentreY&&(t.vignetteCenterY=e.vignetteCentreY),t}static get VIGNETTEMODE_MULTIPLY(){return this._VIGNETTEMODE_MULTIPLY}static get VIGNETTEMODE_OPAQUE(){return this._VIGNETTEMODE_OPAQUE}}h.TONEMAPPING_STANDARD=0,h.TONEMAPPING_ACES=1,h._VIGNETTEMODE_MULTIPLY=0,h._VIGNETTEMODE_OPAQUE=1,(0,s.gn)([(0,n.N$)()],h.prototype,"colorCurves",void 0),(0,s.gn)([(0,n.qC)()],h.prototype,"_colorCurvesEnabled",void 0),(0,s.gn)([(0,n.oU)("colorGradingTexture")],h.prototype,"_colorGradingTexture",void 0),(0,s.gn)([(0,n.qC)()],h.prototype,"_colorGradingEnabled",void 0),(0,s.gn)([(0,n.qC)()],h.prototype,"_colorGradingWithGreenDepth",void 0),(0,s.gn)([(0,n.qC)()],h.prototype,"_colorGradingBGR",void 0),(0,s.gn)([(0,n.qC)()],h.prototype,"_exposure",void 0),(0,s.gn)([(0,n.qC)()],h.prototype,"_toneMappingEnabled",void 0),(0,s.gn)([(0,n.qC)()],h.prototype,"_toneMappingType",void 0),(0,s.gn)([(0,n.qC)()],h.prototype,"_contrast",void 0),(0,s.gn)([(0,n.qC)()],h.prototype,"vignetteStretch",void 0),(0,s.gn)([(0,n.qC)()],h.prototype,"vignetteCenterX",void 0),(0,s.gn)([(0,n.qC)()],h.prototype,"vignetteCenterY",void 0),(0,s.gn)([(0,n.qC)()],h.prototype,"vignetteWeight",void 0),(0,s.gn)([(0,n.XX)()],h.prototype,"vignetteColor",void 0),(0,s.gn)([(0,n.qC)()],h.prototype,"vignetteCameraFov",void 0),(0,s.gn)([(0,n.qC)()],h.prototype,"_vignetteBlendMode",void 0),(0,s.gn)([(0,n.qC)()],h.prototype,"_vignetteEnabled",void 0),(0,s.gn)([(0,n.qC)()],h.prototype,"_ditheringEnabled",void 0),(0,s.gn)([(0,n.qC)()],h.prototype,"_ditheringIntensity",void 0),(0,s.gn)([(0,n.qC)()],h.prototype,"_skipFinalColorClamp",void 0),(0,s.gn)([(0,n.qC)()],h.prototype,"_applyByPostProcess",void 0),(0,s.gn)([(0,n.qC)()],h.prototype,"_isEnabled",void 0),n.p4._ImageProcessingConfigurationParser=h.Parse},6556:function(e,t,i){"use strict";i.d(t,{F:function(){return _}});var s=i(9477),n=i(9336),r=i(8517),a=i(4174),o=i(4198),l=i(65),h=i(1952),c=i(2328),u=i(3683),d=i(2655),f=i(8618);class p{constructor(){this.reset()}reset(){this.enabled=!1,this.mask=255,this.func=519,this.funcRef=1,this.funcMask=255,this.opStencilFail=7680,this.opDepthFail=7680,this.opStencilDepthPass=7681}get func(){return this._func}set func(e){this._func=e}get funcRef(){return this._funcRef}set funcRef(e){this._funcRef=e}get funcMask(){return this._funcMask}set funcMask(e){this._funcMask=e}get opStencilFail(){return this._opStencilFail}set opStencilFail(e){this._opStencilFail=e}get opDepthFail(){return this._opDepthFail}set opDepthFail(e){this._opDepthFail=e}get opStencilDepthPass(){return this._opStencilDepthPass}set opStencilDepthPass(e){this._opStencilDepthPass=e}get mask(){return this._mask}set mask(e){this._mask=e}get enabled(){return this._enabled}set enabled(e){this._enabled=e}getClassName(){return"MaterialStencilState"}copyTo(e){n.p4.Clone((()=>e),this)}serialize(){return n.p4.Serialize(this)}parse(e,t,i){n.p4.Parse((()=>this),e,t,i)}}(0,s.gn)([(0,n.qC)()],p.prototype,"func",null),(0,s.gn)([(0,n.qC)()],p.prototype,"funcRef",null),(0,s.gn)([(0,n.qC)()],p.prototype,"funcMask",null),(0,s.gn)([(0,n.qC)()],p.prototype,"opStencilFail",null),(0,s.gn)([(0,n.qC)()],p.prototype,"opDepthFail",null),(0,s.gn)([(0,n.qC)()],p.prototype,"opStencilDepthPass",null),(0,s.gn)([(0,n.qC)()],p.prototype,"mask",null),(0,s.gn)([(0,n.qC)()],p.prototype,"enabled",null);var g=i(1962),m=i(4071);class _{get canRenderToMRT(){return!1}set alpha(e){if(this._alpha===e)return;const t=this._alpha;this._alpha=e,1!==t&&1!==e||this.markAsDirty(_.MiscDirtyFlag)}get alpha(){return this._alpha}set backFaceCulling(e){this._backFaceCulling!==e&&(this._backFaceCulling=e,this.markAsDirty(_.TextureDirtyFlag))}get backFaceCulling(){return this._backFaceCulling}set cullBackFaces(e){this._cullBackFaces!==e&&(this._cullBackFaces=e,this.markAsDirty(_.TextureDirtyFlag))}get cullBackFaces(){return this._cullBackFaces}get blockDirtyMechanism(){return this._blockDirtyMechanism}set blockDirtyMechanism(e){this._blockDirtyMechanism!==e&&(this._blockDirtyMechanism=e,e||this.markDirty())}atomicMaterialsUpdate(e){this.blockDirtyMechanism=!0;try{e(this)}finally{this.blockDirtyMechanism=!1}}get hasRenderTargetTextures(){return this._eventInfo.hasRenderTargetTextures=!1,this._callbackPluginEventHasRenderTargetTextures(this._eventInfo),this._eventInfo.hasRenderTargetTextures}set onDispose(e){this._onDisposeObserver&&this.onDisposeObservable.remove(this._onDisposeObserver),this._onDisposeObserver=this.onDisposeObservable.add(e)}get onBindObservable(){return this._onBindObservable||(this._onBindObservable=new a.y$),this._onBindObservable}set onBind(e){this._onBindObserver&&this.onBindObservable.remove(this._onBindObserver),this._onBindObserver=this.onBindObservable.add(e)}get onUnBindObservable(){return this._onUnBindObservable||(this._onUnBindObservable=new a.y$),this._onUnBindObservable}get onEffectCreatedObservable(){return this._onEffectCreatedObservable||(this._onEffectCreatedObservable=new a.y$),this._onEffectCreatedObservable}set alphaMode(e){this._alphaMode!==e&&(this._alphaMode=e,this.markAsDirty(_.TextureDirtyFlag))}get alphaMode(){return this._alphaMode}set needDepthPrePass(e){this._needDepthPrePass!==e&&(this._needDepthPrePass=e,this._needDepthPrePass&&(this.checkReadyOnEveryCall=!0))}get needDepthPrePass(){return this._needDepthPrePass}get isPrePassCapable(){return!1}set fogEnabled(e){this._fogEnabled!==e&&(this._fogEnabled=e,this.markAsDirty(_.MiscDirtyFlag))}get fogEnabled(){return this._fogEnabled}get wireframe(){switch(this._fillMode){case _.WireFrameFillMode:case _.LineListDrawMode:case _.LineLoopDrawMode:case _.LineStripDrawMode:return!0}return this._scene.forceWireframe}set wireframe(e){this.fillMode=e?_.WireFrameFillMode:_.TriangleFillMode}get pointsCloud(){switch(this._fillMode){case _.PointFillMode:case _.PointListDrawMode:return!0}return this._scene.forcePointsCloud}set pointsCloud(e){this.fillMode=e?_.PointFillMode:_.TriangleFillMode}get fillMode(){return this._fillMode}set fillMode(e){this._fillMode!==e&&(this._fillMode=e,this.markAsDirty(_.MiscDirtyFlag))}_getDrawWrapper(){return this._drawWrapper}_setDrawWrapper(e){this._drawWrapper=e}constructor(e,t,i){this.shadowDepthWrapper=null,this.allowShaderHotSwapping=!0,this.metadata=null,this.reservedDataStore=null,this.checkReadyOnEveryCall=!1,this.checkReadyOnlyOnce=!1,this.state="",this._alpha=1,this._backFaceCulling=!0,this._cullBackFaces=!0,this._blockDirtyMechanism=!1,this.onCompiled=null,this.onError=null,this.getRenderTargetTextures=null,this.doNotSerialize=!1,this._storeEffectOnSubMeshes=!1,this.animations=null,this.onDisposeObservable=new a.y$,this._onDisposeObserver=null,this._onUnBindObservable=null,this._onBindObserver=null,this._alphaMode=2,this._needDepthPrePass=!1,this.disableDepthWrite=!1,this.disableColorWrite=!1,this.forceDepthWrite=!1,this.depthFunction=0,this.separateCullingPass=!1,this._fogEnabled=!0,this.pointSize=1,this.zOffset=0,this.zOffsetUnits=0,this.stencil=new p,this._useUBO=!1,this._fillMode=_.TriangleFillMode,this._cachedDepthWriteState=!1,this._cachedColorWriteState=!1,this._cachedDepthFunctionState=0,this._indexInSceneMaterialArray=-1,this.meshMap=null,this._parentContainer=null,this._uniformBufferLayoutBuilt=!1,this._eventInfo={},this._callbackPluginEventGeneric=()=>{},this._callbackPluginEventIsReadyForSubMesh=()=>{},this._callbackPluginEventPrepareDefines=()=>{},this._callbackPluginEventPrepareDefinesBeforeAttributes=()=>{},this._callbackPluginEventHardBindForSubMesh=()=>{},this._callbackPluginEventBindForSubMesh=()=>{},this._callbackPluginEventHasRenderTargetTextures=()=>{},this._callbackPluginEventFillRenderTargetTextures=()=>{},this._forceAlphaTest=!1,this._transparencyMode=null,this.name=e;const s=t||o.l.LastCreatedScene;s&&(this._scene=s,this._dirtyCallbacks={},this._dirtyCallbacks[1]=this._markAllSubMeshesAsTexturesDirty.bind(this),this._dirtyCallbacks[2]=this._markAllSubMeshesAsLightsDirty.bind(this),this._dirtyCallbacks[4]=this._markAllSubMeshesAsFresnelDirty.bind(this),this._dirtyCallbacks[8]=this._markAllSubMeshesAsAttributesDirty.bind(this),this._dirtyCallbacks[16]=this._markAllSubMeshesAsMiscDirty.bind(this),this._dirtyCallbacks[32]=this._markAllSubMeshesAsPrePassDirty.bind(this),this._dirtyCallbacks[63]=this._markAllSubMeshesAsAllDirty.bind(this),this.id=e||r.w1.RandomId(),this.uniqueId=this._scene.getUniqueId(),this._materialContext=this._scene.getEngine().createMaterialContext(),this._drawWrapper=new f.q(this._scene.getEngine(),!1),this._drawWrapper.materialContext=this._materialContext,this._scene.useRightHandedSystem?this.sideOrientation=_.ClockWiseSideOrientation:this.sideOrientation=_.CounterClockWiseSideOrientation,this._uniformBuffer=new h.M(this._scene.getEngine(),void 0,void 0,e),this._useUBO=this.getScene().getEngine().supportsUniformBuffers,i||this._scene.addMaterial(this),this._scene.useMaterialMeshMap&&(this.meshMap={}),_.OnEventObservable.notifyObservers(this,m.S.Created))}toString(e){return"Name: "+this.name}getClassName(){return"Material"}get _isMaterial(){return!0}get isFrozen(){return this.checkReadyOnlyOnce}freeze(){this.markDirty(),this.checkReadyOnlyOnce=!0}unfreeze(){this.markDirty(),this.checkReadyOnlyOnce=!1}isReady(e,t){return!0}isReadyForSubMesh(e,t,i){const s=t.materialDefines;return!!s&&(this._eventInfo.isReadyForSubMesh=!0,this._eventInfo.defines=s,this._callbackPluginEventIsReadyForSubMesh(this._eventInfo),this._eventInfo.isReadyForSubMesh)}getEffect(){return this._drawWrapper.effect}getScene(){return this._scene}get transparencyMode(){return this._transparencyMode}set transparencyMode(e){this._transparencyMode!==e&&(this._transparencyMode=e,this._forceAlphaTest=e===_.MATERIAL_ALPHATESTANDBLEND,this._markAllSubMeshesAsTexturesAndMiscDirty())}get _disableAlphaBlending(){return this._transparencyMode===_.MATERIAL_OPAQUE||this._transparencyMode===_.MATERIAL_ALPHATEST}needAlphaBlending(){return!this._disableAlphaBlending&&this.alpha<1}needAlphaBlendingForMesh(e){return e.visibility<1||!this._disableAlphaBlending&&(e.hasVertexAlpha||this.needAlphaBlending())}needAlphaTesting(){return!!this._forceAlphaTest}_shouldTurnAlphaTestOn(e){return!this.needAlphaBlendingForMesh(e)&&this.needAlphaTesting()}getAlphaTestTexture(){return null}markDirty(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=this.getScene().meshes;for(const i of t)if(i.subMeshes)for(const t of i.subMeshes)t.getMaterial()===this&&t.effect&&(t.effect._wasPreviouslyReady=!1,t.effect._wasPreviouslyUsingInstances=null,t.effect._forceRebindOnNextCall=e);e&&this.markAsDirty(_.AllDirtyFlag)}_preBind(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const i=this._scene.getEngine(),s=(null==t?this.sideOrientation:t)===_.ClockWiseSideOrientation;return i.enableEffect(e||this._getDrawWrapper()),i.setState(this.backFaceCulling,this.zOffset,!1,s,this._scene._mirroredCameraPosition?!this.cullBackFaces:this.cullBackFaces,this.stencil,this.zOffsetUnits),s}bind(e,t){}buildUniformLayout(){const e=this._uniformBuffer;this._eventInfo.ubo=e,this._callbackPluginEventGeneric(m.S.PrepareUniformBuffer,this._eventInfo),e.create(),this._uniformBufferLayoutBuilt=!0}bindForSubMesh(e,t,i){const s=i.effect;s&&(this._eventInfo.subMesh=i,this._callbackPluginEventBindForSubMesh(this._eventInfo),s._forceRebindOnNextCall=!1)}bindOnlyWorldMatrix(e){}bindView(e){this._useUBO?this._needToBindSceneUbo=!0:e.setMatrix("view",this.getScene().getViewMatrix())}bindViewProjection(e){this._useUBO?this._needToBindSceneUbo=!0:(e.setMatrix("viewProjection",this.getScene().getTransformMatrix()),e.setMatrix("projection",this.getScene().getProjectionMatrix()))}bindEyePosition(e,t){this._useUBO?this._needToBindSceneUbo=!0:this._scene.bindEyePosition(e,t)}_afterBind(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this._scene._cachedMaterial=this,this._needToBindSceneUbo&&t&&(this._needToBindSceneUbo=!1,d.G.BindSceneUniformBuffer(t,this.getScene().getSceneUniformBuffer()),this._scene.finalizeSceneUbo()),this._scene._cachedVisibility=e?e.visibility:1,this._onBindObservable&&e&&this._onBindObservable.notifyObservers(e),this.disableDepthWrite){const e=this._scene.getEngine();this._cachedDepthWriteState=e.getDepthWrite(),e.setDepthWrite(!1)}if(this.disableColorWrite){const e=this._scene.getEngine();this._cachedColorWriteState=e.getColorWrite(),e.setColorWrite(!1)}if(0!==this.depthFunction){const e=this._scene.getEngine();this._cachedDepthFunctionState=e.getDepthFunction()||0,e.setDepthFunction(this.depthFunction)}}unbind(){if(this._onUnBindObservable&&this._onUnBindObservable.notifyObservers(this),0!==this.depthFunction){this._scene.getEngine().setDepthFunction(this._cachedDepthFunctionState)}if(this.disableDepthWrite){this._scene.getEngine().setDepthWrite(this._cachedDepthWriteState)}if(this.disableColorWrite){this._scene.getEngine().setColorWrite(this._cachedColorWriteState)}}getAnimatables(){return this._eventInfo.animatables=[],this._callbackPluginEventGeneric(m.S.GetAnimatables,this._eventInfo),this._eventInfo.animatables}getActiveTextures(){return this._eventInfo.activeTextures=[],this._callbackPluginEventGeneric(m.S.GetActiveTextures,this._eventInfo),this._eventInfo.activeTextures}hasTexture(e){return this._eventInfo.hasTexture=!1,this._eventInfo.texture=e,this._callbackPluginEventGeneric(m.S.HasTexture,this._eventInfo),this._eventInfo.hasTexture}clone(e){return null}getBindedMeshes(){if(this.meshMap){const e=new Array;for(const t in this.meshMap){const i=this.meshMap[t];i&&e.push(i)}return e}return this._scene.meshes.filter((e=>e.material===this))}forceCompilation(e,t,i,s){const n={clipPlane:!1,useInstances:!1,...i},r=this.getScene(),a=this.allowShaderHotSwapping;this.allowShaderHotSwapping=!1;const o=()=>{if(!this._scene||!this._scene.getEngine())return;const i=r.clipPlane;if(n.clipPlane&&(r.clipPlane=new u.J(0,0,0,1)),this._storeEffectOnSubMeshes){let i=!0,r=null;if(e.subMeshes){const t=new l.P(0,0,0,0,0,e,void 0,!1,!1);t.materialDefines&&(t.materialDefines._renderId=-1),this.isReadyForSubMesh(e,t,n.useInstances)||(t.effect&&t.effect.getCompilationError()&&t.effect.allFallbacksProcessed()?r=t.effect.getCompilationError():(i=!1,setTimeout(o,16)))}i&&(this.allowShaderHotSwapping=a,r&&s&&s(r),t&&t(this))}else this.isReady()?(this.allowShaderHotSwapping=a,t&&t(this)):setTimeout(o,16);n.clipPlane&&(r.clipPlane=i)};o()}forceCompilationAsync(e,t){return new Promise(((i,s)=>{this.forceCompilation(e,(()=>{i()}),t,(e=>{s(e)}))}))}markAsDirty(e){this.getScene().blockMaterialDirtyMechanism||this._blockDirtyMechanism||(_._DirtyCallbackArray.length=0,e&_.TextureDirtyFlag&&_._DirtyCallbackArray.push(_._TextureDirtyCallBack),e&_.LightDirtyFlag&&_._DirtyCallbackArray.push(_._LightsDirtyCallBack),e&_.FresnelDirtyFlag&&_._DirtyCallbackArray.push(_._FresnelDirtyCallBack),e&_.AttributesDirtyFlag&&_._DirtyCallbackArray.push(_._AttributeDirtyCallBack),e&_.MiscDirtyFlag&&_._DirtyCallbackArray.push(_._MiscDirtyCallBack),e&_.PrePassDirtyFlag&&_._DirtyCallbackArray.push(_._PrePassDirtyCallBack),_._DirtyCallbackArray.length&&this._markAllSubMeshesAsDirty(_._RunDirtyCallBacks),this.getScene().resetCachedMaterial())}resetDrawCache(){const e=this.getScene().meshes;for(const t of e)if(t.subMeshes)for(const e of t.subMeshes)e.getMaterial()===this&&e.resetDrawCache()}_markAllSubMeshesAsDirty(e){if(this.getScene().blockMaterialDirtyMechanism||this._blockDirtyMechanism)return;const t=this.getScene().meshes;for(const i of t)if(i.subMeshes)for(const t of i.subMeshes)if(t.getMaterial(!1)===this)for(const i of t._drawWrappers)i&&i.defines&&i.defines.markAllAsDirty&&this._materialContext===i.materialContext&&e(i.defines)}_markScenePrePassDirty(){if(this.getScene().blockMaterialDirtyMechanism||this._blockDirtyMechanism)return;const e=this.getScene().enablePrePassRenderer();e&&e.markAsDirty()}_markAllSubMeshesAsAllDirty(){this._markAllSubMeshesAsDirty(_._AllDirtyCallBack)}_markAllSubMeshesAsImageProcessingDirty(){this._markAllSubMeshesAsDirty(_._ImageProcessingDirtyCallBack)}_markAllSubMeshesAsTexturesDirty(){this._markAllSubMeshesAsDirty(_._TextureDirtyCallBack)}_markAllSubMeshesAsFresnelDirty(){this._markAllSubMeshesAsDirty(_._FresnelDirtyCallBack)}_markAllSubMeshesAsFresnelAndMiscDirty(){this._markAllSubMeshesAsDirty(_._FresnelAndMiscDirtyCallBack)}_markAllSubMeshesAsLightsDirty(){this._markAllSubMeshesAsDirty(_._LightsDirtyCallBack)}_markAllSubMeshesAsAttributesDirty(){this._markAllSubMeshesAsDirty(_._AttributeDirtyCallBack)}_markAllSubMeshesAsMiscDirty(){this._markAllSubMeshesAsDirty(_._MiscDirtyCallBack)}_markAllSubMeshesAsPrePassDirty(){this._markAllSubMeshesAsDirty(_._MiscDirtyCallBack)}_markAllSubMeshesAsTexturesAndMiscDirty(){this._markAllSubMeshesAsDirty(_._TextureAndMiscDirtyCallBack)}_checkScenePerformancePriority(){if(this._scene.performancePriority!==g.a.BackwardCompatible){this.checkReadyOnlyOnce=!0;const e=this._scene.onScenePerformancePriorityChangedObservable.addOnce((()=>{this.checkReadyOnlyOnce=!1}));this.onDisposeObservable.add((()=>{this._scene.onScenePerformancePriorityChangedObservable.remove(e)}))}}setPrePassRenderer(e){return!1}dispose(e,t,i){const s=this.getScene();if(s.stopAnimation(this),s.freeProcessedMaterials(),s.removeMaterial(this),this._eventInfo.forceDisposeTextures=t,this._callbackPluginEventGeneric(m.S.Disposed,this._eventInfo),this._parentContainer){const e=this._parentContainer.materials.indexOf(this);e>-1&&this._parentContainer.materials.splice(e,1),this._parentContainer=null}if(!0!==i)if(this.meshMap)for(const n in this.meshMap){const t=this.meshMap[n];t&&(t.material=null,this.releaseVertexArrayObject(t,e))}else{const t=s.meshes;for(const i of t)i.material!==this||i.sourceMesh||(i.material=null,this.releaseVertexArrayObject(i,e))}this._uniformBuffer.dispose(),e&&this._drawWrapper.effect&&(this._storeEffectOnSubMeshes||this._drawWrapper.effect.dispose(),this._drawWrapper.effect=null),this.metadata=null,this.onDisposeObservable.notifyObservers(this),this.onDisposeObservable.clear(),this._onBindObservable&&this._onBindObservable.clear(),this._onUnBindObservable&&this._onUnBindObservable.clear(),this._onEffectCreatedObservable&&this._onEffectCreatedObservable.clear(),this._eventInfo&&(this._eventInfo={})}releaseVertexArrayObject(e,t){if(e.geometry){const i=e.geometry;if(this._storeEffectOnSubMeshes)for(const s of e.subMeshes)i._releaseVertexArrayObject(s.effect),t&&s.effect&&s.effect.dispose();else i._releaseVertexArrayObject(this._drawWrapper.effect)}}serialize(){const e=n.p4.Serialize(this);return e.stencil=this.stencil.serialize(),e.uniqueId=this.uniqueId,e}static Parse(e,t,i){if(e.customType){if("BABYLON.PBRMaterial"===e.customType&&e.overloadedAlbedo&&(e.customType="BABYLON.LegacyPBRMaterial",!BABYLON.LegacyPBRMaterial))return c.Y.Error("Your scene is trying to load a legacy version of the PBRMaterial, please, include it from the materials library."),null}else e.customType="BABYLON.StandardMaterial";const s=r.w1.Instantiate(e.customType).Parse(e,t,i);return s._loadedUniqueId=e.uniqueId,s}}_.TriangleFillMode=0,_.WireFrameFillMode=1,_.PointFillMode=2,_.PointListDrawMode=3,_.LineListDrawMode=4,_.LineLoopDrawMode=5,_.LineStripDrawMode=6,_.TriangleStripDrawMode=7,_.TriangleFanDrawMode=8,_.ClockWiseSideOrientation=0,_.CounterClockWiseSideOrientation=1,_.TextureDirtyFlag=1,_.LightDirtyFlag=2,_.FresnelDirtyFlag=4,_.AttributesDirtyFlag=8,_.MiscDirtyFlag=16,_.PrePassDirtyFlag=32,_.AllDirtyFlag=63,_.MATERIAL_OPAQUE=0,_.MATERIAL_ALPHATEST=1,_.MATERIAL_ALPHABLEND=2,_.MATERIAL_ALPHATESTANDBLEND=3,_.MATERIAL_NORMALBLENDMETHOD_WHITEOUT=0,_.MATERIAL_NORMALBLENDMETHOD_RNM=1,_.OnEventObservable=new a.y$,o.l.OnEnginesDisposedObservable.addOnce((()=>{_.OnEventObservable.clear()})),_._AllDirtyCallBack=e=>e.markAllAsDirty(),_._ImageProcessingDirtyCallBack=e=>e.markAsImageProcessingDirty(),_._TextureDirtyCallBack=e=>e.markAsTexturesDirty(),_._FresnelDirtyCallBack=e=>e.markAsFresnelDirty(),_._MiscDirtyCallBack=e=>e.markAsMiscDirty(),_._PrePassDirtyCallBack=e=>e.markAsPrePassDirty(),_._LightsDirtyCallBack=e=>e.markAsLightDirty(),_._AttributeDirtyCallBack=e=>e.markAsAttributesDirty(),_._FresnelAndMiscDirtyCallBack=e=>{_._FresnelDirtyCallBack(e),_._MiscDirtyCallBack(e)},_._TextureAndMiscDirtyCallBack=e=>{_._TextureDirtyCallBack(e),_._MiscDirtyCallBack(e)},_._DirtyCallbackArray=[],_._RunDirtyCallBacks=e=>{for(const t of _._DirtyCallbackArray)t(e)},(0,s.gn)([(0,n.qC)()],_.prototype,"id",void 0),(0,s.gn)([(0,n.qC)()],_.prototype,"uniqueId",void 0),(0,s.gn)([(0,n.qC)()],_.prototype,"name",void 0),(0,s.gn)([(0,n.qC)()],_.prototype,"metadata",void 0),(0,s.gn)([(0,n.qC)()],_.prototype,"checkReadyOnEveryCall",void 0),(0,s.gn)([(0,n.qC)()],_.prototype,"checkReadyOnlyOnce",void 0),(0,s.gn)([(0,n.qC)()],_.prototype,"state",void 0),(0,s.gn)([(0,n.qC)("alpha")],_.prototype,"_alpha",void 0),(0,s.gn)([(0,n.qC)("backFaceCulling")],_.prototype,"_backFaceCulling",void 0),(0,s.gn)([(0,n.qC)("cullBackFaces")],_.prototype,"_cullBackFaces",void 0),(0,s.gn)([(0,n.qC)()],_.prototype,"sideOrientation",void 0),(0,s.gn)([(0,n.qC)("alphaMode")],_.prototype,"_alphaMode",void 0),(0,s.gn)([(0,n.qC)()],_.prototype,"_needDepthPrePass",void 0),(0,s.gn)([(0,n.qC)()],_.prototype,"disableDepthWrite",void 0),(0,s.gn)([(0,n.qC)()],_.prototype,"disableColorWrite",void 0),(0,s.gn)([(0,n.qC)()],_.prototype,"forceDepthWrite",void 0),(0,s.gn)([(0,n.qC)()],_.prototype,"depthFunction",void 0),(0,s.gn)([(0,n.qC)()],_.prototype,"separateCullingPass",void 0),(0,s.gn)([(0,n.qC)("fogEnabled")],_.prototype,"_fogEnabled",void 0),(0,s.gn)([(0,n.qC)()],_.prototype,"pointSize",void 0),(0,s.gn)([(0,n.qC)()],_.prototype,"zOffset",void 0),(0,s.gn)([(0,n.qC)()],_.prototype,"zOffsetUnits",void 0),(0,s.gn)([(0,n.qC)()],_.prototype,"pointsCloud",null),(0,s.gn)([(0,n.qC)()],_.prototype,"fillMode",null),(0,s.gn)([(0,n.qC)()],_.prototype,"transparencyMode",null)},4771:function(e,t,i){"use strict";i.d(t,{H:function(){return s}});class s{constructor(e){if(this._keys=[],this._isDirty=!0,this._areLightsDirty=!0,this._areLightsDisposed=!1,this._areAttributesDirty=!0,this._areTexturesDirty=!0,this._areFresnelDirty=!0,this._areMiscDirty=!0,this._arePrePassDirty=!0,this._areImageProcessingDirty=!0,this._normals=!1,this._uvs=!1,this._needNormals=!1,this._needUVs=!1,this._externalProperties=e,e)for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&this._setDefaultValue(t)}get isDirty(){return this._isDirty}markAsProcessed(){this._isDirty=!1,this._areAttributesDirty=!1,this._areTexturesDirty=!1,this._areFresnelDirty=!1,this._areLightsDirty=!1,this._areLightsDisposed=!1,this._areMiscDirty=!1,this._arePrePassDirty=!1,this._areImageProcessingDirty=!1}markAsUnprocessed(){this._isDirty=!0}markAllAsDirty(){this._areTexturesDirty=!0,this._areAttributesDirty=!0,this._areLightsDirty=!0,this._areFresnelDirty=!0,this._areMiscDirty=!0,this._areImageProcessingDirty=!0,this._isDirty=!0}markAsImageProcessingDirty(){this._areImageProcessingDirty=!0,this._isDirty=!0}markAsLightDirty(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._areLightsDirty=!0,this._areLightsDisposed=this._areLightsDisposed||e,this._isDirty=!0}markAsAttributesDirty(){this._areAttributesDirty=!0,this._isDirty=!0}markAsTexturesDirty(){this._areTexturesDirty=!0,this._isDirty=!0}markAsFresnelDirty(){this._areFresnelDirty=!0,this._isDirty=!0}markAsMiscDirty(){this._areMiscDirty=!0,this._isDirty=!0}markAsPrePassDirty(){this._arePrePassDirty=!0,this._isDirty=!0}rebuild(){this._keys.length=0;for(const e of Object.keys(this))"_"!==e[0]&&this._keys.push(e);if(this._externalProperties)for(const e in this._externalProperties)-1===this._keys.indexOf(e)&&this._keys.push(e)}isEqual(e){if(this._keys.length!==e._keys.length)return!1;for(let t=0;t<this._keys.length;t++){const i=this._keys[t];if(this[i]!==e[i])return!1}return!0}cloneTo(e){this._keys.length!==e._keys.length&&(e._keys=this._keys.slice(0));for(let t=0;t<this._keys.length;t++){const i=this._keys[t];e[i]=this[i]}}reset(){this._keys.forEach((e=>this._setDefaultValue(e)))}_setDefaultValue(e){var t,i,s,n,r;const a=null!==(s=null===(i=null===(t=this._externalProperties)||void 0===t?void 0:t[e])||void 0===i?void 0:i.type)&&void 0!==s?s:typeof this[e],o=null===(r=null===(n=this._externalProperties)||void 0===n?void 0:n[e])||void 0===r?void 0:r.default;switch(a){case"number":this[e]=null!=o?o:0;break;case"string":this[e]=null!=o?o:"";break;default:this[e]=null!=o&&o}}toString(){let e="";for(let t=0;t<this._keys.length;t++){const i=this._keys[t],s=this[i];switch(typeof s){case"number":case"string":e+="#define "+i+" "+s+"\n";break;default:s&&(e+="#define "+i+"\n")}}return e}}},2655:function(e,t,i){"use strict";i.d(t,{G:function(){return u}});var s=i(2328),n=i(7337),r=i(1962),a=i(4198),o=i(2845),l=i(1221),h=i(7046),c=i(1401);class u{static BindSceneUniformBuffer(e,t){t.bindToEffect(e,"Scene")}static PrepareDefinesForMergedUV(e,t,i){t._needUVs=!0,t[i]=!0,e.optimizeUVAllocation&&e.getTextureMatrix().isIdentityAs3x2()?(t[i+"DIRECTUV"]=e.coordinatesIndex+1,t["MAINUV"+(e.coordinatesIndex+1)]=!0):t[i+"DIRECTUV"]=0}static BindTextureMatrix(e,t,i){const s=e.getTextureMatrix();t.updateMatrix(i+"Matrix",s)}static GetFogState(e,t){return t.fogEnabled&&e.applyFog&&t.fogMode!==r.x.FOGMODE_NONE}static PrepareDefinesForMisc(e,t,i,s,n,r,a){a._areMiscDirty&&(a.LOGARITHMICDEPTH=i,a.POINTSIZE=s,a.FOG=n&&this.GetFogState(e,t),a.NONUNIFORMSCALING=e.nonUniformScaling,a.ALPHATEST=r)}static PrepareDefinesForCamera(e,t){let i=!1;if(e.activeCamera){const s=t.CAMERA_ORTHOGRAPHIC?1:0,r=t.CAMERA_PERSPECTIVE?1:0,a=e.activeCamera.mode===n.V.ORTHOGRAPHIC_CAMERA?1:0,o=e.activeCamera.mode===n.V.PERSPECTIVE_CAMERA?1:0;(s^a||r^o)&&(t.CAMERA_ORTHOGRAPHIC=1===a,t.CAMERA_PERSPECTIVE=1===o,i=!0)}return i}static PrepareDefinesForFrameBoundValues(e,t,i,s,n){let r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,a=arguments.length>6&&void 0!==arguments[6]&&arguments[6],o=u.PrepareDefinesForCamera(e,s);!1!==r&&(o=(0,c.AN)(i,e,s)),s.DEPTHPREPASS!==!t.getColorWrite()&&(s.DEPTHPREPASS=!s.DEPTHPREPASS,o=!0),s.INSTANCES!==n&&(s.INSTANCES=n,o=!0),s.THIN_INSTANCES!==a&&(s.THIN_INSTANCES=a,o=!0),o&&s.markAsUnprocessed()}static PrepareDefinesForBones(e,t){if(e.useBones&&e.computeBonesUsingShaders&&e.skeleton){t.NUM_BONE_INFLUENCERS=e.numBoneInfluencers;const i=void 0!==t.BONETEXTURE;if(e.skeleton.isUsingTextureForMatrices&&i)t.BONETEXTURE=!0;else{t.BonesPerMesh=e.skeleton.bones.length+1,t.BONETEXTURE=!i&&void 0;const s=e.getScene().prePassRenderer;if(s&&s.enabled){const i=-1===s.excludedSkinnedMesh.indexOf(e);t.BONES_VELOCITY_ENABLED=i}}}else t.NUM_BONE_INFLUENCERS=0,t.BonesPerMesh=0,void 0!==t.BONETEXTURE&&(t.BONETEXTURE=!1)}static PrepareDefinesForMorphTargets(e,t){const i=e.morphTargetManager;i?(t.MORPHTARGETS_UV=i.supportsUVs&&t.UV1,t.MORPHTARGETS_TANGENT=i.supportsTangents&&t.TANGENT,t.MORPHTARGETS_NORMAL=i.supportsNormals&&t.NORMAL,t.MORPHTARGETS=i.numInfluencers>0,t.NUM_MORPH_INFLUENCERS=i.numInfluencers,t.MORPHTARGETS_TEXTURE=i.isUsingTextureForTargets):(t.MORPHTARGETS_UV=!1,t.MORPHTARGETS_TANGENT=!1,t.MORPHTARGETS_NORMAL=!1,t.MORPHTARGETS=!1,t.NUM_MORPH_INFLUENCERS=0)}static PrepareDefinesForBakedVertexAnimation(e,t){const i=e.bakedVertexAnimationManager;t.BAKED_VERTEX_ANIMATION_TEXTURE=!(!i||!i.isEnabled)}static PrepareDefinesForAttributes(e,t,i,s){let n=arguments.length>4&&void 0!==arguments[4]&&arguments[4],r=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],a=!(arguments.length>6&&void 0!==arguments[6])||arguments[6];if(!t._areAttributesDirty&&t._needNormals===t._normals&&t._needUVs===t._uvs)return!1;t._normals=t._needNormals,t._uvs=t._needUVs,t.NORMAL=t._needNormals&&e.isVerticesDataPresent(o.o.NormalKind),t._needNormals&&e.isVerticesDataPresent(o.o.TangentKind)&&(t.TANGENT=!0);for(let o=1;o<=6;++o)t["UV"+o]=!!t._needUVs&&e.isVerticesDataPresent("uv".concat(1===o?"":o));if(i){const i=e.useVertexColors&&e.isVerticesDataPresent(o.o.ColorKind);t.VERTEXCOLOR=i,t.VERTEXALPHA=e.hasVertexAlpha&&i&&r}return e.isVerticesDataPresent(o.o.ColorInstanceKind)&&(e.hasInstances||e.hasThinInstances)&&(t.INSTANCESCOLOR=!0),s&&this.PrepareDefinesForBones(e,t),n&&this.PrepareDefinesForMorphTargets(e,t),a&&this.PrepareDefinesForBakedVertexAnimation(e,t),!0}static PrepareDefinesForMultiview(e,t){if(e.activeCamera){const i=t.MULTIVIEW;t.MULTIVIEW=null!==e.activeCamera.outputRenderTarget&&e.activeCamera.outputRenderTarget.getViewCount()>1,t.MULTIVIEW!=i&&t.markAsUnprocessed()}}static PrepareDefinesForOIT(e,t,i){const s=t.ORDER_INDEPENDENT_TRANSPARENCY,n=t.ORDER_INDEPENDENT_TRANSPARENCY_16BITS;t.ORDER_INDEPENDENT_TRANSPARENCY=e.useOrderIndependentTransparency&&i,t.ORDER_INDEPENDENT_TRANSPARENCY_16BITS=!e.getEngine().getCaps().textureFloatLinearFiltering,s===t.ORDER_INDEPENDENT_TRANSPARENCY&&n===t.ORDER_INDEPENDENT_TRANSPARENCY_16BITS||t.markAsUnprocessed()}static PrepareDefinesForPrePass(e,t,i){const s=t.PREPASS;if(!t._arePrePassDirty)return;const n=[{type:1,define:"PREPASS_POSITION",index:"PREPASS_POSITION_INDEX"},{type:2,define:"PREPASS_VELOCITY",index:"PREPASS_VELOCITY_INDEX"},{type:3,define:"PREPASS_REFLECTIVITY",index:"PREPASS_REFLECTIVITY_INDEX"},{type:0,define:"PREPASS_IRRADIANCE",index:"PREPASS_IRRADIANCE_INDEX"},{type:7,define:"PREPASS_ALBEDO_SQRT",index:"PREPASS_ALBEDO_SQRT_INDEX"},{type:5,define:"PREPASS_DEPTH",index:"PREPASS_DEPTH_INDEX"},{type:6,define:"PREPASS_NORMAL",index:"PREPASS_NORMAL_INDEX"}];if(e.prePassRenderer&&e.prePassRenderer.enabled&&i){t.PREPASS=!0,t.SCENE_MRT_COUNT=e.prePassRenderer.mrtCount;for(let i=0;i<n.length;i++){const s=e.prePassRenderer.getIndex(n[i].type);-1!==s?(t[n[i].define]=!0,t[n[i].index]=s):t[n[i].define]=!1}}else{t.PREPASS=!1;for(let e=0;e<n.length;e++)t[n[e].define]=!1}t.PREPASS!=s&&(t.markAsUnprocessed(),t.markAsImageProcessingDirty())}static PrepareDefinesForLight(e,t,i,s,n,r,a){var o;switch(a.needNormals=!0,void 0===n["LIGHT"+s]&&(a.needRebuild=!0),n["LIGHT"+s]=!0,n["SPOTLIGHT"+s]=!1,n["HEMILIGHT"+s]=!1,n["POINTLIGHT"+s]=!1,n["DIRLIGHT"+s]=!1,i.prepareLightSpecificDefines(n,s),n["LIGHT_FALLOFF_PHYSICAL"+s]=!1,n["LIGHT_FALLOFF_GLTF"+s]=!1,n["LIGHT_FALLOFF_STANDARD"+s]=!1,i.falloffType){case l.m.FALLOFF_GLTF:n["LIGHT_FALLOFF_GLTF"+s]=!0;break;case l.m.FALLOFF_PHYSICAL:n["LIGHT_FALLOFF_PHYSICAL"+s]=!0;break;case l.m.FALLOFF_STANDARD:n["LIGHT_FALLOFF_STANDARD"+s]=!0}if(r&&!i.specular.equalsFloats(0,0,0)&&(a.specularEnabled=!0),n["SHADOW"+s]=!1,n["SHADOWCSM"+s]=!1,n["SHADOWCSMDEBUG"+s]=!1,n["SHADOWCSMNUM_CASCADES"+s]=!1,n["SHADOWCSMUSESHADOWMAXZ"+s]=!1,n["SHADOWCSMNOBLEND"+s]=!1,n["SHADOWCSM_RIGHTHANDED"+s]=!1,n["SHADOWPCF"+s]=!1,n["SHADOWPCSS"+s]=!1,n["SHADOWPOISSON"+s]=!1,n["SHADOWESM"+s]=!1,n["SHADOWCLOSEESM"+s]=!1,n["SHADOWCUBE"+s]=!1,n["SHADOWLOWQUALITY"+s]=!1,n["SHADOWMEDIUMQUALITY"+s]=!1,t&&t.receiveShadows&&e.shadowsEnabled&&i.shadowEnabled){const t=null!==(o=i.getShadowGenerator(e.activeCamera))&&void 0!==o?o:i.getShadowGenerator();if(t){const e=t.getShadowMap();e&&e.renderList&&e.renderList.length>0&&(a.shadowEnabled=!0,t.prepareDefines(n,s))}}i.lightmapMode!=l.m.LIGHTMAP_DEFAULT?(a.lightmapMode=!0,n["LIGHTMAPEXCLUDED"+s]=!0,n["LIGHTMAPNOSPECULAR"+s]=i.lightmapMode==l.m.LIGHTMAP_SHADOWSONLY):(n["LIGHTMAPEXCLUDED"+s]=!1,n["LIGHTMAPNOSPECULAR"+s]=!1)}static PrepareDefinesForLights(e,t,i,s){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:4,r=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(!i._areLightsDirty)return i._needNormals;let a=0;const o={needNormals:i._needNormals,needRebuild:!1,lightmapMode:!1,shadowEnabled:!1,specularEnabled:!1};if(e.lightsEnabled&&!r)for(const h of t.lightSources)if(this.PrepareDefinesForLight(e,t,h,a,i,s,o),a++,a===n)break;i.SPECULARTERM=o.specularEnabled,i.SHADOWS=o.shadowEnabled;for(let h=a;h<n;h++)void 0!==i["LIGHT"+h]&&(i["LIGHT"+h]=!1,i["HEMILIGHT"+h]=!1,i["POINTLIGHT"+h]=!1,i["DIRLIGHT"+h]=!1,i["SPOTLIGHT"+h]=!1,i["SHADOW"+h]=!1,i["SHADOWCSM"+h]=!1,i["SHADOWCSMDEBUG"+h]=!1,i["SHADOWCSMNUM_CASCADES"+h]=!1,i["SHADOWCSMUSESHADOWMAXZ"+h]=!1,i["SHADOWCSMNOBLEND"+h]=!1,i["SHADOWCSM_RIGHTHANDED"+h]=!1,i["SHADOWPCF"+h]=!1,i["SHADOWPCSS"+h]=!1,i["SHADOWPOISSON"+h]=!1,i["SHADOWESM"+h]=!1,i["SHADOWCLOSEESM"+h]=!1,i["SHADOWCUBE"+h]=!1,i["SHADOWLOWQUALITY"+h]=!1,i["SHADOWMEDIUMQUALITY"+h]=!1);const l=e.getEngine().getCaps();return void 0===i.SHADOWFLOAT&&(o.needRebuild=!0),i.SHADOWFLOAT=o.shadowEnabled&&(l.textureFloatRender&&l.textureFloatLinearFiltering||l.textureHalfFloatRender&&l.textureHalfFloatLinearFiltering),i.LIGHTMAPEXCLUDED=o.lightmapMode,o.needRebuild&&i.rebuild(),o.needNormals}static PrepareUniformsAndSamplersForLight(e,t,i,s){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,r=arguments.length>5&&void 0!==arguments[5]&&arguments[5];n&&n.push("Light"+e),r||(t.push("vLightData"+e,"vLightDiffuse"+e,"vLightSpecular"+e,"vLightDirection"+e,"vLightFalloff"+e,"vLightGround"+e,"lightMatrix"+e,"shadowsInfo"+e,"depthValues"+e),i.push("shadowSampler"+e),i.push("depthSampler"+e),t.push("viewFrustumZ"+e,"cascadeBlendFactor"+e,"lightSizeUVCorrection"+e,"depthCorrection"+e,"penumbraDarkness"+e,"frustumLengths"+e),s&&(i.push("projectionLightSampler"+e),t.push("textureProjectionMatrix"+e)))}static PrepareUniformsAndSamplersList(e,t,i){let s,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:4,r=null;if(e.uniformsNames){const a=e;s=a.uniformsNames,r=a.uniformBuffersNames,t=a.samplers,i=a.defines,n=a.maxSimultaneousLights||0}else s=e,t||(t=[]);for(let a=0;a<n&&i["LIGHT"+a];a++)this.PrepareUniformsAndSamplersForLight(a,s,t,i["PROJECTEDLIGHTTEXTURE"+a],r);i.NUM_MORPH_INFLUENCERS&&s.push("morphTargetInfluences"),i.BAKED_VERTEX_ANIMATION_TEXTURE&&(s.push("bakedVertexAnimationSettings"),s.push("bakedVertexAnimationTextureSizeInverted"),s.push("bakedVertexAnimationTime"),t.push("bakedVertexAnimationTexture"))}static HandleFallbacksForShadows(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=0;for(let r=0;r<i&&e["LIGHT"+r];r++)r>0&&(n=s+r,t.addFallback(n,"LIGHT"+r)),e.SHADOWS||(e["SHADOW"+r]&&t.addFallback(s,"SHADOW"+r),e["SHADOWPCF"+r]&&t.addFallback(s,"SHADOWPCF"+r),e["SHADOWPCSS"+r]&&t.addFallback(s,"SHADOWPCSS"+r),e["SHADOWPOISSON"+r]&&t.addFallback(s,"SHADOWPOISSON"+r),e["SHADOWESM"+r]&&t.addFallback(s,"SHADOWESM"+r),e["SHADOWCLOSEESM"+r]&&t.addFallback(s,"SHADOWCLOSEESM"+r));return n++}static PrepareAttributesForMorphTargetsInfluencers(e,t,i){this._TmpMorphInfluencers.NUM_MORPH_INFLUENCERS=i,this.PrepareAttributesForMorphTargets(e,t,this._TmpMorphInfluencers)}static PrepareAttributesForMorphTargets(e,t,i){const n=i.NUM_MORPH_INFLUENCERS;if(n>0&&a.l.LastCreatedEngine){const r=a.l.LastCreatedEngine.getCaps().maxVertexAttribs,l=t.morphTargetManager;if(null==l?void 0:l.isUsingTextureForTargets)return;const h=l&&l.supportsNormals&&i.NORMAL,c=l&&l.supportsTangents&&i.TANGENT,u=l&&l.supportsUVs&&i.UV1;for(let i=0;i<n;i++)e.push(o.o.PositionKind+i),h&&e.push(o.o.NormalKind+i),c&&e.push(o.o.TangentKind+i),u&&e.push(o.o.UVKind+"_"+i),e.length>r&&s.Y.Error("Cannot add more vertex attributes for mesh "+t.name)}}static PrepareAttributesForBakedVertexAnimation(e,t,i){i.BAKED_VERTEX_ANIMATION_TEXTURE&&i.INSTANCES&&e.push("bakedVertexAnimationSettingsInstanced")}static PrepareAttributesForBones(e,t,i,s){i.NUM_BONE_INFLUENCERS>0&&(s.addCPUSkinningFallback(0,t),e.push(o.o.MatricesIndicesKind),e.push(o.o.MatricesWeightsKind),i.NUM_BONE_INFLUENCERS>4&&(e.push(o.o.MatricesIndicesExtraKind),e.push(o.o.MatricesWeightsExtraKind)))}static PrepareAttributesForInstances(e,t){(t.INSTANCES||t.THIN_INSTANCES)&&this.PushAttributesForInstances(e,!!t.PREPASS_VELOCITY),t.INSTANCESCOLOR&&e.push(o.o.ColorInstanceKind)}static PushAttributesForInstances(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.push("world0"),e.push("world1"),e.push("world2"),e.push("world3"),t&&(e.push("previousWorld0"),e.push("previousWorld1"),e.push("previousWorld2"),e.push("previousWorld3"))}static BindLightProperties(e,t,i){e.transferToEffect(t,i+"")}static BindLight(e,t,i,s,n){let r=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];e._bindLight(t,i,s,n,r)}static BindLights(e,t,i,s){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:4;const r=Math.min(t.lightSources.length,n);for(let a=0;a<r;a++){const n=t.lightSources[a];this.BindLight(n,a,e,i,"boolean"==typeof s?s:s.SPECULARTERM,t.receiveShadows)}}static BindFogParameters(e,t,i){let s=arguments.length>3&&void 0!==arguments[3]&&arguments[3];e.fogEnabled&&t.applyFog&&e.fogMode!==r.x.FOGMODE_NONE&&(i.setFloat4("vFogInfos",e.fogMode,e.fogStart,e.fogEnd,e.fogDensity),s?(e.fogColor.toLinearSpaceToRef(this._TempFogColor,e.getEngine().useExactSrgbConversions),i.setColor3("vFogColor",this._TempFogColor)):i.setColor3("vFogColor",e.fogColor))}static BindBonesParameters(e,t,i){if(t&&e&&(e.computeBonesUsingShaders&&t._bonesComputationForcedToCPU&&(e.computeBonesUsingShaders=!1),e.useBones&&e.computeBonesUsingShaders&&e.skeleton)){const s=e.skeleton;if(s.isUsingTextureForMatrices&&t.getUniformIndex("boneTextureWidth")>-1){const i=s.getTransformMatrixTexture(e);t.setTexture("boneSampler",i),t.setFloat("boneTextureWidth",4*(s.bones.length+1))}else{const n=s.getTransformMatrices(e);n&&(t.setMatrices("mBones",n),i&&e.getScene().prePassRenderer&&e.getScene().prePassRenderer.getIndex(2)&&(i.previousBones[e.uniqueId]||(i.previousBones[e.uniqueId]=n.slice()),t.setMatrices("mPreviousBones",i.previousBones[e.uniqueId]),u._CopyBonesTransformationMatrices(n,i.previousBones[e.uniqueId])))}}}static _CopyBonesTransformationMatrices(e,t){return t.set(e),t}static BindMorphTargetParameters(e,t){const i=e.morphTargetManager;e&&i&&t.setFloatArray("morphTargetInfluences",i.influences)}static BindLogDepth(e,t,i){if(!e||e.LOGARITHMICDEPTH||e.indexOf&&e.indexOf("LOGARITHMICDEPTH")>=0){const e=i.activeCamera;e.mode===n.V.ORTHOGRAPHIC_CAMERA&&s.Y.Error("Logarithmic depth is not compatible with orthographic cameras!",20),t.setFloat("logarithmicDepthConstant",2/(Math.log(e.maxZ+1)/Math.LN2))}}}u._TmpMorphInfluencers={NUM_MORPH_INFLUENCERS:0},u._TempFogColor=h.Wo.Black()},4071:function(e,t,i){"use strict";var s;i.d(t,{S:function(){return s}}),function(e){e[e.Created=1]="Created",e[e.Disposed=2]="Disposed",e[e.GetDefineNames=4]="GetDefineNames",e[e.PrepareUniformBuffer=8]="PrepareUniformBuffer",e[e.IsReadyForSubMesh=16]="IsReadyForSubMesh",e[e.PrepareDefines=32]="PrepareDefines",e[e.BindForSubMesh=64]="BindForSubMesh",e[e.PrepareEffect=128]="PrepareEffect",e[e.GetAnimatables=256]="GetAnimatables",e[e.GetActiveTextures=512]="GetActiveTextures",e[e.HasTexture=1024]="HasTexture",e[e.FillRenderTargetTextures=2048]="FillRenderTargetTextures",e[e.HasRenderTargetTextures=4096]="HasRenderTargetTextures",e[e.HardBindForSubMesh=8192]="HardBindForSubMesh"}(s||(s={}))},2402:function(e,t,i){"use strict";i.d(t,{G:function(){return a}});var s=i(6556),n=i(7032),r=i(1704);class a extends s.F{get subMaterials(){return this._subMaterials}set subMaterials(e){this._subMaterials=e,this._hookArray(e)}getChildren(){return this.subMaterials}constructor(e,t){super(e,t,!0),this._waitingSubMaterialsUniqueIds=[],this.getScene().multiMaterials.push(this),this.subMaterials=new Array,this._storeEffectOnSubMeshes=!0}_hookArray(e){var t=this;const i=e.push;e.push=function(){for(var s=arguments.length,n=new Array(s),r=0;r<s;r++)n[r]=arguments[r];const a=i.apply(e,n);return t._markAllSubMeshesAsTexturesDirty(),a};const s=e.splice;e.splice=(t,i)=>{const n=s.apply(e,[t,i]);return this._markAllSubMeshesAsTexturesDirty(),n}}getSubMaterial(e){return e<0||e>=this.subMaterials.length?this.getScene().defaultMaterial:this.subMaterials[e]}getActiveTextures(){return super.getActiveTextures().concat(...this.subMaterials.map((e=>e?e.getActiveTextures():[])))}hasTexture(e){var t;if(super.hasTexture(e))return!0;for(let i=0;i<this.subMaterials.length;i++)if(null===(t=this.subMaterials[i])||void 0===t?void 0:t.hasTexture(e))return!0;return!1}getClassName(){return"MultiMaterial"}isReadyForSubMesh(e,t,i){for(let s=0;s<this.subMaterials.length;s++){const n=this.subMaterials[s];if(n){if(n._storeEffectOnSubMeshes){if(!n.isReadyForSubMesh(e,t,i))return!1;continue}if(!n.isReady(e))return!1}}return!0}clone(e,t){const i=new a(e,this.getScene());for(let s=0;s<this.subMaterials.length;s++){let n=null;const r=this.subMaterials[s];n=t&&r?r.clone(e+"-"+r.name):this.subMaterials[s],i.subMaterials.push(n)}return i}serialize(){const e={};e.name=this.name,e.id=this.id,e.uniqueId=this.uniqueId,n.$&&(e.tags=n.$.GetTags(this)),e.materialsUniqueIds=[],e.materials=[];for(let t=0;t<this.subMaterials.length;t++){const i=this.subMaterials[t];i?(e.materialsUniqueIds.push(i.uniqueId),e.materials.push(i.id)):(e.materialsUniqueIds.push(null),e.materials.push(null))}return e}dispose(e,t,i){const s=this.getScene();if(!s)return;if(i)for(let r=0;r<this.subMaterials.length;r++){const i=this.subMaterials[r];i&&i.dispose(e,t)}const n=s.multiMaterials.indexOf(this);n>=0&&s.multiMaterials.splice(n,1),super.dispose(e,t)}static ParseMultiMaterial(e,t){const i=new a(e.name,t);return i.id=e.id,i._loadedUniqueId=e.uniqueId,n.$&&n.$.AddTagsTo(i,e.tags),e.materialsUniqueIds?i._waitingSubMaterialsUniqueIds=e.materialsUniqueIds:e.materials.forEach((e=>i.subMaterials.push(t.getLastMaterialById(e)))),i}}(0,r.H)("BABYLON.MultiMaterial",a)},2223:function(e,t,i){"use strict";var s;i.d(t,{x:function(){return s}}),function(e){e[e.GLSL=0]="GLSL",e[e.WGSL=1]="WGSL"}(s||(s={}))},1952:function(e,t,i){"use strict";i.d(t,{M:function(){return o}});var s=i(2328),n=i(8517),r=i(4796),a=i(2628);r.B.prototype.createUniformBuffer=function(e){const t=this._gl.createBuffer();if(!t)throw new Error("Unable to create uniform buffer");const i=new a.M(t);return this.bindUniformBuffer(i),e instanceof Float32Array?this._gl.bufferData(this._gl.UNIFORM_BUFFER,e,this._gl.STATIC_DRAW):this._gl.bufferData(this._gl.UNIFORM_BUFFER,new Float32Array(e),this._gl.STATIC_DRAW),this.bindUniformBuffer(null),i.references=1,i},r.B.prototype.createDynamicUniformBuffer=function(e){const t=this._gl.createBuffer();if(!t)throw new Error("Unable to create dynamic uniform buffer");const i=new a.M(t);return this.bindUniformBuffer(i),e instanceof Float32Array?this._gl.bufferData(this._gl.UNIFORM_BUFFER,e,this._gl.DYNAMIC_DRAW):this._gl.bufferData(this._gl.UNIFORM_BUFFER,new Float32Array(e),this._gl.DYNAMIC_DRAW),this.bindUniformBuffer(null),i.references=1,i},r.B.prototype.updateUniformBuffer=function(e,t,i,s){this.bindUniformBuffer(e),void 0===i&&(i=0),void 0===s?t instanceof Float32Array?this._gl.bufferSubData(this._gl.UNIFORM_BUFFER,i,t):this._gl.bufferSubData(this._gl.UNIFORM_BUFFER,i,new Float32Array(t)):t instanceof Float32Array?this._gl.bufferSubData(this._gl.UNIFORM_BUFFER,0,t.subarray(i,i+s)):this._gl.bufferSubData(this._gl.UNIFORM_BUFFER,0,new Float32Array(t).subarray(i,i+s)),this.bindUniformBuffer(null)},r.B.prototype.bindUniformBuffer=function(e){this._gl.bindBuffer(this._gl.UNIFORM_BUFFER,e?e.underlyingResource:null)},r.B.prototype.bindUniformBufferBase=function(e,t,i){this._gl.bindBufferBase(this._gl.UNIFORM_BUFFER,t,e?e.underlyingResource:null)},r.B.prototype.bindUniformBlock=function(e,t,i){const s=e.program,n=this._gl.getUniformBlockIndex(s,t);4294967295!==n&&this._gl.uniformBlockBinding(s,n,i)};class o{constructor(e,t,i,s){let n=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this._valueCache={},this._engine=e,this._noUBO=!e.supportsUniformBuffers||n,this._dynamic=i,this._name=null!=s?s:"no-name",this._data=t||[],this._uniformLocations={},this._uniformSizes={},this._uniformArraySizes={},this._uniformLocationPointer=0,this._needSync=!1,this._engine._features.trackUbosInFrame&&(this._buffers=[],this._bufferIndex=-1,this._createBufferOnWrite=!1,this._currentFrameId=0),this._noUBO?(this.updateMatrix3x3=this._updateMatrix3x3ForEffect,this.updateMatrix2x2=this._updateMatrix2x2ForEffect,this.updateFloat=this._updateFloatForEffect,this.updateFloat2=this._updateFloat2ForEffect,this.updateFloat3=this._updateFloat3ForEffect,this.updateFloat4=this._updateFloat4ForEffect,this.updateFloatArray=this._updateFloatArrayForEffect,this.updateArray=this._updateArrayForEffect,this.updateIntArray=this._updateIntArrayForEffect,this.updateUIntArray=this._updateUIntArrayForEffect,this.updateMatrix=this._updateMatrixForEffect,this.updateMatrices=this._updateMatricesForEffect,this.updateVector3=this._updateVector3ForEffect,this.updateVector4=this._updateVector4ForEffect,this.updateColor3=this._updateColor3ForEffect,this.updateColor4=this._updateColor4ForEffect,this.updateDirectColor4=this._updateDirectColor4ForEffect,this.updateInt=this._updateIntForEffect,this.updateInt2=this._updateInt2ForEffect,this.updateInt3=this._updateInt3ForEffect,this.updateInt4=this._updateInt4ForEffect,this.updateUInt=this._updateUIntForEffect,this.updateUInt2=this._updateUInt2ForEffect,this.updateUInt3=this._updateUInt3ForEffect,this.updateUInt4=this._updateUInt4ForEffect):(this._engine._uniformBuffers.push(this),this.updateMatrix3x3=this._updateMatrix3x3ForUniform,this.updateMatrix2x2=this._updateMatrix2x2ForUniform,this.updateFloat=this._updateFloatForUniform,this.updateFloat2=this._updateFloat2ForUniform,this.updateFloat3=this._updateFloat3ForUniform,this.updateFloat4=this._updateFloat4ForUniform,this.updateFloatArray=this._updateFloatArrayForUniform,this.updateArray=this._updateArrayForUniform,this.updateIntArray=this._updateIntArrayForUniform,this.updateUIntArray=this._updateUIntArrayForUniform,this.updateMatrix=this._updateMatrixForUniform,this.updateMatrices=this._updateMatricesForUniform,this.updateVector3=this._updateVector3ForUniform,this.updateVector4=this._updateVector4ForUniform,this.updateColor3=this._updateColor3ForUniform,this.updateColor4=this._updateColor4ForUniform,this.updateDirectColor4=this._updateDirectColor4ForUniform,this.updateInt=this._updateIntForUniform,this.updateInt2=this._updateInt2ForUniform,this.updateInt3=this._updateInt3ForUniform,this.updateInt4=this._updateInt4ForUniform,this.updateUInt=this._updateUIntForUniform,this.updateUInt2=this._updateUInt2ForUniform,this.updateUInt3=this._updateUInt3ForUniform,this.updateUInt4=this._updateUInt4ForUniform)}get useUbo(){return!this._noUBO}get isSync(){return!this._needSync}isDynamic(){return void 0!==this._dynamic}getData(){return this._bufferData}getBuffer(){return this._buffer}_fillAlignment(e){let t;if(t=e<=2?e:4,this._uniformLocationPointer%t!=0){const e=this._uniformLocationPointer;this._uniformLocationPointer+=t-this._uniformLocationPointer%t;const i=this._uniformLocationPointer-e;for(let t=0;t<i;t++)this._data.push(0)}}addUniform(e,t){let i,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(!this._noUBO&&void 0===this._uniformLocations[e]){if(s>0){if(t instanceof Array)throw"addUniform should not be use with Array in UBO: "+e;if(this._fillAlignment(4),this._uniformArraySizes[e]={strideSize:t,arraySize:s},16==t)t*=s;else{t=t*s+(4-t)*s}i=[];for(let e=0;e<t;e++)i.push(0)}else{if(t instanceof Array)i=t,t=i.length;else{i=[];for(let e=0;e<t;e++)i.push(0)}this._fillAlignment(t)}this._uniformSizes[e]=t,this._uniformLocations[e]=this._uniformLocationPointer,this._uniformLocationPointer+=t;for(let e=0;e<t;e++)this._data.push(i[e]);this._needSync=!0}}addMatrix(e,t){this.addUniform(e,Array.prototype.slice.call(t.toArray()))}addFloat2(e,t,i){const s=[t,i];this.addUniform(e,s)}addFloat3(e,t,i,s){const n=[t,i,s];this.addUniform(e,n)}addColor3(e,t){const i=[t.r,t.g,t.b];this.addUniform(e,i)}addColor4(e,t,i){const s=[t.r,t.g,t.b,i];this.addUniform(e,s)}addVector3(e,t){const i=[t.x,t.y,t.z];this.addUniform(e,i)}addMatrix3x3(e){this.addUniform(e,12)}addMatrix2x2(e){this.addUniform(e,8)}create(){this._noUBO||this._buffer||(this._fillAlignment(4),this._bufferData=new Float32Array(this._data),this._rebuild(),this._needSync=!0)}_rebuild(){!this._noUBO&&this._bufferData&&(this._dynamic?this._buffer=this._engine.createDynamicUniformBuffer(this._bufferData):this._buffer=this._engine.createUniformBuffer(this._bufferData),this._engine._features.trackUbosInFrame&&(this._buffers.push([this._buffer,this._engine._features.checkUbosContentBeforeUpload?this._bufferData.slice():void 0]),this._bufferIndex=this._buffers.length-1,this._createBufferOnWrite=!1))}get _numBuffers(){return this._buffers.length}get _indexBuffer(){return this._bufferIndex}get name(){return this._name}get currentEffect(){return this._currentEffect}_buffersEqual(e,t){for(let i=0;i<e.length;++i)if(e[i]!==t[i])return!1;return!0}_copyBuffer(e,t){for(let i=0;i<e.length;++i)t[i]=e[i]}update(){if(!this._noUBO)if(this.bindUniformBuffer(),this._buffer)if(this._dynamic||this._needSync){if(this._buffers&&this._buffers.length>1&&this._buffers[this._bufferIndex][1]){if(this._buffersEqual(this._bufferData,this._buffers[this._bufferIndex][1]))return this._needSync=!1,void(this._createBufferOnWrite=this._engine._features.trackUbosInFrame);this._copyBuffer(this._bufferData,this._buffers[this._bufferIndex][1])}this._engine.updateUniformBuffer(this._buffer,this._bufferData),this._engine._features._collectUbosUpdatedInFrame&&(o._UpdatedUbosInFrame[this._name]||(o._UpdatedUbosInFrame[this._name]=0),o._UpdatedUbosInFrame[this._name]++),this._needSync=!1,this._createBufferOnWrite=this._engine._features.trackUbosInFrame}else this._createBufferOnWrite=this._engine._features.trackUbosInFrame;else this.create()}_createNewBuffer(){this._bufferIndex+1<this._buffers.length?(this._bufferIndex++,this._buffer=this._buffers[this._bufferIndex][0],this._createBufferOnWrite=!1,this._needSync=!0):this._rebuild()}_checkNewFrame(){this._engine._features.trackUbosInFrame&&this._currentFrameId!==this._engine.frameId&&(this._currentFrameId=this._engine.frameId,this._createBufferOnWrite=!1,this._buffers&&this._buffers.length>0?(this._needSync=0!==this._bufferIndex,this._bufferIndex=0,this._buffer=this._buffers[this._bufferIndex][0]):this._bufferIndex=-1)}updateUniform(e,t,i){this._checkNewFrame();let r=this._uniformLocations[e];if(void 0===r){if(this._buffer)return void s.Y.Error("Cannot add an uniform after UBO has been created.");this.addUniform(e,i),r=this._uniformLocations[e]}if(this._buffer||this.create(),this._dynamic)for(let s=0;s<i;s++)this._bufferData[r+s]=t[s];else{let e=!1;for(let s=0;s<i;s++)(16===i&&!this._engine._features.uniformBufferHardCheckMatrix||this._bufferData[r+s]!==n.w1.FloatRound(t[s]))&&(e=!0,this._createBufferOnWrite&&this._createNewBuffer(),this._bufferData[r+s]=t[s]);this._needSync=this._needSync||e}}updateUniformArray(e,t,i){this._checkNewFrame();const r=this._uniformLocations[e];if(void 0===r)return void s.Y.Error("Cannot add an uniform Array dynamically. Please, add it using addUniform and make sure that uniform buffers are supported by the current engine.");this._buffer||this.create();const a=this._uniformArraySizes[e];if(this._dynamic)for(let s=0;s<i;s++)this._bufferData[r+s]=t[s];else{let e=!1,s=0,o=0;for(let l=0;l<i;l++)if(this._bufferData[r+4*o+s]!==n.w1.FloatRound(t[l])&&(e=!0,this._createBufferOnWrite&&this._createNewBuffer(),this._bufferData[r+4*o+s]=t[l]),s++,s===a.strideSize){for(;s<4;s++)this._bufferData[r+4*o+s]=0;s=0,o++}this._needSync=this._needSync||e}}_cacheMatrix(e,t){this._checkNewFrame();const i=this._valueCache[e],s=t.updateFlag;return(void 0===i||i!==s)&&(this._valueCache[e]=s,!0)}_updateMatrix3x3ForUniform(e,t){for(let i=0;i<3;i++)o._TempBuffer[4*i]=t[3*i],o._TempBuffer[4*i+1]=t[3*i+1],o._TempBuffer[4*i+2]=t[3*i+2],o._TempBuffer[4*i+3]=0;this.updateUniform(e,o._TempBuffer,12)}_updateMatrix3x3ForEffect(e,t){this._currentEffect.setMatrix3x3(e,t)}_updateMatrix2x2ForEffect(e,t){this._currentEffect.setMatrix2x2(e,t)}_updateMatrix2x2ForUniform(e,t){for(let i=0;i<2;i++)o._TempBuffer[4*i]=t[2*i],o._TempBuffer[4*i+1]=t[2*i+1],o._TempBuffer[4*i+2]=0,o._TempBuffer[4*i+3]=0;this.updateUniform(e,o._TempBuffer,8)}_updateFloatForEffect(e,t){this._currentEffect.setFloat(e,t)}_updateFloatForUniform(e,t){o._TempBuffer[0]=t,this.updateUniform(e,o._TempBuffer,1)}_updateFloat2ForEffect(e,t,i){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";this._currentEffect.setFloat2(e+s,t,i)}_updateFloat2ForUniform(e,t,i){o._TempBuffer[0]=t,o._TempBuffer[1]=i,this.updateUniform(e,o._TempBuffer,2)}_updateFloat3ForEffect(e,t,i,s){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";this._currentEffect.setFloat3(e+n,t,i,s)}_updateFloat3ForUniform(e,t,i,s){o._TempBuffer[0]=t,o._TempBuffer[1]=i,o._TempBuffer[2]=s,this.updateUniform(e,o._TempBuffer,3)}_updateFloat4ForEffect(e,t,i,s,n){let r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"";this._currentEffect.setFloat4(e+r,t,i,s,n)}_updateFloat4ForUniform(e,t,i,s,n){o._TempBuffer[0]=t,o._TempBuffer[1]=i,o._TempBuffer[2]=s,o._TempBuffer[3]=n,this.updateUniform(e,o._TempBuffer,4)}_updateFloatArrayForEffect(e,t){this._currentEffect.setFloatArray(e,t)}_updateFloatArrayForUniform(e,t){this.updateUniformArray(e,t,t.length)}_updateArrayForEffect(e,t){this._currentEffect.setArray(e,t)}_updateArrayForUniform(e,t){this.updateUniformArray(e,t,t.length)}_updateIntArrayForEffect(e,t){this._currentEffect.setIntArray(e,t)}_updateIntArrayForUniform(e,t){o._TempBufferInt32View.set(t),this.updateUniformArray(e,o._TempBuffer,t.length)}_updateUIntArrayForEffect(e,t){this._currentEffect.setUIntArray(e,t)}_updateUIntArrayForUniform(e,t){o._TempBufferUInt32View.set(t),this.updateUniformArray(e,o._TempBuffer,t.length)}_updateMatrixForEffect(e,t){this._currentEffect.setMatrix(e,t)}_updateMatrixForUniform(e,t){this._cacheMatrix(e,t)&&this.updateUniform(e,t.toArray(),16)}_updateMatricesForEffect(e,t){this._currentEffect.setMatrices(e,t)}_updateMatricesForUniform(e,t){this.updateUniform(e,t,t.length)}_updateVector3ForEffect(e,t){this._currentEffect.setVector3(e,t)}_updateVector3ForUniform(e,t){o._TempBuffer[0]=t.x,o._TempBuffer[1]=t.y,o._TempBuffer[2]=t.z,this.updateUniform(e,o._TempBuffer,3)}_updateVector4ForEffect(e,t){this._currentEffect.setVector4(e,t)}_updateVector4ForUniform(e,t){o._TempBuffer[0]=t.x,o._TempBuffer[1]=t.y,o._TempBuffer[2]=t.z,o._TempBuffer[3]=t.w,this.updateUniform(e,o._TempBuffer,4)}_updateColor3ForEffect(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";this._currentEffect.setColor3(e+i,t)}_updateColor3ForUniform(e,t){o._TempBuffer[0]=t.r,o._TempBuffer[1]=t.g,o._TempBuffer[2]=t.b,this.updateUniform(e,o._TempBuffer,3)}_updateColor4ForEffect(e,t,i){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";this._currentEffect.setColor4(e+s,t,i)}_updateDirectColor4ForEffect(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";this._currentEffect.setDirectColor4(e+i,t)}_updateColor4ForUniform(e,t,i){o._TempBuffer[0]=t.r,o._TempBuffer[1]=t.g,o._TempBuffer[2]=t.b,o._TempBuffer[3]=i,this.updateUniform(e,o._TempBuffer,4)}_updateDirectColor4ForUniform(e,t){o._TempBuffer[0]=t.r,o._TempBuffer[1]=t.g,o._TempBuffer[2]=t.b,o._TempBuffer[3]=t.a,this.updateUniform(e,o._TempBuffer,4)}_updateIntForEffect(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";this._currentEffect.setInt(e+i,t)}_updateIntForUniform(e,t){o._TempBufferInt32View[0]=t,this.updateUniform(e,o._TempBuffer,1)}_updateInt2ForEffect(e,t,i){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";this._currentEffect.setInt2(e+s,t,i)}_updateInt2ForUniform(e,t,i){o._TempBufferInt32View[0]=t,o._TempBufferInt32View[1]=i,this.updateUniform(e,o._TempBuffer,2)}_updateInt3ForEffect(e,t,i,s){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";this._currentEffect.setInt3(e+n,t,i,s)}_updateInt3ForUniform(e,t,i,s){o._TempBufferInt32View[0]=t,o._TempBufferInt32View[1]=i,o._TempBufferInt32View[2]=s,this.updateUniform(e,o._TempBuffer,3)}_updateInt4ForEffect(e,t,i,s,n){let r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"";this._currentEffect.setInt4(e+r,t,i,s,n)}_updateInt4ForUniform(e,t,i,s,n){o._TempBufferInt32View[0]=t,o._TempBufferInt32View[1]=i,o._TempBufferInt32View[2]=s,o._TempBufferInt32View[3]=n,this.updateUniform(e,o._TempBuffer,4)}_updateUIntForEffect(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";this._currentEffect.setUInt(e+i,t)}_updateUIntForUniform(e,t){o._TempBufferUInt32View[0]=t,this.updateUniform(e,o._TempBuffer,1)}_updateUInt2ForEffect(e,t,i){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";this._currentEffect.setUInt2(e+s,t,i)}_updateUInt2ForUniform(e,t,i){o._TempBufferUInt32View[0]=t,o._TempBufferUInt32View[1]=i,this.updateUniform(e,o._TempBuffer,2)}_updateUInt3ForEffect(e,t,i,s){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";this._currentEffect.setUInt3(e+n,t,i,s)}_updateUInt3ForUniform(e,t,i,s){o._TempBufferUInt32View[0]=t,o._TempBufferUInt32View[1]=i,o._TempBufferUInt32View[2]=s,this.updateUniform(e,o._TempBuffer,3)}_updateUInt4ForEffect(e,t,i,s,n){let r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"";this._currentEffect.setUInt4(e+r,t,i,s,n)}_updateUInt4ForUniform(e,t,i,s,n){o._TempBufferUInt32View[0]=t,o._TempBufferUInt32View[1]=i,o._TempBufferUInt32View[2]=s,o._TempBufferUInt32View[3]=n,this.updateUniform(e,o._TempBuffer,4)}setTexture(e,t){this._currentEffect.setTexture(e,t)}updateUniformDirectly(e,t){this.updateUniform(e,t,t.length),this.update()}bindToEffect(e,t){this._currentEffect=e,this._currentEffectName=t}bindUniformBuffer(){!this._noUBO&&this._buffer&&this._currentEffect&&this._currentEffect.bindUniformBuffer(this._buffer,this._currentEffectName)}unbindEffect(){this._currentEffect=void 0,this._currentEffectName=void 0}setDataBuffer(e){if(!this._buffers)return this._buffer===e;for(let t=0;t<this._buffers.length;++t){if(this._buffers[t][0]===e)return this._bufferIndex=t,this._buffer=e,this._createBufferOnWrite=!1,this._currentEffect=void 0,!0}return!1}dispose(){if(this._noUBO)return;const e=this._engine._uniformBuffers,t=e.indexOf(this);if(-1!==t&&(e[t]=e[e.length-1],e.pop()),this._engine._features.trackUbosInFrame&&this._buffers)for(let i=0;i<this._buffers.length;++i){const e=this._buffers[i][0];this._engine._releaseBuffer(e)}else this._buffer&&this._engine._releaseBuffer(this._buffer)&&(this._buffer=null)}}o._UpdatedUbosInFrame={},o._MAX_UNIFORM_SIZE=256,o._TempBuffer=new Float32Array(o._MAX_UNIFORM_SIZE),o._TempBufferInt32View=new Int32Array(o._TempBuffer.buffer),o._TempBufferUInt32View=new Uint32Array(o._TempBuffer.buffer)},7702:function(e,t,i){"use strict";i.d(t,{RD:function(){return a},T:function(){return s}});var s,n,r=i(6900);!function(e){e[e.LOCAL=0]="LOCAL",e[e.WORLD=1]="WORLD",e[e.BONE=2]="BONE"}(s||(s={}));class a{}a.X=new r.P(1,0,0),a.Y=new r.P(0,1,0),a.Z=new r.P(0,0,1),function(e){e[e.X=0]="X",e[e.Y=1]="Y",e[e.Z=2]="Z"}(n||(n={}))},7046:function(e,t,i){"use strict";i.d(t,{HE:function(){return d},Wo:function(){return u}});var s=i(5602),n=i(3681),r=i(8134),a=i(1704);function o(e){return Math.pow(e,n.Nn)}function l(e){return e<=.04045?.0773993808*e:Math.pow(.947867299*(e+.055),2.4)}function h(e){return Math.pow(e,n.zp)}function c(e){return e<=.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}class u{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.r=e,this.g=t,this.b=i}toString(){return"{R: "+this.r+" G:"+this.g+" B:"+this.b+"}"}getClassName(){return"Color3"}getHashCode(){let e=255*this.r|0;return e=397*e^(255*this.g|0),e=397*e^(255*this.b|0),e}toArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,this}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return u.FromArrayToRef(e,t,this),this}toColor4(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return new d(this.r,this.g,this.b,e)}asArray(){return[this.r,this.g,this.b]}toLuminance(){return.3*this.r+.59*this.g+.11*this.b}multiply(e){return new u(this.r*e.r,this.g*e.g,this.b*e.b)}multiplyToRef(e,t){return t.r=this.r*e.r,t.g=this.g*e.g,t.b=this.b*e.b,this}equals(e){return e&&this.r===e.r&&this.g===e.g&&this.b===e.b}equalsFloats(e,t,i){return this.r===e&&this.g===t&&this.b===i}scale(e){return new u(this.r*e,this.g*e,this.b*e)}scaleInPlace(e){return this.r*=e,this.g*=e,this.b*=e,this}scaleToRef(e,t){return t.r=this.r*e,t.g=this.g*e,t.b=this.b*e,this}scaleAndAddToRef(e,t){return t.r+=this.r*e,t.g+=this.g*e,t.b+=this.b*e,this}clampToRef(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0;return i.r=s.R.Clamp(this.r,e,t),i.g=s.R.Clamp(this.g,e,t),i.b=s.R.Clamp(this.b,e,t),this}add(e){return new u(this.r+e.r,this.g+e.g,this.b+e.b)}addToRef(e,t){return t.r=this.r+e.r,t.g=this.g+e.g,t.b=this.b+e.b,this}subtract(e){return new u(this.r-e.r,this.g-e.g,this.b-e.b)}subtractToRef(e,t){return t.r=this.r-e.r,t.g=this.g-e.g,t.b=this.b-e.b,this}clone(){return new u(this.r,this.g,this.b)}copyFrom(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copyFromFloats(e,t,i){return this.r=e,this.g=t,this.b=i,this}set(e,t,i){return this.copyFromFloats(e,t,i)}toHexString(){const e=Math.round(255*this.r),t=Math.round(255*this.g),i=Math.round(255*this.b);return"#"+s.R.ToHex(e)+s.R.ToHex(t)+s.R.ToHex(i)}toHSV(){const e=new u;return this.toHSVToRef(e),e}toHSVToRef(e){const t=this.r,i=this.g,s=this.b,n=Math.max(t,i,s),r=Math.min(t,i,s);let a=0,o=0;const l=n,h=n-r;0!==n&&(o=h/n),n!=r&&(n==t?(a=(i-s)/h,i<s&&(a+=6)):n==i?a=(s-t)/h+2:n==s&&(a=(t-i)/h+4),a*=60),e.r=a,e.g=o,e.b=l}toLinearSpace(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=new u;return this.toLinearSpaceToRef(t,e),t}toLinearSpaceToRef(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]?(e.r=l(this.r),e.g=l(this.g),e.b=l(this.b)):(e.r=o(this.r),e.g=o(this.g),e.b=o(this.b)),this}toGammaSpace(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=new u;return this.toGammaSpaceToRef(t,e),t}toGammaSpaceToRef(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]?(e.r=c(this.r),e.g=c(this.g),e.b=c(this.b)):(e.r=h(this.r),e.g=h(this.g),e.b=h(this.b)),this}static HSVtoRGBToRef(e,t,i,s){const n=i*t,r=e/60,a=n*(1-Math.abs(r%2-1));let o=0,l=0,h=0;r>=0&&r<=1?(o=n,l=a):r>=1&&r<=2?(o=a,l=n):r>=2&&r<=3?(l=n,h=a):r>=3&&r<=4?(l=a,h=n):r>=4&&r<=5?(o=a,h=n):r>=5&&r<=6&&(o=n,h=a);const c=i-n;s.set(o+c,l+c,h+c)}static FromHSV(e,t,i){const s=new u(0,0,0);return u.HSVtoRGBToRef(e,t,i,s),s}static FromHexString(e){if("#"!==e.substring(0,1)||7!==e.length)return new u(0,0,0);const t=parseInt(e.substring(1,3),16),i=parseInt(e.substring(3,5),16),s=parseInt(e.substring(5,7),16);return u.FromInts(t,i,s)}static FromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return new u(e[t],e[t+1],e[t+2])}static FromArrayToRef(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0;i.r=e[t],i.g=e[t+1],i.b=e[t+2]}static FromInts(e,t,i){return new u(e/255,t/255,i/255)}static Lerp(e,t,i){const s=new u(0,0,0);return u.LerpToRef(e,t,i,s),s}static LerpToRef(e,t,i,s){s.r=e.r+(t.r-e.r)*i,s.g=e.g+(t.g-e.g)*i,s.b=e.b+(t.b-e.b)*i}static Hermite(e,t,i,s,n){const r=n*n,a=n*r,o=2*a-3*r+1,l=-2*a+3*r,h=a-2*r+n,c=a-r,d=e.r*o+i.r*l+t.r*h+s.r*c,f=e.g*o+i.g*l+t.g*h+s.g*c,p=e.b*o+i.b*l+t.b*h+s.b*c;return new u(d,f,p)}static Hermite1stDerivative(e,t,i,s,n){const r=u.Black();return this.Hermite1stDerivativeToRef(e,t,i,s,n,r),r}static Hermite1stDerivativeToRef(e,t,i,s,n,r){const a=n*n;r.r=6*(a-n)*e.r+(3*a-4*n+1)*t.r+6*(-a+n)*i.r+(3*a-2*n)*s.r,r.g=6*(a-n)*e.g+(3*a-4*n+1)*t.g+6*(-a+n)*i.g+(3*a-2*n)*s.g,r.b=6*(a-n)*e.b+(3*a-4*n+1)*t.b+6*(-a+n)*i.b+(3*a-2*n)*s.b}static Red(){return new u(1,0,0)}static Green(){return new u(0,1,0)}static Blue(){return new u(0,0,1)}static Black(){return new u(0,0,0)}static get BlackReadOnly(){return u._BlackReadOnly}static White(){return new u(1,1,1)}static Purple(){return new u(.5,0,.5)}static Magenta(){return new u(1,0,1)}static Yellow(){return new u(1,1,0)}static Gray(){return new u(.5,.5,.5)}static Teal(){return new u(0,1,1)}static Random(){return new u(Math.random(),Math.random(),Math.random())}}u._BlackReadOnly=u.Black();class d{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;this.r=e,this.g=t,this.b=i,this.a=s}addInPlace(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this.a+=e.a,this}asArray(){return[this.r,this.g,this.b,this.a]}toArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e[t+3]=this.a,this}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return d.FromArrayToRef(e,t,this),this}equals(e){return e&&this.r===e.r&&this.g===e.g&&this.b===e.b&&this.a===e.a}add(e){return new d(this.r+e.r,this.g+e.g,this.b+e.b,this.a+e.a)}subtract(e){return new d(this.r-e.r,this.g-e.g,this.b-e.b,this.a-e.a)}subtractToRef(e,t){return t.r=this.r-e.r,t.g=this.g-e.g,t.b=this.b-e.b,t.a=this.a-e.a,this}scale(e){return new d(this.r*e,this.g*e,this.b*e,this.a*e)}scaleInPlace(e){return this.r*=e,this.g*=e,this.b*=e,this.a*=e,this}scaleToRef(e,t){return t.r=this.r*e,t.g=this.g*e,t.b=this.b*e,t.a=this.a*e,this}scaleAndAddToRef(e,t){return t.r+=this.r*e,t.g+=this.g*e,t.b+=this.b*e,t.a+=this.a*e,this}clampToRef(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0;return i.r=s.R.Clamp(this.r,e,t),i.g=s.R.Clamp(this.g,e,t),i.b=s.R.Clamp(this.b,e,t),i.a=s.R.Clamp(this.a,e,t),this}multiply(e){return new d(this.r*e.r,this.g*e.g,this.b*e.b,this.a*e.a)}multiplyToRef(e,t){return t.r=this.r*e.r,t.g=this.g*e.g,t.b=this.b*e.b,t.a=this.a*e.a,t}toString(){return"{R: "+this.r+" G:"+this.g+" B:"+this.b+" A:"+this.a+"}"}getClassName(){return"Color4"}getHashCode(){let e=255*this.r|0;return e=397*e^(255*this.g|0),e=397*e^(255*this.b|0),e=397*e^(255*this.a|0),e}clone(){return new d(this.r,this.g,this.b,this.a)}copyFrom(e){return this.r=e.r,this.g=e.g,this.b=e.b,this.a=e.a,this}copyFromFloats(e,t,i,s){return this.r=e,this.g=t,this.b=i,this.a=s,this}set(e,t,i,s){return this.copyFromFloats(e,t,i,s)}toHexString(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=Math.round(255*this.r),i=Math.round(255*this.g),n=Math.round(255*this.b);if(e)return"#"+s.R.ToHex(t)+s.R.ToHex(i)+s.R.ToHex(n);const r=Math.round(255*this.a);return"#"+s.R.ToHex(t)+s.R.ToHex(i)+s.R.ToHex(n)+s.R.ToHex(r)}toLinearSpace(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=new d;return this.toLinearSpaceToRef(t,e),t}toLinearSpaceToRef(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]?(e.r=l(this.r),e.g=l(this.g),e.b=l(this.b)):(e.r=o(this.r),e.g=o(this.g),e.b=o(this.b)),e.a=this.a,this}toGammaSpace(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=new d;return this.toGammaSpaceToRef(t,e),t}toGammaSpaceToRef(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]?(e.r=c(this.r),e.g=c(this.g),e.b=c(this.b)):(e.r=h(this.r),e.g=h(this.g),e.b=h(this.b)),e.a=this.a,this}static FromHexString(e){if("#"!==e.substring(0,1)||9!==e.length&&7!==e.length)return new d(0,0,0,0);const t=parseInt(e.substring(1,3),16),i=parseInt(e.substring(3,5),16),s=parseInt(e.substring(5,7),16),n=9===e.length?parseInt(e.substring(7,9),16):255;return d.FromInts(t,i,s,n)}static Lerp(e,t,i){const s=new d(0,0,0,0);return d.LerpToRef(e,t,i,s),s}static LerpToRef(e,t,i,s){s.r=e.r+(t.r-e.r)*i,s.g=e.g+(t.g-e.g)*i,s.b=e.b+(t.b-e.b)*i,s.a=e.a+(t.a-e.a)*i}static Hermite(e,t,i,s,n){const r=n*n,a=n*r,o=2*a-3*r+1,l=-2*a+3*r,h=a-2*r+n,c=a-r,u=e.r*o+i.r*l+t.r*h+s.r*c,f=e.g*o+i.g*l+t.g*h+s.g*c,p=e.b*o+i.b*l+t.b*h+s.b*c,g=e.a*o+i.a*l+t.a*h+s.a*c;return new d(u,f,p,g)}static Hermite1stDerivative(e,t,i,s,n){const r=new d;return this.Hermite1stDerivativeToRef(e,t,i,s,n,r),r}static Hermite1stDerivativeToRef(e,t,i,s,n,r){const a=n*n;r.r=6*(a-n)*e.r+(3*a-4*n+1)*t.r+6*(-a+n)*i.r+(3*a-2*n)*s.r,r.g=6*(a-n)*e.g+(3*a-4*n+1)*t.g+6*(-a+n)*i.g+(3*a-2*n)*s.g,r.b=6*(a-n)*e.b+(3*a-4*n+1)*t.b+6*(-a+n)*i.b+(3*a-2*n)*s.b,r.a=6*(a-n)*e.a+(3*a-4*n+1)*t.a+6*(-a+n)*i.a+(3*a-2*n)*s.a}static FromColor3(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return new d(e.r,e.g,e.b,t)}static FromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return new d(e[t],e[t+1],e[t+2],e[t+3])}static FromArrayToRef(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0;i.r=e[t],i.g=e[t+1],i.b=e[t+2],i.a=e[t+3]}static FromInts(e,t,i,s){return new d(e/255,t/255,i/255,s/255)}static CheckColors4(e,t){if(e.length===3*t){const t=[];for(let i=0;i<e.length;i+=3){const s=i/3*4;t[s]=e[i],t[s+1]=e[i+1],t[s+2]=e[i+2],t[s+3]=1}return t}return e}}class f{}f.Color3=r.B.BuildArray(3,u.Black),f.Color4=r.B.BuildArray(3,(()=>new d(0,0,0,0))),(0,a.H)("BABYLON.Color3",u),(0,a.H)("BABYLON.Color4",d)},3681:function(e,t,i){"use strict";i.d(t,{Nn:function(){return n},kn:function(){return r},zp:function(){return s}});const s=1/2.2,n=2.2,r=(Math.sqrt(5),.001)},2465:function(e,t,i){"use strict";i.d(t,{i:function(){return n}});var s=i(3683);class n{static GetPlanes(e){const t=[];for(let i=0;i<6;i++)t.push(new s.J(0,0,0,0));return n.GetPlanesToRef(e,t),t}static GetNearPlaneToRef(e,t){const i=e.m;t.normal.x=i[3]+i[2],t.normal.y=i[7]+i[6],t.normal.z=i[11]+i[10],t.d=i[15]+i[14],t.normalize()}static GetFarPlaneToRef(e,t){const i=e.m;t.normal.x=i[3]-i[2],t.normal.y=i[7]-i[6],t.normal.z=i[11]-i[10],t.d=i[15]-i[14],t.normalize()}static GetLeftPlaneToRef(e,t){const i=e.m;t.normal.x=i[3]+i[0],t.normal.y=i[7]+i[4],t.normal.z=i[11]+i[8],t.d=i[15]+i[12],t.normalize()}static GetRightPlaneToRef(e,t){const i=e.m;t.normal.x=i[3]-i[0],t.normal.y=i[7]-i[4],t.normal.z=i[11]-i[8],t.d=i[15]-i[12],t.normalize()}static GetTopPlaneToRef(e,t){const i=e.m;t.normal.x=i[3]-i[1],t.normal.y=i[7]-i[5],t.normal.z=i[11]-i[9],t.d=i[15]-i[13],t.normalize()}static GetBottomPlaneToRef(e,t){const i=e.m;t.normal.x=i[3]+i[1],t.normal.y=i[7]+i[5],t.normal.z=i[11]+i[9],t.d=i[15]+i[13],t.normalize()}static GetPlanesToRef(e,t){n.GetNearPlaneToRef(e,t[0]),n.GetFarPlaneToRef(e,t[1]),n.GetLeftPlaneToRef(e,t[2]),n.GetRightPlaneToRef(e,t[3]),n.GetTopPlaneToRef(e,t[4]),n.GetBottomPlaneToRef(e,t[5])}static IsPointInFrustum(e,t){for(let i=0;i<6;i++)if(t[i].dotCoordinate(e)<0)return!1;return!0}}},7721:function(e,t,i){"use strict";i.d(t,{k:function(){return l},y:function(){return o}});var s=i(9477),n=i(6900),r=i(9336);class a{static extractMinAndMaxIndexed(e,t,i,s,n,r){for(let a=i;a<i+s;a++){const i=3*t[a],s=e[i],o=e[i+1],l=e[i+2];n.minimizeInPlaceFromFloats(s,o,l),r.maximizeInPlaceFromFloats(s,o,l)}}static extractMinAndMax(e,t,i,s,n,r){for(let a=t,o=t*s;a<t+i;a++,o+=s){const t=e[o],i=e[o+1],s=e[o+2];n.minimizeInPlaceFromFloats(t,i,s),r.maximizeInPlaceFromFloats(t,i,s)}}}function o(e,t,i,s){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;const o=new n.P(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),l=new n.P(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);return a.extractMinAndMaxIndexed(e,t,i,s,o,l),r&&(o.x-=o.x*r.x+r.y,o.y-=o.y*r.x+r.y,o.z-=o.z*r.x+r.y,l.x+=l.x*r.x+r.y,l.y+=l.y*r.x+r.y,l.z+=l.z*r.x+r.y),{minimum:o,maximum:l}}function l(e,t,i){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4?arguments[4]:void 0;const o=new n.P(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),l=new n.P(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);return r||(r=3),a.extractMinAndMax(e,t,i,r,o,l),s&&(o.x-=o.x*s.x+s.y,o.y-=o.y*s.x+s.y,o.z-=o.z*s.x+s.y,l.x+=l.x*s.x+s.y,l.y+=l.y*s.x+s.y,l.z+=l.z*s.x+s.y),{minimum:o,maximum:l}}(0,s.gn)([r.G6.filter((function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];let[s,n]=t;return!Array.isArray(s)&&!Array.isArray(n)}))],a,"extractMinAndMaxIndexed",null),(0,s.gn)([r.G6.filter((function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];let[s]=t;return!Array.isArray(s)}))],a,"extractMinAndMax",null)},3683:function(e,t,i){"use strict";i.d(t,{J:function(){return n}});var s=i(6900);class n{constructor(e,t,i,n){this.normal=new s.P(e,t,i),this.d=n}asArray(){return[this.normal.x,this.normal.y,this.normal.z,this.d]}clone(){return new n(this.normal.x,this.normal.y,this.normal.z,this.d)}getClassName(){return"Plane"}getHashCode(){let e=this.normal.getHashCode();return e=397*e^(0|this.d),e}normalize(){const e=Math.sqrt(this.normal.x*this.normal.x+this.normal.y*this.normal.y+this.normal.z*this.normal.z);let t=0;return 0!==e&&(t=1/e),this.normal.x*=t,this.normal.y*=t,this.normal.z*=t,this.d*=t,this}transform(e){const t=n._TmpMatrix;e.invertToRef(t);const i=t.m,s=this.normal.x,r=this.normal.y,a=this.normal.z,o=this.d,l=s*i[0]+r*i[1]+a*i[2]+o*i[3],h=s*i[4]+r*i[5]+a*i[6]+o*i[7],c=s*i[8]+r*i[9]+a*i[10]+o*i[11],u=s*i[12]+r*i[13]+a*i[14]+o*i[15];return new n(l,h,c,u)}dotCoordinate(e){return this.normal.x*e.x+this.normal.y*e.y+this.normal.z*e.z+this.d}copyFromPoints(e,t,i){const s=t.x-e.x,n=t.y-e.y,r=t.z-e.z,a=i.x-e.x,o=i.y-e.y,l=i.z-e.z,h=n*l-r*o,c=r*a-s*l,u=s*o-n*a,d=Math.sqrt(h*h+c*c+u*u);let f;return f=0!==d?1/d:0,this.normal.x=h*f,this.normal.y=c*f,this.normal.z=u*f,this.d=-(this.normal.x*e.x+this.normal.y*e.y+this.normal.z*e.z),this}isFrontFacingTo(e,t){return s.P.Dot(this.normal,e)<=t}signedDistanceTo(e){return s.P.Dot(e,this.normal)+this.d}static FromArray(e){return new n(e[0],e[1],e[2],e[3])}static FromPoints(e,t,i){const s=new n(0,0,0,0);return s.copyFromPoints(e,t,i),s}static FromPositionAndNormal(e,t){const i=new n(0,0,0,0);return t.normalize(),i.normal=t,i.d=-(t.x*e.x+t.y*e.y+t.z*e.z),i}static SignedDistanceToPlaneFromPositionAndNormal(e,t,i){const n=-(t.x*e.x+t.y*e.y+t.z*e.z);return s.P.Dot(i,t)+n}}n._TmpMatrix=s.y3.Identity()},5602:function(e,t,i){"use strict";i.d(t,{R:function(){return s}});class s{static WithinEpsilon(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1401298e-51;return Math.abs(e-t)<=i}static ToHex(e){const t=e.toString(16);return e<=15?("0"+t).toUpperCase():t.toUpperCase()}static Sign(e){return 0===(e=+e)||isNaN(e)?e:e>0?1:-1}static Clamp(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return Math.min(i,Math.max(t,e))}static Log2(e){return Math.log(e)*Math.LOG2E}static ILog2(e){if(Math.log2)return Math.floor(Math.log2(e));if(e<0)return NaN;if(0===e)return-1/0;let t=0;if(e<1){for(;e<1;)t++,e*=2;t=-t}else if(e>1)for(;e>1;)t++,e=Math.floor(e/2);return t}static Repeat(e,t){return e-Math.floor(e/t)*t}static Normalize(e,t,i){return(e-t)/(i-t)}static Denormalize(e,t,i){return e*(i-t)+t}static DeltaAngle(e,t){let i=s.Repeat(t-e,360);return i>180&&(i-=360),i}static PingPong(e,t){const i=s.Repeat(e,2*t);return t-Math.abs(i-t)}static SmoothStep(e,t,i){let n=s.Clamp(i);return n=-2*n*n*n+3*n*n,t*n+e*(1-n)}static MoveTowards(e,t,i){let n=0;return n=Math.abs(t-e)<=i?t:e+s.Sign(t-e)*i,n}static MoveTowardsAngle(e,t,i){const n=s.DeltaAngle(e,t);let r=0;return-i<n&&n<i?r=t:(t=e+n,r=s.MoveTowards(e,t,i)),r}static Lerp(e,t,i){return e+(t-e)*i}static LerpAngle(e,t,i){let n=s.Repeat(t-e,360);return n>180&&(n-=360),e+n*s.Clamp(i)}static InverseLerp(e,t,i){let n=0;return n=e!=t?s.Clamp((i-e)/(t-e)):0,n}static Hermite(e,t,i,s,n){const r=n*n,a=n*r;return e*(2*a-3*r+1)+i*(-2*a+3*r)+t*(a-2*r+n)+s*(a-r)}static Hermite1stDerivative(e,t,i,s,n){const r=n*n;return 6*(r-n)*e+(3*r-4*n+1)*t+6*(-r+n)*i+(3*r-2*n)*s}static RandomRange(e,t){return e===t?e:Math.random()*(t-e)+e}static RangeToPercent(e,t,i){return(e-t)/(i-t)}static PercentToRange(e,t,i){return(i-t)*e+t}static NormalizeRadians(e){return e-=s.TwoPi*Math.floor((e+Math.PI)/s.TwoPi)}static HCF(e,t){const i=e%t;return 0===i?t:s.HCF(t,i)}}s.TwoPi=2*Math.PI},628:function(e,t,i){"use strict";i.d(t,{l:function(){return s}});class s{constructor(e,t,i,s){this.x=e,this.y=t,this.width=i,this.height=s}toGlobal(e,t){return new s(this.x*e,this.y*t,this.width*e,this.height*t)}toGlobalToRef(e,t,i){return i.x=this.x*e,i.y=this.y*t,i.width=this.width*e,i.height=this.height*t,this}clone(){return new s(this.x,this.y,this.width,this.height)}}},2628:function(e,t,i){"use strict";i.d(t,{M:function(){return n}});var s=i(7818);class n extends s.h{constructor(e){super(),this._buffer=e}get underlyingResource(){return this._buffer}}},9370:function(e,t,i){"use strict";i.d(t,{x:function(){return M}});var s=i(4174),n=i(1962),r=i(6900),a=i(2977),o=i(2845),l=i(4527),h=i(2668),c=i(3541),u=i(9115),d=i(1952);class f{constructor(){this._checkCollisions=!1,this._collisionMask=-1,this._collisionGroup=-1,this._surroundingMeshes=null,this._collider=null,this._oldPositionForCollisions=new r.P(0,0,0),this._diffPositionForCollisions=new r.P(0,0,0),this._collisionResponse=!0}}var p=i(5230),g=i(7721),m=i(7046),_=i(3681),v=i(7702),b=i(1704);class E{constructor(){this.facetNb=0,this.partitioningSubdivisions=10,this.partitioningBBoxRatio=1.01,this.facetDataEnabled=!1,this.facetParameters={},this.bbSize=r.P.Zero(),this.subDiv={max:1,X:1,Y:1,Z:1},this.facetDepthSort=!1,this.facetDepthSortEnabled=!1}}class y{constructor(){this._hasVertexAlpha=!1,this._useVertexColors=!0,this._numBoneInfluencers=4,this._applyFog=!0,this._receiveShadows=!1,this._facetData=new E,this._visibility=1,this._skeleton=null,this._layerMask=268435455,this._computeBonesUsingShaders=!0,this._isActive=!1,this._onlyForInstances=!1,this._isActiveIntermediate=!1,this._onlyForInstancesIntermediate=!1,this._actAsRegularMesh=!1,this._currentLOD=null,this._currentLODIsUpToDate=!1,this._collisionRetryCount=3,this._morphTargetManager=null,this._renderingGroupId=0,this._bakedVertexAnimationManager=null,this._material=null,this._positions=null,this._pointerOverDisableMeshTesting=!1,this._meshCollisionData=new f,this._enableDistantPicking=!1}}class M extends h.Y{static get BILLBOARDMODE_NONE(){return h.Y.BILLBOARDMODE_NONE}static get BILLBOARDMODE_X(){return h.Y.BILLBOARDMODE_X}static get BILLBOARDMODE_Y(){return h.Y.BILLBOARDMODE_Y}static get BILLBOARDMODE_Z(){return h.Y.BILLBOARDMODE_Z}static get BILLBOARDMODE_ALL(){return h.Y.BILLBOARDMODE_ALL}static get BILLBOARDMODE_USE_POSITION(){return h.Y.BILLBOARDMODE_USE_POSITION}get facetNb(){return this._internalAbstractMeshDataInfo._facetData.facetNb}get partitioningSubdivisions(){return this._internalAbstractMeshDataInfo._facetData.partitioningSubdivisions}set partitioningSubdivisions(e){this._internalAbstractMeshDataInfo._facetData.partitioningSubdivisions=e}get partitioningBBoxRatio(){return this._internalAbstractMeshDataInfo._facetData.partitioningBBoxRatio}set partitioningBBoxRatio(e){this._internalAbstractMeshDataInfo._facetData.partitioningBBoxRatio=e}get mustDepthSortFacets(){return this._internalAbstractMeshDataInfo._facetData.facetDepthSort}set mustDepthSortFacets(e){this._internalAbstractMeshDataInfo._facetData.facetDepthSort=e}get facetDepthSortFrom(){return this._internalAbstractMeshDataInfo._facetData.facetDepthSortFrom}set facetDepthSortFrom(e){this._internalAbstractMeshDataInfo._facetData.facetDepthSortFrom=e}get collisionRetryCount(){return this._internalAbstractMeshDataInfo._collisionRetryCount}set collisionRetryCount(e){this._internalAbstractMeshDataInfo._collisionRetryCount=e}get isFacetDataEnabled(){return this._internalAbstractMeshDataInfo._facetData.facetDataEnabled}get morphTargetManager(){return this._internalAbstractMeshDataInfo._morphTargetManager}set morphTargetManager(e){this._internalAbstractMeshDataInfo._morphTargetManager!==e&&(this._internalAbstractMeshDataInfo._morphTargetManager=e,this._syncGeometryWithMorphTargetManager())}get bakedVertexAnimationManager(){return this._internalAbstractMeshDataInfo._bakedVertexAnimationManager}set bakedVertexAnimationManager(e){this._internalAbstractMeshDataInfo._bakedVertexAnimationManager!==e&&(this._internalAbstractMeshDataInfo._bakedVertexAnimationManager=e,this._markSubMeshesAsAttributesDirty())}_syncGeometryWithMorphTargetManager(){}_updateNonUniformScalingState(e){return!!super._updateNonUniformScalingState(e)&&(this._markSubMeshesAsMiscDirty(),!0)}set onCollide(e){this._internalAbstractMeshDataInfo._meshCollisionData._onCollideObserver&&this.onCollideObservable.remove(this._internalAbstractMeshDataInfo._meshCollisionData._onCollideObserver),this._internalAbstractMeshDataInfo._meshCollisionData._onCollideObserver=this.onCollideObservable.add(e)}set onCollisionPositionChange(e){this._internalAbstractMeshDataInfo._meshCollisionData._onCollisionPositionChangeObserver&&this.onCollisionPositionChangeObservable.remove(this._internalAbstractMeshDataInfo._meshCollisionData._onCollisionPositionChangeObserver),this._internalAbstractMeshDataInfo._meshCollisionData._onCollisionPositionChangeObserver=this.onCollisionPositionChangeObservable.add(e)}get visibility(){return this._internalAbstractMeshDataInfo._visibility}set visibility(e){if(this._internalAbstractMeshDataInfo._visibility===e)return;const t=this._internalAbstractMeshDataInfo._visibility;this._internalAbstractMeshDataInfo._visibility=e,(1===t&&1!==e||1!==t&&1===e)&&this._markSubMeshesAsMiscDirty()}get pointerOverDisableMeshTesting(){return this._internalAbstractMeshDataInfo._pointerOverDisableMeshTesting}set pointerOverDisableMeshTesting(e){this._internalAbstractMeshDataInfo._pointerOverDisableMeshTesting=e}get renderingGroupId(){return this._internalAbstractMeshDataInfo._renderingGroupId}set renderingGroupId(e){this._internalAbstractMeshDataInfo._renderingGroupId=e}get material(){return this._internalAbstractMeshDataInfo._material}set material(e){this._internalAbstractMeshDataInfo._material!==e&&(this._internalAbstractMeshDataInfo._material&&this._internalAbstractMeshDataInfo._material.meshMap&&(this._internalAbstractMeshDataInfo._material.meshMap[this.uniqueId]=void 0),this._internalAbstractMeshDataInfo._material=e,e&&e.meshMap&&(e.meshMap[this.uniqueId]=this),this.onMaterialChangedObservable.hasObservers()&&this.onMaterialChangedObservable.notifyObservers(this),this.subMeshes&&(this.resetDrawCache(),this._unBindEffect()))}getMaterialForRenderPass(e){var t;return null===(t=this._internalAbstractMeshDataInfo._materialForRenderPass)||void 0===t?void 0:t[e]}setMaterialForRenderPass(e,t){this.resetDrawCache(e),this._internalAbstractMeshDataInfo._materialForRenderPass||(this._internalAbstractMeshDataInfo._materialForRenderPass=[]),this._internalAbstractMeshDataInfo._materialForRenderPass[e]=t}get receiveShadows(){return this._internalAbstractMeshDataInfo._receiveShadows}set receiveShadows(e){this._internalAbstractMeshDataInfo._receiveShadows!==e&&(this._internalAbstractMeshDataInfo._receiveShadows=e,this._markSubMeshesAsLightDirty())}get hasVertexAlpha(){return this._internalAbstractMeshDataInfo._hasVertexAlpha}set hasVertexAlpha(e){this._internalAbstractMeshDataInfo._hasVertexAlpha!==e&&(this._internalAbstractMeshDataInfo._hasVertexAlpha=e,this._markSubMeshesAsAttributesDirty(),this._markSubMeshesAsMiscDirty())}get useVertexColors(){return this._internalAbstractMeshDataInfo._useVertexColors}set useVertexColors(e){this._internalAbstractMeshDataInfo._useVertexColors!==e&&(this._internalAbstractMeshDataInfo._useVertexColors=e,this._markSubMeshesAsAttributesDirty())}get computeBonesUsingShaders(){return this._internalAbstractMeshDataInfo._computeBonesUsingShaders}set computeBonesUsingShaders(e){this._internalAbstractMeshDataInfo._computeBonesUsingShaders!==e&&(this._internalAbstractMeshDataInfo._computeBonesUsingShaders=e,this._markSubMeshesAsAttributesDirty())}get numBoneInfluencers(){return this._internalAbstractMeshDataInfo._numBoneInfluencers}set numBoneInfluencers(e){this._internalAbstractMeshDataInfo._numBoneInfluencers!==e&&(this._internalAbstractMeshDataInfo._numBoneInfluencers=e,this._markSubMeshesAsAttributesDirty())}get applyFog(){return this._internalAbstractMeshDataInfo._applyFog}set applyFog(e){this._internalAbstractMeshDataInfo._applyFog!==e&&(this._internalAbstractMeshDataInfo._applyFog=e,this._markSubMeshesAsMiscDirty())}get enableDistantPicking(){return this._internalAbstractMeshDataInfo._enableDistantPicking}set enableDistantPicking(e){this._internalAbstractMeshDataInfo._enableDistantPicking=e}get layerMask(){return this._internalAbstractMeshDataInfo._layerMask}set layerMask(e){e!==this._internalAbstractMeshDataInfo._layerMask&&(this._internalAbstractMeshDataInfo._layerMask=e,this._resyncLightSources())}get collisionMask(){return this._internalAbstractMeshDataInfo._meshCollisionData._collisionMask}set collisionMask(e){this._internalAbstractMeshDataInfo._meshCollisionData._collisionMask=isNaN(e)?-1:e}get collisionResponse(){return this._internalAbstractMeshDataInfo._meshCollisionData._collisionResponse}set collisionResponse(e){this._internalAbstractMeshDataInfo._meshCollisionData._collisionResponse=e}get collisionGroup(){return this._internalAbstractMeshDataInfo._meshCollisionData._collisionGroup}set collisionGroup(e){this._internalAbstractMeshDataInfo._meshCollisionData._collisionGroup=isNaN(e)?-1:e}get surroundingMeshes(){return this._internalAbstractMeshDataInfo._meshCollisionData._surroundingMeshes}set surroundingMeshes(e){this._internalAbstractMeshDataInfo._meshCollisionData._surroundingMeshes=e}get lightSources(){return this._lightSources}get _positions(){return null}set skeleton(e){const t=this._internalAbstractMeshDataInfo._skeleton;t&&t.needInitialSkinMatrix&&t._unregisterMeshWithPoseMatrix(this),e&&e.needInitialSkinMatrix&&e._registerMeshWithPoseMatrix(this),this._internalAbstractMeshDataInfo._skeleton=e,this._internalAbstractMeshDataInfo._skeleton||(this._bonesTransformMatrices=null),this._markSubMeshesAsAttributesDirty()}get skeleton(){return this._internalAbstractMeshDataInfo._skeleton}constructor(e){var t;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;switch(super(e,i,!1),t=this,this._internalAbstractMeshDataInfo=new y,this._waitingMaterialId=null,this.cullingStrategy=M.CULLINGSTRATEGY_BOUNDINGSPHERE_ONLY,this.onCollideObservable=new s.y$,this.onCollisionPositionChangeObservable=new s.y$,this.onMaterialChangedObservable=new s.y$,this.definedFacingForward=!0,this._occlusionQuery=null,this._renderingGroup=null,this.alphaIndex=Number.MAX_VALUE,this.isVisible=!0,this.isPickable=!0,this.isNearPickable=!1,this.isNearGrabbable=!1,this.showSubMeshesBoundingBox=!1,this.isBlocker=!1,this.enablePointerMoveEvents=!1,this.outlineColor=m.Wo.Red(),this.outlineWidth=.02,this.overlayColor=m.Wo.Red(),this.overlayAlpha=.5,this.useOctreeForRenderingSelection=!0,this.useOctreeForPicking=!0,this.useOctreeForCollisions=!0,this.alwaysSelectAsActiveMesh=!1,this.doNotSyncBoundingInfo=!1,this.actionManager=null,this.ellipsoid=new r.P(.5,1,.5),this.ellipsoidOffset=new r.P(0,0,0),this.edgesWidth=1,this.edgesColor=new m.HE(1,0,0,1),this._edgesRenderer=null,this._masterMesh=null,this._boundingInfo=null,this._boundingInfoIsDirty=!0,this._renderId=0,this._intersectionsInProgress=new Array,this._unIndexed=!1,this._lightSources=new Array,this._waitingData={lods:null,actions:null,freezeWorldMatrix:null},this._bonesTransformMatrices=null,this._transformMatrixTexture=null,this.onRebuildObservable=new s.y$,this._onCollisionPositionChange=function(e,i){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;i.subtractToRef(t._internalAbstractMeshDataInfo._meshCollisionData._oldPositionForCollisions,t._internalAbstractMeshDataInfo._meshCollisionData._diffPositionForCollisions),t._internalAbstractMeshDataInfo._meshCollisionData._diffPositionForCollisions.length()>a.D.CollisionsEpsilon&&t.position.addInPlace(t._internalAbstractMeshDataInfo._meshCollisionData._diffPositionForCollisions),s&&t.onCollideObservable.notifyObservers(s),t.onCollisionPositionChangeObservable.notifyObservers(t.position)},i=this.getScene(),i.addMesh(this),this._resyncLightSources(),this._uniformBuffer=new d.M(this.getScene().getEngine(),void 0,void 0,e,!this.getScene().getEngine().isWebGPU),this._buildUniformLayout(),i.performancePriority){case n.a.Aggressive:this.doNotSyncBoundingInfo=!0;case n.a.Intermediate:this.alwaysSelectAsActiveMesh=!0,this.isPickable=!1}}_buildUniformLayout(){this._uniformBuffer.addUniform("world",16),this._uniformBuffer.addUniform("visibility",1),this._uniformBuffer.create()}transferToEffect(e){const t=this._uniformBuffer;t.updateMatrix("world",e),t.updateFloat("visibility",this._internalAbstractMeshDataInfo._visibility),t.update()}getMeshUniformBuffer(){return this._uniformBuffer}getClassName(){return"AbstractMesh"}toString(e){let t="Name: "+this.name+", isInstance: "+("InstancedMesh"!==this.getClassName()?"YES":"NO");t+=", # of submeshes: "+(this.subMeshes?this.subMeshes.length:0);const i=this._internalAbstractMeshDataInfo._skeleton;return i&&(t+=", skeleton: "+i.name),e&&(t+=", billboard mode: "+["NONE","X","Y",null,"Z",null,null,"ALL"][this.billboardMode],t+=", freeze wrld mat: "+(this._isWorldMatrixFrozen||this._waitingData.freezeWorldMatrix?"YES":"NO")),t}_getEffectiveParent(){return this._masterMesh&&this.billboardMode!==h.Y.BILLBOARDMODE_NONE?this._masterMesh:super._getEffectiveParent()}_getActionManagerForTrigger(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.actionManager&&(t||this.actionManager.isRecursive)){if(!e)return this.actionManager;if(this.actionManager.hasSpecificTrigger(e))return this.actionManager}return this.parent?this.parent._getActionManagerForTrigger(e,!1):null}_rebuild(){if(this.onRebuildObservable.notifyObservers(this),null!==this._occlusionQuery&&(this._occlusionQuery=null),this.subMeshes)for(const e of this.subMeshes)e._rebuild()}_resyncLightSources(){this._lightSources.length=0;for(const e of this.getScene().lights)e.isEnabled()&&e.canAffectMesh(this)&&this._lightSources.push(e);this._markSubMeshesAsLightDirty()}_resyncLightSource(e){const t=e.isEnabled()&&e.canAffectMesh(this),i=this._lightSources.indexOf(e);let s=!1;if(-1===i){if(!t)return;this._lightSources.push(e)}else{if(t)return;s=!0,this._lightSources.splice(i,1)}this._markSubMeshesAsLightDirty(s)}_unBindEffect(){for(const e of this.subMeshes)e.setEffect(null)}_removeLightSource(e,t){const i=this._lightSources.indexOf(e);-1!==i&&(this._lightSources.splice(i,1),this._markSubMeshesAsLightDirty(t))}_markSubMeshesAsDirty(e){if(this.subMeshes)for(const t of this.subMeshes)for(let i=0;i<t._drawWrappers.length;++i){const s=t._drawWrappers[i];s&&s.defines&&s.defines.markAllAsDirty&&e(s.defines)}}_markSubMeshesAsLightDirty(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._markSubMeshesAsDirty((t=>t.markAsLightDirty(e)))}_markSubMeshesAsAttributesDirty(){this._markSubMeshesAsDirty((e=>e.markAsAttributesDirty()))}_markSubMeshesAsMiscDirty(){this._markSubMeshesAsDirty((e=>e.markAsMiscDirty()))}markAsDirty(e){return this._currentRenderId=Number.MAX_VALUE,this._isDirty=!0,this}resetDrawCache(e){if(this.subMeshes)for(const t of this.subMeshes)t.resetDrawCache(e)}get isBlocked(){return!1}getLOD(e){return this}getTotalVertices(){return 0}getTotalIndices(){return 0}getIndices(){return null}getVerticesData(e){return null}setVerticesData(e,t,i,s){return this}updateVerticesData(e,t,i,s){return this}setIndices(e,t){return this}isVerticesDataPresent(e){return!1}getBoundingInfo(){return this._masterMesh?this._masterMesh.getBoundingInfo():(this._boundingInfoIsDirty&&(this._boundingInfoIsDirty=!1,this._updateBoundingInfo()),this._boundingInfo)}setBoundingInfo(e){return this._boundingInfo=e,this}get hasBoundingInfo(){return null!==this._boundingInfo}buildBoundingInfo(e,t,i){return this._boundingInfo=new u.j(e,t,i),this._boundingInfo}normalizeToUnitCube(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2?arguments[2]:void 0;return super.normalizeToUnitCube(e,t,i)}get useBones(){return this.skeleton&&this.getScene().skeletonsEnabled&&this.isVerticesDataPresent(o.o.MatricesIndicesKind)&&this.isVerticesDataPresent(o.o.MatricesWeightsKind)}_preActivate(){}_preActivateForIntermediateRendering(e){}_activate(e,t){return this._renderId=e,!0}_postActivate(){}_freeze(){}_unFreeze(){}getWorldMatrix(){return this._masterMesh&&this.billboardMode===h.Y.BILLBOARDMODE_NONE?this._masterMesh.getWorldMatrix():super.getWorldMatrix()}_getWorldMatrixDeterminant(){return this._masterMesh?this._masterMesh._getWorldMatrixDeterminant():super._getWorldMatrixDeterminant()}get isAnInstance(){return!1}get hasInstances(){return!1}get hasThinInstances(){return!1}movePOV(e,t,i){return this.position.addInPlace(this.calcMovePOV(e,t,i)),this}calcMovePOV(e,t,i){const s=new r.y3;(this.rotationQuaternion?this.rotationQuaternion:r._f.RotationYawPitchRoll(this.rotation.y,this.rotation.x,this.rotation.z)).toRotationMatrix(s);const n=r.P.Zero(),a=this.definedFacingForward?-1:1;return r.P.TransformCoordinatesFromFloatsToRef(e*a,t,i*a,s,n),n}rotatePOV(e,t,i){return this.rotation.addInPlace(this.calcRotatePOV(e,t,i)),this}calcRotatePOV(e,t,i){const s=this.definedFacingForward?1:-1;return new r.P(e*s,t,i*s)}refreshBoundingInfo(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._boundingInfo&&this._boundingInfo.isLocked||this._refreshBoundingInfo(this._getPositionData(e,t),null),this}_refreshBoundingInfo(e,t){if(e){const i=(0,g.k)(e,0,this.getTotalVertices(),t);this._boundingInfo?this._boundingInfo.reConstruct(i.minimum,i.maximum):this._boundingInfo=new u.j(i.minimum,i.maximum)}if(this.subMeshes)for(let i=0;i<this.subMeshes.length;i++)this.subMeshes[i].refreshBoundingInfo(e);this._updateBoundingInfo()}_getData(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2?arguments[2]:void 0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:o.o.PositionKind;if(i=null!=i?i:this.getVerticesData(s).slice(),i&&t&&this.morphTargetManager){let e=0,t=0;for(let n=0;n<i.length;n++){for(let e=0;e<this.morphTargetManager.numTargets;e++){const t=this.morphTargetManager.getTarget(e),s=t.influence;if(s>0){const e=t.getPositions();e&&(i[n]+=(e[n]-i[n])*s)}}if(e++,s===o.o.PositionKind&&this._positions&&3===e){e=0;const s=3*t;this._positions[t++].copyFromFloats(i[s],i[s+1],i[s+2])}}}if(i&&e&&this.skeleton){const e=this.getVerticesData(o.o.MatricesIndicesKind),t=this.getVerticesData(o.o.MatricesWeightsKind);if(t&&e){const n=this.numBoneInfluencers>4,a=n?this.getVerticesData(o.o.MatricesIndicesExtraKind):null,l=n?this.getVerticesData(o.o.MatricesWeightsExtraKind):null,h=this.skeleton.getTransformMatrices(this),c=r.jp.Vector3[0],u=r.jp.Matrix[0],d=r.jp.Matrix[1];let f=0;for(let p=0;p<i.length;p+=3,f+=4){let g,m;for(u.reset(),g=0;g<4;g++)m=t[f+g],m>0&&(r.y3.FromFloat32ArrayToRefScaled(h,Math.floor(16*e[f+g]),m,d),u.addToSelf(d));if(n)for(g=0;g<4;g++)m=l[f+g],m>0&&(r.y3.FromFloat32ArrayToRefScaled(h,Math.floor(16*a[f+g]),m,d),u.addToSelf(d));s===o.o.NormalKind?r.P.TransformNormalFromFloatsToRef(i[p],i[p+1],i[p+2],u,c):r.P.TransformCoordinatesFromFloatsToRef(i[p],i[p+1],i[p+2],u,c),c.toArray(i,p),s===o.o.PositionKind&&this._positions&&this._positions[p/3].copyFrom(c)}}}return i}getNormalsData(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._getData(e,t,null,o.o.NormalKind)}getPositionData(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2?arguments[2]:void 0;return this._getData(e,t,i,o.o.PositionKind)}_getPositionData(e,t){var i;let s=this.getVerticesData(o.o.PositionKind);if(this._internalAbstractMeshDataInfo._positions&&(this._internalAbstractMeshDataInfo._positions=null),s&&(e&&this.skeleton||t&&this.morphTargetManager)){if(s=s.slice(),this._generatePointsArray(),this._positions){const e=this._positions;this._internalAbstractMeshDataInfo._positions=new Array(e.length);for(let t=0;t<e.length;t++)this._internalAbstractMeshDataInfo._positions[t]=(null===(i=e[t])||void 0===i?void 0:i.clone())||new r.P}return this.getPositionData(e,t,s)}return s}_updateBoundingInfo(){return this._boundingInfo?this._boundingInfo.update(this.worldMatrixFromCache):this._boundingInfo=new u.j(r.P.Zero(),r.P.Zero(),this.worldMatrixFromCache),this._updateSubMeshesBoundingInfo(this.worldMatrixFromCache),this}_updateSubMeshesBoundingInfo(e){if(!this.subMeshes)return this;const t=this.subMeshes.length;for(let i=0;i<t;i++){const s=this.subMeshes[i];(t>1||!s.IsGlobal)&&s.updateBoundingInfo(e)}return this}_afterComputeWorldMatrix(){this.doNotSyncBoundingInfo||(this._boundingInfoIsDirty=!0)}isInFrustum(e){return this.getBoundingInfo().isInFrustum(e,this.cullingStrategy)}isCompletelyInFrustum(e){return this.getBoundingInfo().isCompletelyInFrustum(e)}intersectsMesh(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2?arguments[2]:void 0;const s=this.getBoundingInfo(),n=e.getBoundingInfo();if(s.intersects(n,t))return!0;if(i)for(const r of this.getChildMeshes())if(r.intersectsMesh(e,t,!0))return!0;return!1}intersectsPoint(e){return this.getBoundingInfo().intersectsPoint(e)}get checkCollisions(){return this._internalAbstractMeshDataInfo._meshCollisionData._checkCollisions}set checkCollisions(e){this._internalAbstractMeshDataInfo._meshCollisionData._checkCollisions=e}get collider(){return this._internalAbstractMeshDataInfo._meshCollisionData._collider}moveWithCollisions(e){this.getAbsolutePosition().addToRef(this.ellipsoidOffset,this._internalAbstractMeshDataInfo._meshCollisionData._oldPositionForCollisions);const t=this.getScene().collisionCoordinator;return this._internalAbstractMeshDataInfo._meshCollisionData._collider||(this._internalAbstractMeshDataInfo._meshCollisionData._collider=t.createCollider()),this._internalAbstractMeshDataInfo._meshCollisionData._collider._radius=this.ellipsoid,t.getNewPosition(this._internalAbstractMeshDataInfo._meshCollisionData._oldPositionForCollisions,e,this._internalAbstractMeshDataInfo._meshCollisionData._collider,this.collisionRetryCount,this,this._onCollisionPositionChange,this.uniqueId),this}_collideForSubMesh(e,t,i){var s;if(this._generatePointsArray(),!this._positions)return this;if(!e._lastColliderWorldVertices||!e._lastColliderTransformMatrix.equals(t)){e._lastColliderTransformMatrix=t.clone(),e._lastColliderWorldVertices=[],e._trianglePlanes=[];const i=e.verticesStart,s=e.verticesStart+e.verticesCount;for(let n=i;n<s;n++)e._lastColliderWorldVertices.push(r.P.TransformCoordinates(this._positions[n],t))}return i._collide(e._trianglePlanes,e._lastColliderWorldVertices,this.getIndices(),e.indexStart,e.indexStart+e.indexCount,e.verticesStart,!!e.getMaterial(),this,this._shouldConvertRHS(),7===(null===(s=e.getMaterial())||void 0===s?void 0:s.fillMode)),this}_processCollisionsForSubMeshes(e,t){const i=this._scene.getCollidingSubMeshCandidates(this,e),s=i.length;for(let n=0;n<s;n++){const r=i.data[n];s>1&&!r._checkCollision(e)||this._collideForSubMesh(r,t,e)}return this}_shouldConvertRHS(){return!1}_checkCollision(e){if(!this.getBoundingInfo()._checkCollision(e))return this;const t=r.jp.Matrix[0],i=r.jp.Matrix[1];return r.y3.ScalingToRef(1/e._radius.x,1/e._radius.y,1/e._radius.z,t),this.worldMatrixFromCache.multiplyToRef(t,i),this._processCollisionsForSubMeshes(e,i),this}_generatePointsArray(){return!1}intersects(e,t,i){let s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],n=arguments.length>4?arguments[4]:void 0,a=arguments.length>5&&void 0!==arguments[5]&&arguments[5];const o=new c.p,l="InstancedLinesMesh"===this.getClassName()||"LinesMesh"===this.getClassName()?this.intersectionThreshold:0,h=this.getBoundingInfo();if(!this.subMeshes)return o;if(!(a||e.intersectsSphere(h.boundingSphere,l)&&e.intersectsBox(h.boundingBox,l)))return o;if(s)return o.hit=!a,o.pickedMesh=a?null:this,o.distance=a?0:r.P.Distance(e.origin,h.boundingSphere.center),o.subMeshId=0,o;if(!this._generatePointsArray())return o;let u=null;const d=this._scene.getIntersectingSubMeshCandidates(this,e),f=d.length;let p=!1;for(let r=0;r<f;r++){const e=d.data[r].getMaterial();if(e&&(7==e.fillMode||0==e.fillMode||1==e.fillMode||2==e.fillMode||4==e.fillMode)){p=!0;break}}if(!p)return o.hit=!0,o.pickedMesh=this,o.distance=r.P.Distance(e.origin,h.boundingSphere.center),o.subMeshId=-1,o;for(let r=0;r<f;r++){const s=d.data[r];if(f>1&&!s.canIntersects(e))continue;const n=s.intersects(e,this._positions,this.getIndices(),t,i);if(n&&(t||!u||n.distance<u.distance)&&(u=n,u.subMeshId=r,t))break}if(u){const t=null!=n?n:this.getWorldMatrix(),i=r.jp.Vector3[0],s=r.jp.Vector3[1];r.P.TransformCoordinatesToRef(e.origin,t,i),e.direction.scaleToRef(u.distance,s);const a=r.P.TransformNormal(s,t).addInPlace(i);return o.hit=!0,o.distance=r.P.Distance(i,a),o.pickedPoint=a,o.pickedMesh=this,o.bu=u.bu||0,o.bv=u.bv||0,o.subMeshFaceId=u.faceId,o.faceId=u.faceId+d.data[u.subMeshId].indexStart/(-1!==this.getClassName().indexOf("LinesMesh")?2:3),o.subMeshId=u.subMeshId,o}return o}clone(e,t,i){return null}releaseSubMeshes(){if(this.subMeshes)for(;this.subMeshes.length;)this.subMeshes[0].dispose();else this.subMeshes=new Array;return this}dispose(e){let t,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];for(this._scene.useMaterialMeshMap&&this._internalAbstractMeshDataInfo._material&&this._internalAbstractMeshDataInfo._material.meshMap&&(this._internalAbstractMeshDataInfo._material.meshMap[this.uniqueId]=void 0),this.getScene().freeActiveMeshes(),this.getScene().freeRenderingGroups(),void 0!==this.actionManager&&null!==this.actionManager&&(this.actionManager.dispose(),this.actionManager=null),this._internalAbstractMeshDataInfo._skeleton=null,this._transformMatrixTexture&&(this._transformMatrixTexture.dispose(),this._transformMatrixTexture=null),t=0;t<this._intersectionsInProgress.length;t++){const e=this._intersectionsInProgress[t],i=e._intersectionsInProgress.indexOf(this);e._intersectionsInProgress.splice(i,1)}this._intersectionsInProgress.length=0;this.getScene().lights.forEach((e=>{let t=e.includedOnlyMeshes.indexOf(this);-1!==t&&e.includedOnlyMeshes.splice(t,1),t=e.excludedMeshes.indexOf(this),-1!==t&&e.excludedMeshes.splice(t,1);const i=e.getShadowGenerators();if(i){const e=i.values();for(let i=e.next();!0!==i.done;i=e.next()){const e=i.value.getShadowMap();e&&e.renderList&&(t=e.renderList.indexOf(this),-1!==t&&e.renderList.splice(t,1))}}})),"InstancedMesh"===this.getClassName()&&"InstancedLinesMesh"===this.getClassName()||this.releaseSubMeshes();const s=this.getScene().getEngine();if(null!==this._occlusionQuery&&(this.isOcclusionQueryInProgress=!1,s.deleteQuery(this._occlusionQuery),this._occlusionQuery=null),s.wipeCaches(),this.getScene().removeMesh(this),this._parentContainer){const e=this._parentContainer.meshes.indexOf(this);e>-1&&this._parentContainer.meshes.splice(e,1),this._parentContainer=null}if(i&&this.material&&("MultiMaterial"===this.material.getClassName()?this.material.dispose(!1,!0,!0):this.material.dispose(!1,!0)),!e)for(t=0;t<this.getScene().particleSystems.length;t++)this.getScene().particleSystems[t].emitter===this&&(this.getScene().particleSystems[t].dispose(),t--);this._internalAbstractMeshDataInfo._facetData.facetDataEnabled&&this.disableFacetData(),this._uniformBuffer.dispose(),this.onAfterWorldMatrixUpdateObservable.clear(),this.onCollideObservable.clear(),this.onCollisionPositionChangeObservable.clear(),this.onRebuildObservable.clear(),super.dispose(e,i)}addChild(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e.setParent(this,t),this}removeChild(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e.setParent(null,t),this}_initFacetData(){const e=this._internalAbstractMeshDataInfo._facetData;e.facetNormals||(e.facetNormals=new Array),e.facetPositions||(e.facetPositions=new Array),e.facetPartitioning||(e.facetPartitioning=new Array),e.facetNb=this.getIndices().length/3|0,e.partitioningSubdivisions=e.partitioningSubdivisions?e.partitioningSubdivisions:10,e.partitioningBBoxRatio=e.partitioningBBoxRatio?e.partitioningBBoxRatio:1.01;for(let t=0;t<e.facetNb;t++)e.facetNormals[t]=r.P.Zero(),e.facetPositions[t]=r.P.Zero();return e.facetDataEnabled=!0,this}updateFacetData(){const e=this._internalAbstractMeshDataInfo._facetData;e.facetDataEnabled||this._initFacetData();const t=this.getVerticesData(o.o.PositionKind),i=this.getIndices(),s=this.getVerticesData(o.o.NormalKind),n=this.getBoundingInfo();if(e.facetDepthSort&&!e.facetDepthSortEnabled){if(e.facetDepthSortEnabled=!0,i instanceof Uint16Array)e.depthSortedIndices=new Uint16Array(i);else if(i instanceof Uint32Array)e.depthSortedIndices=new Uint32Array(i);else{let t=!1;for(let e=0;e<i.length;e++)if(i[e]>65535){t=!0;break}e.depthSortedIndices=t?new Uint32Array(i):new Uint16Array(i)}if(e.facetDepthSortFunction=function(e,t){return t.sqDistance-e.sqDistance},!e.facetDepthSortFrom){const t=this.getScene().activeCamera;e.facetDepthSortFrom=t?t.position:r.P.Zero()}e.depthSortedFacets=[];for(let t=0;t<e.facetNb;t++){const i={ind:3*t,sqDistance:0};e.depthSortedFacets.push(i)}e.invertedMatrix=r.y3.Identity(),e.facetDepthSortOrigin=r.P.Zero()}e.bbSize.x=n.maximum.x-n.minimum.x>_.kn?n.maximum.x-n.minimum.x:_.kn,e.bbSize.y=n.maximum.y-n.minimum.y>_.kn?n.maximum.y-n.minimum.y:_.kn,e.bbSize.z=n.maximum.z-n.minimum.z>_.kn?n.maximum.z-n.minimum.z:_.kn;let a=e.bbSize.x>e.bbSize.y?e.bbSize.x:e.bbSize.y;if(a=a>e.bbSize.z?a:e.bbSize.z,e.subDiv.max=e.partitioningSubdivisions,e.subDiv.X=Math.floor(e.subDiv.max*e.bbSize.x/a),e.subDiv.Y=Math.floor(e.subDiv.max*e.bbSize.y/a),e.subDiv.Z=Math.floor(e.subDiv.max*e.bbSize.z/a),e.subDiv.X=e.subDiv.X<1?1:e.subDiv.X,e.subDiv.Y=e.subDiv.Y<1?1:e.subDiv.Y,e.subDiv.Z=e.subDiv.Z<1?1:e.subDiv.Z,e.facetParameters.facetNormals=this.getFacetLocalNormals(),e.facetParameters.facetPositions=this.getFacetLocalPositions(),e.facetParameters.facetPartitioning=this.getFacetLocalPartitioning(),e.facetParameters.bInfo=n,e.facetParameters.bbSize=e.bbSize,e.facetParameters.subDiv=e.subDiv,e.facetParameters.ratio=this.partitioningBBoxRatio,e.facetParameters.depthSort=e.facetDepthSort,e.facetDepthSort&&e.facetDepthSortEnabled&&(this.computeWorldMatrix(!0),this._worldMatrix.invertToRef(e.invertedMatrix),r.P.TransformCoordinatesToRef(e.facetDepthSortFrom,e.invertedMatrix,e.facetDepthSortOrigin),e.facetParameters.distanceTo=e.facetDepthSortOrigin),e.facetParameters.depthSortedFacets=e.depthSortedFacets,s&&l.x.ComputeNormals(t,i,s,e.facetParameters),e.facetDepthSort&&e.facetDepthSortEnabled){e.depthSortedFacets.sort(e.facetDepthSortFunction);const t=e.depthSortedIndices.length/3|0;for(let s=0;s<t;s++){const t=e.depthSortedFacets[s].ind;e.depthSortedIndices[3*s]=i[t],e.depthSortedIndices[3*s+1]=i[t+1],e.depthSortedIndices[3*s+2]=i[t+2]}this.updateIndices(e.depthSortedIndices,void 0,!0)}return this}getFacetLocalNormals(){const e=this._internalAbstractMeshDataInfo._facetData;return e.facetNormals||this.updateFacetData(),e.facetNormals}getFacetLocalPositions(){const e=this._internalAbstractMeshDataInfo._facetData;return e.facetPositions||this.updateFacetData(),e.facetPositions}getFacetLocalPartitioning(){const e=this._internalAbstractMeshDataInfo._facetData;return e.facetPartitioning||this.updateFacetData(),e.facetPartitioning}getFacetPosition(e){const t=r.P.Zero();return this.getFacetPositionToRef(e,t),t}getFacetPositionToRef(e,t){const i=this.getFacetLocalPositions()[e],s=this.getWorldMatrix();return r.P.TransformCoordinatesToRef(i,s,t),this}getFacetNormal(e){const t=r.P.Zero();return this.getFacetNormalToRef(e,t),t}getFacetNormalToRef(e,t){const i=this.getFacetLocalNormals()[e];return r.P.TransformNormalToRef(i,this.getWorldMatrix(),t),this}getFacetsAtLocalCoordinates(e,t,i){const s=this.getBoundingInfo(),n=this._internalAbstractMeshDataInfo._facetData,r=Math.floor((e-s.minimum.x*n.partitioningBBoxRatio)*n.subDiv.X*n.partitioningBBoxRatio/n.bbSize.x),a=Math.floor((t-s.minimum.y*n.partitioningBBoxRatio)*n.subDiv.Y*n.partitioningBBoxRatio/n.bbSize.y),o=Math.floor((i-s.minimum.z*n.partitioningBBoxRatio)*n.subDiv.Z*n.partitioningBBoxRatio/n.bbSize.z);return r<0||r>n.subDiv.max||a<0||a>n.subDiv.max||o<0||o>n.subDiv.max?null:n.facetPartitioning[r+n.subDiv.max*a+n.subDiv.max*n.subDiv.max*o]}getClosestFacetAtCoordinates(e,t,i,s){let n=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];const o=this.getWorldMatrix(),l=r.jp.Matrix[5];o.invertToRef(l);const h=r.jp.Vector3[8];r.P.TransformCoordinatesFromFloatsToRef(e,t,i,l,h);const c=this.getClosestFacetAtLocalCoordinates(h.x,h.y,h.z,s,n,a);return s&&r.P.TransformCoordinatesFromFloatsToRef(s.x,s.y,s.z,o,s),c}getClosestFacetAtLocalCoordinates(e,t,i,s){let n=arguments.length>4&&void 0!==arguments[4]&&arguments[4],r=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],a=null,o=0,l=0,h=0,c=0,u=0,d=0,f=0,p=0;const g=this.getFacetLocalPositions(),m=this.getFacetLocalNormals(),_=this.getFacetsAtLocalCoordinates(e,t,i);if(!_)return null;let v,b,E,y=Number.MAX_VALUE,M=y;for(let T=0;T<_.length;T++)v=_[T],b=m[v],E=g[v],c=(e-E.x)*b.x+(t-E.y)*b.y+(i-E.z)*b.z,(!n||n&&r&&c>=0||n&&!r&&c<=0)&&(c=b.x*E.x+b.y*E.y+b.z*E.z,u=-(b.x*e+b.y*t+b.z*i-c)/(b.x*b.x+b.y*b.y+b.z*b.z),d=e+b.x*u,f=t+b.y*u,p=i+b.z*u,o=d-e,l=f-t,h=p-i,M=o*o+l*l+h*h,M<y&&(y=M,a=v,s&&(s.x=d,s.y=f,s.z=p)));return a}getFacetDataParameters(){return this._internalAbstractMeshDataInfo._facetData.facetParameters}disableFacetData(){const e=this._internalAbstractMeshDataInfo._facetData;return e.facetDataEnabled&&(e.facetDataEnabled=!1,e.facetPositions=new Array,e.facetNormals=new Array,e.facetPartitioning=new Array,e.facetParameters=null,e.depthSortedIndices=new Uint32Array(0)),this}updateIndices(e,t){return this}createNormals(e){const t=this.getVerticesData(o.o.PositionKind),i=this.getIndices();let s;return s=this.isVerticesDataPresent(o.o.NormalKind)?this.getVerticesData(o.o.NormalKind):[],l.x.ComputeNormals(t,i,s,{useRightHandedSystem:this.getScene().useRightHandedSystem}),this.setVerticesData(o.o.NormalKind,s,e),this}alignWithNormal(e,t){t||(t=v.RD.Y);const i=r.jp.Vector3[0],s=r.jp.Vector3[1];return r.P.CrossToRef(t,e,s),r.P.CrossToRef(e,s,i),this.rotationQuaternion?r._f.RotationQuaternionFromAxisToRef(i,e,s,this.rotationQuaternion):r.P.RotationFromAxisToRef(i,e,s,this.rotation),this}_checkOcclusionQuery(){return!1}disableEdgesRendering(){throw(0,p.S)("EdgesRenderer")}enableEdgesRendering(e,t,i){throw(0,p.S)("EdgesRenderer")}getConnectedParticleSystems(){return this._scene.particleSystems.filter((e=>e.emitter===this))}}M.OCCLUSION_TYPE_NONE=0,M.OCCLUSION_TYPE_OPTIMISTIC=1,M.OCCLUSION_TYPE_STRICT=2,M.OCCLUSION_ALGORITHM_TYPE_ACCURATE=0,M.OCCLUSION_ALGORITHM_TYPE_CONSERVATIVE=1,M.CULLINGSTRATEGY_STANDARD=0,M.CULLINGSTRATEGY_BOUNDINGSPHERE_ONLY=1,M.CULLINGSTRATEGY_OPTIMISTIC_INCLUSION=2,M.CULLINGSTRATEGY_OPTIMISTIC_INCLUSION_THEN_BSPHERE_ONLY=3,(0,b.H)("BABYLON.AbstractMesh",M)},7662:function(e,t,i){"use strict";i.d(t,{Z:function(){return g}});var s=i(6900),n=i(7046),r=i(4527),a=i(2845),o=i(65),l=i(6639),h=i(9115),c=i(8517),u=i(7032),d=i(7721),f=i(4198),p=i(6176);class g{get boundingBias(){return this._boundingBias}set boundingBias(e){this._boundingBias?this._boundingBias.copyFrom(e):this._boundingBias=e.clone(),this._updateBoundingInfo(!0,null)}static CreateGeometryForMesh(e){const t=new g(g.RandomId(),e.getScene());return t.applyToMesh(e),t}get meshes(){return this._meshes}constructor(e,t,i){let s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;this.delayLoadState=0,this._totalVertices=0,this._isDisposed=!1,this._indexBufferIsUpdatable=!1,this._positionsCache=[],this._parentContainer=null,this.useBoundingInfoFromGeometry=!1,this._scene=t||f.l.LastCreatedScene,this._scene&&(this.id=e,this.uniqueId=this._scene.getUniqueId(),this._engine=this._scene.getEngine(),this._meshes=[],this._vertexBuffers={},this._indices=[],this._updatable=s,i?this.setAllVerticesData(i,s):this._totalVertices=0,this._engine.getCaps().vertexArrayObject&&(this._vertexArrayObjects={}),n&&(this.applyToMesh(n),n.computeWorldMatrix(!0)))}get extend(){return this._extend}getScene(){return this._scene}getEngine(){return this._engine}isReady(){return 1===this.delayLoadState||0===this.delayLoadState}get doNotSerialize(){for(let e=0;e<this._meshes.length;e++)if(!this._meshes[e].doNotSerialize)return!1;return!0}_rebuild(){this._vertexArrayObjects&&(this._vertexArrayObjects={}),0!==this._meshes.length&&this._indices&&(this._indexBuffer=this._engine.createIndexBuffer(this._indices,this._updatable));for(const e in this._vertexBuffers){this._vertexBuffers[e]._rebuild()}}setAllVerticesData(e,t){e.applyToGeometry(this,t),this._notifyUpdate()}setVerticesData(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=arguments.length>3?arguments[3]:void 0;i&&Array.isArray(t)&&(t=new Float32Array(t));const n=new a.o(this._engine,t,e,i,0===this._meshes.length,s);this.setVerticesBuffer(n)}removeVerticesData(e){this._vertexBuffers[e]&&(this._vertexBuffers[e].dispose(),delete this._vertexBuffers[e]),this._vertexArrayObjects&&this._disposeVertexArrayObjects()}setVerticesBuffer(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const s=e.getKind();this._vertexBuffers[s]&&i&&this._vertexBuffers[s].dispose(),e._buffer&&e._buffer._increaseReferences(),this._vertexBuffers[s]=e;const n=this._meshes,r=n.length;if(s===a.o.PositionKind){const i=e.getData();null!=t?this._totalVertices=t:null!=i&&(this._totalVertices=i.length/(e.type===a.o.BYTE?e.byteStride:e.byteStride/4)),this._updateExtend(i),this._resetPointsArrayCache();for(let e=0;e<r;e++){const t=n[e];t.buildBoundingInfo(this._extend.minimum,this._extend.maximum),t._createGlobalSubMesh(t.isUnIndexed),t.computeWorldMatrix(!0),t.synchronizeInstances()}}this._notifyUpdate(s)}updateVerticesDataDirectly(e,t,i){let s=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const n=this.getVertexBuffer(e);n&&(n.updateDirectly(t,i,s),this._notifyUpdate(e))}updateVerticesData(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const s=this.getVertexBuffer(e);s&&(s.update(t),e===a.o.PositionKind&&this._updateBoundingInfo(i,t),this._notifyUpdate(e))}_updateBoundingInfo(e,t){if(e&&this._updateExtend(t),this._resetPointsArrayCache(),e){const e=this._meshes;for(const t of e){t.hasBoundingInfo?t.getBoundingInfo().reConstruct(this._extend.minimum,this._extend.maximum):t.buildBoundingInfo(this._extend.minimum,this._extend.maximum);const e=t.subMeshes;for(const t of e)t.refreshBoundingInfo()}}}_bind(e,t,i,s){if(!e)return;void 0===t&&(t=this._indexBuffer);const n=this.getVertexBuffers();if(!n)return;if(t!=this._indexBuffer||!this._vertexArrayObjects&&!s)return void this._engine.bindBuffers(n,t,e,i);const r=s||this._vertexArrayObjects;r[e.key]||(r[e.key]=this._engine.recordVertexArrayObject(n,t,e,i)),this._engine.bindVertexArrayObject(r[e.key],t)}getTotalVertices(){return this.isReady()?this._totalVertices:0}getVerticesData(e,t,i){const s=this.getVertexBuffer(e);return s?s.getFloatData(this._totalVertices,i||t&&1!==this._meshes.length):null}isVertexBufferUpdatable(e){const t=this._vertexBuffers[e];return!!t&&t.isUpdatable()}getVertexBuffer(e){return this.isReady()?this._vertexBuffers[e]:null}getVertexBuffers(){return this.isReady()?this._vertexBuffers:null}isVerticesDataPresent(e){return this._vertexBuffers?void 0!==this._vertexBuffers[e]:!!this._delayInfo&&-1!==this._delayInfo.indexOf(e)}getVerticesDataKinds(){const e=[];let t;if(!this._vertexBuffers&&this._delayInfo)for(t in this._delayInfo)e.push(t);else for(t in this._vertexBuffers)e.push(t);return e}updateIndices(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this._indexBuffer)if(this._indexBufferIsUpdatable){const s=e.length!==this._indices.length;if(i||(this._indices=e.slice()),this._engine.updateDynamicIndexBuffer(this._indexBuffer,e,t),s)for(const e of this._meshes)e._createGlobalSubMesh(!0)}else this.setIndices(e,null,!0)}setIndices(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this._indexBuffer&&this._engine._releaseBuffer(this._indexBuffer),this._indices=e,this._indexBufferIsUpdatable=i,0!==this._meshes.length&&this._indices&&(this._indexBuffer=this._engine.createIndexBuffer(this._indices,i)),null!=t&&(this._totalVertices=t);for(const s of this._meshes)s._createGlobalSubMesh(!0),s.synchronizeInstances();this._notifyUpdate()}getTotalIndices(){return this.isReady()?this._indices.length:0}getIndices(e,t){if(!this.isReady())return null;const i=this._indices;return t||e&&1!==this._meshes.length?i.slice():i}getIndexBuffer(){return this.isReady()?this._indexBuffer:null}_releaseVertexArrayObject(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e&&this._vertexArrayObjects&&this._vertexArrayObjects[e.key]&&(this._engine.releaseVertexArrayObject(this._vertexArrayObjects[e.key]),delete this._vertexArrayObjects[e.key])}releaseForMesh(e,t){const i=this._meshes,s=i.indexOf(e);-1!==s&&(i.splice(s,1),this._vertexArrayObjects&&e._invalidateInstanceVertexArrayObject(),e._geometry=null,0===i.length&&t&&this.dispose())}applyToMesh(e){if(e._geometry===this)return;const t=e._geometry;t&&t.releaseForMesh(e),this._vertexArrayObjects&&e._invalidateInstanceVertexArrayObject();const i=this._meshes;e._geometry=this,e._internalAbstractMeshDataInfo._positions=null,this._scene.pushGeometry(this),i.push(e),this.isReady()?this._applyToMesh(e):this._boundingInfo&&e.setBoundingInfo(this._boundingInfo)}_updateExtend(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(this.useBoundingInfoFromGeometry&&this._boundingInfo)this._extend={minimum:this._boundingInfo.minimum.clone(),maximum:this._boundingInfo.maximum.clone()};else{if(!e&&(e=this.getVerticesData(a.o.PositionKind),!e))return;this._extend=(0,d.k)(e,0,this._totalVertices,this.boundingBias,3)}}_applyToMesh(e){const t=this._meshes.length;for(const i in this._vertexBuffers)1===t&&this._vertexBuffers[i].create(),i===a.o.PositionKind&&(this._extend||this._updateExtend(),e.buildBoundingInfo(this._extend.minimum,this._extend.maximum),e._createGlobalSubMesh(e.isUnIndexed),e._updateBoundingInfo());1===t&&this._indices&&this._indices.length>0&&(this._indexBuffer=this._engine.createIndexBuffer(this._indices,this._updatable)),e._syncGeometryWithMorphTargetManager(),e.synchronizeInstances()}_notifyUpdate(e){this.onGeometryUpdated&&this.onGeometryUpdated(this,e),this._vertexArrayObjects&&this._disposeVertexArrayObjects();for(const t of this._meshes)t._markSubMeshesAsAttributesDirty()}load(e,t){2!==this.delayLoadState&&(this.isReady()?t&&t():(this.delayLoadState=2,this._queueLoad(e,t)))}_queueLoad(e,t){this.delayLoadingFile&&(e.addPendingData(this),e._loadFile(this.delayLoadingFile,(i=>{if(!this._delayLoadingFunction)return;this._delayLoadingFunction(JSON.parse(i),this),this.delayLoadState=1,this._delayInfo=[],e.removePendingData(this);const s=this._meshes,n=s.length;for(let e=0;e<n;e++)this._applyToMesh(s[e]);t&&t()}),void 0,!0))}toLeftHanded(){const e=this.getIndices(!1);if(null!=e&&e.length>0){for(let t=0;t<e.length;t+=3){const i=e[t+0];e[t+0]=e[t+2],e[t+2]=i}this.setIndices(e)}const t=this.getVerticesData(a.o.PositionKind,!1);if(null!=t&&t.length>0){for(let e=0;e<t.length;e+=3)t[e+2]=-t[e+2];this.setVerticesData(a.o.PositionKind,t,!1)}const i=this.getVerticesData(a.o.NormalKind,!1);if(null!=i&&i.length>0){for(let e=0;e<i.length;e+=3)i[e+2]=-i[e+2];this.setVerticesData(a.o.NormalKind,i,!1)}}_resetPointsArrayCache(){this._positions=null}_generatePointsArray(){if(this._positions)return!0;const e=this.getVerticesData(a.o.PositionKind);if(!e||0===e.length)return!1;for(let t=3*this._positionsCache.length,i=this._positionsCache.length;t<e.length;t+=3,++i)this._positionsCache[i]=s.P.FromArray(e,t);for(let t=0,i=0;t<e.length;t+=3,++i)this._positionsCache[i].set(e[0+t],e[1+t],e[2+t]);return this._positionsCache.length=e.length/3,this._positions=this._positionsCache,!0}isDisposed(){return this._isDisposed}_disposeVertexArrayObjects(){if(this._vertexArrayObjects){for(const i in this._vertexArrayObjects)this._engine.releaseVertexArrayObject(this._vertexArrayObjects[i]);this._vertexArrayObjects={};const e=this._meshes,t=e.length;for(let i=0;i<t;i++)e[i]._invalidateInstanceVertexArrayObject()}}dispose(){const e=this._meshes,t=e.length;let i;for(i=0;i<t;i++)this.releaseForMesh(e[i]);this._meshes.length=0,this._disposeVertexArrayObjects();for(const s in this._vertexBuffers)this._vertexBuffers[s].dispose();if(this._vertexBuffers={},this._totalVertices=0,this._indexBuffer&&this._engine._releaseBuffer(this._indexBuffer),this._indexBuffer=null,this._indices=[],this.delayLoadState=0,this.delayLoadingFile=null,this._delayLoadingFunction=null,this._delayInfo=[],this._boundingInfo=null,this._scene.removeGeometry(this),this._parentContainer){const e=this._parentContainer.geometries.indexOf(this);e>-1&&this._parentContainer.geometries.splice(e,1),this._parentContainer=null}this._isDisposed=!0}copy(e){const t=new r.x;t.indices=[];const i=this.getIndices();if(i)for(let r=0;r<i.length;r++)t.indices.push(i[r]);let s,n=!1,a=!1;for(s in this._vertexBuffers){const e=this.getVerticesData(s);if(e&&(e instanceof Float32Array?t.set(new Float32Array(e),s):t.set(e.slice(0),s),!a)){const e=this.getVertexBuffer(s);e&&(n=e.isUpdatable(),a=!n)}}const o=new g(e,this._scene,t,n);for(s in o.delayLoadState=this.delayLoadState,o.delayLoadingFile=this.delayLoadingFile,o._delayLoadingFunction=this._delayLoadingFunction,this._delayInfo)o._delayInfo=o._delayInfo||[],o._delayInfo.push(s);return o._boundingInfo=new h.j(this._extend.minimum,this._extend.maximum),o}serialize(){const e={};return e.id=this.id,e.uniqueId=this.uniqueId,e.updatable=this._updatable,u.$&&u.$.HasTags(this)&&(e.tags=u.$.GetTags(this)),e}_toNumberArray(e){return Array.isArray(e)?e:Array.prototype.slice.call(e)}clearCachedData(){this._indices=[],this._resetPointsArrayCache();for(const e in this._vertexBuffers)Object.prototype.hasOwnProperty.call(this._vertexBuffers,e)&&(this._vertexBuffers[e]._buffer._data=null)}serializeVerticeData(){const e=this.serialize();return this.isVerticesDataPresent(a.o.PositionKind)&&(e.positions=this._toNumberArray(this.getVerticesData(a.o.PositionKind)),this.isVertexBufferUpdatable(a.o.PositionKind)&&(e.positions._updatable=!0)),this.isVerticesDataPresent(a.o.NormalKind)&&(e.normals=this._toNumberArray(this.getVerticesData(a.o.NormalKind)),this.isVertexBufferUpdatable(a.o.NormalKind)&&(e.normals._updatable=!0)),this.isVerticesDataPresent(a.o.TangentKind)&&(e.tangents=this._toNumberArray(this.getVerticesData(a.o.TangentKind)),this.isVertexBufferUpdatable(a.o.TangentKind)&&(e.tangents._updatable=!0)),this.isVerticesDataPresent(a.o.UVKind)&&(e.uvs=this._toNumberArray(this.getVerticesData(a.o.UVKind)),this.isVertexBufferUpdatable(a.o.UVKind)&&(e.uvs._updatable=!0)),this.isVerticesDataPresent(a.o.UV2Kind)&&(e.uv2s=this._toNumberArray(this.getVerticesData(a.o.UV2Kind)),this.isVertexBufferUpdatable(a.o.UV2Kind)&&(e.uv2s._updatable=!0)),this.isVerticesDataPresent(a.o.UV3Kind)&&(e.uv3s=this._toNumberArray(this.getVerticesData(a.o.UV3Kind)),this.isVertexBufferUpdatable(a.o.UV3Kind)&&(e.uv3s._updatable=!0)),this.isVerticesDataPresent(a.o.UV4Kind)&&(e.uv4s=this._toNumberArray(this.getVerticesData(a.o.UV4Kind)),this.isVertexBufferUpdatable(a.o.UV4Kind)&&(e.uv4s._updatable=!0)),this.isVerticesDataPresent(a.o.UV5Kind)&&(e.uv5s=this._toNumberArray(this.getVerticesData(a.o.UV5Kind)),this.isVertexBufferUpdatable(a.o.UV5Kind)&&(e.uv5s._updatable=!0)),this.isVerticesDataPresent(a.o.UV6Kind)&&(e.uv6s=this._toNumberArray(this.getVerticesData(a.o.UV6Kind)),this.isVertexBufferUpdatable(a.o.UV6Kind)&&(e.uv6s._updatable=!0)),this.isVerticesDataPresent(a.o.ColorKind)&&(e.colors=this._toNumberArray(this.getVerticesData(a.o.ColorKind)),this.isVertexBufferUpdatable(a.o.ColorKind)&&(e.colors._updatable=!0)),this.isVerticesDataPresent(a.o.MatricesIndicesKind)&&(e.matricesIndices=this._toNumberArray(this.getVerticesData(a.o.MatricesIndicesKind)),e.matricesIndices._isExpanded=!0,this.isVertexBufferUpdatable(a.o.MatricesIndicesKind)&&(e.matricesIndices._updatable=!0)),this.isVerticesDataPresent(a.o.MatricesWeightsKind)&&(e.matricesWeights=this._toNumberArray(this.getVerticesData(a.o.MatricesWeightsKind)),this.isVertexBufferUpdatable(a.o.MatricesWeightsKind)&&(e.matricesWeights._updatable=!0)),e.indices=this._toNumberArray(this.getIndices()),e}static ExtractFromMesh(e,t){const i=e._geometry;return i?i.copy(t):null}static RandomId(){return c.w1.RandomId()}static _GetGeometryByLoadedUniqueId(e,t){for(let i=0;i<t.geometries.length;i++)if(t.geometries[i]._loadedUniqueId===e)return t.geometries[i];return null}static _ImportGeometry(e,t){const i=t.getScene(),s=e.geometryUniqueId,r=e.geometryId;if(s||r){const e=s?this._GetGeometryByLoadedUniqueId(s,i):i.getGeometryById(r);e&&e.applyToMesh(t)}else if(e instanceof ArrayBuffer){const i=t._binaryInfo;if(i.positionsAttrDesc&&i.positionsAttrDesc.count>0){const s=new Float32Array(e,i.positionsAttrDesc.offset,i.positionsAttrDesc.count);t.setVerticesData(a.o.PositionKind,s,!1)}if(i.normalsAttrDesc&&i.normalsAttrDesc.count>0){const s=new Float32Array(e,i.normalsAttrDesc.offset,i.normalsAttrDesc.count);t.setVerticesData(a.o.NormalKind,s,!1)}if(i.tangetsAttrDesc&&i.tangetsAttrDesc.count>0){const s=new Float32Array(e,i.tangetsAttrDesc.offset,i.tangetsAttrDesc.count);t.setVerticesData(a.o.TangentKind,s,!1)}if(i.uvsAttrDesc&&i.uvsAttrDesc.count>0){const s=new Float32Array(e,i.uvsAttrDesc.offset,i.uvsAttrDesc.count);if(p.e.UseOpenGLOrientationForUV)for(let e=1;e<s.length;e+=2)s[e]=1-s[e];t.setVerticesData(a.o.UVKind,s,!1)}if(i.uvs2AttrDesc&&i.uvs2AttrDesc.count>0){const s=new Float32Array(e,i.uvs2AttrDesc.offset,i.uvs2AttrDesc.count);if(p.e.UseOpenGLOrientationForUV)for(let e=1;e<s.length;e+=2)s[e]=1-s[e];t.setVerticesData(a.o.UV2Kind,s,!1)}if(i.uvs3AttrDesc&&i.uvs3AttrDesc.count>0){const s=new Float32Array(e,i.uvs3AttrDesc.offset,i.uvs3AttrDesc.count);if(p.e.UseOpenGLOrientationForUV)for(let e=1;e<s.length;e+=2)s[e]=1-s[e];t.setVerticesData(a.o.UV3Kind,s,!1)}if(i.uvs4AttrDesc&&i.uvs4AttrDesc.count>0){const s=new Float32Array(e,i.uvs4AttrDesc.offset,i.uvs4AttrDesc.count);if(p.e.UseOpenGLOrientationForUV)for(let e=1;e<s.length;e+=2)s[e]=1-s[e];t.setVerticesData(a.o.UV4Kind,s,!1)}if(i.uvs5AttrDesc&&i.uvs5AttrDesc.count>0){const s=new Float32Array(e,i.uvs5AttrDesc.offset,i.uvs5AttrDesc.count);if(p.e.UseOpenGLOrientationForUV)for(let e=1;e<s.length;e+=2)s[e]=1-s[e];t.setVerticesData(a.o.UV5Kind,s,!1)}if(i.uvs6AttrDesc&&i.uvs6AttrDesc.count>0){const s=new Float32Array(e,i.uvs6AttrDesc.offset,i.uvs6AttrDesc.count);if(p.e.UseOpenGLOrientationForUV)for(let e=1;e<s.length;e+=2)s[e]=1-s[e];t.setVerticesData(a.o.UV6Kind,s,!1)}if(i.colorsAttrDesc&&i.colorsAttrDesc.count>0){const s=new Float32Array(e,i.colorsAttrDesc.offset,i.colorsAttrDesc.count);t.setVerticesData(a.o.ColorKind,s,!1,i.colorsAttrDesc.stride)}if(i.matricesIndicesAttrDesc&&i.matricesIndicesAttrDesc.count>0){const s=new Int32Array(e,i.matricesIndicesAttrDesc.offset,i.matricesIndicesAttrDesc.count),n=[];for(let e=0;e<s.length;e++){const t=s[e];n.push(255&t),n.push((65280&t)>>8),n.push((16711680&t)>>16),n.push(t>>24&255)}t.setVerticesData(a.o.MatricesIndicesKind,n,!1)}if(i.matricesIndicesExtraAttrDesc&&i.matricesIndicesExtraAttrDesc.count>0){const s=new Int32Array(e,i.matricesIndicesExtraAttrDesc.offset,i.matricesIndicesExtraAttrDesc.count),n=[];for(let e=0;e<s.length;e++){const t=s[e];n.push(255&t),n.push((65280&t)>>8),n.push((16711680&t)>>16),n.push(t>>24&255)}t.setVerticesData(a.o.MatricesIndicesExtraKind,n,!1)}if(i.matricesWeightsAttrDesc&&i.matricesWeightsAttrDesc.count>0){const s=new Float32Array(e,i.matricesWeightsAttrDesc.offset,i.matricesWeightsAttrDesc.count);t.setVerticesData(a.o.MatricesWeightsKind,s,!1)}if(i.indicesAttrDesc&&i.indicesAttrDesc.count>0){const s=new Int32Array(e,i.indicesAttrDesc.offset,i.indicesAttrDesc.count);t.setIndices(s,null)}if(i.subMeshesAttrDesc&&i.subMeshesAttrDesc.count>0){const s=new Int32Array(e,i.subMeshesAttrDesc.offset,5*i.subMeshesAttrDesc.count);t.subMeshes=[];for(let e=0;e<i.subMeshesAttrDesc.count;e++){const i=s[5*e+0],n=s[5*e+1],r=s[5*e+2],a=s[5*e+3],l=s[5*e+4];o.P.AddToMesh(i,n,r,a,l,t)}}}else if(e.positions&&e.normals&&e.indices){if(t.setVerticesData(a.o.PositionKind,e.positions,e.positions._updatable),t.setVerticesData(a.o.NormalKind,e.normals,e.normals._updatable),e.tangents&&t.setVerticesData(a.o.TangentKind,e.tangents,e.tangents._updatable),e.uvs&&t.setVerticesData(a.o.UVKind,e.uvs,e.uvs._updatable),e.uvs2&&t.setVerticesData(a.o.UV2Kind,e.uvs2,e.uvs2._updatable),e.uvs3&&t.setVerticesData(a.o.UV3Kind,e.uvs3,e.uvs3._updatable),e.uvs4&&t.setVerticesData(a.o.UV4Kind,e.uvs4,e.uvs4._updatable),e.uvs5&&t.setVerticesData(a.o.UV5Kind,e.uvs5,e.uvs5._updatable),e.uvs6&&t.setVerticesData(a.o.UV6Kind,e.uvs6,e.uvs6._updatable),e.colors&&t.setVerticesData(a.o.ColorKind,n.HE.CheckColors4(e.colors,e.positions.length/3),e.colors._updatable),e.matricesIndices)if(e.matricesIndices._isExpanded)delete e.matricesIndices._isExpanded,t.setVerticesData(a.o.MatricesIndicesKind,e.matricesIndices,e.matricesIndices._updatable);else{const i=[];for(let t=0;t<e.matricesIndices.length;t++){const s=e.matricesIndices[t];i.push(255&s),i.push((65280&s)>>8),i.push((16711680&s)>>16),i.push(s>>24&255)}t.setVerticesData(a.o.MatricesIndicesKind,i,e.matricesIndices._updatable)}if(e.matricesIndicesExtra)if(e.matricesIndicesExtra._isExpanded)delete e.matricesIndices._isExpanded,t.setVerticesData(a.o.MatricesIndicesExtraKind,e.matricesIndicesExtra,e.matricesIndicesExtra._updatable);else{const i=[];for(let t=0;t<e.matricesIndicesExtra.length;t++){const s=e.matricesIndicesExtra[t];i.push(255&s),i.push((65280&s)>>8),i.push((16711680&s)>>16),i.push(s>>24&255)}t.setVerticesData(a.o.MatricesIndicesExtraKind,i,e.matricesIndicesExtra._updatable)}e.matricesWeights&&(g._CleanMatricesWeights(e,t),t.setVerticesData(a.o.MatricesWeightsKind,e.matricesWeights,e.matricesWeights._updatable)),e.matricesWeightsExtra&&t.setVerticesData(a.o.MatricesWeightsExtraKind,e.matricesWeightsExtra,e.matricesWeights._updatable),t.setIndices(e.indices,null)}if(e.subMeshes){t.subMeshes=[];for(let i=0;i<e.subMeshes.length;i++){const s=e.subMeshes[i];o.P.AddToMesh(s.materialIndex,s.verticesStart,s.verticesCount,s.indexStart,s.indexCount,t)}}t._shouldGenerateFlatShading&&(t.convertToFlatShadedMesh(),t._shouldGenerateFlatShading=!1),t.computeWorldMatrix(!0),i.onMeshImportedObservable.notifyObservers(t)}static _CleanMatricesWeights(e,t){const i=.001;if(!l.Z.CleanBoneMatrixWeights)return;let s=0;if(!(e.skeletonId>-1))return;{const i=t.getScene().getLastSkeletonById(e.skeletonId);if(!i)return;s=i.bones.length}const n=t.getVerticesData(a.o.MatricesIndicesKind),r=t.getVerticesData(a.o.MatricesIndicesExtraKind),o=e.matricesWeights,h=e.matricesWeightsExtra,c=e.numBoneInfluencer,u=o.length;for(let a=0;a<u;a+=4){let e=0,t=-1;for(let s=0;s<4;s++){const n=o[a+s];e+=n,n<i&&t<0&&(t=s)}if(h)for(let s=0;s<4;s++){const n=h[a+s];e+=n,n<i&&t<0&&(t=s+4)}if((t<0||t>c-1)&&(t=c-1),e>i){const t=1/e;for(let e=0;e<4;e++)o[a+e]*=t;if(h)for(let e=0;e<4;e++)h[a+e]*=t}else t>=4?(h[a+t-4]=1-e,r[a+t-4]=s):(o[a+t]=1-e,n[a+t]=s)}t.setVerticesData(a.o.MatricesIndicesKind,n),e.matricesWeightsExtra&&t.setVerticesData(a.o.MatricesIndicesExtraKind,r)}static Parse(e,t,i){const n=new g(e.id,t,void 0,e.updatable);return n._loadedUniqueId=e.uniqueId,u.$&&u.$.AddTagsTo(n,e.tags),e.delayLoadingFile?(n.delayLoadState=4,n.delayLoadingFile=i+e.delayLoadingFile,n._boundingInfo=new h.j(s.P.FromArray(e.boundingBoxMinimum),s.P.FromArray(e.boundingBoxMaximum)),n._delayInfo=[],e.hasUVs&&n._delayInfo.push(a.o.UVKind),e.hasUVs2&&n._delayInfo.push(a.o.UV2Kind),e.hasUVs3&&n._delayInfo.push(a.o.UV3Kind),e.hasUVs4&&n._delayInfo.push(a.o.UV4Kind),e.hasUVs5&&n._delayInfo.push(a.o.UV5Kind),e.hasUVs6&&n._delayInfo.push(a.o.UV6Kind),e.hasColors&&n._delayInfo.push(a.o.ColorKind),e.hasMatricesIndices&&n._delayInfo.push(a.o.MatricesIndicesKind),e.hasMatricesWeights&&n._delayInfo.push(a.o.MatricesWeightsKind),n._delayLoadingFunction=r.x.ImportVertexData):r.x.ImportVertexData(e,n),t.pushGeometry(n,!0),n}}},4527:function(e,t,i){"use strict";i.d(t,{x:function(){return d}});var s=i(9477),n=i(6900),r=i(2845),a=i(5230),o=i(7046),l=i(2328),h=i(9336),c=i(5203),u=i(8298);class d{constructor(){this._applyTo=(0,c.vp)(this._applyToCoroutine.bind(this))}set(e,t){switch(e.length||l.Y.Warn("Setting vertex data kind '".concat(t,"' with an empty array")),t){case r.o.PositionKind:this.positions=e;break;case r.o.NormalKind:this.normals=e;break;case r.o.TangentKind:this.tangents=e;break;case r.o.UVKind:this.uvs=e;break;case r.o.UV2Kind:this.uvs2=e;break;case r.o.UV3Kind:this.uvs3=e;break;case r.o.UV4Kind:this.uvs4=e;break;case r.o.UV5Kind:this.uvs5=e;break;case r.o.UV6Kind:this.uvs6=e;break;case r.o.ColorKind:this.colors=e;break;case r.o.MatricesIndicesKind:this.matricesIndices=e;break;case r.o.MatricesWeightsKind:this.matricesWeights=e;break;case r.o.MatricesIndicesExtraKind:this.matricesIndicesExtra=e;break;case r.o.MatricesWeightsExtraKind:this.matricesWeightsExtra=e}}applyToMesh(e,t){return this._applyTo(e,t,!1),this}applyToGeometry(e,t){return this._applyTo(e,t,!1),this}updateMesh(e){return this._update(e),this}updateGeometry(e){return this._update(e),this}_applyToCoroutine(e){var t=this;let i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=arguments.length>2?arguments[2]:void 0;return function*(){return t.positions&&(e.setVerticesData(r.o.PositionKind,t.positions,i),s&&(yield)),t.normals&&(e.setVerticesData(r.o.NormalKind,t.normals,i),s&&(yield)),t.tangents&&(e.setVerticesData(r.o.TangentKind,t.tangents,i),s&&(yield)),t.uvs&&(e.setVerticesData(r.o.UVKind,t.uvs,i),s&&(yield)),t.uvs2&&(e.setVerticesData(r.o.UV2Kind,t.uvs2,i),s&&(yield)),t.uvs3&&(e.setVerticesData(r.o.UV3Kind,t.uvs3,i),s&&(yield)),t.uvs4&&(e.setVerticesData(r.o.UV4Kind,t.uvs4,i),s&&(yield)),t.uvs5&&(e.setVerticesData(r.o.UV5Kind,t.uvs5,i),s&&(yield)),t.uvs6&&(e.setVerticesData(r.o.UV6Kind,t.uvs6,i),s&&(yield)),t.colors&&(e.setVerticesData(r.o.ColorKind,t.colors,i),s&&(yield)),t.matricesIndices&&(e.setVerticesData(r.o.MatricesIndicesKind,t.matricesIndices,i),s&&(yield)),t.matricesWeights&&(e.setVerticesData(r.o.MatricesWeightsKind,t.matricesWeights,i),s&&(yield)),t.matricesIndicesExtra&&(e.setVerticesData(r.o.MatricesIndicesExtraKind,t.matricesIndicesExtra,i),s&&(yield)),t.matricesWeightsExtra&&(e.setVerticesData(r.o.MatricesWeightsExtraKind,t.matricesWeightsExtra,i),s&&(yield)),t.indices?(e.setIndices(t.indices,null,i),s&&(yield)):e.setIndices([],null),t}()}_update(e,t,i){return this.positions&&e.updateVerticesData(r.o.PositionKind,this.positions,t,i),this.normals&&e.updateVerticesData(r.o.NormalKind,this.normals,t,i),this.tangents&&e.updateVerticesData(r.o.TangentKind,this.tangents,t,i),this.uvs&&e.updateVerticesData(r.o.UVKind,this.uvs,t,i),this.uvs2&&e.updateVerticesData(r.o.UV2Kind,this.uvs2,t,i),this.uvs3&&e.updateVerticesData(r.o.UV3Kind,this.uvs3,t,i),this.uvs4&&e.updateVerticesData(r.o.UV4Kind,this.uvs4,t,i),this.uvs5&&e.updateVerticesData(r.o.UV5Kind,this.uvs5,t,i),this.uvs6&&e.updateVerticesData(r.o.UV6Kind,this.uvs6,t,i),this.colors&&e.updateVerticesData(r.o.ColorKind,this.colors,t,i),this.matricesIndices&&e.updateVerticesData(r.o.MatricesIndicesKind,this.matricesIndices,t,i),this.matricesWeights&&e.updateVerticesData(r.o.MatricesWeightsKind,this.matricesWeights,t,i),this.matricesIndicesExtra&&e.updateVerticesData(r.o.MatricesIndicesExtraKind,this.matricesIndicesExtra,t,i),this.matricesWeightsExtra&&e.updateVerticesData(r.o.MatricesWeightsExtraKind,this.matricesWeightsExtra,t,i),this.indices&&e.setIndices(this.indices,null),this}static _TransformVector3Coordinates(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length;const r=n.jp.Vector3[0],a=n.jp.Vector3[1];for(let o=i;o<i+s;o+=3)n.P.FromArrayToRef(e,o,r),n.P.TransformCoordinatesToRef(r,t,a),e[o]=a.x,e[o+1]=a.y,e[o+2]=a.z}static _TransformVector3Normals(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length;const r=n.jp.Vector3[0],a=n.jp.Vector3[1];for(let o=i;o<i+s;o+=3)n.P.FromArrayToRef(e,o,r),n.P.TransformNormalToRef(r,t,a),e[o]=a.x,e[o+1]=a.y,e[o+2]=a.z}static _TransformVector4Normals(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length;const r=n.jp.Vector4[0],a=n.jp.Vector4[1];for(let o=i;o<i+s;o+=4)n.Lt.FromArrayToRef(e,o,r),n.Lt.TransformNormalToRef(r,t,a),e[o]=a.x,e[o+1]=a.y,e[o+2]=a.z,e[o+3]=a.w}static _FlipFaces(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.length;for(let s=t;s<t+i;s+=3){const t=e[s+1];e[s+1]=e[s+2],e[s+2]=t}}transform(e){const t=e.determinant()<0;return this.positions&&d._TransformVector3Coordinates(this.positions,e),this.normals&&d._TransformVector3Normals(this.normals,e),this.tangents&&d._TransformVector4Normals(this.tangents,e),t&&this.indices&&d._FlipFaces(this.indices),this}merge(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const s=Array.isArray(e)?e.map((e=>({vertexData:e}))):[{vertexData:e}];return(0,c.s3)(this._mergeCoroutine(void 0,s,t,!1,i))}_mergeCoroutine(e,t){var i=this;let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;return function*(){var o,l,h,c;i._validate();const u=t.map((e=>e.vertexData));for(const e of u)if(e._validate(),!i.normals!=!e.normals||!i.tangents!=!e.tangents||!i.uvs!=!e.uvs||!i.uvs2!=!e.uvs2||!i.uvs3!=!e.uvs3||!i.uvs4!=!e.uvs4||!i.uvs5!=!e.uvs5||!i.uvs6!=!e.uvs6||!i.colors!=!e.colors||!i.matricesIndices!=!e.matricesIndices||!i.matricesWeights!=!e.matricesWeights||!i.matricesIndicesExtra!=!e.matricesIndicesExtra||!i.matricesWeightsExtra!=!e.matricesWeightsExtra)throw new Error("Cannot merge vertex data that do not have the same set of attributes");const f=u.reduce(((e,t)=>{var i,s;return e+(null!==(s=null===(i=t.indices)||void 0===i?void 0:i.length)&&void 0!==s?s:0)}),null!==(l=null===(o=i.indices)||void 0===o?void 0:o.length)&&void 0!==l?l:0);let p=a||u.some((e=>e.indices===i.indices))?null===(h=i.indices)||void 0===h?void 0:h.slice():i.indices;if(f>0){let r=null!==(c=null==p?void 0:p.length)&&void 0!==c?c:0;if(p||(p=new Array(f)),p.length!==f){if(Array.isArray(p))p.length=f;else{const e=s||p instanceof Uint32Array?new Uint32Array(f):new Uint16Array(f);e.set(p),p=e}e&&e.determinant()<0&&d._FlipFaces(p,0,r)}let a=i.positions?i.positions.length/3:0;for(const{vertexData:e,transform:i}of t)if(e.indices){for(let t=0;t<e.indices.length;t++)p[r+t]=e.indices[t]+a;i&&i.determinant()<0&&d._FlipFaces(p,r,e.indices.length),a+=e.positions.length/3,r+=e.indices.length,n&&(yield)}}return i.indices=p,i.positions=d._MergeElement(r.o.PositionKind,i.positions,e,t.map((e=>[e.vertexData.positions,e.transform]))),n&&(yield),i.normals=d._MergeElement(r.o.NormalKind,i.normals,e,t.map((e=>[e.vertexData.normals,e.transform]))),n&&(yield),i.tangents=d._MergeElement(r.o.TangentKind,i.tangents,e,t.map((e=>[e.vertexData.tangents,e.transform]))),n&&(yield),i.uvs=d._MergeElement(r.o.UVKind,i.uvs,e,t.map((e=>[e.vertexData.uvs,e.transform]))),n&&(yield),i.uvs2=d._MergeElement(r.o.UV2Kind,i.uvs2,e,t.map((e=>[e.vertexData.uvs2,e.transform]))),n&&(yield),i.uvs3=d._MergeElement(r.o.UV3Kind,i.uvs3,e,t.map((e=>[e.vertexData.uvs3,e.transform]))),n&&(yield),i.uvs4=d._MergeElement(r.o.UV4Kind,i.uvs4,e,t.map((e=>[e.vertexData.uvs4,e.transform]))),n&&(yield),i.uvs5=d._MergeElement(r.o.UV5Kind,i.uvs5,e,t.map((e=>[e.vertexData.uvs5,e.transform]))),n&&(yield),i.uvs6=d._MergeElement(r.o.UV6Kind,i.uvs6,e,t.map((e=>[e.vertexData.uvs6,e.transform]))),n&&(yield),i.colors=d._MergeElement(r.o.ColorKind,i.colors,e,t.map((e=>[e.vertexData.colors,e.transform]))),n&&(yield),i.matricesIndices=d._MergeElement(r.o.MatricesIndicesKind,i.matricesIndices,e,t.map((e=>[e.vertexData.matricesIndices,e.transform]))),n&&(yield),i.matricesWeights=d._MergeElement(r.o.MatricesWeightsKind,i.matricesWeights,e,t.map((e=>[e.vertexData.matricesWeights,e.transform]))),n&&(yield),i.matricesIndicesExtra=d._MergeElement(r.o.MatricesIndicesExtraKind,i.matricesIndicesExtra,e,t.map((e=>[e.vertexData.matricesIndicesExtra,e.transform]))),n&&(yield),i.matricesWeightsExtra=d._MergeElement(r.o.MatricesWeightsExtraKind,i.matricesWeightsExtra,e,t.map((e=>[e.vertexData.matricesWeightsExtra,e.transform]))),i}()}static _MergeElement(e,t,i,s){const n=s.filter((e=>null!==e[0]&&void 0!==e[0]));if(!t&&0==n.length)return t;if(!t)return this._MergeElement(e,n[0][0],n[0][1],n.slice(1));const a=n.reduce(((e,t)=>e+t[0].length),t.length),o=e===r.o.PositionKind?d._TransformVector3Coordinates:e===r.o.NormalKind?d._TransformVector3Normals:e===r.o.TangentKind?d._TransformVector4Normals:()=>{};if(t instanceof Float32Array){const e=new Float32Array(a);e.set(t),i&&o(e,i,0,t.length);let s=t.length;for(const[t,i]of n)e.set(t,s),i&&o(e,i,s,t.length),s+=t.length;return e}{const e=new Array(a);for(let i=0;i<t.length;i++)e[i]=t[i];i&&o(e,i,0,t.length);let s=t.length;for(const[t,i]of n){for(let i=0;i<t.length;i++)e[s+i]=t[i];i&&o(e,i,s,t.length),s+=t.length}return e}}_validate(){if(!this.positions)throw new u.LH("Positions are required",u.SM.MeshInvalidPositionsError);const e=(e,t)=>{const i=r.o.DeduceStride(e);if(t.length%i!=0)throw new Error("The "+e+"s array count must be a multiple of "+i);return t.length/i},t=e(r.o.PositionKind,this.positions),i=(i,s)=>{const n=e(i,s);if(n!==t)throw new Error("The "+i+"s element count ("+n+") does not match the positions count ("+t+")")};this.normals&&i(r.o.NormalKind,this.normals),this.tangents&&i(r.o.TangentKind,this.tangents),this.uvs&&i(r.o.UVKind,this.uvs),this.uvs2&&i(r.o.UV2Kind,this.uvs2),this.uvs3&&i(r.o.UV3Kind,this.uvs3),this.uvs4&&i(r.o.UV4Kind,this.uvs4),this.uvs5&&i(r.o.UV5Kind,this.uvs5),this.uvs6&&i(r.o.UV6Kind,this.uvs6),this.colors&&i(r.o.ColorKind,this.colors),this.matricesIndices&&i(r.o.MatricesIndicesKind,this.matricesIndices),this.matricesWeights&&i(r.o.MatricesWeightsKind,this.matricesWeights),this.matricesIndicesExtra&&i(r.o.MatricesIndicesExtraKind,this.matricesIndicesExtra),this.matricesWeightsExtra&&i(r.o.MatricesWeightsExtraKind,this.matricesWeightsExtra)}serialize(){const e={};return this.positions&&(e.positions=this.positions),this.normals&&(e.normals=this.normals),this.tangents&&(e.tangents=this.tangents),this.uvs&&(e.uvs=this.uvs),this.uvs2&&(e.uvs2=this.uvs2),this.uvs3&&(e.uvs3=this.uvs3),this.uvs4&&(e.uvs4=this.uvs4),this.uvs5&&(e.uvs5=this.uvs5),this.uvs6&&(e.uvs6=this.uvs6),this.colors&&(e.colors=this.colors),this.matricesIndices&&(e.matricesIndices=this.matricesIndices,e.matricesIndices._isExpanded=!0),this.matricesWeights&&(e.matricesWeights=this.matricesWeights),this.matricesIndicesExtra&&(e.matricesIndicesExtra=this.matricesIndicesExtra,e.matricesIndicesExtra._isExpanded=!0),this.matricesWeightsExtra&&(e.matricesWeightsExtra=this.matricesWeightsExtra),e.indices=this.indices,e}static ExtractFromMesh(e,t,i){return d._ExtractFrom(e,t,i)}static ExtractFromGeometry(e,t,i){return d._ExtractFrom(e,t,i)}static _ExtractFrom(e,t,i){const s=new d;return e.isVerticesDataPresent(r.o.PositionKind)&&(s.positions=e.getVerticesData(r.o.PositionKind,t,i)),e.isVerticesDataPresent(r.o.NormalKind)&&(s.normals=e.getVerticesData(r.o.NormalKind,t,i)),e.isVerticesDataPresent(r.o.TangentKind)&&(s.tangents=e.getVerticesData(r.o.TangentKind,t,i)),e.isVerticesDataPresent(r.o.UVKind)&&(s.uvs=e.getVerticesData(r.o.UVKind,t,i)),e.isVerticesDataPresent(r.o.UV2Kind)&&(s.uvs2=e.getVerticesData(r.o.UV2Kind,t,i)),e.isVerticesDataPresent(r.o.UV3Kind)&&(s.uvs3=e.getVerticesData(r.o.UV3Kind,t,i)),e.isVerticesDataPresent(r.o.UV4Kind)&&(s.uvs4=e.getVerticesData(r.o.UV4Kind,t,i)),e.isVerticesDataPresent(r.o.UV5Kind)&&(s.uvs5=e.getVerticesData(r.o.UV5Kind,t,i)),e.isVerticesDataPresent(r.o.UV6Kind)&&(s.uvs6=e.getVerticesData(r.o.UV6Kind,t,i)),e.isVerticesDataPresent(r.o.ColorKind)&&(s.colors=e.getVerticesData(r.o.ColorKind,t,i)),e.isVerticesDataPresent(r.o.MatricesIndicesKind)&&(s.matricesIndices=e.getVerticesData(r.o.MatricesIndicesKind,t,i)),e.isVerticesDataPresent(r.o.MatricesWeightsKind)&&(s.matricesWeights=e.getVerticesData(r.o.MatricesWeightsKind,t,i)),e.isVerticesDataPresent(r.o.MatricesIndicesExtraKind)&&(s.matricesIndicesExtra=e.getVerticesData(r.o.MatricesIndicesExtraKind,t,i)),e.isVerticesDataPresent(r.o.MatricesWeightsExtraKind)&&(s.matricesWeightsExtra=e.getVerticesData(r.o.MatricesWeightsExtraKind,t,i)),s.indices=e.getIndices(t,i),s}static CreateRibbon(e){throw(0,a.S)("ribbonBuilder")}static CreateBox(e){throw(0,a.S)("boxBuilder")}static CreateTiledBox(e){throw(0,a.S)("tiledBoxBuilder")}static CreateTiledPlane(e){throw(0,a.S)("tiledPlaneBuilder")}static CreateSphere(e){throw(0,a.S)("sphereBuilder")}static CreateCylinder(e){throw(0,a.S)("cylinderBuilder")}static CreateTorus(e){throw(0,a.S)("torusBuilder")}static CreateLineSystem(e){throw(0,a.S)("linesBuilder")}static CreateDashedLines(e){throw(0,a.S)("linesBuilder")}static CreateGround(e){throw(0,a.S)("groundBuilder")}static CreateTiledGround(e){throw(0,a.S)("groundBuilder")}static CreateGroundFromHeightMap(e){throw(0,a.S)("groundBuilder")}static CreatePlane(e){throw(0,a.S)("planeBuilder")}static CreateDisc(e){throw(0,a.S)("discBuilder")}static CreatePolygon(e,t,i,s,n,r,o){throw(0,a.S)("polygonBuilder")}static CreateIcoSphere(e){throw(0,a.S)("icoSphereBuilder")}static CreatePolyhedron(e){throw(0,a.S)("polyhedronBuilder")}static CreateCapsule(){arguments.length>0&&void 0!==arguments[0]||n.P.Up();throw(0,a.S)("capsuleBuilder")}static CreateTorusKnot(e){throw(0,a.S)("torusKnotBuilder")}static ComputeNormals(e,t,i,s){let r=0,a=0,o=0,l=0,h=0,c=0,u=0,d=0,f=0,p=0,g=0,m=0,_=0,v=0,b=0,E=0,y=0,M=0,T=0,A=0,S=!1,I=!1,C=!1,D=!1,P=1,x=0,R=null;s&&(S=!!s.facetNormals,I=!!s.facetPositions,C=!!s.facetPartitioning,P=!0===s.useRightHandedSystem?-1:1,x=s.ratio||0,D=!!s.depthSort,R=s.distanceTo,D&&void 0===R&&(R=n.P.Zero()));let O=0,N=0,w=0,L=0;for(C&&s&&s.bbSize&&(O=s.subDiv.X*x/s.bbSize.x,N=s.subDiv.Y*x/s.bbSize.y,w=s.subDiv.Z*x/s.bbSize.z,L=s.subDiv.max*s.subDiv.max,s.facetPartitioning.length=0),r=0;r<e.length;r++)i[r]=0;const F=t.length/3|0;for(r=0;r<F;r++){if(m=3*t[3*r],_=m+1,v=m+2,b=3*t[3*r+1],E=b+1,y=b+2,M=3*t[3*r+2],T=M+1,A=M+2,a=e[m]-e[b],o=e[_]-e[E],l=e[v]-e[y],h=e[M]-e[b],c=e[T]-e[E],u=e[A]-e[y],d=P*(o*u-l*c),f=P*(l*h-a*u),p=P*(a*c-o*h),g=Math.sqrt(d*d+f*f+p*p),g=0===g?1:g,d/=g,f/=g,p/=g,S&&s&&(s.facetNormals[r].x=d,s.facetNormals[r].y=f,s.facetNormals[r].z=p),I&&s&&(s.facetPositions[r].x=(e[m]+e[b]+e[M])/3,s.facetPositions[r].y=(e[_]+e[E]+e[T])/3,s.facetPositions[r].z=(e[v]+e[y]+e[A])/3),C&&s){const t=Math.floor((s.facetPositions[r].x-s.bInfo.minimum.x*x)*O),i=Math.floor((s.facetPositions[r].y-s.bInfo.minimum.y*x)*N),n=Math.floor((s.facetPositions[r].z-s.bInfo.minimum.z*x)*w),a=Math.floor((e[m]-s.bInfo.minimum.x*x)*O),o=Math.floor((e[_]-s.bInfo.minimum.y*x)*N),l=Math.floor((e[v]-s.bInfo.minimum.z*x)*w),h=Math.floor((e[b]-s.bInfo.minimum.x*x)*O),c=Math.floor((e[E]-s.bInfo.minimum.y*x)*N),u=Math.floor((e[y]-s.bInfo.minimum.z*x)*w),d=Math.floor((e[M]-s.bInfo.minimum.x*x)*O),f=Math.floor((e[T]-s.bInfo.minimum.y*x)*N),p=Math.floor((e[A]-s.bInfo.minimum.z*x)*w),g=a+s.subDiv.max*o+L*l,S=h+s.subDiv.max*c+L*u,I=d+s.subDiv.max*f+L*p,C=t+s.subDiv.max*i+L*n;s.facetPartitioning[C]=s.facetPartitioning[C]?s.facetPartitioning[C]:new Array,s.facetPartitioning[g]=s.facetPartitioning[g]?s.facetPartitioning[g]:new Array,s.facetPartitioning[S]=s.facetPartitioning[S]?s.facetPartitioning[S]:new Array,s.facetPartitioning[I]=s.facetPartitioning[I]?s.facetPartitioning[I]:new Array,s.facetPartitioning[g].push(r),S!=g&&s.facetPartitioning[S].push(r),I!=S&&I!=g&&s.facetPartitioning[I].push(r),C!=g&&C!=S&&C!=I&&s.facetPartitioning[C].push(r)}if(D&&s&&s.facetPositions){const e=s.depthSortedFacets[r];e.ind=3*r,e.sqDistance=n.P.DistanceSquared(s.facetPositions[r],R)}i[m]+=d,i[_]+=f,i[v]+=p,i[b]+=d,i[E]+=f,i[y]+=p,i[M]+=d,i[T]+=f,i[A]+=p}for(r=0;r<i.length/3;r++)d=i[3*r],f=i[3*r+1],p=i[3*r+2],g=Math.sqrt(d*d+f*f+p*p),g=0===g?1:g,d/=g,f/=g,p/=g,i[3*r]=d,i[3*r+1]=f,i[3*r+2]=p}static _ComputeSides(e,t,i,s,r,a,o){const l=i.length,h=s.length;let c,u;switch(e=e||d.DEFAULTSIDE){case d.FRONTSIDE:break;case d.BACKSIDE:for(c=0;c<l;c+=3){const e=i[c];i[c]=i[c+2],i[c+2]=e}for(u=0;u<h;u++)s[u]=-s[u];break;case d.DOUBLESIDE:{const e=t.length,d=e/3;for(let i=0;i<e;i++)t[e+i]=t[i];for(c=0;c<l;c+=3)i[c+l]=i[c+2]+d,i[c+1+l]=i[c+1]+d,i[c+2+l]=i[c]+d;for(u=0;u<h;u++)s[h+u]=-s[u];const f=r.length;let p=0;for(p=0;p<f;p++)r[p+f]=r[p];for(a=a||new n.Lt(0,0,1,1),o=o||new n.Lt(0,0,1,1),p=0,c=0;c<f/2;c++)r[p]=a.x+(a.z-a.x)*r[p],r[p+1]=a.y+(a.w-a.y)*r[p+1],r[p+f]=o.x+(o.z-o.x)*r[p+f],r[p+f+1]=o.y+(o.w-o.y)*r[p+f+1],p+=2;break}}}static ImportVertexData(e,t){const i=new d,s=e.positions;s&&i.set(s,r.o.PositionKind);const n=e.normals;n&&i.set(n,r.o.NormalKind);const a=e.tangents;a&&i.set(a,r.o.TangentKind);const l=e.uvs;l&&i.set(l,r.o.UVKind);const h=e.uv2s;h&&i.set(h,r.o.UV2Kind);const c=e.uv3s;c&&i.set(c,r.o.UV3Kind);const u=e.uv4s;u&&i.set(u,r.o.UV4Kind);const f=e.uv5s;f&&i.set(f,r.o.UV5Kind);const p=e.uv6s;p&&i.set(p,r.o.UV6Kind);const g=e.colors;g&&i.set(o.HE.CheckColors4(g,s.length/3),r.o.ColorKind);const m=e.matricesIndices;m&&i.set(m,r.o.MatricesIndicesKind);const _=e.matricesWeights;_&&i.set(_,r.o.MatricesWeightsKind);const v=e.indices;v&&(i.indices=v),t.setAllVerticesData(i,e.updatable)}}d.FRONTSIDE=0,d.BACKSIDE=1,d.DOUBLESIDE=2,d.DEFAULTSIDE=0,(0,s.gn)([h.G6.filter((function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];let[s]=t;return!Array.isArray(s)}))],d,"_TransformVector3Coordinates",null),(0,s.gn)([h.G6.filter((function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];let[s]=t;return!Array.isArray(s)}))],d,"_TransformVector3Normals",null),(0,s.gn)([h.G6.filter((function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];let[s]=t;return!Array.isArray(s)}))],d,"_TransformVector4Normals",null),(0,s.gn)([h.G6.filter((function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];let[s]=t;return!Array.isArray(s)}))],d,"_FlipFaces",null)},9609:function(e,t,i){"use strict";i.d(t,{g:function(){return s}});class s{constructor(e,t){this.distanceOrScreenCoverage=e,this.mesh=t}}},65:function(e,t,i){"use strict";i.d(t,{P:function(){return l}});var s=i(2845);class n{constructor(e,t,i){this.bu=e,this.bv=t,this.distance=i,this.faceId=0,this.subMeshId=0}}var r=i(9115),a=i(7721),o=i(8618);class l{get materialDefines(){var e;return this._mainDrawWrapperOverride?this._mainDrawWrapperOverride.defines:null===(e=this._getDrawWrapper())||void 0===e?void 0:e.defines}set materialDefines(e){var t;(null!==(t=this._mainDrawWrapperOverride)&&void 0!==t?t:this._getDrawWrapper(void 0,!0)).defines=e}_getDrawWrapper(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e=null!=e?e:this._engine.currentRenderPassId;let i=this._drawWrappers[e];return!i&&t&&(this._drawWrappers[e]=i=new o.q(this._mesh.getScene().getEngine())),i}_removeDrawWrapper(e){var t;(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&(null===(t=this._drawWrappers[e])||void 0===t||t.dispose()),this._drawWrappers[e]=void 0}get effect(){var e,t;return this._mainDrawWrapperOverride?this._mainDrawWrapperOverride.effect:null!==(t=null===(e=this._getDrawWrapper())||void 0===e?void 0:e.effect)&&void 0!==t?t:null}get _drawWrapper(){var e;return null!==(e=this._mainDrawWrapperOverride)&&void 0!==e?e:this._getDrawWrapper(void 0,!0)}get _drawWrapperOverride(){return this._mainDrawWrapperOverride}_setMainDrawWrapperOverride(e){this._mainDrawWrapperOverride=e}setEffect(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2?arguments[2]:void 0,s=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const n=this._drawWrapper;n.setEffect(e,t,s),void 0!==i&&(n.materialContext=i),e||(n.defines=null,n.materialContext=void 0)}resetDrawCache(e){if(this._drawWrappers){if(void 0!==e)return void this._removeDrawWrapper(e);for(const e of this._drawWrappers)null==e||e.dispose()}this._drawWrappers=[]}static AddToMesh(e,t,i,s,n,r,a){return new l(e,t,i,s,n,r,a,!(arguments.length>7&&void 0!==arguments[7])||arguments[7])}constructor(e,t,i,s,n,r,a){let o=!(arguments.length>7&&void 0!==arguments[7])||arguments[7],l=!(arguments.length>8&&void 0!==arguments[8])||arguments[8];this.materialIndex=e,this.verticesStart=t,this.verticesCount=i,this.indexStart=s,this.indexCount=n,this._mainDrawWrapperOverride=null,this._linesIndexCount=0,this._linesIndexBuffer=null,this._lastColliderWorldVertices=null,this._lastColliderTransformMatrix=null,this._wasDispatched=!1,this._renderId=0,this._alphaIndex=0,this._distanceToCamera=0,this._currentMaterial=null,this._mesh=r,this._renderingMesh=a||r,l&&r.subMeshes.push(this),this._engine=this._mesh.getScene().getEngine(),this.resetDrawCache(),this._trianglePlanes=[],this._id=r.subMeshes.length-1,o&&(this.refreshBoundingInfo(),r.computeWorldMatrix(!0))}get IsGlobal(){return 0===this.verticesStart&&this.verticesCount===this._mesh.getTotalVertices()&&0===this.indexStart&&this.indexCount===this._mesh.getTotalIndices()}getBoundingInfo(){return this.IsGlobal?this._mesh.getBoundingInfo():this._boundingInfo}setBoundingInfo(e){return this._boundingInfo=e,this}getMesh(){return this._mesh}getRenderingMesh(){return this._renderingMesh}getReplacementMesh(){return this._mesh._internalAbstractMeshDataInfo._actAsRegularMesh?this._mesh:null}getEffectiveMesh(){const e=this._mesh._internalAbstractMeshDataInfo._actAsRegularMesh?this._mesh:null;return e||this._renderingMesh}getMaterial(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];var t;const i=null!==(t=this._renderingMesh.getMaterialForRenderPass(this._engine.currentRenderPassId))&&void 0!==t?t:this._renderingMesh.material;if(!i)return e?this._mesh.getScene().defaultMaterial:null;if(this._isMultiMaterial(i)){const e=i.getSubMaterial(this.materialIndex);return this._currentMaterial!==e&&(this._currentMaterial=e,this.resetDrawCache()),e}return i}_isMultiMaterial(e){return void 0!==e.getSubMaterial}refreshBoundingInfo(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(this._lastColliderWorldVertices=null,this.IsGlobal||!this._renderingMesh||!this._renderingMesh.geometry)return this;if(e||(e=this._renderingMesh.getVerticesData(s.o.PositionKind)),!e)return this._boundingInfo=this._mesh.getBoundingInfo(),this;const t=this._renderingMesh.getIndices();let i;if(0===this.indexStart&&this.indexCount===t.length){const e=this._renderingMesh.getBoundingInfo();i={minimum:e.minimum.clone(),maximum:e.maximum.clone()}}else i=(0,a.y)(e,t,this.indexStart,this.indexCount,this._renderingMesh.geometry.boundingBias);return this._boundingInfo?this._boundingInfo.reConstruct(i.minimum,i.maximum):this._boundingInfo=new r.j(i.minimum,i.maximum),this}_checkCollision(e){return this.getBoundingInfo()._checkCollision(e)}updateBoundingInfo(e){let t=this.getBoundingInfo();return t||(this.refreshBoundingInfo(),t=this.getBoundingInfo()),t&&t.update(e),this}isInFrustum(e){const t=this.getBoundingInfo();return!!t&&t.isInFrustum(e,this._mesh.cullingStrategy)}isCompletelyInFrustum(e){const t=this.getBoundingInfo();return!!t&&t.isCompletelyInFrustum(e)}render(e){return this._renderingMesh.render(this,e,this._mesh._internalAbstractMeshDataInfo._actAsRegularMesh?this._mesh:void 0),this}_getLinesIndexBuffer(e,t){if(!this._linesIndexBuffer){const i=[];for(let t=this.indexStart;t<this.indexStart+this.indexCount;t+=3)i.push(e[t],e[t+1],e[t+1],e[t+2],e[t+2],e[t]);this._linesIndexBuffer=t.createIndexBuffer(i),this._linesIndexCount=i.length}return this._linesIndexBuffer}canIntersects(e){const t=this.getBoundingInfo();return!!t&&e.intersectsBox(t.boundingBox)}intersects(e,t,i,s,n){const r=this.getMaterial();if(!r)return null;let a=3,o=!1;switch(r.fillMode){case 3:case 5:case 6:case 8:return null;case 7:a=1,o=!0}return 4===r.fillMode?i.length?this._intersectLines(e,t,i,this._mesh.intersectionThreshold,s):this._intersectUnIndexedLines(e,t,i,this._mesh.intersectionThreshold,s):!i.length&&this._mesh._unIndexed?this._intersectUnIndexedTriangles(e,t,i,s,n):this._intersectTriangles(e,t,i,a,o,s,n)}_intersectLines(e,t,i,s,r){let a=null;for(let o=this.indexStart;o<this.indexStart+this.indexCount;o+=2){const l=t[i[o]],h=t[i[o+1]],c=e.intersectionSegment(l,h,s);if(!(c<0)&&((r||!a||c<a.distance)&&(a=new n(null,null,c),a.faceId=o/2,r)))break}return a}_intersectUnIndexedLines(e,t,i,s,r){let a=null;for(let o=this.verticesStart;o<this.verticesStart+this.verticesCount;o+=2){const i=t[o],l=t[o+1],h=e.intersectionSegment(i,l,s);if(!(h<0)&&((r||!a||h<a.distance)&&(a=new n(null,null,h),a.faceId=o/2,r)))break}return a}_intersectTriangles(e,t,i,s,n,r,a){let o=null,l=-1;for(let h=this.indexStart;h<this.indexStart+this.indexCount-(3-s);h+=s){l++;const s=i[h],c=i[h+1],u=i[h+2];if(n&&4294967295===u){h+=2;continue}const d=t[s],f=t[c],p=t[u];if(!d||!f||!p)continue;if(a&&!a(d,f,p,e,s,c,u))continue;const g=e.intersectsTriangle(d,f,p);if(g){if(g.distance<0)continue;if((r||!o||g.distance<o.distance)&&(o=g,o.faceId=l,r))break}}return o}_intersectUnIndexedTriangles(e,t,i,s,n){let r=null;for(let a=this.verticesStart;a<this.verticesStart+this.verticesCount;a+=3){const i=t[a],o=t[a+1],l=t[a+2];if(n&&!n(i,o,l,e,-1,-1,-1))continue;const h=e.intersectsTriangle(i,o,l);if(h){if(h.distance<0)continue;if((s||!r||h.distance<r.distance)&&(r=h,r.faceId=a/3,s))break}}return r}_rebuild(){this._linesIndexBuffer&&(this._linesIndexBuffer=null)}clone(e,t){const i=new l(this.materialIndex,this.verticesStart,this.verticesCount,this.indexStart,this.indexCount,e,t,!1);if(!this.IsGlobal){const e=this.getBoundingInfo();if(!e)return i;i._boundingInfo=new r.j(e.minimum,e.maximum)}return i}dispose(){this._linesIndexBuffer&&(this._mesh.getScene().getEngine()._releaseBuffer(this._linesIndexBuffer),this._linesIndexBuffer=null);const e=this._mesh.subMeshes.indexOf(this);this._mesh.subMeshes.splice(e,1),this.resetDrawCache()}getClassName(){return"SubMesh"}static CreateFromIndices(e,t,i,s,n){let r=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],a=Number.MAX_VALUE,o=-Number.MAX_VALUE;const h=(n||s).getIndices();for(let l=t;l<t+i;l++){const e=h[l];e<a&&(a=e),e>o&&(o=e)}return new l(e,a,o-a+1,t,i,s,n,r)}}},2668:function(e,t,i){"use strict";i.d(t,{Y:function(){return h}});var s=i(9477),n=i(9336),r=i(4174),a=i(6900),o=i(1396),l=i(7702);class h extends o.N{get billboardMode(){return this._billboardMode}set billboardMode(e){this._billboardMode!==e&&(this._billboardMode=e,this._cache.useBillboardPosition=0!=(this._billboardMode&h.BILLBOARDMODE_USE_POSITION),this._computeUseBillboardPath())}get preserveParentRotationForBillboard(){return this._preserveParentRotationForBillboard}set preserveParentRotationForBillboard(e){e!==this._preserveParentRotationForBillboard&&(this._preserveParentRotationForBillboard=e,this._computeUseBillboardPath())}_computeUseBillboardPath(){this._cache.useBillboardPath=this._billboardMode!==h.BILLBOARDMODE_NONE&&!this.preserveParentRotationForBillboard}get infiniteDistance(){return this._infiniteDistance}set infiniteDistance(e){this._infiniteDistance!==e&&(this._infiniteDistance=e)}constructor(e){let t=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null),this._forward=new a.P(0,0,1),this._up=new a.P(0,1,0),this._right=new a.P(1,0,0),this._position=a.P.Zero(),this._rotation=a.P.Zero(),this._rotationQuaternion=null,this._scaling=a.P.One(),this._transformToBoneReferal=null,this._isAbsoluteSynced=!1,this._billboardMode=h.BILLBOARDMODE_NONE,this._preserveParentRotationForBillboard=!1,this.scalingDeterminant=1,this._infiniteDistance=!1,this.ignoreNonUniformScaling=!1,this.reIntegrateRotationIntoRotationQuaternion=!1,this._poseMatrix=null,this._localMatrix=a.y3.Zero(),this._usePivotMatrix=!1,this._absolutePosition=a.P.Zero(),this._absoluteScaling=a.P.Zero(),this._absoluteRotationQuaternion=a._f.Identity(),this._pivotMatrix=a.y3.Identity(),this._postMultiplyPivotMatrix=!1,this._isWorldMatrixFrozen=!1,this._indexInSceneTransformNodesArray=-1,this.onAfterWorldMatrixUpdateObservable=new r.y$,this._nonUniformScaling=!1,t&&this.getScene().addTransformNode(this)}getClassName(){return"TransformNode"}get position(){return this._position}set position(e){this._position=e,this._isDirty=!0}isUsingPivotMatrix(){return this._usePivotMatrix}get rotation(){return this._rotation}set rotation(e){this._rotation=e,this._rotationQuaternion=null,this._isDirty=!0}get scaling(){return this._scaling}set scaling(e){this._scaling=e,this._isDirty=!0}get rotationQuaternion(){return this._rotationQuaternion}set rotationQuaternion(e){this._rotationQuaternion=e,e&&this._rotation.setAll(0),this._isDirty=!0}get forward(){return a.P.TransformNormalFromFloatsToRef(0,0,this.getScene().useRightHandedSystem?-1:1,this.getWorldMatrix(),this._forward),this._forward.normalize()}get up(){return a.P.TransformNormalFromFloatsToRef(0,1,0,this.getWorldMatrix(),this._up),this._up.normalize()}get right(){return a.P.TransformNormalFromFloatsToRef(this.getScene().useRightHandedSystem?-1:1,0,0,this.getWorldMatrix(),this._right),this._right.normalize()}updatePoseMatrix(e){return this._poseMatrix?(this._poseMatrix.copyFrom(e),this):(this._poseMatrix=e.clone(),this)}getPoseMatrix(){return this._poseMatrix||(this._poseMatrix=a.y3.Identity()),this._poseMatrix}_isSynchronized(){const e=this._cache;return this._billboardMode===e.billboardMode&&this._billboardMode===h.BILLBOARDMODE_NONE&&(!e.pivotMatrixUpdated&&(!this._infiniteDistance&&(!this._position._isDirty&&(!this._scaling._isDirty&&!(this._rotationQuaternion&&this._rotationQuaternion._isDirty||this._rotation._isDirty)))))}_initCache(){super._initCache();const e=this._cache;e.localMatrixUpdated=!1,e.billboardMode=-1,e.infiniteDistance=!1,e.useBillboardPosition=!1,e.useBillboardPath=!1}get absolutePosition(){return this.getAbsolutePosition()}get absoluteScaling(){return this._syncAbsoluteScalingAndRotation(),this._absoluteScaling}get absoluteRotationQuaternion(){return this._syncAbsoluteScalingAndRotation(),this._absoluteRotationQuaternion}setPreTransformMatrix(e){return this.setPivotMatrix(e,!1)}setPivotMatrix(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this._pivotMatrix.copyFrom(e),this._usePivotMatrix=!this._pivotMatrix.isIdentity(),this._cache.pivotMatrixUpdated=!0,this._postMultiplyPivotMatrix=t,this._postMultiplyPivotMatrix&&(this._pivotMatrixInverse?this._pivotMatrix.invertToRef(this._pivotMatrixInverse):this._pivotMatrixInverse=a.y3.Invert(this._pivotMatrix)),this}getPivotMatrix(){return this._pivotMatrix}instantiateHierarchy(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0;const s=this.clone("Clone of "+(this.name||this.id),e||this.parent,!0);s&&i&&i(this,s);for(const n of this.getChildTransformNodes(!0))n.instantiateHierarchy(s,t,i);return s}freezeWorldMatrix(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e?arguments.length>1&&void 0!==arguments[1]&&arguments[1]?(this._rotation.setAll(0),this._rotationQuaternion=this._rotationQuaternion||a._f.Identity(),e.decompose(this._scaling,this._rotationQuaternion,this._position),this.computeWorldMatrix(!0)):(this._worldMatrix=e,this._absolutePosition.copyFromFloats(this._worldMatrix.m[12],this._worldMatrix.m[13],this._worldMatrix.m[14]),this._afterComputeWorldMatrix()):(this._isWorldMatrixFrozen=!1,this.computeWorldMatrix(!0)),this._isDirty=!1,this._isWorldMatrixFrozen=!0,this}unfreezeWorldMatrix(){return this._isWorldMatrixFrozen=!1,this.computeWorldMatrix(!0),this}get isWorldMatrixFrozen(){return this._isWorldMatrixFrozen}getAbsolutePosition(){return this.computeWorldMatrix(),this._absolutePosition}setAbsolutePosition(e){if(!e)return this;let t,i,s;if(void 0===e.x){if(arguments.length<3)return this;t=arguments[0],i=arguments[1],s=arguments[2]}else t=e.x,i=e.y,s=e.z;if(this.parent){const e=a.jp.Matrix[0];this.parent.getWorldMatrix().invertToRef(e),a.P.TransformCoordinatesFromFloatsToRef(t,i,s,e,this.position)}else this.position.x=t,this.position.y=i,this.position.z=s;return this._absolutePosition.copyFrom(e),this}setPositionWithLocalVector(e){return this.computeWorldMatrix(),this.position=a.P.TransformNormal(e,this._localMatrix),this}getPositionExpressedInLocalSpace(){this.computeWorldMatrix();const e=a.jp.Matrix[0];return this._localMatrix.invertToRef(e),a.P.TransformNormal(this.position,e)}locallyTranslate(e){return this.computeWorldMatrix(!0),this.position=a.P.TransformCoordinates(e,this._localMatrix),this}lookAt(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:l.T.LOCAL;const r=h._LookAtVectorCache,o=n===l.T.LOCAL?this.position:this.getAbsolutePosition();if(e.subtractToRef(o,r),this.setDirection(r,t,i,s),n===l.T.WORLD&&this.parent)if(this.rotationQuaternion){const e=a.jp.Matrix[0];this.rotationQuaternion.toRotationMatrix(e);const t=a.jp.Matrix[1];this.parent.getWorldMatrix().getRotationMatrixToRef(t),t.invert(),e.multiplyToRef(t,e),this.rotationQuaternion.fromRotationMatrix(e)}else{const e=a.jp.Quaternion[0];a._f.FromEulerVectorToRef(this.rotation,e);const t=a.jp.Matrix[0];e.toRotationMatrix(t);const i=a.jp.Matrix[1];this.parent.getWorldMatrix().getRotationMatrixToRef(i),i.invert(),t.multiplyToRef(i,t),e.fromRotationMatrix(t),e.toEulerAnglesToRef(this.rotation)}return this}getDirection(e){const t=a.P.Zero();return this.getDirectionToRef(e,t),t}getDirectionToRef(e,t){return a.P.TransformNormalToRef(e,this.getWorldMatrix(),t),this}setDirection(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const n=-Math.atan2(e.z,e.x)+Math.PI/2,r=Math.sqrt(e.x*e.x+e.z*e.z),o=-Math.atan2(e.y,r);return this.rotationQuaternion?a._f.RotationYawPitchRollToRef(n+t,o+i,s,this.rotationQuaternion):(this.rotation.x=o+i,this.rotation.y=n+t,this.rotation.z=s),this}setPivotPoint(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l.T.LOCAL;0==this.getScene().getRenderId()&&this.computeWorldMatrix(!0);const i=this.getWorldMatrix();if(t==l.T.WORLD){const t=a.jp.Matrix[0];i.invertToRef(t),e=a.P.TransformCoordinates(e,t)}return this.setPivotMatrix(a.y3.Translation(-e.x,-e.y,-e.z),!0)}getPivotPoint(){const e=a.P.Zero();return this.getPivotPointToRef(e),e}getPivotPointToRef(e){return e.x=-this._pivotMatrix.m[12],e.y=-this._pivotMatrix.m[13],e.z=-this._pivotMatrix.m[14],this}getAbsolutePivotPoint(){const e=a.P.Zero();return this.getAbsolutePivotPointToRef(e),e}getAbsolutePivotPointToRef(e){return this.getPivotPointToRef(e),a.P.TransformCoordinatesToRef(e,this.getWorldMatrix(),e),this}markAsDirty(e){if(this._isDirty)return this;if(this._children)for(const t of this._children)t.markAsDirty(e);return super.markAsDirty(e)}setParent(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!e&&!this.parent)return this;const s=a.jp.Quaternion[0],n=a.jp.Vector3[0],r=a.jp.Vector3[1],o=a.jp.Matrix[1];a.y3.IdentityToRef(o);const l=a.jp.Matrix[0];this.computeWorldMatrix(!0);let c=this.rotationQuaternion;return c||(c=h._TmpRotation,a._f.RotationYawPitchRollToRef(this._rotation.y,this._rotation.x,this._rotation.z,c)),a.y3.ComposeToRef(this.scaling,c,this.position,l),this.parent&&l.multiplyToRef(this.parent.computeWorldMatrix(!0),l),e&&(e.computeWorldMatrix(!0).invertToRef(o),l.multiplyToRef(o,l)),l.decompose(r,s,n,t?this:void 0),this.rotationQuaternion?this.rotationQuaternion.copyFrom(s):s.toEulerAnglesToRef(this.rotation),this.scaling.copyFrom(r),this.position.copyFrom(n),this.parent=e,i&&this.setPivotMatrix(a.y3.Identity()),this}get nonUniformScaling(){return this._nonUniformScaling}_updateNonUniformScalingState(e){return this._nonUniformScaling!==e&&(this._nonUniformScaling=e,!0)}attachToBone(e,t){return this._currentParentWhenAttachingToBone=this.parent,this._transformToBoneReferal=t,this.parent=e,e.getSkeleton().prepare(),e.getWorldMatrix().determinant()<0&&(this.scalingDeterminant*=-1),this}detachFromBone(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.parent?(this.parent.getWorldMatrix().determinant()<0&&(this.scalingDeterminant*=-1),this._transformToBoneReferal=null,this.parent=e?this._currentParentWhenAttachingToBone:null,this):(e&&(this.parent=this._currentParentWhenAttachingToBone),this)}rotate(e,t,i){let s;if(e.normalize(),this.rotationQuaternion||(this.rotationQuaternion=this.rotation.toQuaternion(),this.rotation.setAll(0)),i&&i!==l.T.LOCAL){if(this.parent){const t=a.jp.Matrix[0];this.parent.getWorldMatrix().invertToRef(t),e=a.P.TransformNormal(e,t)}s=a._f.RotationAxisToRef(e,t,h._RotationAxisCache),s.multiplyToRef(this.rotationQuaternion,this.rotationQuaternion)}else s=a._f.RotationAxisToRef(e,t,h._RotationAxisCache),this.rotationQuaternion.multiplyToRef(s,this.rotationQuaternion);return this}rotateAround(e,t,i){t.normalize(),this.rotationQuaternion||(this.rotationQuaternion=a._f.RotationYawPitchRoll(this.rotation.y,this.rotation.x,this.rotation.z),this.rotation.setAll(0));const s=a.jp.Vector3[0],n=a.jp.Vector3[1],r=a.jp.Vector3[2],o=a.jp.Quaternion[0],l=a.jp.Matrix[0],h=a.jp.Matrix[1],c=a.jp.Matrix[2],u=a.jp.Matrix[3];return e.subtractToRef(this.position,s),a.y3.TranslationToRef(s.x,s.y,s.z,l),a.y3.TranslationToRef(-s.x,-s.y,-s.z,h),a.y3.RotationAxisToRef(t,i,c),h.multiplyToRef(c,u),u.multiplyToRef(l,u),u.decompose(n,o,r),this.position.addInPlace(r),o.multiplyToRef(this.rotationQuaternion,this.rotationQuaternion),this}translate(e,t,i){const s=e.scale(t);if(i&&i!==l.T.LOCAL)this.setAbsolutePosition(this.getAbsolutePosition().add(s));else{const e=this.getPositionExpressedInLocalSpace().add(s);this.setPositionWithLocalVector(e)}return this}addRotation(e,t,i){let s;this.rotationQuaternion?s=this.rotationQuaternion:(s=a.jp.Quaternion[1],a._f.RotationYawPitchRollToRef(this.rotation.y,this.rotation.x,this.rotation.z,s));const n=a.jp.Quaternion[0];return a._f.RotationYawPitchRollToRef(t,e,i,n),s.multiplyInPlace(n),this.rotationQuaternion||s.toEulerAnglesToRef(this.rotation),this}_getEffectiveParent(){return this.parent}isWorldMatrixCameraDependent(){return this._infiniteDistance&&!this.parent||this._billboardMode!==h.BILLBOARDMODE_NONE&&!this.preserveParentRotationForBillboard}computeWorldMatrix(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this._isWorldMatrixFrozen&&!this._isDirty)return this._worldMatrix;const i=this.getScene().getRenderId();if(!this._isDirty&&!e&&(this._currentRenderId===i||this.isSynchronized()))return this._currentRenderId=i,this._worldMatrix;t=t||this.getScene().activeCamera,this._updateCache();const s=this._cache;s.pivotMatrixUpdated=!1,s.billboardMode=this.billboardMode,s.infiniteDistance=this.infiniteDistance,s.parent=this._parentNode,this._currentRenderId=i,this._childUpdateId+=1,this._isDirty=!1,this._position._isDirty=!1,this._rotation._isDirty=!1,this._scaling._isDirty=!1;const n=this._getEffectiveParent(),r=h._TmpScaling;let o,l=this._position;if(this._infiniteDistance&&!this.parent&&t){const e=t.getWorldMatrix(),i=new a.P(e.m[12],e.m[13],e.m[14]);l=h._TmpTranslation,l.copyFromFloats(this._position.x+i.x,this._position.y+i.y,this._position.z+i.z)}if(r.copyFromFloats(this._scaling.x*this.scalingDeterminant,this._scaling.y*this.scalingDeterminant,this._scaling.z*this.scalingDeterminant),this._rotationQuaternion){if(this._rotationQuaternion._isDirty=!1,o=this._rotationQuaternion,this.reIntegrateRotationIntoRotationQuaternion){this.rotation.lengthSquared()&&(this._rotationQuaternion.multiplyInPlace(a._f.RotationYawPitchRoll(this._rotation.y,this._rotation.x,this._rotation.z)),this._rotation.copyFromFloats(0,0,0))}}else o=h._TmpRotation,a._f.RotationYawPitchRollToRef(this._rotation.y,this._rotation.x,this._rotation.z,o);if(this._usePivotMatrix){const e=a.jp.Matrix[1];a.y3.ScalingToRef(r.x,r.y,r.z,e);const t=a.jp.Matrix[0];o.toRotationMatrix(t),this._pivotMatrix.multiplyToRef(e,a.jp.Matrix[4]),a.jp.Matrix[4].multiplyToRef(t,this._localMatrix),this._postMultiplyPivotMatrix&&this._localMatrix.multiplyToRef(this._pivotMatrixInverse,this._localMatrix),this._localMatrix.addTranslationFromFloats(l.x,l.y,l.z)}else a.y3.ComposeToRef(r,o,l,this._localMatrix);if(n&&n.getWorldMatrix){if(e&&n.computeWorldMatrix(e),s.useBillboardPath){this._transformToBoneReferal?n.getWorldMatrix().multiplyToRef(this._transformToBoneReferal.getWorldMatrix(),a.jp.Matrix[7]):a.jp.Matrix[7].copyFrom(n.getWorldMatrix());const e=a.jp.Vector3[5],t=a.jp.Vector3[6],i=a.jp.Quaternion[0];a.jp.Matrix[7].decompose(t,i,e),a.y3.ScalingToRef(t.x,t.y,t.z,a.jp.Matrix[7]),a.jp.Matrix[7].setTranslation(e),h.BillboardUseParentOrientation&&(this._position.applyRotationQuaternionToRef(i,e),this._localMatrix.setTranslation(e)),this._localMatrix.multiplyToRef(a.jp.Matrix[7],this._worldMatrix)}else this._transformToBoneReferal?(this._localMatrix.multiplyToRef(n.getWorldMatrix(),a.jp.Matrix[6]),a.jp.Matrix[6].multiplyToRef(this._transformToBoneReferal.getWorldMatrix(),this._worldMatrix)):this._localMatrix.multiplyToRef(n.getWorldMatrix(),this._worldMatrix);this._markSyncedWithParent()}else this._worldMatrix.copyFrom(this._localMatrix);if(s.useBillboardPath&&t&&this.billboardMode&&!s.useBillboardPosition){const e=a.jp.Vector3[0];if(this._worldMatrix.getTranslationToRef(e),a.jp.Matrix[1].copyFrom(t.getViewMatrix()),a.jp.Matrix[1].setTranslationFromFloats(0,0,0),a.jp.Matrix[1].invertToRef(a.jp.Matrix[0]),(this.billboardMode&h.BILLBOARDMODE_ALL)!==h.BILLBOARDMODE_ALL){a.jp.Matrix[0].decompose(void 0,a.jp.Quaternion[0],void 0);const e=a.jp.Vector3[1];a.jp.Quaternion[0].toEulerAnglesToRef(e),(this.billboardMode&h.BILLBOARDMODE_X)!==h.BILLBOARDMODE_X&&(e.x=0),(this.billboardMode&h.BILLBOARDMODE_Y)!==h.BILLBOARDMODE_Y&&(e.y=0),(this.billboardMode&h.BILLBOARDMODE_Z)!==h.BILLBOARDMODE_Z&&(e.z=0),a.y3.RotationYawPitchRollToRef(e.y,e.x,e.z,a.jp.Matrix[0])}this._worldMatrix.setTranslationFromFloats(0,0,0),this._worldMatrix.multiplyToRef(a.jp.Matrix[0],this._worldMatrix),this._worldMatrix.setTranslation(a.jp.Vector3[0])}else if(s.useBillboardPath&&t&&s.useBillboardPosition){const e=a.jp.Vector3[0];this._worldMatrix.getTranslationToRef(e);const i=t.globalPosition;this._worldMatrix.invertToRef(a.jp.Matrix[1]);const s=a.jp.Vector3[1];a.P.TransformCoordinatesToRef(i,a.jp.Matrix[1],s),s.normalize();const n=-Math.atan2(s.z,s.x)+Math.PI/2,r=Math.sqrt(s.x*s.x+s.z*s.z),o=-Math.atan2(s.y,r);if(a._f.RotationYawPitchRollToRef(n,o,0,a.jp.Quaternion[0]),(this.billboardMode&h.BILLBOARDMODE_ALL)!==h.BILLBOARDMODE_ALL){const e=a.jp.Vector3[1];a.jp.Quaternion[0].toEulerAnglesToRef(e),(this.billboardMode&h.BILLBOARDMODE_X)!==h.BILLBOARDMODE_X&&(e.x=0),(this.billboardMode&h.BILLBOARDMODE_Y)!==h.BILLBOARDMODE_Y&&(e.y=0),(this.billboardMode&h.BILLBOARDMODE_Z)!==h.BILLBOARDMODE_Z&&(e.z=0),a.y3.RotationYawPitchRollToRef(e.y,e.x,e.z,a.jp.Matrix[0])}else a.y3.FromQuaternionToRef(a.jp.Quaternion[0],a.jp.Matrix[0]);this._worldMatrix.setTranslationFromFloats(0,0,0),this._worldMatrix.multiplyToRef(a.jp.Matrix[0],this._worldMatrix),this._worldMatrix.setTranslation(a.jp.Vector3[0])}return this.ignoreNonUniformScaling?this._updateNonUniformScalingState(!1):this._scaling.isNonUniformWithinEpsilon(1e-6)?this._updateNonUniformScalingState(!0):n&&n._nonUniformScaling?this._updateNonUniformScalingState(n._nonUniformScaling):this._updateNonUniformScalingState(!1),this._afterComputeWorldMatrix(),this._absolutePosition.copyFromFloats(this._worldMatrix.m[12],this._worldMatrix.m[13],this._worldMatrix.m[14]),this._isAbsoluteSynced=!1,this.onAfterWorldMatrixUpdateObservable.notifyObservers(this),this._poseMatrix||(this._poseMatrix=a.y3.Invert(this._worldMatrix)),this._worldMatrixDeterminantIsDirty=!0,this._worldMatrix}resetLocalMatrix(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.computeWorldMatrix(),e){const e=this.getChildren();for(let t=0;t<e.length;++t){const i=e[t];if(i){i.computeWorldMatrix();const e=a.jp.Matrix[0];i._localMatrix.multiplyToRef(this._localMatrix,e);const t=a.jp.Quaternion[0];e.decompose(i.scaling,t,i.position),i.rotationQuaternion?i.rotationQuaternion.copyFrom(t):t.toEulerAnglesToRef(i.rotation)}}}this.scaling.copyFromFloats(1,1,1),this.position.copyFromFloats(0,0,0),this.rotation.copyFromFloats(0,0,0),this.rotationQuaternion&&(this.rotationQuaternion=a._f.Identity()),this._worldMatrix=a.y3.Identity()}_afterComputeWorldMatrix(){}registerAfterWorldMatrixUpdate(e){return this.onAfterWorldMatrixUpdateObservable.add(e),this}unregisterAfterWorldMatrixUpdate(e){return this.onAfterWorldMatrixUpdateObservable.removeCallback(e),this}getPositionInCameraSpace(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e||(e=this.getScene().activeCamera),a.P.TransformCoordinates(this.getAbsolutePosition(),e.getViewMatrix())}getDistanceToCamera(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e||(e=this.getScene().activeCamera),this.getAbsolutePosition().subtract(e.globalPosition).length()}clone(e,t,i){const s=n.p4.Clone((()=>new h(e,this.getScene())),this);if(s.name=e,s.id=e,t&&(s.parent=t),!i){const t=this.getDescendants(!0);for(let i=0;i<t.length;i++){const n=t[i];n.clone&&n.clone(e+"."+n.name,s)}}return s}serialize(e){const t=n.p4.Serialize(this,e);return t.type=this.getClassName(),t.uniqueId=this.uniqueId,this.parent&&this.parent._serializeAsParent(t),t.localMatrix=this.getPivotMatrix().asArray(),t.isEnabled=this.isEnabled(),t}static Parse(e,t,i){const s=n.p4.Parse((()=>new h(e.name,t)),e,t,i);return e.localMatrix?s.setPreTransformMatrix(a.y3.FromArray(e.localMatrix)):e.pivotMatrix&&s.setPivotMatrix(a.y3.FromArray(e.pivotMatrix)),s.setEnabled(e.isEnabled),s._waitingParsedUniqueId=e.uniqueId,void 0!==e.parentId&&(s._waitingParentId=e.parentId),void 0!==e.parentInstanceIndex&&(s._waitingParentInstanceIndex=e.parentInstanceIndex),s}getChildTransformNodes(e,t){const i=[];return this._getDescendants(i,e,(e=>(!t||t(e))&&e instanceof h)),i}dispose(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.getScene().stopAnimation(this),this.getScene().removeTransformNode(this),this._parentContainer){const e=this._parentContainer.transformNodes.indexOf(this);e>-1&&this._parentContainer.transformNodes.splice(e,1),this._parentContainer=null}if(this.onAfterWorldMatrixUpdateObservable.clear(),e){const e=this.getChildTransformNodes(!0);for(const t of e)t.parent=null,t.computeWorldMatrix(!0)}super.dispose(e,t)}normalizeToUnitCube(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2?arguments[2]:void 0,s=null,n=null;t&&(this.rotationQuaternion?(n=this.rotationQuaternion.clone(),this.rotationQuaternion.copyFromFloats(0,0,0,1)):this.rotation&&(s=this.rotation.clone(),this.rotation.copyFromFloats(0,0,0)));const r=this.getHierarchyBoundingVectors(e,i),a=r.max.subtract(r.min),o=Math.max(a.x,a.y,a.z);if(0===o)return this;const l=1/o;return this.scaling.scaleInPlace(l),t&&(this.rotationQuaternion&&n?this.rotationQuaternion.copyFrom(n):this.rotation&&s&&this.rotation.copyFrom(s)),this}_syncAbsoluteScalingAndRotation(){this._isAbsoluteSynced||(this._worldMatrix.decompose(this._absoluteScaling,this._absoluteRotationQuaternion),this._isAbsoluteSynced=!0)}}h.BILLBOARDMODE_NONE=0,h.BILLBOARDMODE_X=1,h.BILLBOARDMODE_Y=2,h.BILLBOARDMODE_Z=4,h.BILLBOARDMODE_ALL=7,h.BILLBOARDMODE_USE_POSITION=128,h.BillboardUseParentOrientation=!1,h._TmpRotation=a._f.Zero(),h._TmpScaling=a.P.Zero(),h._TmpTranslation=a.P.Zero(),h._LookAtVectorCache=new a.P(0,0,0),h._RotationAxisCache=new a._f,(0,s.gn)([(0,n.hd)("position")],h.prototype,"_position",void 0),(0,s.gn)([(0,n.hd)("rotation")],h.prototype,"_rotation",void 0),(0,s.gn)([(0,n.mv)("rotationQuaternion")],h.prototype,"_rotationQuaternion",void 0),(0,s.gn)([(0,n.hd)("scaling")],h.prototype,"_scaling",void 0),(0,s.gn)([(0,n.qC)("billboardMode")],h.prototype,"_billboardMode",void 0),(0,s.gn)([(0,n.qC)()],h.prototype,"scalingDeterminant",void 0),(0,s.gn)([(0,n.qC)("infiniteDistance")],h.prototype,"_infiniteDistance",void 0),(0,s.gn)([(0,n.qC)()],h.prototype,"ignoreNonUniformScaling",void 0),(0,s.gn)([(0,n.qC)()],h.prototype,"reIntegrateRotationIntoRotationQuaternion",void 0)},8134:function(e,t,i){"use strict";i.d(t,{B:function(){return s},M:function(){return r}});class s{static BuildArray(e,t){const i=[];for(let s=0;s<e;++s)i.push(t());return i}static BuildTuple(e,t){return s.BuildArray(e,t)}}const n=["push","splice","pop","shift","unshift"];function r(e,t){const i=n.map((i=>function(e,t,i){const s=e[t];if("function"!=typeof s)return null;const n=function(){const s=e.length,r=n.previous.apply(e,arguments);return i(t,s),r};return s.next=n,n.previous=s,e[t]=n,()=>{const i=n.previous;if(!i)return;const s=n.next;s?(i.next=s,s.previous=i):(i.next=void 0,e[t]=i),n.next=void 0,n.previous=void 0}}(e,i,t)));return()=>{i.forEach((e=>{null==e||e()}))}}},5203:function(e,t,i){"use strict";function s(e,t,i){try{const s=e.next();s.done?t(s):s.value?s.value.then((()=>{s.value=void 0,t(s)}),i):t(s)}catch(s){i(s)}}function n(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:25;return(i,n,r)=>{const a=performance.now();void 0===e||a-e>t?(e=a,setTimeout((()=>{s(i,n,r)}),0)):s(i,n,r)}}function r(e,t,i,s,n){const r=()=>{let a;const o=e=>{e.done?i(e.value):void 0===a?a=!0:r()};do{a=void 0,n&&n.aborted?s(new Error("Aborted")):t(e,o,s),void 0===a&&(a=!1)}while(a)};r()}function a(e,t){let i;return r(e,s,(e=>i=e),(e=>{throw e}),t),i}function o(e,t,i){return new Promise(((s,n)=>{r(e,t,s,n,i)}))}function l(e,t){return function(){return a(e(...arguments),t)}}i.d(t,{KO:function(){return n},s3:function(){return a},sM:function(){return o},vp:function(){return l}})},9336:function(e,t,i){"use strict";i.d(t,{G6:function(){return A},N$:function(){return E},QC:function(){return _},RR:function(){return b},XX:function(){return y},hd:function(){return v},mv:function(){return M},n9:function(){return g},oU:function(){return p},p4:function(){return T},qC:function(){return f},qQ:function(){return m},wz:function(){return d}});var s=i(7032),n=i(6900),r=i(5230),a=i(7046);const o={},l={},h=function(e,t,i){const n=e();s.$&&s.$.HasTags(t)&&s.$.AddTagsTo(n,s.$.GetTags(t,!0));const r=c(n);for(const s in r){const e=r[s],a=t[s],o=e.type;if(null!=a&&("uniqueId"!==s||T.AllowLoadingUniqueId))switch(o){case 0:case 6:case 11:n[s]=a;break;case 1:n[s]=i||a.isRenderTarget?a:a.clone();break;case 2:case 3:case 4:case 5:case 7:case 10:case 12:n[s]=i?a:a.clone()}}return n};function c(e){const t=e.getClassName();if(l[t])return l[t];l[t]={};const i=l[t];let s=e,n=t;for(;n;){const e=o[n];for(const s in e)i[s]=e[s];let t,r=!1;do{if(t=Object.getPrototypeOf(s),!t.getClassName){r=!0;break}if(t.getClassName()!==n)break;s=t}while(t);if(r)break;n=t.getClassName(),s=t}return i}function u(e,t){return(i,s)=>{const n=function(e){const t=e.getClassName();return o[t]||(o[t]={}),o[t]}(i);n[s]||(n[s]={type:e,sourceName:t})}}function d(e){return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return(i,s)=>{const n=t||"_"+s;Object.defineProperty(i,s,{get:function(){return this[n]},set:function(t){"function"==typeof this.equals&&this.equals(t)||this[n]!==t&&(this[n]=t,i[e].apply(this))},enumerable:!0,configurable:!0})}}(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null)}function f(e){return u(0,e)}function p(e){return u(1,e)}function g(e){return u(2,e)}function m(e){return u(3,e)}function _(e){return u(4,e)}function v(e){return u(5,e)}function b(e){return u(6,e)}function E(e){return u(7,e)}function y(e){return u(8,e)}function M(e){return u(10,e)}class T{static AppendSerializedAnimations(e,t){if(e.animations){t.animations=[];for(let i=0;i<e.animations.length;i++){const s=e.animations[i];t.animations.push(s.serialize())}}}static Serialize(e,t){t||(t={}),s.$&&(t.tags=s.$.GetTags(e));const i=c(e);for(const s in i){const n=i[s],r=n.sourceName||s,a=n.type,o=e[s];if(null!=o&&("uniqueId"!==s||T.AllowLoadingUniqueId))switch(a){case 0:t[r]=o;break;case 1:case 3:case 7:case 9:t[r]=o.serialize();break;case 2:case 4:case 5:case 8:case 10:case 12:t[r]=o.asArray();break;case 6:case 11:t[r]=o.id}}return t}static ParseProperties(e,t,i,s){s||(s="");const r=c(t);for(const o in r){const l=r[o],h=e[l.sourceName||o],c=l.type;if(null!=h&&("uniqueId"!==o||T.AllowLoadingUniqueId)){const e=t;switch(c){case 0:e[o]=h;break;case 1:i&&(e[o]=T._TextureParser(h,i,s));break;case 2:e[o]=a.Wo.FromArray(h);break;case 3:e[o]=T._FresnelParametersParser(h);break;case 4:e[o]=n.FM.FromArray(h);break;case 5:e[o]=n.P.FromArray(h);break;case 6:i&&(e[o]=i.getLastMeshById(h));break;case 7:e[o]=T._ColorCurvesParser(h);break;case 8:e[o]=a.HE.FromArray(h);break;case 9:e[o]=T._ImageProcessingConfigurationParser(h);break;case 10:e[o]=n._f.FromArray(h);break;case 11:i&&(e[o]=i.getCameraById(h));break;case 12:e[o]=n.y3.FromArray(h)}}}}static Parse(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const r=e();return s.$&&s.$.AddTagsTo(r,t.tags),T.ParseProperties(t,r,i,n),r}static Clone(e,t){return h(e,t,!1)}static Instanciate(e,t){return h(e,t,!0)}}function A(e,t,i,s){const n=i.value;i.value=function(){let i=n;if("undefined"!=typeof _native&&_native[t]){const e=_native[t];i=s?function(){return s(...arguments)?e(...arguments):n(...arguments)}:e}return e[t]=i,i(...arguments)}}T.AllowLoadingUniqueId=!1,T._ImageProcessingConfigurationParser=e=>{throw(0,r.S)("ImageProcessingConfiguration")},T._FresnelParametersParser=e=>{throw(0,r.S)("FresnelParameters")},T._ColorCurvesParser=e=>{throw(0,r.S)("ColorCurves")},T._TextureParser=(e,t,i)=>{throw(0,r.S)("Texture")},A.filter=function(e){return(t,i,s)=>A(t,i,s,e)}},3192:function(e,t,i){"use strict";i.d(t,{j:function(){return r}});var s=i(2328);const n=(e,t)=>e?e.getClassName&&"Mesh"===e.getClassName()?null:e.getClassName&&"SubMesh"===e.getClassName()?e.clone(t):e.clone?e.clone():null:null;class r{static DeepCopy(e,t,i,r){const a=function(e){const t=[];do{Object.getOwnPropertyNames(e).forEach((function(e){-1===t.indexOf(e)&&t.push(e)}))}while(e=Object.getPrototypeOf(e));return t}(e);for(const l of a){if("_"===l[0]&&(!r||-1===r.indexOf(l)))continue;if(l.endsWith("Observable"))continue;if(i&&-1!==i.indexOf(l))continue;const a=e[l],h=typeof a;if("function"!==h)try{if("object"===h)if(a instanceof Array){if(t[l]=[],a.length>0)if("object"==typeof a[0])for(let e=0;e<a.length;e++){const i=n(a[e],t);-1===t[l].indexOf(i)&&t[l].push(i)}else t[l]=a.slice(0)}else t[l]=n(a,t);else t[l]=a}catch(o){s.Y.Warn(o.message)}}}}},5230:function(e,t,i){"use strict";function s(e){return"".concat(e," needs to be imported before as it contains a side-effect required by your code.")}i.d(t,{S:function(){return s}})},5092:function(e,t,i){"use strict";function s(){return"undefined"!=typeof window}function n(){return"undefined"!=typeof navigator}function r(){return"undefined"!=typeof document}function a(e){let t="",i=e.firstChild;for(;i;)3===i.nodeType&&(t+=i.textContent),i=i.nextSibling;return t}i.d(t,{CG:function(){return s},MZ:function(){return o},n5:function(){return r},up:function(){return n},v:function(){return a}});const o={IsWindowObjectExist:s,IsNavigatorAvailable:n,IsDocumentAvailable:r,GetDOMTextContent:a}},8298:function(e,t,i){"use strict";i.d(t,{GU:function(){return s},LH:function(){return r},SM:function(){return n}});class s extends Error{}s._setPrototypeOf=Object.setPrototypeOf||((e,t)=>(e.__proto__=t,e));const n={MeshInvalidPositionsError:0,UnsupportedTextureError:1e3,GLTFLoaderUnexpectedMagicError:2e3,SceneLoaderError:3e3,LoadFileError:4e3,RequestFileError:4001,ReadFileError:4002};class r extends s{constructor(e,t,i){super(e),this.errorCode=t,this.innerError=i,this.name="RuntimeError",s._setPrototypeOf(this,r.prototype)}}},562:function(e,t,i){"use strict";i.d(t,{$K:function(){return D},rN:function(){return v},VL:function(){return I},vP:function(){return T},r6:function(){return y},Ip:function(){return M},FV:function(){return A},$M:function(){return E}});var s=i(8628),n=i(5092),r=i(4174);class a{}a.FilesToLoad={};var o=i(8298),l=i(2399),h=i(9776),c=i(4796),u=i(4198),d=i(2328),f=i(8370);const p=new RegExp(/^data:([^,]+\/[^,]+)?;base64,/i);class g extends o.LH{constructor(e,t){super(e,o.SM.LoadFileError),this.name="LoadFileError",o.GU._setPrototypeOf(this,g.prototype),t instanceof s.g?this.request=t:this.file=t}}class m extends o.LH{constructor(e,t){super(e,o.SM.RequestFileError),this.request=t,this.name="RequestFileError",o.GU._setPrototypeOf(this,m.prototype)}}class _ extends o.LH{constructor(e,t){super(e,o.SM.ReadFileError),this.file=t,this.name="ReadFileError",o.GU._setPrototypeOf(this,_.prototype)}}const v={DefaultRetryStrategy:class{static ExponentialBackoff(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500;return(i,s,n)=>0!==s.status||n>=e||-1!==i.indexOf("file:")?-1:Math.pow(2,n)*t}}.ExponentialBackoff(),BaseUrl:"",CorsBehavior:"anonymous",PreprocessUrl:e=>e},b=e=>e=e.replace(/#/gm,"%23"),E=(e,t)=>{if((!e||0!==e.indexOf("data:"))&&v.CorsBehavior)if("string"==typeof v.CorsBehavior||v.CorsBehavior instanceof String)t.crossOrigin=v.CorsBehavior;else{const i=v.CorsBehavior(e);i&&(t.crossOrigin=i)}},y=function(e,t,i,s){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",r=arguments.length>5?arguments[5]:void 0;var o;let h,c=!1;e instanceof ArrayBuffer||ArrayBuffer.isView(e)?"undefined"!=typeof Blob&&"undefined"!=typeof URL?(h=URL.createObjectURL(new Blob([e],{type:n})),c=!0):h="data:".concat(n,";base64,")+(0,l.Gh)(e):e instanceof Blob?(h=URL.createObjectURL(e),c=!0):(h=b(e),h=v.PreprocessUrl(e));const d=u.l.LastCreatedEngine,f=t=>{if(i){const s=h||e.toString();i("Error while trying to load image: ".concat(0===s.indexOf("http")||s.length<=128?s:s.slice(0,128)+"..."),t)}};if("undefined"==typeof Image||null!==(o=null==d?void 0:d._features.forceBitmapOverHTMLImageElement)&&void 0!==o&&o)return T(h,(s=>{d.createImageBitmap(new Blob([s],{type:n}),{premultiplyAlpha:"none",...r}).then((e=>{t(e),c&&URL.revokeObjectURL(h)})).catch((t=>{i&&i("Error while trying to load image: "+e,t)}))}),void 0,s||void 0,!0,((e,t)=>{f(t)})),null;const p=new Image;E(h,p);const g=[],m=()=>{g.forEach((e=>{e.target.removeEventListener(e.name,e.handler)})),g.length=0};g.push({target:p,name:"load",handler:()=>{m(),t(p),c&&p.src&&URL.revokeObjectURL(p.src)}}),g.push({target:p,name:"error",handler:e=>{m(),f(e),c&&p.src&&URL.revokeObjectURL(p.src)}}),g.push({target:document,name:"securitypolicyviolation",handler:e=>{if(e.blockedURI!==p.src)return;m();const t=new Error("CSP violation of policy ".concat(e.effectiveDirective," ").concat(e.blockedURI,". Current policy is ").concat(e.originalPolicy));u.l.UseFallbackTexture=!1,f(t),c&&p.src&&URL.revokeObjectURL(p.src),p.src=""}}),g.forEach((e=>{e.target.addEventListener(e.name,e.handler)}));const _="blob:"===h.substring(0,5),y="data:"===h.substring(0,5),M=()=>{_||y?p.src=h:T(h,((e,t,i)=>{const s=new Blob([e],{type:!n&&i?i:n}),r=URL.createObjectURL(s);c=!0,p.src=r}),void 0,s||void 0,!0,((e,t)=>{f(t)}))},A=()=>{s&&s.loadImage(h,p)};if(!_&&!y&&s&&s.enableTexturesOffline)s.open(A,M);else{if(-1!==h.indexOf("file:")){const e=decodeURIComponent(h.substring(5).toLowerCase());if(a.FilesToLoad[e]&&"undefined"!=typeof URL){try{let t;try{t=URL.createObjectURL(a.FilesToLoad[e])}catch(S){t=URL.createObjectURL(a.FilesToLoad[e])}p.src=t,c=!0}catch(I){p.src=""}return p}}M()}return p},M=(e,t,i,s,n)=>{const a=new FileReader,o={onCompleteObservable:new r.y$,abort:()=>a.abort()};return a.onloadend=()=>o.onCompleteObservable.notifyObservers(o),n&&(a.onerror=()=>{n(new _("Unable to read ".concat(e.name),e))}),a.onload=e=>{t(e.target.result)},i&&(a.onprogress=i),s?a.readAsArrayBuffer(e):a.readAsText(e),o},T=(e,t,i,s,n,l,h)=>{if(e.name)return M(e,t,i,n,l?e=>{l(void 0,e)}:void 0);const c=e;if(-1!==c.indexOf("file:")){let e=decodeURIComponent(c.substring(5).toLowerCase());0===e.indexOf("./")&&(e=e.substring(2));const s=a.FilesToLoad[e];if(s)return M(s,t,i,n,l?e=>l(void 0,new g(e.message,e.file)):void 0)}const{match:u,type:p}=C(c);if(u){const e={onCompleteObservable:new r.y$,abort:()=>()=>{}};try{const e=n?D(c):P(c);t(e,void 0,p)}catch(o){l?l(void 0,o):d.Y.Error(o.message||"Failed to parse the Data URL")}return f.Q.SetImmediate((()=>{e.onCompleteObservable.notifyObservers(e)})),e}return A(c,((e,i)=>{t(e,null==i?void 0:i.responseURL,null==i?void 0:i.getResponseHeader("content-type"))}),i,s,n,l?e=>{l(e.request,new g(e.message,e.request))}:void 0,h)},A=(e,t,i,a,o,l,h)=>{e=b(e),e=v.PreprocessUrl(e);const c=v.BaseUrl+e;let u=!1;const f={onCompleteObservable:new r.y$,abort:()=>u=!0},p=()=>{let e,r=new s.g,a=null;const p=()=>{r&&(i&&r.removeEventListener("progress",i),e&&r.removeEventListener("readystatechange",e),r.removeEventListener("loadend",g))};let g=()=>{p(),f.onCompleteObservable.notifyObservers(f),f.onCompleteObservable.clear(),i=void 0,e=null,g=null,l=void 0,h=void 0,t=void 0};f.abort=()=>{u=!0,g&&g(),r&&r.readyState!==(XMLHttpRequest.DONE||4)&&r.abort(),null!==a&&(clearTimeout(a),a=null),r=null};const _=e=>{const t=e.message||"Unknown error";l&&r?l(new m(t,r)):d.Y.Error(t)},b=d=>{if(r){if(r.open("GET",c),h)try{h(r)}catch(f){return void _(f)}o&&(r.responseType="arraybuffer"),i&&r.addEventListener("progress",i),g&&r.addEventListener("loadend",g),e=()=>{if(!u&&r&&r.readyState===(XMLHttpRequest.DONE||4)){if(e&&r.removeEventListener("readystatechange",e),r.status>=200&&r.status<300||0===r.status&&(!(0,n.CG)()||S())){try{t&&t(o?r.response:r.responseText,r)}catch(f){_(f)}return}const i=v.DefaultRetryStrategy;if(i){const e=i(c,r,d);if(-1!==e)return p(),r=new s.g,void(a=setTimeout((()=>b(d+1)),e))}const h=new m("Error status: "+r.status+" "+r.statusText+" - Unable to load "+c,r);l&&l(h)}},r.addEventListener("readystatechange",e),r.send()}};b(0)};if(a&&a.enableSceneOffline){const s=e=>{e&&e.status>400?l&&l(e):p()},n=()=>{a&&a.loadFile(v.BaseUrl+e,(e=>{!u&&t&&t(e),f.onCompleteObservable.notifyObservers(f)}),i?e=>{!u&&i&&i(e)}:void 0,s,o)};a.open(n,s)}else p();return f},S=()=>"undefined"!=typeof location&&"file:"===location.protocol,I=e=>p.test(e),C=e=>{const t=p.exec(e);if(null===t||0===t.length)return{match:!1,type:""};return{match:!0,type:t[0].replace("data:","").replace("base64,","")}};function D(e){return(0,l.HQ)(e.split(",")[1])}const P=e=>(0,l.rP)(e.split(",")[1]);let x;c.B._FileToolsLoadImage=y,c.B._FileToolsLoadFile=T,h.L._FileToolsLoadFile=T;((e,t,i,s,n,r,a,o,l,h)=>{x={DecodeBase64UrlToBinary:e,DecodeBase64UrlToString:t,DefaultRetryStrategy:i.DefaultRetryStrategy,BaseUrl:i.BaseUrl,CorsBehavior:i.CorsBehavior,PreprocessUrl:i.PreprocessUrl,IsBase64DataUrl:s,IsFileURL:n,LoadFile:r,LoadImage:a,ReadFile:o,RequestFile:l,SetCorsBehavior:h},Object.defineProperty(x,"DefaultRetryStrategy",{get:function(){return i.DefaultRetryStrategy},set:function(e){i.DefaultRetryStrategy=e}}),Object.defineProperty(x,"BaseUrl",{get:function(){return i.BaseUrl},set:function(e){i.BaseUrl=e}}),Object.defineProperty(x,"PreprocessUrl",{get:function(){return i.PreprocessUrl},set:function(e){i.PreprocessUrl=e}}),Object.defineProperty(x,"CorsBehavior",{get:function(){return i.CorsBehavior},set:function(e){i.CorsBehavior=e}})})(D,P,v,I,S,T,y,M,A,E)},9950:function(e,t,i){"use strict";function s(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}i.d(t,{f:function(){return s}})},8797:function(e,t,i){"use strict";i.d(t,{K:function(){return r}});var s=i(2328),n=i(1704);class r{static Instantiate(e){if(this.RegisteredExternalClasses&&this.RegisteredExternalClasses[e])return this.RegisteredExternalClasses[e];const t=(0,n.q)(e);if(t)return t;s.Y.Warn(e+" not found, you may have missed an import.");const i=e.split(".");let r=window||this;for(let s=0,n=i.length;s<n;s++)r=r[i[s]];return"function"!=typeof r?null:r}}r.RegisteredExternalClasses={}},2328:function(e,t,i){"use strict";i.d(t,{Y:function(){return s}});class s{static _CheckLimit(e,t){let i=s._LogLimitOutputs[e];return i?i.current++:(i={limit:t,current:1},s._LogLimitOutputs[e]=i),i.current<=i.limit}static _GenerateLimitMessage(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;var i;const n=s._LogLimitOutputs[e];if(!n||!s.MessageLimitReached)return;const r=this._Levels[t];n.current===n.limit&&s[r.name](s.MessageLimitReached.replace(/%LIMIT%/g,""+n.limit).replace(/%TYPE%/g,null!==(i=r.name)&&void 0!==i?i:""))}static _AddLogEntry(e){s._LogCache=e+s._LogCache,s.OnNewCacheEntry&&s.OnNewCacheEntry(e)}static _FormatMessage(e){const t=e=>e<10?"0"+e:""+e,i=new Date;return"["+t(i.getHours())+":"+t(i.getMinutes())+":"+t(i.getSeconds())+"]: "+e}static _LogDisabled(e,t){}static _LogEnabled(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0;if(void 0!==i&&!s._CheckLimit(t,i))return;const n=s._FormatMessage(t),r=this._Levels[e];r.logFunc&&r.logFunc("BJS - "+n);const a="<div style='color:".concat(r.color,"'>").concat(n,"</div><br>");s._AddLogEntry(a),s._GenerateLimitMessage(t,e)}static get LogCache(){return s._LogCache}static ClearLogCache(){s._LogCache="",s._LogLimitOutputs={},s.errorsCount=0}static set LogLevels(e){s.Log=s._LogDisabled,s.Warn=s._LogDisabled,s.Error=s._LogDisabled,[s.MessageLogLevel,s.WarningLogLevel,s.ErrorLogLevel].forEach((t=>{if((e&t)===t){const e=this._Levels[t];s[e.name]=s._LogEnabled.bind(s,t)}}))}}s.NoneLogLevel=0,s.MessageLogLevel=1,s.WarningLogLevel=2,s.ErrorLogLevel=4,s.AllLogLevel=7,s.MessageLimitReached="Too many %TYPE%s (%LIMIT%), no more %TYPE%s will be reported for this message.",s._LogCache="",s._LogLimitOutputs={},s._Levels=[{},{color:"white",logFunc:console.log,name:"Log"},{color:"orange",logFunc:console.warn,name:"Warn"},{},{color:"red",logFunc:console.error,name:"Error"}],s.errorsCount=0,s.Log=s._LogEnabled.bind(s,s.MessageLogLevel),s.Warn=s._LogEnabled.bind(s,s.WarningLogLevel),s.Error=s._LogEnabled.bind(s,s.ErrorLogLevel)},4174:function(e,t,i){"use strict";i.d(t,{y$:function(){return r}});class s{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;this.initialize(e,t,i,s)}initialize(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;return this.mask=e,this.skipNextObservers=t,this.target=i,this.currentTarget=s,this}}class n{constructor(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.callback=e,this.mask=t,this.scope=i,this._willBeUnregistered=!1,this.unregisterOnNextCall=!1}}class r{static FromPromise(e,t){const i=new r;return e.then((e=>{i.notifyObservers(e)})).catch((e=>{if(!t)throw e;t.notifyObservers(e)})),i}get observers(){return this._observers}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.notifyIfTriggered=t,this._observers=new Array,this._numObserversMarkedAsDeleted=0,this._hasNotified=!1,this._eventState=new s(0),e&&(this._onObserverAdded=e)}add(e){let t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!e)return null;const s=new n(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null);return s.unregisterOnNextCall=i,t?this._observers.unshift(s):this._observers.push(s),this._onObserverAdded&&this._onObserverAdded(s),this._hasNotified&&this.notifyIfTriggered&&void 0!==this._lastNotifiedValue&&this.notifyObserver(s,this._lastNotifiedValue),s}addOnce(e){return this.add(e,void 0,void 0,void 0,!0)}remove(e){if(!e)return!1;return-1!==this._observers.indexOf(e)&&(this._deferUnregister(e),!0)}removeCallback(e,t){for(let i=0;i<this._observers.length;i++){const s=this._observers[i];if(!s._willBeUnregistered&&(s.callback===e&&(!t||t===s.scope)))return this._deferUnregister(s),!0}return!1}_deferUnregister(e){e._willBeUnregistered||(this._numObserversMarkedAsDeleted++,e.unregisterOnNextCall=!1,e._willBeUnregistered=!0,setTimeout((()=>{this._remove(e)}),0))}_remove(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!e)return!1;const i=this._observers.indexOf(e);return-1!==i&&(t&&this._numObserversMarkedAsDeleted--,this._observers.splice(i,1),!0)}makeObserverTopPriority(e){this._remove(e,!1),this._observers.unshift(e)}makeObserverBottomPriority(e){this._remove(e,!1),this._observers.push(e)}notifyObservers(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,i=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0,n=arguments.length>4?arguments[4]:void 0;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=e),!this._observers.length)return!0;const r=this._eventState;r.mask=t,r.target=i,r.currentTarget=s,r.skipNextObservers=!1,r.lastReturnValue=e,r.userInfo=n;for(const a of this._observers)if(!a._willBeUnregistered&&(a.mask&t&&(a.unregisterOnNextCall&&this._deferUnregister(a),a.scope?r.lastReturnValue=a.callback.apply(a.scope,[e,r]):r.lastReturnValue=a.callback(e,r)),r.skipNextObservers))return!1;return!0}notifyObserver(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(this.notifyIfTriggered&&(this._hasNotified=!0,this._lastNotifiedValue=t),e._willBeUnregistered)return;const s=this._eventState;s.mask=i,s.skipNextObservers=!1,e.unregisterOnNextCall&&this._deferUnregister(e),e.callback(t,s)}hasObservers(){return this._observers.length-this._numObserversMarkedAsDeleted>0}clear(){this._observers.length=0,this._onObserverAdded=null,this._numObserversMarkedAsDeleted=0,this.cleanLastNotifiedState()}cleanLastNotifiedState(){this._hasNotified=!1,this._lastNotifiedValue=void 0}clone(){const e=new r;return e._observers=this._observers.slice(0),e}hasSpecificMask(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;for(const t of this._observers)if(t.mask&e||t.mask===e)return!0;return!1}}},2864:function(e,t,i){"use strict";i.d(t,{z:function(){return n}});var s=i(2786);class n{get min(){return this._min}get max(){return this._max}get average(){return this._average}get lastSecAverage(){return this._lastSecAverage}get current(){return this._current}get total(){return this._totalAccumulated}get count(){return this._totalValueCount}constructor(){this._startMonitoringTime=0,this._min=0,this._max=0,this._average=0,this._lastSecAverage=0,this._current=0,this._totalValueCount=0,this._totalAccumulated=0,this._lastSecAccumulated=0,this._lastSecTime=0,this._lastSecValueCount=0}fetchNewFrame(){this._totalValueCount++,this._current=0,this._lastSecValueCount++}addCount(e,t){n.Enabled&&(this._current+=e,t&&this._fetchResult())}beginMonitoring(){n.Enabled&&(this._startMonitoringTime=s.F.Now)}endMonitoring(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!n.Enabled)return;e&&this.fetchNewFrame();const t=s.F.Now;this._current=t-this._startMonitoringTime,e&&this._fetchResult()}_fetchResult(){this._totalAccumulated+=this._current,this._lastSecAccumulated+=this._current,this._min=Math.min(this._min,this._current),this._max=Math.max(this._max,this._current),this._average=this._totalAccumulated/this._totalValueCount;const e=s.F.Now;e-this._lastSecTime>1e3&&(this._lastSecAverage=this._lastSecAccumulated/this._lastSecValueCount,this._lastSecTime=e,this._lastSecAccumulated=0,this._lastSecValueCount=0)}}n.Enabled=!0},2786:function(e,t,i){"use strict";i.d(t,{F:function(){return n}});var s=i(5092);class n{static get Now(){return s.MZ.IsWindowObjectExist()&&window.performance&&window.performance.now?window.performance.now():Date.now()}}},5934:function(e,t,i){"use strict";i.d(t,{f:function(){return n},t:function(){return s}});class s{constructor(e){this.length=0,this.data=new Array(e),this._id=s._GlobalId++}push(e){this.data[this.length++]=e,this.length>this.data.length&&(this.data.length*=2)}forEach(e){for(let t=0;t<this.length;t++)e(this.data[t])}sort(e){this.data.sort(e)}reset(){this.length=0}dispose(){this.reset(),this.data&&(this.data.length=0)}concat(e){if(0!==e.length){this.length+e.length>this.data.length&&(this.data.length=2*(this.length+e.length));for(let t=0;t<e.length;t++)this.data[this.length++]=(e.data||e)[t]}}indexOf(e){const t=this.data.indexOf(e);return t>=this.length?-1:t}contains(e){return-1!==this.indexOf(e)}}s._GlobalId=0;class n extends s{constructor(){super(...arguments),this._duplicateId=0}push(e){super.push(e),e.__smartArrayFlags||(e.__smartArrayFlags={}),e.__smartArrayFlags[this._id]=this._duplicateId}pushNoDuplicate(e){return(!e.__smartArrayFlags||e.__smartArrayFlags[this._id]!==this._duplicateId)&&(this.push(e),!0)}reset(){super.reset(),this._duplicateId++}concatWithNoDuplicate(e){if(0!==e.length){this.length+e.length>this.data.length&&(this.data.length=2*(this.length+e.length));for(let t=0;t<e.length;t++){const i=(e.data||e)[t];this.pushNoDuplicate(i)}}}}},2399:function(e,t,i){"use strict";i.d(t,{Gh:function(){return s},HQ:function(){return r},rP:function(){return n}});const s=e=>{const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let i,s,n,r,a,o,l,h="",c=0;const u=ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e);for(;c<u.length;)i=u[c++],s=c<u.length?u[c++]:Number.NaN,n=c<u.length?u[c++]:Number.NaN,r=i>>2,a=(3&i)<<4|s>>4,o=(15&s)<<2|n>>6,l=63&n,isNaN(s)?o=l=64:isNaN(n)&&(l=64),h+=t.charAt(r)+t.charAt(a)+t.charAt(o)+t.charAt(l);return h},n=e=>atob(e),r=e=>{const t=n(e),i=t.length,s=new Uint8Array(new ArrayBuffer(i));for(let n=0;n<i;n++)s[n]=t.charCodeAt(n);return s.buffer}},7032:function(e,t,i){"use strict";i.d(t,{$:function(){return n}});class s{static Eval(e,t){return"true"===(e=e.match(/\([^()]*\)/g)?e.replace(/\([^()]*\)/g,(e=>(e=e.slice(1,e.length-1),s._HandleParenthesisContent(e,t)))):s._HandleParenthesisContent(e,t))||"false"!==e&&s.Eval(e,t)}static _HandleParenthesisContent(e,t){let i;t=t||(e=>"true"===e);const n=e.split("||");for(const r in n)if(Object.prototype.hasOwnProperty.call(n,r)){let e=s._SimplifyNegation(n[r].trim());const a=e.split("&&");if(a.length>1)for(let n=0;n<a.length;++n){const r=s._SimplifyNegation(a[n].trim());if(i="true"!==r&&"false"!==r?"!"===r[0]?!t(r.substring(1)):t(r):"true"===r,!i){e="false";break}}if(i||"true"===e){i=!0;break}i="true"!==e&&"false"!==e?"!"===e[0]?!t(e.substring(1)):t(e):"true"===e}return i?"true":"false"}static _SimplifyNegation(e){return"!true"===(e=(e=e.replace(/^[\s!]+/,(e=>(e=e.replace(/[\s]/g,(()=>""))).length%2?"!":""))).trim())?e="false":"!false"===e&&(e="true"),e}}class n{static EnableFor(e){e._tags=e._tags||{},e.hasTags=()=>n.HasTags(e),e.addTags=t=>n.AddTagsTo(e,t),e.removeTags=t=>n.RemoveTagsFrom(e,t),e.matchesTagsQuery=t=>n.MatchesQuery(e,t)}static DisableFor(e){delete e._tags,delete e.hasTags,delete e.addTags,delete e.removeTags,delete e.matchesTagsQuery}static HasTags(e){if(!e._tags)return!1;const t=e._tags;for(const i in t)if(Object.prototype.hasOwnProperty.call(t,i))return!0;return!1}static GetTags(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!e._tags)return null;if(t){const t=[];for(const i in e._tags)Object.prototype.hasOwnProperty.call(e._tags,i)&&!0===e._tags[i]&&t.push(i);return t.join(" ")}return e._tags}static AddTagsTo(e,t){if(!t)return;if("string"!=typeof t)return;t.split(" ").forEach((function(t){n._AddTagTo(e,t)}))}static _AddTagTo(e,t){""!==(t=t.trim())&&"true"!==t&&"false"!==t&&(t.match(/[\s]/)||t.match(/^([!]|([|]|[&]){2})/)||(n.EnableFor(e),e._tags[t]=!0))}static RemoveTagsFrom(e,t){if(!n.HasTags(e))return;const i=t.split(" ");for(const s in i)n._RemoveTagFrom(e,i[s])}static _RemoveTagFrom(e,t){delete e._tags[t]}static MatchesQuery(e,t){return void 0===t||(""===t?n.HasTags(e):s.Eval(t,(t=>n.HasTags(e)&&e._tags[t])))}}},8370:function(e,t,i){"use strict";i.d(t,{Q:function(){return n}});var s=i(5092);class n{static SetImmediate(e){(0,s.CG)()&&window.setImmediate?window.setImmediate(e):setTimeout(e,1)}}},8517:function(e,t,i){"use strict";i.d(t,{$g:function(){return m},w1:function(){return g}});var s=i(4174),n=i(5092),r=i(2328),a=i(3192),o=i(2786),l=i(5230),h=i(8628),c=i(4198),u=i(562),d=i(8370),f=i(8797),p=i(9950);class g{static get BaseUrl(){return u.rN.BaseUrl}static set BaseUrl(e){u.rN.BaseUrl=e}static get DefaultRetryStrategy(){return u.rN.DefaultRetryStrategy}static set DefaultRetryStrategy(e){u.rN.DefaultRetryStrategy=e}static get CorsBehavior(){return u.rN.CorsBehavior}static set CorsBehavior(e){u.rN.CorsBehavior=e}static get UseFallbackTexture(){return c.l.UseFallbackTexture}static set UseFallbackTexture(e){c.l.UseFallbackTexture=e}static get RegisteredExternalClasses(){return f.K.RegisteredExternalClasses}static set RegisteredExternalClasses(e){f.K.RegisteredExternalClasses=e}static get fallbackTexture(){return c.l.FallbackTexture}static set fallbackTexture(e){c.l.FallbackTexture=e}static FetchToRef(e,t,i,s,n,r){const a=4*((Math.abs(e)*i%i|0)+(Math.abs(t)*s%s|0)*i);r.r=n[a]/255,r.g=n[a+1]/255,r.b=n[a+2]/255,r.a=n[a+3]/255}static Mix(e,t,i){return e*(1-i)+t*i}static Instantiate(e){return f.K.Instantiate(e)}static SetImmediate(e){d.Q.SetImmediate(e)}static IsExponentOfTwo(e){let t=1;do{t*=2}while(t<e);return t===e}static FloatRound(e){return Math.fround?Math.fround(e):(g._TmpFloatArray[0]=e,g._TmpFloatArray[0])}static GetFilename(e){const t=e.lastIndexOf("/");return t<0?e:e.substring(t+1)}static GetFolderPath(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const i=e.lastIndexOf("/");return i<0?t?e:"":e.substring(0,i+1)}static ToDegrees(e){return 180*e/Math.PI}static ToRadians(e){return e*Math.PI/180}static SmoothAngleChange(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.9;const s=this.ToRadians(e),n=this.ToRadians(t);return this.ToDegrees(Math.atan2((1-i)*Math.sin(n)+i*Math.sin(s),(1-i)*Math.cos(n)+i*Math.cos(s)))}static MakeArray(e,t){return!0===t||void 0!==e&&null!=e?Array.isArray(e)?e:[e]:null}static GetPointerPrefix(e){let t="pointer";return(0,n.CG)()&&!window.PointerEvent&&(t="mouse"),!e._badDesktopOS||e._badOS||document&&"ontouchend"in document||(t="mouse"),t}static SetCorsBehavior(e,t){(0,u.$M)(e,t)}static SetReferrerPolicyBehavior(e,t){t.referrerPolicy=e}static CleanUrl(e){return e=e.replace(/#/gm,"%23")}static get PreprocessUrl(){return u.rN.PreprocessUrl}static set PreprocessUrl(e){u.rN.PreprocessUrl=e}static LoadImage(e,t,i,s,n,r){return(0,u.r6)(e,t,i,s,n,r)}static LoadFile(e,t,i,s,n,r){return(0,u.vP)(e,t,i,s,n,r)}static LoadFileAsync(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return new Promise(((i,s)=>{(0,u.vP)(e,(e=>{i(e)}),void 0,void 0,t,((e,t)=>{s(t)}))}))}static LoadScript(e,t,i,s){if("function"==typeof importScripts){try{importScripts(e),t()}catch(o){null==i||i("Unable to load script '".concat(e,"' in worker"),o)}return}if(!(0,n.CG)())return void(null==i||i("Cannot load script '".concat(e,"' outside of a window or a worker")));const r=document.getElementsByTagName("head")[0],a=document.createElement("script");a.setAttribute("type","text/javascript"),a.setAttribute("src",e),s&&(a.id=s),a.onload=()=>{t&&t()},a.onerror=t=>{i&&i("Unable to load script '".concat(e,"'"),t)},r.appendChild(a)}static LoadScriptAsync(e){return new Promise(((t,i)=>{this.LoadScript(e,(()=>{t()}),((e,t)=>{i(t||new Error(e))}))}))}static ReadFileAsDataURL(e,t,i){const n=new FileReader,r={onCompleteObservable:new s.y$,abort:()=>n.abort()};return n.onloadend=()=>{r.onCompleteObservable.notifyObservers(r)},n.onload=e=>{t(e.target.result)},n.onprogress=i,n.readAsDataURL(e),r}static ReadFile(e,t,i,s,n){return(0,u.Ip)(e,t,i,s,n)}static FileAsURL(e){const t=new Blob([e]);return window.URL.createObjectURL(t)}static Format(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return e.toFixed(t)}static DeepCopy(e,t,i,s){a.j.DeepCopy(e,t,i,s)}static IsEmpty(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}static RegisterTopRootEvents(e,t){for(let s=0;s<t.length;s++){const n=t[s];e.addEventListener(n.name,n.handler,!1);try{window.parent&&window.parent.addEventListener(n.name,n.handler,!1)}catch(i){}}}static UnregisterTopRootEvents(e,t){for(let s=0;s<t.length;s++){const n=t[s];e.removeEventListener(n.name,n.handler);try{e.parent&&e.parent.removeEventListener(n.name,n.handler)}catch(i){}}}static async DumpFramebuffer(e,t,i,s){throw(0,l.S)("DumpTools")}static DumpData(e,t,i,s){throw(0,l.S)("DumpTools")}static DumpDataAsync(e,t,i){throw(0,l.S)("DumpTools")}static ToBlob(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"image/png",s=arguments.length>3?arguments[3]:void 0;e.toBlob||(e.toBlob=function(e,t,i){setTimeout((()=>{const s=atob(this.toDataURL(t,i).split(",")[1]),n=s.length,r=new Uint8Array(n);for(let e=0;e<n;e++)r[e]=s.charCodeAt(e);e(new Blob([r]))}))}),e.toBlob((function(e){t(e)}),i,s)}static DownloadBlob(e,t){if("download"in document.createElement("a")){if(!t){const e=new Date;t="screenshot_"+((e.getFullYear()+"-"+(e.getMonth()+1)).slice(2)+"-"+e.getDate()+"_"+e.getHours()+"-"+("0"+e.getMinutes()).slice(-2))+".png"}g.Download(e,t)}else if(e&&"undefined"!=typeof URL){const t=URL.createObjectURL(e),i=window.open("");if(!i)return;const s=i.document.createElement("img");s.onload=function(){URL.revokeObjectURL(t)},s.src=t,i.document.body.appendChild(s)}}static EncodeScreenshotCanvasData(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"image/png",s=arguments.length>3?arguments[3]:void 0,n=arguments.length>4?arguments[4]:void 0;if(t){t(e.toDataURL(i,n))}else this.ToBlob(e,(function(e){e&&g.DownloadBlob(e,s)}),i,n)}static Download(e,t){if("undefined"==typeof URL)return;const i=window.URL.createObjectURL(e),s=document.createElement("a");document.body.appendChild(s),s.style.display="none",s.href=i,s.download=t,s.addEventListener("click",(()=>{s.parentElement&&s.parentElement.removeChild(s)})),s.click(),window.URL.revokeObjectURL(i)}static BackCompatCameraNoPreventDefault(e){return"boolean"==typeof e[0]?e[0]:"boolean"==typeof e[1]&&e[1]}static CreateScreenshot(e,t,i,s){throw(0,l.S)("ScreenshotTools")}static CreateScreenshotAsync(e,t,i){throw(0,l.S)("ScreenshotTools")}static CreateScreenshotUsingRenderTarget(e,t,i,s){throw(0,l.S)("ScreenshotTools")}static CreateScreenshotUsingRenderTargetAsync(e,t,i){throw(0,l.S)("ScreenshotTools")}static RandomId(){return(0,p.f)()}static IsBase64(e){return(0,u.VL)(e)}static DecodeBase64(e){return(0,u.$K)(e)}static get errorsCount(){return r.Y.errorsCount}static Log(e){r.Y.Log(e)}static Warn(e){r.Y.Warn(e)}static Error(e){r.Y.Error(e)}static get LogCache(){return r.Y.LogCache}static ClearLogCache(){r.Y.ClearLogCache()}static set LogLevels(e){r.Y.LogLevels=e}static set PerformanceLogLevel(e){return(e&g.PerformanceUserMarkLogLevel)===g.PerformanceUserMarkLogLevel?(g.StartPerformanceCounter=g._StartUserMark,void(g.EndPerformanceCounter=g._EndUserMark)):(e&g.PerformanceConsoleLogLevel)===g.PerformanceConsoleLogLevel?(g.StartPerformanceCounter=g._StartPerformanceConsole,void(g.EndPerformanceCounter=g._EndPerformanceConsole)):(g.StartPerformanceCounter=g._StartPerformanceCounterDisabled,void(g.EndPerformanceCounter=g._EndPerformanceCounterDisabled))}static _StartPerformanceCounterDisabled(e,t){}static _EndPerformanceCounterDisabled(e,t){}static _StartUserMark(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!g._Performance){if(!(0,n.CG)())return;g._Performance=window.performance}t&&g._Performance.mark&&g._Performance.mark(e+"-Begin")}static _EndUserMark(e){(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&g._Performance.mark&&(g._Performance.mark(e+"-End"),g._Performance.measure(e,e+"-Begin",e+"-End"))}static _StartPerformanceConsole(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t&&(g._StartUserMark(e,t),console.time&&console.time(e))}static _EndPerformanceConsole(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t&&(g._EndUserMark(e,t),console.timeEnd(e))}static get Now(){return o.F.Now}static GetClassName(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=null;if(!t&&e.getClassName)i=e.getClassName();else{if(e instanceof Object){i=(t?e:Object.getPrototypeOf(e)).constructor.__bjsclassName__}i||(i=typeof e)}return i}static First(e,t){for(const i of e)if(t(i))return i;return null}static getFullClassName(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=null,s=null;if(!t&&e.getClassName)i=e.getClassName();else{if(e instanceof Object){const n=t?e:Object.getPrototypeOf(e);i=n.constructor.__bjsclassName__,s=n.constructor.__bjsmoduleName__}i||(i=typeof e)}return i?(null!=s?s+".":"")+i:null}static DelayAsync(e){return new Promise((t=>{setTimeout((()=>{t()}),e)}))}static IsSafari(){return!!(0,n.up)()&&/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}}g.UseCustomRequestHeaders=!1,g.CustomRequestHeaders=h.g.CustomRequestHeaders,g._TmpFloatArray=new Float32Array(1),g.GetDOMTextContent=n.v,g.GetAbsoluteUrl="object"==typeof document?e=>{const t=document.createElement("a");return t.href=e,t.href}:"function"==typeof URL&&"object"==typeof location?e=>new URL(e,location.origin).href:()=>{throw new Error("Unable to get absolute URL. Override BABYLON.Tools.GetAbsoluteUrl to a custom implementation for the current context.")},g.NoneLogLevel=r.Y.NoneLogLevel,g.MessageLogLevel=r.Y.MessageLogLevel,g.WarningLogLevel=r.Y.WarningLogLevel,g.ErrorLogLevel=r.Y.ErrorLogLevel,g.AllLogLevel=r.Y.AllLogLevel,g.IsWindowObjectExist=n.CG,g.PerformanceNoneLogLevel=0,g.PerformanceUserMarkLogLevel=1,g.PerformanceConsoleLogLevel=2,g.StartPerformanceCounter=g._StartPerformanceCounterDisabled,g.EndPerformanceCounter=g._EndPerformanceCounterDisabled;class m{constructor(e,t,i){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.iterations=e,this.index=s-1,this._done=!1,this._fn=t,this._successCallback=i}executeNext(){this._done||(this.index+1<this.iterations?(++this.index,this._fn(this)):this.breakLoop())}breakLoop(){this._done=!0,this._successCallback()}static Run(e,t,i){const s=new m(e,t,i,arguments.length>3&&void 0!==arguments[3]?arguments[3]:0);return s.executeNext(),s}static SyncAsyncForLoop(e,t,i,s,n){let r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;return m.Run(Math.ceil(e/t),(s=>{n&&n()?s.breakLoop():setTimeout((()=>{for(let r=0;r<t;++r){const a=s.index*t+r;if(a>=e)break;if(i(a),n&&n()){s.breakLoop();break}}s.executeNext()}),r)}),s)}}c.l.FallbackTexture="data:image/jpg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/4QBmRXhpZgAATU0AKgAAAAgABAEaAAUAAAABAAAAPgEbAAUAAAABAAAARgEoAAMAAAABAAIAAAExAAIAAAAQAAAATgAAAAAAAABgAAAAAQAAAGAAAAABcGFpbnQubmV0IDQuMC41AP/bAEMABAIDAwMCBAMDAwQEBAQFCQYFBQUFCwgIBgkNCw0NDQsMDA4QFBEODxMPDAwSGBITFRYXFxcOERkbGRYaFBYXFv/bAEMBBAQEBQUFCgYGChYPDA8WFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFv/AABEIAQABAAMBIgACEQEDEQH/xAAfAAABBQEBAQEBAQAAAAAAAAAAAQIDBAUGBwgJCgv/xAC1EAACAQMDAgQDBQUEBAAAAX0BAgMABBEFEiExQQYTUWEHInEUMoGRoQgjQrHBFVLR8CQzYnKCCQoWFxgZGiUmJygpKjQ1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4eLj5OXm5+jp6vHy8/T19vf4+fr/xAAfAQADAQEBAQEBAQEBAAAAAAAAAQIDBAUGBwgJCgv/xAC1EQACAQIEBAMEBwUEBAABAncAAQIDEQQFITEGEkFRB2FxEyIygQgUQpGhscEJIzNS8BVictEKFiQ04SXxFxgZGiYnKCkqNTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqCg4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2dri4+Tl5ufo6ery8/T19vf4+fr/2gAMAwEAAhEDEQA/APH6KKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FCiiigD6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++gooooA+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gUKKKKAPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76CiiigD5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BQooooA+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/voKKKKAPl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FCiiigD6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++gooooA+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gUKKKKAPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76CiiigD5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BQooooA+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/voKKKKAPl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FCiiigD6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++gooooA+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gUKKKKAPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76P//Z"},1704:function(e,t,i){"use strict";i.d(t,{H:function(){return n},q:function(){return r}});const s={};function n(e,t){s[e]=t}function r(e){return s[e]}},8628:function(e,t,i){"use strict";i.d(t,{g:function(){return s}});class s{constructor(){this._xhr="undefined"!=typeof _native&&_native.XMLHttpRequest?new _native.XMLHttpRequest:new XMLHttpRequest,this._requestURL=""}_injectCustomRequestHeaders(){if(!this._shouldSkipRequestModifications(this._requestURL))for(const e in s.CustomRequestHeaders){const t=s.CustomRequestHeaders[e];t&&this._xhr.setRequestHeader(e,t)}}_shouldSkipRequestModifications(e){return s.SkipRequestModificationForBabylonCDN&&(e.includes("preview.babylonjs.com")||e.includes("cdn.babylonjs.com"))}get onprogress(){return this._xhr.onprogress}set onprogress(e){this._xhr.onprogress=e}get readyState(){return this._xhr.readyState}get status(){return this._xhr.status}get statusText(){return this._xhr.statusText}get response(){return this._xhr.response}get responseURL(){return this._xhr.responseURL}get responseText(){return this._xhr.responseText}get responseType(){return this._xhr.responseType}set responseType(e){this._xhr.responseType=e}get timeout(){return this._xhr.timeout}set timeout(e){this._xhr.timeout=e}addEventListener(e,t,i){this._xhr.addEventListener(e,t,i)}removeEventListener(e,t,i){this._xhr.removeEventListener(e,t,i)}abort(){this._xhr.abort()}send(e){s.CustomRequestHeaders&&this._injectCustomRequestHeaders(),this._xhr.send(e)}open(e,t){for(const i of s.CustomRequestModifiers){if(this._shouldSkipRequestModifications(t))return;i(this._xhr,t)}return t=(t=t.replace("file:http:","http:")).replace("file:https:","https:"),this._requestURL=t,this._xhr.open(e,t,!0)}setRequestHeader(e,t){this._xhr.setRequestHeader(e,t)}getResponseHeader(e){return this._xhr.getResponseHeader(e)}}s.CustomRequestHeaders={},s.CustomRequestModifiers=new Array,s.SkipRequestModificationForBabylonCDN=!0},768:function(e,t,i){"use strict";i.d(t,{Q:function(){return s}});class s{constructor(){this._blendFunctionParameters=new Array(4),this._blendEquationParameters=new Array(2),this._blendConstants=new Array(4),this._isBlendConstantsDirty=!1,this._alphaBlend=!1,this._isAlphaBlendDirty=!1,this._isBlendFunctionParametersDirty=!1,this._isBlendEquationParametersDirty=!1,this.reset()}get isDirty(){return this._isAlphaBlendDirty||this._isBlendFunctionParametersDirty||this._isBlendEquationParametersDirty}get alphaBlend(){return this._alphaBlend}set alphaBlend(e){this._alphaBlend!==e&&(this._alphaBlend=e,this._isAlphaBlendDirty=!0)}setAlphaBlendConstants(e,t,i,s){this._blendConstants[0]===e&&this._blendConstants[1]===t&&this._blendConstants[2]===i&&this._blendConstants[3]===s||(this._blendConstants[0]=e,this._blendConstants[1]=t,this._blendConstants[2]=i,this._blendConstants[3]=s,this._isBlendConstantsDirty=!0)}setAlphaBlendFunctionParameters(e,t,i,s){this._blendFunctionParameters[0]===e&&this._blendFunctionParameters[1]===t&&this._blendFunctionParameters[2]===i&&this._blendFunctionParameters[3]===s||(this._blendFunctionParameters[0]=e,this._blendFunctionParameters[1]=t,this._blendFunctionParameters[2]=i,this._blendFunctionParameters[3]=s,this._isBlendFunctionParametersDirty=!0)}setAlphaEquationParameters(e,t){this._blendEquationParameters[0]===e&&this._blendEquationParameters[1]===t||(this._blendEquationParameters[0]=e,this._blendEquationParameters[1]=t,this._isBlendEquationParametersDirty=!0)}reset(){this._alphaBlend=!1,this._blendFunctionParameters[0]=null,this._blendFunctionParameters[1]=null,this._blendFunctionParameters[2]=null,this._blendFunctionParameters[3]=null,this._blendEquationParameters[0]=null,this._blendEquationParameters[1]=null,this._blendConstants[0]=null,this._blendConstants[1]=null,this._blendConstants[2]=null,this._blendConstants[3]=null,this._isAlphaBlendDirty=!0,this._isBlendFunctionParametersDirty=!1,this._isBlendEquationParametersDirty=!1,this._isBlendConstantsDirty=!1}apply(e){this.isDirty&&(this._isAlphaBlendDirty&&(this._alphaBlend?e.enable(e.BLEND):e.disable(e.BLEND),this._isAlphaBlendDirty=!1),this._isBlendFunctionParametersDirty&&(e.blendFuncSeparate(this._blendFunctionParameters[0],this._blendFunctionParameters[1],this._blendFunctionParameters[2],this._blendFunctionParameters[3]),this._isBlendFunctionParametersDirty=!1),this._isBlendEquationParametersDirty&&(e.blendEquationSeparate(this._blendEquationParameters[0],this._blendEquationParameters[1]),this._isBlendEquationParametersDirty=!1),this._isBlendConstantsDirty&&(e.blendColor(this._blendConstants[0],this._blendConstants[1],this._blendConstants[2],this._blendConstants[3]),this._isBlendConstantsDirty=!1))}}},1379:function(e,t,i){"use strict";i.d(t,{k:function(){return s}});class s{constructor(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._isDepthTestDirty=!1,this._isDepthMaskDirty=!1,this._isDepthFuncDirty=!1,this._isCullFaceDirty=!1,this._isCullDirty=!1,this._isZOffsetDirty=!1,this._isFrontFaceDirty=!1,e&&this.reset()}get isDirty(){return this._isDepthFuncDirty||this._isDepthTestDirty||this._isDepthMaskDirty||this._isCullFaceDirty||this._isCullDirty||this._isZOffsetDirty||this._isFrontFaceDirty}get zOffset(){return this._zOffset}set zOffset(e){this._zOffset!==e&&(this._zOffset=e,this._isZOffsetDirty=!0)}get zOffsetUnits(){return this._zOffsetUnits}set zOffsetUnits(e){this._zOffsetUnits!==e&&(this._zOffsetUnits=e,this._isZOffsetDirty=!0)}get cullFace(){return this._cullFace}set cullFace(e){this._cullFace!==e&&(this._cullFace=e,this._isCullFaceDirty=!0)}get cull(){return this._cull}set cull(e){this._cull!==e&&(this._cull=e,this._isCullDirty=!0)}get depthFunc(){return this._depthFunc}set depthFunc(e){this._depthFunc!==e&&(this._depthFunc=e,this._isDepthFuncDirty=!0)}get depthMask(){return this._depthMask}set depthMask(e){this._depthMask!==e&&(this._depthMask=e,this._isDepthMaskDirty=!0)}get depthTest(){return this._depthTest}set depthTest(e){this._depthTest!==e&&(this._depthTest=e,this._isDepthTestDirty=!0)}get frontFace(){return this._frontFace}set frontFace(e){this._frontFace!==e&&(this._frontFace=e,this._isFrontFaceDirty=!0)}reset(){this._depthMask=!0,this._depthTest=!0,this._depthFunc=null,this._cullFace=null,this._cull=null,this._zOffset=0,this._zOffsetUnits=0,this._frontFace=null,this._isDepthTestDirty=!0,this._isDepthMaskDirty=!0,this._isDepthFuncDirty=!1,this._isCullFaceDirty=!1,this._isCullDirty=!1,this._isZOffsetDirty=!0,this._isFrontFaceDirty=!1}apply(e){this.isDirty&&(this._isCullDirty&&(this.cull?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE),this._isCullDirty=!1),this._isCullFaceDirty&&(e.cullFace(this.cullFace),this._isCullFaceDirty=!1),this._isDepthMaskDirty&&(e.depthMask(this.depthMask),this._isDepthMaskDirty=!1),this._isDepthTestDirty&&(this.depthTest?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST),this._isDepthTestDirty=!1),this._isDepthFuncDirty&&(e.depthFunc(this.depthFunc),this._isDepthFuncDirty=!1),this._isZOffsetDirty&&(this.zOffset||this.zOffsetUnits?(e.enable(e.POLYGON_OFFSET_FILL),e.polygonOffset(this.zOffset,this.zOffsetUnits)):e.disable(e.POLYGON_OFFSET_FILL),this._isZOffsetDirty=!1),this._isFrontFaceDirty&&(e.frontFace(this.frontFace),this._isFrontFaceDirty=!1))}}},5852:function(e,t,i){"use strict";i.d(t,{s:function(){return s}});class s{constructor(){this.reset()}reset(){this.enabled=!1,this.mask=255,this.func=s.ALWAYS,this.funcRef=1,this.funcMask=255,this.opStencilFail=s.KEEP,this.opDepthFail=s.KEEP,this.opStencilDepthPass=s.REPLACE}get stencilFunc(){return this.func}set stencilFunc(e){this.func=e}get stencilFuncRef(){return this.funcRef}set stencilFuncRef(e){this.funcRef=e}get stencilFuncMask(){return this.funcMask}set stencilFuncMask(e){this.funcMask=e}get stencilOpStencilFail(){return this.opStencilFail}set stencilOpStencilFail(e){this.opStencilFail=e}get stencilOpDepthFail(){return this.opDepthFail}set stencilOpDepthFail(e){this.opDepthFail=e}get stencilOpStencilDepthPass(){return this.opStencilDepthPass}set stencilOpStencilDepthPass(e){this.opStencilDepthPass=e}get stencilMask(){return this.mask}set stencilMask(e){this.mask=e}get stencilTest(){return this.enabled}set stencilTest(e){this.enabled=e}}s.ALWAYS=519,s.KEEP=7680,s.REPLACE=7681},8789:function(e,t,i){"use strict";i.d(t,{C:function(){return s}});class s{get isDirty(){return this._isStencilTestDirty||this._isStencilMaskDirty||this._isStencilFuncDirty||this._isStencilOpDirty}get func(){return this._func}set func(e){this._func!==e&&(this._func=e,this._isStencilFuncDirty=!0)}get funcRef(){return this._funcRef}set funcRef(e){this._funcRef!==e&&(this._funcRef=e,this._isStencilFuncDirty=!0)}get funcMask(){return this._funcMask}set funcMask(e){this._funcMask!==e&&(this._funcMask=e,this._isStencilFuncDirty=!0)}get opStencilFail(){return this._opStencilFail}set opStencilFail(e){this._opStencilFail!==e&&(this._opStencilFail=e,this._isStencilOpDirty=!0)}get opDepthFail(){return this._opDepthFail}set opDepthFail(e){this._opDepthFail!==e&&(this._opDepthFail=e,this._isStencilOpDirty=!0)}get opStencilDepthPass(){return this._opStencilDepthPass}set opStencilDepthPass(e){this._opStencilDepthPass!==e&&(this._opStencilDepthPass=e,this._isStencilOpDirty=!0)}get mask(){return this._mask}set mask(e){this._mask!==e&&(this._mask=e,this._isStencilMaskDirty=!0)}get enabled(){return this._enabled}set enabled(e){this._enabled!==e&&(this._enabled=e,this._isStencilTestDirty=!0)}constructor(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._isStencilTestDirty=!1,this._isStencilMaskDirty=!1,this._isStencilFuncDirty=!1,this._isStencilOpDirty=!1,this.useStencilGlobalOnly=!1,e&&this.reset()}reset(){var e;this.stencilMaterial=void 0,null===(e=this.stencilGlobal)||void 0===e||e.reset(),this._isStencilTestDirty=!0,this._isStencilMaskDirty=!0,this._isStencilFuncDirty=!0,this._isStencilOpDirty=!0}apply(e){var t;if(!e)return;const i=!this.useStencilGlobalOnly&&!!(null===(t=this.stencilMaterial)||void 0===t?void 0:t.enabled);this.enabled=i?this.stencilMaterial.enabled:this.stencilGlobal.enabled,this.func=i?this.stencilMaterial.func:this.stencilGlobal.func,this.funcRef=i?this.stencilMaterial.funcRef:this.stencilGlobal.funcRef,this.funcMask=i?this.stencilMaterial.funcMask:this.stencilGlobal.funcMask,this.opStencilFail=i?this.stencilMaterial.opStencilFail:this.stencilGlobal.opStencilFail,this.opDepthFail=i?this.stencilMaterial.opDepthFail:this.stencilGlobal.opDepthFail,this.opStencilDepthPass=i?this.stencilMaterial.opStencilDepthPass:this.stencilGlobal.opStencilDepthPass,this.mask=i?this.stencilMaterial.mask:this.stencilGlobal.mask,this.isDirty&&(this._isStencilTestDirty&&(this.enabled?e.enable(e.STENCIL_TEST):e.disable(e.STENCIL_TEST),this._isStencilTestDirty=!1),this._isStencilMaskDirty&&(e.stencilMask(this.mask),this._isStencilMaskDirty=!1),this._isStencilFuncDirty&&(e.stencilFunc(this.func,this.funcRef,this.funcMask),this._isStencilFuncDirty=!1),this._isStencilOpDirty&&(e.stencilOp(this.opStencilFail,this.opDepthFail,this.opStencilDepthPass),this._isStencilOpDirty=!1))}}},1396:function(e,t,i){"use strict";i.d(t,{N:function(){return c}});var s=i(9477),n=i(6900),r=i(9336),a=i(4174),o=i(4198),l=i(5230);class h{constructor(){this._doNotSerialize=!1,this._isDisposed=!1,this._sceneRootNodesIndex=-1,this._isEnabled=!0,this._isParentEnabled=!0,this._isReady=!0,this._onEnabledStateChangedObservable=new a.y$,this._onClonedObservable=new a.y$}}class c{static AddNodeConstructor(e,t){this._NodeConstructors[e]=t}static Construct(e,t,i,s){const n=this._NodeConstructors[e];return n?n(t,i,s):null}set accessibilityTag(e){this._accessibilityTag=e,this.onAccessibilityTagChangedObservable.notifyObservers(e)}get accessibilityTag(){return this._accessibilityTag}get doNotSerialize(){return!!this._nodeDataStorage._doNotSerialize||!!this._parentNode&&this._parentNode.doNotSerialize}set doNotSerialize(e){this._nodeDataStorage._doNotSerialize=e}isDisposed(){return this._nodeDataStorage._isDisposed}set parent(e){if(this._parentNode===e)return;const t=this._parentNode;if(this._parentNode&&void 0!==this._parentNode._children&&null!==this._parentNode._children){const t=this._parentNode._children.indexOf(this);-1!==t&&this._parentNode._children.splice(t,1),e||this._nodeDataStorage._isDisposed||this._addToSceneRootNodes()}this._parentNode=e,this._parentNode&&(void 0!==this._parentNode._children&&null!==this._parentNode._children||(this._parentNode._children=new Array),this._parentNode._children.push(this),t||this._removeFromSceneRootNodes()),this._syncParentEnabledState()}get parent(){return this._parentNode}_serializeAsParent(e){e.parentId=this.uniqueId}_addToSceneRootNodes(){-1===this._nodeDataStorage._sceneRootNodesIndex&&(this._nodeDataStorage._sceneRootNodesIndex=this._scene.rootNodes.length,this._scene.rootNodes.push(this))}_removeFromSceneRootNodes(){if(-1!==this._nodeDataStorage._sceneRootNodesIndex){const e=this._scene.rootNodes,t=e.length-1;e[this._nodeDataStorage._sceneRootNodesIndex]=e[t],e[this._nodeDataStorage._sceneRootNodesIndex]._nodeDataStorage._sceneRootNodesIndex=this._nodeDataStorage._sceneRootNodesIndex,this._scene.rootNodes.pop(),this._nodeDataStorage._sceneRootNodesIndex=-1}}get animationPropertiesOverride(){return this._animationPropertiesOverride?this._animationPropertiesOverride:this._scene.animationPropertiesOverride}set animationPropertiesOverride(e){this._animationPropertiesOverride=e}getClassName(){return"Node"}set onDispose(e){this._onDisposeObserver&&this.onDisposeObservable.remove(this._onDisposeObserver),this._onDisposeObserver=this.onDisposeObservable.add(e)}get onEnabledStateChangedObservable(){return this._nodeDataStorage._onEnabledStateChangedObservable}get onClonedObservable(){return this._nodeDataStorage._onClonedObservable}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._isDirty=!1,this._nodeDataStorage=new h,this.state="",this.metadata=null,this.reservedDataStore=null,this._accessibilityTag=null,this.onAccessibilityTagChangedObservable=new a.y$,this._parentContainer=null,this.animations=new Array,this._ranges={},this.onReady=null,this._currentRenderId=-1,this._parentUpdateId=-1,this._childUpdateId=-1,this._waitingParentId=null,this._waitingParentInstanceIndex=null,this._waitingParsedUniqueId=null,this._cache={},this._parentNode=null,this._children=null,this._worldMatrix=n.y3.Identity(),this._worldMatrixDeterminant=0,this._worldMatrixDeterminantIsDirty=!0,this._animationPropertiesOverride=null,this._isNode=!0,this.onDisposeObservable=new a.y$,this._onDisposeObserver=null,this._behaviors=new Array,this.name=e,this.id=e,this._scene=t||o.l.LastCreatedScene,this.uniqueId=this._scene.getUniqueId(),this._initCache()}getScene(){return this._scene}getEngine(){return this._scene.getEngine()}addBehavior(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return-1!==this._behaviors.indexOf(e)||(e.init(),this._scene.isLoading&&!t?this._scene.onDataLoadedObservable.addOnce((()=>{e.attach(this)})):e.attach(this),this._behaviors.push(e)),this}removeBehavior(e){const t=this._behaviors.indexOf(e);return-1===t||(this._behaviors[t].detach(),this._behaviors.splice(t,1)),this}get behaviors(){return this._behaviors}getBehaviorByName(e){for(const t of this._behaviors)if(t.name===e)return t;return null}getWorldMatrix(){return this._currentRenderId!==this._scene.getRenderId()&&this.computeWorldMatrix(),this._worldMatrix}_getWorldMatrixDeterminant(){return this._worldMatrixDeterminantIsDirty&&(this._worldMatrixDeterminantIsDirty=!1,this._worldMatrixDeterminant=this._worldMatrix.determinant()),this._worldMatrixDeterminant}get worldMatrixFromCache(){return this._worldMatrix}_initCache(){this._cache={},this._cache.parent=void 0}updateCache(e){!e&&this.isSynchronized()||(this._cache.parent=this.parent,this._updateCache())}_getActionManagerForTrigger(e){return this.parent?this.parent._getActionManagerForTrigger(e,!1):null}_updateCache(e){}_isSynchronized(){return!0}_markSyncedWithParent(){this._parentNode&&(this._parentUpdateId=this._parentNode._childUpdateId)}isSynchronizedWithParent(){return!this._parentNode||!this._parentNode._isDirty&&this._parentUpdateId===this._parentNode._childUpdateId&&this._parentNode.isSynchronized()}isSynchronized(){return this._cache.parent!==this._parentNode?(this._cache.parent=this._parentNode,!1):!(this._parentNode&&!this.isSynchronizedWithParent())&&this._isSynchronized()}isReady(){return this._nodeDataStorage._isReady}markAsDirty(e){return this._currentRenderId=Number.MAX_VALUE,this._isDirty=!0,this}isEnabled(){return!1===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])?this._nodeDataStorage._isEnabled:!!this._nodeDataStorage._isEnabled&&this._nodeDataStorage._isParentEnabled}_syncParentEnabledState(){this._nodeDataStorage._isParentEnabled=!this._parentNode||this._parentNode.isEnabled(),this._children&&this._children.forEach((e=>{e._syncParentEnabledState()}))}setEnabled(e){this._nodeDataStorage._isEnabled!==e&&(this._nodeDataStorage._isEnabled=e,this._syncParentEnabledState(),this._nodeDataStorage._onEnabledStateChangedObservable.notifyObservers(e))}isDescendantOf(e){return!!this.parent&&(this.parent===e||this.parent.isDescendantOf(e))}_getDescendants(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2?arguments[2]:void 0;if(this._children)for(let s=0;s<this._children.length;s++){const n=this._children[s];i&&!i(n)||e.push(n),t||n._getDescendants(e,!1,i)}}getDescendants(e,t){const i=new Array;return this._getDescendants(i,e,t),i}getChildMeshes(e,t){const i=[];return this._getDescendants(i,e,(e=>(!t||t(e))&&void 0!==e.cullingStrategy)),i}getChildren(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.getDescendants(t,e)}_setReady(e){e!==this._nodeDataStorage._isReady&&(e?(this.onReady&&this.onReady(this),this._nodeDataStorage._isReady=!0):this._nodeDataStorage._isReady=!1)}getAnimationByName(e){for(let t=0;t<this.animations.length;t++){const i=this.animations[t];if(i.name===e)return i}return null}createAnimationRange(e,t,i){if(!this._ranges[e]){this._ranges[e]=c._AnimationRangeFactory(e,t,i);for(let s=0,n=this.animations.length;s<n;s++)this.animations[s]&&this.animations[s].createRange(e,t,i)}}deleteAnimationRange(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];for(let i=0,s=this.animations.length;i<s;i++)this.animations[i]&&this.animations[i].deleteRange(e,t);this._ranges[e]=null}getAnimationRange(e){return this._ranges[e]||null}getAnimationRanges(){const e=[];let t;for(t in this._ranges)e.push(this._ranges[t]);return e}beginAnimation(e,t,i,s){const n=this.getAnimationRange(e);return n?this._scene.beginAnimation(this,n.from,n.to,t,i,s):null}serializeAnimationRanges(){const e=[];for(const t in this._ranges){const i=this._ranges[t];if(!i)continue;const s={};s.name=t,s.from=i.from,s.to=i.to,e.push(s)}return e}computeWorldMatrix(e){return this._worldMatrix||(this._worldMatrix=n.y3.Identity()),this._worldMatrix}dispose(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this._nodeDataStorage._isDisposed=!0,!e){const i=this.getDescendants(!0);for(const s of i)s.dispose(e,t)}this.parent?this.parent=null:this._removeFromSceneRootNodes(),this.onDisposeObservable.notifyObservers(this),this.onDisposeObservable.clear(),this.onEnabledStateChangedObservable.clear(),this.onClonedObservable.clear();for(const i of this._behaviors)i.detach();this._behaviors.length=0,this.metadata=null}static ParseAnimationRanges(e,t,i){if(t.ranges)for(let s=0;s<t.ranges.length;s++){const i=t.ranges[s];e.createAnimationRange(i.name,i.from,i.to)}}getHierarchyBoundingVectors(){let e,t,i=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.getScene().incrementRenderId(),this.computeWorldMatrix(!0);const r=this;if(r.getBoundingInfo&&r.subMeshes){const i=r.getBoundingInfo();e=i.boundingBox.minimumWorld.clone(),t=i.boundingBox.maximumWorld.clone()}else e=new n.P(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),t=new n.P(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);if(i){const i=this.getDescendants(!1);for(const r of i){const i=r;if(i.computeWorldMatrix(!0),s&&!s(i))continue;if(!i.getBoundingInfo||0===i.getTotalVertices())continue;const a=i.getBoundingInfo().boundingBox,o=a.minimumWorld,l=a.maximumWorld;n.P.CheckExtends(o,e,t),n.P.CheckExtends(l,e,t)}}return{min:e,max:t}}}c._AnimationRangeFactory=(e,t,i)=>{throw(0,l.S)("AnimationRange")},c._NodeConstructors={},(0,s.gn)([(0,r.qC)()],c.prototype,"name",void 0),(0,s.gn)([(0,r.qC)()],c.prototype,"id",void 0),(0,s.gn)([(0,r.qC)()],c.prototype,"uniqueId",void 0),(0,s.gn)([(0,r.qC)()],c.prototype,"state",void 0),(0,s.gn)([(0,r.qC)()],c.prototype,"metadata",void 0)},1962:function(e,t,i){"use strict";i.d(t,{x:function(){return $},a:function(){return q}});var s=i(8517),n=i(2786),r=i(4174),a=i(5934);class o{constructor(){this._count=0,this._data={}}copyFrom(e){this.clear(),e.forEach(((e,t)=>this.add(e,t)))}get(e){const t=this._data[e];if(void 0!==t)return t}getOrAddWithFactory(e,t){let i=this.get(e);return void 0!==i||(i=t(e),i&&this.add(e,i)),i}getOrAdd(e,t){const i=this.get(e);return void 0!==i?i:(this.add(e,t),t)}contains(e){return void 0!==this._data[e]}add(e,t){return void 0===this._data[e]&&(this._data[e]=t,++this._count,!0)}set(e,t){return void 0!==this._data[e]&&(this._data[e]=t,!0)}getAndRemove(e){const t=this.get(e);return void 0!==t?(delete this._data[e],--this._count,t):null}remove(e){return!!this.contains(e)&&(delete this._data[e],--this._count,!0)}clear(){this._data={},this._count=0}get count(){return this._count}forEach(e){for(const t in this._data){e(t,this._data[t])}}first(e){for(const t in this._data){const i=e(t,this._data[t]);if(i)return i}return null}}var l=i(7032),h=i(6900);class c{constructor(){this.rootNodes=new Array,this.cameras=new Array,this.lights=new Array,this.meshes=new Array,this.skeletons=new Array,this.particleSystems=new Array,this.animations=[],this.animationGroups=new Array,this.multiMaterials=new Array,this.materials=new Array,this.morphTargetManagers=new Array,this.geometries=new Array,this.transformNodes=new Array,this.actionManagers=new Array,this.textures=new Array,this._environmentTexture=null,this.postProcesses=new Array}static AddParser(e,t){this._BabylonFileParsers[e]=t}static GetParser(e){return this._BabylonFileParsers[e]?this._BabylonFileParsers[e]:null}static AddIndividualParser(e,t){this._IndividualBabylonFileParsers[e]=t}static GetIndividualParser(e){return this._IndividualBabylonFileParsers[e]?this._IndividualBabylonFileParsers[e]:null}static Parse(e,t,i,s){for(const n in this._BabylonFileParsers)Object.prototype.hasOwnProperty.call(this._BabylonFileParsers,n)&&this._BabylonFileParsers[n](e,t,i,s)}get environmentTexture(){return this._environmentTexture}set environmentTexture(e){this._environmentTexture=e}getNodes(){let e=new Array;return e=e.concat(this.meshes),e=e.concat(this.lights),e=e.concat(this.cameras),e=e.concat(this.transformNodes),this.skeletons.forEach((t=>e=e.concat(t.bones))),e}}c._BabylonFileParsers={},c._IndividualBabylonFileParsers={};var u=i(7823),d=i(1952),f=i(3541);class p{constructor(e,t,i,s,n,r){this.source=e,this.pointerX=t,this.pointerY=i,this.meshUnderPointer=s,this.sourceEvent=n,this.additionalData=r}static CreateNew(e,t,i){const s=e.getScene();return new p(e,s.pointerX,s.pointerY,s.meshUnderPointer||e,t,i)}static CreateNewFromSprite(e,t,i,s){return new p(e,t.pointerX,t.pointerY,t.meshUnderPointer,i,s)}static CreateNewFromScene(e,t){return new p(null,e.pointerX,e.pointerY,e.meshUnderPointer,t)}static CreateNewFromPrimitive(e,t,i,s){return new p(e,t.x,t.y,null,i,s)}}var g=i(2845);class m{constructor(e){this._vertexBuffers={},this._scene=e}_prepareBuffers(){if(this._vertexBuffers[g.o.PositionKind])return;const e=[];e.push(1,1),e.push(-1,1),e.push(-1,-1),e.push(1,-1),this._vertexBuffers[g.o.PositionKind]=new g.o(this._scene.getEngine(),e,g.o.PositionKind,!1,!1,2),this._buildIndexBuffer()}_buildIndexBuffer(){const e=[];e.push(0),e.push(1),e.push(2),e.push(0),e.push(2),e.push(3),this._indexBuffer=this._scene.getEngine().createIndexBuffer(e)}_rebuild(){const e=this._vertexBuffers[g.o.PositionKind];e&&(e._rebuild(),this._buildIndexBuffer())}_prepareFrame(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const i=this._scene.activeCamera;return!!i&&(t=t||i._postProcesses.filter((e=>null!=e)),!(!t||0===t.length||!this._scene.postProcessesEnabled)&&(t[0].activate(i,e,null!=t),!0))}directRender(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,r=arguments.length>5&&void 0!==arguments[5]&&arguments[5];var a;const o=this._scene.getEngine();for(let l=0;l<e.length;l++){l<e.length-1?e[l+1].activate(this._scene.activeCamera,null==t?void 0:t.texture):(t?o.bindFramebuffer(t,s,void 0,void 0,i,n):r||o.restoreDefaultFramebuffer(),null===(a=o._debugInsertMarker)||void 0===a||a.call(o,"post process ".concat(e[l].name," output")));const h=e[l],c=h.apply();c&&(h.onBeforeRenderObservable.notifyObservers(c),this._prepareBuffers(),o.bindBuffers(this._vertexBuffers,this._indexBuffer,c),o.drawElementsType(0,0,6),h.onAfterRenderObservable.notifyObservers(c))}o.setDepthBuffer(!0),o.setDepthWrite(!0)}_finalizeFrame(e,t,i,s){let n=arguments.length>4&&void 0!==arguments[4]&&arguments[4];var r;const a=this._scene.activeCamera;if(!a)return;if(0===(s=s||a._postProcesses.filter((e=>null!=e))).length||!this._scene.postProcessesEnabled)return;const o=this._scene.getEngine();for(let l=0,h=s.length;l<h;l++){const c=s[l];if(l<h-1?c._outputTexture=s[l+1].activate(a,null==t?void 0:t.texture):(t?(o.bindFramebuffer(t,i,void 0,void 0,n),c._outputTexture=t):(o.restoreDefaultFramebuffer(),c._outputTexture=null),null===(r=o._debugInsertMarker)||void 0===r||r.call(o,"post process ".concat(s[l].name," output"))),e)break;const u=c.apply();u&&(c.onBeforeRenderObservable.notifyObservers(u),this._prepareBuffers(),o.bindBuffers(this._vertexBuffers,this._indexBuffer,u),o.drawElementsType(0,0,6),c.onAfterRenderObservable.notifyObservers(u))}o.setDepthBuffer(!0),o.setDepthWrite(!0),o.setAlphaMode(0)}dispose(){const e=this._vertexBuffers[g.o.PositionKind];e&&(e.dispose(),this._vertexBuffers[g.o.PositionKind]=null),this._indexBuffer&&(this._scene.getEngine()._releaseBuffer(this._indexBuffer),this._indexBuffer=null)}}class _{set opaqueSortCompareFn(e){this._opaqueSortCompareFn=e||_.PainterSortCompare,this._renderOpaque=this._renderOpaqueSorted}set alphaTestSortCompareFn(e){this._alphaTestSortCompareFn=e||_.PainterSortCompare,this._renderAlphaTest=this._renderAlphaTestSorted}set transparentSortCompareFn(e){this._transparentSortCompareFn=e||_.defaultTransparentSortCompare,this._renderTransparent=this._renderTransparentSorted}constructor(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;this.index=e,this._opaqueSubMeshes=new a.t(256),this._transparentSubMeshes=new a.t(256),this._alphaTestSubMeshes=new a.t(256),this._depthOnlySubMeshes=new a.t(256),this._particleSystems=new a.t(256),this._spriteManagers=new a.t(256),this._empty=!0,this._edgesRenderers=new a.f(16),this._scene=t,this.opaqueSortCompareFn=i,this.alphaTestSortCompareFn=s,this.transparentSortCompareFn=n}render(e,t,i,s){if(e)return void e(this._opaqueSubMeshes,this._alphaTestSubMeshes,this._transparentSubMeshes,this._depthOnlySubMeshes);const n=this._scene.getEngine();0!==this._depthOnlySubMeshes.length&&(n.setColorWrite(!1),this._renderAlphaTest(this._depthOnlySubMeshes),n.setColorWrite(!0)),0!==this._opaqueSubMeshes.length&&this._renderOpaque(this._opaqueSubMeshes),0!==this._alphaTestSubMeshes.length&&this._renderAlphaTest(this._alphaTestSubMeshes);const r=n.getStencilBuffer();if(n.setStencilBuffer(!1),t&&this._renderSprites(),i&&this._renderParticles(s),this.onBeforeTransparentRendering&&this.onBeforeTransparentRendering(),0!==this._transparentSubMeshes.length||this._scene.useOrderIndependentTransparency){if(n.setStencilBuffer(r),this._scene.useOrderIndependentTransparency){const e=this._scene.depthPeelingRenderer.render(this._transparentSubMeshes);e.length&&this._renderTransparent(e)}else this._renderTransparent(this._transparentSubMeshes);n.setAlphaMode(0)}if(n.setStencilBuffer(!1),this._edgesRenderers.length){for(let e=0;e<this._edgesRenderers.length;e++)this._edgesRenderers.data[e].render();n.setAlphaMode(0)}n.setStencilBuffer(r)}_renderOpaqueSorted(e){return _._RenderSorted(e,this._opaqueSortCompareFn,this._scene.activeCamera,!1)}_renderAlphaTestSorted(e){return _._RenderSorted(e,this._alphaTestSortCompareFn,this._scene.activeCamera,!1)}_renderTransparentSorted(e){return _._RenderSorted(e,this._transparentSortCompareFn,this._scene.activeCamera,!0)}static _RenderSorted(e,t,i,s){let n,r=0;const a=i?i.globalPosition:_._ZeroVector;if(s)for(;r<e.length;r++)n=e.data[r],n._alphaIndex=n.getMesh().alphaIndex,n._distanceToCamera=h.P.Distance(n.getBoundingInfo().boundingSphere.centerWorld,a);const o=e.length===e.data.length?e.data:e.data.slice(0,e.length);t&&o.sort(t);const l=o[0].getMesh().getScene();for(r=0;r<o.length;r++)if(n=o[r],!l._activeMeshesFrozenButKeepClipping||n.isInFrustum(l._frustumPlanes)){if(s){const e=n.getMaterial();if(e&&e.needDepthPrePass){const t=e.getScene().getEngine();t.setColorWrite(!1),t.setAlphaMode(0),n.render(!1),t.setColorWrite(!0)}}n.render(s)}}static defaultTransparentSortCompare(e,t){return e._alphaIndex>t._alphaIndex?1:e._alphaIndex<t._alphaIndex?-1:_.backToFrontSortCompare(e,t)}static backToFrontSortCompare(e,t){return e._distanceToCamera<t._distanceToCamera?1:e._distanceToCamera>t._distanceToCamera?-1:0}static frontToBackSortCompare(e,t){return e._distanceToCamera<t._distanceToCamera?-1:e._distanceToCamera>t._distanceToCamera?1:0}static PainterSortCompare(e,t){const i=e.getMesh(),s=t.getMesh();return i.material&&s.material?i.material.uniqueId-s.material.uniqueId:i.uniqueId-s.uniqueId}prepare(){this._opaqueSubMeshes.reset(),this._transparentSubMeshes.reset(),this._alphaTestSubMeshes.reset(),this._depthOnlySubMeshes.reset(),this._particleSystems.reset(),this.prepareSprites(),this._edgesRenderers.reset(),this._empty=!0}prepareSprites(){this._spriteManagers.reset()}dispose(){this._opaqueSubMeshes.dispose(),this._transparentSubMeshes.dispose(),this._alphaTestSubMeshes.dispose(),this._depthOnlySubMeshes.dispose(),this._particleSystems.dispose(),this._spriteManagers.dispose(),this._edgesRenderers.dispose()}dispatch(e,t,i){void 0===t&&(t=e.getMesh()),void 0===i&&(i=e.getMaterial()),null!=i&&(i.needAlphaBlendingForMesh(t)?this._transparentSubMeshes.push(e):i.needAlphaTesting()?(i.needDepthPrePass&&this._depthOnlySubMeshes.push(e),this._alphaTestSubMeshes.push(e)):(i.needDepthPrePass&&this._depthOnlySubMeshes.push(e),this._opaqueSubMeshes.push(e)),t._renderingGroup=this,t._edgesRenderer&&t._edgesRenderer.isEnabled&&this._edgesRenderers.pushNoDuplicate(t._edgesRenderer),this._empty=!1)}dispatchSprites(e){this._spriteManagers.push(e),this._empty=!1}dispatchParticles(e){this._particleSystems.push(e),this._empty=!1}_renderParticles(e){if(0===this._particleSystems.length)return;const t=this._scene.activeCamera;this._scene.onBeforeParticlesRenderingObservable.notifyObservers(this._scene);for(let i=0;i<this._particleSystems.length;i++){const s=this._particleSystems.data[i];if(0===(t&&t.layerMask&s.layerMask))continue;const n=s.emitter;n.position&&e&&-1===e.indexOf(n)||this._scene._activeParticles.addCount(s.render(),!1)}this._scene.onAfterParticlesRenderingObservable.notifyObservers(this._scene)}_renderSprites(){if(!this._scene.spritesEnabled||0===this._spriteManagers.length)return;const e=this._scene.activeCamera;this._scene.onBeforeSpritesRenderingObservable.notifyObservers(this._scene);for(let t=0;t<this._spriteManagers.length;t++){const i=this._spriteManagers.data[t];0!==(e&&e.layerMask&i.layerMask)&&i.render()}this._scene.onAfterSpritesRenderingObservable.notifyObservers(this._scene)}}_._ZeroVector=h.P.Zero();class v{}class b{get maintainStateBetweenFrames(){return this._maintainStateBetweenFrames}set maintainStateBetweenFrames(e){if(e!==this._maintainStateBetweenFrames&&(this._maintainStateBetweenFrames=e,!this._maintainStateBetweenFrames)){for(const e of this._scene.meshes)if(e.subMeshes)for(const t of e.subMeshes)t._wasDispatched=!1;if(this._scene.spriteManagers)for(const e of this._scene.spriteManagers)e._wasDispatched=!1;for(const e of this._scene.particleSystems)e._wasDispatched=!1}}constructor(e){this._useSceneAutoClearSetup=!1,this._renderingGroups=new Array,this._autoClearDepthStencil={},this._customOpaqueSortCompareFn={},this._customAlphaTestSortCompareFn={},this._customTransparentSortCompareFn={},this._renderingGroupInfo=new v,this._maintainStateBetweenFrames=!1,this._scene=e;for(let t=b.MIN_RENDERINGGROUPS;t<b.MAX_RENDERINGGROUPS;t++)this._autoClearDepthStencil[t]={autoClear:!0,depth:!0,stencil:!0}}getRenderingGroup(e){const t=e||0;return this._prepareRenderingGroup(t),this._renderingGroups[t]}_clearDepthStencilBuffer(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this._depthStencilBufferAlreadyCleaned||(this._scene.getEngine().clear(null,!1,e,t),this._depthStencilBufferAlreadyCleaned=!0)}render(e,t,i,s){const n=this._renderingGroupInfo;if(n.scene=this._scene,n.camera=this._scene.activeCamera,this._scene.spriteManagers&&s)for(let r=0;r<this._scene.spriteManagers.length;r++){const e=this._scene.spriteManagers[r];this.dispatchSprites(e)}for(let r=b.MIN_RENDERINGGROUPS;r<b.MAX_RENDERINGGROUPS;r++){this._depthStencilBufferAlreadyCleaned=r===b.MIN_RENDERINGGROUPS;const a=this._renderingGroups[r];if(!a||a._empty)continue;const o=Math.pow(2,r);if(n.renderingGroupId=r,this._scene.onBeforeRenderingGroupObservable.notifyObservers(n,o),b.AUTOCLEAR){const e=this._useSceneAutoClearSetup?this._scene.getAutoClearDepthStencilSetup(r):this._autoClearDepthStencil[r];e&&e.autoClear&&this._clearDepthStencilBuffer(e.depth,e.stencil)}for(const e of this._scene._beforeRenderingGroupDrawStage)e.action(r);a.render(e,s,i,t);for(const e of this._scene._afterRenderingGroupDrawStage)e.action(r);this._scene.onAfterRenderingGroupObservable.notifyObservers(n,o)}}reset(){if(!this.maintainStateBetweenFrames)for(let e=b.MIN_RENDERINGGROUPS;e<b.MAX_RENDERINGGROUPS;e++){const t=this._renderingGroups[e];t&&t.prepare()}}resetSprites(){if(!this.maintainStateBetweenFrames)for(let e=b.MIN_RENDERINGGROUPS;e<b.MAX_RENDERINGGROUPS;e++){const t=this._renderingGroups[e];t&&t.prepareSprites()}}dispose(){this.freeRenderingGroups(),this._renderingGroups.length=0,this._renderingGroupInfo=null}freeRenderingGroups(){for(let e=b.MIN_RENDERINGGROUPS;e<b.MAX_RENDERINGGROUPS;e++){const t=this._renderingGroups[e];t&&t.dispose()}}_prepareRenderingGroup(e){void 0===this._renderingGroups[e]&&(this._renderingGroups[e]=new _(e,this._scene,this._customOpaqueSortCompareFn[e],this._customAlphaTestSortCompareFn[e],this._customTransparentSortCompareFn[e]))}dispatchSprites(e){this.maintainStateBetweenFrames&&e._wasDispatched||(e._wasDispatched=!0,this.getRenderingGroup(e.renderingGroupId).dispatchSprites(e))}dispatchParticles(e){this.maintainStateBetweenFrames&&e._wasDispatched||(e._wasDispatched=!0,this.getRenderingGroup(e.renderingGroupId).dispatchParticles(e))}dispatch(e,t,i){void 0===t&&(t=e.getMesh()),this.maintainStateBetweenFrames&&e._wasDispatched||(e._wasDispatched=!0,this.getRenderingGroup(t.renderingGroupId).dispatch(e,t,i))}setRenderingOrder(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(this._customOpaqueSortCompareFn[e]=t,this._customAlphaTestSortCompareFn[e]=i,this._customTransparentSortCompareFn[e]=s,this._renderingGroups[e]){const t=this._renderingGroups[e];t.opaqueSortCompareFn=this._customOpaqueSortCompareFn[e],t.alphaTestSortCompareFn=this._customAlphaTestSortCompareFn[e],t.transparentSortCompareFn=this._customTransparentSortCompareFn[e]}}setRenderingAutoClearDepthStencil(e,t){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],s=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];this._autoClearDepthStencil[e]={autoClear:t,depth:i,stencil:s}}getAutoClearDepthStencilSetup(e){return this._autoClearDepthStencil[e]}}b.MAX_RENDERINGGROUPS=4,b.MIN_RENDERINGGROUPS=0,b.AUTOCLEAR=!0;var E=i(3767),y=i(5092),M=i(4198),T=i(5230),A=i(3365);class S{constructor(){this.hoverCursor="",this.actions=new Array,this.isRecursive=!1}static get HasTriggers(){for(const e in S.Triggers)if(Object.prototype.hasOwnProperty.call(S.Triggers,e))return!0;return!1}static get HasPickTriggers(){for(const e in S.Triggers)if(Object.prototype.hasOwnProperty.call(S.Triggers,e)){const t=parseInt(e);if(t>=1&&t<=7)return!0}return!1}static HasSpecificTrigger(e){for(const t in S.Triggers)if(Object.prototype.hasOwnProperty.call(S.Triggers,t)){if(parseInt(t)===e)return!0}return!1}}S.Triggers={};var I,C,D,P,x,R,O,N=i(3531);!function(e){e[e.Generic=0]="Generic",e[e.Keyboard=1]="Keyboard",e[e.Mouse=2]="Mouse",e[e.Touch=3]="Touch",e[e.DualShock=4]="DualShock",e[e.Xbox=5]="Xbox",e[e.Switch=6]="Switch",e[e.DualSense=7]="DualSense"}(I||(I={})),function(e){e[e.Horizontal=0]="Horizontal",e[e.Vertical=1]="Vertical",e[e.LeftClick=2]="LeftClick",e[e.MiddleClick=3]="MiddleClick",e[e.RightClick=4]="RightClick",e[e.BrowserBack=5]="BrowserBack",e[e.BrowserForward=6]="BrowserForward",e[e.MouseWheelX=7]="MouseWheelX",e[e.MouseWheelY=8]="MouseWheelY",e[e.MouseWheelZ=9]="MouseWheelZ",e[e.Move=12]="Move"}(C||(C={})),function(e){e[e.Horizontal=0]="Horizontal",e[e.Vertical=1]="Vertical",e[e.LeftClick=2]="LeftClick",e[e.MiddleClick=3]="MiddleClick",e[e.RightClick=4]="RightClick",e[e.BrowserBack=5]="BrowserBack",e[e.BrowserForward=6]="BrowserForward",e[e.MouseWheelX=7]="MouseWheelX",e[e.MouseWheelY=8]="MouseWheelY",e[e.MouseWheelZ=9]="MouseWheelZ",e[e.DeltaHorizontal=10]="DeltaHorizontal",e[e.DeltaVertical=11]="DeltaVertical"}(D||(D={})),function(e){e[e.Cross=0]="Cross",e[e.Circle=1]="Circle",e[e.Square=2]="Square",e[e.Triangle=3]="Triangle",e[e.L1=4]="L1",e[e.R1=5]="R1",e[e.L2=6]="L2",e[e.R2=7]="R2",e[e.Share=8]="Share",e[e.Options=9]="Options",e[e.L3=10]="L3",e[e.R3=11]="R3",e[e.DPadUp=12]="DPadUp",e[e.DPadDown=13]="DPadDown",e[e.DPadLeft=14]="DPadLeft",e[e.DPadRight=15]="DPadRight",e[e.Home=16]="Home",e[e.TouchPad=17]="TouchPad",e[e.LStickXAxis=18]="LStickXAxis",e[e.LStickYAxis=19]="LStickYAxis",e[e.RStickXAxis=20]="RStickXAxis",e[e.RStickYAxis=21]="RStickYAxis"}(P||(P={})),function(e){e[e.Cross=0]="Cross",e[e.Circle=1]="Circle",e[e.Square=2]="Square",e[e.Triangle=3]="Triangle",e[e.L1=4]="L1",e[e.R1=5]="R1",e[e.L2=6]="L2",e[e.R2=7]="R2",e[e.Create=8]="Create",e[e.Options=9]="Options",e[e.L3=10]="L3",e[e.R3=11]="R3",e[e.DPadUp=12]="DPadUp",e[e.DPadDown=13]="DPadDown",e[e.DPadLeft=14]="DPadLeft",e[e.DPadRight=15]="DPadRight",e[e.Home=16]="Home",e[e.TouchPad=17]="TouchPad",e[e.LStickXAxis=18]="LStickXAxis",e[e.LStickYAxis=19]="LStickYAxis",e[e.RStickXAxis=20]="RStickXAxis",e[e.RStickYAxis=21]="RStickYAxis"}(x||(x={})),function(e){e[e.A=0]="A",e[e.B=1]="B",e[e.X=2]="X",e[e.Y=3]="Y",e[e.LB=4]="LB",e[e.RB=5]="RB",e[e.LT=6]="LT",e[e.RT=7]="RT",e[e.Back=8]="Back",e[e.Start=9]="Start",e[e.LS=10]="LS",e[e.RS=11]="RS",e[e.DPadUp=12]="DPadUp",e[e.DPadDown=13]="DPadDown",e[e.DPadLeft=14]="DPadLeft",e[e.DPadRight=15]="DPadRight",e[e.Home=16]="Home",e[e.LStickXAxis=17]="LStickXAxis",e[e.LStickYAxis=18]="LStickYAxis",e[e.RStickXAxis=19]="RStickXAxis",e[e.RStickYAxis=20]="RStickYAxis"}(R||(R={})),function(e){e[e.B=0]="B",e[e.A=1]="A",e[e.Y=2]="Y",e[e.X=3]="X",e[e.L=4]="L",e[e.R=5]="R",e[e.ZL=6]="ZL",e[e.ZR=7]="ZR",e[e.Minus=8]="Minus",e[e.Plus=9]="Plus",e[e.LS=10]="LS",e[e.RS=11]="RS",e[e.DPadUp=12]="DPadUp",e[e.DPadDown=13]="DPadDown",e[e.DPadLeft=14]="DPadLeft",e[e.DPadRight=15]="DPadRight",e[e.Home=16]="Home",e[e.Capture=17]="Capture",e[e.LStickXAxis=18]="LStickXAxis",e[e.LStickYAxis=19]="LStickYAxis",e[e.RStickXAxis=20]="RStickXAxis",e[e.RStickYAxis=21]="RStickYAxis"}(O||(O={}));var w=i(1187);class L{static CreateDeviceEvent(e,t,i,s,n,r,a){switch(e){case I.Keyboard:return this._CreateKeyboardEvent(i,s,n,r);case I.Mouse:if(i===C.MouseWheelX||i===C.MouseWheelY||i===C.MouseWheelZ)return this._CreateWheelEvent(e,t,i,s,n,r);case I.Touch:return this._CreatePointerEvent(e,t,i,s,n,r,a);default:throw"Unable to generate event for device ".concat(I[e])}}static _CreatePointerEvent(e,t,i,s,n,r,a){const o=this._CreateMouseEvent(e,t,i,s,n,r);return e===I.Mouse?(o.deviceType=I.Mouse,o.pointerId=1,o.pointerType="mouse"):(o.deviceType=I.Touch,o.pointerId=null!=a?a:t,o.pointerType="touch"),i===C.Move?o.type="pointermove":i>=C.LeftClick&&i<=C.RightClick&&(o.type=1===s?"pointerdown":"pointerup",o.button=i-2),o}static _CreateWheelEvent(e,t,i,s,n,r){const a=this._CreateMouseEvent(e,t,i,s,n,r);switch(a.pointerId=1,a.type="wheel",a.deltaMode=w.G.DOM_DELTA_PIXEL,a.deltaX=0,a.deltaY=0,a.deltaZ=0,i){case C.MouseWheelX:a.deltaX=s;break;case C.MouseWheelY:a.deltaY=s;break;case C.MouseWheelZ:a.deltaZ=s}return a}static _CreateMouseEvent(e,t,i,s,n,r){const a=this._CreateEvent(r),o=n.pollInput(e,t,C.Horizontal),l=n.pollInput(e,t,C.Vertical);return r?(a.movementX=0,a.movementY=0,a.offsetX=a.movementX-r.getBoundingClientRect().x,a.offsetY=a.movementY-r.getBoundingClientRect().y):(a.movementX=n.pollInput(e,t,D.DeltaHorizontal),a.movementY=n.pollInput(e,t,D.DeltaVertical),a.offsetX=0,a.offsetY=0),this._CheckNonCharacterKeys(a,n),a.clientX=o,a.clientY=l,a.x=o,a.y=l,a.deviceType=e,a.deviceSlot=t,a.inputIndex=i,a}static _CreateKeyboardEvent(e,t,i,s){const n=this._CreateEvent(s);return this._CheckNonCharacterKeys(n,i),n.deviceType=I.Keyboard,n.deviceSlot=0,n.inputIndex=e,n.type=1===t?"keydown":"keyup",n.key=String.fromCharCode(e),n.keyCode=e,n}static _CheckNonCharacterKeys(e,t){const i=t.isDeviceAvailable(I.Keyboard),s=i&&1===t.pollInput(I.Keyboard,0,18),n=i&&1===t.pollInput(I.Keyboard,0,17),r=i&&(1===t.pollInput(I.Keyboard,0,91)||1===t.pollInput(I.Keyboard,0,92)||1===t.pollInput(I.Keyboard,0,93)),a=i&&1===t.pollInput(I.Keyboard,0,16);e.altKey=s,e.ctrlKey=n,e.metaKey=r,e.shiftKey=a}static _CreateEvent(e){const t={preventDefault:()=>{}};return t.target=e,t}}class F{constructor(e,t,i){this._nativeInput=_native.DeviceInputSystem?new _native.DeviceInputSystem(e,t,((e,t,s,n)=>{const r=L.CreateDeviceEvent(e,t,s,n,this);i(e,t,r)})):this._createDummyNativeInput()}pollInput(e,t,i){return this._nativeInput.pollInput(e,t,i)}isDeviceAvailable(e){return e===I.Mouse||e===I.Touch}dispose(){this._nativeInput.dispose()}_createDummyNativeInput(){return{pollInput:()=>0,isDeviceAvailable:()=>!1,dispose:()=>{}}}}const B=Object.keys(C).length/2;class U{constructor(e,t,i,n){this._inputs=[],this._keyboardActive=!1,this._pointerActive=!1,this._usingSafari=s.w1.IsSafari(),this._usingMacOS=(0,y.up)()&&/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform),this._keyboardDownEvent=e=>{},this._keyboardUpEvent=e=>{},this._keyboardBlurEvent=e=>{},this._pointerMoveEvent=e=>{},this._pointerDownEvent=e=>{},this._pointerUpEvent=e=>{},this._pointerCancelEvent=e=>{},this._pointerWheelEvent=e=>{},this._pointerBlurEvent=e=>{},this._eventsAttached=!1,this._mouseId=-1,this._isUsingFirefox=y.MZ.IsNavigatorAvailable()&&navigator.userAgent&&-1!==navigator.userAgent.indexOf("Firefox"),this._maxTouchPoints=0,this._pointerInputClearObserver=null,this._gamepadConnectedEvent=e=>{},this._gamepadDisconnectedEvent=e=>{},this._eventPrefix=s.w1.GetPointerPrefix(e),this._engine=e,this._onDeviceConnected=t,this._onDeviceDisconnected=i,this._onInputChanged=n,this._mouseId=this._isUsingFirefox?0:1,this._enableEvents(),this._usingMacOS&&(this._metaKeys=[]),this._engine._onEngineViewChanged||(this._engine._onEngineViewChanged=()=>{this._enableEvents()})}pollInput(e,t,i){const n=this._inputs[e][t];if(!n)throw"Unable to find device ".concat(I[e]);e>=I.DualShock&&e<=I.DualSense&&this._updateDevice(e,t,i);const r=n[i];if(void 0===r)throw"Unable to find input ".concat(i," for device ").concat(I[e]," in slot ").concat(t);return i===C.Move&&s.w1.Warn("Unable to provide information for PointerInput.Move.  Try using PointerInput.Horizontal or PointerInput.Vertical for move data."),r}isDeviceAvailable(e){return void 0!==this._inputs[e]}dispose(){this._onDeviceConnected=()=>{},this._onDeviceDisconnected=()=>{},this._onInputChanged=()=>{},delete this._engine._onEngineViewChanged,this._elementToAttachTo&&this._disableEvents()}_enableEvents(){const e=null==this?void 0:this._engine.getInputElement();if(e&&(!this._eventsAttached||this._elementToAttachTo!==e)){if(this._disableEvents(),this._inputs)for(const e of this._inputs)if(e)for(const t in e){const i=e[+t];if(i)for(let e=0;e<i.length;e++)i[e]=0}this._elementToAttachTo=e,this._elementToAttachTo.tabIndex=-1!==this._elementToAttachTo.tabIndex?this._elementToAttachTo.tabIndex:this._engine.canvasTabIndex,this._handleKeyActions(),this._handlePointerActions(),this._handleGamepadActions(),this._eventsAttached=!0,this._checkForConnectedDevices()}}_disableEvents(){this._elementToAttachTo&&(this._elementToAttachTo.removeEventListener("blur",this._keyboardBlurEvent),this._elementToAttachTo.removeEventListener("blur",this._pointerBlurEvent),this._elementToAttachTo.removeEventListener("keydown",this._keyboardDownEvent),this._elementToAttachTo.removeEventListener("keyup",this._keyboardUpEvent),this._elementToAttachTo.removeEventListener(this._eventPrefix+"move",this._pointerMoveEvent),this._elementToAttachTo.removeEventListener(this._eventPrefix+"down",this._pointerDownEvent),this._elementToAttachTo.removeEventListener(this._eventPrefix+"up",this._pointerUpEvent),this._elementToAttachTo.removeEventListener(this._eventPrefix+"cancel",this._pointerCancelEvent),this._elementToAttachTo.removeEventListener(this._wheelEventName,this._pointerWheelEvent),window.removeEventListener("gamepadconnected",this._gamepadConnectedEvent),window.removeEventListener("gamepaddisconnected",this._gamepadDisconnectedEvent)),this._pointerInputClearObserver&&this._engine.onEndFrameObservable.remove(this._pointerInputClearObserver),this._eventsAttached=!1}_checkForConnectedDevices(){if(navigator.getGamepads){const e=navigator.getGamepads();for(const t of e)t&&this._addGamePad(t)}"function"==typeof matchMedia&&matchMedia("(pointer:fine)").matches&&this._addPointerDevice(I.Mouse,0,0,0)}_addGamePad(e){const t=this._getGamepadDeviceType(e.id),i=e.index;this._gamepads=this._gamepads||new Array(e.index+1),this._registerDevice(t,i,e.buttons.length+e.axes.length),this._gamepads[i]=t}_addPointerDevice(e,t,i,s){this._pointerActive||(this._pointerActive=!0),this._registerDevice(e,t,B);const n=this._inputs[e][t];n[0]=i,n[1]=s}_registerDevice(e,t,i){if(void 0===t)throw"Unable to register device ".concat(I[e]," to undefined slot.");if(this._inputs[e]||(this._inputs[e]={}),!this._inputs[e][t]){const s=new Array(i);s.fill(0),this._inputs[e][t]=s,this._onDeviceConnected(e,t)}}_unregisterDevice(e,t){this._inputs[e][t]&&(delete this._inputs[e][t],this._onDeviceDisconnected(e,t))}_handleKeyActions(){this._keyboardDownEvent=e=>{this._keyboardActive||(this._keyboardActive=!0,this._registerDevice(I.Keyboard,0,255));const t=this._inputs[I.Keyboard][0];if(t){t[e.keyCode]=1;const i=e;i.inputIndex=e.keyCode,this._usingMacOS&&e.metaKey&&"Meta"!==e.key&&(this._metaKeys.includes(e.keyCode)||this._metaKeys.push(e.keyCode)),this._onInputChanged(I.Keyboard,0,i)}},this._keyboardUpEvent=e=>{this._keyboardActive||(this._keyboardActive=!0,this._registerDevice(I.Keyboard,0,255));const t=this._inputs[I.Keyboard][0];if(t){t[e.keyCode]=0;const i=e;if(i.inputIndex=e.keyCode,this._usingMacOS&&"Meta"===e.key&&this._metaKeys.length>0){for(const e of this._metaKeys){const i=L.CreateDeviceEvent(I.Keyboard,0,e,0,this,this._elementToAttachTo);t[e]=0,this._onInputChanged(I.Keyboard,0,i)}this._metaKeys.splice(0,this._metaKeys.length)}this._onInputChanged(I.Keyboard,0,i)}},this._keyboardBlurEvent=()=>{if(this._keyboardActive){const e=this._inputs[I.Keyboard][0];for(let t=0;t<e.length;t++)if(0!==e[t]){e[t]=0;const i=L.CreateDeviceEvent(I.Keyboard,0,t,0,this,this._elementToAttachTo);this._onInputChanged(I.Keyboard,0,i)}this._usingMacOS&&this._metaKeys.splice(0,this._metaKeys.length)}},this._elementToAttachTo.addEventListener("keydown",this._keyboardDownEvent),this._elementToAttachTo.addEventListener("keyup",this._keyboardUpEvent),this._elementToAttachTo.addEventListener("blur",this._keyboardBlurEvent)}_handlePointerActions(){this._maxTouchPoints=y.MZ.IsNavigatorAvailable()&&navigator.maxTouchPoints||2,this._activeTouchIds||(this._activeTouchIds=new Array(this._maxTouchPoints));for(let s=0;s<this._maxTouchPoints;s++)this._activeTouchIds[s]=-1;this._pointerMoveEvent=e=>{const t=this._getPointerType(e),i=t===I.Mouse?0:this._activeTouchIds.indexOf(e.pointerId);this._inputs[t]||(this._inputs[t]={}),this._inputs[t][i]||this._addPointerDevice(t,i,e.clientX,e.clientY);const s=this._inputs[t][i];if(s){const n=e;n.inputIndex=C.Move,s[C.Horizontal]=e.clientX,s[C.Vertical]=e.clientY,void 0===e.pointerId&&(e.pointerId=this._mouseId),this._onInputChanged(t,i,n),this._usingSafari||-1===e.button||(n.inputIndex=e.button+2,s[e.button+2]=s[e.button+2]?0:1,this._onInputChanged(t,i,n))}},this._pointerDownEvent=e=>{const t=this._getPointerType(e);let i=t===I.Mouse?0:e.pointerId;if(t===I.Touch){const t=this._activeTouchIds.indexOf(-1);if(!(t>=0))return void s.w1.Warn("Max number of touches exceeded.  Ignoring touches in excess of ".concat(this._maxTouchPoints));i=t,this._activeTouchIds[t]=e.pointerId}this._inputs[t]||(this._inputs[t]={}),this._inputs[t][i]?t===I.Touch&&this._onDeviceConnected(t,i):this._addPointerDevice(t,i,e.clientX,e.clientY);const n=this._inputs[t][i];if(n){const s=n[C.Horizontal],a=n[C.Vertical];if(t===I.Mouse){if(void 0===e.pointerId&&(e.pointerId=this._mouseId),!document.pointerLockElement)try{this._elementToAttachTo.setPointerCapture(this._mouseId)}catch(r){}}else if(e.pointerId&&!document.pointerLockElement)try{this._elementToAttachTo.setPointerCapture(e.pointerId)}catch(r){}n[C.Horizontal]=e.clientX,n[C.Vertical]=e.clientY,n[e.button+2]=1;const o=e;o.inputIndex=e.button+2,this._onInputChanged(t,i,o),s===e.clientX&&a===e.clientY||(o.inputIndex=C.Move,this._onInputChanged(t,i,o))}},this._pointerUpEvent=e=>{var t,i,s,n,r;const a=this._getPointerType(e),o=a===I.Mouse?0:this._activeTouchIds.indexOf(e.pointerId);if(a===I.Touch){if(-1===o)return;this._activeTouchIds[o]=-1}const l=null===(t=this._inputs[a])||void 0===t?void 0:t[o];if(l&&0!==l[e.button+2]){const t=l[C.Horizontal],h=l[C.Vertical];l[C.Horizontal]=e.clientX,l[C.Vertical]=e.clientY,l[e.button+2]=0;const c=e;void 0===e.pointerId&&(e.pointerId=this._mouseId),t===e.clientX&&h===e.clientY||(c.inputIndex=C.Move,this._onInputChanged(a,o,c)),c.inputIndex=e.button+2,a===I.Mouse&&this._mouseId>=0&&(null===(s=(i=this._elementToAttachTo).hasPointerCapture)||void 0===s?void 0:s.call(i,this._mouseId))?this._elementToAttachTo.releasePointerCapture(this._mouseId):e.pointerId&&(null===(r=(n=this._elementToAttachTo).hasPointerCapture)||void 0===r?void 0:r.call(n,e.pointerId))&&this._elementToAttachTo.releasePointerCapture(e.pointerId),this._onInputChanged(a,o,c),a===I.Touch&&this._onDeviceDisconnected(a,o)}},this._pointerCancelEvent=e=>{var t,i,s,n;if("mouse"===e.pointerType){const e=this._inputs[I.Mouse][0];this._mouseId>=0&&(null===(i=(t=this._elementToAttachTo).hasPointerCapture)||void 0===i?void 0:i.call(t,this._mouseId))&&this._elementToAttachTo.releasePointerCapture(this._mouseId);for(let t=C.LeftClick;t<=C.BrowserForward;t++)if(1===e[t]){e[t]=0;const i=L.CreateDeviceEvent(I.Mouse,0,t,0,this,this._elementToAttachTo);this._onInputChanged(I.Mouse,0,i)}}else{const t=this._activeTouchIds.indexOf(e.pointerId);(null===(n=(s=this._elementToAttachTo).hasPointerCapture)||void 0===n?void 0:n.call(s,e.pointerId))&&this._elementToAttachTo.releasePointerCapture(e.pointerId),this._inputs[I.Touch][t][C.LeftClick]=0;const i=L.CreateDeviceEvent(I.Touch,t,C.LeftClick,0,this,this._elementToAttachTo,e.pointerId);this._onInputChanged(I.Touch,t,i),this._activeTouchIds[t]=-1,this._onDeviceDisconnected(I.Touch,t)}},this._wheelEventName="onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll";let e=!1;const t=function(){};try{const i=Object.defineProperty({},"passive",{get:function(){e=!0}});this._elementToAttachTo.addEventListener("test",t,i),this._elementToAttachTo.removeEventListener("test",t,i)}catch(i){}this._pointerBlurEvent=()=>{var e,t,i,s,n;if(this.isDeviceAvailable(I.Mouse)){const i=this._inputs[I.Mouse][0];this._mouseId>=0&&(null===(t=(e=this._elementToAttachTo).hasPointerCapture)||void 0===t?void 0:t.call(e,this._mouseId))&&this._elementToAttachTo.releasePointerCapture(this._mouseId);for(let e=C.LeftClick;e<=C.BrowserForward;e++)if(1===i[e]){i[e]=0;const t=L.CreateDeviceEvent(I.Mouse,0,e,0,this,this._elementToAttachTo);this._onInputChanged(I.Mouse,0,t)}}if(this.isDeviceAvailable(I.Touch)){const e=this._inputs[I.Touch];for(let t=0;t<this._activeTouchIds.length;t++){const r=this._activeTouchIds[t];if((null===(s=(i=this._elementToAttachTo).hasPointerCapture)||void 0===s?void 0:s.call(i,r))&&this._elementToAttachTo.releasePointerCapture(r),-1!==r&&1===(null===(n=e[t])||void 0===n?void 0:n[C.LeftClick])){e[t][C.LeftClick]=0;const i=L.CreateDeviceEvent(I.Touch,t,C.LeftClick,0,this,this._elementToAttachTo,r);this._onInputChanged(I.Touch,t,i),this._activeTouchIds[t]=-1,this._onDeviceDisconnected(I.Touch,t)}}}},this._pointerWheelEvent=e=>{const t=I.Mouse;this._inputs[t]||(this._inputs[t]=[]),this._inputs[t][0]||(this._pointerActive=!0,this._registerDevice(t,0,B));const i=this._inputs[t][0];if(i){i[C.MouseWheelX]=e.deltaX||0,i[C.MouseWheelY]=e.deltaY||e.wheelDelta||0,i[C.MouseWheelZ]=e.deltaZ||0;const s=e;void 0===e.pointerId&&(e.pointerId=this._mouseId),0!==i[C.MouseWheelX]&&(s.inputIndex=C.MouseWheelX,this._onInputChanged(t,0,s)),0!==i[C.MouseWheelY]&&(s.inputIndex=C.MouseWheelY,this._onInputChanged(t,0,s)),0!==i[C.MouseWheelZ]&&(s.inputIndex=C.MouseWheelZ,this._onInputChanged(t,0,s))}},this._elementToAttachTo.addEventListener(this._eventPrefix+"move",this._pointerMoveEvent),this._elementToAttachTo.addEventListener(this._eventPrefix+"down",this._pointerDownEvent),this._elementToAttachTo.addEventListener(this._eventPrefix+"up",this._pointerUpEvent),this._elementToAttachTo.addEventListener(this._eventPrefix+"cancel",this._pointerCancelEvent),this._elementToAttachTo.addEventListener("blur",this._pointerBlurEvent),this._elementToAttachTo.addEventListener(this._wheelEventName,this._pointerWheelEvent,!!e&&{passive:!1}),this._pointerInputClearObserver=this._engine.onEndFrameObservable.add((()=>{if(this.isDeviceAvailable(I.Mouse)){const e=this._inputs[I.Mouse][0];e[C.MouseWheelX]=0,e[C.MouseWheelY]=0,e[C.MouseWheelZ]=0}}))}_handleGamepadActions(){this._gamepadConnectedEvent=e=>{this._addGamePad(e.gamepad)},this._gamepadDisconnectedEvent=e=>{if(this._gamepads){const t=this._getGamepadDeviceType(e.gamepad.id),i=e.gamepad.index;this._unregisterDevice(t,i),delete this._gamepads[i]}},window.addEventListener("gamepadconnected",this._gamepadConnectedEvent),window.addEventListener("gamepaddisconnected",this._gamepadDisconnectedEvent)}_updateDevice(e,t,i){const s=navigator.getGamepads()[t];if(s&&e===this._gamepads[t]){const n=this._inputs[e][t];i>=s.buttons.length?n[i]=s.axes[i-s.buttons.length].valueOf():n[i]=s.buttons[i].value}}_getGamepadDeviceType(e){return-1!==e.indexOf("054c")?-1!==e.indexOf("0ce6")?I.DualSense:I.DualShock:-1!==e.indexOf("Xbox One")||-1!==e.search("Xbox 360")||-1!==e.search("xinput")?I.Xbox:-1!==e.indexOf("057e")?I.Switch:I.Generic}_getPointerType(e){let t=I.Mouse;return("touch"===e.pointerType||"pen"===e.pointerType||e.touches)&&(t=I.Touch),t}}class k{constructor(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.deviceType=t,this.deviceSlot=i,this.onInputChangedObservable=new r.y$,this._deviceInputSystem=e}getInput(e){return this._deviceInputSystem.pollInput(this.deviceType,this.deviceSlot,e)}}class V{constructor(e){this._registeredManagers=new Array,this._refCount=0,this.registerManager=e=>{for(let t=0;t<this._devices.length;t++){const i=this._devices[t];for(const s in i){const i=+s;e._addDevice(new k(this._deviceInputSystem,t,i))}}this._registeredManagers.push(e)},this.unregisterManager=e=>{const t=this._registeredManagers.indexOf(e);t>-1&&this._registeredManagers.splice(t,1)};const t=Object.keys(I).length/2;this._devices=new Array(t);const i=(e,t)=>{this._devices[e]||(this._devices[e]=new Array),this._devices[e][t]||(this._devices[e][t]=t);for(const i of this._registeredManagers){const s=new k(this._deviceInputSystem,e,t);i._addDevice(s)}},s=(e,t)=>{var i;(null===(i=this._devices[e])||void 0===i?void 0:i[t])&&delete this._devices[e][t];for(const s of this._registeredManagers)s._removeDevice(e,t)},n=(e,t,i)=>{if(i)for(const s of this._registeredManagers)s._onInputChanged(e,t,i)};"undefined"!=typeof _native?this._deviceInputSystem=new F(i,s,n):this._deviceInputSystem=new U(e,i,s,n)}dispose(){this._deviceInputSystem.dispose()}}class G{getDeviceSource(e,t){if(void 0===t){if(void 0===this._firstDevice[e])return null;t=this._firstDevice[e]}return this._devices[e]&&void 0!==this._devices[e][t]?this._devices[e][t]:null}getDeviceSources(e){return this._devices[e]?this._devices[e].filter((e=>!!e)):[]}constructor(e){const t=Object.keys(I).length/2;this._devices=new Array(t),this._firstDevice=new Array(t),this._engine=e,this._engine._deviceSourceManager||(this._engine._deviceSourceManager=new V(e)),this._engine._deviceSourceManager._refCount++,this.onDeviceConnectedObservable=new r.y$((e=>{for(const t of this._devices)if(t)for(const i of t)i&&this.onDeviceConnectedObservable.notifyObserver(e,i)})),this.onDeviceDisconnectedObservable=new r.y$,this._engine._deviceSourceManager.registerManager(this),this._onDisposeObserver=e.onDisposeObservable.add((()=>{this.dispose()}))}dispose(){this.onDeviceConnectedObservable.clear(),this.onDeviceDisconnectedObservable.clear(),this._engine._deviceSourceManager&&(this._engine._deviceSourceManager.unregisterManager(this),--this._engine._deviceSourceManager._refCount<1&&(this._engine._deviceSourceManager.dispose(),delete this._engine._deviceSourceManager)),this._engine.onDisposeObservable.remove(this._onDisposeObserver)}_addDevice(e){this._devices[e.deviceType]||(this._devices[e.deviceType]=new Array),this._devices[e.deviceType][e.deviceSlot]||(this._devices[e.deviceType][e.deviceSlot]=e,this._updateFirstDevices(e.deviceType)),this.onDeviceConnectedObservable.notifyObservers(e)}_removeDevice(e,t){var i,s;const n=null===(i=this._devices[e])||void 0===i?void 0:i[t];this.onDeviceDisconnectedObservable.notifyObservers(n),(null===(s=this._devices[e])||void 0===s?void 0:s[t])&&delete this._devices[e][t],this._updateFirstDevices(e)}_onInputChanged(e,t,i){var s,n;null===(n=null===(s=this._devices[e])||void 0===s?void 0:s[t])||void 0===n||n.onInputChangedObservable.notifyObservers(i)}_updateFirstDevices(e){switch(e){case I.Keyboard:case I.Mouse:this._firstDevice[e]=0;break;case I.Touch:case I.DualSense:case I.DualShock:case I.Xbox:case I.Switch:case I.Generic:{delete this._firstDevice[e];const t=this._devices[e];if(t)for(let i=0;i<t.length;i++)if(t[i]){this._firstDevice[e]=i;break}break}}}}class W{constructor(){this._singleClick=!1,this._doubleClick=!1,this._hasSwiped=!1,this._ignore=!1}get singleClick(){return this._singleClick}get doubleClick(){return this._doubleClick}get hasSwiped(){return this._hasSwiped}get ignore(){return this._ignore}set singleClick(e){this._singleClick=e}set doubleClick(e){this._doubleClick=e}set hasSwiped(e){this._hasSwiped=e}set ignore(e){this._ignore=e}}class z{constructor(e){this._alreadyAttached=!1,this._meshPickProceed=!1,this._currentPickResult=null,this._previousPickResult=null,this._totalPointersPressed=0,this._doubleClickOccured=!1,this._isSwiping=!1,this._swipeButtonPressed=-1,this._skipPointerTap=!1,this._isMultiTouchGesture=!1,this._pointerX=0,this._pointerY=0,this._startingPointerPosition=new h.FM(0,0),this._previousStartingPointerPosition=new h.FM(0,0),this._startingPointerTime=0,this._previousStartingPointerTime=0,this._pointerCaptures={},this._meshUnderPointerId={},this._movePointerInfo=null,this._cameraObserverCount=0,this._delayedClicks=[null,null,null,null,null],this._deviceSourceManager=null,this._scene=e||M.l.LastCreatedScene,this._scene}get meshUnderPointer(){return this._movePointerInfo&&(this._movePointerInfo._generatePickInfo(),this._movePointerInfo=null),this._pointerOverMesh}getMeshUnderPointerByPointerId(e){return this._meshUnderPointerId[e]||null}get unTranslatedPointer(){return new h.FM(this._unTranslatedPointerX,this._unTranslatedPointerY)}get pointerX(){return this._pointerX}set pointerX(e){this._pointerX=e}get pointerY(){return this._pointerY}set pointerY(e){this._pointerY=e}_updatePointerPosition(e){const t=this._scene.getEngine().getInputElementClientRect();t&&(this._pointerX=e.clientX-t.left,this._pointerY=e.clientY-t.top,this._unTranslatedPointerX=this._pointerX,this._unTranslatedPointerY=this._pointerY)}_processPointerMove(e,t){const i=this._scene,s=i.getEngine(),n=s.getInputElement();n&&(n.tabIndex=s.canvasTabIndex,i.doNotHandleCursors||(n.style.cursor=i.defaultCursor)),this._setCursorAndPointerOverMesh(e,t,i);for(const o of i._pointerMoveStage){const t=!!(null==e?void 0:e.pickedMesh);e=o.action(this._unTranslatedPointerX,this._unTranslatedPointerY,e,t,n)}const r=t.inputIndex>=C.MouseWheelX&&t.inputIndex<=C.MouseWheelZ?A.kD.POINTERWHEEL:A.kD.POINTERMOVE;let a;i.onPointerMove&&(e=e||this._pickMove(t),i.onPointerMove(t,e,r)),e?(a=new A.R5(r,t,e),this._setRayOnPointerInfo(e,t)):(a=new A.R5(r,t,null,this),this._movePointerInfo=a),i.onPointerObservable.hasObservers()&&i.onPointerObservable.notifyObservers(a,r)}_setRayOnPointerInfo(e,t){const i=this._scene;e&&i._pickingAvailable&&(e.ray||(e.ray=i.createPickingRay(t.offsetX,t.offsetY,h.y3.Identity(),i.activeCamera)))}_addCameraPointerObserver(e,t){return this._cameraObserverCount++,this._scene.onPointerObservable.add(e,t)}_removeCameraPointerObserver(e){return this._cameraObserverCount--,this._scene.onPointerObservable.remove(e)}_checkForPicking(){return!!(this._scene.onPointerObservable.observers.length>this._cameraObserverCount||this._scene.onPointerPick)}_checkPrePointerObservable(e,t,i){const s=this._scene,n=new A.FV(i,t,this._unTranslatedPointerX,this._unTranslatedPointerY);return e&&(n.originalPickingInfo=e,n.ray=e.ray,e.originMesh&&(n.nearInteractionPickingInfo=e)),s.onPrePointerObservable.notifyObservers(n,i),!!n.skipOnPointerObservable}_pickMove(e){const t=this._scene,i=t.pick(this._unTranslatedPointerX,this._unTranslatedPointerY,t.pointerMovePredicate,!1,t.cameraToUseForPointers,t.pointerMoveTrianglePredicate);return this._setCursorAndPointerOverMesh(i,e,t),i}_setCursorAndPointerOverMesh(e,t,i){const s=i.getEngine().getInputElement();if(null==e?void 0:e.pickedMesh){if(this.setPointerOverMesh(e.pickedMesh,t.pointerId,e,t),!i.doNotHandleCursors&&s&&this._pointerOverMesh){const e=this._pointerOverMesh._getActionManagerForTrigger();e&&e.hasPointerTriggers&&(s.style.cursor=e.hoverCursor||i.hoverCursor)}}else this.setPointerOverMesh(null,t.pointerId,e,t)}simulatePointerMove(e,t){const i=new PointerEvent("pointermove",t);i.inputIndex=C.Move,this._checkPrePointerObservable(e,i,A.kD.POINTERMOVE)||this._processPointerMove(e,i)}simulatePointerDown(e,t){const i=new PointerEvent("pointerdown",t);i.inputIndex=i.button+2,this._checkPrePointerObservable(e,i,A.kD.POINTERDOWN)||this._processPointerDown(e,i)}_processPointerDown(e,t){const i=this._scene;if(null==e?void 0:e.pickedMesh){this._pickedDownMesh=e.pickedMesh;const s=e.pickedMesh._getActionManagerForTrigger();if(s){if(s.hasPickTriggers)switch(s.processTrigger(5,p.CreateNew(e.pickedMesh,t)),t.button){case 0:s.processTrigger(2,p.CreateNew(e.pickedMesh,t));break;case 1:s.processTrigger(4,p.CreateNew(e.pickedMesh,t));break;case 2:s.processTrigger(3,p.CreateNew(e.pickedMesh,t))}s.hasSpecificTrigger(8)&&window.setTimeout((()=>{const e=i.pick(this._unTranslatedPointerX,this._unTranslatedPointerY,(e=>e.isPickable&&e.isVisible&&e.isReady()&&e.actionManager&&e.actionManager.hasSpecificTrigger(8)&&e===this._pickedDownMesh),!1,i.cameraToUseForPointers);(null==e?void 0:e.pickedMesh)&&s&&0!==this._totalPointersPressed&&Date.now()-this._startingPointerTime>z.LongPressDelay&&!this._isPointerSwiping()&&(this._startingPointerTime=0,s.processTrigger(8,p.CreateNew(e.pickedMesh,t)))}),z.LongPressDelay)}}else for(const r of i._pointerDownStage)e=r.action(this._unTranslatedPointerX,this._unTranslatedPointerY,e,t,!1);let s;const n=A.kD.POINTERDOWN;e?(i.onPointerDown&&i.onPointerDown(t,e,n),s=new A.R5(n,t,e),this._setRayOnPointerInfo(e,t)):s=new A.R5(n,t,null,this),i.onPointerObservable.hasObservers()&&i.onPointerObservable.notifyObservers(s,n)}_isPointerSwiping(){return this._isSwiping}simulatePointerUp(e,t,i){const s=new PointerEvent("pointerup",t);s.inputIndex=C.Move;const n=new W;i?n.doubleClick=!0:n.singleClick=!0,this._checkPrePointerObservable(e,s,A.kD.POINTERUP)||this._processPointerUp(e,s,n)}_processPointerUp(e,t,i){const s=this._scene;if(null==e?void 0:e.pickedMesh){if(this._pickedUpMesh=e.pickedMesh,this._pickedDownMesh===this._pickedUpMesh&&(s.onPointerPick&&s.onPointerPick(t,e),i.singleClick&&!i.ignore&&s.onPointerObservable.observers.length>this._cameraObserverCount)){const i=A.kD.POINTERPICK,n=new A.R5(i,t,e);this._setRayOnPointerInfo(e,t),s.onPointerObservable.notifyObservers(n,i)}const n=e.pickedMesh._getActionManagerForTrigger();if(n&&!i.ignore){n.processTrigger(7,p.CreateNew(e.pickedMesh,t,e)),!i.hasSwiped&&i.singleClick&&n.processTrigger(1,p.CreateNew(e.pickedMesh,t,e));const s=e.pickedMesh._getActionManagerForTrigger(6);i.doubleClick&&s&&s.processTrigger(6,p.CreateNew(e.pickedMesh,t,e))}}else if(!i.ignore)for(const n of s._pointerUpStage)e=n.action(this._unTranslatedPointerX,this._unTranslatedPointerY,e,t,i.doubleClick);if(this._pickedDownMesh&&this._pickedDownMesh!==this._pickedUpMesh){const e=this._pickedDownMesh._getActionManagerForTrigger(16);e&&e.processTrigger(16,p.CreateNew(this._pickedDownMesh,t))}if(!i.ignore){const n=new A.R5(A.kD.POINTERUP,t,e);if(this._setRayOnPointerInfo(e,t),s.onPointerObservable.notifyObservers(n,A.kD.POINTERUP),s.onPointerUp&&s.onPointerUp(t,e,A.kD.POINTERUP),!i.hasSwiped&&!this._skipPointerTap&&!this._isMultiTouchGesture){let n=0;if(i.singleClick?n=A.kD.POINTERTAP:i.doubleClick&&(n=A.kD.POINTERDOUBLETAP),n){const i=new A.R5(n,t,e);s.onPointerObservable.hasObservers()&&s.onPointerObservable.hasSpecificMask(n)&&s.onPointerObservable.notifyObservers(i,n)}}}}isPointerCaptured(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this._pointerCaptures[e]}attachControl(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const n=this._scene,r=n.getEngine();s||(s=r.getInputElement()),this._alreadyAttached&&this.detachControl(),s&&(this._alreadyAttachedTo=s),this._deviceSourceManager=new G(r),this._initActionManager=e=>{if(!this._meshPickProceed){const t=n.skipPointerUpPicking||0===n._registeredActions&&!this._checkForPicking()&&!n.onPointerUp?null:n.pick(this._unTranslatedPointerX,this._unTranslatedPointerY,n.pointerUpPredicate,!1,n.cameraToUseForPointers);this._currentPickResult=t,t&&(e=t.hit&&t.pickedMesh?t.pickedMesh._getActionManagerForTrigger():null),this._meshPickProceed=!0}return e},this._delayedSimpleClick=(e,t,i)=>{if((Date.now()-this._previousStartingPointerTime>z.DoubleClickDelay&&!this._doubleClickOccured||e!==this._previousButtonPressed)&&(this._doubleClickOccured=!1,t.singleClick=!0,t.ignore=!1,this._delayedClicks[e])){const t=this._delayedClicks[e].evt,i=A.kD.POINTERTAP,s=new A.R5(i,t,this._currentPickResult);n.onPointerObservable.hasObservers()&&n.onPointerObservable.hasSpecificMask(i)&&n.onPointerObservable.notifyObservers(s,i),this._delayedClicks[e]=null}},this._initClickEvent=(e,t,i,s)=>{var n,r;const a=new W;this._currentPickResult=null;let o=null,l=e.hasSpecificMask(A.kD.POINTERPICK)||t.hasSpecificMask(A.kD.POINTERPICK)||e.hasSpecificMask(A.kD.POINTERTAP)||t.hasSpecificMask(A.kD.POINTERTAP)||e.hasSpecificMask(A.kD.POINTERDOUBLETAP)||t.hasSpecificMask(A.kD.POINTERDOUBLETAP);!l&&S&&(o=this._initActionManager(o,a),o&&(l=o.hasPickTriggers));let h=!1;if(l){const l=i.button;if(a.hasSwiped=this._isPointerSwiping(),!a.hasSwiped){let c=!z.ExclusiveDoubleClickMode;if(c||(c=!e.hasSpecificMask(A.kD.POINTERDOUBLETAP)&&!t.hasSpecificMask(A.kD.POINTERDOUBLETAP),c&&!S.HasSpecificTrigger(6)&&(o=this._initActionManager(o,a),o&&(c=!o.hasSpecificTrigger(6)))),c)(Date.now()-this._previousStartingPointerTime>z.DoubleClickDelay||l!==this._previousButtonPressed)&&(a.singleClick=!0,s(a,this._currentPickResult),h=!0);else{const e={evt:i,clickInfo:a,timeoutId:window.setTimeout(this._delayedSimpleClick.bind(this,l,a,s),z.DoubleClickDelay)};this._delayedClicks[l]=e}let u=e.hasSpecificMask(A.kD.POINTERDOUBLETAP)||t.hasSpecificMask(A.kD.POINTERDOUBLETAP);!u&&S.HasSpecificTrigger(6)&&(o=this._initActionManager(o,a),o&&(u=o.hasSpecificTrigger(6))),u&&(l===this._previousButtonPressed&&Date.now()-this._previousStartingPointerTime<z.DoubleClickDelay&&!this._doubleClickOccured?(a.hasSwiped||this._isPointerSwiping()?(this._doubleClickOccured=!1,this._previousStartingPointerTime=this._startingPointerTime,this._previousStartingPointerPosition.x=this._startingPointerPosition.x,this._previousStartingPointerPosition.y=this._startingPointerPosition.y,this._previousButtonPressed=l,z.ExclusiveDoubleClickMode?(this._delayedClicks[l]&&(clearTimeout(null===(r=this._delayedClicks[l])||void 0===r?void 0:r.timeoutId),this._delayedClicks[l]=null),s(a,this._previousPickResult)):s(a,this._currentPickResult)):(this._previousStartingPointerTime=0,this._doubleClickOccured=!0,a.doubleClick=!0,a.ignore=!1,z.ExclusiveDoubleClickMode&&this._delayedClicks[l]&&(clearTimeout(null===(n=this._delayedClicks[l])||void 0===n?void 0:n.timeoutId),this._delayedClicks[l]=null),s(a,this._currentPickResult)),h=!0):(this._doubleClickOccured=!1,this._previousStartingPointerTime=this._startingPointerTime,this._previousStartingPointerPosition.x=this._startingPointerPosition.x,this._previousStartingPointerPosition.y=this._startingPointerPosition.y,this._previousButtonPressed=l))}}h||s(a,this._currentPickResult)},this._onPointerMove=e=>{if(this._updatePointerPosition(e),this._isSwiping||-1===this._swipeButtonPressed||(this._isSwiping=Math.abs(this._startingPointerPosition.x-this._pointerX)>z.DragMovementThreshold||Math.abs(this._startingPointerPosition.y-this._pointerY)>z.DragMovementThreshold),r.isPointerLock&&r._verifyPointerLock(),this._checkPrePointerObservable(null,e,e.inputIndex>=C.MouseWheelX&&e.inputIndex<=C.MouseWheelZ?A.kD.POINTERWHEEL:A.kD.POINTERMOVE))return;if(!n.cameraToUseForPointers&&!n.activeCamera)return;if(n.skipPointerMovePicking)return void this._processPointerMove(new f.p,e);n.pointerMovePredicate||(n.pointerMovePredicate=e=>e.isPickable&&e.isVisible&&e.isReady()&&e.isEnabled()&&(e.enablePointerMoveEvents||n.constantlyUpdateMeshUnderPointer||null!==e._getActionManagerForTrigger())&&(!n.cameraToUseForPointers||0!=(n.cameraToUseForPointers.layerMask&e.layerMask)));const t=n._registeredActions>0?this._pickMove(e):null;this._processPointerMove(t,e)},this._onPointerDown=e=>{var t;if(this._totalPointersPressed++,this._pickedDownMesh=null,this._meshPickProceed=!1,z.ExclusiveDoubleClickMode)for(let s=0;s<this._delayedClicks.length;s++)if(this._delayedClicks[s])if(e.button===s)clearTimeout(null===(t=this._delayedClicks[s])||void 0===t?void 0:t.timeoutId);else{const e=this._delayedClicks[s].clickInfo;this._doubleClickOccured=!1,e.singleClick=!0,e.ignore=!1;const t=this._delayedClicks[s].evt,i=A.kD.POINTERTAP,r=new A.R5(i,t,this._currentPickResult);n.onPointerObservable.hasObservers()&&n.onPointerObservable.hasSpecificMask(i)&&n.onPointerObservable.notifyObservers(r,i),this._delayedClicks[s]=null}if(this._updatePointerPosition(e),-1===this._swipeButtonPressed&&(this._swipeButtonPressed=e.button),n.preventDefaultOnPointerDown&&s&&(e.preventDefault(),s.focus()),this._startingPointerPosition.x=this._pointerX,this._startingPointerPosition.y=this._pointerY,this._startingPointerTime=Date.now(),this._checkPrePointerObservable(null,e,A.kD.POINTERDOWN))return;if(!n.cameraToUseForPointers&&!n.activeCamera)return;let i;this._pointerCaptures[e.pointerId]=!0,n.pointerDownPredicate||(n.pointerDownPredicate=e=>e.isPickable&&e.isVisible&&e.isReady()&&e.isEnabled()&&(!n.cameraToUseForPointers||0!=(n.cameraToUseForPointers.layerMask&e.layerMask))),this._pickedDownMesh=null,i=n.skipPointerDownPicking||0===n._registeredActions&&!this._checkForPicking()&&!n.onPointerDown?new f.p:n.pick(this._unTranslatedPointerX,this._unTranslatedPointerY,n.pointerDownPredicate,!1,n.cameraToUseForPointers),this._processPointerDown(i,e)},this._onPointerUp=e=>{0!==this._totalPointersPressed&&(this._totalPointersPressed--,this._pickedUpMesh=null,this._meshPickProceed=!1,this._updatePointerPosition(e),n.preventDefaultOnPointerUp&&s&&(e.preventDefault(),s.focus()),this._initClickEvent(n.onPrePointerObservable,n.onPointerObservable,e,((t,i)=>{if(n.onPrePointerObservable.hasObservers()&&(this._skipPointerTap=!1,!t.ignore)){if(this._checkPrePointerObservable(null,e,A.kD.POINTERUP))return void(this._swipeButtonPressed===e.button&&(this._isSwiping=!1,this._swipeButtonPressed=-1));t.hasSwiped||(t.singleClick&&n.onPrePointerObservable.hasSpecificMask(A.kD.POINTERTAP)&&this._checkPrePointerObservable(null,e,A.kD.POINTERTAP)&&(this._skipPointerTap=!0),t.doubleClick&&n.onPrePointerObservable.hasSpecificMask(A.kD.POINTERDOUBLETAP)&&this._checkPrePointerObservable(null,e,A.kD.POINTERDOUBLETAP)&&(this._skipPointerTap=!0))}this._pointerCaptures[e.pointerId]?(0===e.buttons&&(this._pointerCaptures[e.pointerId]=!1),(n.cameraToUseForPointers||n.activeCamera)&&(n.pointerUpPredicate||(n.pointerUpPredicate=e=>e.isPickable&&e.isVisible&&e.isReady()&&e.isEnabled()&&(!n.cameraToUseForPointers||0!=(n.cameraToUseForPointers.layerMask&e.layerMask))),!this._meshPickProceed&&(S&&S.HasTriggers||this._checkForPicking()||n.onPointerUp)&&this._initActionManager(null,t),i||(i=this._currentPickResult),this._processPointerUp(i,e,t),this._previousPickResult=this._currentPickResult,this._swipeButtonPressed===e.button&&(this._isSwiping=!1,this._swipeButtonPressed=-1))):this._swipeButtonPressed===e.button&&(this._isSwiping=!1,this._swipeButtonPressed=-1)})))},this._onKeyDown=e=>{const t=N.OG.KEYDOWN;if(n.onPreKeyboardObservable.hasObservers()){const i=new N.WZ(t,e);if(n.onPreKeyboardObservable.notifyObservers(i,t),i.skipOnKeyboardObservable)return}if(n.onKeyboardObservable.hasObservers()){const i=new N.NG(t,e);n.onKeyboardObservable.notifyObservers(i,t)}n.actionManager&&n.actionManager.processTrigger(14,p.CreateNewFromScene(n,e))},this._onKeyUp=e=>{const t=N.OG.KEYUP;if(n.onPreKeyboardObservable.hasObservers()){const i=new N.WZ(t,e);if(n.onPreKeyboardObservable.notifyObservers(i,t),i.skipOnKeyboardObservable)return}if(n.onKeyboardObservable.hasObservers()){const i=new N.NG(t,e);n.onKeyboardObservable.notifyObservers(i,t)}n.actionManager&&n.actionManager.processTrigger(15,p.CreateNewFromScene(n,e))},this._deviceSourceManager.onDeviceConnectedObservable.add((s=>{s.deviceType===I.Mouse?s.onInputChangedObservable.add((n=>{n.inputIndex===C.LeftClick||n.inputIndex===C.MiddleClick||n.inputIndex===C.RightClick||n.inputIndex===C.BrowserBack||n.inputIndex===C.BrowserForward?t&&1===s.getInput(n.inputIndex)?this._onPointerDown(n):e&&0===s.getInput(n.inputIndex)&&this._onPointerUp(n):i&&(n.inputIndex===C.Move?this._onPointerMove(n):n.inputIndex!==C.MouseWheelX&&n.inputIndex!==C.MouseWheelY&&n.inputIndex!==C.MouseWheelZ||this._onPointerMove(n))})):s.deviceType===I.Touch?s.onInputChangedObservable.add((n=>{n.inputIndex===C.LeftClick&&(t&&1===s.getInput(n.inputIndex)?(this._onPointerDown(n),this._totalPointersPressed>1&&(this._isMultiTouchGesture=!0)):e&&0===s.getInput(n.inputIndex)&&(this._onPointerUp(n),0===this._totalPointersPressed&&(this._isMultiTouchGesture=!1))),i&&n.inputIndex===C.Move&&this._onPointerMove(n)})):s.deviceType===I.Keyboard&&s.onInputChangedObservable.add((e=>{"keydown"===e.type?this._onKeyDown(e):"keyup"===e.type&&this._onKeyUp(e)}))})),this._alreadyAttached=!0}detachControl(){this._alreadyAttached&&(this._deviceSourceManager.dispose(),this._deviceSourceManager=null,this._alreadyAttachedTo&&!this._scene.doNotHandleCursors&&(this._alreadyAttachedTo.style.cursor=this._scene.defaultCursor),this._alreadyAttached=!1,this._alreadyAttachedTo=null)}setPointerOverMesh(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;if(!(this._meshUnderPointerId[t]!==e||e&&e._internalAbstractMeshDataInfo._pointerOverDisableMeshTesting))return;const n=this._meshUnderPointerId[t];let r;n&&(r=n._getActionManagerForTrigger(10),r&&r.processTrigger(10,p.CreateNew(n,s,{pointerId:t}))),e?(this._meshUnderPointerId[t]=e,this._pointerOverMesh=e,r=e._getActionManagerForTrigger(9),r&&r.processTrigger(9,p.CreateNew(e,s,{pointerId:t,pickResult:i}))):(delete this._meshUnderPointerId[t],this._pointerOverMesh=null)}getPointerOverMesh(){return this.meshUnderPointer}_invalidateMesh(e){this._pointerOverMesh===e&&(this._pointerOverMesh=null),this._pickedDownMesh===e&&(this._pickedDownMesh=null),this._pickedUpMesh===e&&(this._pickedUpMesh=null);for(const t in this._meshUnderPointerId)this._meshUnderPointerId[t]===e&&delete this._meshUnderPointerId[t]}}z.DragMovementThreshold=10,z.LongPressDelay=500,z.DoubleClickDelay=300,z.ExclusiveDoubleClickMode=!1;var H=i(2864),X=i(7046),j=i(2465);class Y{static get UniqueId(){const e=this._UniqueIdCounter;return this._UniqueIdCounter++,e}}Y._UniqueIdCounter=1;var q,K=i(562),Q=i(1221),Z=i(8134);!function(e){e[e.BackwardCompatible=0]="BackwardCompatible",e[e.Intermediate=1]="Intermediate",e[e.Aggressive=2]="Aggressive"}(q||(q={}));class $ extends c{static DefaultMaterialFactory(e){throw(0,T.S)("StandardMaterial")}static CollisionCoordinatorFactory(){throw(0,T.S)("DefaultCollisionCoordinator")}get environmentTexture(){return this._environmentTexture}set environmentTexture(e){this._environmentTexture!==e&&(this._environmentTexture=e,this.markAllMaterialsAsDirty(1))}get imageProcessingConfiguration(){return this._imageProcessingConfiguration}get performancePriority(){return this._performancePriority}set performancePriority(e){if(e!==this._performancePriority){switch(this._performancePriority=e,e){case q.BackwardCompatible:this.skipFrustumClipping=!1,this._renderingManager.maintainStateBetweenFrames=!1,this.skipPointerMovePicking=!1,this.autoClear=!0;break;case q.Intermediate:this.skipFrustumClipping=!1,this._renderingManager.maintainStateBetweenFrames=!1,this.skipPointerMovePicking=!0,this.autoClear=!1;break;case q.Aggressive:this.skipFrustumClipping=!0,this._renderingManager.maintainStateBetweenFrames=!0,this.skipPointerMovePicking=!0,this.autoClear=!1}this.onScenePerformancePriorityChangedObservable.notifyObservers(e)}}set forceWireframe(e){this._forceWireframe!==e&&(this._forceWireframe=e,this.markAllMaterialsAsDirty(16))}get forceWireframe(){return this._forceWireframe}set skipFrustumClipping(e){this._skipFrustumClipping!==e&&(this._skipFrustumClipping=e)}get skipFrustumClipping(){return this._skipFrustumClipping}set forcePointsCloud(e){this._forcePointsCloud!==e&&(this._forcePointsCloud=e,this.markAllMaterialsAsDirty(16))}get forcePointsCloud(){return this._forcePointsCloud}get animationPropertiesOverride(){return this._animationPropertiesOverride}set animationPropertiesOverride(e){this._animationPropertiesOverride=e}set onDispose(e){this._onDisposeObserver&&this.onDisposeObservable.remove(this._onDisposeObserver),this._onDisposeObserver=this.onDisposeObservable.add(e)}set beforeRender(e){this._onBeforeRenderObserver&&this.onBeforeRenderObservable.remove(this._onBeforeRenderObserver),e&&(this._onBeforeRenderObserver=this.onBeforeRenderObservable.add(e))}set afterRender(e){this._onAfterRenderObserver&&this.onAfterRenderObservable.remove(this._onAfterRenderObserver),e&&(this._onAfterRenderObserver=this.onAfterRenderObservable.add(e))}set beforeCameraRender(e){this._onBeforeCameraRenderObserver&&this.onBeforeCameraRenderObservable.remove(this._onBeforeCameraRenderObserver),this._onBeforeCameraRenderObserver=this.onBeforeCameraRenderObservable.add(e)}set afterCameraRender(e){this._onAfterCameraRenderObserver&&this.onAfterCameraRenderObservable.remove(this._onAfterCameraRenderObserver),this._onAfterCameraRenderObserver=this.onAfterCameraRenderObservable.add(e)}get unTranslatedPointer(){return this._inputManager.unTranslatedPointer}static get DragMovementThreshold(){return z.DragMovementThreshold}static set DragMovementThreshold(e){z.DragMovementThreshold=e}static get LongPressDelay(){return z.LongPressDelay}static set LongPressDelay(e){z.LongPressDelay=e}static get DoubleClickDelay(){return z.DoubleClickDelay}static set DoubleClickDelay(e){z.DoubleClickDelay=e}static get ExclusiveDoubleClickMode(){return z.ExclusiveDoubleClickMode}static set ExclusiveDoubleClickMode(e){z.ExclusiveDoubleClickMode=e}bindEyePosition(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"vEyePosition",i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];var s;const n=this._forcedViewPosition?this._forcedViewPosition:this._mirroredCameraPosition?this._mirroredCameraPosition:null!==(s=this.activeCamera.globalPosition)&&void 0!==s?s:this.activeCamera.devicePosition,r=this.useRightHandedSystem===(null!=this._mirroredCameraPosition);return h.jp.Vector4[0].set(n.x,n.y,n.z,r?-1:1),e&&(i?e.setFloat3(t,h.jp.Vector4[0].x,h.jp.Vector4[0].y,h.jp.Vector4[0].z):e.setVector4(t,h.jp.Vector4[0])),h.jp.Vector4[0]}finalizeSceneUbo(){const e=this.getSceneUniformBuffer(),t=this.bindEyePosition(null);return e.updateFloat4("vEyePosition",t.x,t.y,t.z,t.w),e.update(),e}set useRightHandedSystem(e){this._useRightHandedSystem!==e&&(this._useRightHandedSystem=e,this.markAllMaterialsAsDirty(16))}get useRightHandedSystem(){return this._useRightHandedSystem}setStepId(e){this._currentStepId=e}getStepId(){return this._currentStepId}getInternalStep(){return this._currentInternalStep}set fogEnabled(e){this._fogEnabled!==e&&(this._fogEnabled=e,this.markAllMaterialsAsDirty(16))}get fogEnabled(){return this._fogEnabled}set fogMode(e){this._fogMode!==e&&(this._fogMode=e,this.markAllMaterialsAsDirty(16))}get fogMode(){return this._fogMode}get prePass(){return!!this.prePassRenderer&&this.prePassRenderer.defaultRT.enabled}set shadowsEnabled(e){this._shadowsEnabled!==e&&(this._shadowsEnabled=e,this.markAllMaterialsAsDirty(2))}get shadowsEnabled(){return this._shadowsEnabled}set lightsEnabled(e){this._lightsEnabled!==e&&(this._lightsEnabled=e,this.markAllMaterialsAsDirty(2))}get lightsEnabled(){return this._lightsEnabled}get activeCameras(){return this._activeCameras}set activeCameras(e){this._unObserveActiveCameras&&(this._unObserveActiveCameras(),this._unObserveActiveCameras=null),e&&(this._unObserveActiveCameras=(0,Z.M)(e,(()=>{this.onActiveCamerasChanged.notifyObservers(this)}))),this._activeCameras=e}get activeCamera(){return this._activeCamera}set activeCamera(e){e!==this._activeCamera&&(this._activeCamera=e,this.onActiveCameraChanged.notifyObservers(this))}get defaultMaterial(){return this._defaultMaterial||(this._defaultMaterial=$.DefaultMaterialFactory(this)),this._defaultMaterial}set defaultMaterial(e){this._defaultMaterial=e}set texturesEnabled(e){this._texturesEnabled!==e&&(this._texturesEnabled=e,this.markAllMaterialsAsDirty(1))}get texturesEnabled(){return this._texturesEnabled}set skeletonsEnabled(e){this._skeletonsEnabled!==e&&(this._skeletonsEnabled=e,this.markAllMaterialsAsDirty(8))}get skeletonsEnabled(){return this._skeletonsEnabled}get collisionCoordinator(){return this._collisionCoordinator||(this._collisionCoordinator=$.CollisionCoordinatorFactory(),this._collisionCoordinator.init(this)),this._collisionCoordinator}get renderingManager(){return this._renderingManager}get frustumPlanes(){return this._frustumPlanes}_registerTransientComponents(){if(this._transientComponents.length>0){for(const e of this._transientComponents)e.register();this._transientComponents.length=0}}_addComponent(e){this._components.push(e),this._transientComponents.push(e);const t=e;t.addFromContainer&&t.serialize&&this._serializableComponents.push(t)}_getComponent(e){for(const t of this._components)if(t.name===e)return t;return null}constructor(e,t){super(),this._inputManager=new z(this),this.cameraToUseForPointers=null,this._isScene=!0,this._blockEntityCollection=!1,this.autoClear=!0,this.autoClearDepthAndStencil=!0,this.clearColor=new X.HE(.2,.2,.3,1),this.ambientColor=new X.Wo(0,0,0),this.environmentIntensity=1,this._performancePriority=q.BackwardCompatible,this.onScenePerformancePriorityChangedObservable=new r.y$,this._forceWireframe=!1,this._skipFrustumClipping=!1,this._forcePointsCloud=!1,this.animationsEnabled=!0,this._animationPropertiesOverride=null,this.useConstantAnimationDeltaTime=!1,this.constantlyUpdateMeshUnderPointer=!1,this.hoverCursor="pointer",this.defaultCursor="",this.doNotHandleCursors=!1,this.preventDefaultOnPointerDown=!0,this.preventDefaultOnPointerUp=!0,this.metadata=null,this.reservedDataStore=null,this.disableOfflineSupportExceptionRules=new Array,this.onDisposeObservable=new r.y$,this._onDisposeObserver=null,this.onBeforeRenderObservable=new r.y$,this._onBeforeRenderObserver=null,this.onAfterRenderObservable=new r.y$,this.onAfterRenderCameraObservable=new r.y$,this._onAfterRenderObserver=null,this.onBeforeAnimationsObservable=new r.y$,this.onAfterAnimationsObservable=new r.y$,this.onBeforeDrawPhaseObservable=new r.y$,this.onAfterDrawPhaseObservable=new r.y$,this.onReadyObservable=new r.y$,this.onBeforeCameraRenderObservable=new r.y$,this._onBeforeCameraRenderObserver=null,this.onAfterCameraRenderObservable=new r.y$,this._onAfterCameraRenderObserver=null,this.onBeforeActiveMeshesEvaluationObservable=new r.y$,this.onAfterActiveMeshesEvaluationObservable=new r.y$,this.onBeforeParticlesRenderingObservable=new r.y$,this.onAfterParticlesRenderingObservable=new r.y$,this.onDataLoadedObservable=new r.y$,this.onNewCameraAddedObservable=new r.y$,this.onCameraRemovedObservable=new r.y$,this.onNewLightAddedObservable=new r.y$,this.onLightRemovedObservable=new r.y$,this.onNewGeometryAddedObservable=new r.y$,this.onGeometryRemovedObservable=new r.y$,this.onNewTransformNodeAddedObservable=new r.y$,this.onTransformNodeRemovedObservable=new r.y$,this.onNewMeshAddedObservable=new r.y$,this.onMeshRemovedObservable=new r.y$,this.onNewSkeletonAddedObservable=new r.y$,this.onSkeletonRemovedObservable=new r.y$,this.onNewMaterialAddedObservable=new r.y$,this.onNewMultiMaterialAddedObservable=new r.y$,this.onMaterialRemovedObservable=new r.y$,this.onMultiMaterialRemovedObservable=new r.y$,this.onNewTextureAddedObservable=new r.y$,this.onTextureRemovedObservable=new r.y$,this.onBeforeRenderTargetsRenderObservable=new r.y$,this.onAfterRenderTargetsRenderObservable=new r.y$,this.onBeforeStepObservable=new r.y$,this.onAfterStepObservable=new r.y$,this.onActiveCameraChanged=new r.y$,this.onActiveCamerasChanged=new r.y$,this.onBeforeRenderingGroupObservable=new r.y$,this.onAfterRenderingGroupObservable=new r.y$,this.onMeshImportedObservable=new r.y$,this.onAnimationFileImportedObservable=new r.y$,this._registeredForLateAnimationBindings=new a.f(256),this.skipPointerMovePicking=!1,this.skipPointerDownPicking=!1,this.skipPointerUpPicking=!1,this.onPrePointerObservable=new r.y$,this.onPointerObservable=new r.y$,this.onPreKeyboardObservable=new r.y$,this.onKeyboardObservable=new r.y$,this._useRightHandedSystem=!1,this._timeAccumulator=0,this._currentStepId=0,this._currentInternalStep=0,this._fogEnabled=!0,this._fogMode=$.FOGMODE_NONE,this.fogColor=new X.Wo(.2,.2,.3),this.fogDensity=.1,this.fogStart=0,this.fogEnd=1e3,this.needsPreviousWorldMatrices=!1,this._shadowsEnabled=!0,this._lightsEnabled=!0,this._unObserveActiveCameras=null,this._texturesEnabled=!0,this.physicsEnabled=!0,this.particlesEnabled=!0,this.spritesEnabled=!0,this._skeletonsEnabled=!0,this.lensFlaresEnabled=!0,this.collisionsEnabled=!0,this.gravity=new h.P(0,-9.807,0),this.postProcessesEnabled=!0,this.renderTargetsEnabled=!0,this.dumpNextRenderTargets=!1,this.customRenderTargets=new Array,this.importedMeshesFiles=new Array,this.probesEnabled=!0,this._meshesForIntersections=new a.f(256),this.proceduralTexturesEnabled=!0,this._totalVertices=new H.z,this._activeIndices=new H.z,this._activeParticles=new H.z,this._activeBones=new H.z,this._animationTime=0,this.animationTimeScale=1,this._renderId=0,this._frameId=0,this._executeWhenReadyTimeoutId=null,this._intermediateRendering=!1,this._defaultFrameBufferCleared=!1,this._viewUpdateFlag=-1,this._projectionUpdateFlag=-1,this._toBeDisposed=new Array(256),this._activeRequests=new Array,this._pendingData=new Array,this._isDisposed=!1,this.dispatchAllSubMeshesOfActiveMeshes=!1,this._activeMeshes=new a.t(256),this._processedMaterials=new a.t(256),this._renderTargets=new a.f(256),this._materialsRenderTargets=new a.f(256),this._activeParticleSystems=new a.t(256),this._activeSkeletons=new a.f(32),this._softwareSkinnedMeshes=new a.f(32),this._activeAnimatables=new Array,this._transformMatrix=h.y3.Zero(),this.requireLightSorting=!1,this._components=[],this._serializableComponents=[],this._transientComponents=[],this._beforeCameraUpdateStage=E.H.Create(),this._beforeClearStage=E.H.Create(),this._beforeRenderTargetClearStage=E.H.Create(),this._gatherRenderTargetsStage=E.H.Create(),this._gatherActiveCameraRenderTargetsStage=E.H.Create(),this._isReadyForMeshStage=E.H.Create(),this._beforeEvaluateActiveMeshStage=E.H.Create(),this._evaluateSubMeshStage=E.H.Create(),this._preActiveMeshStage=E.H.Create(),this._cameraDrawRenderTargetStage=E.H.Create(),this._beforeCameraDrawStage=E.H.Create(),this._beforeRenderTargetDrawStage=E.H.Create(),this._beforeRenderingGroupDrawStage=E.H.Create(),this._beforeRenderingMeshStage=E.H.Create(),this._afterRenderingMeshStage=E.H.Create(),this._afterRenderingGroupDrawStage=E.H.Create(),this._afterCameraDrawStage=E.H.Create(),this._afterCameraPostProcessStage=E.H.Create(),this._afterRenderTargetDrawStage=E.H.Create(),this._afterRenderTargetPostProcessStage=E.H.Create(),this._afterRenderStage=E.H.Create(),this._pointerMoveStage=E.H.Create(),this._pointerDownStage=E.H.Create(),this._pointerUpStage=E.H.Create(),this._geometriesByUniqueId=null,this._defaultMeshCandidates={data:[],length:0},this._defaultSubMeshCandidates={data:[],length:0},this._preventFreeActiveMeshesAndRenderingGroups=!1,this._activeMeshesFrozen=!1,this._activeMeshesFrozenButKeepClipping=!1,this._skipEvaluateActiveMeshesCompletely=!1,this._allowPostProcessClearColor=!0,this.getDeterministicFrameTime=()=>this._engine.getTimeStep(),this._registeredActions=0,this._blockMaterialDirtyMechanism=!1,this._perfCollector=null,this.activeCameras=new Array;const i={useGeometryUniqueIdsMap:!0,useMaterialMeshMap:!0,useClonedMeshMap:!0,virtual:!1,...t};this._engine=e||M.l.LastCreatedEngine,i.virtual?this._engine._virtualScenes.push(this):(M.l._LastCreatedScene=this,this._engine.scenes.push(this)),this._uid=null,this._renderingManager=new b(this),m&&(this.postProcessManager=new m(this)),(0,y.CG)()&&this.attachControl(),this._createUbo(),u.$&&(this._imageProcessingConfiguration=new u.$),this.setDefaultCandidateProviders(),i.useGeometryUniqueIdsMap&&(this._geometriesByUniqueId={}),this.useMaterialMeshMap=i.useMaterialMeshMap,this.useClonedMeshMap=i.useClonedMeshMap,t&&t.virtual||this._engine.onNewSceneAddedObservable.notifyObservers(this)}getClassName(){return"Scene"}_getDefaultMeshCandidates(){return this._defaultMeshCandidates.data=this.meshes,this._defaultMeshCandidates.length=this.meshes.length,this._defaultMeshCandidates}_getDefaultSubMeshCandidates(e){return this._defaultSubMeshCandidates.data=e.subMeshes,this._defaultSubMeshCandidates.length=e.subMeshes.length,this._defaultSubMeshCandidates}setDefaultCandidateProviders(){this.getActiveMeshCandidates=this._getDefaultMeshCandidates.bind(this),this.getActiveSubMeshCandidates=this._getDefaultSubMeshCandidates.bind(this),this.getIntersectingSubMeshCandidates=this._getDefaultSubMeshCandidates.bind(this),this.getCollidingSubMeshCandidates=this._getDefaultSubMeshCandidates.bind(this)}get meshUnderPointer(){return this._inputManager.meshUnderPointer}get pointerX(){return this._inputManager.pointerX}set pointerX(e){this._inputManager.pointerX=e}get pointerY(){return this._inputManager.pointerY}set pointerY(e){this._inputManager.pointerY=e}getCachedMaterial(){return this._cachedMaterial}getCachedEffect(){return this._cachedEffect}getCachedVisibility(){return this._cachedVisibility}isCachedMaterialInvalid(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return this._cachedEffect!==t||this._cachedMaterial!==e||this._cachedVisibility!==i}getEngine(){return this._engine}getTotalVertices(){return this._totalVertices.current}get totalVerticesPerfCounter(){return this._totalVertices}getActiveIndices(){return this._activeIndices.current}get totalActiveIndicesPerfCounter(){return this._activeIndices}getActiveParticles(){return this._activeParticles.current}get activeParticlesPerfCounter(){return this._activeParticles}getActiveBones(){return this._activeBones.current}get activeBonesPerfCounter(){return this._activeBones}getActiveMeshes(){return this._activeMeshes}getAnimationRatio(){return void 0!==this._animationRatio?this._animationRatio:1}getRenderId(){return this._renderId}getFrameId(){return this._frameId}incrementRenderId(){this._renderId++}_createUbo(){this.setSceneUniformBuffer(this.createSceneUniformBuffer())}simulatePointerMove(e,t){return this._inputManager.simulatePointerMove(e,t),this}simulatePointerDown(e,t){return this._inputManager.simulatePointerDown(e,t),this}simulatePointerUp(e,t,i){return this._inputManager.simulatePointerUp(e,t,i),this}isPointerCaptured(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this._inputManager.isPointerCaptured(e)}attachControl(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this._inputManager.attachControl(e,t,i)}detachControl(){this._inputManager.detachControl()}isReady(){let e,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this._isDisposed)return!1;const i=this.getEngine();let s=!0;for(this._pendingData.length>0&&(s=!1),t&&(this._processedMaterials.reset(),this._materialsRenderTargets.reset()),e=0;e<this.meshes.length;e++){const n=this.meshes[e];if(!n.subMeshes||0===n.subMeshes.length)continue;if(!n.isReady(!0)){s=!1;continue}const r=n.hasThinInstances||"InstancedMesh"===n.getClassName()||"InstancedLinesMesh"===n.getClassName()||i.getCaps().instancedArrays&&n.instances.length>0;for(const e of this._isReadyForMeshStage)e.action(n,r)||(s=!1);if(!t)continue;const a=n.material||this.defaultMaterial;if(a)if(a._storeEffectOnSubMeshes)for(const e of n.subMeshes){const t=e.getMaterial();t&&t.hasRenderTargetTextures&&null!=t.getRenderTargetTextures&&-1===this._processedMaterials.indexOf(t)&&(this._processedMaterials.push(t),this._materialsRenderTargets.concatWithNoDuplicate(t.getRenderTargetTextures()))}else a.hasRenderTargetTextures&&null!=a.getRenderTargetTextures&&-1===this._processedMaterials.indexOf(a)&&(this._processedMaterials.push(a),this._materialsRenderTargets.concatWithNoDuplicate(a.getRenderTargetTextures()))}if(!s)return!1;if(!i.areAllEffectsReady())return!1;if(t)for(e=0;e<this._materialsRenderTargets.length;++e){if(!this._materialsRenderTargets.data[e].isReadyForRendering())return!1}for(e=0;e<this.geometries.length;e++){if(2===this.geometries[e].delayLoadState)return!1}if(this.activeCameras&&this.activeCameras.length>0){for(const n of this.activeCameras)if(!n.isReady(!0))return!1}else if(this.activeCamera&&!this.activeCamera.isReady(!0))return!1;for(const n of this.particleSystems)if(!n.isReady())return!1;return!0}resetCachedMaterial(){this._cachedMaterial=null,this._cachedEffect=null,this._cachedVisibility=null}registerBeforeRender(e){this.onBeforeRenderObservable.add(e)}unregisterBeforeRender(e){this.onBeforeRenderObservable.removeCallback(e)}registerAfterRender(e){this.onAfterRenderObservable.add(e)}unregisterAfterRender(e){this.onAfterRenderObservable.removeCallback(e)}_executeOnceBeforeRender(e){const t=()=>{e(),setTimeout((()=>{this.unregisterBeforeRender(t)}))};this.registerBeforeRender(t)}executeOnceBeforeRender(e,t){void 0!==t?setTimeout((()=>{this._executeOnceBeforeRender(e)}),t):this._executeOnceBeforeRender(e)}addPendingData(e){this._pendingData.push(e)}removePendingData(e){const t=this.isLoading,i=this._pendingData.indexOf(e);-1!==i&&this._pendingData.splice(i,1),t&&!this.isLoading&&this.onDataLoadedObservable.notifyObservers(this)}getWaitingItemsCount(){return this._pendingData.length}get isLoading(){return this._pendingData.length>0}executeWhenReady(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.onReadyObservable.addOnce(e),null===this._executeWhenReadyTimeoutId&&this._checkIsReady(t)}whenReadyAsync(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return new Promise((t=>{this.executeWhenReady((()=>{t()}),e)}))}_checkIsReady(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._registerTransientComponents(),this.isReady(e)?(this.onReadyObservable.notifyObservers(this),this.onReadyObservable.clear(),void(this._executeWhenReadyTimeoutId=null)):this._isDisposed?(this.onReadyObservable.clear(),void(this._executeWhenReadyTimeoutId=null)):void(this._executeWhenReadyTimeoutId=setTimeout((()=>{this.incrementRenderId(),this._checkIsReady(e)}),100))}get animatables(){return this._activeAnimatables}resetLastAnimationTimeFrame(){this._animationTimeLast=n.F.Now}getViewMatrix(){return this._viewMatrix}getProjectionMatrix(){return this._projectionMatrix}getTransformMatrix(){return this._transformMatrix}setTransformMatrix(e,t,i,s){i||s||!this._multiviewSceneUbo||(this._multiviewSceneUbo.dispose(),this._multiviewSceneUbo=null),this._viewUpdateFlag===e.updateFlag&&this._projectionUpdateFlag===t.updateFlag||(this._viewUpdateFlag=e.updateFlag,this._projectionUpdateFlag=t.updateFlag,this._viewMatrix=e,this._projectionMatrix=t,this._viewMatrix.multiplyToRef(this._projectionMatrix,this._transformMatrix),this._frustumPlanes?j.i.GetPlanesToRef(this._transformMatrix,this._frustumPlanes):this._frustumPlanes=j.i.GetPlanes(this._transformMatrix),this._multiviewSceneUbo&&this._multiviewSceneUbo.useUbo?this._updateMultiviewUbo(i,s):this._sceneUbo.useUbo&&(this._sceneUbo.updateMatrix("viewProjection",this._transformMatrix),this._sceneUbo.updateMatrix("view",this._viewMatrix),this._sceneUbo.updateMatrix("projection",this._projectionMatrix)))}getSceneUniformBuffer(){return this._multiviewSceneUbo?this._multiviewSceneUbo:this._sceneUbo}createSceneUniformBuffer(e){const t=new d.M(this._engine,void 0,!1,null!=e?e:"scene");return t.addUniform("viewProjection",16),t.addUniform("view",16),t.addUniform("projection",16),t.addUniform("vEyePosition",4),t}setSceneUniformBuffer(e){this._sceneUbo=e,this._viewUpdateFlag=-1,this._projectionUpdateFlag=-1}getUniqueId(){return Y.UniqueId}addMesh(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._blockEntityCollection||(this.meshes.push(e),e._resyncLightSources(),e.parent||e._addToSceneRootNodes(),this.onNewMeshAddedObservable.notifyObservers(e),t&&e.getChildMeshes().forEach((e=>{this.addMesh(e)})))}removeMesh(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const i=this.meshes.indexOf(e);return-1!==i&&(this.meshes[i]=this.meshes[this.meshes.length-1],this.meshes.pop(),e.parent||e._removeFromSceneRootNodes()),this._inputManager._invalidateMesh(e),this.onMeshRemovedObservable.notifyObservers(e),t&&e.getChildMeshes().forEach((e=>{this.removeMesh(e)})),i}addTransformNode(e){this._blockEntityCollection||e.getScene()===this&&-1!==e._indexInSceneTransformNodesArray||(e._indexInSceneTransformNodesArray=this.transformNodes.length,this.transformNodes.push(e),e.parent||e._addToSceneRootNodes(),this.onNewTransformNodeAddedObservable.notifyObservers(e))}removeTransformNode(e){const t=e._indexInSceneTransformNodesArray;if(-1!==t){if(t!==this.transformNodes.length-1){const e=this.transformNodes[this.transformNodes.length-1];this.transformNodes[t]=e,e._indexInSceneTransformNodesArray=t}e._indexInSceneTransformNodesArray=-1,this.transformNodes.pop(),e.parent||e._removeFromSceneRootNodes()}return this.onTransformNodeRemovedObservable.notifyObservers(e),t}removeSkeleton(e){const t=this.skeletons.indexOf(e);return-1!==t&&(this.skeletons.splice(t,1),this.onSkeletonRemovedObservable.notifyObservers(e),this._executeActiveContainerCleanup(this._activeSkeletons)),t}removeMorphTargetManager(e){const t=this.morphTargetManagers.indexOf(e);return-1!==t&&this.morphTargetManagers.splice(t,1),t}removeLight(e){const t=this.lights.indexOf(e);if(-1!==t){for(const t of this.meshes)t._removeLightSource(e,!1);this.lights.splice(t,1),this.sortLightsByPriority(),e.parent||e._removeFromSceneRootNodes()}return this.onLightRemovedObservable.notifyObservers(e),t}removeCamera(e){const t=this.cameras.indexOf(e);if(-1!==t&&(this.cameras.splice(t,1),e.parent||e._removeFromSceneRootNodes()),this.activeCameras){const t=this.activeCameras.indexOf(e);-1!==t&&this.activeCameras.splice(t,1)}return this.activeCamera===e&&(this.cameras.length>0?this.activeCamera=this.cameras[0]:this.activeCamera=null),this.onCameraRemovedObservable.notifyObservers(e),t}removeParticleSystem(e){const t=this.particleSystems.indexOf(e);return-1!==t&&(this.particleSystems.splice(t,1),this._executeActiveContainerCleanup(this._activeParticleSystems)),t}removeAnimation(e){const t=this.animations.indexOf(e);return-1!==t&&this.animations.splice(t,1),t}stopAnimation(e,t,i){}removeAnimationGroup(e){const t=this.animationGroups.indexOf(e);return-1!==t&&this.animationGroups.splice(t,1),t}removeMultiMaterial(e){const t=this.multiMaterials.indexOf(e);return-1!==t&&this.multiMaterials.splice(t,1),this.onMultiMaterialRemovedObservable.notifyObservers(e),t}removeMaterial(e){const t=e._indexInSceneMaterialArray;if(-1!==t&&t<this.materials.length){if(t!==this.materials.length-1){const e=this.materials[this.materials.length-1];this.materials[t]=e,e._indexInSceneMaterialArray=t}e._indexInSceneMaterialArray=-1,this.materials.pop()}return this.onMaterialRemovedObservable.notifyObservers(e),t}removeActionManager(e){const t=this.actionManagers.indexOf(e);return-1!==t&&this.actionManagers.splice(t,1),t}removeTexture(e){const t=this.textures.indexOf(e);return-1!==t&&this.textures.splice(t,1),this.onTextureRemovedObservable.notifyObservers(e),t}addLight(e){if(!this._blockEntityCollection){this.lights.push(e),this.sortLightsByPriority(),e.parent||e._addToSceneRootNodes();for(const t of this.meshes)-1===t.lightSources.indexOf(e)&&(t.lightSources.push(e),t._resyncLightSources());this.onNewLightAddedObservable.notifyObservers(e)}}sortLightsByPriority(){this.requireLightSorting&&this.lights.sort(Q.m.CompareLightsPriority)}addCamera(e){this._blockEntityCollection||(this.cameras.push(e),this.onNewCameraAddedObservable.notifyObservers(e),e.parent||e._addToSceneRootNodes())}addSkeleton(e){this._blockEntityCollection||(this.skeletons.push(e),this.onNewSkeletonAddedObservable.notifyObservers(e))}addParticleSystem(e){this._blockEntityCollection||this.particleSystems.push(e)}addAnimation(e){this._blockEntityCollection||this.animations.push(e)}addAnimationGroup(e){this._blockEntityCollection||this.animationGroups.push(e)}addMultiMaterial(e){this._blockEntityCollection||(this.multiMaterials.push(e),this.onNewMultiMaterialAddedObservable.notifyObservers(e))}addMaterial(e){this._blockEntityCollection||e.getScene()===this&&-1!==e._indexInSceneMaterialArray||(e._indexInSceneMaterialArray=this.materials.length,this.materials.push(e),this.onNewMaterialAddedObservable.notifyObservers(e))}addMorphTargetManager(e){this._blockEntityCollection||this.morphTargetManagers.push(e)}addGeometry(e){this._blockEntityCollection||(this._geometriesByUniqueId&&(this._geometriesByUniqueId[e.uniqueId]=this.geometries.length),this.geometries.push(e))}addActionManager(e){this.actionManagers.push(e)}addTexture(e){this._blockEntityCollection||(this.textures.push(e),this.onNewTextureAddedObservable.notifyObservers(e))}switchActiveCamera(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this._engine.getInputElement()&&(this.activeCamera&&this.activeCamera.detachControl(),this.activeCamera=e,t&&e.attachControl())}setActiveCameraById(e){const t=this.getCameraById(e);return t?(this.activeCamera=t,t):null}setActiveCameraByName(e){const t=this.getCameraByName(e);return t?(this.activeCamera=t,t):null}getAnimationGroupByName(e){for(let t=0;t<this.animationGroups.length;t++)if(this.animationGroups[t].name===e)return this.animationGroups[t];return null}_getMaterial(e,t){for(let i=0;i<this.materials.length;i++){const e=this.materials[i];if(t(e))return e}if(e)for(let i=0;i<this.multiMaterials.length;i++){const e=this.multiMaterials[i];if(t(e))return e}return null}getMaterialByUniqueID(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._getMaterial(t,(t=>t.uniqueId===e))}getMaterialById(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._getMaterial(t,(t=>t.id===e))}getMaterialByName(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._getMaterial(t,(t=>t.name===e))}getLastMaterialById(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];for(let i=this.materials.length-1;i>=0;i--)if(this.materials[i].id===e)return this.materials[i];if(t)for(let i=this.multiMaterials.length-1;i>=0;i--)if(this.multiMaterials[i].id===e)return this.multiMaterials[i];return null}getTextureByUniqueId(e){for(let t=0;t<this.textures.length;t++)if(this.textures[t].uniqueId===e)return this.textures[t];return null}getTextureByName(e){for(let t=0;t<this.textures.length;t++)if(this.textures[t].name===e)return this.textures[t];return null}getCameraById(e){for(let t=0;t<this.cameras.length;t++)if(this.cameras[t].id===e)return this.cameras[t];return null}getCameraByUniqueId(e){for(let t=0;t<this.cameras.length;t++)if(this.cameras[t].uniqueId===e)return this.cameras[t];return null}getCameraByName(e){for(let t=0;t<this.cameras.length;t++)if(this.cameras[t].name===e)return this.cameras[t];return null}getBoneById(e){for(let t=0;t<this.skeletons.length;t++){const i=this.skeletons[t];for(let t=0;t<i.bones.length;t++)if(i.bones[t].id===e)return i.bones[t]}return null}getBoneByName(e){for(let t=0;t<this.skeletons.length;t++){const i=this.skeletons[t];for(let t=0;t<i.bones.length;t++)if(i.bones[t].name===e)return i.bones[t]}return null}getLightByName(e){for(let t=0;t<this.lights.length;t++)if(this.lights[t].name===e)return this.lights[t];return null}getLightById(e){for(let t=0;t<this.lights.length;t++)if(this.lights[t].id===e)return this.lights[t];return null}getLightByUniqueId(e){for(let t=0;t<this.lights.length;t++)if(this.lights[t].uniqueId===e)return this.lights[t];return null}getParticleSystemById(e){for(let t=0;t<this.particleSystems.length;t++)if(this.particleSystems[t].id===e)return this.particleSystems[t];return null}getGeometryById(e){for(let t=0;t<this.geometries.length;t++)if(this.geometries[t].id===e)return this.geometries[t];return null}_getGeometryByUniqueId(e){if(this._geometriesByUniqueId){const t=this._geometriesByUniqueId[e];if(void 0!==t)return this.geometries[t]}else for(let t=0;t<this.geometries.length;t++)if(this.geometries[t].uniqueId===e)return this.geometries[t];return null}pushGeometry(e,t){return!(!t&&this._getGeometryByUniqueId(e.uniqueId))&&(this.addGeometry(e),this.onNewGeometryAddedObservable.notifyObservers(e),!0)}removeGeometry(e){let t;if(this._geometriesByUniqueId){if(t=this._geometriesByUniqueId[e.uniqueId],void 0===t)return!1}else if(t=this.geometries.indexOf(e),t<0)return!1;if(t!==this.geometries.length-1){const e=this.geometries[this.geometries.length-1];e&&(this.geometries[t]=e,this._geometriesByUniqueId&&(this._geometriesByUniqueId[e.uniqueId]=t))}return this._geometriesByUniqueId&&(this._geometriesByUniqueId[e.uniqueId]=void 0),this.geometries.pop(),this.onGeometryRemovedObservable.notifyObservers(e),!0}getGeometries(){return this.geometries}getMeshById(e){for(let t=0;t<this.meshes.length;t++)if(this.meshes[t].id===e)return this.meshes[t];return null}getMeshesById(e){return this.meshes.filter((function(t){return t.id===e}))}getTransformNodeById(e){for(let t=0;t<this.transformNodes.length;t++)if(this.transformNodes[t].id===e)return this.transformNodes[t];return null}getTransformNodeByUniqueId(e){for(let t=0;t<this.transformNodes.length;t++)if(this.transformNodes[t].uniqueId===e)return this.transformNodes[t];return null}getTransformNodesById(e){return this.transformNodes.filter((function(t){return t.id===e}))}getMeshByUniqueId(e){for(let t=0;t<this.meshes.length;t++)if(this.meshes[t].uniqueId===e)return this.meshes[t];return null}getLastMeshById(e){for(let t=this.meshes.length-1;t>=0;t--)if(this.meshes[t].id===e)return this.meshes[t];return null}getLastEntryById(e){let t;for(t=this.meshes.length-1;t>=0;t--)if(this.meshes[t].id===e)return this.meshes[t];for(t=this.transformNodes.length-1;t>=0;t--)if(this.transformNodes[t].id===e)return this.transformNodes[t];for(t=this.cameras.length-1;t>=0;t--)if(this.cameras[t].id===e)return this.cameras[t];for(t=this.lights.length-1;t>=0;t--)if(this.lights[t].id===e)return this.lights[t];return null}getNodeById(e){const t=this.getMeshById(e);if(t)return t;const i=this.getTransformNodeById(e);if(i)return i;const s=this.getLightById(e);if(s)return s;const n=this.getCameraById(e);if(n)return n;const r=this.getBoneById(e);return r||null}getNodeByName(e){const t=this.getMeshByName(e);if(t)return t;const i=this.getTransformNodeByName(e);if(i)return i;const s=this.getLightByName(e);if(s)return s;const n=this.getCameraByName(e);if(n)return n;const r=this.getBoneByName(e);return r||null}getMeshByName(e){for(let t=0;t<this.meshes.length;t++)if(this.meshes[t].name===e)return this.meshes[t];return null}getTransformNodeByName(e){for(let t=0;t<this.transformNodes.length;t++)if(this.transformNodes[t].name===e)return this.transformNodes[t];return null}getLastSkeletonById(e){for(let t=this.skeletons.length-1;t>=0;t--)if(this.skeletons[t].id===e)return this.skeletons[t];return null}getSkeletonByUniqueId(e){for(let t=0;t<this.skeletons.length;t++)if(this.skeletons[t].uniqueId===e)return this.skeletons[t];return null}getSkeletonById(e){for(let t=0;t<this.skeletons.length;t++)if(this.skeletons[t].id===e)return this.skeletons[t];return null}getSkeletonByName(e){for(let t=0;t<this.skeletons.length;t++)if(this.skeletons[t].name===e)return this.skeletons[t];return null}getMorphTargetManagerById(e){for(let t=0;t<this.morphTargetManagers.length;t++)if(this.morphTargetManagers[t].uniqueId===e)return this.morphTargetManagers[t];return null}getMorphTargetById(e){for(let t=0;t<this.morphTargetManagers.length;++t){const i=this.morphTargetManagers[t];for(let t=0;t<i.numTargets;++t){const s=i.getTarget(t);if(s.id===e)return s}}return null}getMorphTargetByName(e){for(let t=0;t<this.morphTargetManagers.length;++t){const i=this.morphTargetManagers[t];for(let t=0;t<i.numTargets;++t){const s=i.getTarget(t);if(s.name===e)return s}}return null}getPostProcessByName(e){for(let t=0;t<this.postProcesses.length;++t){const i=this.postProcesses[t];if(i.name===e)return i}return null}isActiveMesh(e){return-1!==this._activeMeshes.indexOf(e)}get uid(){return this._uid||(this._uid=s.w1.RandomId()),this._uid}addExternalData(e,t){return this._externalData||(this._externalData=new o),this._externalData.add(e,t)}getExternalData(e){return this._externalData?this._externalData.get(e):null}getOrAddExternalDataWithFactory(e,t){return this._externalData||(this._externalData=new o),this._externalData.getOrAddWithFactory(e,t)}removeExternalData(e){return this._externalData.remove(e)}_evaluateSubMesh(e,t,i,s){if(s||e.isInFrustum(this._frustumPlanes)){for(const s of this._evaluateSubMeshStage)s.action(t,e);const i=e.getMaterial();null!=i&&(i.hasRenderTargetTextures&&null!=i.getRenderTargetTextures&&-1===this._processedMaterials.indexOf(i)&&(this._processedMaterials.push(i),this._materialsRenderTargets.concatWithNoDuplicate(i.getRenderTargetTextures())),this._renderingManager.dispatch(e,t,i))}}freeProcessedMaterials(){this._processedMaterials.dispose()}get blockfreeActiveMeshesAndRenderingGroups(){return this._preventFreeActiveMeshesAndRenderingGroups}set blockfreeActiveMeshesAndRenderingGroups(e){this._preventFreeActiveMeshesAndRenderingGroups!==e&&(e&&(this.freeActiveMeshes(),this.freeRenderingGroups()),this._preventFreeActiveMeshesAndRenderingGroups=e)}freeActiveMeshes(){if(!this.blockfreeActiveMeshesAndRenderingGroups&&(this._activeMeshes.dispose(),this.activeCamera&&this.activeCamera._activeMeshes&&this.activeCamera._activeMeshes.dispose(),this.activeCameras))for(let e=0;e<this.activeCameras.length;e++){const t=this.activeCameras[e];t&&t._activeMeshes&&t._activeMeshes.dispose()}}freeRenderingGroups(){if(!this.blockfreeActiveMeshesAndRenderingGroups&&(this._renderingManager&&this._renderingManager.freeRenderingGroups(),this.textures))for(let e=0;e<this.textures.length;e++){const t=this.textures[e];t&&t.renderList&&t.freeRenderingGroups()}}_isInIntermediateRendering(){return this._intermediateRendering}freezeActiveMeshes(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0,s=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],n=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return this.executeWhenReady((()=>{if(this.activeCamera){if(this._frustumPlanes||this.updateTransformMatrix(),this._evaluateActiveMeshes(),this._activeMeshesFrozen=!0,this._activeMeshesFrozenButKeepClipping=n,this._skipEvaluateActiveMeshesCompletely=e,s)for(let e=0;e<this._activeMeshes.length;e++)this._activeMeshes.data[e]._freeze();t&&t()}else i&&i("No active camera found")})),this}unfreezeActiveMeshes(){for(let e=0;e<this.meshes.length;e++){const t=this.meshes[e];t._internalAbstractMeshDataInfo&&(t._internalAbstractMeshDataInfo._isActive=!1)}for(let e=0;e<this._activeMeshes.length;e++)this._activeMeshes.data[e]._unFreeze();return this._activeMeshesFrozen=!1,this}_executeActiveContainerCleanup(e){(!this._engine.snapshotRendering||1!==this._engine.snapshotRenderingMode)&&this._activeMeshesFrozen&&this._activeMeshes.length||this.onBeforeRenderObservable.addOnce((()=>e.dispose()))}_evaluateActiveMeshes(){var e;if(this._engine.snapshotRendering&&1===this._engine.snapshotRenderingMode)return void(this._activeMeshes.length>0&&(null===(e=this.activeCamera)||void 0===e||e._activeMeshes.reset(),this._activeMeshes.reset(),this._renderingManager.reset(),this._processedMaterials.reset(),this._activeParticleSystems.reset(),this._activeSkeletons.reset(),this._softwareSkinnedMeshes.reset()));if(this._activeMeshesFrozen&&this._activeMeshes.length){if(!this._skipEvaluateActiveMeshesCompletely){const e=this._activeMeshes.length;for(let t=0;t<e;t++){this._activeMeshes.data[t].computeWorldMatrix()}}if(this._activeParticleSystems){const e=this._activeParticleSystems.length;for(let t=0;t<e;t++)this._activeParticleSystems.data[t].animate()}return void this._renderingManager.resetSprites()}if(!this.activeCamera)return;this.onBeforeActiveMeshesEvaluationObservable.notifyObservers(this),this.activeCamera._activeMeshes.reset(),this._activeMeshes.reset(),this._renderingManager.reset(),this._processedMaterials.reset(),this._activeParticleSystems.reset(),this._activeSkeletons.reset(),this._softwareSkinnedMeshes.reset(),this._materialsRenderTargets.reset();for(const s of this._beforeEvaluateActiveMeshStage)s.action();const t=this.getActiveMeshCandidates(),i=t.length;for(let s=0;s<i;s++){const e=t.data[s];if(e._internalAbstractMeshDataInfo._currentLODIsUpToDate=!1,e.isBlocked)continue;if(this._totalVertices.addCount(e.getTotalVertices(),!1),!e.isReady()||!e.isEnabled()||e.scaling.hasAZeroComponent)continue;e.computeWorldMatrix(),e.actionManager&&e.actionManager.hasSpecificTriggers2(12,13)&&this._meshesForIntersections.pushNoDuplicate(e);let i=this.customLODSelector?this.customLODSelector(e,this.activeCamera):e.getLOD(this.activeCamera);if(e._internalAbstractMeshDataInfo._currentLOD=i,e._internalAbstractMeshDataInfo._currentLODIsUpToDate=!0,null!=i&&(i!==e&&0!==i.billboardMode&&i.computeWorldMatrix(),e._preActivate(),e.isVisible&&e.visibility>0&&0!=(e.layerMask&this.activeCamera.layerMask)&&(this._skipFrustumClipping||e.alwaysSelectAsActiveMesh||e.isInFrustum(this._frustumPlanes)))){this._activeMeshes.push(e),this.activeCamera._activeMeshes.push(e),i!==e&&i._activate(this._renderId,!1);for(const t of this._preActiveMeshStage)t.action(e);e._activate(this._renderId,!1)&&(e.isAnInstance?e._internalAbstractMeshDataInfo._actAsRegularMesh&&(i=e):i._internalAbstractMeshDataInfo._onlyForInstances=!1,i._internalAbstractMeshDataInfo._isActive=!0,this._activeMesh(e,i)),e._postActivate()}}if(this.particlesEnabled){this.onBeforeParticlesRenderingObservable.notifyObservers(this);for(let e=0;e<this.particleSystems.length;e++){const t=this.particleSystems[e];if(!t.isStarted()||!t.emitter)continue;const i=t.emitter;i.position&&!i.isEnabled()||(this._activeParticleSystems.push(t),t.animate(),this._renderingManager.dispatchParticles(t))}this.onAfterParticlesRenderingObservable.notifyObservers(this)}}_activeMesh(e,t){this._skeletonsEnabled&&null!==t.skeleton&&void 0!==t.skeleton&&(this._activeSkeletons.pushNoDuplicate(t.skeleton)&&(t.skeleton.prepare(),this._activeBones.addCount(t.skeleton.bones.length,!1)),t.computeBonesUsingShaders||this._softwareSkinnedMeshes.pushNoDuplicate(t));let i=e.hasInstances||e.isAnInstance||this.dispatchAllSubMeshesOfActiveMeshes||this._skipFrustumClipping||t.alwaysSelectAsActiveMesh;if(t&&t.subMeshes&&t.subMeshes.length>0){const s=this.getActiveSubMeshCandidates(t),n=s.length;i=i||1===n;for(let r=0;r<n;r++){const n=s.data[r];this._evaluateSubMesh(n,t,e,i)}}}updateTransformMatrix(e){if(this.activeCamera)if(this.activeCamera._renderingMultiview){const t=this.activeCamera._rigCameras[0],i=this.activeCamera._rigCameras[1];this.setTransformMatrix(t.getViewMatrix(),t.getProjectionMatrix(e),i.getViewMatrix(),i.getProjectionMatrix(e))}else this.setTransformMatrix(this.activeCamera.getViewMatrix(),this.activeCamera.getProjectionMatrix(e))}_bindFrameBuffer(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e&&e._multiviewTexture?e._multiviewTexture._bindFrameBuffer():e&&e.outputRenderTarget?e.outputRenderTarget._bindFrameBuffer():this._engine._currentFrameBufferIsDefaultFrameBuffer()||this._engine.restoreDefaultFramebuffer(),t&&this._clearFrameBuffer(e)}_clearFrameBuffer(e){if(e&&e._multiviewTexture);else if(e&&e.outputRenderTarget&&!e._renderingMultiview){const t=e.outputRenderTarget;t.onClearObservable.hasObservers()?t.onClearObservable.notifyObservers(this._engine):t.skipInitialClear||(this.autoClear&&this._engine.clear(t.clearColor||this.clearColor,!t._cleared,!0,!0),t._cleared=!0)}else this._defaultFrameBufferCleared?this._engine.clear(null,!1,!0,!0):(this._defaultFrameBufferCleared=!0,this._clear())}_renderForCamera(e,t){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];var n,r,a;if(e&&e._skipRendering)return;const o=this._engine;if(this._activeCamera=e,!this.activeCamera)throw new Error("Active camera not set");if(o.setViewport(this.activeCamera.viewport),this.resetCachedMaterial(),this._renderId++,!this.prePass&&i){let t=!0;e._renderingMultiview&&e.outputRenderTarget&&(t=e.outputRenderTarget.skipInitialClear,this.autoClear&&(this._defaultFrameBufferCleared=!1,e.outputRenderTarget.skipInitialClear=!1)),this._bindFrameBuffer(this._activeCamera),e._renderingMultiview&&e.outputRenderTarget&&(e.outputRenderTarget.skipInitialClear=t)}this.updateTransformMatrix(),this.onBeforeCameraRenderObservable.notifyObservers(this.activeCamera),this._evaluateActiveMeshes();for(let s=0;s<this._softwareSkinnedMeshes.length;s++){const e=this._softwareSkinnedMeshes.data[s];e.applySkeleton(e.skeleton)}this.onBeforeRenderTargetsRenderObservable.notifyObservers(this),this._renderTargets.concatWithNoDuplicate(this._materialsRenderTargets),e.customRenderTargets&&e.customRenderTargets.length>0&&this._renderTargets.concatWithNoDuplicate(e.customRenderTargets),t&&t.customRenderTargets&&t.customRenderTargets.length>0&&this._renderTargets.concatWithNoDuplicate(t.customRenderTargets),this.environmentTexture&&this.environmentTexture.isRenderTarget&&this._renderTargets.pushNoDuplicate(this.environmentTexture);for(const s of this._gatherActiveCameraRenderTargetsStage)s.action(this._renderTargets);let l=!1;if(this.renderTargetsEnabled){if(this._intermediateRendering=!0,this._renderTargets.length>0){s.w1.StartPerformanceCounter("Render targets",this._renderTargets.length>0);for(let e=0;e<this._renderTargets.length;e++){const t=this._renderTargets.data[e];if(t._shouldRender()){this._renderId++;const e=t.activeCamera&&t.activeCamera!==this.activeCamera;t.render(e,this.dumpNextRenderTargets),l=!0}}s.w1.EndPerformanceCounter("Render targets",this._renderTargets.length>0),this._renderId++}for(const e of this._cameraDrawRenderTargetStage)l=e.action(this.activeCamera)||l;this._intermediateRendering=!1}this._engine.currentRenderPassId=null!==(a=null!==(r=null===(n=e.outputRenderTarget)||void 0===n?void 0:n.renderPassId)&&void 0!==r?r:e.renderPassId)&&void 0!==a?a:0,l&&!this.prePass&&this._bindFrameBuffer(this._activeCamera,!1),this.onAfterRenderTargetsRenderObservable.notifyObservers(this),!this.postProcessManager||e._multiviewTexture||this.prePass||this.postProcessManager._prepareFrame();for(const s of this._beforeCameraDrawStage)s.action(this.activeCamera);this.onBeforeDrawPhaseObservable.notifyObservers(this),o.snapshotRendering&&1===o.snapshotRenderingMode&&this.finalizeSceneUbo(),this._renderingManager.render(null,null,!0,!0),this.onAfterDrawPhaseObservable.notifyObservers(this);for(const s of this._afterCameraDrawStage)s.action(this.activeCamera);if(this.postProcessManager&&!e._multiviewTexture){const t=e.outputRenderTarget?e.outputRenderTarget.renderTarget:void 0;this.postProcessManager._finalizeFrame(e.isIntermediate,t)}for(const s of this._afterCameraPostProcessStage)s.action(this.activeCamera);this._renderTargets.reset(),this.onAfterCameraRenderObservable.notifyObservers(this.activeCamera)}_processSubCameras(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(0===e.cameraRigMode||e._renderingMultiview)return e._renderingMultiview&&!this._multiviewSceneUbo&&this._createMultiviewUbo(),this._renderForCamera(e,void 0,t),void this.onAfterRenderCameraObservable.notifyObservers(e);if(e._useMultiviewToSingleView)this._renderMultiviewToSingleView(e);else{this.onBeforeCameraRenderObservable.notifyObservers(e);for(let t=0;t<e._rigCameras.length;t++)this._renderForCamera(e._rigCameras[t],e)}this._activeCamera=e,this.updateTransformMatrix(),this.onAfterRenderCameraObservable.notifyObservers(e)}_checkIntersections(){for(let e=0;e<this._meshesForIntersections.length;e++){const t=this._meshesForIntersections.data[e];if(t.actionManager)for(let e=0;t.actionManager&&e<t.actionManager.actions.length;e++){const i=t.actionManager.actions[e];if(12===i.trigger||13===i.trigger){const e=i.getTriggerParameter(),s=e.mesh?e.mesh:e,n=s.intersectsMesh(t,e.usePreciseIntersection),r=t._intersectionsInProgress.indexOf(s);n&&-1===r?12===i.trigger?(i._executeCurrent(p.CreateNew(t,void 0,s)),t._intersectionsInProgress.push(s)):13===i.trigger&&t._intersectionsInProgress.push(s):!n&&r>-1&&(13===i.trigger&&i._executeCurrent(p.CreateNew(t,void 0,s)),t.actionManager.hasSpecificTrigger(13,(e=>{const t=e.mesh?e.mesh:e;return s===t}))&&13!==i.trigger||t._intersectionsInProgress.splice(r,1))}}}}_advancePhysicsEngineStep(e){}_animate(){}animate(){if(this._engine.isDeterministicLockStep()){let e=Math.max($.MinDeltaTime,Math.min(this._engine.getDeltaTime(),$.MaxDeltaTime))+this._timeAccumulator;const t=this._engine.getTimeStep(),i=1e3/t/1e3;let s=0;const n=this._engine.getLockstepMaxSteps();let r=Math.floor(e/t);for(r=Math.min(r,n);e>0&&s<r;)this.onBeforeStepObservable.notifyObservers(this),this._animationRatio=t*i,this._animate(),this.onAfterAnimationsObservable.notifyObservers(this),this.physicsEnabled&&this._advancePhysicsEngineStep(t),this.onAfterStepObservable.notifyObservers(this),this._currentStepId++,s++,e-=t;this._timeAccumulator=e<0?0:e}else{const e=this.useConstantAnimationDeltaTime?16:Math.max($.MinDeltaTime,Math.min(this._engine.getDeltaTime(),$.MaxDeltaTime));this._animationRatio=.06*e,this._animate(),this.onAfterAnimationsObservable.notifyObservers(this),this.physicsEnabled&&this._advancePhysicsEngineStep(e)}}_clear(){(this.autoClearDepthAndStencil||this.autoClear)&&this._engine.clear(this.clearColor,this.autoClear||this.forceWireframe||this.forcePointsCloud,this.autoClearDepthAndStencil,this.autoClearDepthAndStencil)}_checkCameraRenderTarget(e){var t;if((null==e?void 0:e.outputRenderTarget)&&!(null==e?void 0:e.isRigCamera)&&(e.outputRenderTarget._cleared=!1),null===(t=null==e?void 0:e.rigCameras)||void 0===t?void 0:t.length)for(let i=0;i<e.rigCameras.length;++i){const t=e.rigCameras[i].outputRenderTarget;t&&(t._cleared=!1)}}resetDrawCache(e){if(this.meshes)for(const t of this.meshes)t.resetDrawCache(e)}render(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];var i,n,r;if(this.isDisposed)return;this.onReadyObservable.hasObservers()&&null===this._executeWhenReadyTimeoutId&&this._checkIsReady(),this._frameId++,this._defaultFrameBufferCleared=!1,this._checkCameraRenderTarget(this.activeCamera),(null===(i=this.activeCameras)||void 0===i?void 0:i.length)&&this.activeCameras.forEach(this._checkCameraRenderTarget),this._registerTransientComponents(),this._activeParticles.fetchNewFrame(),this._totalVertices.fetchNewFrame(),this._activeIndices.fetchNewFrame(),this._activeBones.fetchNewFrame(),this._meshesForIntersections.reset(),this.resetCachedMaterial(),this.onBeforeAnimationsObservable.notifyObservers(this),this.actionManager&&this.actionManager.processTrigger(11),t||this.animate();for(const s of this._beforeCameraUpdateStage)s.action();if(e)if(this.activeCameras&&this.activeCameras.length>0)for(let s=0;s<this.activeCameras.length;s++){const e=this.activeCameras[s];if(e.update(),0!==e.cameraRigMode)for(let t=0;t<e._rigCameras.length;t++)e._rigCameras[t].update()}else if(this.activeCamera&&(this.activeCamera.update(),0!==this.activeCamera.cameraRigMode))for(let s=0;s<this.activeCamera._rigCameras.length;s++)this.activeCamera._rigCameras[s].update();this.onBeforeRenderObservable.notifyObservers(this);const a=this.getEngine();this.onBeforeRenderTargetsRenderObservable.notifyObservers(this);const o=(null===(n=this.activeCameras)||void 0===n?void 0:n.length)?this.activeCameras[0]:this.activeCamera;if(this.renderTargetsEnabled){s.w1.StartPerformanceCounter("Custom render targets",this.customRenderTargets.length>0),this._intermediateRendering=!0;for(let e=0;e<this.customRenderTargets.length;e++){const t=this.customRenderTargets[e];if(t._shouldRender()){if(this._renderId++,this.activeCamera=t.activeCamera||this.activeCamera,!this.activeCamera)throw new Error("Active camera not set");a.setViewport(this.activeCamera.viewport),this.updateTransformMatrix(),t.render(o!==this.activeCamera,this.dumpNextRenderTargets)}}s.w1.EndPerformanceCounter("Custom render targets",this.customRenderTargets.length>0),this._intermediateRendering=!1,this._renderId++}this._engine.currentRenderPassId=null!==(r=null==o?void 0:o.renderPassId)&&void 0!==r?r:0,this.activeCamera=o,this._activeCamera&&22!==this._activeCamera.cameraRigMode&&!this.prePass&&this._bindFrameBuffer(this._activeCamera,!1),this.onAfterRenderTargetsRenderObservable.notifyObservers(this);for(const s of this._beforeClearStage)s.action();this._clearFrameBuffer(this.activeCamera);for(const s of this._gatherRenderTargetsStage)s.action(this._renderTargets);if(this.activeCameras&&this.activeCameras.length>0)for(let s=0;s<this.activeCameras.length;s++)this._processSubCameras(this.activeCameras[s],s>0);else{if(!this.activeCamera)throw new Error("No camera defined");this._processSubCameras(this.activeCamera,!!this.activeCamera.outputRenderTarget)}this._checkIntersections();for(const s of this._afterRenderStage)s.action();if(this.afterRender&&this.afterRender(),this.onAfterRenderObservable.notifyObservers(this),this._toBeDisposed.length){for(let e=0;e<this._toBeDisposed.length;e++){const t=this._toBeDisposed[e];t&&t.dispose()}this._toBeDisposed.length=0}this.dumpNextRenderTargets&&(this.dumpNextRenderTargets=!1),this._activeBones.addCount(0,!0),this._activeIndices.addCount(0,!0),this._activeParticles.addCount(0,!0),this._engine.restoreDefaultFramebuffer()}freezeMaterials(){for(let e=0;e<this.materials.length;e++)this.materials[e].freeze()}unfreezeMaterials(){for(let e=0;e<this.materials.length;e++)this.materials[e].unfreeze()}dispose(){if(this.isDisposed)return;this.beforeRender=null,this.afterRender=null,this.metadata=null,this.skeletons.length=0,this.morphTargetManagers.length=0,this._transientComponents.length=0,this._isReadyForMeshStage.clear(),this._beforeEvaluateActiveMeshStage.clear(),this._evaluateSubMeshStage.clear(),this._preActiveMeshStage.clear(),this._cameraDrawRenderTargetStage.clear(),this._beforeCameraDrawStage.clear(),this._beforeRenderTargetDrawStage.clear(),this._beforeRenderingGroupDrawStage.clear(),this._beforeRenderingMeshStage.clear(),this._afterRenderingMeshStage.clear(),this._afterRenderingGroupDrawStage.clear(),this._afterCameraDrawStage.clear(),this._afterRenderTargetDrawStage.clear(),this._afterRenderStage.clear(),this._beforeCameraUpdateStage.clear(),this._beforeClearStage.clear(),this._gatherRenderTargetsStage.clear(),this._gatherActiveCameraRenderTargetsStage.clear(),this._pointerMoveStage.clear(),this._pointerDownStage.clear(),this._pointerUpStage.clear(),this.importedMeshesFiles=new Array,this.stopAllAnimations&&this.stopAllAnimations(),this.resetCachedMaterial(),this.activeCamera&&(this.activeCamera._activeMeshes.dispose(),this.activeCamera=null),this.activeCameras=null,this._activeMeshes.dispose(),this._renderingManager.dispose(),this._processedMaterials.dispose(),this._activeParticleSystems.dispose(),this._activeSkeletons.dispose(),this._softwareSkinnedMeshes.dispose(),this._renderTargets.dispose(),this._materialsRenderTargets.dispose(),this._registeredForLateAnimationBindings.dispose(),this._meshesForIntersections.dispose(),this._toBeDisposed.length=0;const e=this._activeRequests.slice();for(const n of e)n.abort();this._activeRequests.length=0;try{this.onDisposeObservable.notifyObservers(this)}catch(s){console.error("An error occurred while calling onDisposeObservable!",s)}this.detachControl();if(this._engine.getInputElement())for(let n=0;n<this.cameras.length;n++)this.cameras[n].detachControl();this._disposeList(this.animationGroups),this._disposeList(this.lights),this._disposeList(this.meshes,(e=>e.dispose(!0))),this._disposeList(this.transformNodes,(e=>e.dispose(!0)));const t=this.cameras;this._disposeList(t),this._defaultMaterial&&this._defaultMaterial.dispose(),this._disposeList(this.multiMaterials),this._disposeList(this.materials),this._disposeList(this.particleSystems),this._disposeList(this.postProcesses),this._disposeList(this.textures),this._disposeList(this.morphTargetManagers),this._sceneUbo.dispose(),this._multiviewSceneUbo&&this._multiviewSceneUbo.dispose(),this.postProcessManager.dispose(),this._disposeList(this._components);let i=this._engine.scenes.indexOf(this);i>-1&&this._engine.scenes.splice(i,1),M.l._LastCreatedScene===this&&(this._engine.scenes.length>0?M.l._LastCreatedScene=this._engine.scenes[this._engine.scenes.length-1]:M.l._LastCreatedScene=null),i=this._engine._virtualScenes.indexOf(this),i>-1&&this._engine._virtualScenes.splice(i,1),this._engine.wipeCaches(!0),this.onDisposeObservable.clear(),this.onBeforeRenderObservable.clear(),this.onAfterRenderObservable.clear(),this.onBeforeRenderTargetsRenderObservable.clear(),this.onAfterRenderTargetsRenderObservable.clear(),this.onAfterStepObservable.clear(),this.onBeforeStepObservable.clear(),this.onBeforeActiveMeshesEvaluationObservable.clear(),this.onAfterActiveMeshesEvaluationObservable.clear(),this.onBeforeParticlesRenderingObservable.clear(),this.onAfterParticlesRenderingObservable.clear(),this.onBeforeDrawPhaseObservable.clear(),this.onAfterDrawPhaseObservable.clear(),this.onBeforeAnimationsObservable.clear(),this.onAfterAnimationsObservable.clear(),this.onDataLoadedObservable.clear(),this.onBeforeRenderingGroupObservable.clear(),this.onAfterRenderingGroupObservable.clear(),this.onMeshImportedObservable.clear(),this.onBeforeCameraRenderObservable.clear(),this.onAfterCameraRenderObservable.clear(),this.onAfterRenderCameraObservable.clear(),this.onReadyObservable.clear(),this.onNewCameraAddedObservable.clear(),this.onCameraRemovedObservable.clear(),this.onNewLightAddedObservable.clear(),this.onLightRemovedObservable.clear(),this.onNewGeometryAddedObservable.clear(),this.onGeometryRemovedObservable.clear(),this.onNewTransformNodeAddedObservable.clear(),this.onTransformNodeRemovedObservable.clear(),this.onNewMeshAddedObservable.clear(),this.onMeshRemovedObservable.clear(),this.onNewSkeletonAddedObservable.clear(),this.onSkeletonRemovedObservable.clear(),this.onNewMaterialAddedObservable.clear(),this.onNewMultiMaterialAddedObservable.clear(),this.onMaterialRemovedObservable.clear(),this.onMultiMaterialRemovedObservable.clear(),this.onNewTextureAddedObservable.clear(),this.onTextureRemovedObservable.clear(),this.onPrePointerObservable.clear(),this.onPointerObservable.clear(),this.onPreKeyboardObservable.clear(),this.onKeyboardObservable.clear(),this.onActiveCameraChanged.clear(),this.onScenePerformancePriorityChangedObservable.clear(),this._isDisposed=!0}_disposeList(e,t){const i=e.slice(0);t=null!=t?t:e=>e.dispose();for(const s of i)t(s);e.length=0}get isDisposed(){return this._isDisposed}clearCachedVertexData(){for(let e=0;e<this.meshes.length;e++){const t=this.meshes[e].geometry;t&&t.clearCachedData()}}cleanCachedTextureBuffer(){for(const e of this.textures){e._buffer&&(e._buffer=null)}}getWorldExtends(e){const t=new h.P(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),i=new h.P(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);return e=e||(()=>!0),this.meshes.filter(e).forEach((e=>{if(e.computeWorldMatrix(!0),!e.subMeshes||0===e.subMeshes.length||e.infiniteDistance)return;const s=e.getBoundingInfo(),n=s.boundingBox.minimumWorld,r=s.boundingBox.maximumWorld;h.P.CheckExtends(n,t,i),h.P.CheckExtends(r,t,i)})),{min:t,max:i}}createPickingRay(e,t,i,s){throw(0,T.S)("Ray")}createPickingRayToRef(e,t,i,s,n){throw(0,T.S)("Ray")}createPickingRayInCameraSpace(e,t,i){throw(0,T.S)("Ray")}createPickingRayInCameraSpaceToRef(e,t,i,s){throw(0,T.S)("Ray")}get _pickingAvailable(){return!1}pick(e,t,i,s,n,r){return new f.p}pickWithBoundingInfo(e,t,i,s,n){return new f.p}pickWithRay(e,t,i,s){throw(0,T.S)("Ray")}multiPick(e,t,i,s,n){throw(0,T.S)("Ray")}multiPickWithRay(e,t,i){throw(0,T.S)("Ray")}setPointerOverMesh(e,t,i){this._inputManager.setPointerOverMesh(e,t,i)}getPointerOverMesh(){return this._inputManager.getPointerOverMesh()}_rebuildGeometries(){for(const e of this.geometries)e._rebuild();for(const e of this.meshes)e._rebuild();this.postProcessManager&&this.postProcessManager._rebuild();for(const e of this._components)e.rebuild();for(const e of this.particleSystems)e.rebuild();if(this.spriteManagers)for(const e of this.spriteManagers)e.rebuild()}_rebuildTextures(){for(const e of this.textures)e._rebuild();this.markAllMaterialsAsDirty(1)}_getByTags(e,t,i){if(void 0===t)return e;const s=[];i=i||(e=>{});for(const n in e){const r=e[n];l.$&&l.$.MatchesQuery(r,t)&&(s.push(r),i(r))}return s}getMeshesByTags(e,t){return this._getByTags(this.meshes,e,t)}getCamerasByTags(e,t){return this._getByTags(this.cameras,e,t)}getLightsByTags(e,t){return this._getByTags(this.lights,e,t)}getMaterialByTags(e,t){return this._getByTags(this.materials,e,t).concat(this._getByTags(this.multiMaterials,e,t))}getTransformNodesByTags(e,t){return this._getByTags(this.transformNodes,e,t)}setRenderingOrder(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this._renderingManager.setRenderingOrder(e,t,i,s)}setRenderingAutoClearDepthStencil(e,t){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],s=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];this._renderingManager.setRenderingAutoClearDepthStencil(e,t,i,s)}getAutoClearDepthStencilSetup(e){return this._renderingManager.getAutoClearDepthStencilSetup(e)}get blockMaterialDirtyMechanism(){return this._blockMaterialDirtyMechanism}set blockMaterialDirtyMechanism(e){this._blockMaterialDirtyMechanism!==e&&(this._blockMaterialDirtyMechanism=e,e||this.markAllMaterialsAsDirty(63))}markAllMaterialsAsDirty(e,t){if(!this._blockMaterialDirtyMechanism)for(const i of this.materials)t&&!t(i)||i.markAsDirty(e)}_loadFile(e,t,i,s,n,r,a){const o=(0,K.vP)(e,t,i,s?this.offlineProvider:void 0,n,r,a);return this._activeRequests.push(o),o.onCompleteObservable.add((e=>{this._activeRequests.splice(this._activeRequests.indexOf(e),1)})),o}_loadFileAsync(e,t,i,s,n){return new Promise(((r,a)=>{this._loadFile(e,(e=>{r(e)}),t,i,s,((e,t)=>{a(t)}),n)}))}_requestFile(e,t,i,s,n,r,a){const o=(0,K.FV)(e,t,i,s?this.offlineProvider:void 0,n,r,a);return this._activeRequests.push(o),o.onCompleteObservable.add((e=>{this._activeRequests.splice(this._activeRequests.indexOf(e),1)})),o}_requestFileAsync(e,t,i,s,n){return new Promise(((r,a)=>{this._requestFile(e,(e=>{r(e)}),t,i,s,(e=>{a(e)}),n)}))}_readFile(e,t,i,s,n){const r=(0,K.Ip)(e,t,i,s,n);return this._activeRequests.push(r),r.onCompleteObservable.add((e=>{this._activeRequests.splice(this._activeRequests.indexOf(e),1)})),r}_readFileAsync(e,t,i){return new Promise(((s,n)=>{this._readFile(e,(e=>{s(e)}),t,i,(e=>{n(e)}))}))}getPerfCollector(){throw(0,T.S)("performanceViewerSceneExtension")}}$.FOGMODE_NONE=0,$.FOGMODE_EXP=1,$.FOGMODE_EXP2=2,$.FOGMODE_LINEAR=3,$.MinDeltaTime=1,$.MaxDeltaTime=1e3,$.prototype.setActiveCameraByID=function(e){return this.setActiveCameraById(e)},$.prototype.getLastMaterialByID=function(e){return this.getLastMaterialById(e)},$.prototype.getMaterialByID=function(e){return this.getMaterialById(e)},$.prototype.getTextureByUniqueID=function(e){return this.getTextureByUniqueId(e)},$.prototype.getCameraByID=function(e){return this.getCameraById(e)},$.prototype.getCameraByUniqueID=function(e){return this.getCameraByUniqueId(e)},$.prototype.getBoneByID=function(e){return this.getBoneById(e)},$.prototype.getLightByID=function(e){return this.getLightById(e)},$.prototype.getLightByUniqueID=function(e){return this.getLightByUniqueId(e)},$.prototype.getParticleSystemByID=function(e){return this.getParticleSystemById(e)},$.prototype.getGeometryByID=function(e){return this.getGeometryById(e)},$.prototype.getMeshByID=function(e){return this.getMeshById(e)},$.prototype.getMeshesByID=function(e){return this.getMeshesById(e)},$.prototype.getTransformNodeByID=function(e){return this.getTransformNodeById(e)},$.prototype.getTransformNodeByUniqueID=function(e){return this.getTransformNodeByUniqueId(e)},$.prototype.getTransformNodesByID=function(e){return this.getTransformNodesById(e)},$.prototype.getMeshByUniqueID=function(e){return this.getMeshByUniqueId(e)},$.prototype.getLastMeshByID=function(e){return this.getLastMeshById(e)},$.prototype.getLastEntryByID=function(e){return this.getLastEntryById(e)},$.prototype.getNodeByID=function(e){return this.getNodeById(e)},$.prototype.getLastSkeletonByID=function(e){return this.getLastSkeletonById(e)}},3767:function(e,t,i){"use strict";i.d(t,{H:function(){return n},l:function(){return s}});class s{}s.NAME_EFFECTLAYER="EffectLayer",s.NAME_LAYER="Layer",s.NAME_LENSFLARESYSTEM="LensFlareSystem",s.NAME_BOUNDINGBOXRENDERER="BoundingBoxRenderer",s.NAME_PARTICLESYSTEM="ParticleSystem",s.NAME_GAMEPAD="Gamepad",s.NAME_SIMPLIFICATIONQUEUE="SimplificationQueue",s.NAME_GEOMETRYBUFFERRENDERER="GeometryBufferRenderer",s.NAME_PREPASSRENDERER="PrePassRenderer",s.NAME_DEPTHRENDERER="DepthRenderer",s.NAME_DEPTHPEELINGRENDERER="DepthPeelingRenderer",s.NAME_POSTPROCESSRENDERPIPELINEMANAGER="PostProcessRenderPipelineManager",s.NAME_SPRITE="Sprite",s.NAME_SUBSURFACE="SubSurface",s.NAME_OUTLINERENDERER="Outline",s.NAME_PROCEDURALTEXTURE="ProceduralTexture",s.NAME_SHADOWGENERATOR="ShadowGenerator",s.NAME_OCTREE="Octree",s.NAME_PHYSICSENGINE="PhysicsEngine",s.NAME_AUDIO="Audio",s.NAME_FLUIDRENDERER="FluidRenderer",s.STEP_ISREADYFORMESH_EFFECTLAYER=0,s.STEP_BEFOREEVALUATEACTIVEMESH_BOUNDINGBOXRENDERER=0,s.STEP_EVALUATESUBMESH_BOUNDINGBOXRENDERER=0,s.STEP_PREACTIVEMESH_BOUNDINGBOXRENDERER=0,s.STEP_CAMERADRAWRENDERTARGET_EFFECTLAYER=1,s.STEP_BEFORECAMERADRAW_PREPASS=0,s.STEP_BEFORECAMERADRAW_EFFECTLAYER=1,s.STEP_BEFORECAMERADRAW_LAYER=2,s.STEP_BEFORERENDERTARGETDRAW_PREPASS=0,s.STEP_BEFORERENDERTARGETDRAW_LAYER=1,s.STEP_BEFORERENDERINGMESH_PREPASS=0,s.STEP_BEFORERENDERINGMESH_OUTLINE=1,s.STEP_AFTERRENDERINGMESH_PREPASS=0,s.STEP_AFTERRENDERINGMESH_OUTLINE=1,s.STEP_AFTERRENDERINGGROUPDRAW_EFFECTLAYER_DRAW=0,s.STEP_AFTERRENDERINGGROUPDRAW_BOUNDINGBOXRENDERER=1,s.STEP_BEFORECAMERAUPDATE_SIMPLIFICATIONQUEUE=0,s.STEP_BEFORECAMERAUPDATE_GAMEPAD=1,s.STEP_BEFORECLEAR_PROCEDURALTEXTURE=0,s.STEP_BEFORECLEAR_PREPASS=1,s.STEP_BEFORERENDERTARGETCLEAR_PREPASS=0,s.STEP_AFTERRENDERTARGETDRAW_PREPASS=0,s.STEP_AFTERRENDERTARGETDRAW_LAYER=1,s.STEP_AFTERCAMERADRAW_PREPASS=0,s.STEP_AFTERCAMERADRAW_EFFECTLAYER=1,s.STEP_AFTERCAMERADRAW_LENSFLARESYSTEM=2,s.STEP_AFTERCAMERADRAW_EFFECTLAYER_DRAW=3,s.STEP_AFTERCAMERADRAW_LAYER=4,s.STEP_AFTERCAMERADRAW_FLUIDRENDERER=5,s.STEP_AFTERCAMERAPOSTPROCESS_LAYER=0,s.STEP_AFTERRENDERTARGETPOSTPROCESS_LAYER=0,s.STEP_AFTERRENDER_AUDIO=0,s.STEP_GATHERRENDERTARGETS_DEPTHRENDERER=0,s.STEP_GATHERRENDERTARGETS_GEOMETRYBUFFERRENDERER=1,s.STEP_GATHERRENDERTARGETS_SHADOWGENERATOR=2,s.STEP_GATHERRENDERTARGETS_POSTPROCESSRENDERPIPELINEMANAGER=3,s.STEP_GATHERACTIVECAMERARENDERTARGETS_DEPTHRENDERER=0,s.STEP_GATHERACTIVECAMERARENDERTARGETS_FLUIDRENDERER=1,s.STEP_POINTERMOVE_SPRITE=0,s.STEP_POINTERDOWN_SPRITE=0,s.STEP_POINTERUP_SPRITE=0;class n extends Array{constructor(e){super(...e)}static Create(){return Object.create(n.prototype)}registerStep(e,t,i){let s=0,n=Number.MAX_VALUE;for(;s<this.length;s++){if(n=this[s].index,e<n)break}this.splice(s,0,{index:e,component:t,action:i.bind(t)})}clear(){this.length=0}}},9477:function(e,t,i){"use strict";i.d(t,{gn:function(){return s}});function s(e,t,i,s){var n,r=arguments.length,a=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(n=e[o])&&(a=(r<3?n(a):r>3?n(t,i,a):n(t,i))||a);return r>3&&a&&Object.defineProperty(t,i,a),a}Object.create;Object.create},5477:function(e,t,i){"use strict";i.d(t,{kG:function(){return s}});function s(e,t,i){if(void 0===i&&(i=Error),!e)throw new i(t)}},289:function(e,t,i){"use strict";function s(e,t){var i=t&&t.cache?t.cache:c,s=t&&t.serializer?t.serializer:l;return(t&&t.strategy?t.strategy:o)(e,{cache:i,serializer:s})}function n(e,t,i,s){var n,r=null==(n=s)||"number"==typeof n||"boolean"==typeof n?s:i(s),a=t.get(r);return void 0===a&&(a=e.call(this,s),t.set(r,a)),a}function r(e,t,i){var s=Array.prototype.slice.call(arguments,3),n=i(s),r=t.get(n);return void 0===r&&(r=e.apply(this,s),t.set(n,r)),r}function a(e,t,i,s,n){return i.bind(t,e,s,n)}function o(e,t){return a(e,this,1===e.length?n:r,t.cache.create(),t.serializer)}i.d(t,{A:function(){return u},H:function(){return s}});var l=function(){return JSON.stringify(arguments)};function h(){this.cache=Object.create(null)}h.prototype.get=function(e){return this.cache[e]},h.prototype.set=function(e,t){this.cache[e]=t};var c={create:function(){return new h}},u={variadic:function(e,t){return a(e,this,r,t.cache.create(),t.serializer)},monadic:function(e,t){return a(e,this,n,t.cache.create(),t.serializer)}}},7959:function(e,t,i){"use strict";i.d(t,{wD:function(){return n},VG:function(){return l},rp:function(){return c},Ii:function(){return _},O4:function(){return o},uf:function(){return h},Wh:function(){return m},Jo:function(){return f},yx:function(){return p},Wi:function(){return d},HI:function(){return g},pe:function(){return u},Qc:function(){return re}});var s,n,r,a=i(9900);function o(e){return e.type===n.literal}function l(e){return e.type===n.argument}function h(e){return e.type===n.number}function c(e){return e.type===n.date}function u(e){return e.type===n.time}function d(e){return e.type===n.select}function f(e){return e.type===n.plural}function p(e){return e.type===n.pound}function g(e){return e.type===n.tag}function m(e){return!(!e||"object"!=typeof e||e.type!==r.number)}function _(e){return!(!e||"object"!=typeof e||e.type!==r.dateTime)}!function(e){e[e.EXPECT_ARGUMENT_CLOSING_BRACE=1]="EXPECT_ARGUMENT_CLOSING_BRACE",e[e.EMPTY_ARGUMENT=2]="EMPTY_ARGUMENT",e[e.MALFORMED_ARGUMENT=3]="MALFORMED_ARGUMENT",e[e.EXPECT_ARGUMENT_TYPE=4]="EXPECT_ARGUMENT_TYPE",e[e.INVALID_ARGUMENT_TYPE=5]="INVALID_ARGUMENT_TYPE",e[e.EXPECT_ARGUMENT_STYLE=6]="EXPECT_ARGUMENT_STYLE",e[e.INVALID_NUMBER_SKELETON=7]="INVALID_NUMBER_SKELETON",e[e.INVALID_DATE_TIME_SKELETON=8]="INVALID_DATE_TIME_SKELETON",e[e.EXPECT_NUMBER_SKELETON=9]="EXPECT_NUMBER_SKELETON",e[e.EXPECT_DATE_TIME_SKELETON=10]="EXPECT_DATE_TIME_SKELETON",e[e.UNCLOSED_QUOTE_IN_ARGUMENT_STYLE=11]="UNCLOSED_QUOTE_IN_ARGUMENT_STYLE",e[e.EXPECT_SELECT_ARGUMENT_OPTIONS=12]="EXPECT_SELECT_ARGUMENT_OPTIONS",e[e.EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE=13]="EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE",e[e.INVALID_PLURAL_ARGUMENT_OFFSET_VALUE=14]="INVALID_PLURAL_ARGUMENT_OFFSET_VALUE",e[e.EXPECT_SELECT_ARGUMENT_SELECTOR=15]="EXPECT_SELECT_ARGUMENT_SELECTOR",e[e.EXPECT_PLURAL_ARGUMENT_SELECTOR=16]="EXPECT_PLURAL_ARGUMENT_SELECTOR",e[e.EXPECT_SELECT_ARGUMENT_SELECTOR_FRAGMENT=17]="EXPECT_SELECT_ARGUMENT_SELECTOR_FRAGMENT",e[e.EXPECT_PLURAL_ARGUMENT_SELECTOR_FRAGMENT=18]="EXPECT_PLURAL_ARGUMENT_SELECTOR_FRAGMENT",e[e.INVALID_PLURAL_ARGUMENT_SELECTOR=19]="INVALID_PLURAL_ARGUMENT_SELECTOR",e[e.DUPLICATE_PLURAL_ARGUMENT_SELECTOR=20]="DUPLICATE_PLURAL_ARGUMENT_SELECTOR",e[e.DUPLICATE_SELECT_ARGUMENT_SELECTOR=21]="DUPLICATE_SELECT_ARGUMENT_SELECTOR",e[e.MISSING_OTHER_CLAUSE=22]="MISSING_OTHER_CLAUSE",e[e.INVALID_TAG=23]="INVALID_TAG",e[e.INVALID_TAG_NAME=25]="INVALID_TAG_NAME",e[e.UNMATCHED_CLOSING_TAG=26]="UNMATCHED_CLOSING_TAG",e[e.UNCLOSED_TAG=27]="UNCLOSED_TAG"}(s||(s={})),function(e){e[e.literal=0]="literal",e[e.argument=1]="argument",e[e.number=2]="number",e[e.date=3]="date",e[e.time=4]="time",e[e.select=5]="select",e[e.plural=6]="plural",e[e.pound=7]="pound",e[e.tag=8]="tag"}(n||(n={})),function(e){e[e.number=0]="number",e[e.dateTime=1]="dateTime"}(r||(r={}));var v=/[ \xA0\u1680\u2000-\u200A\u202F\u205F\u3000]/,b=/(?:[Eec]{1,6}|G{1,5}|[Qq]{1,5}|(?:[yYur]+|U{1,5})|[ML]{1,5}|d{1,2}|D{1,3}|F{1}|[abB]{1,5}|[hkHK]{1,2}|w{1,2}|W{1}|m{1,2}|s{1,2}|[zZOvVxX]{1,4})(?=([^']*'[^']*')*[^']*$)/g;function E(e){var t={};return e.replace(b,(function(e){var i=e.length;switch(e[0]){case"G":t.era=4===i?"long":5===i?"narrow":"short";break;case"y":t.year=2===i?"2-digit":"numeric";break;case"Y":case"u":case"U":case"r":throw new RangeError("`Y/u/U/r` (year) patterns are not supported, use `y` instead");case"q":case"Q":throw new RangeError("`q/Q` (quarter) patterns are not supported");case"M":case"L":t.month=["numeric","2-digit","short","long","narrow"][i-1];break;case"w":case"W":throw new RangeError("`w/W` (week) patterns are not supported");case"d":t.day=["numeric","2-digit"][i-1];break;case"D":case"F":case"g":throw new RangeError("`D/F/g` (day) patterns are not supported, use `d` instead");case"E":t.weekday=4===i?"short":5===i?"narrow":"short";break;case"e":if(i<4)throw new RangeError("`e..eee` (weekday) patterns are not supported");t.weekday=["short","long","narrow","short"][i-4];break;case"c":if(i<4)throw new RangeError("`c..ccc` (weekday) patterns are not supported");t.weekday=["short","long","narrow","short"][i-4];break;case"a":t.hour12=!0;break;case"b":case"B":throw new RangeError("`b/B` (period) patterns are not supported, use `a` instead");case"h":t.hourCycle="h12",t.hour=["numeric","2-digit"][i-1];break;case"H":t.hourCycle="h23",t.hour=["numeric","2-digit"][i-1];break;case"K":t.hourCycle="h11",t.hour=["numeric","2-digit"][i-1];break;case"k":t.hourCycle="h24",t.hour=["numeric","2-digit"][i-1];break;case"j":case"J":case"C":throw new RangeError("`j/J/C` (hour) patterns are not supported, use `h/H/K/k` instead");case"m":t.minute=["numeric","2-digit"][i-1];break;case"s":t.second=["numeric","2-digit"][i-1];break;case"S":case"A":throw new RangeError("`S/A` (second) patterns are not supported, use `s` instead");case"z":t.timeZoneName=i<4?"short":"long";break;case"Z":case"O":case"v":case"V":case"X":case"x":throw new RangeError("`Z/O/v/V/X/x` (timeZone) patterns are not supported, use `z` instead")}return""})),t}var y=/[\t-\r \x85\u200E\u200F\u2028\u2029]/i;var M=/^\.(?:(0+)(\*)?|(#+)|(0+)(#+))$/g,T=/^(@+)?(\+|#+)?[rs]?$/g,A=/(\*)(0+)|(#+)(0+)|(0+)/g,S=/^(0+)$/;function I(e){var t={};return"r"===e[e.length-1]?t.roundingPriority="morePrecision":"s"===e[e.length-1]&&(t.roundingPriority="lessPrecision"),e.replace(T,(function(e,i,s){return"string"!=typeof s?(t.minimumSignificantDigits=i.length,t.maximumSignificantDigits=i.length):"+"===s?t.minimumSignificantDigits=i.length:"#"===i[0]?t.maximumSignificantDigits=i.length:(t.minimumSignificantDigits=i.length,t.maximumSignificantDigits=i.length+("string"==typeof s?s.length:0)),""})),t}function C(e){switch(e){case"sign-auto":return{signDisplay:"auto"};case"sign-accounting":case"()":return{currencySign:"accounting"};case"sign-always":case"+!":return{signDisplay:"always"};case"sign-accounting-always":case"()!":return{signDisplay:"always",currencySign:"accounting"};case"sign-except-zero":case"+?":return{signDisplay:"exceptZero"};case"sign-accounting-except-zero":case"()?":return{signDisplay:"exceptZero",currencySign:"accounting"};case"sign-never":case"+_":return{signDisplay:"never"}}}function D(e){var t;if("E"===e[0]&&"E"===e[1]?(t={notation:"engineering"},e=e.slice(2)):"E"===e[0]&&(t={notation:"scientific"},e=e.slice(1)),t){var i=e.slice(0,2);if("+!"===i?(t.signDisplay="always",e=e.slice(2)):"+?"===i&&(t.signDisplay="exceptZero",e=e.slice(2)),!S.test(e))throw new Error("Malformed concise eng/scientific notation");t.minimumIntegerDigits=e.length}return t}function P(e){var t=C(e);return t||{}}function x(e){for(var t={},i=0,s=e;i<s.length;i++){var n=s[i];switch(n.stem){case"percent":case"%":t.style="percent";continue;case"%x100":t.style="percent",t.scale=100;continue;case"currency":t.style="currency",t.currency=n.options[0];continue;case"group-off":case",_":t.useGrouping=!1;continue;case"precision-integer":case".":t.maximumFractionDigits=0;continue;case"measure-unit":case"unit":t.style="unit",t.unit=n.options[0].replace(/^(.*?)-/,"");continue;case"compact-short":case"K":t.notation="compact",t.compactDisplay="short";continue;case"compact-long":case"KK":t.notation="compact",t.compactDisplay="long";continue;case"scientific":t=(0,a.pi)((0,a.pi)((0,a.pi)({},t),{notation:"scientific"}),n.options.reduce((function(e,t){return(0,a.pi)((0,a.pi)({},e),P(t))}),{}));continue;case"engineering":t=(0,a.pi)((0,a.pi)((0,a.pi)({},t),{notation:"engineering"}),n.options.reduce((function(e,t){return(0,a.pi)((0,a.pi)({},e),P(t))}),{}));continue;case"notation-simple":t.notation="standard";continue;case"unit-width-narrow":t.currencyDisplay="narrowSymbol",t.unitDisplay="narrow";continue;case"unit-width-short":t.currencyDisplay="code",t.unitDisplay="short";continue;case"unit-width-full-name":t.currencyDisplay="name",t.unitDisplay="long";continue;case"unit-width-iso-code":t.currencyDisplay="symbol";continue;case"scale":t.scale=parseFloat(n.options[0]);continue;case"integer-width":if(n.options.length>1)throw new RangeError("integer-width stems only accept a single optional option");n.options[0].replace(A,(function(e,i,s,n,r,a){if(i)t.minimumIntegerDigits=s.length;else{if(n&&r)throw new Error("We currently do not support maximum integer digits");if(a)throw new Error("We currently do not support exact integer digits")}return""}));continue}if(S.test(n.stem))t.minimumIntegerDigits=n.stem.length;else if(M.test(n.stem)){if(n.options.length>1)throw new RangeError("Fraction-precision stems only accept a single optional option");n.stem.replace(M,(function(e,i,s,n,r,a){return"*"===s?t.minimumFractionDigits=i.length:n&&"#"===n[0]?t.maximumFractionDigits=n.length:r&&a?(t.minimumFractionDigits=r.length,t.maximumFractionDigits=r.length+a.length):(t.minimumFractionDigits=i.length,t.maximumFractionDigits=i.length),""}));var r=n.options[0];"w"===r?t=(0,a.pi)((0,a.pi)({},t),{trailingZeroDisplay:"stripIfInteger"}):r&&(t=(0,a.pi)((0,a.pi)({},t),I(r)))}else if(T.test(n.stem))t=(0,a.pi)((0,a.pi)({},t),I(n.stem));else{var o=C(n.stem);o&&(t=(0,a.pi)((0,a.pi)({},t),o));var l=D(n.stem);l&&(t=(0,a.pi)((0,a.pi)({},t),l))}}return t}var R,O={AX:["H"],BQ:["H"],CP:["H"],CZ:["H"],DK:["H"],FI:["H"],ID:["H"],IS:["H"],ML:["H"],NE:["H"],RU:["H"],SE:["H"],SJ:["H"],SK:["H"],AS:["h","H"],BT:["h","H"],DJ:["h","H"],ER:["h","H"],GH:["h","H"],IN:["h","H"],LS:["h","H"],PG:["h","H"],PW:["h","H"],SO:["h","H"],TO:["h","H"],VU:["h","H"],WS:["h","H"],"001":["H","h"],AL:["h","H","hB"],TD:["h","H","hB"],"ca-ES":["H","h","hB"],CF:["H","h","hB"],CM:["H","h","hB"],"fr-CA":["H","h","hB"],"gl-ES":["H","h","hB"],"it-CH":["H","h","hB"],"it-IT":["H","h","hB"],LU:["H","h","hB"],NP:["H","h","hB"],PF:["H","h","hB"],SC:["H","h","hB"],SM:["H","h","hB"],SN:["H","h","hB"],TF:["H","h","hB"],VA:["H","h","hB"],CY:["h","H","hb","hB"],GR:["h","H","hb","hB"],CO:["h","H","hB","hb"],DO:["h","H","hB","hb"],KP:["h","H","hB","hb"],KR:["h","H","hB","hb"],NA:["h","H","hB","hb"],PA:["h","H","hB","hb"],PR:["h","H","hB","hb"],VE:["h","H","hB","hb"],AC:["H","h","hb","hB"],AI:["H","h","hb","hB"],BW:["H","h","hb","hB"],BZ:["H","h","hb","hB"],CC:["H","h","hb","hB"],CK:["H","h","hb","hB"],CX:["H","h","hb","hB"],DG:["H","h","hb","hB"],FK:["H","h","hb","hB"],GB:["H","h","hb","hB"],GG:["H","h","hb","hB"],GI:["H","h","hb","hB"],IE:["H","h","hb","hB"],IM:["H","h","hb","hB"],IO:["H","h","hb","hB"],JE:["H","h","hb","hB"],LT:["H","h","hb","hB"],MK:["H","h","hb","hB"],MN:["H","h","hb","hB"],MS:["H","h","hb","hB"],NF:["H","h","hb","hB"],NG:["H","h","hb","hB"],NR:["H","h","hb","hB"],NU:["H","h","hb","hB"],PN:["H","h","hb","hB"],SH:["H","h","hb","hB"],SX:["H","h","hb","hB"],TA:["H","h","hb","hB"],ZA:["H","h","hb","hB"],"af-ZA":["H","h","hB","hb"],AR:["H","h","hB","hb"],CL:["H","h","hB","hb"],CR:["H","h","hB","hb"],CU:["H","h","hB","hb"],EA:["H","h","hB","hb"],"es-BO":["H","h","hB","hb"],"es-BR":["H","h","hB","hb"],"es-EC":["H","h","hB","hb"],"es-ES":["H","h","hB","hb"],"es-GQ":["H","h","hB","hb"],"es-PE":["H","h","hB","hb"],GT:["H","h","hB","hb"],HN:["H","h","hB","hb"],IC:["H","h","hB","hb"],KG:["H","h","hB","hb"],KM:["H","h","hB","hb"],LK:["H","h","hB","hb"],MA:["H","h","hB","hb"],MX:["H","h","hB","hb"],NI:["H","h","hB","hb"],PY:["H","h","hB","hb"],SV:["H","h","hB","hb"],UY:["H","h","hB","hb"],JP:["H","h","K"],AD:["H","hB"],AM:["H","hB"],AO:["H","hB"],AT:["H","hB"],AW:["H","hB"],BE:["H","hB"],BF:["H","hB"],BJ:["H","hB"],BL:["H","hB"],BR:["H","hB"],CG:["H","hB"],CI:["H","hB"],CV:["H","hB"],DE:["H","hB"],EE:["H","hB"],FR:["H","hB"],GA:["H","hB"],GF:["H","hB"],GN:["H","hB"],GP:["H","hB"],GW:["H","hB"],HR:["H","hB"],IL:["H","hB"],IT:["H","hB"],KZ:["H","hB"],MC:["H","hB"],MD:["H","hB"],MF:["H","hB"],MQ:["H","hB"],MZ:["H","hB"],NC:["H","hB"],NL:["H","hB"],PM:["H","hB"],PT:["H","hB"],RE:["H","hB"],RO:["H","hB"],SI:["H","hB"],SR:["H","hB"],ST:["H","hB"],TG:["H","hB"],TR:["H","hB"],WF:["H","hB"],YT:["H","hB"],BD:["h","hB","H"],PK:["h","hB","H"],AZ:["H","hB","h"],BA:["H","hB","h"],BG:["H","hB","h"],CH:["H","hB","h"],GE:["H","hB","h"],LI:["H","hB","h"],ME:["H","hB","h"],RS:["H","hB","h"],UA:["H","hB","h"],UZ:["H","hB","h"],XK:["H","hB","h"],AG:["h","hb","H","hB"],AU:["h","hb","H","hB"],BB:["h","hb","H","hB"],BM:["h","hb","H","hB"],BS:["h","hb","H","hB"],CA:["h","hb","H","hB"],DM:["h","hb","H","hB"],"en-001":["h","hb","H","hB"],FJ:["h","hb","H","hB"],FM:["h","hb","H","hB"],GD:["h","hb","H","hB"],GM:["h","hb","H","hB"],GU:["h","hb","H","hB"],GY:["h","hb","H","hB"],JM:["h","hb","H","hB"],KI:["h","hb","H","hB"],KN:["h","hb","H","hB"],KY:["h","hb","H","hB"],LC:["h","hb","H","hB"],LR:["h","hb","H","hB"],MH:["h","hb","H","hB"],MP:["h","hb","H","hB"],MW:["h","hb","H","hB"],NZ:["h","hb","H","hB"],SB:["h","hb","H","hB"],SG:["h","hb","H","hB"],SL:["h","hb","H","hB"],SS:["h","hb","H","hB"],SZ:["h","hb","H","hB"],TC:["h","hb","H","hB"],TT:["h","hb","H","hB"],UM:["h","hb","H","hB"],US:["h","hb","H","hB"],VC:["h","hb","H","hB"],VG:["h","hb","H","hB"],VI:["h","hb","H","hB"],ZM:["h","hb","H","hB"],BO:["H","hB","h","hb"],EC:["H","hB","h","hb"],ES:["H","hB","h","hb"],GQ:["H","hB","h","hb"],PE:["H","hB","h","hb"],AE:["h","hB","hb","H"],"ar-001":["h","hB","hb","H"],BH:["h","hB","hb","H"],DZ:["h","hB","hb","H"],EG:["h","hB","hb","H"],EH:["h","hB","hb","H"],HK:["h","hB","hb","H"],IQ:["h","hB","hb","H"],JO:["h","hB","hb","H"],KW:["h","hB","hb","H"],LB:["h","hB","hb","H"],LY:["h","hB","hb","H"],MO:["h","hB","hb","H"],MR:["h","hB","hb","H"],OM:["h","hB","hb","H"],PH:["h","hB","hb","H"],PS:["h","hB","hb","H"],QA:["h","hB","hb","H"],SA:["h","hB","hb","H"],SD:["h","hB","hb","H"],SY:["h","hB","hb","H"],TN:["h","hB","hb","H"],YE:["h","hB","hb","H"],AF:["H","hb","hB","h"],LA:["H","hb","hB","h"],CN:["H","hB","hb","h"],LV:["H","hB","hb","h"],TL:["H","hB","hb","h"],"zu-ZA":["H","hB","hb","h"],CD:["hB","H"],IR:["hB","H"],"hi-IN":["hB","h","H"],"kn-IN":["hB","h","H"],"ml-IN":["hB","h","H"],"te-IN":["hB","h","H"],KH:["hB","h","H","hb"],"ta-IN":["hB","h","hb","H"],BN:["hb","hB","h","H"],MY:["hb","hB","h","H"],ET:["hB","hb","h","H"],"gu-IN":["hB","hb","h","H"],"mr-IN":["hB","hb","h","H"],"pa-IN":["hB","hb","h","H"],TW:["hB","hb","h","H"],KE:["hB","hb","H","h"],MM:["hB","hb","H","h"],TZ:["hB","hb","H","h"],UG:["hB","hb","H","h"]};function N(e){var t=e.hourCycle;if(void 0===t&&e.hourCycles&&e.hourCycles.length&&(t=e.hourCycles[0]),t)switch(t){case"h24":return"k";case"h23":return"H";case"h12":return"h";case"h11":return"K";default:throw new Error("Invalid hourCycle")}var i,s=e.language;return"root"!==s&&(i=e.maximize().region),(O[i||""]||O[s||""]||O["".concat(s,"-001")]||O["001"])[0]}var w=new RegExp("^".concat(v.source,"*")),L=new RegExp("".concat(v.source,"*$"));function F(e,t){return{start:e,end:t}}var B=!!String.prototype.startsWith,U=!!String.fromCodePoint,k=!!Object.fromEntries,V=!!String.prototype.codePointAt,G=!!String.prototype.trimStart,W=!!String.prototype.trimEnd,z=!!Number.isSafeInteger?Number.isSafeInteger:function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e&&Math.abs(e)<=9007199254740991},H=!0;try{H="a"===(null===(R=$("([^\\p{White_Space}\\p{Pattern_Syntax}]*)","yu").exec("a"))||void 0===R?void 0:R[0])}catch(ae){H=!1}var X,j=B?function(e,t,i){return e.startsWith(t,i)}:function(e,t,i){return e.slice(i,i+t.length)===t},Y=U?String.fromCodePoint:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var i,s="",n=e.length,r=0;n>r;){if((i=e[r++])>1114111)throw RangeError(i+" is not a valid code point");s+=i<65536?String.fromCharCode(i):String.fromCharCode(55296+((i-=65536)>>10),i%1024+56320)}return s},q=k?Object.fromEntries:function(e){for(var t={},i=0,s=e;i<s.length;i++){var n=s[i],r=n[0],a=n[1];t[r]=a}return t},K=V?function(e,t){return e.codePointAt(t)}:function(e,t){var i=e.length;if(!(t<0||t>=i)){var s,n=e.charCodeAt(t);return n<55296||n>56319||t+1===i||(s=e.charCodeAt(t+1))<56320||s>57343?n:s-56320+(n-55296<<10)+65536}},Q=G?function(e){return e.trimStart()}:function(e){return e.replace(w,"")},Z=W?function(e){return e.trimEnd()}:function(e){return e.replace(L,"")};function $(e,t){return new RegExp(e,t)}if(H){var J=$("([^\\p{White_Space}\\p{Pattern_Syntax}]*)","yu");X=function(e,t){var i;return J.lastIndex=t,null!==(i=J.exec(e)[1])&&void 0!==i?i:""}}else X=function(e,t){for(var i=[];;){var s=K(e,t);if(void 0===s||ie(s)||se(s))break;i.push(s),t+=s>=65536?2:1}return Y.apply(void 0,i)};var ee=function(){function e(e,t){void 0===t&&(t={}),this.message=e,this.position={offset:0,line:1,column:1},this.ignoreTag=!!t.ignoreTag,this.locale=t.locale,this.requiresOtherClause=!!t.requiresOtherClause,this.shouldParseSkeletons=!!t.shouldParseSkeletons}return e.prototype.parse=function(){if(0!==this.offset())throw Error("parser can only be used once");return this.parseMessage(0,"",!1)},e.prototype.parseMessage=function(e,t,i){for(var r=[];!this.isEOF();){var a=this.char();if(123===a){if((o=this.parseArgument(e,i)).err)return o;r.push(o.val)}else{if(125===a&&e>0)break;if(35!==a||"plural"!==t&&"selectordinal"!==t){if(60===a&&!this.ignoreTag&&47===this.peek()){if(i)break;return this.error(s.UNMATCHED_CLOSING_TAG,F(this.clonePosition(),this.clonePosition()))}if(60===a&&!this.ignoreTag&&te(this.peek()||0)){if((o=this.parseTag(e,t)).err)return o;r.push(o.val)}else{var o;if((o=this.parseLiteral(e,t)).err)return o;r.push(o.val)}}else{var l=this.clonePosition();this.bump(),r.push({type:n.pound,location:F(l,this.clonePosition())})}}}return{val:r,err:null}},e.prototype.parseTag=function(e,t){var i=this.clonePosition();this.bump();var r=this.parseTagName();if(this.bumpSpace(),this.bumpIf("/>"))return{val:{type:n.literal,value:"<".concat(r,"/>"),location:F(i,this.clonePosition())},err:null};if(this.bumpIf(">")){var a=this.parseMessage(e+1,t,!0);if(a.err)return a;var o=a.val,l=this.clonePosition();if(this.bumpIf("</")){if(this.isEOF()||!te(this.char()))return this.error(s.INVALID_TAG,F(l,this.clonePosition()));var h=this.clonePosition();return r!==this.parseTagName()?this.error(s.UNMATCHED_CLOSING_TAG,F(h,this.clonePosition())):(this.bumpSpace(),this.bumpIf(">")?{val:{type:n.tag,value:r,children:o,location:F(i,this.clonePosition())},err:null}:this.error(s.INVALID_TAG,F(l,this.clonePosition())))}return this.error(s.UNCLOSED_TAG,F(i,this.clonePosition()))}return this.error(s.INVALID_TAG,F(i,this.clonePosition()))},e.prototype.parseTagName=function(){var e,t=this.offset();for(this.bump();!this.isEOF()&&(45===(e=this.char())||46===e||e>=48&&e<=57||95===e||e>=97&&e<=122||e>=65&&e<=90||183==e||e>=192&&e<=214||e>=216&&e<=246||e>=248&&e<=893||e>=895&&e<=8191||e>=8204&&e<=8205||e>=8255&&e<=8256||e>=8304&&e<=8591||e>=11264&&e<=12271||e>=12289&&e<=55295||e>=63744&&e<=64975||e>=65008&&e<=65533||e>=65536&&e<=983039);)this.bump();return this.message.slice(t,this.offset())},e.prototype.parseLiteral=function(e,t){for(var i=this.clonePosition(),s="";;){var r=this.tryParseQuote(t);if(r)s+=r;else{var a=this.tryParseUnquoted(e,t);if(a)s+=a;else{var o=this.tryParseLeftAngleBracket();if(!o)break;s+=o}}}var l=F(i,this.clonePosition());return{val:{type:n.literal,value:s,location:l},err:null}},e.prototype.tryParseLeftAngleBracket=function(){return this.isEOF()||60!==this.char()||!this.ignoreTag&&(te(e=this.peek()||0)||47===e)?null:(this.bump(),"<");var e},e.prototype.tryParseQuote=function(e){if(this.isEOF()||39!==this.char())return null;switch(this.peek()){case 39:return this.bump(),this.bump(),"'";case 123:case 60:case 62:case 125:break;case 35:if("plural"===e||"selectordinal"===e)break;return null;default:return null}this.bump();var t=[this.char()];for(this.bump();!this.isEOF();){var i=this.char();if(39===i){if(39!==this.peek()){this.bump();break}t.push(39),this.bump()}else t.push(i);this.bump()}return Y.apply(void 0,t)},e.prototype.tryParseUnquoted=function(e,t){if(this.isEOF())return null;var i=this.char();return 60===i||123===i||35===i&&("plural"===t||"selectordinal"===t)||125===i&&e>0?null:(this.bump(),Y(i))},e.prototype.parseArgument=function(e,t){var i=this.clonePosition();if(this.bump(),this.bumpSpace(),this.isEOF())return this.error(s.EXPECT_ARGUMENT_CLOSING_BRACE,F(i,this.clonePosition()));if(125===this.char())return this.bump(),this.error(s.EMPTY_ARGUMENT,F(i,this.clonePosition()));var r=this.parseIdentifierIfPossible().value;if(!r)return this.error(s.MALFORMED_ARGUMENT,F(i,this.clonePosition()));if(this.bumpSpace(),this.isEOF())return this.error(s.EXPECT_ARGUMENT_CLOSING_BRACE,F(i,this.clonePosition()));switch(this.char()){case 125:return this.bump(),{val:{type:n.argument,value:r,location:F(i,this.clonePosition())},err:null};case 44:return this.bump(),this.bumpSpace(),this.isEOF()?this.error(s.EXPECT_ARGUMENT_CLOSING_BRACE,F(i,this.clonePosition())):this.parseArgumentOptions(e,t,r,i);default:return this.error(s.MALFORMED_ARGUMENT,F(i,this.clonePosition()))}},e.prototype.parseIdentifierIfPossible=function(){var e=this.clonePosition(),t=this.offset(),i=X(this.message,t),s=t+i.length;return this.bumpTo(s),{value:i,location:F(e,this.clonePosition())}},e.prototype.parseArgumentOptions=function(e,t,i,o){var l,h=this.clonePosition(),c=this.parseIdentifierIfPossible().value,u=this.clonePosition();switch(c){case"":return this.error(s.EXPECT_ARGUMENT_TYPE,F(h,u));case"number":case"date":case"time":this.bumpSpace();var d=null;if(this.bumpIf(",")){this.bumpSpace();var f=this.clonePosition();if((M=this.parseSimpleArgStyleIfPossible()).err)return M;if(0===(_=Z(M.val)).length)return this.error(s.EXPECT_ARGUMENT_STYLE,F(this.clonePosition(),this.clonePosition()));d={style:_,styleLocation:F(f,this.clonePosition())}}if((T=this.tryParseArgumentClose(o)).err)return T;var p=F(o,this.clonePosition());if(d&&j(null==d?void 0:d.style,"::",0)){var g=Q(d.style.slice(2));if("number"===c)return(M=this.parseNumberSkeletonFromString(g,d.styleLocation)).err?M:{val:{type:n.number,value:i,location:p,style:M.val},err:null};if(0===g.length)return this.error(s.EXPECT_DATE_TIME_SKELETON,p);var m=g;this.locale&&(m=function(e,t){for(var i="",s=0;s<e.length;s++){var n=e.charAt(s);if("j"===n){for(var r=0;s+1<e.length&&e.charAt(s+1)===n;)r++,s++;var a=1+(1&r),o=r<2?1:3+(r>>1),l=N(t);for("H"!=l&&"k"!=l||(o=0);o-- >0;)i+="a";for(;a-- >0;)i=l+i}else i+="J"===n?"H":n}return i}(g,this.locale));var _={type:r.dateTime,pattern:m,location:d.styleLocation,parsedOptions:this.shouldParseSkeletons?E(m):{}};return{val:{type:"date"===c?n.date:n.time,value:i,location:p,style:_},err:null}}return{val:{type:"number"===c?n.number:"date"===c?n.date:n.time,value:i,location:p,style:null!==(l=null==d?void 0:d.style)&&void 0!==l?l:null},err:null};case"plural":case"selectordinal":case"select":var v=this.clonePosition();if(this.bumpSpace(),!this.bumpIf(","))return this.error(s.EXPECT_SELECT_ARGUMENT_OPTIONS,F(v,(0,a.pi)({},v)));this.bumpSpace();var b=this.parseIdentifierIfPossible(),y=0;if("select"!==c&&"offset"===b.value){if(!this.bumpIf(":"))return this.error(s.EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE,F(this.clonePosition(),this.clonePosition()));var M;if(this.bumpSpace(),(M=this.tryParseDecimalInteger(s.EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE,s.INVALID_PLURAL_ARGUMENT_OFFSET_VALUE)).err)return M;this.bumpSpace(),b=this.parseIdentifierIfPossible(),y=M.val}var T,A=this.tryParsePluralOrSelectOptions(e,c,t,b);if(A.err)return A;if((T=this.tryParseArgumentClose(o)).err)return T;var S=F(o,this.clonePosition());return"select"===c?{val:{type:n.select,value:i,options:q(A.val),location:S},err:null}:{val:{type:n.plural,value:i,options:q(A.val),offset:y,pluralType:"plural"===c?"cardinal":"ordinal",location:S},err:null};default:return this.error(s.INVALID_ARGUMENT_TYPE,F(h,u))}},e.prototype.tryParseArgumentClose=function(e){return this.isEOF()||125!==this.char()?this.error(s.EXPECT_ARGUMENT_CLOSING_BRACE,F(e,this.clonePosition())):(this.bump(),{val:!0,err:null})},e.prototype.parseSimpleArgStyleIfPossible=function(){for(var e=0,t=this.clonePosition();!this.isEOF();){switch(this.char()){case 39:this.bump();var i=this.clonePosition();if(!this.bumpUntil("'"))return this.error(s.UNCLOSED_QUOTE_IN_ARGUMENT_STYLE,F(i,this.clonePosition()));this.bump();break;case 123:e+=1,this.bump();break;case 125:if(!(e>0))return{val:this.message.slice(t.offset,this.offset()),err:null};e-=1;break;default:this.bump()}}return{val:this.message.slice(t.offset,this.offset()),err:null}},e.prototype.parseNumberSkeletonFromString=function(e,t){var i=[];try{i=function(e){if(0===e.length)throw new Error("Number skeleton cannot be empty");for(var t=[],i=0,s=e.split(y).filter((function(e){return e.length>0}));i<s.length;i++){var n=s[i].split("/");if(0===n.length)throw new Error("Invalid number skeleton");for(var r=n[0],a=n.slice(1),o=0,l=a;o<l.length;o++)if(0===l[o].length)throw new Error("Invalid number skeleton");t.push({stem:r,options:a})}return t}(e)}catch(n){return this.error(s.INVALID_NUMBER_SKELETON,t)}return{val:{type:r.number,tokens:i,location:t,parsedOptions:this.shouldParseSkeletons?x(i):{}},err:null}},e.prototype.tryParsePluralOrSelectOptions=function(e,t,i,n){for(var r,a=!1,o=[],l=new Set,h=n.value,c=n.location;;){if(0===h.length){var u=this.clonePosition();if("select"===t||!this.bumpIf("="))break;var d=this.tryParseDecimalInteger(s.EXPECT_PLURAL_ARGUMENT_SELECTOR,s.INVALID_PLURAL_ARGUMENT_SELECTOR);if(d.err)return d;c=F(u,this.clonePosition()),h=this.message.slice(u.offset,this.offset())}if(l.has(h))return this.error("select"===t?s.DUPLICATE_SELECT_ARGUMENT_SELECTOR:s.DUPLICATE_PLURAL_ARGUMENT_SELECTOR,c);"other"===h&&(a=!0),this.bumpSpace();var f=this.clonePosition();if(!this.bumpIf("{"))return this.error("select"===t?s.EXPECT_SELECT_ARGUMENT_SELECTOR_FRAGMENT:s.EXPECT_PLURAL_ARGUMENT_SELECTOR_FRAGMENT,F(this.clonePosition(),this.clonePosition()));var p=this.parseMessage(e+1,t,i);if(p.err)return p;var g=this.tryParseArgumentClose(f);if(g.err)return g;o.push([h,{value:p.val,location:F(f,this.clonePosition())}]),l.add(h),this.bumpSpace(),h=(r=this.parseIdentifierIfPossible()).value,c=r.location}return 0===o.length?this.error("select"===t?s.EXPECT_SELECT_ARGUMENT_SELECTOR:s.EXPECT_PLURAL_ARGUMENT_SELECTOR,F(this.clonePosition(),this.clonePosition())):this.requiresOtherClause&&!a?this.error(s.MISSING_OTHER_CLAUSE,F(this.clonePosition(),this.clonePosition())):{val:o,err:null}},e.prototype.tryParseDecimalInteger=function(e,t){var i=1,s=this.clonePosition();this.bumpIf("+")||this.bumpIf("-")&&(i=-1);for(var n=!1,r=0;!this.isEOF();){var a=this.char();if(!(a>=48&&a<=57))break;n=!0,r=10*r+(a-48),this.bump()}var o=F(s,this.clonePosition());return n?z(r*=i)?{val:r,err:null}:this.error(t,o):this.error(e,o)},e.prototype.offset=function(){return this.position.offset},e.prototype.isEOF=function(){return this.offset()===this.message.length},e.prototype.clonePosition=function(){return{offset:this.position.offset,line:this.position.line,column:this.position.column}},e.prototype.char=function(){var e=this.position.offset;if(e>=this.message.length)throw Error("out of bound");var t=K(this.message,e);if(void 0===t)throw Error("Offset ".concat(e," is at invalid UTF-16 code unit boundary"));return t},e.prototype.error=function(e,t){return{val:null,err:{kind:e,message:this.message,location:t}}},e.prototype.bump=function(){if(!this.isEOF()){var e=this.char();10===e?(this.position.line+=1,this.position.column=1,this.position.offset+=1):(this.position.column+=1,this.position.offset+=e<65536?1:2)}},e.prototype.bumpIf=function(e){if(j(this.message,e,this.offset())){for(var t=0;t<e.length;t++)this.bump();return!0}return!1},e.prototype.bumpUntil=function(e){var t=this.offset(),i=this.message.indexOf(e,t);return i>=0?(this.bumpTo(i),!0):(this.bumpTo(this.message.length),!1)},e.prototype.bumpTo=function(e){if(this.offset()>e)throw Error("targetOffset ".concat(e," must be greater than or equal to the current offset ").concat(this.offset()));for(e=Math.min(e,this.message.length);;){var t=this.offset();if(t===e)break;if(t>e)throw Error("targetOffset ".concat(e," is at invalid UTF-16 code unit boundary"));if(this.bump(),this.isEOF())break}},e.prototype.bumpSpace=function(){for(;!this.isEOF()&&ie(this.char());)this.bump()},e.prototype.peek=function(){if(this.isEOF())return null;var e=this.char(),t=this.offset(),i=this.message.charCodeAt(t+(e>=65536?2:1));return null!=i?i:null},e}();function te(e){return e>=97&&e<=122||e>=65&&e<=90}function ie(e){return e>=9&&e<=13||32===e||133===e||e>=8206&&e<=8207||8232===e||8233===e}function se(e){return e>=33&&e<=35||36===e||e>=37&&e<=39||40===e||41===e||42===e||43===e||44===e||45===e||e>=46&&e<=47||e>=58&&e<=59||e>=60&&e<=62||e>=63&&e<=64||91===e||92===e||93===e||94===e||96===e||123===e||124===e||125===e||126===e||161===e||e>=162&&e<=165||166===e||167===e||169===e||171===e||172===e||174===e||176===e||177===e||182===e||187===e||191===e||215===e||247===e||e>=8208&&e<=8213||e>=8214&&e<=8215||8216===e||8217===e||8218===e||e>=8219&&e<=8220||8221===e||8222===e||8223===e||e>=8224&&e<=8231||e>=8240&&e<=8248||8249===e||8250===e||e>=8251&&e<=8254||e>=8257&&e<=8259||8260===e||8261===e||8262===e||e>=8263&&e<=8273||8274===e||8275===e||e>=8277&&e<=8286||e>=8592&&e<=8596||e>=8597&&e<=8601||e>=8602&&e<=8603||e>=8604&&e<=8607||8608===e||e>=8609&&e<=8610||8611===e||e>=8612&&e<=8613||8614===e||e>=8615&&e<=8621||8622===e||e>=8623&&e<=8653||e>=8654&&e<=8655||e>=8656&&e<=8657||8658===e||8659===e||8660===e||e>=8661&&e<=8691||e>=8692&&e<=8959||e>=8960&&e<=8967||8968===e||8969===e||8970===e||8971===e||e>=8972&&e<=8991||e>=8992&&e<=8993||e>=8994&&e<=9e3||9001===e||9002===e||e>=9003&&e<=9083||9084===e||e>=9085&&e<=9114||e>=9115&&e<=9139||e>=9140&&e<=9179||e>=9180&&e<=9185||e>=9186&&e<=9254||e>=9255&&e<=9279||e>=9280&&e<=9290||e>=9291&&e<=9311||e>=9472&&e<=9654||9655===e||e>=9656&&e<=9664||9665===e||e>=9666&&e<=9719||e>=9720&&e<=9727||e>=9728&&e<=9838||9839===e||e>=9840&&e<=10087||10088===e||10089===e||10090===e||10091===e||10092===e||10093===e||10094===e||10095===e||10096===e||10097===e||10098===e||10099===e||10100===e||10101===e||e>=10132&&e<=10175||e>=10176&&e<=10180||10181===e||10182===e||e>=10183&&e<=10213||10214===e||10215===e||10216===e||10217===e||10218===e||10219===e||10220===e||10221===e||10222===e||10223===e||e>=10224&&e<=10239||e>=10240&&e<=10495||e>=10496&&e<=10626||10627===e||10628===e||10629===e||10630===e||10631===e||10632===e||10633===e||10634===e||10635===e||10636===e||10637===e||10638===e||10639===e||10640===e||10641===e||10642===e||10643===e||10644===e||10645===e||10646===e||10647===e||10648===e||e>=10649&&e<=10711||10712===e||10713===e||10714===e||10715===e||e>=10716&&e<=10747||10748===e||10749===e||e>=10750&&e<=11007||e>=11008&&e<=11055||e>=11056&&e<=11076||e>=11077&&e<=11078||e>=11079&&e<=11084||e>=11085&&e<=11123||e>=11124&&e<=11125||e>=11126&&e<=11157||11158===e||e>=11159&&e<=11263||e>=11776&&e<=11777||11778===e||11779===e||11780===e||11781===e||e>=11782&&e<=11784||11785===e||11786===e||11787===e||11788===e||11789===e||e>=11790&&e<=11798||11799===e||e>=11800&&e<=11801||11802===e||11803===e||11804===e||11805===e||e>=11806&&e<=11807||11808===e||11809===e||11810===e||11811===e||11812===e||11813===e||11814===e||11815===e||11816===e||11817===e||e>=11818&&e<=11822||11823===e||e>=11824&&e<=11833||e>=11834&&e<=11835||e>=11836&&e<=11839||11840===e||11841===e||11842===e||e>=11843&&e<=11855||e>=11856&&e<=11857||11858===e||e>=11859&&e<=11903||e>=12289&&e<=12291||12296===e||12297===e||12298===e||12299===e||12300===e||12301===e||12302===e||12303===e||12304===e||12305===e||e>=12306&&e<=12307||12308===e||12309===e||12310===e||12311===e||12312===e||12313===e||12314===e||12315===e||12316===e||12317===e||e>=12318&&e<=12319||12320===e||12336===e||64830===e||64831===e||e>=65093&&e<=65094}function ne(e){e.forEach((function(e){if(delete e.location,d(e)||f(e))for(var t in e.options)delete e.options[t].location,ne(e.options[t].value);else h(e)&&m(e.style)||(c(e)||u(e))&&_(e.style)?delete e.style.location:g(e)&&ne(e.children)}))}function re(e,t){void 0===t&&(t={}),t=(0,a.pi)({shouldParseSkeletons:!0,requiresOtherClause:!0},t);var i=new ee(e,t).parse();if(i.err){var n=SyntaxError(s[i.err.kind]);throw n.location=i.err.location,n.originalMessage=i.err.message,n}return(null==t?void 0:t.captureLocation)||ne(i.val),i.val}},4889:function(e,t,i){"use strict";i.d(t,{$6:function(){return u},OV:function(){return o},Qe:function(){return h},Rw:function(){return r},X9:function(){return c},bc:function(){return s},gb:function(){return l},wI:function(){return a}});var s,n=i(9900);!function(e){e.FORMAT_ERROR="FORMAT_ERROR",e.UNSUPPORTED_FORMATTER="UNSUPPORTED_FORMATTER",e.INVALID_CONFIG="INVALID_CONFIG",e.MISSING_DATA="MISSING_DATA",e.MISSING_TRANSLATION="MISSING_TRANSLATION"}(s||(s={}));var r=function(e){function t(i,s,n){var r=this,a=n?n instanceof Error?n:new Error(String(n)):void 0;return(r=e.call(this,"[@formatjs/intl Error ".concat(i,"] ").concat(s,"\n").concat(a?"\n".concat(a.message,"\n").concat(a.stack):""))||this).code=i,"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(r,t),r}return(0,n.ZT)(t,e),t}(Error),a=function(e){function t(t,i){return e.call(this,s.UNSUPPORTED_FORMATTER,t,i)||this}return(0,n.ZT)(t,e),t}(r),o=function(e){function t(t,i){return e.call(this,s.INVALID_CONFIG,t,i)||this}return(0,n.ZT)(t,e),t}(r),l=function(e){function t(t,i){return e.call(this,s.MISSING_DATA,t,i)||this}return(0,n.ZT)(t,e),t}(r),h=function(e){function t(t,i,n){return e.call(this,s.FORMAT_ERROR,"".concat(t,"\nLocale: ").concat(i,"\n"),n)||this}return(0,n.ZT)(t,e),t}(r),c=function(e){function t(t,i,s,n){var r=e.call(this,"".concat(t,"\nMessageID: ").concat(null==s?void 0:s.id,"\nDefault Message: ").concat(null==s?void 0:s.defaultMessage,"\nDescription: ").concat(null==s?void 0:s.description,"\n"),i,n)||this;return r.descriptor=s,r}return(0,n.ZT)(t,e),t}(h),u=function(e){function t(t,i){var n=e.call(this,s.MISSING_TRANSLATION,'Missing message: "'.concat(t.id,'" for locale "').concat(i,'", using ').concat(t.defaultMessage?"default message (".concat("string"==typeof t.defaultMessage?t.defaultMessage:t.defaultMessage.map((function(e){var t;return null!==(t=e.value)&&void 0!==t?t:JSON.stringify(e)})).join(),")"):"id"," as fallback."))||this;return n.descriptor=t,n}return(0,n.ZT)(t,e),t}(r)},7143:function(e,t,i){"use strict";i.d(t,{L6:function(){return o},Sn:function(){return h},TB:function(){return d},Z0:function(){return l},ax:function(){return u}});var s=i(9900),n=i(1482),r=i(289),a=i(4889);function o(e,t,i){return void 0===i&&(i={}),t.reduce((function(t,s){return s in e?t[s]=e[s]:s in i&&(t[s]=i[s]),t}),{})}var l={formats:{},messages:{},timeZone:void 0,defaultLocale:"en",defaultFormats:{},fallbackOnEmptyString:!0,onError:function(e){0},onWarn:function(e){0}};function h(){return{dateTime:{},number:{},message:{},relativeTime:{},pluralRules:{},list:{},displayNames:{}}}function c(e){return{create:function(){return{get:function(t){return e[t]},set:function(t,i){e[t]=i}}}}}function u(e){void 0===e&&(e={dateTime:{},number:{},message:{},relativeTime:{},pluralRules:{},list:{},displayNames:{}});var t=Intl.RelativeTimeFormat,i=Intl.ListFormat,a=Intl.DisplayNames,o=(0,r.H)((function(){for(var e,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return new((e=Intl.DateTimeFormat).bind.apply(e,(0,s.ev)([void 0],t,!1)))}),{cache:c(e.dateTime),strategy:r.A.variadic}),l=(0,r.H)((function(){for(var e,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return new((e=Intl.NumberFormat).bind.apply(e,(0,s.ev)([void 0],t,!1)))}),{cache:c(e.number),strategy:r.A.variadic}),h=(0,r.H)((function(){for(var e,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return new((e=Intl.PluralRules).bind.apply(e,(0,s.ev)([void 0],t,!1)))}),{cache:c(e.pluralRules),strategy:r.A.variadic});return{getDateTimeFormat:o,getNumberFormat:l,getMessageFormat:(0,r.H)((function(e,t,i,r){return new n.C(e,t,i,(0,s.pi)({formatters:{getNumberFormat:l,getDateTimeFormat:o,getPluralRules:h}},r||{}))}),{cache:c(e.message),strategy:r.A.variadic}),getRelativeTimeFormat:(0,r.H)((function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];return new(t.bind.apply(t,(0,s.ev)([void 0],e,!1)))}),{cache:c(e.relativeTime),strategy:r.A.variadic}),getPluralRules:h,getListFormat:(0,r.H)((function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new(i.bind.apply(i,(0,s.ev)([void 0],e,!1)))}),{cache:c(e.list),strategy:r.A.variadic}),getDisplayNames:(0,r.H)((function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new(a.bind.apply(a,(0,s.ev)([void 0],e,!1)))}),{cache:c(e.displayNames),strategy:r.A.variadic})}}function d(e,t,i,s){var n,r=e&&e[t];if(r&&(n=r[i]),n)return n;s(new a.wI("No ".concat(t," format named: ").concat(i)))}},5900:function(e,t){var i;!function(){"use strict";var s={}.hasOwnProperty;function n(){for(var e=[],t=0;t<arguments.length;t++){var i=arguments[t];if(i){var r=typeof i;if("string"===r||"number"===r)e.push(i);else if(Array.isArray(i)){if(i.length){var a=n.apply(null,i);a&&e.push(a)}}else if("object"===r){if(i.toString!==Object.prototype.toString&&!i.toString.toString().includes("[native code]")){e.push(i.toString());continue}for(var o in i)s.call(i,o)&&i[o]&&e.push(o)}}}return e.join(" ")}e.exports?(n.default=n,e.exports=n):void 0===(i=function(){return n}.apply(t,[]))||(e.exports=i)}()},5706:function(e,t,i){"use strict";var s=i(8812),n={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},r={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},a={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},o={};function l(e){return s.isMemo(e)?a:o[e.$$typeof]||n}o[s.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},o[s.Memo]=a;var h=Object.defineProperty,c=Object.getOwnPropertyNames,u=Object.getOwnPropertySymbols,d=Object.getOwnPropertyDescriptor,f=Object.getPrototypeOf,p=Object.prototype;e.exports=function e(t,i,s){if("string"!=typeof i){if(p){var n=f(i);n&&n!==p&&e(t,n,s)}var a=c(i);u&&(a=a.concat(u(i)));for(var o=l(t),g=l(i),m=0;m<a.length;++m){var _=a[m];if(!(r[_]||s&&s[_]||g&&g[_]||o&&o[_])){var v=d(i,_);try{h(t,_,v)}catch(b){}}}}return t}},1482:function(e,t,i){"use strict";i.d(t,{C:function(){return h}});var s=i(9900),n=i(7959),r=i(289),a=i(4597);function o(e,t){return t?Object.keys(e).reduce((function(i,n){var r,a;return i[n]=(r=e[n],(a=t[n])?(0,s.pi)((0,s.pi)((0,s.pi)({},r||{}),a||{}),Object.keys(r).reduce((function(e,t){return e[t]=(0,s.pi)((0,s.pi)({},r[t]),a[t]||{}),e}),{})):r),i}),(0,s.pi)({},e)):e}function l(e){return{create:function(){return{get:function(t){return e[t]},set:function(t,i){e[t]=i}}}}}var h=function(){function e(t,i,n,h){void 0===i&&(i=e.defaultLocale);var c,u=this;if(this.formatterCache={number:{},dateTime:{},pluralRules:{}},this.format=function(e){var t=u.formatToParts(e);if(1===t.length)return t[0].value;var i=t.reduce((function(e,t){return e.length&&t.type===a.du.literal&&"string"==typeof e[e.length-1]?e[e.length-1]+=t.value:e.push(t.value),e}),[]);return i.length<=1?i[0]||"":i},this.formatToParts=function(e){return(0,a.FK)(u.ast,u.locales,u.formatters,u.formats,e,void 0,u.message)},this.resolvedOptions=function(){var e;return{locale:(null===(e=u.resolvedLocale)||void 0===e?void 0:e.toString())||Intl.NumberFormat.supportedLocalesOf(u.locales)[0]}},this.getAst=function(){return u.ast},this.locales=i,this.resolvedLocale=e.resolveLocale(i),"string"==typeof t){if(this.message=t,!e.__parse)throw new TypeError("IntlMessageFormat.__parse must be set to process `message` of type `string`");var d=h||{},f=(d.formatters,(0,s._T)(d,["formatters"]));this.ast=e.__parse(t,(0,s.pi)((0,s.pi)({},f),{locale:this.resolvedLocale}))}else this.ast=t;if(!Array.isArray(this.ast))throw new TypeError("A message must be provided as a String or AST.");this.formats=o(e.formats,n),this.formatters=h&&h.formatters||(void 0===(c=this.formatterCache)&&(c={number:{},dateTime:{},pluralRules:{}}),{getNumberFormat:(0,r.H)((function(){for(var e,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return new((e=Intl.NumberFormat).bind.apply(e,(0,s.ev)([void 0],t,!1)))}),{cache:l(c.number),strategy:r.A.variadic}),getDateTimeFormat:(0,r.H)((function(){for(var e,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return new((e=Intl.DateTimeFormat).bind.apply(e,(0,s.ev)([void 0],t,!1)))}),{cache:l(c.dateTime),strategy:r.A.variadic}),getPluralRules:(0,r.H)((function(){for(var e,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return new((e=Intl.PluralRules).bind.apply(e,(0,s.ev)([void 0],t,!1)))}),{cache:l(c.pluralRules),strategy:r.A.variadic})})}return Object.defineProperty(e,"defaultLocale",{get:function(){return e.memoizedDefaultLocale||(e.memoizedDefaultLocale=(new Intl.NumberFormat).resolvedOptions().locale),e.memoizedDefaultLocale},enumerable:!1,configurable:!0}),e.memoizedDefaultLocale=null,e.resolveLocale=function(e){if(void 0!==Intl.Locale){var t=Intl.NumberFormat.supportedLocalesOf(e);return t.length>0?new Intl.Locale(t[0]):new Intl.Locale("string"==typeof e?e:e[0])}},e.__parse=n.Qc,e.formats={number:{integer:{maximumFractionDigits:0},currency:{style:"currency"},percent:{style:"percent"}},date:{short:{month:"numeric",day:"numeric",year:"2-digit"},medium:{month:"short",day:"numeric",year:"numeric"},long:{month:"long",day:"numeric",year:"numeric"},full:{weekday:"long",month:"long",day:"numeric",year:"numeric"}},time:{short:{hour:"numeric",minute:"numeric"},medium:{hour:"numeric",minute:"numeric",second:"numeric"},long:{hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"},full:{hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"}}},e}()},8402:function(e,t,i){"use strict";i.d(t,{C8:function(){return a},HR:function(){return l},YR:function(){return o},jK:function(){return s},u_:function(){return r}});var s,n=i(9900);!function(e){e.MISSING_VALUE="MISSING_VALUE",e.INVALID_VALUE="INVALID_VALUE",e.MISSING_INTL_API="MISSING_INTL_API"}(s||(s={}));var r=function(e){function t(t,i,s){var n=e.call(this,t)||this;return n.code=i,n.originalMessage=s,n}return(0,n.ZT)(t,e),t.prototype.toString=function(){return"[formatjs Error: ".concat(this.code,"] ").concat(this.message)},t}(Error),a=function(e){function t(t,i,n,r){return e.call(this,'Invalid values for "'.concat(t,'": "').concat(i,'". Options are "').concat(Object.keys(n).join('", "'),'"'),s.INVALID_VALUE,r)||this}return(0,n.ZT)(t,e),t}(r),o=function(e){function t(t,i,n){return e.call(this,'Value for "'.concat(t,'" must be of type ').concat(i),s.INVALID_VALUE,n)||this}return(0,n.ZT)(t,e),t}(r),l=function(e){function t(t,i){return e.call(this,'The intl string context variable "'.concat(t,'" was not provided to the string "').concat(i,'"'),s.MISSING_VALUE,i)||this}return(0,n.ZT)(t,e),t}(r)},4597:function(e,t,i){"use strict";i.d(t,{FK:function(){return o},Gt:function(){return a},du:function(){return s}});var s,n=i(7959),r=i(8402);function a(e){return"function"==typeof e}function o(e,t,i,l,h,c,u){if(1===e.length&&(0,n.O4)(e[0]))return[{type:s.literal,value:e[0].value}];for(var d=[],f=0,p=e;f<p.length;f++){var g=p[f];if((0,n.O4)(g))d.push({type:s.literal,value:g.value});else if((0,n.yx)(g))"number"==typeof c&&d.push({type:s.literal,value:i.getNumberFormat(t).format(c)});else{var m=g.value;if(!h||!(m in h))throw new r.HR(m,u);var _=h[m];if((0,n.VG)(g))_&&"string"!=typeof _&&"number"!=typeof _||(_="string"==typeof _||"number"==typeof _?String(_):""),d.push({type:"string"==typeof _?s.literal:s.object,value:_});else if((0,n.rp)(g)){var v="string"==typeof g.style?l.date[g.style]:(0,n.Ii)(g.style)?g.style.parsedOptions:void 0;d.push({type:s.literal,value:i.getDateTimeFormat(t,v).format(_)})}else if((0,n.pe)(g)){v="string"==typeof g.style?l.time[g.style]:(0,n.Ii)(g.style)?g.style.parsedOptions:l.time.medium;d.push({type:s.literal,value:i.getDateTimeFormat(t,v).format(_)})}else if((0,n.uf)(g)){(v="string"==typeof g.style?l.number[g.style]:(0,n.Wh)(g.style)?g.style.parsedOptions:void 0)&&v.scale&&(_*=v.scale||1),d.push({type:s.literal,value:i.getNumberFormat(t,v).format(_)})}else{if((0,n.HI)(g)){var b=g.children,E=g.value,y=h[E];if(!a(y))throw new r.YR(E,"function",u);var M=y(o(b,t,i,l,h,c).map((function(e){return e.value})));Array.isArray(M)||(M=[M]),d.push.apply(d,M.map((function(e){return{type:"string"==typeof e?s.literal:s.object,value:e}})))}if((0,n.Wi)(g)){if(!(T=g.options[_]||g.options.other))throw new r.C8(g.value,_,Object.keys(g.options),u);d.push.apply(d,o(T.value,t,i,l,h))}else if((0,n.Jo)(g)){var T;if(!(T=g.options["=".concat(_)])){if(!Intl.PluralRules)throw new r.u_('Intl.PluralRules is not available in this environment.\nTry polyfilling it using "@formatjs/intl-pluralrules"\n',r.jK.MISSING_INTL_API,u);var A=i.getPluralRules(t,{type:g.pluralType}).select(_-(g.offset||0));T=g.options[A]||g.options.other}if(!T)throw new r.C8(g.value,_,Object.keys(g.options),u);d.push.apply(d,o(T.value,t,i,l,h,_-(g.offset||0)))}else;}}}return function(e){return e.length<2?e:e.reduce((function(e,t){var i=e[e.length-1];return i&&i.type===s.literal&&t.type===s.literal?i.value+=t.value:e.push(t),e}),[])}(d)}!function(e){e[e.literal=0]="literal",e[e.object=1]="object"}(s||(s={}))},3964:function(e,t,i){(e=i.nmd(e)).exports=function(){"use strict";var t,i;function s(){return t.apply(null,arguments)}function n(e){t=e}function r(e){return e instanceof Array||"[object Array]"===Object.prototype.toString.call(e)}function a(e){return null!=e&&"[object Object]"===Object.prototype.toString.call(e)}function o(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function l(e){if(Object.getOwnPropertyNames)return 0===Object.getOwnPropertyNames(e).length;var t;for(t in e)if(o(e,t))return!1;return!0}function h(e){return void 0===e}function c(e){return"number"==typeof e||"[object Number]"===Object.prototype.toString.call(e)}function u(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}function d(e,t){var i,s=[],n=e.length;for(i=0;i<n;++i)s.push(t(e[i],i));return s}function f(e,t){for(var i in t)o(t,i)&&(e[i]=t[i]);return o(t,"toString")&&(e.toString=t.toString),o(t,"valueOf")&&(e.valueOf=t.valueOf),e}function p(e,t,i,s){return Yi(e,t,i,s,!0).utc()}function g(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function m(e){return null==e._pf&&(e._pf=g()),e._pf}function _(e){if(null==e._isValid){var t=m(e),s=i.call(t.parsedDateParts,(function(e){return null!=e})),n=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidEra&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&s);if(e._strict&&(n=n&&0===t.charsLeftOver&&0===t.unusedTokens.length&&void 0===t.bigHour),null!=Object.isFrozen&&Object.isFrozen(e))return n;e._isValid=n}return e._isValid}function v(e){var t=p(NaN);return null!=e?f(m(t),e):m(t).userInvalidated=!0,t}i=Array.prototype.some?Array.prototype.some:function(e){var t,i=Object(this),s=i.length>>>0;for(t=0;t<s;t++)if(t in i&&e.call(this,i[t],t,i))return!0;return!1};var b=s.momentProperties=[],E=!1;function y(e,t){var i,s,n,r=b.length;if(h(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),h(t._i)||(e._i=t._i),h(t._f)||(e._f=t._f),h(t._l)||(e._l=t._l),h(t._strict)||(e._strict=t._strict),h(t._tzm)||(e._tzm=t._tzm),h(t._isUTC)||(e._isUTC=t._isUTC),h(t._offset)||(e._offset=t._offset),h(t._pf)||(e._pf=m(t)),h(t._locale)||(e._locale=t._locale),r>0)for(i=0;i<r;i++)h(n=t[s=b[i]])||(e[s]=n);return e}function M(e){y(this,e),this._d=new Date(null!=e._d?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===E&&(E=!0,s.updateOffset(this),E=!1)}function T(e){return e instanceof M||null!=e&&null!=e._isAMomentObject}function A(e){!1===s.suppressDeprecationWarnings&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+e)}function S(e,t){var i=!0;return f((function(){if(null!=s.deprecationHandler&&s.deprecationHandler(null,e),i){var n,r,a,l=[],h=arguments.length;for(r=0;r<h;r++){if(n="","object"==typeof arguments[r]){for(a in n+="\n["+r+"] ",arguments[0])o(arguments[0],a)&&(n+=a+": "+arguments[0][a]+", ");n=n.slice(0,-2)}else n=arguments[r];l.push(n)}A(e+"\nArguments: "+Array.prototype.slice.call(l).join("")+"\n"+(new Error).stack),i=!1}return t.apply(this,arguments)}),t)}var I,C={};function D(e,t){null!=s.deprecationHandler&&s.deprecationHandler(e,t),C[e]||(A(t),C[e]=!0)}function P(e){return"undefined"!=typeof Function&&e instanceof Function||"[object Function]"===Object.prototype.toString.call(e)}function x(e){var t,i;for(i in e)o(e,i)&&(P(t=e[i])?this[i]=t:this["_"+i]=t);this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function R(e,t){var i,s=f({},e);for(i in t)o(t,i)&&(a(e[i])&&a(t[i])?(s[i]={},f(s[i],e[i]),f(s[i],t[i])):null!=t[i]?s[i]=t[i]:delete s[i]);for(i in e)o(e,i)&&!o(t,i)&&a(e[i])&&(s[i]=f({},s[i]));return s}function O(e){null!=e&&this.set(e)}s.suppressDeprecationWarnings=!1,s.deprecationHandler=null,I=Object.keys?Object.keys:function(e){var t,i=[];for(t in e)o(e,t)&&i.push(t);return i};var N={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function w(e,t,i){var s=this._calendar[e]||this._calendar.sameElse;return P(s)?s.call(t,i):s}function L(e,t,i){var s=""+Math.abs(e),n=t-s.length;return(e>=0?i?"+":"":"-")+Math.pow(10,Math.max(0,n)).toString().substr(1)+s}var F=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,B=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,U={},k={};function V(e,t,i,s){var n=s;"string"==typeof s&&(n=function(){return this[s]()}),e&&(k[e]=n),t&&(k[t[0]]=function(){return L(n.apply(this,arguments),t[1],t[2])}),i&&(k[i]=function(){return this.localeData().ordinal(n.apply(this,arguments),e)})}function G(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function W(e){var t,i,s=e.match(F);for(t=0,i=s.length;t<i;t++)k[s[t]]?s[t]=k[s[t]]:s[t]=G(s[t]);return function(t){var n,r="";for(n=0;n<i;n++)r+=P(s[n])?s[n].call(t,e):s[n];return r}}function z(e,t){return e.isValid()?(t=H(t,e.localeData()),U[t]=U[t]||W(t),U[t](e)):e.localeData().invalidDate()}function H(e,t){var i=5;function s(e){return t.longDateFormat(e)||e}for(B.lastIndex=0;i>=0&&B.test(e);)e=e.replace(B,s),B.lastIndex=0,i-=1;return e}var X={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function j(e){var t=this._longDateFormat[e],i=this._longDateFormat[e.toUpperCase()];return t||!i?t:(this._longDateFormat[e]=i.match(F).map((function(e){return"MMMM"===e||"MM"===e||"DD"===e||"dddd"===e?e.slice(1):e})).join(""),this._longDateFormat[e])}var Y="Invalid date";function q(){return this._invalidDate}var K="%d",Q=/\d{1,2}/;function Z(e){return this._ordinal.replace("%d",e)}var $={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function J(e,t,i,s){var n=this._relativeTime[i];return P(n)?n(e,t,i,s):n.replace(/%d/i,e)}function ee(e,t){var i=this._relativeTime[e>0?"future":"past"];return P(i)?i(t):i.replace(/%s/i,t)}var te={};function ie(e,t){var i=e.toLowerCase();te[i]=te[i+"s"]=te[t]=e}function se(e){return"string"==typeof e?te[e]||te[e.toLowerCase()]:void 0}function ne(e){var t,i,s={};for(i in e)o(e,i)&&(t=se(i))&&(s[t]=e[i]);return s}var re={};function ae(e,t){re[e]=t}function oe(e){var t,i=[];for(t in e)o(e,t)&&i.push({unit:t,priority:re[t]});return i.sort((function(e,t){return e.priority-t.priority})),i}function le(e){return e%4==0&&e%100!=0||e%400==0}function he(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function ce(e){var t=+e,i=0;return 0!==t&&isFinite(t)&&(i=he(t)),i}function ue(e,t){return function(i){return null!=i?(fe(this,e,i),s.updateOffset(this,t),this):de(this,e)}}function de(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function fe(e,t,i){e.isValid()&&!isNaN(i)&&("FullYear"===t&&le(e.year())&&1===e.month()&&29===e.date()?(i=ce(i),e._d["set"+(e._isUTC?"UTC":"")+t](i,e.month(),Je(i,e.month()))):e._d["set"+(e._isUTC?"UTC":"")+t](i))}function pe(e){return P(this[e=se(e)])?this[e]():this}function ge(e,t){if("object"==typeof e){var i,s=oe(e=ne(e)),n=s.length;for(i=0;i<n;i++)this[s[i].unit](e[s[i].unit])}else if(P(this[e=se(e)]))return this[e](t);return this}var me,_e=/\d/,ve=/\d\d/,be=/\d{3}/,Ee=/\d{4}/,ye=/[+-]?\d{6}/,Me=/\d\d?/,Te=/\d\d\d\d?/,Ae=/\d\d\d\d\d\d?/,Se=/\d{1,3}/,Ie=/\d{1,4}/,Ce=/[+-]?\d{1,6}/,De=/\d+/,Pe=/[+-]?\d+/,xe=/Z|[+-]\d\d:?\d\d/gi,Re=/Z|[+-]\d\d(?::?\d\d)?/gi,Oe=/[+-]?\d+(\.\d{1,3})?/,Ne=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i;function we(e,t,i){me[e]=P(t)?t:function(e,s){return e&&i?i:t}}function Le(e,t){return o(me,e)?me[e](t._strict,t._locale):new RegExp(Fe(e))}function Fe(e){return Be(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,(function(e,t,i,s,n){return t||i||s||n})))}function Be(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}me={};var Ue={};function ke(e,t){var i,s,n=t;for("string"==typeof e&&(e=[e]),c(t)&&(n=function(e,i){i[t]=ce(e)}),s=e.length,i=0;i<s;i++)Ue[e[i]]=n}function Ve(e,t){ke(e,(function(e,i,s,n){s._w=s._w||{},t(e,s._w,s,n)}))}function Ge(e,t,i){null!=t&&o(Ue,e)&&Ue[e](t,i._a,i,e)}var We,ze=0,He=1,Xe=2,je=3,Ye=4,qe=5,Ke=6,Qe=7,Ze=8;function $e(e,t){return(e%t+t)%t}function Je(e,t){if(isNaN(e)||isNaN(t))return NaN;var i=$e(t,12);return e+=(t-i)/12,1===i?le(e)?29:28:31-i%7%2}We=Array.prototype.indexOf?Array.prototype.indexOf:function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1},V("M",["MM",2],"Mo",(function(){return this.month()+1})),V("MMM",0,0,(function(e){return this.localeData().monthsShort(this,e)})),V("MMMM",0,0,(function(e){return this.localeData().months(this,e)})),ie("month","M"),ae("month",8),we("M",Me),we("MM",Me,ve),we("MMM",(function(e,t){return t.monthsShortRegex(e)})),we("MMMM",(function(e,t){return t.monthsRegex(e)})),ke(["M","MM"],(function(e,t){t[He]=ce(e)-1})),ke(["MMM","MMMM"],(function(e,t,i,s){var n=i._locale.monthsParse(e,s,i._strict);null!=n?t[He]=n:m(i).invalidMonth=e}));var et="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),tt="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),it=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,st=Ne,nt=Ne;function rt(e,t){return e?r(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||it).test(t)?"format":"standalone"][e.month()]:r(this._months)?this._months:this._months.standalone}function at(e,t){return e?r(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[it.test(t)?"format":"standalone"][e.month()]:r(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function ot(e,t,i){var s,n,r,a=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],s=0;s<12;++s)r=p([2e3,s]),this._shortMonthsParse[s]=this.monthsShort(r,"").toLocaleLowerCase(),this._longMonthsParse[s]=this.months(r,"").toLocaleLowerCase();return i?"MMM"===t?-1!==(n=We.call(this._shortMonthsParse,a))?n:null:-1!==(n=We.call(this._longMonthsParse,a))?n:null:"MMM"===t?-1!==(n=We.call(this._shortMonthsParse,a))||-1!==(n=We.call(this._longMonthsParse,a))?n:null:-1!==(n=We.call(this._longMonthsParse,a))||-1!==(n=We.call(this._shortMonthsParse,a))?n:null}function lt(e,t,i){var s,n,r;if(this._monthsParseExact)return ot.call(this,e,t,i);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),s=0;s<12;s++){if(n=p([2e3,s]),i&&!this._longMonthsParse[s]&&(this._longMonthsParse[s]=new RegExp("^"+this.months(n,"").replace(".","")+"$","i"),this._shortMonthsParse[s]=new RegExp("^"+this.monthsShort(n,"").replace(".","")+"$","i")),i||this._monthsParse[s]||(r="^"+this.months(n,"")+"|^"+this.monthsShort(n,""),this._monthsParse[s]=new RegExp(r.replace(".",""),"i")),i&&"MMMM"===t&&this._longMonthsParse[s].test(e))return s;if(i&&"MMM"===t&&this._shortMonthsParse[s].test(e))return s;if(!i&&this._monthsParse[s].test(e))return s}}function ht(e,t){var i;if(!e.isValid())return e;if("string"==typeof t)if(/^\d+$/.test(t))t=ce(t);else if(!c(t=e.localeData().monthsParse(t)))return e;return i=Math.min(e.date(),Je(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,i),e}function ct(e){return null!=e?(ht(this,e),s.updateOffset(this,!0),this):de(this,"Month")}function ut(){return Je(this.year(),this.month())}function dt(e){return this._monthsParseExact?(o(this,"_monthsRegex")||pt.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(o(this,"_monthsShortRegex")||(this._monthsShortRegex=st),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)}function ft(e){return this._monthsParseExact?(o(this,"_monthsRegex")||pt.call(this),e?this._monthsStrictRegex:this._monthsRegex):(o(this,"_monthsRegex")||(this._monthsRegex=nt),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)}function pt(){function e(e,t){return t.length-e.length}var t,i,s=[],n=[],r=[];for(t=0;t<12;t++)i=p([2e3,t]),s.push(this.monthsShort(i,"")),n.push(this.months(i,"")),r.push(this.months(i,"")),r.push(this.monthsShort(i,""));for(s.sort(e),n.sort(e),r.sort(e),t=0;t<12;t++)s[t]=Be(s[t]),n[t]=Be(n[t]);for(t=0;t<24;t++)r[t]=Be(r[t]);this._monthsRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+s.join("|")+")","i")}function gt(e){return le(e)?366:365}V("Y",0,0,(function(){var e=this.year();return e<=9999?L(e,4):"+"+e})),V(0,["YY",2],0,(function(){return this.year()%100})),V(0,["YYYY",4],0,"year"),V(0,["YYYYY",5],0,"year"),V(0,["YYYYYY",6,!0],0,"year"),ie("year","y"),ae("year",1),we("Y",Pe),we("YY",Me,ve),we("YYYY",Ie,Ee),we("YYYYY",Ce,ye),we("YYYYYY",Ce,ye),ke(["YYYYY","YYYYYY"],ze),ke("YYYY",(function(e,t){t[ze]=2===e.length?s.parseTwoDigitYear(e):ce(e)})),ke("YY",(function(e,t){t[ze]=s.parseTwoDigitYear(e)})),ke("Y",(function(e,t){t[ze]=parseInt(e,10)})),s.parseTwoDigitYear=function(e){return ce(e)+(ce(e)>68?1900:2e3)};var mt=ue("FullYear",!0);function _t(){return le(this.year())}function vt(e,t,i,s,n,r,a){var o;return e<100&&e>=0?(o=new Date(e+400,t,i,s,n,r,a),isFinite(o.getFullYear())&&o.setFullYear(e)):o=new Date(e,t,i,s,n,r,a),o}function bt(e){var t,i;return e<100&&e>=0?((i=Array.prototype.slice.call(arguments))[0]=e+400,t=new Date(Date.UTC.apply(null,i)),isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e)):t=new Date(Date.UTC.apply(null,arguments)),t}function Et(e,t,i){var s=7+t-i;return-(7+bt(e,0,s).getUTCDay()-t)%7+s-1}function yt(e,t,i,s,n){var r,a,o=1+7*(t-1)+(7+i-s)%7+Et(e,s,n);return o<=0?a=gt(r=e-1)+o:o>gt(e)?(r=e+1,a=o-gt(e)):(r=e,a=o),{year:r,dayOfYear:a}}function Mt(e,t,i){var s,n,r=Et(e.year(),t,i),a=Math.floor((e.dayOfYear()-r-1)/7)+1;return a<1?s=a+Tt(n=e.year()-1,t,i):a>Tt(e.year(),t,i)?(s=a-Tt(e.year(),t,i),n=e.year()+1):(n=e.year(),s=a),{week:s,year:n}}function Tt(e,t,i){var s=Et(e,t,i),n=Et(e+1,t,i);return(gt(e)-s+n)/7}function At(e){return Mt(e,this._week.dow,this._week.doy).week}V("w",["ww",2],"wo","week"),V("W",["WW",2],"Wo","isoWeek"),ie("week","w"),ie("isoWeek","W"),ae("week",5),ae("isoWeek",5),we("w",Me),we("ww",Me,ve),we("W",Me),we("WW",Me,ve),Ve(["w","ww","W","WW"],(function(e,t,i,s){t[s.substr(0,1)]=ce(e)}));var St={dow:0,doy:6};function It(){return this._week.dow}function Ct(){return this._week.doy}function Dt(e){var t=this.localeData().week(this);return null==e?t:this.add(7*(e-t),"d")}function Pt(e){var t=Mt(this,1,4).week;return null==e?t:this.add(7*(e-t),"d")}function xt(e,t){return"string"!=typeof e?e:isNaN(e)?"number"==typeof(e=t.weekdaysParse(e))?e:null:parseInt(e,10)}function Rt(e,t){return"string"==typeof e?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}function Ot(e,t){return e.slice(t,7).concat(e.slice(0,t))}V("d",0,"do","day"),V("dd",0,0,(function(e){return this.localeData().weekdaysMin(this,e)})),V("ddd",0,0,(function(e){return this.localeData().weekdaysShort(this,e)})),V("dddd",0,0,(function(e){return this.localeData().weekdays(this,e)})),V("e",0,0,"weekday"),V("E",0,0,"isoWeekday"),ie("day","d"),ie("weekday","e"),ie("isoWeekday","E"),ae("day",11),ae("weekday",11),ae("isoWeekday",11),we("d",Me),we("e",Me),we("E",Me),we("dd",(function(e,t){return t.weekdaysMinRegex(e)})),we("ddd",(function(e,t){return t.weekdaysShortRegex(e)})),we("dddd",(function(e,t){return t.weekdaysRegex(e)})),Ve(["dd","ddd","dddd"],(function(e,t,i,s){var n=i._locale.weekdaysParse(e,s,i._strict);null!=n?t.d=n:m(i).invalidWeekday=e})),Ve(["d","e","E"],(function(e,t,i,s){t[s]=ce(e)}));var Nt="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),wt="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Lt="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),Ft=Ne,Bt=Ne,Ut=Ne;function kt(e,t){var i=r(this._weekdays)?this._weekdays:this._weekdays[e&&!0!==e&&this._weekdays.isFormat.test(t)?"format":"standalone"];return!0===e?Ot(i,this._week.dow):e?i[e.day()]:i}function Vt(e){return!0===e?Ot(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort}function Gt(e){return!0===e?Ot(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin}function Wt(e,t,i){var s,n,r,a=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],s=0;s<7;++s)r=p([2e3,1]).day(s),this._minWeekdaysParse[s]=this.weekdaysMin(r,"").toLocaleLowerCase(),this._shortWeekdaysParse[s]=this.weekdaysShort(r,"").toLocaleLowerCase(),this._weekdaysParse[s]=this.weekdays(r,"").toLocaleLowerCase();return i?"dddd"===t?-1!==(n=We.call(this._weekdaysParse,a))?n:null:"ddd"===t?-1!==(n=We.call(this._shortWeekdaysParse,a))?n:null:-1!==(n=We.call(this._minWeekdaysParse,a))?n:null:"dddd"===t?-1!==(n=We.call(this._weekdaysParse,a))||-1!==(n=We.call(this._shortWeekdaysParse,a))||-1!==(n=We.call(this._minWeekdaysParse,a))?n:null:"ddd"===t?-1!==(n=We.call(this._shortWeekdaysParse,a))||-1!==(n=We.call(this._weekdaysParse,a))||-1!==(n=We.call(this._minWeekdaysParse,a))?n:null:-1!==(n=We.call(this._minWeekdaysParse,a))||-1!==(n=We.call(this._weekdaysParse,a))||-1!==(n=We.call(this._shortWeekdaysParse,a))?n:null}function zt(e,t,i){var s,n,r;if(this._weekdaysParseExact)return Wt.call(this,e,t,i);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),s=0;s<7;s++){if(n=p([2e3,1]).day(s),i&&!this._fullWeekdaysParse[s]&&(this._fullWeekdaysParse[s]=new RegExp("^"+this.weekdays(n,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[s]=new RegExp("^"+this.weekdaysShort(n,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[s]=new RegExp("^"+this.weekdaysMin(n,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[s]||(r="^"+this.weekdays(n,"")+"|^"+this.weekdaysShort(n,"")+"|^"+this.weekdaysMin(n,""),this._weekdaysParse[s]=new RegExp(r.replace(".",""),"i")),i&&"dddd"===t&&this._fullWeekdaysParse[s].test(e))return s;if(i&&"ddd"===t&&this._shortWeekdaysParse[s].test(e))return s;if(i&&"dd"===t&&this._minWeekdaysParse[s].test(e))return s;if(!i&&this._weekdaysParse[s].test(e))return s}}function Ht(e){if(!this.isValid())return null!=e?this:NaN;var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(e=xt(e,this.localeData()),this.add(e-t,"d")):t}function Xt(e){if(!this.isValid())return null!=e?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return null==e?t:this.add(e-t,"d")}function jt(e){if(!this.isValid())return null!=e?this:NaN;if(null!=e){var t=Rt(e,this.localeData());return this.day(this.day()%7?t:t-7)}return this.day()||7}function Yt(e){return this._weekdaysParseExact?(o(this,"_weekdaysRegex")||Qt.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(o(this,"_weekdaysRegex")||(this._weekdaysRegex=Ft),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)}function qt(e){return this._weekdaysParseExact?(o(this,"_weekdaysRegex")||Qt.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(o(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Bt),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function Kt(e){return this._weekdaysParseExact?(o(this,"_weekdaysRegex")||Qt.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(o(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Ut),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function Qt(){function e(e,t){return t.length-e.length}var t,i,s,n,r,a=[],o=[],l=[],h=[];for(t=0;t<7;t++)i=p([2e3,1]).day(t),s=Be(this.weekdaysMin(i,"")),n=Be(this.weekdaysShort(i,"")),r=Be(this.weekdays(i,"")),a.push(s),o.push(n),l.push(r),h.push(s),h.push(n),h.push(r);a.sort(e),o.sort(e),l.sort(e),h.sort(e),this._weekdaysRegex=new RegExp("^("+h.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+l.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+o.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+a.join("|")+")","i")}function Zt(){return this.hours()%12||12}function $t(){return this.hours()||24}function Jt(e,t){V(e,0,0,(function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)}))}function ei(e,t){return t._meridiemParse}function ti(e){return"p"===(e+"").toLowerCase().charAt(0)}V("H",["HH",2],0,"hour"),V("h",["hh",2],0,Zt),V("k",["kk",2],0,$t),V("hmm",0,0,(function(){return""+Zt.apply(this)+L(this.minutes(),2)})),V("hmmss",0,0,(function(){return""+Zt.apply(this)+L(this.minutes(),2)+L(this.seconds(),2)})),V("Hmm",0,0,(function(){return""+this.hours()+L(this.minutes(),2)})),V("Hmmss",0,0,(function(){return""+this.hours()+L(this.minutes(),2)+L(this.seconds(),2)})),Jt("a",!0),Jt("A",!1),ie("hour","h"),ae("hour",13),we("a",ei),we("A",ei),we("H",Me),we("h",Me),we("k",Me),we("HH",Me,ve),we("hh",Me,ve),we("kk",Me,ve),we("hmm",Te),we("hmmss",Ae),we("Hmm",Te),we("Hmmss",Ae),ke(["H","HH"],je),ke(["k","kk"],(function(e,t,i){var s=ce(e);t[je]=24===s?0:s})),ke(["a","A"],(function(e,t,i){i._isPm=i._locale.isPM(e),i._meridiem=e})),ke(["h","hh"],(function(e,t,i){t[je]=ce(e),m(i).bigHour=!0})),ke("hmm",(function(e,t,i){var s=e.length-2;t[je]=ce(e.substr(0,s)),t[Ye]=ce(e.substr(s)),m(i).bigHour=!0})),ke("hmmss",(function(e,t,i){var s=e.length-4,n=e.length-2;t[je]=ce(e.substr(0,s)),t[Ye]=ce(e.substr(s,2)),t[qe]=ce(e.substr(n)),m(i).bigHour=!0})),ke("Hmm",(function(e,t,i){var s=e.length-2;t[je]=ce(e.substr(0,s)),t[Ye]=ce(e.substr(s))})),ke("Hmmss",(function(e,t,i){var s=e.length-4,n=e.length-2;t[je]=ce(e.substr(0,s)),t[Ye]=ce(e.substr(s,2)),t[qe]=ce(e.substr(n))}));var ii=/[ap]\.?m?\.?/i,si=ue("Hours",!0);function ni(e,t,i){return e>11?i?"pm":"PM":i?"am":"AM"}var ri,ai={calendar:N,longDateFormat:X,invalidDate:Y,ordinal:K,dayOfMonthOrdinalParse:Q,relativeTime:$,months:et,monthsShort:tt,week:St,weekdays:Nt,weekdaysMin:Lt,weekdaysShort:wt,meridiemParse:ii},oi={},li={};function hi(e,t){var i,s=Math.min(e.length,t.length);for(i=0;i<s;i+=1)if(e[i]!==t[i])return i;return s}function ci(e){return e?e.toLowerCase().replace("_","-"):e}function ui(e){for(var t,i,s,n,r=0;r<e.length;){for(t=(n=ci(e[r]).split("-")).length,i=(i=ci(e[r+1]))?i.split("-"):null;t>0;){if(s=fi(n.slice(0,t).join("-")))return s;if(i&&i.length>=t&&hi(n,i)>=t-1)break;t--}r++}return ri}function di(e){return null!=e.match("^[^/\\\\]*$")}function fi(t){var i=null;if(void 0===oi[t]&&e&&e.exports&&di(t))try{i=ri._abbr,Object(function(){var e=new Error("Cannot find module 'undefined'");throw e.code="MODULE_NOT_FOUND",e}()),pi(i)}catch(s){oi[t]=null}return oi[t]}function pi(e,t){var i;return e&&((i=h(t)?_i(e):gi(e,t))?ri=i:"undefined"!=typeof console&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),ri._abbr}function gi(e,t){if(null!==t){var i,s=ai;if(t.abbr=e,null!=oi[e])D("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),s=oi[e]._config;else if(null!=t.parentLocale)if(null!=oi[t.parentLocale])s=oi[t.parentLocale]._config;else{if(null==(i=fi(t.parentLocale)))return li[t.parentLocale]||(li[t.parentLocale]=[]),li[t.parentLocale].push({name:e,config:t}),null;s=i._config}return oi[e]=new O(R(s,t)),li[e]&&li[e].forEach((function(e){gi(e.name,e.config)})),pi(e),oi[e]}return delete oi[e],null}function mi(e,t){if(null!=t){var i,s,n=ai;null!=oi[e]&&null!=oi[e].parentLocale?oi[e].set(R(oi[e]._config,t)):(null!=(s=fi(e))&&(n=s._config),t=R(n,t),null==s&&(t.abbr=e),(i=new O(t)).parentLocale=oi[e],oi[e]=i),pi(e)}else null!=oi[e]&&(null!=oi[e].parentLocale?(oi[e]=oi[e].parentLocale,e===pi()&&pi(e)):null!=oi[e]&&delete oi[e]);return oi[e]}function _i(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return ri;if(!r(e)){if(t=fi(e))return t;e=[e]}return ui(e)}function vi(){return I(oi)}function bi(e){var t,i=e._a;return i&&-2===m(e).overflow&&(t=i[He]<0||i[He]>11?He:i[Xe]<1||i[Xe]>Je(i[ze],i[He])?Xe:i[je]<0||i[je]>24||24===i[je]&&(0!==i[Ye]||0!==i[qe]||0!==i[Ke])?je:i[Ye]<0||i[Ye]>59?Ye:i[qe]<0||i[qe]>59?qe:i[Ke]<0||i[Ke]>999?Ke:-1,m(e)._overflowDayOfYear&&(t<ze||t>Xe)&&(t=Xe),m(e)._overflowWeeks&&-1===t&&(t=Qe),m(e)._overflowWeekday&&-1===t&&(t=Ze),m(e).overflow=t),e}var Ei=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,yi=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Mi=/Z|[+-]\d\d(?::?\d\d)?/,Ti=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],Ai=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],Si=/^\/?Date\((-?\d+)/i,Ii=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,Ci={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function Di(e){var t,i,s,n,r,a,o=e._i,l=Ei.exec(o)||yi.exec(o),h=Ti.length,c=Ai.length;if(l){for(m(e).iso=!0,t=0,i=h;t<i;t++)if(Ti[t][1].exec(l[1])){n=Ti[t][0],s=!1!==Ti[t][2];break}if(null==n)return void(e._isValid=!1);if(l[3]){for(t=0,i=c;t<i;t++)if(Ai[t][1].exec(l[3])){r=(l[2]||" ")+Ai[t][0];break}if(null==r)return void(e._isValid=!1)}if(!s&&null!=r)return void(e._isValid=!1);if(l[4]){if(!Mi.exec(l[4]))return void(e._isValid=!1);a="Z"}e._f=n+(r||"")+(a||""),Vi(e)}else e._isValid=!1}function Pi(e,t,i,s,n,r){var a=[xi(e),tt.indexOf(t),parseInt(i,10),parseInt(s,10),parseInt(n,10)];return r&&a.push(parseInt(r,10)),a}function xi(e){var t=parseInt(e,10);return t<=49?2e3+t:t<=999?1900+t:t}function Ri(e){return e.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function Oi(e,t,i){return!e||wt.indexOf(e)===new Date(t[0],t[1],t[2]).getDay()||(m(i).weekdayMismatch=!0,i._isValid=!1,!1)}function Ni(e,t,i){if(e)return Ci[e];if(t)return 0;var s=parseInt(i,10),n=s%100;return(s-n)/100*60+n}function wi(e){var t,i=Ii.exec(Ri(e._i));if(i){if(t=Pi(i[4],i[3],i[2],i[5],i[6],i[7]),!Oi(i[1],t,e))return;e._a=t,e._tzm=Ni(i[8],i[9],i[10]),e._d=bt.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),m(e).rfc2822=!0}else e._isValid=!1}function Li(e){var t=Si.exec(e._i);null===t?(Di(e),!1===e._isValid&&(delete e._isValid,wi(e),!1===e._isValid&&(delete e._isValid,e._strict?e._isValid=!1:s.createFromInputFallback(e)))):e._d=new Date(+t[1])}function Fi(e,t,i){return null!=e?e:null!=t?t:i}function Bi(e){var t=new Date(s.now());return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function Ui(e){var t,i,s,n,r,a=[];if(!e._d){for(s=Bi(e),e._w&&null==e._a[Xe]&&null==e._a[He]&&ki(e),null!=e._dayOfYear&&(r=Fi(e._a[ze],s[ze]),(e._dayOfYear>gt(r)||0===e._dayOfYear)&&(m(e)._overflowDayOfYear=!0),i=bt(r,0,e._dayOfYear),e._a[He]=i.getUTCMonth(),e._a[Xe]=i.getUTCDate()),t=0;t<3&&null==e._a[t];++t)e._a[t]=a[t]=s[t];for(;t<7;t++)e._a[t]=a[t]=null==e._a[t]?2===t?1:0:e._a[t];24===e._a[je]&&0===e._a[Ye]&&0===e._a[qe]&&0===e._a[Ke]&&(e._nextDay=!0,e._a[je]=0),e._d=(e._useUTC?bt:vt).apply(null,a),n=e._useUTC?e._d.getUTCDay():e._d.getDay(),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[je]=24),e._w&&void 0!==e._w.d&&e._w.d!==n&&(m(e).weekdayMismatch=!0)}}function ki(e){var t,i,s,n,r,a,o,l,h;null!=(t=e._w).GG||null!=t.W||null!=t.E?(r=1,a=4,i=Fi(t.GG,e._a[ze],Mt(qi(),1,4).year),s=Fi(t.W,1),((n=Fi(t.E,1))<1||n>7)&&(l=!0)):(r=e._locale._week.dow,a=e._locale._week.doy,h=Mt(qi(),r,a),i=Fi(t.gg,e._a[ze],h.year),s=Fi(t.w,h.week),null!=t.d?((n=t.d)<0||n>6)&&(l=!0):null!=t.e?(n=t.e+r,(t.e<0||t.e>6)&&(l=!0)):n=r),s<1||s>Tt(i,r,a)?m(e)._overflowWeeks=!0:null!=l?m(e)._overflowWeekday=!0:(o=yt(i,s,n,r,a),e._a[ze]=o.year,e._dayOfYear=o.dayOfYear)}function Vi(e){if(e._f!==s.ISO_8601)if(e._f!==s.RFC_2822){e._a=[],m(e).empty=!0;var t,i,n,r,a,o,l,h=""+e._i,c=h.length,u=0;for(l=(n=H(e._f,e._locale).match(F)||[]).length,t=0;t<l;t++)r=n[t],(i=(h.match(Le(r,e))||[])[0])&&((a=h.substr(0,h.indexOf(i))).length>0&&m(e).unusedInput.push(a),h=h.slice(h.indexOf(i)+i.length),u+=i.length),k[r]?(i?m(e).empty=!1:m(e).unusedTokens.push(r),Ge(r,i,e)):e._strict&&!i&&m(e).unusedTokens.push(r);m(e).charsLeftOver=c-u,h.length>0&&m(e).unusedInput.push(h),e._a[je]<=12&&!0===m(e).bigHour&&e._a[je]>0&&(m(e).bigHour=void 0),m(e).parsedDateParts=e._a.slice(0),m(e).meridiem=e._meridiem,e._a[je]=Gi(e._locale,e._a[je],e._meridiem),null!==(o=m(e).era)&&(e._a[ze]=e._locale.erasConvertYear(o,e._a[ze])),Ui(e),bi(e)}else wi(e);else Di(e)}function Gi(e,t,i){var s;return null==i?t:null!=e.meridiemHour?e.meridiemHour(t,i):null!=e.isPM?((s=e.isPM(i))&&t<12&&(t+=12),s||12!==t||(t=0),t):t}function Wi(e){var t,i,s,n,r,a,o=!1,l=e._f.length;if(0===l)return m(e).invalidFormat=!0,void(e._d=new Date(NaN));for(n=0;n<l;n++)r=0,a=!1,t=y({},e),null!=e._useUTC&&(t._useUTC=e._useUTC),t._f=e._f[n],Vi(t),_(t)&&(a=!0),r+=m(t).charsLeftOver,r+=10*m(t).unusedTokens.length,m(t).score=r,o?r<s&&(s=r,i=t):(null==s||r<s||a)&&(s=r,i=t,a&&(o=!0));f(e,i||t)}function zi(e){if(!e._d){var t=ne(e._i),i=void 0===t.day?t.date:t.day;e._a=d([t.year,t.month,i,t.hour,t.minute,t.second,t.millisecond],(function(e){return e&&parseInt(e,10)})),Ui(e)}}function Hi(e){var t=new M(bi(Xi(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t}function Xi(e){var t=e._i,i=e._f;return e._locale=e._locale||_i(e._l),null===t||void 0===i&&""===t?v({nullInput:!0}):("string"==typeof t&&(e._i=t=e._locale.preparse(t)),T(t)?new M(bi(t)):(u(t)?e._d=t:r(i)?Wi(e):i?Vi(e):ji(e),_(e)||(e._d=null),e))}function ji(e){var t=e._i;h(t)?e._d=new Date(s.now()):u(t)?e._d=new Date(t.valueOf()):"string"==typeof t?Li(e):r(t)?(e._a=d(t.slice(0),(function(e){return parseInt(e,10)})),Ui(e)):a(t)?zi(e):c(t)?e._d=new Date(t):s.createFromInputFallback(e)}function Yi(e,t,i,s,n){var o={};return!0!==t&&!1!==t||(s=t,t=void 0),!0!==i&&!1!==i||(s=i,i=void 0),(a(e)&&l(e)||r(e)&&0===e.length)&&(e=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=n,o._l=i,o._i=e,o._f=t,o._strict=s,Hi(o)}function qi(e,t,i,s){return Yi(e,t,i,s,!1)}s.createFromInputFallback=S("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",(function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))})),s.ISO_8601=function(){},s.RFC_2822=function(){};var Ki=S("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",(function(){var e=qi.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:v()})),Qi=S("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",(function(){var e=qi.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:v()}));function Zi(e,t){var i,s;if(1===t.length&&r(t[0])&&(t=t[0]),!t.length)return qi();for(i=t[0],s=1;s<t.length;++s)t[s].isValid()&&!t[s][e](i)||(i=t[s]);return i}function $i(){return Zi("isBefore",[].slice.call(arguments,0))}function Ji(){return Zi("isAfter",[].slice.call(arguments,0))}var es=function(){return Date.now?Date.now():+new Date},ts=["year","quarter","month","week","day","hour","minute","second","millisecond"];function is(e){var t,i,s=!1,n=ts.length;for(t in e)if(o(e,t)&&(-1===We.call(ts,t)||null!=e[t]&&isNaN(e[t])))return!1;for(i=0;i<n;++i)if(e[ts[i]]){if(s)return!1;parseFloat(e[ts[i]])!==ce(e[ts[i]])&&(s=!0)}return!0}function ss(){return this._isValid}function ns(){return Cs(NaN)}function rs(e){var t=ne(e),i=t.year||0,s=t.quarter||0,n=t.month||0,r=t.week||t.isoWeek||0,a=t.day||0,o=t.hour||0,l=t.minute||0,h=t.second||0,c=t.millisecond||0;this._isValid=is(t),this._milliseconds=+c+1e3*h+6e4*l+1e3*o*60*60,this._days=+a+7*r,this._months=+n+3*s+12*i,this._data={},this._locale=_i(),this._bubble()}function as(e){return e instanceof rs}function os(e){return e<0?-1*Math.round(-1*e):Math.round(e)}function ls(e,t,i){var s,n=Math.min(e.length,t.length),r=Math.abs(e.length-t.length),a=0;for(s=0;s<n;s++)(i&&e[s]!==t[s]||!i&&ce(e[s])!==ce(t[s]))&&a++;return a+r}function hs(e,t){V(e,0,0,(function(){var e=this.utcOffset(),i="+";return e<0&&(e=-e,i="-"),i+L(~~(e/60),2)+t+L(~~e%60,2)}))}hs("Z",":"),hs("ZZ",""),we("Z",Re),we("ZZ",Re),ke(["Z","ZZ"],(function(e,t,i){i._useUTC=!0,i._tzm=us(Re,e)}));var cs=/([\+\-]|\d\d)/gi;function us(e,t){var i,s,n=(t||"").match(e);return null===n?null:0===(s=60*(i=((n[n.length-1]||[])+"").match(cs)||["-",0,0])[1]+ce(i[2]))?0:"+"===i[0]?s:-s}function ds(e,t){var i,n;return t._isUTC?(i=t.clone(),n=(T(e)||u(e)?e.valueOf():qi(e).valueOf())-i.valueOf(),i._d.setTime(i._d.valueOf()+n),s.updateOffset(i,!1),i):qi(e).local()}function fs(e){return-Math.round(e._d.getTimezoneOffset())}function ps(e,t,i){var n,r=this._offset||0;if(!this.isValid())return null!=e?this:NaN;if(null!=e){if("string"==typeof e){if(null===(e=us(Re,e)))return this}else Math.abs(e)<16&&!i&&(e*=60);return!this._isUTC&&t&&(n=fs(this)),this._offset=e,this._isUTC=!0,null!=n&&this.add(n,"m"),r!==e&&(!t||this._changeInProgress?Os(this,Cs(e-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,s.updateOffset(this,!0),this._changeInProgress=null)),this}return this._isUTC?r:fs(this)}function gs(e,t){return null!=e?("string"!=typeof e&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}function ms(e){return this.utcOffset(0,e)}function _s(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(fs(this),"m")),this}function vs(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"==typeof this._i){var e=us(xe,this._i);null!=e?this.utcOffset(e):this.utcOffset(0,!0)}return this}function bs(e){return!!this.isValid()&&(e=e?qi(e).utcOffset():0,(this.utcOffset()-e)%60==0)}function Es(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function ys(){if(!h(this._isDSTShifted))return this._isDSTShifted;var e,t={};return y(t,this),(t=Xi(t))._a?(e=t._isUTC?p(t._a):qi(t._a),this._isDSTShifted=this.isValid()&&ls(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function Ms(){return!!this.isValid()&&!this._isUTC}function Ts(){return!!this.isValid()&&this._isUTC}function As(){return!!this.isValid()&&this._isUTC&&0===this._offset}s.updateOffset=function(){};var Ss=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,Is=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Cs(e,t){var i,s,n,r=e,a=null;return as(e)?r={ms:e._milliseconds,d:e._days,M:e._months}:c(e)||!isNaN(+e)?(r={},t?r[t]=+e:r.milliseconds=+e):(a=Ss.exec(e))?(i="-"===a[1]?-1:1,r={y:0,d:ce(a[Xe])*i,h:ce(a[je])*i,m:ce(a[Ye])*i,s:ce(a[qe])*i,ms:ce(os(1e3*a[Ke]))*i}):(a=Is.exec(e))?(i="-"===a[1]?-1:1,r={y:Ds(a[2],i),M:Ds(a[3],i),w:Ds(a[4],i),d:Ds(a[5],i),h:Ds(a[6],i),m:Ds(a[7],i),s:Ds(a[8],i)}):null==r?r={}:"object"==typeof r&&("from"in r||"to"in r)&&(n=xs(qi(r.from),qi(r.to)),(r={}).ms=n.milliseconds,r.M=n.months),s=new rs(r),as(e)&&o(e,"_locale")&&(s._locale=e._locale),as(e)&&o(e,"_isValid")&&(s._isValid=e._isValid),s}function Ds(e,t){var i=e&&parseFloat(e.replace(",","."));return(isNaN(i)?0:i)*t}function Ps(e,t){var i={};return i.months=t.month()-e.month()+12*(t.year()-e.year()),e.clone().add(i.months,"M").isAfter(t)&&--i.months,i.milliseconds=+t-+e.clone().add(i.months,"M"),i}function xs(e,t){var i;return e.isValid()&&t.isValid()?(t=ds(t,e),e.isBefore(t)?i=Ps(e,t):((i=Ps(t,e)).milliseconds=-i.milliseconds,i.months=-i.months),i):{milliseconds:0,months:0}}function Rs(e,t){return function(i,s){var n;return null===s||isNaN(+s)||(D(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),n=i,i=s,s=n),Os(this,Cs(i,s),e),this}}function Os(e,t,i,n){var r=t._milliseconds,a=os(t._days),o=os(t._months);e.isValid()&&(n=null==n||n,o&&ht(e,de(e,"Month")+o*i),a&&fe(e,"Date",de(e,"Date")+a*i),r&&e._d.setTime(e._d.valueOf()+r*i),n&&s.updateOffset(e,a||o))}Cs.fn=rs.prototype,Cs.invalid=ns;var Ns=Rs(1,"add"),ws=Rs(-1,"subtract");function Ls(e){return"string"==typeof e||e instanceof String}function Fs(e){return T(e)||u(e)||Ls(e)||c(e)||Us(e)||Bs(e)||null==e}function Bs(e){var t,i,s=a(e)&&!l(e),n=!1,r=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],h=r.length;for(t=0;t<h;t+=1)i=r[t],n=n||o(e,i);return s&&n}function Us(e){var t=r(e),i=!1;return t&&(i=0===e.filter((function(t){return!c(t)&&Ls(e)})).length),t&&i}function ks(e){var t,i,s=a(e)&&!l(e),n=!1,r=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"];for(t=0;t<r.length;t+=1)i=r[t],n=n||o(e,i);return s&&n}function Vs(e,t){var i=e.diff(t,"days",!0);return i<-6?"sameElse":i<-1?"lastWeek":i<0?"lastDay":i<1?"sameDay":i<2?"nextDay":i<7?"nextWeek":"sameElse"}function Gs(e,t){1===arguments.length&&(arguments[0]?Fs(arguments[0])?(e=arguments[0],t=void 0):ks(arguments[0])&&(t=arguments[0],e=void 0):(e=void 0,t=void 0));var i=e||qi(),n=ds(i,this).startOf("day"),r=s.calendarFormat(this,n)||"sameElse",a=t&&(P(t[r])?t[r].call(this,i):t[r]);return this.format(a||this.localeData().calendar(r,this,qi(i)))}function Ws(){return new M(this)}function zs(e,t){var i=T(e)?e:qi(e);return!(!this.isValid()||!i.isValid())&&("millisecond"===(t=se(t)||"millisecond")?this.valueOf()>i.valueOf():i.valueOf()<this.clone().startOf(t).valueOf())}function Hs(e,t){var i=T(e)?e:qi(e);return!(!this.isValid()||!i.isValid())&&("millisecond"===(t=se(t)||"millisecond")?this.valueOf()<i.valueOf():this.clone().endOf(t).valueOf()<i.valueOf())}function Xs(e,t,i,s){var n=T(e)?e:qi(e),r=T(t)?t:qi(t);return!!(this.isValid()&&n.isValid()&&r.isValid())&&("("===(s=s||"()")[0]?this.isAfter(n,i):!this.isBefore(n,i))&&(")"===s[1]?this.isBefore(r,i):!this.isAfter(r,i))}function js(e,t){var i,s=T(e)?e:qi(e);return!(!this.isValid()||!s.isValid())&&("millisecond"===(t=se(t)||"millisecond")?this.valueOf()===s.valueOf():(i=s.valueOf(),this.clone().startOf(t).valueOf()<=i&&i<=this.clone().endOf(t).valueOf()))}function Ys(e,t){return this.isSame(e,t)||this.isAfter(e,t)}function qs(e,t){return this.isSame(e,t)||this.isBefore(e,t)}function Ks(e,t,i){var s,n,r;if(!this.isValid())return NaN;if(!(s=ds(e,this)).isValid())return NaN;switch(n=6e4*(s.utcOffset()-this.utcOffset()),t=se(t)){case"year":r=Qs(this,s)/12;break;case"month":r=Qs(this,s);break;case"quarter":r=Qs(this,s)/3;break;case"second":r=(this-s)/1e3;break;case"minute":r=(this-s)/6e4;break;case"hour":r=(this-s)/36e5;break;case"day":r=(this-s-n)/864e5;break;case"week":r=(this-s-n)/6048e5;break;default:r=this-s}return i?r:he(r)}function Qs(e,t){if(e.date()<t.date())return-Qs(t,e);var i=12*(t.year()-e.year())+(t.month()-e.month()),s=e.clone().add(i,"months");return-(i+(t-s<0?(t-s)/(s-e.clone().add(i-1,"months")):(t-s)/(e.clone().add(i+1,"months")-s)))||0}function Zs(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function $s(e){if(!this.isValid())return null;var t=!0!==e,i=t?this.clone().utc():this;return i.year()<0||i.year()>9999?z(i,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):P(Date.prototype.toISOString)?t?this.toDate().toISOString():new Date(this.valueOf()+60*this.utcOffset()*1e3).toISOString().replace("Z",z(i,"Z")):z(i,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function Js(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e,t,i,s,n="moment",r="";return this.isLocal()||(n=0===this.utcOffset()?"moment.utc":"moment.parseZone",r="Z"),e="["+n+'("]',t=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",s=r+'[")]',this.format(e+t+i+s)}function en(e){e||(e=this.isUtc()?s.defaultFormatUtc:s.defaultFormat);var t=z(this,e);return this.localeData().postformat(t)}function tn(e,t){return this.isValid()&&(T(e)&&e.isValid()||qi(e).isValid())?Cs({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function sn(e){return this.from(qi(),e)}function nn(e,t){return this.isValid()&&(T(e)&&e.isValid()||qi(e).isValid())?Cs({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function rn(e){return this.to(qi(),e)}function an(e){var t;return void 0===e?this._locale._abbr:(null!=(t=_i(e))&&(this._locale=t),this)}s.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",s.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var on=S("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",(function(e){return void 0===e?this.localeData():this.locale(e)}));function ln(){return this._locale}var hn=1e3,cn=60*hn,un=60*cn,dn=3506328*un;function fn(e,t){return(e%t+t)%t}function pn(e,t,i){return e<100&&e>=0?new Date(e+400,t,i)-dn:new Date(e,t,i).valueOf()}function gn(e,t,i){return e<100&&e>=0?Date.UTC(e+400,t,i)-dn:Date.UTC(e,t,i)}function mn(e){var t,i;if(void 0===(e=se(e))||"millisecond"===e||!this.isValid())return this;switch(i=this._isUTC?gn:pn,e){case"year":t=i(this.year(),0,1);break;case"quarter":t=i(this.year(),this.month()-this.month()%3,1);break;case"month":t=i(this.year(),this.month(),1);break;case"week":t=i(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":t=i(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":t=i(this.year(),this.month(),this.date());break;case"hour":t=this._d.valueOf(),t-=fn(t+(this._isUTC?0:this.utcOffset()*cn),un);break;case"minute":t=this._d.valueOf(),t-=fn(t,cn);break;case"second":t=this._d.valueOf(),t-=fn(t,hn)}return this._d.setTime(t),s.updateOffset(this,!0),this}function _n(e){var t,i;if(void 0===(e=se(e))||"millisecond"===e||!this.isValid())return this;switch(i=this._isUTC?gn:pn,e){case"year":t=i(this.year()+1,0,1)-1;break;case"quarter":t=i(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":t=i(this.year(),this.month()+1,1)-1;break;case"week":t=i(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":t=i(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":t=i(this.year(),this.month(),this.date()+1)-1;break;case"hour":t=this._d.valueOf(),t+=un-fn(t+(this._isUTC?0:this.utcOffset()*cn),un)-1;break;case"minute":t=this._d.valueOf(),t+=cn-fn(t,cn)-1;break;case"second":t=this._d.valueOf(),t+=hn-fn(t,hn)-1}return this._d.setTime(t),s.updateOffset(this,!0),this}function vn(){return this._d.valueOf()-6e4*(this._offset||0)}function bn(){return Math.floor(this.valueOf()/1e3)}function En(){return new Date(this.valueOf())}function yn(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function Mn(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function Tn(){return this.isValid()?this.toISOString():null}function An(){return _(this)}function Sn(){return f({},m(this))}function In(){return m(this).overflow}function Cn(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}function Dn(e,t){var i,n,r,a=this._eras||_i("en")._eras;for(i=0,n=a.length;i<n;++i)switch("string"==typeof a[i].since&&(r=s(a[i].since).startOf("day"),a[i].since=r.valueOf()),typeof a[i].until){case"undefined":a[i].until=1/0;break;case"string":r=s(a[i].until).startOf("day").valueOf(),a[i].until=r.valueOf()}return a}function Pn(e,t,i){var s,n,r,a,o,l=this.eras();for(e=e.toUpperCase(),s=0,n=l.length;s<n;++s)if(r=l[s].name.toUpperCase(),a=l[s].abbr.toUpperCase(),o=l[s].narrow.toUpperCase(),i)switch(t){case"N":case"NN":case"NNN":if(a===e)return l[s];break;case"NNNN":if(r===e)return l[s];break;case"NNNNN":if(o===e)return l[s]}else if([r,a,o].indexOf(e)>=0)return l[s]}function xn(e,t){var i=e.since<=e.until?1:-1;return void 0===t?s(e.since).year():s(e.since).year()+(t-e.offset)*i}function Rn(){var e,t,i,s=this.localeData().eras();for(e=0,t=s.length;e<t;++e){if(i=this.clone().startOf("day").valueOf(),s[e].since<=i&&i<=s[e].until)return s[e].name;if(s[e].until<=i&&i<=s[e].since)return s[e].name}return""}function On(){var e,t,i,s=this.localeData().eras();for(e=0,t=s.length;e<t;++e){if(i=this.clone().startOf("day").valueOf(),s[e].since<=i&&i<=s[e].until)return s[e].narrow;if(s[e].until<=i&&i<=s[e].since)return s[e].narrow}return""}function Nn(){var e,t,i,s=this.localeData().eras();for(e=0,t=s.length;e<t;++e){if(i=this.clone().startOf("day").valueOf(),s[e].since<=i&&i<=s[e].until)return s[e].abbr;if(s[e].until<=i&&i<=s[e].since)return s[e].abbr}return""}function wn(){var e,t,i,n,r=this.localeData().eras();for(e=0,t=r.length;e<t;++e)if(i=r[e].since<=r[e].until?1:-1,n=this.clone().startOf("day").valueOf(),r[e].since<=n&&n<=r[e].until||r[e].until<=n&&n<=r[e].since)return(this.year()-s(r[e].since).year())*i+r[e].offset;return this.year()}function Ln(e){return o(this,"_erasNameRegex")||Wn.call(this),e?this._erasNameRegex:this._erasRegex}function Fn(e){return o(this,"_erasAbbrRegex")||Wn.call(this),e?this._erasAbbrRegex:this._erasRegex}function Bn(e){return o(this,"_erasNarrowRegex")||Wn.call(this),e?this._erasNarrowRegex:this._erasRegex}function Un(e,t){return t.erasAbbrRegex(e)}function kn(e,t){return t.erasNameRegex(e)}function Vn(e,t){return t.erasNarrowRegex(e)}function Gn(e,t){return t._eraYearOrdinalRegex||De}function Wn(){var e,t,i=[],s=[],n=[],r=[],a=this.eras();for(e=0,t=a.length;e<t;++e)s.push(Be(a[e].name)),i.push(Be(a[e].abbr)),n.push(Be(a[e].narrow)),r.push(Be(a[e].name)),r.push(Be(a[e].abbr)),r.push(Be(a[e].narrow));this._erasRegex=new RegExp("^("+r.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+s.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+i.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+n.join("|")+")","i")}function zn(e,t){V(0,[e,e.length],0,t)}function Hn(e){return Qn.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function Xn(e){return Qn.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function jn(){return Tt(this.year(),1,4)}function Yn(){return Tt(this.isoWeekYear(),1,4)}function qn(){var e=this.localeData()._week;return Tt(this.year(),e.dow,e.doy)}function Kn(){var e=this.localeData()._week;return Tt(this.weekYear(),e.dow,e.doy)}function Qn(e,t,i,s,n){var r;return null==e?Mt(this,s,n).year:(t>(r=Tt(e,s,n))&&(t=r),Zn.call(this,e,t,i,s,n))}function Zn(e,t,i,s,n){var r=yt(e,t,i,s,n),a=bt(r.year,0,r.dayOfYear);return this.year(a.getUTCFullYear()),this.month(a.getUTCMonth()),this.date(a.getUTCDate()),this}function $n(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)}V("N",0,0,"eraAbbr"),V("NN",0,0,"eraAbbr"),V("NNN",0,0,"eraAbbr"),V("NNNN",0,0,"eraName"),V("NNNNN",0,0,"eraNarrow"),V("y",["y",1],"yo","eraYear"),V("y",["yy",2],0,"eraYear"),V("y",["yyy",3],0,"eraYear"),V("y",["yyyy",4],0,"eraYear"),we("N",Un),we("NN",Un),we("NNN",Un),we("NNNN",kn),we("NNNNN",Vn),ke(["N","NN","NNN","NNNN","NNNNN"],(function(e,t,i,s){var n=i._locale.erasParse(e,s,i._strict);n?m(i).era=n:m(i).invalidEra=e})),we("y",De),we("yy",De),we("yyy",De),we("yyyy",De),we("yo",Gn),ke(["y","yy","yyy","yyyy"],ze),ke(["yo"],(function(e,t,i,s){var n;i._locale._eraYearOrdinalRegex&&(n=e.match(i._locale._eraYearOrdinalRegex)),i._locale.eraYearOrdinalParse?t[ze]=i._locale.eraYearOrdinalParse(e,n):t[ze]=parseInt(e,10)})),V(0,["gg",2],0,(function(){return this.weekYear()%100})),V(0,["GG",2],0,(function(){return this.isoWeekYear()%100})),zn("gggg","weekYear"),zn("ggggg","weekYear"),zn("GGGG","isoWeekYear"),zn("GGGGG","isoWeekYear"),ie("weekYear","gg"),ie("isoWeekYear","GG"),ae("weekYear",1),ae("isoWeekYear",1),we("G",Pe),we("g",Pe),we("GG",Me,ve),we("gg",Me,ve),we("GGGG",Ie,Ee),we("gggg",Ie,Ee),we("GGGGG",Ce,ye),we("ggggg",Ce,ye),Ve(["gggg","ggggg","GGGG","GGGGG"],(function(e,t,i,s){t[s.substr(0,2)]=ce(e)})),Ve(["gg","GG"],(function(e,t,i,n){t[n]=s.parseTwoDigitYear(e)})),V("Q",0,"Qo","quarter"),ie("quarter","Q"),ae("quarter",7),we("Q",_e),ke("Q",(function(e,t){t[He]=3*(ce(e)-1)})),V("D",["DD",2],"Do","date"),ie("date","D"),ae("date",9),we("D",Me),we("DD",Me,ve),we("Do",(function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient})),ke(["D","DD"],Xe),ke("Do",(function(e,t){t[Xe]=ce(e.match(Me)[0])}));var Jn=ue("Date",!0);function er(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==e?t:this.add(e-t,"d")}V("DDD",["DDDD",3],"DDDo","dayOfYear"),ie("dayOfYear","DDD"),ae("dayOfYear",4),we("DDD",Se),we("DDDD",be),ke(["DDD","DDDD"],(function(e,t,i){i._dayOfYear=ce(e)})),V("m",["mm",2],0,"minute"),ie("minute","m"),ae("minute",14),we("m",Me),we("mm",Me,ve),ke(["m","mm"],Ye);var tr=ue("Minutes",!1);V("s",["ss",2],0,"second"),ie("second","s"),ae("second",15),we("s",Me),we("ss",Me,ve),ke(["s","ss"],qe);var ir,sr,nr=ue("Seconds",!1);for(V("S",0,0,(function(){return~~(this.millisecond()/100)})),V(0,["SS",2],0,(function(){return~~(this.millisecond()/10)})),V(0,["SSS",3],0,"millisecond"),V(0,["SSSS",4],0,(function(){return 10*this.millisecond()})),V(0,["SSSSS",5],0,(function(){return 100*this.millisecond()})),V(0,["SSSSSS",6],0,(function(){return 1e3*this.millisecond()})),V(0,["SSSSSSS",7],0,(function(){return 1e4*this.millisecond()})),V(0,["SSSSSSSS",8],0,(function(){return 1e5*this.millisecond()})),V(0,["SSSSSSSSS",9],0,(function(){return 1e6*this.millisecond()})),ie("millisecond","ms"),ae("millisecond",16),we("S",Se,_e),we("SS",Se,ve),we("SSS",Se,be),ir="SSSS";ir.length<=9;ir+="S")we(ir,De);function rr(e,t){t[Ke]=ce(1e3*("0."+e))}for(ir="S";ir.length<=9;ir+="S")ke(ir,rr);function ar(){return this._isUTC?"UTC":""}function or(){return this._isUTC?"Coordinated Universal Time":""}sr=ue("Milliseconds",!1),V("z",0,0,"zoneAbbr"),V("zz",0,0,"zoneName");var lr=M.prototype;function hr(e){return qi(1e3*e)}function cr(){return qi.apply(null,arguments).parseZone()}function ur(e){return e}lr.add=Ns,lr.calendar=Gs,lr.clone=Ws,lr.diff=Ks,lr.endOf=_n,lr.format=en,lr.from=tn,lr.fromNow=sn,lr.to=nn,lr.toNow=rn,lr.get=pe,lr.invalidAt=In,lr.isAfter=zs,lr.isBefore=Hs,lr.isBetween=Xs,lr.isSame=js,lr.isSameOrAfter=Ys,lr.isSameOrBefore=qs,lr.isValid=An,lr.lang=on,lr.locale=an,lr.localeData=ln,lr.max=Qi,lr.min=Ki,lr.parsingFlags=Sn,lr.set=ge,lr.startOf=mn,lr.subtract=ws,lr.toArray=yn,lr.toObject=Mn,lr.toDate=En,lr.toISOString=$s,lr.inspect=Js,"undefined"!=typeof Symbol&&null!=Symbol.for&&(lr[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"}),lr.toJSON=Tn,lr.toString=Zs,lr.unix=bn,lr.valueOf=vn,lr.creationData=Cn,lr.eraName=Rn,lr.eraNarrow=On,lr.eraAbbr=Nn,lr.eraYear=wn,lr.year=mt,lr.isLeapYear=_t,lr.weekYear=Hn,lr.isoWeekYear=Xn,lr.quarter=lr.quarters=$n,lr.month=ct,lr.daysInMonth=ut,lr.week=lr.weeks=Dt,lr.isoWeek=lr.isoWeeks=Pt,lr.weeksInYear=qn,lr.weeksInWeekYear=Kn,lr.isoWeeksInYear=jn,lr.isoWeeksInISOWeekYear=Yn,lr.date=Jn,lr.day=lr.days=Ht,lr.weekday=Xt,lr.isoWeekday=jt,lr.dayOfYear=er,lr.hour=lr.hours=si,lr.minute=lr.minutes=tr,lr.second=lr.seconds=nr,lr.millisecond=lr.milliseconds=sr,lr.utcOffset=ps,lr.utc=ms,lr.local=_s,lr.parseZone=vs,lr.hasAlignedHourOffset=bs,lr.isDST=Es,lr.isLocal=Ms,lr.isUtcOffset=Ts,lr.isUtc=As,lr.isUTC=As,lr.zoneAbbr=ar,lr.zoneName=or,lr.dates=S("dates accessor is deprecated. Use date instead.",Jn),lr.months=S("months accessor is deprecated. Use month instead",ct),lr.years=S("years accessor is deprecated. Use year instead",mt),lr.zone=S("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",gs),lr.isDSTShifted=S("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",ys);var dr=O.prototype;function fr(e,t,i,s){var n=_i(),r=p().set(s,t);return n[i](r,e)}function pr(e,t,i){if(c(e)&&(t=e,e=void 0),e=e||"",null!=t)return fr(e,t,i,"month");var s,n=[];for(s=0;s<12;s++)n[s]=fr(e,s,i,"month");return n}function gr(e,t,i,s){"boolean"==typeof e?(c(t)&&(i=t,t=void 0),t=t||""):(i=t=e,e=!1,c(t)&&(i=t,t=void 0),t=t||"");var n,r=_i(),a=e?r._week.dow:0,o=[];if(null!=i)return fr(t,(i+a)%7,s,"day");for(n=0;n<7;n++)o[n]=fr(t,(n+a)%7,s,"day");return o}function mr(e,t){return pr(e,t,"months")}function _r(e,t){return pr(e,t,"monthsShort")}function vr(e,t,i){return gr(e,t,i,"weekdays")}function br(e,t,i){return gr(e,t,i,"weekdaysShort")}function Er(e,t,i){return gr(e,t,i,"weekdaysMin")}dr.calendar=w,dr.longDateFormat=j,dr.invalidDate=q,dr.ordinal=Z,dr.preparse=ur,dr.postformat=ur,dr.relativeTime=J,dr.pastFuture=ee,dr.set=x,dr.eras=Dn,dr.erasParse=Pn,dr.erasConvertYear=xn,dr.erasAbbrRegex=Fn,dr.erasNameRegex=Ln,dr.erasNarrowRegex=Bn,dr.months=rt,dr.monthsShort=at,dr.monthsParse=lt,dr.monthsRegex=ft,dr.monthsShortRegex=dt,dr.week=At,dr.firstDayOfYear=Ct,dr.firstDayOfWeek=It,dr.weekdays=kt,dr.weekdaysMin=Gt,dr.weekdaysShort=Vt,dr.weekdaysParse=zt,dr.weekdaysRegex=Yt,dr.weekdaysShortRegex=qt,dr.weekdaysMinRegex=Kt,dr.isPM=ti,dr.meridiem=ni,pi("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10;return e+(1===ce(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")}}),s.lang=S("moment.lang is deprecated. Use moment.locale instead.",pi),s.langData=S("moment.langData is deprecated. Use moment.localeData instead.",_i);var yr=Math.abs;function Mr(){var e=this._data;return this._milliseconds=yr(this._milliseconds),this._days=yr(this._days),this._months=yr(this._months),e.milliseconds=yr(e.milliseconds),e.seconds=yr(e.seconds),e.minutes=yr(e.minutes),e.hours=yr(e.hours),e.months=yr(e.months),e.years=yr(e.years),this}function Tr(e,t,i,s){var n=Cs(t,i);return e._milliseconds+=s*n._milliseconds,e._days+=s*n._days,e._months+=s*n._months,e._bubble()}function Ar(e,t){return Tr(this,e,t,1)}function Sr(e,t){return Tr(this,e,t,-1)}function Ir(e){return e<0?Math.floor(e):Math.ceil(e)}function Cr(){var e,t,i,s,n,r=this._milliseconds,a=this._days,o=this._months,l=this._data;return r>=0&&a>=0&&o>=0||r<=0&&a<=0&&o<=0||(r+=864e5*Ir(Pr(o)+a),a=0,o=0),l.milliseconds=r%1e3,e=he(r/1e3),l.seconds=e%60,t=he(e/60),l.minutes=t%60,i=he(t/60),l.hours=i%24,a+=he(i/24),o+=n=he(Dr(a)),a-=Ir(Pr(n)),s=he(o/12),o%=12,l.days=a,l.months=o,l.years=s,this}function Dr(e){return 4800*e/146097}function Pr(e){return 146097*e/4800}function xr(e){if(!this.isValid())return NaN;var t,i,s=this._milliseconds;if("month"===(e=se(e))||"quarter"===e||"year"===e)switch(t=this._days+s/864e5,i=this._months+Dr(t),e){case"month":return i;case"quarter":return i/3;case"year":return i/12}else switch(t=this._days+Math.round(Pr(this._months)),e){case"week":return t/7+s/6048e5;case"day":return t+s/864e5;case"hour":return 24*t+s/36e5;case"minute":return 1440*t+s/6e4;case"second":return 86400*t+s/1e3;case"millisecond":return Math.floor(864e5*t)+s;default:throw new Error("Unknown unit "+e)}}function Rr(){return this.isValid()?this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*ce(this._months/12):NaN}function Or(e){return function(){return this.as(e)}}var Nr=Or("ms"),wr=Or("s"),Lr=Or("m"),Fr=Or("h"),Br=Or("d"),Ur=Or("w"),kr=Or("M"),Vr=Or("Q"),Gr=Or("y");function Wr(){return Cs(this)}function zr(e){return e=se(e),this.isValid()?this[e+"s"]():NaN}function Hr(e){return function(){return this.isValid()?this._data[e]:NaN}}var Xr=Hr("milliseconds"),jr=Hr("seconds"),Yr=Hr("minutes"),qr=Hr("hours"),Kr=Hr("days"),Qr=Hr("months"),Zr=Hr("years");function $r(){return he(this.days()/7)}var Jr=Math.round,ea={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function ta(e,t,i,s,n){return n.relativeTime(t||1,!!i,e,s)}function ia(e,t,i,s){var n=Cs(e).abs(),r=Jr(n.as("s")),a=Jr(n.as("m")),o=Jr(n.as("h")),l=Jr(n.as("d")),h=Jr(n.as("M")),c=Jr(n.as("w")),u=Jr(n.as("y")),d=r<=i.ss&&["s",r]||r<i.s&&["ss",r]||a<=1&&["m"]||a<i.m&&["mm",a]||o<=1&&["h"]||o<i.h&&["hh",o]||l<=1&&["d"]||l<i.d&&["dd",l];return null!=i.w&&(d=d||c<=1&&["w"]||c<i.w&&["ww",c]),(d=d||h<=1&&["M"]||h<i.M&&["MM",h]||u<=1&&["y"]||["yy",u])[2]=t,d[3]=+e>0,d[4]=s,ta.apply(null,d)}function sa(e){return void 0===e?Jr:"function"==typeof e&&(Jr=e,!0)}function na(e,t){return void 0!==ea[e]&&(void 0===t?ea[e]:(ea[e]=t,"s"===e&&(ea.ss=t-1),!0))}function ra(e,t){if(!this.isValid())return this.localeData().invalidDate();var i,s,n=!1,r=ea;return"object"==typeof e&&(t=e,e=!1),"boolean"==typeof e&&(n=e),"object"==typeof t&&(r=Object.assign({},ea,t),null!=t.s&&null==t.ss&&(r.ss=t.s-1)),s=ia(this,!n,r,i=this.localeData()),n&&(s=i.pastFuture(+this,s)),i.postformat(s)}var aa=Math.abs;function oa(e){return(e>0)-(e<0)||+e}function la(){if(!this.isValid())return this.localeData().invalidDate();var e,t,i,s,n,r,a,o,l=aa(this._milliseconds)/1e3,h=aa(this._days),c=aa(this._months),u=this.asSeconds();return u?(e=he(l/60),t=he(e/60),l%=60,e%=60,i=he(c/12),c%=12,s=l?l.toFixed(3).replace(/\.?0+$/,""):"",n=u<0?"-":"",r=oa(this._months)!==oa(u)?"-":"",a=oa(this._days)!==oa(u)?"-":"",o=oa(this._milliseconds)!==oa(u)?"-":"",n+"P"+(i?r+i+"Y":"")+(c?r+c+"M":"")+(h?a+h+"D":"")+(t||e||l?"T":"")+(t?o+t+"H":"")+(e?o+e+"M":"")+(l?o+s+"S":"")):"P0D"}var ha=rs.prototype;return ha.isValid=ss,ha.abs=Mr,ha.add=Ar,ha.subtract=Sr,ha.as=xr,ha.asMilliseconds=Nr,ha.asSeconds=wr,ha.asMinutes=Lr,ha.asHours=Fr,ha.asDays=Br,ha.asWeeks=Ur,ha.asMonths=kr,ha.asQuarters=Vr,ha.asYears=Gr,ha.valueOf=Rr,ha._bubble=Cr,ha.clone=Wr,ha.get=zr,ha.milliseconds=Xr,ha.seconds=jr,ha.minutes=Yr,ha.hours=qr,ha.days=Kr,ha.weeks=$r,ha.months=Qr,ha.years=Zr,ha.humanize=ra,ha.toISOString=la,ha.toString=la,ha.toJSON=la,ha.locale=an,ha.localeData=ln,ha.toIsoString=S("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",la),ha.lang=on,V("X",0,0,"unix"),V("x",0,0,"valueOf"),we("x",Pe),we("X",Oe),ke("X",(function(e,t,i){i._d=new Date(1e3*parseFloat(e))})),ke("x",(function(e,t,i){i._d=new Date(ce(e))})),s.version="2.29.4",n(qi),s.fn=lr,s.min=$i,s.max=Ji,s.now=es,s.utc=p,s.unix=hr,s.months=mr,s.isDate=u,s.locale=pi,s.invalid=v,s.duration=Cs,s.isMoment=T,s.weekdays=vr,s.parseZone=cr,s.localeData=_i,s.isDuration=as,s.monthsShort=_r,s.weekdaysMin=Er,s.defineLocale=gi,s.updateLocale=mi,s.locales=vi,s.weekdaysShort=br,s.normalizeUnits=se,s.relativeTimeRounding=sa,s.relativeTimeThreshold=na,s.calendarFormat=Vs,s.prototype=lr,s.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"},s}()},5333:function(e,t,i){"use strict";i.d(t,{_y:function(){return a},zt:function(){return r}});var s=i(7294);i(5706);var n="undefined"!=typeof window?window.__REACT_INTL_CONTEXT__||(window.__REACT_INTL_CONTEXT__=s.createContext(null)):s.createContext(null),r=(n.Consumer,n.Provider),a=n},78:function(e,t,i){"use strict";i.d(t,{Z:function(){return X}});var s=i(9900),n=i(7294),r=i(5333),a=i(5861),o=i(5477),l=i(1482),h=i(4889),c=i(7959);function u(e,t){return Object.keys(e).reduce((function(i,n){return i[n]=(0,s.pi)({timeZone:t},e[n]),i}),{})}function d(e,t){return Object.keys((0,s.pi)((0,s.pi)({},e),t)).reduce((function(i,n){return i[n]=(0,s.pi)((0,s.pi)({},e[n]||{}),t[n]||{}),i}),{})}function f(e,t){if(!t)return e;var i=l.C.formats;return(0,s.pi)((0,s.pi)((0,s.pi)({},i),e),{date:d(u(i.date,t),u(e.date||{},t)),time:d(u(i.time,t),u(e.time||{},t))})}var p=function(e,t,i,n,r){var a=e.locale,l=e.formats,u=e.messages,d=e.defaultLocale,p=e.defaultFormats,g=e.fallbackOnEmptyString,m=e.onError,_=e.timeZone,v=e.defaultRichTextElements;void 0===i&&(i={id:""});var b=i.id,E=i.defaultMessage;(0,o.kG)(!!b,"[@formatjs/intl] An `id` must be provided to format a message. You can either:\n1. Configure your build toolchain with [babel-plugin-formatjs](https://formatjs.io/docs/tooling/babel-plugin)\nor [@formatjs/ts-transformer](https://formatjs.io/docs/tooling/ts-transformer) OR\n2. Configure your `eslint` config to include [eslint-plugin-formatjs](https://formatjs.io/docs/tooling/linter#enforce-id)\nto autofix this issue");var y=String(b),M=u&&Object.prototype.hasOwnProperty.call(u,y)&&u[y];if(Array.isArray(M)&&1===M.length&&M[0].type===c.wD.literal)return M[0].value;if(!n&&M&&"string"==typeof M&&!v)return M.replace(/'\{(.*?)\}'/gi,"{$1}");if(n=(0,s.pi)((0,s.pi)({},v),n||{}),l=f(l,_),p=f(p,_),!M){if(!1===g&&""===M)return M;if((!E||a&&a.toLowerCase()!==d.toLowerCase())&&m(new h.$6(i,a)),E)try{return t.getMessageFormat(E,d,p,r).format(n)}catch(T){return m(new h.X9('Error formatting default message for: "'.concat(y,'", rendering default message verbatim'),a,i,T)),"string"==typeof E?E:y}return y}try{return t.getMessageFormat(M,a,l,(0,s.pi)({formatters:t},r||{})).format(n)}catch(T){m(new h.X9('Error formatting message: "'.concat(y,'", using ').concat(E?"default message":"id"," as fallback."),a,i,T))}if(E)try{return t.getMessageFormat(E,d,p,r).format(n)}catch(T){m(new h.X9('Error formatting the default message for: "'.concat(y,'", rendering message verbatim'),a,i,T))}return"string"==typeof M?M:"string"==typeof E?E:y},g=i(7143),m=["style","currency","currencyDisplay","unit","unitDisplay","useGrouping","minimumIntegerDigits","minimumFractionDigits","maximumFractionDigits","minimumSignificantDigits","maximumSignificantDigits","compactDisplay","currencyDisplay","currencySign","notation","signDisplay","unit","unitDisplay","numberingSystem"];function _(e,t,i){var s=e.locale,n=e.formats,r=e.onError;void 0===i&&(i={});var a=i.format,o=a&&(0,g.TB)(n,"number",a,r)||{};return t(s,(0,g.L6)(i,m,o))}function v(e,t,i,s){void 0===s&&(s={});try{return _(e,t,s).format(i)}catch(n){e.onError(new h.Rw(h.bc.FORMAT_ERROR,"Error formatting number.",n))}return String(i)}function b(e,t,i,s){void 0===s&&(s={});try{return _(e,t,s).formatToParts(i)}catch(n){e.onError(new h.Rw(h.bc.FORMAT_ERROR,"Error formatting number.",n))}return[]}var E=i(8402),y=["numeric","style"];function M(e,t,i,s,n){void 0===n&&(n={}),s||(s="second"),Intl.RelativeTimeFormat||e.onError(new E.u_('Intl.RelativeTimeFormat is not available in this environment.\nTry polyfilling it using "@formatjs/intl-relativetimeformat"\n',E.jK.MISSING_INTL_API));try{return function(e,t,i){var s=e.locale,n=e.formats,r=e.onError;void 0===i&&(i={});var a=i.format,o=!!a&&(0,g.TB)(n,"relative",a,r)||{};return t(s,(0,g.L6)(i,y,o))}(e,t,n).format(i,s)}catch(r){e.onError(new h.Qe("Error formatting relative time.",e.locale,r))}return String(i)}var T=["formatMatcher","timeZone","hour12","weekday","era","year","month","day","hour","minute","second","timeZoneName","hourCycle","dateStyle","timeStyle","calendar","numberingSystem","fractionalSecondDigits"];function A(e,t,i,n){var r=e.locale,a=e.formats,o=e.onError,l=e.timeZone;void 0===n&&(n={});var h=n.format,c=(0,s.pi)((0,s.pi)({},l&&{timeZone:l}),h&&(0,g.TB)(a,t,h,o)),u=(0,g.L6)(n,T,c);return"time"!==t||u.hour||u.minute||u.second||u.timeStyle||u.dateStyle||(u=(0,s.pi)((0,s.pi)({},u),{hour:"numeric",minute:"numeric"})),i(r,u)}function S(e,t){for(var i=[],s=2;s<arguments.length;s++)i[s-2]=arguments[s];var n=i[0],r=i[1],a=void 0===r?{}:r,o="string"==typeof n?new Date(n||0):n;try{return A(e,"date",t,a).format(o)}catch(l){e.onError(new h.Rw(h.bc.FORMAT_ERROR,"Error formatting date.",l))}return String(o)}function I(e,t){for(var i=[],s=2;s<arguments.length;s++)i[s-2]=arguments[s];var n=i[0],r=i[1],a=void 0===r?{}:r,o="string"==typeof n?new Date(n||0):n;try{return A(e,"time",t,a).format(o)}catch(l){e.onError(new h.Rw(h.bc.FORMAT_ERROR,"Error formatting time.",l))}return String(o)}function C(e,t){for(var i=[],s=2;s<arguments.length;s++)i[s-2]=arguments[s];var n=i[0],r=i[1],a=i[2],o=void 0===a?{}:a,l=e.timeZone,c=e.locale,u=e.onError,d=(0,g.L6)(o,T,l?{timeZone:l}:{});try{return t(c,d).formatRange(n,r)}catch(f){u(new h.Rw(h.bc.FORMAT_ERROR,"Error formatting date time range.",f))}return String(n)}function D(e,t){for(var i=[],s=2;s<arguments.length;s++)i[s-2]=arguments[s];var n=i[0],r=i[1],a=void 0===r?{}:r,o="string"==typeof n?new Date(n||0):n;try{return A(e,"date",t,a).formatToParts(o)}catch(l){e.onError(new h.Rw(h.bc.FORMAT_ERROR,"Error formatting date.",l))}return[]}function P(e,t){for(var i=[],s=2;s<arguments.length;s++)i[s-2]=arguments[s];var n=i[0],r=i[1],a=void 0===r?{}:r,o="string"==typeof n?new Date(n||0):n;try{return A(e,"time",t,a).formatToParts(o)}catch(l){e.onError(new h.Rw(h.bc.FORMAT_ERROR,"Error formatting time.",l))}return[]}var x=["type"];function R(e,t,i,s){var n=e.locale,r=e.onError;void 0===s&&(s={}),Intl.PluralRules||r(new E.u_('Intl.PluralRules is not available in this environment.\nTry polyfilling it using "@formatjs/intl-pluralrules"\n',E.jK.MISSING_INTL_API));var a=(0,g.L6)(s,x);try{return t(n,a).select(i)}catch(o){r(new h.Qe("Error formatting plural.",n,o))}return"other"}var O=["type","style"],N=Date.now();function w(e,t,i,s){void 0===s&&(s={});var n=L(e,t,i,s).reduce((function(e,t){var i=t.value;return"string"!=typeof i?e.push(i):"string"==typeof e[e.length-1]?e[e.length-1]+=i:e.push(i),e}),[]);return 1===n.length?n[0]:0===n.length?"":n}function L(e,t,i,n){var r=e.locale,a=e.onError;void 0===n&&(n={}),Intl.ListFormat||a(new E.u_('Intl.ListFormat is not available in this environment.\nTry polyfilling it using "@formatjs/intl-listformat"\n',E.jK.MISSING_INTL_API));var o=(0,g.L6)(n,O);try{var l={},c=i.map((function(e,t){if("object"==typeof e){var i=function(e){return"".concat(N,"_").concat(e,"_").concat(N)}(t);return l[i]=e,i}return String(e)}));return t(r,o).formatToParts(c).map((function(e){return"literal"===e.type?e:(0,s.pi)((0,s.pi)({},e),{value:l[e.value]||e.value})}))}catch(u){a(new h.Rw(h.bc.FORMAT_ERROR,"Error formatting list.",u))}return i}var F=["style","type","fallback","languageDisplay"];function B(e,t,i,s){var n=e.locale,r=e.onError;Intl.DisplayNames||r(new E.u_('Intl.DisplayNames is not available in this environment.\nTry polyfilling it using "@formatjs/intl-displaynames"\n',E.jK.MISSING_INTL_API));var a=(0,g.L6)(s,F);try{return t(n,a).of(i)}catch(o){r(new h.Rw(h.bc.FORMAT_ERROR,"Error formatting display name.",o))}}function U(e){var t;e.onWarn&&e.defaultRichTextElements&&"string"==typeof((t=e.messages||{})?t[Object.keys(t)[0]]:void 0)&&e.onWarn('[@formatjs/intl] "defaultRichTextElements" was specified but "message" was not pre-compiled. \nPlease consider using "@formatjs/cli" to pre-compile your messages for performance.\nFor more details see https://formatjs.io/docs/getting-started/message-distribution')}var k=i(4597);function V(e){return{locale:e.locale,timeZone:e.timeZone,fallbackOnEmptyString:e.fallbackOnEmptyString,formats:e.formats,textComponent:e.textComponent,messages:e.messages,defaultLocale:e.defaultLocale,defaultFormats:e.defaultFormats,onError:e.onError,onWarn:e.onWarn,wrapRichTextChunksInFragment:e.wrapRichTextChunksInFragment,defaultRichTextElements:e.defaultRichTextElements}}function G(e){return e?Object.keys(e).reduce((function(t,i){var s=e[i];return t[i]=(0,k.Gt)(s)?(0,a.dt)(s):s,t}),{}):e}var W=function(e,t,i,r){for(var a=[],o=4;o<arguments.length;o++)a[o-4]=arguments[o];var l=G(r),h=p.apply(void 0,(0,s.ev)([e,t,i,l],a,!1));return Array.isArray(h)?n.Children.toArray(h):h},z=function(e,t){var i=e.defaultRichTextElements,n=(0,s._T)(e,["defaultRichTextElements"]),r=G(i),o=function(e,t){var i=(0,g.ax)(t),n=(0,s.pi)((0,s.pi)({},g.Z0),e),r=n.locale,a=n.defaultLocale,o=n.onError;return r?!Intl.NumberFormat.supportedLocalesOf(r).length&&o?o(new h.gb('Missing locale data for locale: "'.concat(r,'" in Intl.NumberFormat. Using default locale: "').concat(a,'" as fallback. See https://formatjs.io/docs/react-intl#runtime-requirements for more details'))):!Intl.DateTimeFormat.supportedLocalesOf(r).length&&o&&o(new h.gb('Missing locale data for locale: "'.concat(r,'" in Intl.DateTimeFormat. Using default locale: "').concat(a,'" as fallback. See https://formatjs.io/docs/react-intl#runtime-requirements for more details'))):(o&&o(new h.OV('"locale" was not configured, using "'.concat(a,'" as fallback. See https://formatjs.io/docs/react-intl/api#intlshape for more details'))),n.locale=n.defaultLocale||"en"),U(n),(0,s.pi)((0,s.pi)({},n),{formatters:i,formatNumber:v.bind(null,n,i.getNumberFormat),formatNumberToParts:b.bind(null,n,i.getNumberFormat),formatRelativeTime:M.bind(null,n,i.getRelativeTimeFormat),formatDate:S.bind(null,n,i.getDateTimeFormat),formatDateToParts:D.bind(null,n,i.getDateTimeFormat),formatTime:I.bind(null,n,i.getDateTimeFormat),formatDateTimeRange:C.bind(null,n,i.getDateTimeFormat),formatTimeToParts:P.bind(null,n,i.getDateTimeFormat),formatPlural:R.bind(null,n,i.getPluralRules),formatMessage:p.bind(null,n,i),$t:p.bind(null,n,i),formatList:w.bind(null,n,i.getListFormat),formatListToParts:L.bind(null,n,i.getListFormat),formatDisplayName:B.bind(null,n,i.getDisplayNames)})}((0,s.pi)((0,s.pi)((0,s.pi)({},a.Z0),n),{defaultRichTextElements:r}),t),l={locale:o.locale,timeZone:o.timeZone,fallbackOnEmptyString:o.fallbackOnEmptyString,formats:o.formats,defaultLocale:o.defaultLocale,defaultFormats:o.defaultFormats,messages:o.messages,onError:o.onError,defaultRichTextElements:r};return(0,s.pi)((0,s.pi)({},o),{formatMessage:W.bind(null,l,o.formatters),$t:W.bind(null,l,o.formatters)})},H=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.cache=(0,g.Sn)(),t.state={cache:t.cache,intl:z(V(t.props),t.cache),prevConfig:V(t.props)},t}return(0,s.ZT)(t,e),t.getDerivedStateFromProps=function(e,t){var i=t.prevConfig,s=t.cache,n=V(e);return(0,a.wU)(i,n)?null:{intl:z(n,s),prevConfig:n}},t.prototype.render=function(){return(0,a.lq)(this.state.intl),n.createElement(r.zt,{value:this.state.intl},this.props.children)},t.displayName="IntlProvider",t.defaultProps=a.Z0,t}(n.PureComponent),X=H},9785:function(e,t,i){"use strict";i.d(t,{Z:function(){return a}});var s=i(7294),n=i(5333),r=i(5861);function a(){var e=s.useContext(n._y);return(0,r.lq)(e),e}},5861:function(e,t,i){"use strict";i.d(t,{Z0:function(){return l},dt:function(){return h},lq:function(){return o},wU:function(){return c}});var s=i(9900),n=i(7294),r=i(5477),a=i(7143);function o(e){(0,r.kG)(e,"[React Intl] Could not find required `intl` object. <IntlProvider> needs to exist in the component ancestry.")}var l=(0,s.pi)((0,s.pi)({},a.Z0),{textComponent:n.Fragment});function h(e){return function(t){return e(n.Children.toArray(t))}}function c(e,t){if(e===t)return!0;if(!e||!t)return!1;var i=Object.keys(e),s=Object.keys(t),n=i.length;if(s.length!==n)return!1;for(var r=0;r<n;r++){var a=i[r];if(e[a]!==t[a]||!Object.prototype.hasOwnProperty.call(t,a))return!1}return!0}},165:function(e,t){"use strict";var i="function"==typeof Symbol&&Symbol.for,s=i?Symbol.for("react.element"):60103,n=i?Symbol.for("react.portal"):60106,r=i?Symbol.for("react.fragment"):60107,a=i?Symbol.for("react.strict_mode"):60108,o=i?Symbol.for("react.profiler"):60114,l=i?Symbol.for("react.provider"):60109,h=i?Symbol.for("react.context"):60110,c=i?Symbol.for("react.async_mode"):60111,u=i?Symbol.for("react.concurrent_mode"):60111,d=i?Symbol.for("react.forward_ref"):60112,f=i?Symbol.for("react.suspense"):60113,p=i?Symbol.for("react.suspense_list"):60120,g=i?Symbol.for("react.memo"):60115,m=i?Symbol.for("react.lazy"):60116,_=i?Symbol.for("react.block"):60121,v=i?Symbol.for("react.fundamental"):60117,b=i?Symbol.for("react.responder"):60118,E=i?Symbol.for("react.scope"):60119;function y(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case s:switch(e=e.type){case c:case u:case r:case o:case a:case f:return e;default:switch(e=e&&e.$$typeof){case h:case d:case m:case g:case l:return e;default:return t}}case n:return t}}}function M(e){return y(e)===u}t.AsyncMode=c,t.ConcurrentMode=u,t.ContextConsumer=h,t.ContextProvider=l,t.Element=s,t.ForwardRef=d,t.Fragment=r,t.Lazy=m,t.Memo=g,t.Portal=n,t.Profiler=o,t.StrictMode=a,t.Suspense=f,t.isAsyncMode=function(e){return M(e)||y(e)===c},t.isConcurrentMode=M,t.isContextConsumer=function(e){return y(e)===h},t.isContextProvider=function(e){return y(e)===l},t.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===s},t.isForwardRef=function(e){return y(e)===d},t.isFragment=function(e){return y(e)===r},t.isLazy=function(e){return y(e)===m},t.isMemo=function(e){return y(e)===g},t.isPortal=function(e){return y(e)===n},t.isProfiler=function(e){return y(e)===o},t.isStrictMode=function(e){return y(e)===a},t.isSuspense=function(e){return y(e)===f},t.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===r||e===u||e===o||e===a||e===f||e===p||"object"==typeof e&&null!==e&&(e.$$typeof===m||e.$$typeof===g||e.$$typeof===l||e.$$typeof===h||e.$$typeof===d||e.$$typeof===v||e.$$typeof===b||e.$$typeof===E||e.$$typeof===_)},t.typeOf=y},8812:function(e,t,i){"use strict";e.exports=i(165)},9900:function(e,t,i){"use strict";i.d(t,{ZT:function(){return n},_T:function(){return a},ev:function(){return o},pi:function(){return r}});var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},s(e,t)};function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}var r=function(){return r=Object.assign||function(e){for(var t,i=1,s=arguments.length;i<s;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},r.apply(this,arguments)};function a(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(s=Object.getOwnPropertySymbols(e);n<s.length;n++)t.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(e,s[n])&&(i[s[n]]=e[s[n]])}return i}Object.create;function o(e,t,i){if(i||2===arguments.length)for(var s,n=0,r=t.length;n<r;n++)!s&&n in t||(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return e.concat(s||Array.prototype.slice.call(t))}Object.create},3792:function(e,t,i){i(1223)("flat")},9325:function(e,t,i){"use strict";i.d(t,{Z:function(){return s}});var s={en:JSON.parse('{"hero:title":"Start building your product today","hero:subtitle":"We define, build and scale digital products that people want and businesses need.","clients:title":"Our engineers have worked with","cta:title":"They’ll love your product, you’ll love our process.","cta:text":"We offer you the peace of mind of knowing that you are in good hands. ","cta2:title":"Our team thinks sharp, builds fast and deploys frequently.","cta2:action":"I want a team like that!","cta3:title":"Have an awesome idea and not sure how to get started? ","cta3:action":"Help me make it real!","approach:name":"Our approach","team:name":"The team","startups:name":"For startups","team:title":"Meet the team","team:pretitle":"Team","team:position:ignacio":"Project Manager","team:description:ignacio":"Obsessed with the process of continuous improvement. If something poses a challenge, he will find it inviting. Uncontrollable competitive gene.","team:position:antonio":"Tech Consultant","team:description:antonio":"Software engineer specialized in 3D and data visualization technologies. Passionate about teaching, ancient editors and esoteric programming languages.","team:position:sara":"UI Developer","team:description:sara":"Specialist in crafting high-quality digital product experiences. Likes reading, painting and illustrating and has created over 1000 artworks.","team:position:juanlu":"Full Stack","team:description:juanlu":"Inveterate techie and expert drone pilot. Has created dozens of videogames and web experiences. No stack is out of reach.","team:section2:title":"The best product delivery partner","team:claim1":"Product-centric","team:claim2":"Agile and lean","team:claim3":"Lightning fast","team:claim4":"Tailored to you","services:title":"What we can do for you","services:name":"Our services","services:pretitle":"Our main service is to meet your needs","services:intro-text":"Front-end multiplatform applications, scalable cloud infrastructures, complex 3D visualizations... No project is out of your reach. ","services:service1:title":"Product design","services:service1:text":"Design a killer product with the best user experience for your clients.","services:service2:title":"Product development","services:service2:text":"Turn your business idea into reality with the industry’s best technologies.","services:service3:title":"Dedicated team","services:service3:text":"Give a boost to your project with the help of a top tier tech team.","services:service4:title":"Software consultancy","services:service4:text":"Improve your existing software or train your engineers to get to the next level.","services:section2:title":"What you will get from us","services:service5:title":"Faster time to market","services:service6:title":"Things done right","services:service7:title":"Top 1% tech talent","services:service8:title":"True agile development","aucta:title":"We’re the team that built Aucta’s 3D web editor!","aucta:show-case-study":"Show me the case study!","aucta:go":"Go to Aucta!","approach:title":"How we make it work","approach:intro-text":"We’ve narrowed down the process to three simple steps to turn your idea into a digital product.","approach:step1:title":"Discover & define","approach:step1:text":"We sit down with you and learn all there is to know about your product idea and business needs, research your industry, competition and users, to define the best unique value proposition for your product.","approach:step2:title":"Design & build","approach:step2:text":"All that information is then used to design a beatiful and user friendly experience that will be implemented using the industry’s latest technologies to ensure it is optimized to the fullest.","approach:step3:title":"Launch & scale","approach:step3:text":"Finishing the development of the product is not the end of the road. Launching it into market and gathering data from users is key to define the next steps in the product roadmap.","approach:section2:title":"What we can build for you","approach:claim1":"Progressive web apps","approach:claim2":"SaaS applications","approach:claim3":"Enterprise applications","approach:claim4":"Custom CRM systems","approach:claim5":"Cloud-based applications","approach:claim6":"Single page apps","approach:claim7":"Ecommerce","approach:claim8":"API development","startups:title":"Build your business idea with us","startups:why":"Why?","startups:why:text":"Because you will...","startups:how":"How?","startups:how:text":"There’s a lot of work to do...","startups:service1:title":"Have a team with startup experience","startups:service1:text":"We know the problems startups face during the early stages. We’ll help you get the most value.","startups:service2:title":"Save money on development costs","startups:service2:text":"Building a team from the ground up is not an easy nor fast process. A battle tested team will get results faster.","startups:service3:title":"Beat your competition to market","startups:service3:text":"We don’t like to boast, but we work fast. At this early stage in your business, getting to market as soon as possible is a must.","startups:service4:title":"Have a CTO on demand to guide you","startups:service4:text":"Top tech talent is not easy to find. With us you will have access to knowledge that will boost your product.","startups:service5:title":"Idea validation","startups:service6:title":"Technical feasibility check","startups:service7:title":"Brand & UX/UI design","startups:service8:title":"User stories & user journey","startups:service9:title":"MVP feature list","startups:service10:title":"Estimation and timeline","startups:service11:title":"High fidelity design screens","startups:service12:title":"Development & launch","map:title":"You can find us at","map:address1":" Sector Literatos 38.","map:address2":"28760, Tres Cantos. Madrid (Spain)","contact:title":"Got a project in mind? Tell us all about it!","contact:name":"Name","contact:whats-your-name":"What’s your name?","contact:company":"Company","contact:what-company-work":"What company do you work for?","contact:email":"Email","contact:give-us-email":"Give us an email to contact you!","contact:purpose":"I want to:","contact:purpose1":"Hire a development team","contact:purpose2":"Build a digital product from scratch","contact:purpose3":"Redesign an app or improve UX","contact:purpose4":"Something else","contact:budget":"Budget","contact:tell-us-budget":"Tell us your budget! (if you want to)","contact:how-can-we-help-you":"How can we help you?","contact:tell-us-more":"Tell us more about your project!","contact:lets-work-together":"Let’s work together!","contact:error-email":"Incorrect email","contact:error-required":"This field is required","contact:error-select":"Please select one","contact:extra-text":"If you don\'t like forms, you can reach us at <a> hello@bonsaitech.io </a>","quote:text":"I’m saving tons of project management time with Bonsai, because they listen very carefully, ask the right questions upfront and have an eye to engineer excellent web applications you will only get from senior people. They’re specialized and absolutely premium when it comes to UI/UX heavy React based web apps.","quote:daniel-position":"Founder at Aucta","quote:action":"Check Daniel’s Website!","action:hire":"Hire your team now!","action:lets-start":"Let’s start now!","action:lets-talk":"Let’s talk!","action:start-working":"Let\'s get to work now","action:lets-make-it-happen":"Let’s make it happen!","action:program-meeting":"Schedule a meeting","action:ask-budget":"Ask for a quote","action:tell-us-your-project":"Tell us about your project","info:based-madrid":"We are based in Madrid (Spain)","info:all-rights-reserved":"All rights reserved","info:privacy":"Privacy policy","info:legal":"Legal notice","info:cookies":"Cookies","privacy:section1:title1":"Data of the Data Controller","privacy:section1:item1":"Company Name: Ignacio Ramos Howell Company, hereinafter \'The Company\'.","privacy:section1:item2":"Commercial Name: Bonsai.","privacy:section1:item3":"Registered Address: Sector Literatos 38, 28760 Tres Cantos, Madrid.","privacy:section1:item4":"NIF: 53657188M","privacy:section1:item5":"Telephone: 646 036 206","privacy:section1:item6":"Email: hola@bonsaitech.io","privacy:section1:title2":"1.1. Applicable regulations","privacy:section1:text1":"Our Privacy Policy has been designed in accordance with the EU General Data Protection Regulation 2016/679 of the European Parliament and of the Council of 27 April 2016 on the protection of natural persons with regard to the processing of personal data and on the free movement of such data and repealing Directive 95/46/EC (General Data Protection Regulation), and Organic Law 3/2018 of 5 December, on the Protection of Personal Data and Guarantee of Digital Rights. By providing us with your data, you declare that you have read and are aware of this Privacy Policy, giving your unequivocal and express consent to the processing of your personal data in accordance with the purposes and terms expressed herein. The Company may modify this Privacy Policy to adapt it to new legislation, jurisprudence or interpretation of the Spanish Data Protection Agency. These privacy conditions may be supplemented by the Legal Notice, Cookies Policy and General Conditions, if any, are collected for certain products or services, if such access involves any specialty in the field of personal data protection.","privacy:section1:title3":"1.2. Data Protection Officer","privacy:section1:text2":"The person responsible for the file is Ignacio Ramos Howell. If you wish to exercise your rights of access, rectification, cancellation or opposition, you may do so before the data controller by any means that allows proof of sending and receipt, or by sending an email to the following email address: hola@bonsaitech.io. ","privacy:section2:title1":"2. Purpose of the Processing of Personal Data","privacy:section2:text1":"The processing we carry out of your personal data responds to the following purposes:","privacy:section2:text2":"Management of communication with people interested in contracting our services.","privacy:section2:title2":"2.1. Retention period of your data.","privacy:section2:text3":"We will keep your personal data from the time you give us your consent until you revoke it or request the limitation of processing. In such cases, we will keep your data blocked for the legally required periods.","privacy:section3:title1":"3. Legitimation and Data Collected","privacy:section3:text1":"The legitimacy for the processing of your data is the express consent given by a positive and affirmative act (fill out the appropriate form and check the box of acceptance of this policy) at the time of providing us with your personal data.","privacy:section3:title2":"3.1. Consent to process your data","privacy:section3:text2":"By filling in the forms, checking the box \'I accept the Privacy Policy\' and clicking to send the data, or by sending e-mails to the Company through the accounts provided for this purpose, the User declares to have read and expressly accepted this privacy policy, and gives his unequivocal and express consent to the processing of his personal data in accordance with the purposes indicated.","privacy:section3:title3":"3.2. Categories of data","privacy:section3:text3":"The data to be collected will be personal.","privacy:section4:title1":"4. Security Measures","privacy:section4:text1":"As part of our commitment to ensure the security and confidentiality of your personal data, we inform you that we have adopted the necessary technical and organizational measures to ensure the security of personal data and prevent its alteration, loss, unauthorized processing or access, given the state of technology, the nature of the data stored and the risks to which they are exposed, according to Art. 32 of the RGPD EU 679/2016.","privacy:section5:title1":"5. Transfer of Data","privacy:section5:text1":"No data transfers or international transfers of your data are foreseen, except for those authorized by tax, commercial and telecommunications legislation as well as in cases where we are required to do so by a judicial authority.","privacy:section6:title1":"6. User Rights","privacy:section6:text1":"Any interested party has the right to obtain confirmation as to whether or not we are processing personal data concerning him/her. Interested parties have the right to access their personal data, as well as to request the rectification of inaccurate data or, where appropriate, to request its deletion when, among other reasons, the data is no longer necessary for the purposes for which it was collected. In certain circumstances, the interested parties may request the limitation of the processing of their data, in which case we will only keep them for the exercise or defense of claims. For reasons related to their particular situation, data subjects may object to the processing of their data. The Data Controller will stop processing the data, except for compelling legitimate reasons, or the exercise or defense of possible claims. In accordance with current legislation, you have the following rights: the right to request access to your personal data, the right to request its rectification or deletion, the right to request the limitation of its processing, the right to oppose its processing, the right to data portability and, likewise, to revoke the consent given. You also have the right to file a complaint with the Spanish Data Protection Agency.","privacy:section6:title2":"6.1. How to exercise my rights?  ","privacy:section6:text2":"To exercise your rights, you must contact the person responsible, requesting the corresponding form for the exercise of the chosen right. Optionally, you can go to the competent Control Authority to obtain additional information about your rights. The contact details for the exercise of your rights are telephone → 647 036 206 and email: → hola@bonsaitech.io. Remember to accompany a copy of a document that allows us to identify you. ","privacy:section7:title1":"7. Consent to send Electronic Communications","privacy:section7:text1":"Likewise, and in accordance with the provisions of Law 34/2002, of July 11, 2002, on Information Society Services and Electronic Commerce, by completing the data collection form and checking the corresponding box \'I accept the sending of electronic communications\', you are giving your express consent to send information about the Company to your email address, telephone, fax or other electronic means.","legal:section1:text1":"In order to comply with Article 10 of Law 34/2002 of Services of the Information Society and Electronic Commerce, we inform the user of our data:","legal:section1:item1":"Company Name: Ignacio Ramos Howell, hereinafter \'The Provider\'.","legal:section1:item2":"Commercial Name: Bonsai","legal:section1:item3":"Registered Address: Sector Literatos 38, 28760 Tres Cantos, Madrid.","legal:section1:item4":"NIF: 53657188M","legal:section1:item5":"Telephone: 646 036 206.","legal:section1:item6":"Email: hola@bonsaitech.io","legal:section2:title1":"Object","legal:section2:text1":"The provider, responsible for the website, makes available to users this document with which it intends to comply with the obligations under Law 34/2002, of Services of the Information Society and Electronic Commerce (LSSI-CE), as well as inform all users of the website regarding what are the conditions of use of the website.","legal:section2:text2":"Any person accessing this website assumes the role of user, committing to the observance and strict compliance with the provisions herein, as well as any other legal provision that may be applicable.","legal:section2:text3":"The provider reserves the right to modify any type of information that may appear on the website, without any obligation to give prior notice or inform users of such obligations, being understood as sufficient with the publication on the website of the provider.","legal:section3:title1":"Responsibility","legal:section3:text1":"The provider disclaims any liability for the information published on its website, provided that this information has been manipulated or introduced by a third party external to it.","legal:section3:text2":"The provider\'s website may use cookies (small information files that the server sends to the computer of the person accessing the page) to carry out certain functions that are considered essential for the proper functioning and visualization of the site. The cookies used on the website are, in any case, of a temporary nature for the sole purpose of making more efficient onward transmission and disappear at the end of the user\'s session. Under no circumstances will cookies be used to collect personal information. <a>Cookies Policy</a>.","legal:section3:text3":"From the client\'s website you may be redirected to content on third party websites. Since the provider can not always control the content posted by third parties on their websites, it does not assume any responsibility for such content. In any case, the provider states that it will proceed to the immediate removal of any content that could violate national or international law, morality or public order, proceeding to the immediate withdrawal of the redirection to that website, informing the competent authorities of the content in question.","legal:section3:text4":"The provider is not responsible for the information and content stored, including but not limited to, forums, chats, blogs generators, comments, social networks or any other means that allows third parties to publish content independently on the website of the provider. However, and in compliance with the provisions of art. 11 and 16 of the LSSI-CE, the provider is available to all users, authorities and security forces, and actively collaborating in the removal or blocking of all content that could affect or contravene national or international law, the rights of third parties or morality and public order. In the event that the user considers that there is any content on the website that could be susceptible to this classification, please notify the website administrator immediately.","legal:section3:text5":"This website has been checked and tested for proper operation. In principle, it can be guaranteed to function correctly 365 days a year, 24 hours a day. However, the provider does not rule out the possibility of the existence of certain programming errors, or the occurrence of force majeure, natural disasters, strikes, or similar circumstances that make it impossible to access the website.","legal:section4:title1":"Intellectual and Industrial Property","legal:section4:text1":"The website, including but not limited to programming, editing, compilation and other elements necessary for its operation, designs, logos, text and / or graphics are the property of the provider or if you have a license or express authorization from the authors. All the contents of the website are duly protected by intellectual and industrial property regulations, as well as registered in the corresponding public registries.","legal:section4:text2":"Regardless of the purpose for which they were intended, the total or partial reproduction, use, exploitation, distribution and marketing, in any case requires prior written authorization from the provider. Any use not previously authorized by the provider will be considered a serious breach of the intellectual or industrial property rights of the author.","legal:section4:text3":"The designs, logos, text and / or graphics outside the provider and that may appear on the website belong to their respective owners, themselves responsible for any dispute that may arise in respect thereof. In any case, the provider has the express and prior authorization from them.","legal:section4:text4":"The provider DOES NOT expressly AUTHORIZE third parties to redirect directly to the specific contents of the website, and in any case must redirect to the main website of the provider.","legal:section4:text5":"The provider recognizes in favor of their owners the corresponding industrial and intellectual property rights, not implying its mere mention or appearance on the website the existence of any rights or liability of the provider on them, nor endorsement, sponsorship or recommendation by the same.","legal:section4:text6":"To make any comments regarding possible breaches of the rights of intellectual or industrial property, as well as any of the contents of the website, you can do so through the email address listed in the identification data at the beginning of this document.","legal:section5:title1":"Accuracy of the Information","legal:section5:text1":"All the information provided by the User must be truthful. To these effects, the User guarantees the authenticity of the data communicated through the forms for the subscription of the Services. It will be the User\'s responsibility to keep all the information provided to the Company permanently updated so that it corresponds, at all times, to his or her real situation. In any case, the User will be solely responsible for any false or inaccurate statements made and the damages caused to the provider or third parties.","legal:section6:title1":"Minors","legal:section6:text1":"For the use of the services, minors must always obtain prior consent from parents, guardians or legal representatives, ultimately responsible for all acts performed by minors in their care. The responsibility for determining the specific content accessed by minors lies with them, which is why if they access inappropriate content on the Internet, mechanisms must be established on their computers, in particular computer programs, filters and blocks, which allow them to limit the content available and, although not infallible, are particularly useful for controlling and restricting the material to which minors may have access.","legal:section7:title1":"Obligation to make correct use of the Website","legal:section7:text1":"The User agrees to use the Web in accordance with the Law and this Legal Notice, as well as morality and good customs. To this end, the User will refrain from using the page for illegal or prohibited purposes, harmful to the rights and interests of third parties, or in any way damage, disable, overburden, impair or impede the normal use of computer equipment or documents, files and all kinds of content stored on any computer equipment of the provider.","legal:section7:text2":"In particular, and by way of example but not exhaustive, the User undertakes not to transmit, disseminate or make available to third parties information, data, content, messages, graphics, drawings, sound or image files, photographs, recordings, software and, in general, any kind of material that:","legal:section7:text3":"(a) is contrary to, disregards or infringes upon fundamental rights and public liberties recognized in the Constitution, international treaties and other applicable laws;","legal:section7:text4":"(b) induces, incites or promotes criminal, denigrating, defamatory, violent or, in general, contrary to the law, morality and public order;","legal:section7:text5":"(c) induces, incites or promotes discriminatory actions, attitudes or thoughts based on sex, race, religion, beliefs, age or condition;","legal:section7:text6":"(d) is contrary to the right to honor, to personal or family privacy or to one\'s own image;  ","legal:section7:text7":"(e) in any way damages the credibility of the provider or third parties; and","legal:section7:text8":"(f) constitutes unlawful, misleading or unfair advertising.","legal:section8:title1":"Applicable Law and Jurisdiction","legal:section8:text1":"For the resolution of all disputes or questions related to this website or the activities developed in it, will apply Spanish law, to which the parties expressly submit themselves, being competent for the resolution of all disputes arising from or related to its use the Courts and Tribunals of the Community of Madrid.","cookies:section1:title1":"General Information","cookies:section1:text1":"Due to the entry into force of the amendment of the \'Law of Services of the Information Society\' (LSSICE) established by Royal Decree 13/2012, it is mandatory to obtain the express consent of the user of all websites that use cookies expendable, before the user navigates through them.","cookies:section1:title2":"What are cookies?","cookies:section1:text2":"Cookies and other similar technologies such as local shared objects, flash cookies or pixels, are tools used by Web servers to store and retrieve information about their visitors, as well as to provide a proper functioning of the site.","cookies:section1:text3":"The use of these devices allows the Web server to remember some data concerning the user, such as your preferences for viewing the pages of that server, name and password, products that most interest you, etc..","cookies:section1:title3":"Cookies affected by the regulation and exempted cookies","cookies:section1:text4":"According to the EU directive, the cookies that require the user\'s informed consent are analytical cookies and advertising and affiliation cookies, with the exception of technical cookies and those necessary for the operation of the website or the provision of services expressly requested by the user.","cookies:section1:title4":"What types of cookies exist?","cookies:section1:text5":"According to their ownership","cookies:section1:item1":"Own Cookies: These are those that are sent to the user\'s terminal equipment from a computer or domain managed by the editor itself and from which the service requested by the user is provided.","cookies:section1:item2":"Third-party cookies: These are those that are sent to the user\'s terminal equipment from a computer or domain that is not managed by the editor, but by another entity that processes the data obtained through the cookies.","cookies:section1:text6":"According to their duration","cookies:section1:item3":"Session Cookies: These are a type of cookies designed to collect and store data while the user accesses a web page.","cookies:section1:item4":"Persistent cookies: They are a type of cookies in which the data remain stored in the terminal and can be accessed and treated for a period defined by the person responsible for the cookie, and that can range from a few minutes to several years.","cookies:section1:text7":"According to their functionality  ","cookies:section1:item5":"Necessary cookies: these are essential for the correct functioning of the website. They do not collect any type of user data and collect information such as language preference, whether the cookie policy has been accepted, etc.","cookies:section1:item6":"Analysis Cookies: These are those that are well treated by us or by third parties, allow us to quantify the number of users and thus perform the measurement and statistical analysis of the use made by users of the service offered. To do this, your browsing on our website is analyzed in order to improve the range of products or services we offer.","cookies:section1:item7":"Advertising or marketing cookies: These are those that allow the management, in the most effective way possible, of advertising spaces that, where appropriate, the editor has included on a website, application or platform from which provides the requested service based on criteria such as the edited content or the frequency at which the ads are displayed.","cookies:section1:item8":"Cookies behavioral advertising or personalized marketing: These are those that allow the management, as effectively as possible, of advertising spaces that, where appropriate, the publisher has included on a web page, application or platform from which it provides the requested service. These cookies store information on user behavior obtained through the continuous observation of their browsing habits, which allows the development of a specific profile to display advertising based on the same. It is also possible that when you visit a web page or open an email where an advertisement or promotion about our products or services is published, a cookie may be installed in your browser that helps us to later show you advertising related to the search you have made, develop a control of our ads in relation to, for example, the number of times they are viewed, where they appear, what time they are seen, etc..","cookies:section2:title1":"Cookie Statement","cookies:section2:text1":"Please complete the following table with information on all cookies used on your website.","cookies:section2:table-header1":"Cookie","cookies:section2:table-header2":"Owner","cookies:section2:table-header3":"Duration","cookies:section2:table-header4":"Purpose","cookies:section2:table-header5":"Type","cookies:section2:table-cell21":"_gsas ","cookies:section2:table-cell22":".bonsaitech.io","cookies:section2:table-cell23":"1 year 24 days","cookies:section2:table-cell24":"---","cookies:section2:table-cell25":"Others","cookies:section2:table-cell1":"CONSENT","cookies:section2:table-cell2":".google.com","cookies:section2:table-cell3":"2 years","cookies:section2:table-cell4":"YouTube sets this cookie via embedded youtube-videos and registers anonymous statistical data","cookies:section2:table-cell5":"Analytics","cookies:section2:title2":"Revocation of consent to install Cookies","cookies:section2:text2":"Explains in this section how users can withdraw or modify their consent to the use of cookies.  ","cookies:section2:text3":"How to remove Cookies from the browser.","cookies:section2:item1":"Chrome: <a> https://support.google.com/chrome/answer/95647 </a>","cookies:section2:item2":"Internet Explorer: <a> https://support.microsoft.com/es-es/help/17442/windows-internet-explorer-delete-manage-cookies </a>","cookies:section2:item3":"Firefox: <a> https://support.mozilla.org/es/kb/habilitar-y-deshabilitar-cookies-sitios-web-rastrear-preferencias </a>","cookies:section2:item4":"Safari: <a> https://support.apple.com/es-es/guide/safari/sfri11471/mac </a>","cookies:section2:item5":"Opera: <a> https://www.opera.com/help/tutorials/security/privacy/ </a>","cookies:section2:text4":"If it is not listed, consult the documentation of the browser you have installed to block, delete or allow the downloading of Cookies."}'),es:JSON.parse('{"hero:title":"Empieza a crear tu producto hoy","hero:subtitle":"Definimos, creamos y escalamos productos digitales que la gente quiere y los negocios necesitan.","clients:title":"Nuestros desarrolladores han trabajado con","cta:title":"Les encantará tu producto, amarás nuestro proceso.","cta:text":"Te ofrecemos la tranquilidad de saber que estás en buenas manos.","cta2:title":"Nuestro equipo piensa de forma ingeniosa, construye rápidamente y despliega con frecuencia.","cta2:action":"¡Quiero un equipo como ese!","cta3:title":"¿Tienes una gran idea y no sabes cómo empezar?","cta3:action":"¡Ayúdame a hacerlo realidad!","approach:name":"Nuestro enfoque","startups:name":"Para startups","team:title":"Conoce al equipo","team:pretitle":"Equipo","team:position:ignacio":"Gestor de proyecto","team:description:ignacio":"Obsesionado con el proceso de mejora continua. Todo lo que supone un reto le resulta atractivo. Incontrolable gen competitivo.","team:position:antonio":"Consultor tecnológico","team:description:antonio":"Ingeniero del software especializado en visualizaciones de datos y 3D. Apasionado de emacs, enseñar a programar y los lenguajes de programación esotéricos.","team:position:sara":"Desarrolladora UI","team:description:sara":"Especialista en la creación experiencias de productos digitales de alta calidad. Le gusta leer, dibujar y ha producido alrededor de 1.000 illustraciones de arte digital.","team:position:juanlu":"Desarrollador Full Stack","team:description:juanlu":"Entusiasta de la tecnología y el pilotaje de drones. Ha creado docenas de videojuegos y experiencias web. Ningún stack está fuera de alcance.","team:section2:title":"El mejor socio de entrega de productos.","team:claim1":"Centrado en producto","team:claim2":"Ágil y sin grasa","team:claim3":"Velocidad relámpago","team:claim4":"Adaptado a ti","services:title":"Lo que podemos hacer por ti","services:name":"Nuestros servicios","services:pretitle":"Nuestro servicio principal es cubrir tus necesidades","services:intro-text":"Aplicaciones front-end multiplataforma, infraestructuras cloud escalables, visualizaciones 3D complejas... Ningún proyecto fuera de tu alcance.","services:service1:title":"Diseño de producto","services:service1:text":"Diseña un producto con la mejor experiencia de usuario para tus clientes.","services:service2:title":"Desarrollo de producto","services:service2:text":"Convierte tu idea de negocio en realidad con las mejores tecnologías de la industria.","services:service3:title":"Equipo dedicado","services:service3:text":"Dale un impulso a tu proyecto con la ayuda de un equipo technológico de primera categoría.","services:service4:title":"Consultoría de software","services:service4:text":"Mejora tu software o entrena a tus ingenieros para que alcancen el siguiente nivel.","services:section2:title":"Lo que conseguirás con nosotros","services:service5:title":"Rapidez de llegada al mercado","services:service6:title":"Cosas bien hechas","services:service7:title":"Mejor 1% del talento tecnológico","services:service8:title":"Desarrollo ágil de verdad","aucta:title":"¡Somos el equipo que ha construido el editor 3D de Aucta!","aucta:show-case-study":"¡Muestrame el caso de estudio!","aucta:go":"¡Ir a Aucta!","approach:title":"Cómo hacemos que funcione","approach:intro-text":"Hemos acotado el proceso a tres pasos sencillos para convertir tu idea en un producto digital.","approach:step1:title":"Descubre & define","approach:step1:text":"Nos sentamos contigo y conocemos todo lo necesario sobre tu idea de producto y las necesidades de tu negocio, investigamos sobre tu industria, competencia y usuarios, para definir la mejor propuesta de valor para tu producto.","approach:step2:title":"Diseña & construye","approach:step2:text":"Toda esa información es luego utilizada para diseñar una experiencia de usuario amigable y bonita que será implementada utilizando las últimas tecnologías de la industria para garantizar que esté optimizada al máximo.","approach:step3:title":"Lanzamiento & escala","approach:step3:text":"Terminar el desarrollo del producto no es el final del camino. Lanzarlo al mercado y recopilar datos de los usuarios es clave para definir los próximos pasos en el mapa de ruta del producto.","approach:section2:title":"Lo que podemos construir para ti","approach:claim1":"Aplicaciones web progresivas","approach:claim2":"Aplicaciones SaaS","approach:claim3":"Aplicaciones empresariales","approach:claim4":"Sistemas CRM a medida","approach:claim5":"Aplicaciones basadas en la nube","approach:claim6":"Aplicaciones de una sola página","approach:claim7":"Ecommerce","approach:claim8":"Desarrollo de API","startups:title":"Construye tu ida de negocio con nosotros","startups:why":"Por qué?","startups:why:text":"Porque...","startups:how":"Cómo?","startups:how:text":"Hay mucho trabajo que hacer...","startups:service1:title":"Dispón de un equipo con experiencia en startups","startups:service1:text":"Conocemos los problemas que enfrentan las startups durante las etapas iniciales. Te ayudaremos a obtener el máximo valor.","startups:service2:title":"Ahorra dinero en costes de desarrollo","startups:service2:text":"Formar un equipo desde cero no es un proceso fácil ni rápido. Un equipo experimentado obtendrá resultados más rápidamente.","startups:service3:title":"Supera a tu competencia en el mercado","startups:service3:text":"No nos gusta presumir, pero trabajamos rápido. En esta etapa temprana de su negocio, llegar al mercado lo más pronto posible es imprescindible. ","startups:service4:title":"Ten un CTO disponible bajo demanda para guiarte","startups:service4:text":"El mejor talento tecnológico no es fácil de encontrar. Con nosotros, tendrás acceso al conocimiento que impulsará tu producto.","startups:service5:title":"Validación de tu idea","startups:service6:title":"Verificación de factibilidad técnica","startups:service7:title":"Marca & diseño UX/UI","startups:service8:title":"Historias de usuario y recorrido de usuario","startups:service9:title":"Lista de requisitos de MVP","startups:service10:title":"Estimación & cronograma","startups:service11:title":"Diseño de pantallas de alta fidelidad","startups:service12:title":"Desarrollo & lanzammiento","team:name":"El equipo","map:title":"Puedes encontrarnos en","map:address1":" Sector Literatos 38.","map:address2":"28760, Tres Cantos. Madrid (España)","contact:title":"¿Tienes un proyecto en mente? Cuéntanos sobre el","contact:name":"Nombre","contact:whats-your-name":"¿Cuál es tu nombre?","contact:company":"Empresa","contact:what-company-work":"¿En qué empresa trabajas?","contact:email":"Email","contact:give-us-email":"Danos tu email para poder contactarte","contact:purpose":"Quiero:","contact:purpose1":"Contratar un equipo de desarrollo","contact:purpose2":"Crear un producto digital desde cero","contact:purpose3":"Rediseñar una aplicación o mejorar la experiencia de usuario","contact:purpose4":"Otra cosa","contact:budget":"Presupuesto","contact:tell-us-budget":"Dinos tu presupuesto (si quieres)","contact:how-can-we-help-you":"¿Cómo podemos ayudarte?","contact:tell-us-more":"¡Cuéntanos más sobre tu proyecto!","contact:lets-work-together":"¡Trabajemos juntos!","contact:error-email":"Email incorrecto","contact:error-required":"Este campo es obligatorio","contact:error-select":"Por favor selecciona uno","contact:extra-text":"Si no te gustan los formularios, puedes contactarnos directamente en <a> hola@bonsaitech.io </a>","quote:text":"Bonsai me ha ahorrado muchísimo tiempo de gestión de proyecto porque escuchan atentamente, plantean las preguntas adecuadas y tienen un criterio para crear aplicaciones web de calidad que sólo encuentras en la gente más senior. Dominan totalmente React y ofrecen un servicio UX/UI absolutamente premium.","quote:action":"¡Echa un vistazo a la web de Daniel!","quote:daniel-position":"Fundador de Aucta","action:hire":"¡Contrata a tu equipo ya!","action:lets-start":"¡Empecemos ya!","action:lets-talk":"¡Hablemos!","action:start-working":"Empecemos a trabajar ya","action:lets-make-it-happen":"¡Hagamos que ocurra!","action:program-meeting":"Programa una reunión","action:ask-budget":"Pídenos presupuesto","action:tell-us-your-project":"Cuéntanos tu proyecto","info:based-madrid":"Estamos en Madrid (España)","info:all-rights-reserved":"Todos los derechos reservados","info:privacy":"Política de privacidad","info:legal":"Aviso legal","info:cookies":"Cookies","privacy:section1:title1":"1. Datos del Responsable del Tratamiento","privacy:section1:item1":"Denominación Social: Ignacio Ramos Howell, en adelante, «La empresa». ","privacy:section1:item2":"Nombre Comercial: Bonsai.","privacy:section1:item3":"Domicilio Social: Sector Literatos 38, 28760 Tres Cantos, Madrid","privacy:section1:item4":"NIF: 53657188M.","privacy:section1:item5":"Teléfono: 646 036 206.","privacy:section1:item6":"Email: hola@bonsaitech.io email operativo de tu empresa.","privacy:section1:title2":"1.1. Normativa aplicable","privacy:section1:text1":"Nuestra Política de Privacidad se ha diseñado de acuerdo con el Reglamento General de Protección de Datos de la UE 2016/679 del Parlamento Europeo y del Consejo, de 27 de abril de 2016, relativo a la protección de las personas físicas en lo que respecta al tratamiento de datos personales y a la libre circulación de estos datos y por el que se deroga la Directiva 95/46/CE (Reglamento general de protección de datos), y la Ley Orgánica 3/2018 del 5 de diciembre, de Protección de Datos de Carácter Personal y Garantía de los Derechos Digitales. Al facilitarnos sus datos, Usted declara haber leído y conocer la presente Política de Privacidad, prestando su consentimiento inequívoco y expreso al tratamiento de sus datos personales de acuerdo a las finalidades y términos aquí expresados. La Empresa podrá modificar la presente Política de Privacidad para adaptarla a las novedades legislativas, jurisprudenciales o de interpretación de la Agencia Española de Protección de Datos. Estas condiciones de privacidad podrán ser complementadas por el Aviso Legal, Política de Cookies y las Condiciones Generales que, en su caso, se recojan para determinados productos o servicios, si dicho acceso supone alguna especialidad en materia de protección de datos de carácter personal.","privacy:section1:title3":"1.2. Delegado de Protección de Datos","privacy:section1:text2":"El responsable del fichero es Ignacio Ramos Howell. Si quieres ejercer tus derechos de acceso, rectificación, cancelación u oposición, puedes hacerlo ante el responsable del fichero por cualquier medio que permita acreditar el envío y la recepción, o enviando un mail a la siguiente dirección de correo electrónico: hola@bonsaitech.io.","privacy:section2:title1":"2. Finalidad del Tratamiento de los Datos Personales","privacy:section2:text1":"El tratamiento que realizamos de sus datos personales responde a las siguientes finalidades: ","privacy:section2:text2":"Gestión de la comunicación con personas interesadas en contratar nuestros servicios.","privacy:section2:title2":"2.1. Plazo de Conservación de sus datos","privacy:section2:text3":"Conservaremos sus datos personales desde que nos dé su consentimiento hasta que lo revoque o bien solicite la limitación del tratamiento. En tales casos, mantendremos sus datos de manera bloqueada durante los plazos legalmente exigidos.","privacy:section3:title1":"3. Legitimación y Datos Recabados","privacy:section3:text1":"La legitimación para el tratamiento de sus datos es el consentimiento expreso otorgado mediante un acto positivo y afirmativo (rellenar el formulario correspondiente y marcar la casilla de aceptación de esta política) en el momento de facilitarnos sus datos personales.","privacy:section3:title2":"3.1. Consentimiento para tratar sus datos","privacy:section3:text2":"Al rellenar los formularios, marcar la casilla “Acepto la Política de Privacidad” y hacer clic para enviar los datos, o al remitir correos electrónicos a la Empresa a través de las cuentas habilitadas al efecto, el Usuario manifiesta haber leído y aceptado expresamente la presente política de privacidad, y otorga su consentimiento inequívoco y expreso al tratamiento de sus datos personales conforme a las finalidades indicadas.","privacy:section3:title3":"3.2. Categorías de datos.","privacy:section3:text3":"Los datos que se recopilarán serán personales.","privacy:section4:title1":"4. Medidas de Seguridad","privacy:section4:text1":"Dentro de nuestro compromiso por garantizar la seguridad y confidencialidad de sus datos de carácter personal, le informamos que se han adoptado las medidas de índole técnica y organizativas necesarias para garantizar la seguridad de los datos de carácter personal y evitar su alteración, pérdida, tratamiento o acceso no autorizado, habida cuenta del estado de la tecnología, la naturaleza de los datos almacenados y los riesgos a que estén expuestos, según el Art. 32 del RGPD EU 679/2016.","privacy:section5:title1":"5. Cesión de Datos","privacy:section5:text1":"No se prevén cesiones de datos ni transferencias internacionales de sus datos, a excepción de las autorizadas por la legislación fiscal, mercantil y de telecomunicaciones así como en aquellos casos en los que una autoridad judicial nos lo requiera.","privacy:section6:title1":"6. Derechos del Usuario","privacy:section6:text1":"Cualquier interesado tiene derecho a obtener confirmación sobre si estamos tratando datos personales que le conciernan, o no. Las personas interesadas tienen derecho a acceder a sus datos personales, así como a solicitar la rectificación de los datos inexactos o, en su caso, solicitar su supresión cuando, entre otros motivos, los datos ya no sean necesarios para los fines que fueron recogidos. En determinadas circunstancias, los interesados podrán solicitar la limitación del tratamiento de sus datos, en cuyo caso únicamente los conservaremos para el ejercicio o la defensa de reclamaciones. Por motivos relacionados con su situación particular, los interesados podrán oponerse al tratamiento de sus datos. El Responsable del fichero dejará de tratar los datos, salvo por motivos legítimos imperiosos, o el ejercicio o la defensa de posibles reclamaciones. De acuerdo con la legislación vigente tiene los siguientes derechos: derecho a solicitar el acceso a sus datos personales, derecho a solicitar su rectificación o supresión, derecho a solicitar la limitación de su tratamiento, derecho a oponerse al tratamiento, derecho a la portabilidad de los datos y así mismo, a revocar el consentimiento otorgado. Asimismo, tiene derecho a presentar una reclamación ante la Agencia Española de Protección de Datos.","privacy:section6:title2":"6.1. ¿Cómo ejercitar mis derechos?","privacy:section6:text2":"Para ejercer sus derechos, debe dirigirse al responsable, solicitando el correspondiente formulario para el ejercicio del derecho elegido. Opcionalmente, puede acudir a la Autoridad de Control competente para obtener información adicional acerca de sus derechos. Los datos de contacto para el ejercicio de sus derechos son el teléfono 647 036 206 y el correo electrónico: hola@bonsaitech.io. Recuerde acompañar una copia de un documento que nos permita identificarle.","privacy:section7:title1":"7. Consentimiento para envío de Comunicaciones Electrónicas","privacy:section7:text1":"Así mismo, y de acuerdo con lo establecido en la Ley 34/2002, de 11 de julio, de Servicios de la Sociedad de la Información y del Comercio Electrónico, completando el formulario de recogida de datos y marcando la correspondiente casilla “Acepto el envío de comunicaciones electrónicas”, está otorgando el consentimiento expreso para enviarle a su dirección de correo electrónico, teléfono, fax u otro medio electrónico en envío de información acerca de la Empresa.","legal:section1:text1":"Con la finalidad de dar cumplimiento al artículo 10 de la Ley 34/2002 de Servicios de la Sociedad de la Información y Comercio Electrónico, informamos al usuario de nuestros datos:  ","legal:section1:item1":"Denominación Social: Ignacio Ramos Howell, en adelante, «El prestador».","legal:section1:item2":"Nombre Comercial: Bonsai.","legal:section1:item3":"Domicilio Social:Sector Literatos 38, 28760 Tres Cantos, Madrid. ","legal:section1:item4":"NIF: 53657188M","legal:section1:item5":"Teléfono: 646 036 206.","legal:section1:item6":"Email: hola@bonsaitech.io","legal:section2:title1":"Objeto","legal:section2:text1":"El prestador, responsable del sitio web, pone a disposición de los usuarios el presente documento con el que pretende dar cumplimiento a las obligaciones dispuestas en la Ley 34/2002, de Servicios de la Sociedad de la Información y del Comercio Electrónico (LSSI-CE), así como informar a todos los usuarios del sitio web respecto a cuáles son las condiciones de uso del sitio web.","legal:section2:text2":"Toda persona que acceda a este sitio web asume el papel de usuario, comprometiéndose a la observancia y cumplimiento riguroso de las disposiciones aquí dispuestas, así como a cualquier otra disposición legal que fuera de aplicación.","legal:section2:text3":"El prestador se reserva el derecho a modificar cualquier tipo de información que pudiera aparecer en el sitio web, sin que exista obligación de preavisar o poner en conocimiento de los usuarios dichas obligaciones, entendiéndose como suficiente con la publicación en el sitio web del prestador.","legal:section3:title1":"Responsabilidad","legal:section3:text1":"El prestador se exime de cualquier tipo de responsabilidad derivada de la información publicada en su sitio web, siempre que esta información haya sido manipulada o introducida por un tercero ajeno al mismo. ","legal:section3:text2":"El sitio web del prestador puede utilizar cookies (pequeños archivos de información que el servidor envía al ordenador de quien accede a la página) para llevar a cabo determinadas funciones que son consideradas imprescindibles para el correcto funcionamiento y visualización del sitio. Las cookies utilizadas en el sitio web tienen, en todo caso, carácter temporal con la única finalidad de hacer más eficaz su transmisión ulterior y desaparecen al terminar la sesión del usuario. En ningún caso se utilizarán las cookies para recoger información de carácter personal. <a>Política de Cookies</a> ","legal:section3:text3":"Desde el sitio web del cliente es posible que se redirija a contenidos de terceros sitios web. Dado que el prestador no puede controlar siempre los contenidos introducidos por los terceros en sus sitios web, éste no asume ningún tipo de responsabilidad respecto a dichos contenidos. En todo caso, el prestador manifiesta que procederá a la retirada inmediata de cualquier contenido que pudiera contravenir la legislación nacional o internacional, la moral o el orden público, procediendo a la retirada inmediata de la redirección a dicho sitio web, poniendo en conocimiento de las autoridades competentes el contenido en cuestión.  ","legal:section3:text4":"El prestador no se hace responsable de la información y contenidos almacenados, a título enunciativo pero no limitativo, en foros, chats, generadores de blogs, comentarios, redes sociales o cualquier otro medio que permita a terceros publicar contenidos de forma independiente en la página web del prestador. No obstante y en cumplimiento de lo dispuesto en el art. 11 y 16 de la LSSI-CE, el prestador se pone a disposición de todos los usuarios, autoridades y fuerzas de seguridad, y colaborando de forma activa en la retirada o en su caso bloqueo de todos aquellos contenidos que pudieran afectar o contravenir la legislación nacional, o internacional, derechos de terceros o la moral y el orden público. En caso de que el usuario considere que existe en el sitio web algún contenido que pudiera ser susceptible de esta clasificación, se ruega lo notifique de forma inmediata al administrador del sitio web. ","legal:section3:text5":"Este sitio web ha sido revisado y probado para que funcione correctamente. En principio, puede garantizarse el correcto funcionamiento los 365 días del año, 24 horas al día. No obstante, el prestador no descarta la posibilidad de que existan ciertos errores de programación, o que acontezcan causas de fuerza mayor, catástrofes naturales, huelgas, o circunstancias semejantes que hagan imposible el acceso a la página web. ","legal:section4:title1":"Propiedad Intelectual e Industrial","legal:section4:text1":"El sitio web, incluyendo a título enunciativo pero no limitativo su programación, edición, compilación y demás elementos necesarios para su funcionamiento, los diseños, logotipos, texto y/o gráficos son propiedad del prestador o en su caso dispone de licencia o autorización expresa por parte de los autores. Todos los contenidos del sitio web se encuentran debidamente protegidos por la normativa de propiedad intelectual e industrial, así como inscritos en los registros públicos correspondientes.","legal:section4:text2":"Independientemente de la finalidad para la que fueran destinados, la reproducción total o parcial, uso, explotación, distribución y comercialización, requiere en todo caso de la autorización escrita previa por parte del prestador. Cualquier uso no autorizado previamente por parte del prestador será considerado un incumplimiento grave de los derechos de propiedad intelectual o industrial del autor.","legal:section4:text3":"Los diseños, logotipos, texto y/o gráficos ajenos al prestador y que pudieran aparecer en el sitio web, pertenecen a sus respectivos propietarios, siendo ellos mismos responsables de cualquier posible controversia que pudiera suscitarse respecto a los mismos. En todo caso, el prestador cuenta con la autorización expresa y previa por parte de los mismos. ","legal:section4:text4":"El prestador NO AUTORIZA expresamente a que terceros puedan redirigir directamente a los contenidos concretos del sitio web, debiendo en todo caso redirigir al sitio web principal del prestador.","legal:section4:text5":"El prestador reconoce a favor de sus titulares los correspondientes derechos de propiedad industrial e intelectual, no implicando su sola mención o aparición en el sitio web la existencia de derechos o responsabilidad alguna del prestador sobre los mismos, como tampoco respaldo, patrocinio o recomendación por parte del mismo.","legal:section4:text6":"Para realizar cualquier tipo de observación respecto a posibles incumplimientos de los derechos de propiedad intelectual o industrial, así como sobre cualquiera de los contenidos del sitio web, puede hacerlo a través del correo electrónico que figura en los datos identificativos al principio de este documento.","legal:section5:title1":"Veracidad de la Información ","legal:section5:text1":"Toda la información que facilita el Usuario tiene que ser veraz. A estos efectos, el Usuario garantiza la autenticidad de los datos comunicados a través de los formularios para la suscripción de los Servicios. Será responsabilidad del Usuario mantener toda la información facilitada a la Empresa permanentemente actualizada de forma que responda, en cada momento, a su situación real. En todo caso, el Usuario será el único responsable de las manifestaciones falsas o inexactas que realice y de los perjuicios que cause al prestador o a terceros.","legal:section6:title1":"Menores de Edad","legal:section6:text1":"Para el uso de los servicios, los menores de edad tienen que obtener siempre previamente el consentimiento de los padres, tutores o representantes legales, responsables últimos de todos los actos realizados por los menores a su cargo. La responsabilidad en la determinación de contenidos concretos a los cuales acceden los menores corresponde a aquellos, es por eso que si acceden a contenidos no apropiados por Internet, se tendrán que establecer en sus ordenadores mecanismos, en particular programas informáticos, filtros y bloqueos, que permitan limitar los contenidos disponibles y, a pesar de que no sean infalibles, son de especial utilidad para controlar y restringir los materiales a los que pueden acceder los menores.","legal:section7:title1":"Obligación de hacer un uso correcto de la Web","legal:section7:text1":"El Usuario se compromete a utilizar la Web de conformidad a la Ley y al presente Aviso Legal, así como a la moral y a buenas costumbres. A tal efecto, el Usuario se abstendrá de utilizar la página con finalidades ilícitas o prohibidas, lesivas de derechos e intereses de terceros, o que de cualquier forma puedan dañar, inutilizar, sobrecargar, deteriorar o impedir la normal utilización de equipos informáticos o documentos, archivos y toda clase de contenidos almacenados en cualquier equipo informático del prestador. ","legal:section7:text2":"En particular, y a título indicativo pero no exhaustivo, el Usuario se compromete a no transmitir, difundir o poner a disposición de terceros informaciones, datos, contenidos, mensajes, gráficos, dibujos, archivos de sonido o imagen, fotografías, grabaciones, software y, en general, cualquier clase de material que:","legal:section7:text3":"(a) sea contraria, desprecie o atente contra los derechos fundamentales y las libertades públicas reconocidas constitucionalmente, en tratados internacionales y otras normas vigentes; ","legal:section7:text4":"(b) induzca, incite o promueva actuaciones delictivas, denigrantes, difamatorias, violentas o, en general, contrarias a la ley, a la moral y al orden público; ","legal:section7:text5":"(c) induzca, incite o promueva actuaciones, actitudes o pensamientos discriminatorios por razón de sexo, raza, religión, creencias, edad o condición;","legal:section7:text6":"(d) sea contrario al derecho al honor, a la intimidad personal o familiar o a la propia imagen de las personas;","legal:section7:text7":"(e) de cualquier manera perjudique la credibilidad del prestador o de terceros; y ","legal:section7:text8":"(f) constituya publicidad ilícita, engañosa o desleal.","legal:section8:title1":"Ley Aplicable y Jurisdicción  ","legal:section8:text1":"Para la resolución de todas las controversias o cuestiones relacionadas con el presente sitio web o de las actividades en él desarrolladas, será de aplicación la legislación española, a la que se someten expresamente las partes, siendo competentes para la resolución de todos los conflictos derivados o relacionados con su uso los Juzgados y Tribunales de la Comunidad de Madrid.  ","cookies:section1:title1":"Información general","cookies:section1:text1":"Debido a la entrada en vigor de la referente modificación de la “Ley de Servicios de la Sociedad de la Información” (LSSICE) establecida por el Real Decreto 13/2012, es de obligación obtener el consentimiento expreso del usuario de todas las páginas web que usan cookies prescindibles, antes de que éste navegue por ellas.","cookies:section1:title2":"¿Qué son las cookies?","cookies:section1:text2":"Las cookies y otras tecnologías similares tales como local shared objects, flash cookies o píxeles, son herramientas empleadas por los servidores Web para almacenar y recuperar información acerca de sus visitantes, así como para ofrecer un correcto funcionamiento del sitio.","cookies:section1:text3":"Mediante el uso de estos dispositivos se permite al servidor Web recordar algunos datos concernientes al usuario, como sus preferencias para la visualización de las páginas de ese servidor, nombre y contraseña, productos que más le interesan, etc. ","cookies:section1:title3":"Cookies afectadas por la normativa y cookies exceptuadas","cookies:section1:text4":"Según la directiva de la UE, las cookies que requieren el consentimiento informado por parte del usuario son las cookies de analítica y las de publicidad y afiliación, quedando exceptuadas las de carácter técnico y las necesarias para el funcionamiento del sitio web o la prestación de servicios expresamente solicitados por el usuario.","cookies:section1:title4":"¿Qué tipos de cookies existen?","cookies:section1:text5":"Según su titularidad","cookies:section1:item1":"Cookies propias: Son aquéllas que se envían al equipo terminal del usuario desde un equipo o dominio gestionado por el propio editor y desde el que se presta el servicio Solicitado por el usuario.","cookies:section1:item2":"Cookies de terceros: Son aquéllas que se envían al equipo terminal del usuario desde un equipo o dominio que no es gestionado por el editor, sino por otra entidad que trata los datos obtenidos través de las cookies.","cookies:section1:text6":"Según su duración","cookies:section1:item3":"Cookies de sesión: Son un tipo de cookies diseñadas para recabar y almacenar datos mientras el usuario accede a una página web.","cookies:section1:item4":"Cookies persistentes: Son un tipo de cookies en el que los datos siguen almacenados en el terminal y pueden ser accedidos y tratados durante un periodo definido por el responsable de la cookie, y que puede ir de unos minutos a varios años.","cookies:section1:text7":"Según su funcionalidad","cookies:section1:item5":"Cookies necesarias: son aquellas imprescindibles para el correcto funcionamiento del sitio web. No recopilan ningún tipo de datos de usuario y recogen información como la preferencia de idioma, si se ha aceptado la política de cookies, etc.","cookies:section1:item6":"Cookies de análisis: Son aquéllas que bien tratadas por nosotros o por terceros, nos permiten cuantificar el número de usuarios y así realizar la medición y análisis estadístico de la utilización que hacen los usuarios del servicio ofertado. Para ello se analiza su navegación en nuestra página web con el fin de mejorar la oferta de productos o servicios que le ofrecemos.","cookies:section1:item7":"Cookies publicitarias o de marketing: Son aquéllas que permiten la gestión, de la forma más eficaz posible, de los espacios publicitarios que, en su caso, el editor haya incluido en una página web, aplicación o plataforma desde la que presta el servicio solicitado en base a criterios como el contenido editado o la frecuencia en la que se muestran los anuncios.","cookies:section1:item8":"Cookies de publicidad comportamental o de marketing personalizado: Son aquéllas que permiten la gestión, de la forma más eficaz posible, de los espacios publicitarios que, en su caso, el editor haya incluido en una página web, aplicación o plataforma desde la que presta el servicio solicitado. Estas cookies almacenan información del comportamiento de los usuarios obtenida a través de la observación continuada de sus hábitos de navegación, lo que permite desarrollar un perfil específico para mostrar publicidad en función del mismo. Asimismo es posible que al visitar alguna página web o al abrir algún email donde se publique algún anuncio o alguna promoción sobre nuestros productos o servicios se instale en tu navegador alguna cookie que nos sirve para mostrarte posteriormente publicidad relacionada con la búsqueda que hayas realizado, desarrollar un control de nuestros anuncios en relación, por ejemplo, con el número de veces que son vistos, donde aparecen, a qué hora se ven, etc.","cookies:section2:title1":"Declaración de Cookies","cookies:section2:text1":"Completa la siguiente tabla con información de todas las cookies que se utilizan en tu sitio web.","cookies:section2:table-header1":"Cookie","cookies:section2:table-header2":"Propietario","cookies:section2:table-header3":"Duración","cookies:section2:table-header4":"Finalidad","cookies:section2:table-header5":"Tipo","cookies:section2:table-cell21":"_gsas ","cookies:section2:table-cell22":".bonsaitech.io","cookies:section2:table-cell23":"1 año 24 días","cookies:section2:table-cell24":"---","cookies:section2:table-cell25":"Otros","cookies:section2:table-cell1":"CONSENT","cookies:section2:table-cell2":".google.com","cookies:section2:table-cell3":"2 años","cookies:section2:table-cell4":"Youtube establece esta cookie a través de vídeos embebidos y registra datos estadísticos anónimos","cookies:section2:table-cell5":"Analytics","cookies:section2:title2":"Revocación del consentimiento para instalar Cookies  ","cookies:section2:text2":"Explica en este apartado cómo  pueden los usuarios retirar o modificar su consentimiento para el uso de cookies.","cookies:section2:text3":"Cómo eliminar las Cookies del navegador.","cookies:section2:item1":"Chrome: <a> https://support.google.com/chrome/answer/95647 </a>","cookies:section2:item2":"Internet Explorer: <a> https://support.microsoft.com/es-es/help/17442/windows-internet-explorer-delete-manage-cookies </a>","cookies:section2:item3":"Firefox: <a> https://support.mozilla.org/es/kb/habilitar-y-deshabilitar-cookies-sitios-web-rastrear-preferencias </a>","cookies:section2:item4":"Safari: <a> https://support.apple.com/es-es/guide/safari/sfri11471/mac </a>","cookies:section2:item5":"Opera: <a> https://www.opera.com/help/tutorials/security/privacy/ </a>","cookies:section2:text4":"Si no aparece listado, consulte la documentación del navegador que tenga instalado para bloquear, eliminar o permitir la descarga de Cookies"}')}},6733:function(e,t,i){"use strict";i.d(t,{W:function(){return r}});var s=i(9785),n=i(8157);const r=e=>{const{locale:t}=(0,s.Z)(),i=e||t;return e=>{const t=(0,n.TG)(e);return i!==n.ZW?"/"+i+t:t}};t.Z=r},3698:function(e,t,i){"use strict";var s=i(7294),n=i(9785);i(9325);t.Z=()=>{const e=(0,n.Z)();return(0,s.useCallback)((function(t,i){return void 0===i&&(i={}),e.formatMessage({id:t,defaultMessage:t},i)}),[e])}},8157:function(e,t,i){"use strict";i.d(t,{ZW:function(){return r},TG:function(){return l},Q3:function(){return a},mS:function(){return o},E5:function(){return h}});var s=[{locale:"en",match:/en/},{locale:"es",match:/es/}],n=i(9325);const r={}.REACT_APP_DEFAULT_LOCALE||s[0].locale,a=()=>{const e=s.find((e=>{let{match:t}=e;return t.test("undefined"!=typeof navigator&&navigator?navigator.language:r)}));return e?e.locale:r},o=e=>{const t="undefined"==typeof window,i=e.pathname||(t?"/":window.location.pathname);return s.reduce(((e,t)=>{let{locale:s}=t;return i.startsWith("/"+s+"/")?s:e}),r)},l=function(e){void 0===e&&(e="");const t=s.reduce(((e,t)=>e.replace(new RegExp("^/"+t.locale+"/"),"/").replace(new RegExp("^/"+t.locale+"$"),"/")),e);return t.length>1?t.replace(/\/$/,""):t},h=function(e){void 0===e&&(e=void 0);const t=function(e){void 0===e&&(e=void 0);const t=s.find((t=>{let{match:i}=t;return i.test(e||("undefined"!=typeof navigator&&navigator?navigator.language:r))}));return t?t.locale:r}(e),i=n.Z[t]||n.Z[r];return n.Z[t]||console.warn("Missing translations for locale "+t),{messages:i,locale:t}}},8694:function(e,t,i){"use strict";i.d(t,{Z:function(){return os}});var s=i(7294),n=i(2977),r=i(1962),a=i(9522),o=i(4527),l=i(6176);function h(e){const t=[],i=[],s=[],n=[],r=e.width||e.size||1,a=e.height||e.size||1,h=0===e.sideOrientation?0:e.sideOrientation||o.x.DEFAULTSIDE,c=r/2,u=a/2;i.push(-c,-u,0),s.push(0,0,-1),n.push(0,l.e.UseOpenGLOrientationForUV?1:0),i.push(c,-u,0),s.push(0,0,-1),n.push(1,l.e.UseOpenGLOrientationForUV?1:0),i.push(c,u,0),s.push(0,0,-1),n.push(1,l.e.UseOpenGLOrientationForUV?0:1),i.push(-c,u,0),s.push(0,0,-1),n.push(0,l.e.UseOpenGLOrientationForUV?0:1),t.push(0),t.push(1),t.push(2),t.push(0),t.push(2),t.push(3),o.x._ComputeSides(h,i,t,s,n,e.frontUVs,e.backUVs);const d=new o.x;return d.indices=t,d.positions=i,d.normals=s,d.uvs=n,d}function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const s=new a.Kj(e,i);t.sideOrientation=a.Kj._GetDefaultSideOrientation(t.sideOrientation),s._originalBuilderSideOrientation=t.sideOrientation;return h(t).applyToMesh(s,t.updatable),t.sourcePlane&&(s.translate(t.sourcePlane.normal,-t.sourcePlane.d),s.setDirection(t.sourcePlane.normal.scale(-1))),s}o.x.CreatePlane=h,a.Kj.CreatePlane=(e,t,i,s,n)=>c(e,{size:t,width:t,height:t,sideOrientation:n,updatable:s},i);i(3792);var u=i(6900),d=i(7046);function f(e){let t=[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23];const i=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0],s=[];let n=[];const r=e.width||e.size||1,a=e.height||e.size||1,h=e.depth||e.size||1,c=e.wrap||!1;let f=void 0===e.topBaseAt?1:e.topBaseAt,p=void 0===e.bottomBaseAt?0:e.bottomBaseAt;f=(f+4)%4,p=(p+4)%4;let g=[2,0,3,1][f],m=[2,0,1,3][p],_=[1,-1,1,-1,-1,1,-1,1,1,1,1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1,1,1,-1,1,-1,-1,1,-1,1,1,1,1,-1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1,1,1,-1,1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,1];if(c){t=[2,3,0,2,0,1,4,5,6,4,6,7,9,10,11,9,11,8,12,14,15,12,13,14],_=[-1,1,1,1,1,1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1,1,1,1,1,1,-1,1,-1,-1,1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,-1,-1,-1];let e=[[1,1,1],[-1,1,1],[-1,1,-1],[1,1,-1]],i=[[-1,-1,1],[1,-1,1],[1,-1,-1],[-1,-1,-1]];const s=[17,18,19,16],n=[22,23,20,21];for(;g>0;)e.unshift(e.pop()),s.unshift(s.pop()),g--;for(;m>0;)i.unshift(i.pop()),n.unshift(n.pop()),m--;e=e.flat(),i=i.flat(),_=_.concat(e).concat(i),t.push(s[0],s[2],s[3],s[0],s[1],s[2]),t.push(n[0],n[2],n[3],n[0],n[1],n[2])}const v=[r/2,a/2,h/2];n=_.reduce(((e,t,i)=>e.concat(t*v[i%3])),[]);const b=0===e.sideOrientation?0:e.sideOrientation||o.x.DEFAULTSIDE,E=e.faceUV||new Array(6),y=e.faceColors,M=[];for(let o=0;o<6;o++)void 0===E[o]&&(E[o]=new u.Lt(0,0,1,1)),y&&void 0===y[o]&&(y[o]=new d.HE(1,1,1,1));for(let o=0;o<6;o++)if(s.push(E[o].z,l.e.UseOpenGLOrientationForUV?1-E[o].w:E[o].w),s.push(E[o].x,l.e.UseOpenGLOrientationForUV?1-E[o].w:E[o].w),s.push(E[o].x,l.e.UseOpenGLOrientationForUV?1-E[o].y:E[o].y),s.push(E[o].z,l.e.UseOpenGLOrientationForUV?1-E[o].y:E[o].y),y)for(let e=0;e<4;e++)M.push(y[o].r,y[o].g,y[o].b,y[o].a);o.x._ComputeSides(b,n,t,i,s,e.frontUVs,e.backUVs);const T=new o.x;if(T.indices=t,T.positions=n,T.normals=i,T.uvs=s,y){const e=b===o.x.DOUBLESIDE?M.concat(M):M;T.colors=e}return T}function p(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const s=new a.Kj(e,i);t.sideOrientation=a.Kj._GetDefaultSideOrientation(t.sideOrientation),s._originalBuilderSideOrientation=t.sideOrientation;return f(t).applyToMesh(s,t.updatable),s}o.x.CreateBox=f,a.Kj.CreateBox=function(e,t){return p(e,{size:t,sideOrientation:arguments.length>4?arguments[4]:void 0,updatable:arguments.length>3?arguments[3]:void 0},arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)};var g,m=i(7702),_=i(3681),v=(i(2465),i(5602));!function(e){e[e.CW=0]="CW",e[e.CCW=1]="CCW"}(g||(g={}));var b=i(3683);class E{constructor(e,t){this.width=e,this.height=t}toString(){return"{W: ".concat(this.width,", H: ").concat(this.height,"}")}getClassName(){return"Size"}getHashCode(){let e=0|this.width;return e=397*e^(0|this.height),e}copyFrom(e){this.width=e.width,this.height=e.height}copyFromFloats(e,t){return this.width=e,this.height=t,this}set(e,t){return this.copyFromFloats(e,t)}multiplyByFloats(e,t){return new E(this.width*e,this.height*t)}clone(){return new E(this.width,this.height)}equals(e){return!!e&&(this.width===e.width&&this.height===e.height)}get surface(){return this.width*this.height}static Zero(){return new E(0,0)}add(e){return new E(this.width+e.width,this.height+e.height)}subtract(e){return new E(this.width-e.width,this.height-e.height)}static Lerp(e,t,i){const s=e.width+(t.width-e.width)*i,n=e.height+(t.height-e.height)*i;return new E(s,n)}}i(628);var y=i(9477),M=i(9336),T=i(4174),A=i(1396),S=i(3365),I=i(2786);class C{constructor(){this._zoomStopsAnimation=!1,this._idleRotationSpeed=.05,this._idleRotationWaitTime=2e3,this._idleRotationSpinupTime=2e3,this.targetAlpha=null,this._isPointerDown=!1,this._lastFrameTime=null,this._lastInteractionTime=-1/0,this._cameraRotationSpeed=0,this._lastFrameRadius=0}get name(){return"AutoRotation"}set zoomStopsAnimation(e){this._zoomStopsAnimation=e}get zoomStopsAnimation(){return this._zoomStopsAnimation}set idleRotationSpeed(e){this._idleRotationSpeed=e}get idleRotationSpeed(){return this._idleRotationSpeed}set idleRotationWaitTime(e){this._idleRotationWaitTime=e}get idleRotationWaitTime(){return this._idleRotationWaitTime}set idleRotationSpinupTime(e){this._idleRotationSpinupTime=e}get idleRotationSpinupTime(){return this._idleRotationSpinupTime}get rotationInProgress(){return Math.abs(this._cameraRotationSpeed)>0}init(){}attach(e){this._attachedCamera=e;const t=this._attachedCamera.getScene();this._onPrePointerObservableObserver=t.onPrePointerObservable.add((e=>{e.type!==S.kD.POINTERDOWN?e.type===S.kD.POINTERUP&&(this._isPointerDown=!1):this._isPointerDown=!0})),this._onAfterCheckInputsObserver=e.onAfterCheckInputsObservable.add((()=>{if(this._reachTargetAlpha())return;const e=I.F.Now;let t=0;null!=this._lastFrameTime&&(t=e-this._lastFrameTime),this._lastFrameTime=e,this._applyUserInteraction();const i=e-this._lastInteractionTime-this._idleRotationWaitTime,s=Math.max(Math.min(i/this._idleRotationSpinupTime,1),0);this._cameraRotationSpeed=this._idleRotationSpeed*s,this._attachedCamera&&(this._attachedCamera.alpha-=this._cameraRotationSpeed*(t/1e3))}))}detach(){if(!this._attachedCamera)return;const e=this._attachedCamera.getScene();this._onPrePointerObservableObserver&&e.onPrePointerObservable.remove(this._onPrePointerObservableObserver),this._attachedCamera.onAfterCheckInputsObservable.remove(this._onAfterCheckInputsObserver),this._attachedCamera=null}resetLastInteractionTime(e){this._lastInteractionTime=null!=e?e:I.F.Now}_reachTargetAlpha(){return!(!this._attachedCamera||!this.targetAlpha)&&Math.abs(this._attachedCamera.alpha-this.targetAlpha)<_.kn}_userIsZooming(){return!!this._attachedCamera&&0!==this._attachedCamera.inertialRadiusOffset}_shouldAnimationStopForInteraction(){if(!this._attachedCamera)return!1;let e=!1;return this._lastFrameRadius===this._attachedCamera.radius&&0!==this._attachedCamera.inertialRadiusOffset&&(e=!0),this._lastFrameRadius=this._attachedCamera.radius,this._zoomStopsAnimation?e:this._userIsZooming()}_applyUserInteraction(){this._userIsMoving()&&!this._shouldAnimationStopForInteraction()&&(this._lastInteractionTime=I.F.Now)}_userIsMoving(){return!!this._attachedCamera&&(0!==this._attachedCamera.inertialAlphaOffset||0!==this._attachedCamera.inertialBetaOffset||0!==this._attachedCamera.inertialRadiusOffset||0!==this._attachedCamera.inertialPanningX||0!==this._attachedCamera.inertialPanningY||this._isPointerDown)}}class D{constructor(){this._easingMode=D.EASINGMODE_EASEIN}setEasingMode(e){const t=Math.min(Math.max(e,0),2);this._easingMode=t}getEasingMode(){return this._easingMode}easeInCore(e){throw new Error("You must implement this method")}ease(e){switch(this._easingMode){case D.EASINGMODE_EASEIN:return this.easeInCore(e);case D.EASINGMODE_EASEOUT:return 1-this.easeInCore(1-e)}return e>=.5?.5*(1-this.easeInCore(2*(1-e)))+.5:.5*this.easeInCore(2*e)}}D.EASINGMODE_EASEIN=0,D.EASINGMODE_EASEOUT=1,D.EASINGMODE_EASEINOUT=2;var P,x=i(1704);!function(e){e[e.NONE=0]="NONE",e[e.STEP=1]="STEP"}(P||(P={}));class R{constructor(e,t,i){this.name=e,this.from=t,this.to=i}clone(){return new R(this.name,this.from,this.to)}}var O=i(8628);class N{static _PrepareAnimation(e,t,i,s,n,r,a,o){let l;if(!isNaN(parseFloat(n))&&isFinite(n)?l=N.ANIMATIONTYPE_FLOAT:n instanceof u._f?l=N.ANIMATIONTYPE_QUATERNION:n instanceof u.P?l=N.ANIMATIONTYPE_VECTOR3:n instanceof u.FM?l=N.ANIMATIONTYPE_VECTOR2:n instanceof d.Wo?l=N.ANIMATIONTYPE_COLOR3:n instanceof d.HE?l=N.ANIMATIONTYPE_COLOR4:n instanceof E&&(l=N.ANIMATIONTYPE_SIZE),null==l)return null;const h=new N(e,t,i,l,a),c=[{frame:0,value:n},{frame:s,value:r}];return h.setKeys(c),void 0!==o&&h.setEasingFunction(o),h}static CreateAnimation(e,t,i,s){const n=new N(e+"Animation",e,i,t,N.ANIMATIONLOOPMODE_CONSTANT);return n.setEasingFunction(s),n}static CreateAndStartAnimation(e,t,i,s,n,r,a,o,l,h,c){const u=N._PrepareAnimation(e,i,s,n,r,a,o,l);return u?(t.getScene&&(c=t.getScene()),c?c.beginDirectAnimation(t,[u],0,n,1===u.loopMode,1,h):null):null}static CreateAndStartHierarchyAnimation(e,t,i,s,n,r,a,o,l,h,c){const u=N._PrepareAnimation(e,s,n,r,a,o,l,h);if(!u)return null;return t.getScene().beginDirectHierarchyAnimation(t,i,[u],0,r,1===u.loopMode,1,c)}static CreateMergeAndStartAnimation(e,t,i,s,n,r,a,o,l,h){const c=N._PrepareAnimation(e,i,s,n,r,a,o,l);return c?(t.animations.push(c),t.getScene().beginAnimation(t,0,n,1===c.loopMode,1,h)):null}static MakeAnimationAdditive(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0,s=arguments.length>4?arguments[4]:void 0,n=e;if(arguments.length>3&&void 0!==arguments[3]&&arguments[3]&&(n=e.clone(),n.name=s||n.name),!n._keys.length)return n;t=t>=0?t:0;let r=0;const a=n._keys[0];let o=n._keys.length-1;const l=n._keys[o],h={referenceValue:a.value,referencePosition:u.jp.Vector3[0],referenceQuaternion:u.jp.Quaternion[0],referenceScaling:u.jp.Vector3[1],keyPosition:u.jp.Vector3[2],keyQuaternion:u.jp.Quaternion[1],keyScaling:u.jp.Vector3[3]};let c=!1,d=a.frame,f=l.frame;if(i){const e=n.getRange(i);e&&(d=e.from,f=e.to)}let p=a.frame===d,g=l.frame===f;if(1===n._keys.length){const e=n._getKeyValue(n._keys[0]);h.referenceValue=e.clone?e.clone():e,c=!0}else if(t<=a.frame){const e=n._getKeyValue(a.value);h.referenceValue=e.clone?e.clone():e,c=!0}else if(t>=l.frame){const e=n._getKeyValue(l.value);h.referenceValue=e.clone?e.clone():e,c=!0}let m=0;for(;!c||!p||!g&&m<n._keys.length-1;){const e=n._keys[m],i=n._keys[m+1];if(!c&&t>=e.frame&&t<=i.frame){let s;if(t===e.frame)s=n._getKeyValue(e.value);else if(t===i.frame)s=n._getKeyValue(i.value);else{const e={key:m,repeatCount:0,loopMode:this.ANIMATIONLOOPMODE_CONSTANT};s=n._interpolate(t,e)}h.referenceValue=s.clone?s.clone():s,c=!0}if(!p&&d>=e.frame&&d<=i.frame){if(d===e.frame)r=m;else if(d===i.frame)r=m+1;else{const e={key:m,repeatCount:0,loopMode:this.ANIMATIONLOOPMODE_CONSTANT},t=n._interpolate(d,e),i={frame:d,value:t.clone?t.clone():t};n._keys.splice(m+1,0,i),r=m+1}p=!0}if(!g&&f>=e.frame&&f<=i.frame){if(f===e.frame)o=m;else if(f===i.frame)o=m+1;else{const e={key:m,repeatCount:0,loopMode:this.ANIMATIONLOOPMODE_CONSTANT},t=n._interpolate(f,e),i={frame:f,value:t.clone?t.clone():t};n._keys.splice(m+1,0,i),o=m+1}g=!0}m++}for(n.dataType===N.ANIMATIONTYPE_QUATERNION?h.referenceValue.normalize().conjugateInPlace():n.dataType===N.ANIMATIONTYPE_MATRIX&&(h.referenceValue.decompose(h.referenceScaling,h.referenceQuaternion,h.referencePosition),h.referenceQuaternion.normalize().conjugateInPlace()),m=r;m<=o;m++){const e=n._keys[m];if(!m||n.dataType===N.ANIMATIONTYPE_FLOAT||e.value!==a.value)switch(n.dataType){case N.ANIMATIONTYPE_MATRIX:e.value.decompose(h.keyScaling,h.keyQuaternion,h.keyPosition),h.keyPosition.subtractInPlace(h.referencePosition),h.keyScaling.divideInPlace(h.referenceScaling),h.referenceQuaternion.multiplyToRef(h.keyQuaternion,h.keyQuaternion),u.y3.ComposeToRef(h.keyScaling,h.keyQuaternion,h.keyPosition,e.value);break;case N.ANIMATIONTYPE_QUATERNION:h.referenceValue.multiplyToRef(e.value,e.value);break;case N.ANIMATIONTYPE_VECTOR2:case N.ANIMATIONTYPE_VECTOR3:case N.ANIMATIONTYPE_COLOR3:case N.ANIMATIONTYPE_COLOR4:e.value.subtractToRef(h.referenceValue,e.value);break;case N.ANIMATIONTYPE_SIZE:e.value.width-=h.referenceValue.width,e.value.height-=h.referenceValue.height;break;default:e.value-=h.referenceValue}}return n}static TransitionTo(e,t,i,s,n,r,a){let o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;if(a<=0)return i[e]=t,o&&o(),null;const l=n*(a/1e3);r.setKeys([{frame:0,value:i[e].clone?i[e].clone():i[e]},{frame:l,value:t}]),i.animations||(i.animations=[]),i.animations.push(r);const h=s.beginAnimation(i,0,l,!1);return h.onAnimationEnd=o,h}get runtimeAnimations(){return this._runtimeAnimations}get hasRunningRuntimeAnimations(){for(const e of this._runtimeAnimations)if(!e.isStopped())return!0;return!1}constructor(e,t,i,s,n,r){this.name=e,this.targetProperty=t,this.framePerSecond=i,this.dataType=s,this.loopMode=n,this.enableBlending=r,this._easingFunction=null,this._runtimeAnimations=new Array,this._events=new Array,this.blendingSpeed=.01,this._ranges={},this.targetPropertyPath=t.split("."),this.dataType=s,this.loopMode=void 0===n?N.ANIMATIONLOOPMODE_CYCLE:n,this.uniqueId=N._UniqueIdGenerator++}toString(e){let t="Name: "+this.name+", property: "+this.targetProperty;if(t+=", datatype: "+["Float","Vector3","Quaternion","Matrix","Color3","Vector2"][this.dataType],t+=", nKeys: "+(this._keys?this._keys.length:"none"),t+=", nRanges: "+(this._ranges?Object.keys(this._ranges).length:"none"),e){t+=", Ranges: {";let e=!0;for(const i in this._ranges)e&&(t+=", ",e=!1),t+=i;t+="}"}return t}addEvent(e){this._events.push(e),this._events.sort(((e,t)=>e.frame-t.frame))}removeEvents(e){for(let t=0;t<this._events.length;t++)this._events[t].frame===e&&(this._events.splice(t,1),t--)}getEvents(){return this._events}createRange(e,t,i){this._ranges[e]||(this._ranges[e]=new R(e,t,i))}deleteRange(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const i=this._ranges[e];if(i){if(t){const e=i.from,t=i.to;for(let i=this._keys.length-1;i>=0;i--)this._keys[i].frame>=e&&this._keys[i].frame<=t&&this._keys.splice(i,1)}this._ranges[e]=null}}getRange(e){return this._ranges[e]}getKeys(){return this._keys}getHighestFrame(){let e=0;for(let t=0,i=this._keys.length;t<i;t++)e<this._keys[t].frame&&(e=this._keys[t].frame);return e}getEasingFunction(){return this._easingFunction}setEasingFunction(e){this._easingFunction=e}floatInterpolateFunction(e,t,i){return v.R.Lerp(e,t,i)}floatInterpolateFunctionWithTangents(e,t,i,s,n){return v.R.Hermite(e,t,i,s,n)}quaternionInterpolateFunction(e,t,i){return u._f.Slerp(e,t,i)}quaternionInterpolateFunctionWithTangents(e,t,i,s,n){return u._f.Hermite(e,t,i,s,n).normalize()}vector3InterpolateFunction(e,t,i){return u.P.Lerp(e,t,i)}vector3InterpolateFunctionWithTangents(e,t,i,s,n){return u.P.Hermite(e,t,i,s,n)}vector2InterpolateFunction(e,t,i){return u.FM.Lerp(e,t,i)}vector2InterpolateFunctionWithTangents(e,t,i,s,n){return u.FM.Hermite(e,t,i,s,n)}sizeInterpolateFunction(e,t,i){return E.Lerp(e,t,i)}color3InterpolateFunction(e,t,i){return d.Wo.Lerp(e,t,i)}color3InterpolateFunctionWithTangents(e,t,i,s,n){return d.Wo.Hermite(e,t,i,s,n)}color4InterpolateFunction(e,t,i){return d.HE.Lerp(e,t,i)}color4InterpolateFunctionWithTangents(e,t,i,s,n){return d.HE.Hermite(e,t,i,s,n)}_getKeyValue(e){return"function"==typeof e?e():e}evaluate(e){return this._interpolate(e,{key:0,repeatCount:0,loopMode:N.ANIMATIONLOOPMODE_CONSTANT})}_interpolate(e,t){if(t.loopMode===N.ANIMATIONLOOPMODE_CONSTANT&&t.repeatCount>0)return t.highLimitValue.clone?t.highLimitValue.clone():t.highLimitValue;const i=this._keys,s=i.length;let n=t.key;for(;n>=0&&e<i[n].frame;)--n;for(;n+1<=s-1&&e>=i[n+1].frame;)++n;if(t.key=n,n<0)return this._getKeyValue(i[0].value);if(n+1>s-1)return this._getKeyValue(i[s-1].value);const r=i[n],a=i[n+1],o=this._getKeyValue(r.value),l=this._getKeyValue(a.value);if(r.interpolation===P.STEP)return a.frame>e?o:l;const h=void 0!==r.outTangent&&void 0!==a.inTangent,c=a.frame-r.frame;let u=(e-r.frame)/c;const d=this.getEasingFunction();switch(null!==d&&(u=d.ease(u)),this.dataType){case N.ANIMATIONTYPE_FLOAT:{const e=h?this.floatInterpolateFunctionWithTangents(o,r.outTangent*c,l,a.inTangent*c,u):this.floatInterpolateFunction(o,l,u);switch(t.loopMode){case N.ANIMATIONLOOPMODE_CYCLE:case N.ANIMATIONLOOPMODE_CONSTANT:return e;case N.ANIMATIONLOOPMODE_RELATIVE:return t.offsetValue*t.repeatCount+e}break}case N.ANIMATIONTYPE_QUATERNION:{const e=h?this.quaternionInterpolateFunctionWithTangents(o,r.outTangent.scale(c),l,a.inTangent.scale(c),u):this.quaternionInterpolateFunction(o,l,u);switch(t.loopMode){case N.ANIMATIONLOOPMODE_CYCLE:case N.ANIMATIONLOOPMODE_CONSTANT:return e;case N.ANIMATIONLOOPMODE_RELATIVE:return e.addInPlace(t.offsetValue.scale(t.repeatCount))}return e}case N.ANIMATIONTYPE_VECTOR3:{const e=h?this.vector3InterpolateFunctionWithTangents(o,r.outTangent.scale(c),l,a.inTangent.scale(c),u):this.vector3InterpolateFunction(o,l,u);switch(t.loopMode){case N.ANIMATIONLOOPMODE_CYCLE:case N.ANIMATIONLOOPMODE_CONSTANT:return e;case N.ANIMATIONLOOPMODE_RELATIVE:return e.add(t.offsetValue.scale(t.repeatCount))}break}case N.ANIMATIONTYPE_VECTOR2:{const e=h?this.vector2InterpolateFunctionWithTangents(o,r.outTangent.scale(c),l,a.inTangent.scale(c),u):this.vector2InterpolateFunction(o,l,u);switch(t.loopMode){case N.ANIMATIONLOOPMODE_CYCLE:case N.ANIMATIONLOOPMODE_CONSTANT:return e;case N.ANIMATIONLOOPMODE_RELATIVE:return e.add(t.offsetValue.scale(t.repeatCount))}break}case N.ANIMATIONTYPE_SIZE:switch(t.loopMode){case N.ANIMATIONLOOPMODE_CYCLE:case N.ANIMATIONLOOPMODE_CONSTANT:return this.sizeInterpolateFunction(o,l,u);case N.ANIMATIONLOOPMODE_RELATIVE:return this.sizeInterpolateFunction(o,l,u).add(t.offsetValue.scale(t.repeatCount))}break;case N.ANIMATIONTYPE_COLOR3:{const e=h?this.color3InterpolateFunctionWithTangents(o,r.outTangent.scale(c),l,a.inTangent.scale(c),u):this.color3InterpolateFunction(o,l,u);switch(t.loopMode){case N.ANIMATIONLOOPMODE_CYCLE:case N.ANIMATIONLOOPMODE_CONSTANT:return e;case N.ANIMATIONLOOPMODE_RELATIVE:return e.add(t.offsetValue.scale(t.repeatCount))}break}case N.ANIMATIONTYPE_COLOR4:{const e=h?this.color4InterpolateFunctionWithTangents(o,r.outTangent.scale(c),l,a.inTangent.scale(c),u):this.color4InterpolateFunction(o,l,u);switch(t.loopMode){case N.ANIMATIONLOOPMODE_CYCLE:case N.ANIMATIONLOOPMODE_CONSTANT:return e;case N.ANIMATIONLOOPMODE_RELATIVE:return e.add(t.offsetValue.scale(t.repeatCount))}break}case N.ANIMATIONTYPE_MATRIX:switch(t.loopMode){case N.ANIMATIONLOOPMODE_CYCLE:case N.ANIMATIONLOOPMODE_CONSTANT:return N.AllowMatricesInterpolation?this.matrixInterpolateFunction(o,l,u,t.workValue):o;case N.ANIMATIONLOOPMODE_RELATIVE:return o}}return 0}matrixInterpolateFunction(e,t,i,s){return N.AllowMatrixDecomposeForInterpolation?s?(u.y3.DecomposeLerpToRef(e,t,i,s),s):u.y3.DecomposeLerp(e,t,i):s?(u.y3.LerpToRef(e,t,i,s),s):u.y3.Lerp(e,t,i)}clone(){const e=new N(this.name,this.targetPropertyPath.join("."),this.framePerSecond,this.dataType,this.loopMode);if(e.enableBlending=this.enableBlending,e.blendingSpeed=this.blendingSpeed,this._keys&&e.setKeys(this._keys),this._ranges){e._ranges={};for(const t in this._ranges){const i=this._ranges[t];i&&(e._ranges[t]=i.clone())}}return e}setKeys(e){this._keys=e.slice(0)}serialize(){const e={};e.name=this.name,e.property=this.targetProperty,e.framePerSecond=this.framePerSecond,e.dataType=this.dataType,e.loopBehavior=this.loopMode,e.enableBlending=this.enableBlending,e.blendingSpeed=this.blendingSpeed;const t=this.dataType;e.keys=[];const i=this.getKeys();for(let s=0;s<i.length;s++){const n=i[s],r={};switch(r.frame=n.frame,t){case N.ANIMATIONTYPE_FLOAT:r.values=[n.value],void 0!==n.inTangent&&r.values.push(n.inTangent),void 0!==n.outTangent&&(void 0===n.inTangent&&r.values.push(void 0),r.values.push(n.outTangent)),void 0!==n.interpolation&&(void 0===n.inTangent&&r.values.push(void 0),void 0===n.outTangent&&r.values.push(void 0),r.values.push(n.interpolation));break;case N.ANIMATIONTYPE_QUATERNION:case N.ANIMATIONTYPE_MATRIX:case N.ANIMATIONTYPE_VECTOR3:case N.ANIMATIONTYPE_COLOR3:case N.ANIMATIONTYPE_COLOR4:r.values=n.value.asArray(),null!=n.inTangent&&r.values.push(n.inTangent.asArray()),null!=n.outTangent&&(void 0===n.inTangent&&r.values.push(void 0),r.values.push(n.outTangent.asArray())),void 0!==n.interpolation&&(void 0===n.inTangent&&r.values.push(void 0),void 0===n.outTangent&&r.values.push(void 0),r.values.push(n.interpolation))}e.keys.push(r)}e.ranges=[];for(const s in this._ranges){const t=this._ranges[s];if(!t)continue;const i={};i.name=s,i.from=t.from,i.to=t.to,e.ranges.push(i)}return e}static _UniversalLerp(e,t,i){const s=e.constructor;return s.Lerp?s.Lerp(e,t,i):s.Slerp?s.Slerp(e,t,i):e.toFixed?e*(1-i)+i*t:t}static Parse(e){const t=new N(e.name,e.property,e.framePerSecond,e.dataType,e.loopBehavior),i=e.dataType,s=[];let n,r;for(e.enableBlending&&(t.enableBlending=e.enableBlending),e.blendingSpeed&&(t.blendingSpeed=e.blendingSpeed),r=0;r<e.keys.length;r++){const t=e.keys[r];let a,o,l;switch(i){case N.ANIMATIONTYPE_FLOAT:n=t.values[0],t.values.length>=2&&(a=t.values[1]),t.values.length>=3&&(o=t.values[2]),t.values.length>=4&&(l=t.values[3]);break;case N.ANIMATIONTYPE_QUATERNION:if(n=u._f.FromArray(t.values),t.values.length>=8){const e=u._f.FromArray(t.values.slice(4,8));e.equals(u._f.Zero())||(a=e)}if(t.values.length>=12){const e=u._f.FromArray(t.values.slice(8,12));e.equals(u._f.Zero())||(o=e)}t.values.length>=13&&(l=t.values[12]);break;case N.ANIMATIONTYPE_MATRIX:n=u.y3.FromArray(t.values),t.values.length>=17&&(l=t.values[16]);break;case N.ANIMATIONTYPE_COLOR3:n=d.Wo.FromArray(t.values),t.values[3]&&(a=d.Wo.FromArray(t.values[3])),t.values[4]&&(o=d.Wo.FromArray(t.values[4])),t.values[5]&&(l=t.values[5]);break;case N.ANIMATIONTYPE_COLOR4:n=d.HE.FromArray(t.values),t.values[4]&&(a=d.HE.FromArray(t.values[4])),t.values[5]&&(o=d.HE.FromArray(t.values[5])),t.values[6]&&(l=d.HE.FromArray(t.values[6]));break;case N.ANIMATIONTYPE_VECTOR3:default:n=u.P.FromArray(t.values),t.values[3]&&(a=u.P.FromArray(t.values[3])),t.values[4]&&(o=u.P.FromArray(t.values[4])),t.values[5]&&(l=t.values[5])}const h={};h.frame=t.frame,h.value=n,null!=a&&(h.inTangent=a),null!=o&&(h.outTangent=o),null!=l&&(h.interpolation=l),s.push(h)}if(t.setKeys(s),e.ranges)for(r=0;r<e.ranges.length;r++)n=e.ranges[r],t.createRange(n.name,n.from,n.to);return t}static AppendSerializedAnimations(e,t){M.p4.AppendSerializedAnimations(e,t)}static ParseFromFileAsync(e,t){return new Promise(((i,s)=>{const n=new O.g;n.addEventListener("readystatechange",(()=>{if(4==n.readyState)if(200==n.status){let t=JSON.parse(n.responseText);if(t.animations&&(t=t.animations),t.length){const e=new Array;for(const i of t)e.push(this.Parse(i));i(e)}else{const s=this.Parse(t);e&&(s.name=e),i(s)}}else s("Unable to load the animation")})),n.open("GET",t),n.send()}))}static ParseFromSnippetAsync(e){return new Promise(((t,i)=>{const s=new O.g;s.addEventListener("readystatechange",(()=>{if(4==s.readyState)if(200==s.status){const i=JSON.parse(JSON.parse(s.responseText).jsonPayload);if(i.animations){const s=JSON.parse(i.animations),n=new Array;for(const t of s.animations){const i=this.Parse(t);i.snippetId=e,n.push(i)}t(n)}else{const s=JSON.parse(i.animation),n=this.Parse(s);n.snippetId=e,t(n)}}else i("Unable to load the snippet "+e)})),s.open("GET",this.SnippetUrl+"/"+e.replace(/#/g,"/")),s.send()}))}}N._UniqueIdGenerator=0,N.AllowMatricesInterpolation=!1,N.AllowMatrixDecomposeForInterpolation=!0,N.SnippetUrl="https://snippet.babylonjs.com",N.ANIMATIONTYPE_FLOAT=0,N.ANIMATIONTYPE_VECTOR3=1,N.ANIMATIONTYPE_QUATERNION=2,N.ANIMATIONTYPE_MATRIX=3,N.ANIMATIONTYPE_COLOR3=4,N.ANIMATIONTYPE_COLOR4=7,N.ANIMATIONTYPE_VECTOR2=5,N.ANIMATIONTYPE_SIZE=6,N.ANIMATIONLOOPMODE_RELATIVE=0,N.ANIMATIONLOOPMODE_CYCLE=1,N.ANIMATIONLOOPMODE_CONSTANT=2,N.CreateFromSnippetAsync=N.ParseFromSnippetAsync,(0,x.H)("BABYLON.Animation",N),A.N._AnimationRangeFactory=(e,t,i)=>new R(e,t,i);class w{constructor(){this.transitionDuration=450,this.lowerRadiusTransitionRange=2,this.upperRadiusTransitionRange=-2,this._autoTransitionRange=!1,this._radiusIsAnimating=!1,this._radiusBounceTransition=null,this._animatables=new Array}get name(){return"Bouncing"}get autoTransitionRange(){return this._autoTransitionRange}set autoTransitionRange(e){if(this._autoTransitionRange===e)return;this._autoTransitionRange=e;const t=this._attachedCamera;t&&(e?this._onMeshTargetChangedObserver=t.onMeshTargetChangedObservable.add((e=>{if(!e)return;e.computeWorldMatrix(!0);const t=e.getBoundingInfo().diagonalLength;this.lowerRadiusTransitionRange=.05*t,this.upperRadiusTransitionRange=.05*t})):this._onMeshTargetChangedObserver&&t.onMeshTargetChangedObservable.remove(this._onMeshTargetChangedObserver))}init(){}attach(e){this._attachedCamera=e,this._onAfterCheckInputsObserver=e.onAfterCheckInputsObservable.add((()=>{this._attachedCamera&&(this._isRadiusAtLimit(this._attachedCamera.lowerRadiusLimit)&&this._applyBoundRadiusAnimation(this.lowerRadiusTransitionRange),this._isRadiusAtLimit(this._attachedCamera.upperRadiusLimit)&&this._applyBoundRadiusAnimation(this.upperRadiusTransitionRange))}))}detach(){this._attachedCamera&&(this._onAfterCheckInputsObserver&&this._attachedCamera.onAfterCheckInputsObservable.remove(this._onAfterCheckInputsObserver),this._onMeshTargetChangedObserver&&this._attachedCamera.onMeshTargetChangedObservable.remove(this._onMeshTargetChangedObserver),this._attachedCamera=null)}_isRadiusAtLimit(e){return!!this._attachedCamera&&(this._attachedCamera.radius===e&&!this._radiusIsAnimating)}_applyBoundRadiusAnimation(e){if(!this._attachedCamera)return;this._radiusBounceTransition||(w.EasingFunction.setEasingMode(w.EasingMode),this._radiusBounceTransition=N.CreateAnimation("radius",N.ANIMATIONTYPE_FLOAT,60,w.EasingFunction)),this._cachedWheelPrecision=this._attachedCamera.wheelPrecision,this._attachedCamera.wheelPrecision=1/0,this._attachedCamera.inertialRadiusOffset=0,this.stopAllAnimations(),this._radiusIsAnimating=!0;const t=N.TransitionTo("radius",this._attachedCamera.radius+e,this._attachedCamera,this._attachedCamera.getScene(),60,this._radiusBounceTransition,this.transitionDuration,(()=>this._clearAnimationLocks()));t&&this._animatables.push(t)}_clearAnimationLocks(){this._radiusIsAnimating=!1,this._attachedCamera&&(this._attachedCamera.wheelPrecision=this._cachedWheelPrecision)}stopAllAnimations(){for(this._attachedCamera&&(this._attachedCamera.animations=[]);this._animatables.length;)this._animatables[0].onAnimationEnd=null,this._animatables[0].stop(),this._animatables.shift()}}w.EasingFunction=new class extends D{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;super(),this.amplitude=e}easeInCore(e){const t=Math.max(0,this.amplitude);return Math.pow(e,3)-e*t*Math.sin(3.141592653589793*e)}}(.3),w.EasingMode=D.EASINGMODE_EASEOUT;class L{constructor(){this.onTargetFramingAnimationEndObservable=new T.y$,this._mode=L.FitFrustumSidesMode,this._radiusScale=1,this._positionScale=.5,this._defaultElevation=.3,this._elevationReturnTime=1500,this._elevationReturnWaitTime=1e3,this._zoomStopsAnimation=!1,this._framingTime=1500,this.autoCorrectCameraLimitsAndSensibility=!0,this._isPointerDown=!1,this._lastInteractionTime=-1/0,this._animatables=new Array,this._betaIsAnimating=!1}get name(){return"Framing"}set mode(e){this._mode=e}get mode(){return this._mode}set radiusScale(e){this._radiusScale=e}get radiusScale(){return this._radiusScale}set positionScale(e){this._positionScale=e}get positionScale(){return this._positionScale}set defaultElevation(e){this._defaultElevation=e}get defaultElevation(){return this._defaultElevation}set elevationReturnTime(e){this._elevationReturnTime=e}get elevationReturnTime(){return this._elevationReturnTime}set elevationReturnWaitTime(e){this._elevationReturnWaitTime=e}get elevationReturnWaitTime(){return this._elevationReturnWaitTime}set zoomStopsAnimation(e){this._zoomStopsAnimation=e}get zoomStopsAnimation(){return this._zoomStopsAnimation}set framingTime(e){this._framingTime=e}get framingTime(){return this._framingTime}init(){}attach(e){this._attachedCamera=e;const t=this._attachedCamera.getScene();L.EasingFunction.setEasingMode(L.EasingMode),this._onPrePointerObservableObserver=t.onPrePointerObservable.add((e=>{e.type!==S.kD.POINTERDOWN?e.type===S.kD.POINTERUP&&(this._isPointerDown=!1):this._isPointerDown=!0})),this._onMeshTargetChangedObserver=e.onMeshTargetChangedObservable.add((e=>{e&&this.zoomOnMesh(e,void 0,(()=>{this.onTargetFramingAnimationEndObservable.notifyObservers()}))})),this._onAfterCheckInputsObserver=e.onAfterCheckInputsObservable.add((()=>{this._applyUserInteraction(),this._maintainCameraAboveGround()}))}detach(){if(!this._attachedCamera)return;const e=this._attachedCamera.getScene();this._onPrePointerObservableObserver&&e.onPrePointerObservable.remove(this._onPrePointerObservableObserver),this._onAfterCheckInputsObserver&&this._attachedCamera.onAfterCheckInputsObservable.remove(this._onAfterCheckInputsObserver),this._onMeshTargetChangedObserver&&this._attachedCamera.onMeshTargetChangedObservable.remove(this._onMeshTargetChangedObserver),this._attachedCamera=null}zoomOnMesh(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.computeWorldMatrix(!0);const s=e.getBoundingInfo().boundingBox;this.zoomOnBoundingInfo(s.minimumWorld,s.maximumWorld,t,i)}zoomOnMeshHierarchy(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.computeWorldMatrix(!0);const s=e.getHierarchyBoundingVectors(!0);this.zoomOnBoundingInfo(s.min,s.max,t,i)}zoomOnMeshesHierarchy(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const s=new u.P(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),n=new u.P(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(let r=0;r<e.length;r++){const t=e[r].getHierarchyBoundingVectors(!0);u.P.CheckExtends(t.min,s,n),u.P.CheckExtends(t.max,s,n)}this.zoomOnBoundingInfo(s,n,t,i)}zoomOnBoundingInfo(e,t){let i,s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(!this._attachedCamera)return;const r=e.y,a=r+(t.y-r)*this._positionScale,o=t.subtract(e).scale(.5);if(s)i=new u.P(0,a,0);else{const t=e.add(o);i=new u.P(t.x,a,t.z)}this._vectorTransition||(this._vectorTransition=N.CreateAnimation("target",N.ANIMATIONTYPE_VECTOR3,60,L.EasingFunction)),this._betaIsAnimating=!0;let l=N.TransitionTo("target",i,this._attachedCamera,this._attachedCamera.getScene(),60,this._vectorTransition,this._framingTime);l&&this._animatables.push(l);let h=0;if(this._mode===L.FitFrustumSidesMode){const i=this._calculateLowerRadiusFromModelBoundingSphere(e,t);this.autoCorrectCameraLimitsAndSensibility&&(this._attachedCamera.lowerRadiusLimit=o.length()+this._attachedCamera.minZ),h=i}else this._mode===L.IgnoreBoundsSizeMode&&(h=this._calculateLowerRadiusFromModelBoundingSphere(e,t),this.autoCorrectCameraLimitsAndSensibility&&null===this._attachedCamera.lowerRadiusLimit&&(this._attachedCamera.lowerRadiusLimit=this._attachedCamera.minZ));if(this.autoCorrectCameraLimitsAndSensibility){const i=t.subtract(e).length();this._attachedCamera.panningSensibility=5e3/i,this._attachedCamera.wheelPrecision=100/h}this._radiusTransition||(this._radiusTransition=N.CreateAnimation("radius",N.ANIMATIONTYPE_FLOAT,60,L.EasingFunction)),l=N.TransitionTo("radius",h,this._attachedCamera,this._attachedCamera.getScene(),60,this._radiusTransition,this._framingTime,(()=>{this.stopAllAnimations(),n&&n(),this._attachedCamera&&this._attachedCamera.useInputToRestoreState&&this._attachedCamera.storeState()})),l&&this._animatables.push(l)}_calculateLowerRadiusFromModelBoundingSphere(e,t){const i=t.subtract(e).length(),s=this._getFrustumSlope(),n=.5*i*this._radiusScale,r=n*Math.sqrt(1+1/(s.x*s.x)),a=n*Math.sqrt(1+1/(s.y*s.y));let o=Math.max(r,a);const l=this._attachedCamera;return l?(l.lowerRadiusLimit&&this._mode===L.IgnoreBoundsSizeMode&&(o=o<l.lowerRadiusLimit?l.lowerRadiusLimit:o),l.upperRadiusLimit&&(o=o>l.upperRadiusLimit?l.upperRadiusLimit:o),o):0}_maintainCameraAboveGround(){if(this._elevationReturnTime<0)return;const e=I.F.Now-this._lastInteractionTime,t=.5*Math.PI-this._defaultElevation,i=.5*Math.PI;if(this._attachedCamera&&!this._betaIsAnimating&&this._attachedCamera.beta>i&&e>=this._elevationReturnWaitTime){this._betaIsAnimating=!0,this.stopAllAnimations(),this._betaTransition||(this._betaTransition=N.CreateAnimation("beta",N.ANIMATIONTYPE_FLOAT,60,L.EasingFunction));const e=N.TransitionTo("beta",t,this._attachedCamera,this._attachedCamera.getScene(),60,this._betaTransition,this._elevationReturnTime,(()=>{this._clearAnimationLocks(),this.stopAllAnimations()}));e&&this._animatables.push(e)}}_getFrustumSlope(){const e=this._attachedCamera;if(!e)return u.FM.Zero();const t=e.getScene().getEngine().getAspectRatio(e),i=Math.tan(e.fov/2),s=i*t;return new u.FM(s,i)}_clearAnimationLocks(){this._betaIsAnimating=!1}_applyUserInteraction(){this.isUserIsMoving&&(this._lastInteractionTime=I.F.Now,this.stopAllAnimations(),this._clearAnimationLocks())}stopAllAnimations(){for(this._attachedCamera&&(this._attachedCamera.animations=[]);this._animatables.length;)this._animatables[0]&&(this._animatables[0].onAnimationEnd=null,this._animatables[0].stop()),this._animatables.shift()}get isUserIsMoving(){return!!this._attachedCamera&&(0!==this._attachedCamera.inertialAlphaOffset||0!==this._attachedCamera.inertialBetaOffset||0!==this._attachedCamera.inertialRadiusOffset||0!==this._attachedCamera.inertialPanningX||0!==this._attachedCamera.inertialPanningY||this._isPointerDown)}}L.EasingFunction=new class extends D{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;super(),this.exponent=e}easeInCore(e){return this.exponent<=0?e:(Math.exp(this.exponent*e)-1)/(Math.exp(this.exponent)-1)}},L.EasingMode=D.EASINGMODE_EASEINOUT,L.IgnoreBoundsSizeMode=0,L.FitFrustumSidesMode=1;var F=i(7337);class B extends F.V{constructor(e,t,i){super(e,t,i,!(arguments.length>3&&void 0!==arguments[3])||arguments[3]),this._tmpUpVector=u.P.Zero(),this._tmpTargetVector=u.P.Zero(),this.cameraDirection=new u.P(0,0,0),this.cameraRotation=new u.FM(0,0),this.ignoreParentScaling=!1,this.updateUpVectorFromRotation=!1,this._tmpQuaternion=new u._f,this.rotation=new u.P(0,0,0),this.speed=2,this.noRotationConstraint=!1,this.invertRotation=!1,this.inverseRotationSpeed=.2,this.lockedTarget=null,this._currentTarget=u.P.Zero(),this._initialFocalDistance=1,this._viewMatrix=u.y3.Zero(),this._camMatrix=u.y3.Zero(),this._cameraTransformMatrix=u.y3.Zero(),this._cameraRotationMatrix=u.y3.Zero(),this._referencePoint=new u.P(0,0,1),this._transformedReferencePoint=u.P.Zero(),this._defaultUp=u.P.Up(),this._cachedRotationZ=0,this._cachedQuaternionRotationZ=0}getFrontPosition(e){this.getWorldMatrix();const t=this.getTarget().subtract(this.position);return t.normalize(),t.scaleInPlace(e),this.globalPosition.add(t)}_getLockedTargetPosition(){if(!this.lockedTarget)return null;if(this.lockedTarget.absolutePosition){const e=this.lockedTarget;e.computeWorldMatrix().getTranslationToRef(e.absolutePosition)}return this.lockedTarget.absolutePosition||this.lockedTarget}storeState(){return this._storedPosition=this.position.clone(),this._storedRotation=this.rotation.clone(),this.rotationQuaternion&&(this._storedRotationQuaternion=this.rotationQuaternion.clone()),super.storeState()}_restoreStateValues(){return!!super._restoreStateValues()&&(this.position=this._storedPosition.clone(),this.rotation=this._storedRotation.clone(),this.rotationQuaternion&&(this.rotationQuaternion=this._storedRotationQuaternion.clone()),this.cameraDirection.copyFromFloats(0,0,0),this.cameraRotation.copyFromFloats(0,0),!0)}_initCache(){super._initCache(),this._cache.lockedTarget=new u.P(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),this._cache.rotation=new u.P(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),this._cache.rotationQuaternion=new u._f(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE)}_updateCache(e){e||super._updateCache();const t=this._getLockedTargetPosition();t?this._cache.lockedTarget?this._cache.lockedTarget.copyFrom(t):this._cache.lockedTarget=t.clone():this._cache.lockedTarget=null,this._cache.rotation.copyFrom(this.rotation),this.rotationQuaternion&&this._cache.rotationQuaternion.copyFrom(this.rotationQuaternion)}_isSynchronizedViewMatrix(){if(!super._isSynchronizedViewMatrix())return!1;const e=this._getLockedTargetPosition();return(this._cache.lockedTarget?this._cache.lockedTarget.equals(e):!e)&&(this.rotationQuaternion?this.rotationQuaternion.equals(this._cache.rotationQuaternion):this._cache.rotation.equals(this.rotation))}_computeLocalCameraSpeed(){const e=this.getEngine();return this.speed*Math.sqrt(e.getDeltaTime()/(100*e.getFps()))}setTarget(e){this.upVector.normalize(),this._initialFocalDistance=e.subtract(this.position).length(),this.position.z===e.z&&(this.position.z+=_.kn),this._referencePoint.normalize().scaleInPlace(this._initialFocalDistance),u.y3.LookAtLHToRef(this.position,e,this._defaultUp,this._camMatrix),this._camMatrix.invert(),this.rotation.x=Math.atan(this._camMatrix.m[6]/this._camMatrix.m[10]);const t=e.subtract(this.position);t.x>=0?this.rotation.y=-Math.atan(t.z/t.x)+Math.PI/2:this.rotation.y=-Math.atan(t.z/t.x)-Math.PI/2,this.rotation.z=0,isNaN(this.rotation.x)&&(this.rotation.x=0),isNaN(this.rotation.y)&&(this.rotation.y=0),isNaN(this.rotation.z)&&(this.rotation.z=0),this.rotationQuaternion&&u._f.RotationYawPitchRollToRef(this.rotation.y,this.rotation.x,this.rotation.z,this.rotationQuaternion)}get target(){return this.getTarget()}set target(e){this.setTarget(e)}getTarget(){return this._currentTarget}_decideIfNeedsToMove(){return Math.abs(this.cameraDirection.x)>0||Math.abs(this.cameraDirection.y)>0||Math.abs(this.cameraDirection.z)>0}_updatePosition(){if(this.parent)return this.parent.getWorldMatrix().invertToRef(u.jp.Matrix[0]),u.P.TransformNormalToRef(this.cameraDirection,u.jp.Matrix[0],u.jp.Vector3[0]),void this.position.addInPlace(u.jp.Vector3[0]);this.position.addInPlace(this.cameraDirection)}_checkInputs(){const e=this.invertRotation?-this.inverseRotationSpeed:1,t=this._decideIfNeedsToMove(),i=Math.abs(this.cameraRotation.x)>0||Math.abs(this.cameraRotation.y)>0;if(t&&this._updatePosition(),i){if(this.rotationQuaternion&&this.rotationQuaternion.toEulerAnglesToRef(this.rotation),this.rotation.x+=this.cameraRotation.x*e,this.rotation.y+=this.cameraRotation.y*e,!this.noRotationConstraint){const e=1.570796;this.rotation.x>e&&(this.rotation.x=e),this.rotation.x<-e&&(this.rotation.x=-e)}if(this.rotationQuaternion){this.rotation.lengthSquared()&&u._f.RotationYawPitchRollToRef(this.rotation.y,this.rotation.x,this.rotation.z,this.rotationQuaternion)}}t&&(Math.abs(this.cameraDirection.x)<this.speed*_.kn&&(this.cameraDirection.x=0),Math.abs(this.cameraDirection.y)<this.speed*_.kn&&(this.cameraDirection.y=0),Math.abs(this.cameraDirection.z)<this.speed*_.kn&&(this.cameraDirection.z=0),this.cameraDirection.scaleInPlace(this.inertia)),i&&(Math.abs(this.cameraRotation.x)<this.speed*_.kn&&(this.cameraRotation.x=0),Math.abs(this.cameraRotation.y)<this.speed*_.kn&&(this.cameraRotation.y=0),this.cameraRotation.scaleInPlace(this.inertia)),super._checkInputs()}_updateCameraRotationMatrix(){this.rotationQuaternion?this.rotationQuaternion.toRotationMatrix(this._cameraRotationMatrix):u.y3.RotationYawPitchRollToRef(this.rotation.y,this.rotation.x,this.rotation.z,this._cameraRotationMatrix)}_rotateUpVectorWithCameraRotationMatrix(){return u.P.TransformNormalToRef(this._defaultUp,this._cameraRotationMatrix,this.upVector),this}_getViewMatrix(){return this.lockedTarget&&this.setTarget(this._getLockedTargetPosition()),this._updateCameraRotationMatrix(),this.rotationQuaternion&&this._cachedQuaternionRotationZ!=this.rotationQuaternion.z?(this._rotateUpVectorWithCameraRotationMatrix(),this._cachedQuaternionRotationZ=this.rotationQuaternion.z):this._cachedRotationZ!==this.rotation.z&&(this._rotateUpVectorWithCameraRotationMatrix(),this._cachedRotationZ=this.rotation.z),u.P.TransformCoordinatesToRef(this._referencePoint,this._cameraRotationMatrix,this._transformedReferencePoint),this.position.addToRef(this._transformedReferencePoint,this._currentTarget),this.updateUpVectorFromRotation&&(this.rotationQuaternion?m.RD.Y.rotateByQuaternionToRef(this.rotationQuaternion,this.upVector):(u._f.FromEulerVectorToRef(this.rotation,this._tmpQuaternion),m.RD.Y.rotateByQuaternionToRef(this._tmpQuaternion,this.upVector))),this._computeViewMatrix(this.position,this._currentTarget,this.upVector),this._viewMatrix}_computeViewMatrix(e,t,i){if(this.ignoreParentScaling){if(this.parent){const s=this.parent.getWorldMatrix();u.P.TransformCoordinatesToRef(e,s,this._globalPosition),u.P.TransformCoordinatesToRef(t,s,this._tmpTargetVector),u.P.TransformNormalToRef(i,s,this._tmpUpVector),this._markSyncedWithParent()}else this._globalPosition.copyFrom(e),this._tmpTargetVector.copyFrom(t),this._tmpUpVector.copyFrom(i);this.getScene().useRightHandedSystem?u.y3.LookAtRHToRef(this._globalPosition,this._tmpTargetVector,this._tmpUpVector,this._viewMatrix):u.y3.LookAtLHToRef(this._globalPosition,this._tmpTargetVector,this._tmpUpVector,this._viewMatrix)}else if(this.getScene().useRightHandedSystem?u.y3.LookAtRHToRef(e,t,i,this._viewMatrix):u.y3.LookAtLHToRef(e,t,i,this._viewMatrix),this.parent){const e=this.parent.getWorldMatrix();this._viewMatrix.invert(),this._viewMatrix.multiplyToRef(e,this._viewMatrix),this._viewMatrix.getTranslationToRef(this._globalPosition),this._viewMatrix.invert(),this._markSyncedWithParent()}else this._globalPosition.copyFrom(e)}createRigCamera(e,t){if(this.cameraRigMode!==F.V.RIG_MODE_NONE){const t=new B(e,this.position.clone(),this.getScene());return t.isRigCamera=!0,t.rigParent=this,this.cameraRigMode!==F.V.RIG_MODE_VR&&this.cameraRigMode!==F.V.RIG_MODE_WEBVR||(this.rotationQuaternion||(this.rotationQuaternion=new u._f),t._cameraRigParams={},t.rotationQuaternion=new u._f),t.mode=this.mode,t.orthoLeft=this.orthoLeft,t.orthoRight=this.orthoRight,t.orthoTop=this.orthoTop,t.orthoBottom=this.orthoBottom,t}return null}_updateRigCameras(){const e=this._rigCameras[0],t=this._rigCameras[1];switch(this.computeWorldMatrix(),this.cameraRigMode){case F.V.RIG_MODE_STEREOSCOPIC_ANAGLYPH:case F.V.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL:case F.V.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED:case F.V.RIG_MODE_STEREOSCOPIC_OVERUNDER:case F.V.RIG_MODE_STEREOSCOPIC_INTERLACED:{const i=this.cameraRigMode===F.V.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED?1:-1,s=this.cameraRigMode===F.V.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED?-1:1;this._getRigCamPositionAndTarget(this._cameraRigParams.stereoHalfAngle*i,e),this._getRigCamPositionAndTarget(this._cameraRigParams.stereoHalfAngle*s,t);break}case F.V.RIG_MODE_VR:e.rotationQuaternion?(e.rotationQuaternion.copyFrom(this.rotationQuaternion),t.rotationQuaternion.copyFrom(this.rotationQuaternion)):(e.rotation.copyFrom(this.rotation),t.rotation.copyFrom(this.rotation)),e.position.copyFrom(this.position),t.position.copyFrom(this.position)}super._updateRigCameras()}_getRigCamPositionAndTarget(e,t){this.getTarget().subtractToRef(this.position,B._TargetFocalPoint),B._TargetFocalPoint.normalize().scaleInPlace(this._initialFocalDistance);const i=B._TargetFocalPoint.addInPlace(this.position);u.y3.TranslationToRef(-i.x,-i.y,-i.z,B._TargetTransformMatrix),B._TargetTransformMatrix.multiplyToRef(u.y3.RotationAxis(t.upVector,e),B._RigCamTransformMatrix),u.y3.TranslationToRef(i.x,i.y,i.z,B._TargetTransformMatrix),B._RigCamTransformMatrix.multiplyToRef(B._TargetTransformMatrix,B._RigCamTransformMatrix),u.P.TransformCoordinatesToRef(this.position,B._RigCamTransformMatrix,t.position),t.setTarget(i)}getClassName(){return"TargetCamera"}}B._RigCamTransformMatrix=new u.y3,B._TargetTransformMatrix=new u.y3,B._TargetFocalPoint=new u.P,(0,y.gn)([(0,M.hd)()],B.prototype,"rotation",void 0),(0,y.gn)([(0,M.qC)()],B.prototype,"speed",void 0),(0,y.gn)([(0,M.RR)("lockedTargetId")],B.prototype,"lockedTarget",void 0);var U=i(2328),k={};class V{constructor(e){this.attachedToElement=!1,this.attached={},this.camera=e,this.checkInputs=()=>{}}add(e){const t=e.getSimpleName();this.attached[t]?U.Y.Warn("camera input of type "+t+" already exists on camera"):(this.attached[t]=e,e.camera=this.camera,e.checkInputs&&(this.checkInputs=this._addCheckInputs(e.checkInputs.bind(e))),this.attachedToElement&&e.attachControl(this.noPreventDefault))}remove(e){for(const t in this.attached){const i=this.attached[t];if(i===e)return i.detachControl(),i.camera=null,delete this.attached[t],void this.rebuildInputCheck()}}removeByType(e){for(const t in this.attached){const i=this.attached[t];i.getClassName()===e&&(i.detachControl(),i.camera=null,delete this.attached[t],this.rebuildInputCheck())}}_addCheckInputs(e){const t=this.checkInputs;return()=>{t(),e()}}attachInput(e){this.attachedToElement&&e.attachControl(this.noPreventDefault)}attachElement(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.attachedToElement){e=!F.V.ForceAttachControlToAlwaysPreventDefault&&e,this.attachedToElement=!0,this.noPreventDefault=e;for(const t in this.attached)this.attached[t].attachControl(e)}}detachElement(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];for(const t in this.attached)this.attached[t].detachControl(),e&&(this.attached[t].camera=null);this.attachedToElement=!1}rebuildInputCheck(){this.checkInputs=()=>{};for(const e in this.attached){const t=this.attached[e];t.checkInputs&&(this.checkInputs=this._addCheckInputs(t.checkInputs.bind(t)))}}clear(){this.attachedToElement&&this.detachElement(!0),this.attached={},this.attachedToElement=!1,this.checkInputs=()=>{}}serialize(e){const t={};for(const i in this.attached){const e=this.attached[i],s=M.p4.Serialize(e);t[e.getClassName()]=s}e.inputsmgr=t}parse(e){const t=e.inputsmgr;if(t){this.clear();for(const e in t){const i=k[e];if(i){const s=t[e],n=M.p4.Parse((()=>new i),s,null);this.add(n)}}}else for(const i in this.attached){const t=k[this.attached[i].getClassName()];if(t){const s=M.p4.Parse((()=>new t),e,null);this.remove(this.attached[i]),this.add(s)}}}}var G=i(8517);class W{constructor(){this._currentActiveButton=-1,this.buttons=[0,1,2]}attachControl(e){e=G.w1.BackCompatCameraNoPreventDefault(arguments);const t=this.camera.getEngine(),i=t.getInputElement();let s=0,n=null;this._pointA=null,this._pointB=null,this._altKey=!1,this._ctrlKey=!1,this._metaKey=!1,this._shiftKey=!1,this._buttonsPressed=0,this._pointerInput=r=>{var a,o;const l=r.event,h="touch"===l.pointerType;if(t.isInVRExclusivePointerMode)return;if(r.type!==S.kD.POINTERMOVE&&-1===this.buttons.indexOf(l.button))return;const c=l.target;if(this._altKey=l.altKey,this._ctrlKey=l.ctrlKey,this._metaKey=l.metaKey,this._shiftKey=l.shiftKey,this._buttonsPressed=l.buttons,t.isPointerLock){const e=l.movementX,t=l.movementY;this.onTouch(null,e,t),this._pointA=null,this._pointB=null}else{if(r.type!==S.kD.POINTERDOWN&&h&&(null===(a=this._pointA)||void 0===a?void 0:a.pointerId)!==l.pointerId&&(null===(o=this._pointB)||void 0===o?void 0:o.pointerId)!==l.pointerId)return;if(r.type!==S.kD.POINTERDOWN||-1!==this._currentActiveButton&&!h)if(r.type===S.kD.POINTERDOUBLETAP)this.onDoubleTap(l.pointerType);else if(r.type!==S.kD.POINTERUP||this._currentActiveButton!==l.button&&!h){if(r.type===S.kD.POINTERMOVE)if(e||l.preventDefault(),this._pointA&&null===this._pointB){const e=l.clientX-this._pointA.x,t=l.clientY-this._pointA.y;this.onTouch(this._pointA,e,t),this._pointA.x=l.clientX,this._pointA.y=l.clientY}else if(this._pointA&&this._pointB){const e=this._pointA.pointerId===l.pointerId?this._pointA:this._pointB;e.x=l.clientX,e.y=l.clientY;const t=this._pointA.x-this._pointB.x,i=this._pointA.y-this._pointB.y,a=t*t+i*i,o={x:(this._pointA.x+this._pointB.x)/2,y:(this._pointA.y+this._pointB.y)/2,pointerId:l.pointerId,type:r.type};this.onMultiTouch(this._pointA,this._pointB,s,a,n,o),n=o,s=a}}else{try{null==c||c.releasePointerCapture(l.pointerId)}catch(u){}h||(this._pointB=null),t._badOS?this._pointA=this._pointB=null:this._pointB&&this._pointA&&this._pointA.pointerId==l.pointerId?(this._pointA=this._pointB,this._pointB=null):this._pointA&&this._pointB&&this._pointB.pointerId==l.pointerId?this._pointB=null:this._pointA=this._pointB=null,(0!==s||n)&&(this.onMultiTouch(this._pointA,this._pointB,s,0,n,null),s=0,n=null),this._currentActiveButton=-1,this.onButtonUp(l),e||l.preventDefault()}else{try{null==c||c.setPointerCapture(l.pointerId)}catch(u){}if(null===this._pointA)this._pointA={x:l.clientX,y:l.clientY,pointerId:l.pointerId,type:l.pointerType};else{if(null!==this._pointB)return;this._pointB={x:l.clientX,y:l.clientY,pointerId:l.pointerId,type:l.pointerType}}-1!==this._currentActiveButton||h||(this._currentActiveButton=l.button),this.onButtonDown(l),e||(l.preventDefault(),i&&i.focus())}}},this._observer=this.camera.getScene()._inputManager._addCameraPointerObserver(this._pointerInput,S.kD.POINTERDOWN|S.kD.POINTERUP|S.kD.POINTERMOVE|S.kD.POINTERDOUBLETAP),this._onLostFocus=()=>{this._pointA=this._pointB=null,s=0,n=null,this.onLostFocus()},this._contextMenuBind=this.onContextMenu.bind(this),i&&i.addEventListener("contextmenu",this._contextMenuBind,!1);const r=this.camera.getScene().getEngine().getHostWindow();r&&G.w1.RegisterTopRootEvents(r,[{name:"blur",handler:this._onLostFocus}])}detachControl(){if(this._onLostFocus){const e=this.camera.getScene().getEngine().getHostWindow();e&&G.w1.UnregisterTopRootEvents(e,[{name:"blur",handler:this._onLostFocus}])}if(this._observer){if(this.camera.getScene()._inputManager._removeCameraPointerObserver(this._observer),this._observer=null,this._contextMenuBind){const e=this.camera.getScene().getEngine().getInputElement();e&&e.removeEventListener("contextmenu",this._contextMenuBind)}this._onLostFocus=null}this._altKey=!1,this._ctrlKey=!1,this._metaKey=!1,this._shiftKey=!1,this._buttonsPressed=0,this._currentActiveButton=-1}getClassName(){return"BaseCameraPointersInput"}getSimpleName(){return"pointers"}onDoubleTap(e){}onTouch(e,t,i){}onMultiTouch(e,t,i,s,n,r){}onContextMenu(e){e.preventDefault()}onButtonDown(e){}onButtonUp(e){}onLostFocus(){}}(0,y.gn)([(0,M.qC)()],W.prototype,"buttons",void 0);class z extends W{constructor(){super(...arguments),this.buttons=[0,1,2],this.angularSensibilityX=1e3,this.angularSensibilityY=1e3,this.pinchPrecision=12,this.pinchDeltaPercentage=0,this.useNaturalPinchZoom=!1,this.pinchZoom=!0,this.panningSensibility=1e3,this.multiTouchPanning=!0,this.multiTouchPanAndZoom=!0,this.pinchInwards=!0,this._isPanClick=!1,this._twoFingerActivityCount=0,this._isPinching=!1}getClassName(){return"ArcRotateCameraPointersInput"}_computeMultiTouchPanning(e,t){if(0!==this.panningSensibility&&e&&t){const i=t.x-e.x,s=t.y-e.y;this.camera.inertialPanningX+=-i/this.panningSensibility,this.camera.inertialPanningY+=s/this.panningSensibility}}_computePinchZoom(e,t){const i=this.camera.radius||z.MinimumRadiusForPinch;this.useNaturalPinchZoom?this.camera.radius=i*Math.sqrt(e)/Math.sqrt(t):this.pinchDeltaPercentage?this.camera.inertialRadiusOffset+=.001*(t-e)*i*this.pinchDeltaPercentage:this.camera.inertialRadiusOffset+=(t-e)/(this.pinchPrecision*(this.pinchInwards?1:-1)*(this.angularSensibilityX+this.angularSensibilityY)/2)}onTouch(e,t,i){0!==this.panningSensibility&&(this._ctrlKey&&this.camera._useCtrlForPanning||this._isPanClick)?(this.camera.inertialPanningX+=-t/this.panningSensibility,this.camera.inertialPanningY+=i/this.panningSensibility):(this.camera.inertialAlphaOffset-=t/this.angularSensibilityX,this.camera.inertialBetaOffset-=i/this.angularSensibilityY)}onDoubleTap(){this.camera.useInputToRestoreState&&this.camera.restoreState()}onMultiTouch(e,t,i,s,n,r){0===i&&null===n||0===s&&null===r||(this.multiTouchPanAndZoom?(this._computePinchZoom(i,s),this._computeMultiTouchPanning(n,r)):this.multiTouchPanning&&this.pinchZoom?(this._twoFingerActivityCount++,this._isPinching||this._twoFingerActivityCount<20&&Math.abs(Math.sqrt(s)-Math.sqrt(i))>this.camera.pinchToPanMaxDistance?(this._computePinchZoom(i,s),this._isPinching=!0):this._computeMultiTouchPanning(n,r)):this.multiTouchPanning?this._computeMultiTouchPanning(n,r):this.pinchZoom&&this._computePinchZoom(i,s))}onButtonDown(e){this._isPanClick=e.button===this.camera._panningMouseButton}onButtonUp(){this._twoFingerActivityCount=0,this._isPinching=!1}onLostFocus(){this._isPanClick=!1,this._twoFingerActivityCount=0,this._isPinching=!1}}z.MinimumRadiusForPinch=.001,(0,y.gn)([(0,M.qC)()],z.prototype,"buttons",void 0),(0,y.gn)([(0,M.qC)()],z.prototype,"angularSensibilityX",void 0),(0,y.gn)([(0,M.qC)()],z.prototype,"angularSensibilityY",void 0),(0,y.gn)([(0,M.qC)()],z.prototype,"pinchPrecision",void 0),(0,y.gn)([(0,M.qC)()],z.prototype,"pinchDeltaPercentage",void 0),(0,y.gn)([(0,M.qC)()],z.prototype,"useNaturalPinchZoom",void 0),(0,y.gn)([(0,M.qC)()],z.prototype,"pinchZoom",void 0),(0,y.gn)([(0,M.qC)()],z.prototype,"panningSensibility",void 0),(0,y.gn)([(0,M.qC)()],z.prototype,"multiTouchPanning",void 0),(0,y.gn)([(0,M.qC)()],z.prototype,"multiTouchPanAndZoom",void 0),k.ArcRotateCameraPointersInput=z;var H=i(3531);class X{constructor(){this.keysUp=[38],this.keysDown=[40],this.keysLeft=[37],this.keysRight=[39],this.keysReset=[220],this.panningSensibility=50,this.zoomingSensibility=25,this.useAltToZoom=!0,this.angularSpeed=.01,this._keys=new Array}attachControl(e){e=G.w1.BackCompatCameraNoPreventDefault(arguments),this._onCanvasBlurObserver||(this._scene=this.camera.getScene(),this._engine=this._scene.getEngine(),this._onCanvasBlurObserver=this._engine.onCanvasBlurObservable.add((()=>{this._keys.length=0})),this._onKeyboardObserver=this._scene.onKeyboardObservable.add((t=>{const i=t.event;if(!i.metaKey)if(t.type===H.OG.KEYDOWN){if(this._ctrlPressed=i.ctrlKey,this._altPressed=i.altKey,-1!==this.keysUp.indexOf(i.keyCode)||-1!==this.keysDown.indexOf(i.keyCode)||-1!==this.keysLeft.indexOf(i.keyCode)||-1!==this.keysRight.indexOf(i.keyCode)||-1!==this.keysReset.indexOf(i.keyCode)){-1===this._keys.indexOf(i.keyCode)&&this._keys.push(i.keyCode),i.preventDefault&&(e||i.preventDefault())}}else if(-1!==this.keysUp.indexOf(i.keyCode)||-1!==this.keysDown.indexOf(i.keyCode)||-1!==this.keysLeft.indexOf(i.keyCode)||-1!==this.keysRight.indexOf(i.keyCode)||-1!==this.keysReset.indexOf(i.keyCode)){const t=this._keys.indexOf(i.keyCode);t>=0&&this._keys.splice(t,1),i.preventDefault&&(e||i.preventDefault())}})))}detachControl(){this._scene&&(this._onKeyboardObserver&&this._scene.onKeyboardObservable.remove(this._onKeyboardObserver),this._onCanvasBlurObserver&&this._engine.onCanvasBlurObservable.remove(this._onCanvasBlurObserver),this._onKeyboardObserver=null,this._onCanvasBlurObserver=null),this._keys.length=0}checkInputs(){if(this._onKeyboardObserver){const e=this.camera;for(let t=0;t<this._keys.length;t++){const i=this._keys[t];-1!==this.keysLeft.indexOf(i)?this._ctrlPressed&&this.camera._useCtrlForPanning?e.inertialPanningX-=1/this.panningSensibility:e.inertialAlphaOffset-=this.angularSpeed:-1!==this.keysUp.indexOf(i)?this._ctrlPressed&&this.camera._useCtrlForPanning?e.inertialPanningY+=1/this.panningSensibility:this._altPressed&&this.useAltToZoom?e.inertialRadiusOffset+=1/this.zoomingSensibility:e.inertialBetaOffset-=this.angularSpeed:-1!==this.keysRight.indexOf(i)?this._ctrlPressed&&this.camera._useCtrlForPanning?e.inertialPanningX+=1/this.panningSensibility:e.inertialAlphaOffset+=this.angularSpeed:-1!==this.keysDown.indexOf(i)?this._ctrlPressed&&this.camera._useCtrlForPanning?e.inertialPanningY-=1/this.panningSensibility:this._altPressed&&this.useAltToZoom?e.inertialRadiusOffset-=1/this.zoomingSensibility:e.inertialBetaOffset+=this.angularSpeed:-1!==this.keysReset.indexOf(i)&&e.useInputToRestoreState&&e.restoreState()}}}getClassName(){return"ArcRotateCameraKeyboardMoveInput"}getSimpleName(){return"keyboard"}}(0,y.gn)([(0,M.qC)()],X.prototype,"keysUp",void 0),(0,y.gn)([(0,M.qC)()],X.prototype,"keysDown",void 0),(0,y.gn)([(0,M.qC)()],X.prototype,"keysLeft",void 0),(0,y.gn)([(0,M.qC)()],X.prototype,"keysRight",void 0),(0,y.gn)([(0,M.qC)()],X.prototype,"keysReset",void 0),(0,y.gn)([(0,M.qC)()],X.prototype,"panningSensibility",void 0),(0,y.gn)([(0,M.qC)()],X.prototype,"zoomingSensibility",void 0),(0,y.gn)([(0,M.qC)()],X.prototype,"useAltToZoom",void 0),(0,y.gn)([(0,M.qC)()],X.prototype,"angularSpeed",void 0),k.ArcRotateCameraKeyboardMoveInput=X;var j=i(1187);class Y{constructor(){this.wheelPrecision=3,this.zoomToMouseLocation=!1,this.wheelDeltaPercentage=0,this.customComputeDeltaFromMouseWheel=null,this._inertialPanning=u.P.Zero()}_computeDeltaFromMouseWheelLegacyEvent(e,t){let i=0;const s=.01*e*this.wheelDeltaPercentage*t;return i=e>0?s/(1+this.wheelDeltaPercentage):s*(1+this.wheelDeltaPercentage),i}attachControl(e){e=G.w1.BackCompatCameraNoPreventDefault(arguments),this._wheel=t=>{if(t.type!==S.kD.POINTERWHEEL)return;const i=t.event;let s=0;const n=i.deltaMode===j.G.DOM_DELTA_LINE?40:1,r=-i.deltaY*n;if(this.customComputeDeltaFromMouseWheel)s=this.customComputeDeltaFromMouseWheel(r,this,i);else if(this.wheelDeltaPercentage){if(s=this._computeDeltaFromMouseWheelLegacyEvent(r,this.camera.radius),s>0){let e=this.camera.radius,t=this.camera.inertialRadiusOffset+s;for(let i=0;i<20&&Math.abs(t)>.001;i++)e-=t,t*=this.camera.inertia;e=v.R.Clamp(e,0,Number.MAX_VALUE),s=this._computeDeltaFromMouseWheelLegacyEvent(r,e)}}else s=r/(40*this.wheelPrecision);s&&(this.zoomToMouseLocation&&this._hitPlane?this._zoomToMouse(s):this.camera.inertialRadiusOffset+=s),i.preventDefault&&(e||i.preventDefault())},this._observer=this.camera.getScene()._inputManager._addCameraPointerObserver(this._wheel,S.kD.POINTERWHEEL),this.zoomToMouseLocation&&this._inertialPanning.setAll(0)}detachControl(){this._observer&&(this.camera.getScene()._inputManager._removeCameraPointerObserver(this._observer),this._observer=null,this._wheel=null)}checkInputs(){if(!this.zoomToMouseLocation)return;const e=this.camera;0+e.inertialAlphaOffset+e.inertialBetaOffset+e.inertialRadiusOffset&&(this._updateHitPlane(),e.target.addInPlace(this._inertialPanning),this._inertialPanning.scaleInPlace(e.inertia),this._zeroIfClose(this._inertialPanning))}getClassName(){return"ArcRotateCameraMouseWheelInput"}getSimpleName(){return"mousewheel"}_updateHitPlane(){const e=this.camera,t=e.target.subtract(e.position);this._hitPlane=b.J.FromPositionAndNormal(e.target,t)}_getPosition(){var e;const t=this.camera,i=t.getScene(),s=i.createPickingRay(i.pointerX,i.pointerY,u.y3.Identity(),t,!1);let n=0;return this._hitPlane&&(n=null!==(e=s.intersectsPlane(this._hitPlane))&&void 0!==e?e:0),s.origin.addInPlace(s.direction.scaleInPlace(n))}_zoomToMouse(e){var t,i;const s=this.camera,n=1-s.inertia;if(s.lowerRadiusLimit){const i=null!==(t=s.lowerRadiusLimit)&&void 0!==t?t:0;s.radius-(s.inertialRadiusOffset+e)/n<i&&(e=(s.radius-i)*n-s.inertialRadiusOffset)}if(s.upperRadiusLimit){const t=null!==(i=s.upperRadiusLimit)&&void 0!==i?i:0;s.radius-(s.inertialRadiusOffset+e)/n>t&&(e=(s.radius-t)*n-s.inertialRadiusOffset)}const r=e/n/s.radius,a=this._getPosition(),o=u.jp.Vector3[6];a.subtractToRef(s.target,o),o.scaleInPlace(r),o.scaleInPlace(n),this._inertialPanning.addInPlace(o),s.inertialRadiusOffset+=e}_zeroIfClose(e){Math.abs(e.x)<_.kn&&(e.x=0),Math.abs(e.y)<_.kn&&(e.y=0),Math.abs(e.z)<_.kn&&(e.z=0)}}(0,y.gn)([(0,M.qC)()],Y.prototype,"wheelPrecision",void 0),(0,y.gn)([(0,M.qC)()],Y.prototype,"zoomToMouseLocation",void 0),(0,y.gn)([(0,M.qC)()],Y.prototype,"wheelDeltaPercentage",void 0),k.ArcRotateCameraMouseWheelInput=Y;class q extends V{constructor(e){super(e)}addMouseWheel(){return this.add(new Y),this}addPointers(){return this.add(new z),this}addKeyboard(){return this.add(new X),this}}A.N.AddNodeConstructor("ArcRotateCamera",((e,t)=>()=>new K(e,0,0,1,u.P.Zero(),t)));class K extends B{get target(){return this._target}set target(e){this.setTarget(e)}get targetHost(){return this._targetHost}set targetHost(e){e&&this.setTarget(e)}getTarget(){return this.target}get position(){return this._position}set position(e){this.setPosition(e)}set upVector(e){this._upToYMatrix||(this._yToUpMatrix=new u.y3,this._upToYMatrix=new u.y3,this._upVector=u.P.Zero()),e.normalize(),this._upVector.copyFrom(e),this.setMatUp()}get upVector(){return this._upVector}setMatUp(){u.y3.RotationAlignToRef(u.P.UpReadOnly,this._upVector,this._yToUpMatrix),u.y3.RotationAlignToRef(this._upVector,u.P.UpReadOnly,this._upToYMatrix)}get angularSensibilityX(){const e=this.inputs.attached.pointers;return e?e.angularSensibilityX:0}set angularSensibilityX(e){const t=this.inputs.attached.pointers;t&&(t.angularSensibilityX=e)}get angularSensibilityY(){const e=this.inputs.attached.pointers;return e?e.angularSensibilityY:0}set angularSensibilityY(e){const t=this.inputs.attached.pointers;t&&(t.angularSensibilityY=e)}get pinchPrecision(){const e=this.inputs.attached.pointers;return e?e.pinchPrecision:0}set pinchPrecision(e){const t=this.inputs.attached.pointers;t&&(t.pinchPrecision=e)}get pinchDeltaPercentage(){const e=this.inputs.attached.pointers;return e?e.pinchDeltaPercentage:0}set pinchDeltaPercentage(e){const t=this.inputs.attached.pointers;t&&(t.pinchDeltaPercentage=e)}get useNaturalPinchZoom(){const e=this.inputs.attached.pointers;return!!e&&e.useNaturalPinchZoom}set useNaturalPinchZoom(e){const t=this.inputs.attached.pointers;t&&(t.useNaturalPinchZoom=e)}get panningSensibility(){const e=this.inputs.attached.pointers;return e?e.panningSensibility:0}set panningSensibility(e){const t=this.inputs.attached.pointers;t&&(t.panningSensibility=e)}get keysUp(){const e=this.inputs.attached.keyboard;return e?e.keysUp:[]}set keysUp(e){const t=this.inputs.attached.keyboard;t&&(t.keysUp=e)}get keysDown(){const e=this.inputs.attached.keyboard;return e?e.keysDown:[]}set keysDown(e){const t=this.inputs.attached.keyboard;t&&(t.keysDown=e)}get keysLeft(){const e=this.inputs.attached.keyboard;return e?e.keysLeft:[]}set keysLeft(e){const t=this.inputs.attached.keyboard;t&&(t.keysLeft=e)}get keysRight(){const e=this.inputs.attached.keyboard;return e?e.keysRight:[]}set keysRight(e){const t=this.inputs.attached.keyboard;t&&(t.keysRight=e)}get wheelPrecision(){const e=this.inputs.attached.mousewheel;return e?e.wheelPrecision:0}set wheelPrecision(e){const t=this.inputs.attached.mousewheel;t&&(t.wheelPrecision=e)}get zoomToMouseLocation(){const e=this.inputs.attached.mousewheel;return!!e&&e.zoomToMouseLocation}set zoomToMouseLocation(e){const t=this.inputs.attached.mousewheel;t&&(t.zoomToMouseLocation=e)}get wheelDeltaPercentage(){const e=this.inputs.attached.mousewheel;return e?e.wheelDeltaPercentage:0}set wheelDeltaPercentage(e){const t=this.inputs.attached.mousewheel;t&&(t.wheelDeltaPercentage=e)}get bouncingBehavior(){return this._bouncingBehavior}get useBouncingBehavior(){return null!=this._bouncingBehavior}set useBouncingBehavior(e){e!==this.useBouncingBehavior&&(e?(this._bouncingBehavior=new w,this.addBehavior(this._bouncingBehavior)):this._bouncingBehavior&&(this.removeBehavior(this._bouncingBehavior),this._bouncingBehavior=null))}get framingBehavior(){return this._framingBehavior}get useFramingBehavior(){return null!=this._framingBehavior}set useFramingBehavior(e){e!==this.useFramingBehavior&&(e?(this._framingBehavior=new L,this.addBehavior(this._framingBehavior)):this._framingBehavior&&(this.removeBehavior(this._framingBehavior),this._framingBehavior=null))}get autoRotationBehavior(){return this._autoRotationBehavior}get useAutoRotationBehavior(){return null!=this._autoRotationBehavior}set useAutoRotationBehavior(e){e!==this.useAutoRotationBehavior&&(e?(this._autoRotationBehavior=new C,this.addBehavior(this._autoRotationBehavior)):this._autoRotationBehavior&&(this.removeBehavior(this._autoRotationBehavior),this._autoRotationBehavior=null))}constructor(e,t,i,s,n,r){var a;let o=!(arguments.length>6&&void 0!==arguments[6])||arguments[6];super(e,u.P.Zero(),r,o),a=this,this.inertialAlphaOffset=0,this.inertialBetaOffset=0,this.inertialRadiusOffset=0,this.lowerAlphaLimit=null,this.upperAlphaLimit=null,this.lowerBetaLimit=.01,this.upperBetaLimit=Math.PI-.01,this.lowerRadiusLimit=null,this.upperRadiusLimit=null,this.inertialPanningX=0,this.inertialPanningY=0,this.pinchToPanMaxDistance=20,this.panningDistanceLimit=null,this.panningOriginTarget=u.P.Zero(),this.panningInertia=.9,this.zoomOnFactor=1,this.targetScreenOffset=u.FM.Zero(),this.allowUpsideDown=!0,this.useInputToRestoreState=!0,this._viewMatrix=new u.y3,this.panningAxis=new u.P(1,1,0),this._transformedDirection=new u.P,this.mapPanning=!1,this.onMeshTargetChangedObservable=new T.y$,this.checkCollisions=!1,this.collisionRadius=new u.P(.5,.5,.5),this._previousPosition=u.P.Zero(),this._collisionVelocity=u.P.Zero(),this._newPosition=u.P.Zero(),this._computationVector=u.P.Zero(),this._onCollisionPositionChange=function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;i?(a.setPosition(t),a.onCollide&&a.onCollide(i)):a._previousPosition.copyFrom(a._position);const s=Math.cos(a.alpha),n=Math.sin(a.alpha),r=Math.cos(a.beta);let o=Math.sin(a.beta);0===o&&(o=1e-4);const l=a._getTargetPosition();a._computationVector.copyFromFloats(a.radius*s*o,a.radius*r,a.radius*n*o),l.addToRef(a._computationVector,a._newPosition),a._position.copyFrom(a._newPosition);let h=a.upVector;a.allowUpsideDown&&a.beta<0&&(h=h.clone(),h=h.negate()),a._computeViewMatrix(a._position,l,h),a._viewMatrix.addAtIndex(12,a.targetScreenOffset.x),a._viewMatrix.addAtIndex(13,a.targetScreenOffset.y),a._collisionTriggered=!1},this._target=u.P.Zero(),n&&this.setTarget(n),this.alpha=t,this.beta=i,this.radius=s,this.getViewMatrix(),this.inputs=new q(this),this.inputs.addKeyboard().addMouseWheel().addPointers()}_initCache(){super._initCache(),this._cache._target=new u.P(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),this._cache.alpha=void 0,this._cache.beta=void 0,this._cache.radius=void 0,this._cache.targetScreenOffset=u.FM.Zero()}_updateCache(e){e||super._updateCache(),this._cache._target.copyFrom(this._getTargetPosition()),this._cache.alpha=this.alpha,this._cache.beta=this.beta,this._cache.radius=this.radius,this._cache.targetScreenOffset.copyFrom(this.targetScreenOffset)}_getTargetPosition(){if(this._targetHost&&this._targetHost.getAbsolutePosition){const e=this._targetHost.getAbsolutePosition();this._targetBoundingCenter?e.addToRef(this._targetBoundingCenter,this._target):this._target.copyFrom(e)}const e=this._getLockedTargetPosition();return e||this._target}storeState(){return this._storedAlpha=this.alpha,this._storedBeta=this.beta,this._storedRadius=this.radius,this._storedTarget=this._getTargetPosition().clone(),this._storedTargetScreenOffset=this.targetScreenOffset.clone(),super.storeState()}_restoreStateValues(){return!!super._restoreStateValues()&&(this.setTarget(this._storedTarget.clone()),this.alpha=this._storedAlpha,this.beta=this._storedBeta,this.radius=this._storedRadius,this.targetScreenOffset=this._storedTargetScreenOffset.clone(),this.inertialAlphaOffset=0,this.inertialBetaOffset=0,this.inertialRadiusOffset=0,this.inertialPanningX=0,this.inertialPanningY=0,!0)}_isSynchronizedViewMatrix(){return!!super._isSynchronizedViewMatrix()&&(this._cache._target.equals(this._getTargetPosition())&&this._cache.alpha===this.alpha&&this._cache.beta===this.beta&&this._cache.radius===this.radius&&this._cache.targetScreenOffset.equals(this.targetScreenOffset))}attachControl(e,t){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2;const n=arguments;t=G.w1.BackCompatCameraNoPreventDefault(n),this._useCtrlForPanning=i,this._panningMouseButton=s,"boolean"==typeof n[0]&&(n.length>1&&(this._useCtrlForPanning=n[1]),n.length>2&&(this._panningMouseButton=n[2])),this.inputs.attachElement(t),this._reset=()=>{this.inertialAlphaOffset=0,this.inertialBetaOffset=0,this.inertialRadiusOffset=0,this.inertialPanningX=0,this.inertialPanningY=0}}detachControl(){this.inputs.detachElement(),this._reset&&this._reset()}_checkInputs(){if(!this._collisionTriggered){if(this.inputs.checkInputs(),0!==this.inertialAlphaOffset||0!==this.inertialBetaOffset||0!==this.inertialRadiusOffset){const e=this.invertRotation?-1:1;let t=this.inertialAlphaOffset;this.beta<=0&&(t*=-1),this.getScene().useRightHandedSystem&&(t*=-1),this.parent&&this.parent._getWorldMatrixDeterminant()<0&&(t*=-1),this.alpha+=t*e,this.beta+=this.inertialBetaOffset*e,this.radius-=this.inertialRadiusOffset,this.inertialAlphaOffset*=this.inertia,this.inertialBetaOffset*=this.inertia,this.inertialRadiusOffset*=this.inertia,Math.abs(this.inertialAlphaOffset)<_.kn&&(this.inertialAlphaOffset=0),Math.abs(this.inertialBetaOffset)<_.kn&&(this.inertialBetaOffset=0),Math.abs(this.inertialRadiusOffset)<this.speed*_.kn&&(this.inertialRadiusOffset=0)}if(0!==this.inertialPanningX||0!==this.inertialPanningY){const e=new u.P(this.inertialPanningX,this.inertialPanningY,this.inertialPanningY);if(this._viewMatrix.invertToRef(this._cameraTransformMatrix),e.multiplyInPlace(this.panningAxis),u.P.TransformNormalToRef(e,this._cameraTransformMatrix,this._transformedDirection),!this.mapPanning&&this.panningAxis.y||(this._transformedDirection.y=0),!this._targetHost)if(this.panningDistanceLimit){this._transformedDirection.addInPlace(this._target);u.P.DistanceSquared(this._transformedDirection,this.panningOriginTarget)<=this.panningDistanceLimit*this.panningDistanceLimit&&this._target.copyFrom(this._transformedDirection)}else this._target.addInPlace(this._transformedDirection);this.inertialPanningX*=this.panningInertia,this.inertialPanningY*=this.panningInertia,Math.abs(this.inertialPanningX)<this.speed*_.kn&&(this.inertialPanningX=0),Math.abs(this.inertialPanningY)<this.speed*_.kn&&(this.inertialPanningY=0)}this._checkLimits(),super._checkInputs()}}_checkLimits(){null===this.lowerBetaLimit||void 0===this.lowerBetaLimit?this.allowUpsideDown&&this.beta>Math.PI&&(this.beta=this.beta-2*Math.PI):this.beta<this.lowerBetaLimit&&(this.beta=this.lowerBetaLimit),null===this.upperBetaLimit||void 0===this.upperBetaLimit?this.allowUpsideDown&&this.beta<-Math.PI&&(this.beta=this.beta+2*Math.PI):this.beta>this.upperBetaLimit&&(this.beta=this.upperBetaLimit),null!==this.lowerAlphaLimit&&this.alpha<this.lowerAlphaLimit&&(this.alpha=this.lowerAlphaLimit),null!==this.upperAlphaLimit&&this.alpha>this.upperAlphaLimit&&(this.alpha=this.upperAlphaLimit),null!==this.lowerRadiusLimit&&this.radius<this.lowerRadiusLimit&&(this.radius=this.lowerRadiusLimit,this.inertialRadiusOffset=0),null!==this.upperRadiusLimit&&this.radius>this.upperRadiusLimit&&(this.radius=this.upperRadiusLimit,this.inertialRadiusOffset=0)}rebuildAnglesAndRadius(){this._position.subtractToRef(this._getTargetPosition(),this._computationVector),0===this._upVector.x&&1===this._upVector.y&&0===this._upVector.z||u.P.TransformCoordinatesToRef(this._computationVector,this._upToYMatrix,this._computationVector),this.radius=this._computationVector.length(),0===this.radius&&(this.radius=1e-4);const e=this.alpha;0===this._computationVector.x&&0===this._computationVector.z?this.alpha=Math.PI/2:this.alpha=Math.acos(this._computationVector.x/Math.sqrt(Math.pow(this._computationVector.x,2)+Math.pow(this._computationVector.z,2))),this._computationVector.z<0&&(this.alpha=2*Math.PI-this.alpha);const t=Math.round((e-this.alpha)/(2*Math.PI));this.alpha+=2*t*Math.PI,this.beta=Math.acos(this._computationVector.y/this.radius),this._checkLimits()}setPosition(e){this._position.equals(e)||(this._position.copyFrom(e),this.rebuildAnglesAndRadius())}setTarget(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=arguments.length>3&&void 0!==arguments[3]&&arguments[3];var n;if(s=null!==(n=this.overrideCloneAlphaBetaRadius)&&void 0!==n?n:s,e.getBoundingInfo)this._targetBoundingCenter=t?e.getBoundingInfo().boundingBox.centerWorld.clone():null,e.computeWorldMatrix(),this._targetHost=e,this._target=this._getTargetPosition(),this.onMeshTargetChangedObservable.notifyObservers(this._targetHost);else{const t=e,s=this._getTargetPosition();if(s&&!i&&s.equals(t))return;this._targetHost=null,this._target=t,this._targetBoundingCenter=null,this.onMeshTargetChangedObservable.notifyObservers(null)}s||this.rebuildAnglesAndRadius()}_getViewMatrix(){const e=Math.cos(this.alpha),t=Math.sin(this.alpha),i=Math.cos(this.beta);let s=Math.sin(this.beta);0===s&&(s=1e-4),0===this.radius&&(this.radius=1e-4);const n=this._getTargetPosition();if(this._computationVector.copyFromFloats(this.radius*e*s,this.radius*i,this.radius*t*s),0===this._upVector.x&&1===this._upVector.y&&0===this._upVector.z||u.P.TransformCoordinatesToRef(this._computationVector,this._yToUpMatrix,this._computationVector),n.addToRef(this._computationVector,this._newPosition),this.getScene().collisionsEnabled&&this.checkCollisions){const e=this.getScene().collisionCoordinator;this._collider||(this._collider=e.createCollider()),this._collider._radius=this.collisionRadius,this._newPosition.subtractToRef(this._position,this._collisionVelocity),this._collisionTriggered=!0,e.getNewPosition(this._position,this._collisionVelocity,this._collider,3,null,this._onCollisionPositionChange,this.uniqueId)}else{this._position.copyFrom(this._newPosition);let e=this.upVector;this.allowUpsideDown&&s<0&&(e=e.negate()),this._computeViewMatrix(this._position,n,e),this._viewMatrix.addAtIndex(12,this.targetScreenOffset.x),this._viewMatrix.addAtIndex(13,this.targetScreenOffset.y)}return this._currentTarget=n,this._viewMatrix}zoomOn(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e=e||this.getScene().meshes;const i=a.Kj.MinMax(e),s=u.P.Distance(i.min,i.max);this.radius=s*this.zoomOnFactor,this.focusOn({min:i.min,max:i.max,distance:s},t)}focusOn(e){let t,i,s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(void 0===e.min){const s=e||this.getScene().meshes;t=a.Kj.MinMax(s),i=u.P.Distance(t.min,t.max)}else{t=e,i=e.distance}this._target=a.Kj.Center(t),s||(this.maxZ=2*i)}createRigCamera(e,t){let i=0;switch(this.cameraRigMode){case F.V.RIG_MODE_STEREOSCOPIC_ANAGLYPH:case F.V.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL:case F.V.RIG_MODE_STEREOSCOPIC_OVERUNDER:case F.V.RIG_MODE_STEREOSCOPIC_INTERLACED:case F.V.RIG_MODE_VR:i=this._cameraRigParams.stereoHalfAngle*(0===t?1:-1);break;case F.V.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED:i=this._cameraRigParams.stereoHalfAngle*(0===t?-1:1)}const s=new K(e,this.alpha+i,this.beta,this.radius,this._target,this.getScene());return s._cameraRigParams={},s.isRigCamera=!0,s.rigParent=this,s.upVector=this.upVector,s.mode=this.mode,s.orthoLeft=this.orthoLeft,s.orthoRight=this.orthoRight,s.orthoBottom=this.orthoBottom,s.orthoTop=this.orthoTop,s}_updateRigCameras(){const e=this._rigCameras[0],t=this._rigCameras[1];switch(e.beta=t.beta=this.beta,this.cameraRigMode){case F.V.RIG_MODE_STEREOSCOPIC_ANAGLYPH:case F.V.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL:case F.V.RIG_MODE_STEREOSCOPIC_OVERUNDER:case F.V.RIG_MODE_STEREOSCOPIC_INTERLACED:case F.V.RIG_MODE_VR:e.alpha=this.alpha-this._cameraRigParams.stereoHalfAngle,t.alpha=this.alpha+this._cameraRigParams.stereoHalfAngle;break;case F.V.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED:e.alpha=this.alpha+this._cameraRigParams.stereoHalfAngle,t.alpha=this.alpha-this._cameraRigParams.stereoHalfAngle}super._updateRigCameras()}dispose(){this.inputs.clear(),super.dispose()}getClassName(){return"ArcRotateCamera"}}(0,y.gn)([(0,M.qC)()],K.prototype,"alpha",void 0),(0,y.gn)([(0,M.qC)()],K.prototype,"beta",void 0),(0,y.gn)([(0,M.qC)()],K.prototype,"radius",void 0),(0,y.gn)([(0,M.qC)()],K.prototype,"overrideCloneAlphaBetaRadius",void 0),(0,y.gn)([(0,M.hd)("target")],K.prototype,"_target",void 0),(0,y.gn)([(0,M.RR)("targetHost")],K.prototype,"_targetHost",void 0),(0,y.gn)([(0,M.qC)()],K.prototype,"inertialAlphaOffset",void 0),(0,y.gn)([(0,M.qC)()],K.prototype,"inertialBetaOffset",void 0),(0,y.gn)([(0,M.qC)()],K.prototype,"inertialRadiusOffset",void 0),(0,y.gn)([(0,M.qC)()],K.prototype,"lowerAlphaLimit",void 0),(0,y.gn)([(0,M.qC)()],K.prototype,"upperAlphaLimit",void 0),(0,y.gn)([(0,M.qC)()],K.prototype,"lowerBetaLimit",void 0),(0,y.gn)([(0,M.qC)()],K.prototype,"upperBetaLimit",void 0),(0,y.gn)([(0,M.qC)()],K.prototype,"lowerRadiusLimit",void 0),(0,y.gn)([(0,M.qC)()],K.prototype,"upperRadiusLimit",void 0),(0,y.gn)([(0,M.qC)()],K.prototype,"inertialPanningX",void 0),(0,y.gn)([(0,M.qC)()],K.prototype,"inertialPanningY",void 0),(0,y.gn)([(0,M.qC)()],K.prototype,"pinchToPanMaxDistance",void 0),(0,y.gn)([(0,M.qC)()],K.prototype,"panningDistanceLimit",void 0),(0,y.gn)([(0,M.hd)()],K.prototype,"panningOriginTarget",void 0),(0,y.gn)([(0,M.qC)()],K.prototype,"panningInertia",void 0),(0,y.gn)([(0,M.qC)()],K.prototype,"zoomToMouseLocation",null),(0,y.gn)([(0,M.qC)()],K.prototype,"zoomOnFactor",void 0),(0,y.gn)([(0,M.QC)()],K.prototype,"targetScreenOffset",void 0),(0,y.gn)([(0,M.qC)()],K.prototype,"allowUpsideDown",void 0),(0,y.gn)([(0,M.qC)()],K.prototype,"useInputToRestoreState",void 0);var Q=i(5934),Z=i(2845);class ${constructor(){this.previousWorldMatrices={},this.previousBones={}}static AddUniforms(e){e.push("previousWorld","previousViewProjection","mPreviousBones")}static AddSamplers(e){}bindForSubMesh(e,t,i,s,n){if(t.prePassRenderer&&t.prePassRenderer.enabled&&t.prePassRenderer.currentRTisSceneRT&&-1!==t.prePassRenderer.getIndex(2)){this.previousWorldMatrices[i.uniqueId]||(this.previousWorldMatrices[i.uniqueId]=s.clone()),this.previousViewProjection||(this.previousViewProjection=t.getTransformMatrix().clone(),this.currentViewProjection=t.getTransformMatrix().clone());const n=t.getEngine();this.currentViewProjection.updateFlag!==t.getTransformMatrix().updateFlag?(this._lastUpdateFrameId=n.frameId,this.previousViewProjection.copyFrom(this.currentViewProjection),this.currentViewProjection.copyFrom(t.getTransformMatrix())):this._lastUpdateFrameId!==n.frameId&&(this._lastUpdateFrameId=n.frameId,this.previousViewProjection.copyFrom(this.currentViewProjection)),e.setMatrix("previousWorld",this.previousWorldMatrices[i.uniqueId]),e.setMatrix("previousViewProjection",this.previousViewProjection),this.previousWorldMatrices[i.uniqueId]=s.clone()}}}var J=i(7823),ee=i(6556),te=i(4071),ie=i(4771);class se extends ee.F{constructor(e,t){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];super(e,t),this._normalMatrix=new u.y3,this._storeEffectOnSubMeshes=i}getEffect(){return this._storeEffectOnSubMeshes?this._activeEffect:super.getEffect()}isReady(e,t){return!!e&&(!this._storeEffectOnSubMeshes||(!e.subMeshes||0===e.subMeshes.length||this.isReadyForSubMesh(e,e.subMeshes[0],t)))}_isReadyForSubMesh(e){const t=e.materialDefines;return!(this.checkReadyOnEveryCall||!e.effect||!t||t._renderId!==this.getScene().getRenderId())}bindOnlyWorldMatrix(e){this._activeEffect.setMatrix("world",e)}bindOnlyNormalMatrix(e){this._activeEffect.setMatrix("normalMatrix",e)}bind(e,t){t&&this.bindForSubMesh(e,t,t.subMeshes[0])}_afterBind(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super._afterBind(e,t),this.getScene()._cachedEffect=t,t&&(t._forceRebindOnNextCall=!1)}_mustRebind(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return e.isCachedMaterialInvalid(this,t,i)}dispose(e,t,i){this._activeEffect=void 0,super.dispose(e,t,i)}}var ne=i(2655),re=i(4198),ae=i(9950);i(562);class oe{get wrapU(){return this._wrapU}set wrapU(e){this._wrapU=e}get wrapV(){return this._wrapV}set wrapV(e){this._wrapV=e}get coordinatesMode(){return 0}get isCube(){return!!this._texture&&this._texture.isCube}set isCube(e){this._texture&&(this._texture.isCube=e)}get is3D(){return!!this._texture&&this._texture.is3D}set is3D(e){this._texture&&(this._texture.is3D=e)}get is2DArray(){return!!this._texture&&this._texture.is2DArray}set is2DArray(e){this._texture&&(this._texture.is2DArray=e)}getClassName(){return"ThinTexture"}static _IsRenderTargetWrapper(e){return void 0!==(null==e?void 0:e._shareDepth)}constructor(e){this._wrapU=1,this._wrapV=1,this.wrapR=1,this.anisotropicFilteringLevel=4,this.delayLoadState=0,this._texture=null,this._engine=null,this._cachedSize=E.Zero(),this._cachedBaseSize=E.Zero(),this._initialSamplingMode=2,this._texture=oe._IsRenderTargetWrapper(e)?e.texture:e,this._texture&&(this._engine=this._texture.getEngine())}isReady(){return 4===this.delayLoadState?(this.delayLoad(),!1):!!this._texture&&this._texture.isReady}delayLoad(){}getInternalTexture(){return this._texture}getSize(){if(this._texture){if(this._texture.width)return this._cachedSize.width=this._texture.width,this._cachedSize.height=this._texture.height,this._cachedSize;if(this._texture._size)return this._cachedSize.width=this._texture._size,this._cachedSize.height=this._texture._size,this._cachedSize}return this._cachedSize}getBaseSize(){return this.isReady()&&this._texture?this._texture._size?(this._cachedBaseSize.width=this._texture._size,this._cachedBaseSize.height=this._texture._size,this._cachedBaseSize):(this._cachedBaseSize.width=this._texture.baseWidth,this._cachedBaseSize.height=this._texture.baseHeight,this._cachedBaseSize):(this._cachedBaseSize.width=0,this._cachedBaseSize.height=0,this._cachedBaseSize)}get samplingMode(){return this._texture?this._texture.samplingMode:this._initialSamplingMode}updateSamplingMode(e){this._texture&&this._engine&&this._engine.updateTextureSamplingMode(e,this._texture)}releaseInternalTexture(){this._texture&&(this._texture.dispose(),this._texture=null)}dispose(){this._texture&&(this.releaseInternalTexture(),this._engine=null)}}class le extends oe{set hasAlpha(e){this._hasAlpha!==e&&(this._hasAlpha=e,this._scene&&this._scene.markAllMaterialsAsDirty(1,(e=>e.hasTexture(this))))}get hasAlpha(){return this._hasAlpha}set getAlphaFromRGB(e){this._getAlphaFromRGB!==e&&(this._getAlphaFromRGB=e,this._scene&&this._scene.markAllMaterialsAsDirty(1,(e=>e.hasTexture(this))))}get getAlphaFromRGB(){return this._getAlphaFromRGB}set coordinatesIndex(e){this._coordinatesIndex!==e&&(this._coordinatesIndex=e,this._scene&&this._scene.markAllMaterialsAsDirty(1,(e=>e.hasTexture(this))))}get coordinatesIndex(){return this._coordinatesIndex}set coordinatesMode(e){this._coordinatesMode!==e&&(this._coordinatesMode=e,this._scene&&this._scene.markAllMaterialsAsDirty(1,(e=>e.hasTexture(this))))}get coordinatesMode(){return this._coordinatesMode}get wrapU(){return this._wrapU}set wrapU(e){this._wrapU=e}get wrapV(){return this._wrapV}set wrapV(e){this._wrapV=e}get isCube(){return this._texture?this._texture.isCube:this._isCube}set isCube(e){this._texture?this._texture.isCube=e:this._isCube=e}get is3D(){return!!this._texture&&this._texture.is3D}set is3D(e){this._texture&&(this._texture.is3D=e)}get is2DArray(){return!!this._texture&&this._texture.is2DArray}set is2DArray(e){this._texture&&(this._texture.is2DArray=e)}get gammaSpace(){return this._texture?(null===this._texture._gammaSpace&&(this._texture._gammaSpace=this._gammaSpace),this._texture._gammaSpace&&!this._texture._useSRGBBuffer):this._gammaSpace}set gammaSpace(e){if(this._texture){if(this._texture._gammaSpace===e)return;this._texture._gammaSpace=e}else{if(this._gammaSpace===e)return;this._gammaSpace=e}this._markAllSubMeshesAsTexturesDirty()}get isRGBD(){return null!=this._texture&&this._texture._isRGBD}set isRGBD(e){this._texture&&(this._texture._isRGBD=e)}get noMipmap(){return!1}get lodGenerationOffset(){return this._texture?this._texture._lodGenerationOffset:0}set lodGenerationOffset(e){this._texture&&(this._texture._lodGenerationOffset=e)}get lodGenerationScale(){return this._texture?this._texture._lodGenerationScale:0}set lodGenerationScale(e){this._texture&&(this._texture._lodGenerationScale=e)}get linearSpecularLOD(){return!!this._texture&&this._texture._linearSpecularLOD}set linearSpecularLOD(e){this._texture&&(this._texture._linearSpecularLOD=e)}get irradianceTexture(){return this._texture?this._texture._irradianceTexture:null}set irradianceTexture(e){this._texture&&(this._texture._irradianceTexture=e)}get uid(){return this._uid||(this._uid=(0,ae.f)()),this._uid}toString(){return this.name}getClassName(){return"BaseTexture"}set onDispose(e){this._onDisposeObserver&&this.onDisposeObservable.remove(this._onDisposeObserver),this._onDisposeObserver=this.onDisposeObservable.add(e)}get isBlocking(){return!0}get loadingError(){return this._loadingError}get errorObject(){return this._errorObject}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(null),this.metadata=null,this.reservedDataStore=null,this._hasAlpha=!1,this._getAlphaFromRGB=!1,this.level=1,this._coordinatesIndex=0,this.optimizeUVAllocation=!0,this._coordinatesMode=0,this.wrapR=1,this.anisotropicFilteringLevel=le.DEFAULT_ANISOTROPIC_FILTERING_LEVEL,this._isCube=!1,this._gammaSpace=!0,this.invertZ=!1,this.lodLevelInAlpha=!1,this.isRenderTarget=!1,this._prefiltered=!1,this._forceSerialize=!1,this.animations=new Array,this.onDisposeObservable=new T.y$,this._onDisposeObserver=null,this._scene=null,this._uid=null,this._parentContainer=null,this._loadingError=!1,e?le._IsScene(e)?this._scene=e:this._engine=e:this._scene=re.l.LastCreatedScene,this._scene&&(this.uniqueId=this._scene.getUniqueId(),this._scene.addTexture(this),this._engine=this._scene.getEngine()),this._texture=t,this._uid=null}getScene(){return this._scene}_getEngine(){return this._engine}checkTransformsAreIdentical(e){return null!==e}getTextureMatrix(){return u.y3.IdentityReadOnly}getReflectionTextureMatrix(){return u.y3.IdentityReadOnly}isReadyOrNotBlocking(){return!this.isBlocking||this.isReady()||this.loadingError}scale(e){}get canRescale(){return!1}_getFromCache(e,t,i,s,n,r){const a=this._getEngine();if(!a)return null;const o=a._getUseSRGBBuffer(!!n,t),l=a.getLoadedTexturesCache();for(let h=0;h<l.length;h++){const a=l[h];if(!(void 0!==n&&o!==a._useSRGBBuffer||void 0!==s&&s!==a.invertY||a.url!==e||a.generateMipMaps!==!t||i&&i!==a.samplingMode||void 0!==r&&r!==a.isCube))return a.incrementReferences(),a}return null}_rebuild(){}clone(){return null}get textureType(){return this._texture&&void 0!==this._texture.type?this._texture.type:0}get textureFormat(){return this._texture&&void 0!==this._texture.format?this._texture.format:5}_markAllSubMeshesAsTexturesDirty(){const e=this.getScene();e&&e.markAllMaterialsAsDirty(1)}readPixels(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],n=arguments.length>4&&void 0!==arguments[4]&&arguments[4],r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:Number.MAX_VALUE,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:Number.MAX_VALUE;if(!this._texture)return null;const h=this._getEngine();if(!h)return null;const c=this.getSize();let u=c.width,d=c.height;0!==t&&(u/=Math.pow(2,t),d/=Math.pow(2,t),u=Math.round(u),d=Math.round(d)),o=Math.min(u,o),l=Math.min(d,l);try{return this._texture.isCube?h._readTexturePixels(this._texture,o,l,e,t,i,s,n,r,a):h._readTexturePixels(this._texture,o,l,-1,t,i,s,n,r,a)}catch(f){return null}}_readPixelsSync(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],n=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!this._texture)return null;const r=this.getSize();let a=r.width,o=r.height;const l=this._getEngine();if(!l)return null;0!=t&&(a/=Math.pow(2,t),o/=Math.pow(2,t),a=Math.round(a),o=Math.round(o));try{return this._texture.isCube?l._readTexturePixelsSync(this._texture,a,o,e,t,i,s,n):l._readTexturePixelsSync(this._texture,a,o,-1,t,i,s,n)}catch(h){return null}}get _lodTextureHigh(){return this._texture?this._texture._lodTextureHigh:null}get _lodTextureMid(){return this._texture?this._texture._lodTextureMid:null}get _lodTextureLow(){return this._texture?this._texture._lodTextureLow:null}dispose(){if(this._scene){this._scene.stopAnimation&&this._scene.stopAnimation(this),this._scene.removePendingData(this);const e=this._scene.textures.indexOf(this);if(e>=0&&this._scene.textures.splice(e,1),this._scene.onTextureRemovedObservable.notifyObservers(this),this._scene=null,this._parentContainer){const e=this._parentContainer.textures.indexOf(this);e>-1&&this._parentContainer.textures.splice(e,1),this._parentContainer=null}}this.onDisposeObservable.notifyObservers(this),this.onDisposeObservable.clear(),this.metadata=null,super.dispose()}serialize(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.name&&!e)return null;const t=M.p4.Serialize(this);return M.p4.AppendSerializedAnimations(this,t),t}static WhenAllReady(e,t){let i=e.length;if(0!==i)for(let s=0;s<e.length;s++){const n=e[s];if(n.isReady())0==--i&&t();else{const e=n.onLoadObservable;e?e.addOnce((()=>{0==--i&&t()})):0==--i&&t()}}else t()}static _IsScene(e){return"Scene"===e.getClassName()}}le.DEFAULT_ANISOTROPIC_FILTERING_LEVEL=4,(0,y.gn)([(0,M.qC)()],le.prototype,"uniqueId",void 0),(0,y.gn)([(0,M.qC)()],le.prototype,"name",void 0),(0,y.gn)([(0,M.qC)()],le.prototype,"metadata",void 0),(0,y.gn)([(0,M.qC)("hasAlpha")],le.prototype,"_hasAlpha",void 0),(0,y.gn)([(0,M.qC)("getAlphaFromRGB")],le.prototype,"_getAlphaFromRGB",void 0),(0,y.gn)([(0,M.qC)()],le.prototype,"level",void 0),(0,y.gn)([(0,M.qC)("coordinatesIndex")],le.prototype,"_coordinatesIndex",void 0),(0,y.gn)([(0,M.qC)()],le.prototype,"optimizeUVAllocation",void 0),(0,y.gn)([(0,M.qC)("coordinatesMode")],le.prototype,"_coordinatesMode",void 0),(0,y.gn)([(0,M.qC)()],le.prototype,"wrapU",null),(0,y.gn)([(0,M.qC)()],le.prototype,"wrapV",null),(0,y.gn)([(0,M.qC)()],le.prototype,"wrapR",void 0),(0,y.gn)([(0,M.qC)()],le.prototype,"anisotropicFilteringLevel",void 0),(0,y.gn)([(0,M.qC)()],le.prototype,"isCube",null),(0,y.gn)([(0,M.qC)()],le.prototype,"is3D",null),(0,y.gn)([(0,M.qC)()],le.prototype,"is2DArray",null),(0,y.gn)([(0,M.qC)()],le.prototype,"gammaSpace",null),(0,y.gn)([(0,M.qC)()],le.prototype,"invertZ",void 0),(0,y.gn)([(0,M.qC)()],le.prototype,"lodLevelInAlpha",void 0),(0,y.gn)([(0,M.qC)()],le.prototype,"lodGenerationOffset",null),(0,y.gn)([(0,M.qC)()],le.prototype,"lodGenerationScale",null),(0,y.gn)([(0,M.qC)()],le.prototype,"linearSpecularLOD",null),(0,y.gn)([(0,M.oU)()],le.prototype,"irradianceTexture",null),(0,y.gn)([(0,M.qC)()],le.prototype,"isRenderTarget",void 0);var he=i(5230),ce=i(8370),ue=i(8797),de=i(2399);function fe(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const s=t.width,n=t.height;if(e instanceof Float32Array){let t=e.byteLength/e.BYTES_PER_ELEMENT;const i=new Uint8Array(t);for(;--t>=0;){let s=e[t];s<0?s=0:s>1&&(s=1),i[t]=255*s}e=i}const r=document.createElement("canvas");r.width=s,r.height=n;const a=r.getContext("2d");if(!a)return null;const o=a.createImageData(s,n);if(o.data.set(e),a.putImageData(o,0,0),i){const e=document.createElement("canvas");e.width=s,e.height=n;const t=e.getContext("2d");return t?(t.translate(0,n),t.scale(1,-1),t.drawImage(r,0,0),e.toDataURL("image/png")):null}return r.toDataURL("image/png")}function pe(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const s=e.getInternalTexture();if(!s)return null;const n=e._readPixelsSync(t,i);return n?fe(n,e.getSize(),s.invertY):null}async function ge(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const s=e.getInternalTexture();if(!s)return null;const n=await e.readPixels(t,i);return n?fe(n,e.getSize(),s.invertY):null}class me extends le{get noMipmap(){return this._noMipmap}get mimeType(){return this._mimeType}set isBlocking(e){this._isBlocking=e}get isBlocking(){return this._isBlocking}get invertY(){return this._invertY}constructor(e,t,i,s){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:me.TRILINEAR_SAMPLINGMODE,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,h=arguments.length>8&&void 0!==arguments[8]&&arguments[8],c=arguments.length>9?arguments[9]:void 0,u=arguments.length>10?arguments[10]:void 0,d=arguments.length>11?arguments[11]:void 0,f=arguments.length>12?arguments[12]:void 0,p=arguments.length>13?arguments[13]:void 0;var g,m,_,v,b,E,y,M,A;let S;super(t),this.url=null,this.uOffset=0,this.vOffset=0,this.uScale=1,this.vScale=1,this.uAng=0,this.vAng=0,this.wAng=0,this.uRotationCenter=.5,this.vRotationCenter=.5,this.wRotationCenter=.5,this.homogeneousRotationInUVTransform=!1,this.inspectableCustomProperties=null,this._noMipmap=!1,this._invertY=!1,this._rowGenerationMatrix=null,this._cachedTextureMatrix=null,this._projectionModeMatrix=null,this._t0=null,this._t1=null,this._t2=null,this._cachedUOffset=-1,this._cachedVOffset=-1,this._cachedUScale=0,this._cachedVScale=0,this._cachedUAng=-1,this._cachedVAng=-1,this._cachedWAng=-1,this._cachedReflectionProjectionMatrixId=-1,this._cachedURotationCenter=-1,this._cachedVRotationCenter=-1,this._cachedWRotationCenter=-1,this._cachedHomogeneousRotationInUVTransform=!1,this._cachedReflectionTextureMatrix=null,this._cachedReflectionUOffset=-1,this._cachedReflectionVOffset=-1,this._cachedReflectionUScale=0,this._cachedReflectionVScale=0,this._cachedReflectionCoordinatesMode=-1,this._buffer=null,this._deleteBuffer=!1,this._format=null,this._delayedOnLoad=null,this._delayedOnError=null,this.onLoadObservable=new T.y$,this._isBlocking=!0,this.name=e||"",this.url=e;let I=!1,C=null;"object"==typeof i&&null!==i?(S=null!==(g=i.noMipmap)&&void 0!==g&&g,s=null!==(m=i.invertY)&&void 0!==m?m:!l.e.UseOpenGLOrientationForUV,n=null!==(_=i.samplingMode)&&void 0!==_?_:me.TRILINEAR_SAMPLINGMODE,r=null!==(v=i.onLoad)&&void 0!==v?v:null,a=null!==(b=i.onError)&&void 0!==b?b:null,o=null!==(E=i.buffer)&&void 0!==E?E:null,h=null!==(y=i.deleteBuffer)&&void 0!==y&&y,c=i.format,u=i.mimeType,d=i.loaderOptions,f=i.creationFlags,I=null!==(M=i.useSRGBBuffer)&&void 0!==M&&M,C=null!==(A=i.internalTexture)&&void 0!==A?A:null):S=!!i,this._noMipmap=S,this._invertY=void 0===s?!l.e.UseOpenGLOrientationForUV:s,this._initialSamplingMode=n,this._buffer=o,this._deleteBuffer=h,this._mimeType=u,this._loaderOptions=d,this._creationFlags=f,this._useSRGBBuffer=I,this._forcedExtension=p,c&&(this._format=c);const D=this.getScene(),P=this._getEngine();if(!P)return;P.onBeforeTextureInitObservable.notifyObservers(this);const x=()=>{this._texture&&(this._texture._invertVScale&&(this.vScale*=-1,this.vOffset+=1),null!==this._texture._cachedWrapU&&(this.wrapU=this._texture._cachedWrapU,this._texture._cachedWrapU=null),null!==this._texture._cachedWrapV&&(this.wrapV=this._texture._cachedWrapV,this._texture._cachedWrapV=null),null!==this._texture._cachedWrapR&&(this.wrapR=this._texture._cachedWrapR,this._texture._cachedWrapR=null)),this.onLoadObservable.hasObservers()&&this.onLoadObservable.notifyObservers(this),r&&r(),!this.isBlocking&&D&&D.resetCachedMaterial()},R=(e,t)=>{this._loadingError=!0,this._errorObject={message:e,exception:t},a&&a(e,t),me.OnTextureLoadErrorObservable.notifyObservers(this)};if(!this.url&&!C)return this._delayedOnLoad=x,void(this._delayedOnError=R);if(this._texture=null!=C?C:this._getFromCache(this.url,S,n,this._invertY,I),this._texture)if(this._texture.isReady)ce.Q.SetImmediate((()=>x()));else{const e=this._texture.onLoadedObservable.add(x);this._texture.onErrorObservable.add((t=>{var i;R(t.message,t.exception),null===(i=this._texture)||void 0===i||i.onLoadedObservable.remove(e)}))}else if(D&&D.useDelayedTextureLoading)this.delayLoadState=4,this._delayedOnLoad=x,this._delayedOnError=R;else{try{this._texture=P.createTexture(this.url,S,this._invertY,D,n,x,R,this._buffer,void 0,this._format,this._forcedExtension,u,d,f,I)}catch(O){throw R("error loading",O),O}h&&(this._buffer=null)}}updateURL(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;this.url&&(this.releaseInternalTexture(),this.getScene().markAllMaterialsAsDirty(1)),this.name&&!this.name.startsWith("data:")||(this.name=e),this.url=e,this._buffer=t,this._forcedExtension=s,this.delayLoadState=4,i&&(this._delayedOnLoad=i),this.delayLoad()}delayLoad(){if(4!==this.delayLoadState)return;const e=this.getScene();e&&(this.delayLoadState=1,this._texture=this._getFromCache(this.url,this._noMipmap,this.samplingMode,this._invertY,this._useSRGBBuffer),this._texture?this._delayedOnLoad&&(this._texture.isReady?ce.Q.SetImmediate(this._delayedOnLoad):this._texture.onLoadedObservable.add(this._delayedOnLoad)):(this._texture=e.getEngine().createTexture(this.url,this._noMipmap,this._invertY,e,this.samplingMode,this._delayedOnLoad,this._delayedOnError,this._buffer,null,this._format,this._forcedExtension,this._mimeType,this._loaderOptions,this._creationFlags,this._useSRGBBuffer),this._deleteBuffer&&(this._buffer=null)),this._delayedOnLoad=null,this._delayedOnError=null)}_prepareRowForTextureGeneration(e,t,i,s){e*=this._cachedUScale,t*=this._cachedVScale,e-=this.uRotationCenter*this._cachedUScale,t-=this.vRotationCenter*this._cachedVScale,i-=this.wRotationCenter,u.P.TransformCoordinatesFromFloatsToRef(e,t,i,this._rowGenerationMatrix,s),s.x+=this.uRotationCenter*this._cachedUScale+this._cachedUOffset,s.y+=this.vRotationCenter*this._cachedVScale+this._cachedVOffset,s.z+=this.wRotationCenter}checkTransformsAreIdentical(e){return null!==e&&this.uOffset===e.uOffset&&this.vOffset===e.vOffset&&this.uScale===e.uScale&&this.vScale===e.vScale&&this.uAng===e.uAng&&this.vAng===e.vAng&&this.wAng===e.wAng}getTextureMatrix(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;if(this.uOffset===this._cachedUOffset&&this.vOffset===this._cachedVOffset&&this.uScale*e===this._cachedUScale&&this.vScale===this._cachedVScale&&this.uAng===this._cachedUAng&&this.vAng===this._cachedVAng&&this.wAng===this._cachedWAng&&this.uRotationCenter===this._cachedURotationCenter&&this.vRotationCenter===this._cachedVRotationCenter&&this.wRotationCenter===this._cachedWRotationCenter&&this.homogeneousRotationInUVTransform===this._cachedHomogeneousRotationInUVTransform)return this._cachedTextureMatrix;this._cachedUOffset=this.uOffset,this._cachedVOffset=this.vOffset,this._cachedUScale=this.uScale*e,this._cachedVScale=this.vScale,this._cachedUAng=this.uAng,this._cachedVAng=this.vAng,this._cachedWAng=this.wAng,this._cachedURotationCenter=this.uRotationCenter,this._cachedVRotationCenter=this.vRotationCenter,this._cachedWRotationCenter=this.wRotationCenter,this._cachedHomogeneousRotationInUVTransform=this.homogeneousRotationInUVTransform,this._cachedTextureMatrix&&this._rowGenerationMatrix||(this._cachedTextureMatrix=u.y3.Zero(),this._rowGenerationMatrix=new u.y3,this._t0=u.P.Zero(),this._t1=u.P.Zero(),this._t2=u.P.Zero()),u.y3.RotationYawPitchRollToRef(this.vAng,this.uAng,this.wAng,this._rowGenerationMatrix),this.homogeneousRotationInUVTransform?(u.y3.TranslationToRef(-this._cachedURotationCenter,-this._cachedVRotationCenter,-this._cachedWRotationCenter,u.jp.Matrix[0]),u.y3.TranslationToRef(this._cachedURotationCenter,this._cachedVRotationCenter,this._cachedWRotationCenter,u.jp.Matrix[1]),u.y3.ScalingToRef(this._cachedUScale,this._cachedVScale,0,u.jp.Matrix[2]),u.y3.TranslationToRef(this._cachedUOffset,this._cachedVOffset,0,u.jp.Matrix[3]),u.jp.Matrix[0].multiplyToRef(this._rowGenerationMatrix,this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(u.jp.Matrix[1],this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(u.jp.Matrix[2],this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(u.jp.Matrix[3],this._cachedTextureMatrix),this._cachedTextureMatrix.setRowFromFloats(2,this._cachedTextureMatrix.m[12],this._cachedTextureMatrix.m[13],this._cachedTextureMatrix.m[14],1)):(this._prepareRowForTextureGeneration(0,0,0,this._t0),this._prepareRowForTextureGeneration(1,0,0,this._t1),this._prepareRowForTextureGeneration(0,1,0,this._t2),this._t1.subtractInPlace(this._t0),this._t2.subtractInPlace(this._t0),u.y3.FromValuesToRef(this._t1.x,this._t1.y,this._t1.z,0,this._t2.x,this._t2.y,this._t2.z,0,this._t0.x,this._t0.y,this._t0.z,0,0,0,0,1,this._cachedTextureMatrix));const t=this.getScene();return t?(this.optimizeUVAllocation&&t.markAllMaterialsAsDirty(1,(e=>e.hasTexture(this))),this._cachedTextureMatrix):this._cachedTextureMatrix}getReflectionTextureMatrix(){const e=this.getScene();if(!e)return this._cachedReflectionTextureMatrix;if(this.uOffset===this._cachedReflectionUOffset&&this.vOffset===this._cachedReflectionVOffset&&this.uScale===this._cachedReflectionUScale&&this.vScale===this._cachedReflectionVScale&&this.coordinatesMode===this._cachedReflectionCoordinatesMode){if(this.coordinatesMode!==me.PROJECTION_MODE)return this._cachedReflectionTextureMatrix;if(this._cachedReflectionProjectionMatrixId===e.getProjectionMatrix().updateFlag)return this._cachedReflectionTextureMatrix}this._cachedReflectionTextureMatrix||(this._cachedReflectionTextureMatrix=u.y3.Zero()),this._projectionModeMatrix||(this._projectionModeMatrix=u.y3.Zero());const t=this._cachedReflectionCoordinatesMode!==this.coordinatesMode;switch(this._cachedReflectionUOffset=this.uOffset,this._cachedReflectionVOffset=this.vOffset,this._cachedReflectionUScale=this.uScale,this._cachedReflectionVScale=this.vScale,this._cachedReflectionCoordinatesMode=this.coordinatesMode,this.coordinatesMode){case me.PLANAR_MODE:u.y3.IdentityToRef(this._cachedReflectionTextureMatrix),this._cachedReflectionTextureMatrix[0]=this.uScale,this._cachedReflectionTextureMatrix[5]=this.vScale,this._cachedReflectionTextureMatrix[12]=this.uOffset,this._cachedReflectionTextureMatrix[13]=this.vOffset;break;case me.PROJECTION_MODE:{u.y3.FromValuesToRef(.5,0,0,0,0,-.5,0,0,0,0,0,0,.5,.5,1,1,this._projectionModeMatrix);const t=e.getProjectionMatrix();this._cachedReflectionProjectionMatrixId=t.updateFlag,t.multiplyToRef(this._projectionModeMatrix,this._cachedReflectionTextureMatrix);break}default:u.y3.IdentityToRef(this._cachedReflectionTextureMatrix)}return t&&e.markAllMaterialsAsDirty(1,(e=>-1!==e.getActiveTextures().indexOf(this))),this._cachedReflectionTextureMatrix}clone(){const e={noMipmap:this._noMipmap,invertY:this._invertY,samplingMode:this.samplingMode,onLoad:void 0,onError:void 0,buffer:this._texture?this._texture._buffer:void 0,deleteBuffer:this._deleteBuffer,format:this.textureFormat,mimeType:this.mimeType,loaderOptions:this._loaderOptions,creationFlags:this._creationFlags,useSRGBBuffer:this._useSRGBBuffer};return M.p4.Clone((()=>new me(this._texture?this._texture.url:null,this.getScene(),e)),this)}serialize(){var e,t;const i=this.name;me.SerializeBuffers||this.name.startsWith("data:")&&(this.name=""),this.name.startsWith("data:")&&this.url===this.name&&(this.url="");const s=super.serialize(me._SerializeInternalTextureUniqueId);return s?((me.SerializeBuffers||me.ForceSerializeBuffers)&&("string"==typeof this._buffer&&"data:"===this._buffer.substr(0,5)?(s.base64String=this._buffer,s.name=s.name.replace("data:","")):this.url&&this.url.startsWith("data:")&&this._buffer instanceof Uint8Array?s.base64String="data:image/png;base64,"+(0,de.Gh)(this._buffer):(me.ForceSerializeBuffers||this.url&&this.url.startsWith("blob:")||this._forceSerialize)&&(s.base64String=!this._engine||this._engine._features.supportSyncTextureRead?pe(this):ge(this))),s.invertY=this._invertY,s.samplingMode=this.samplingMode,s._creationFlags=this._creationFlags,s._useSRGBBuffer=this._useSRGBBuffer,me._SerializeInternalTextureUniqueId&&(s.internalTextureUniqueId=null!==(t=null===(e=this._texture)||void 0===e?void 0:e.uniqueId)&&void 0!==t?t:void 0),this.name=i,s):null}getClassName(){return"Texture"}dispose(){super.dispose(),this.onLoadObservable.clear(),this._delayedOnLoad=null,this._delayedOnError=null,this._buffer=null}static Parse(e,t,i){if(e.customType){const s=ue.K.Instantiate(e.customType).Parse(e,t,i);return e.samplingMode&&s.updateSamplingMode&&s._samplingMode&&s._samplingMode!==e.samplingMode&&s.updateSamplingMode(e.samplingMode),s}if(e.isCube&&!e.isRenderTarget)return me._CubeTextureParser(e,t,i);const s=void 0!==e.internalTextureUniqueId;if(!e.name&&!e.isRenderTarget&&!s)return null;let n;if(s){const i=t.getEngine().getLoadedTexturesCache();for(const t of i)if(t.uniqueId===e.internalTextureUniqueId){n=t;break}}const r=t=>{var i;if(t&&t._texture&&(t._texture._cachedWrapU=null,t._texture._cachedWrapV=null,t._texture._cachedWrapR=null),e.samplingMode){const i=e.samplingMode;t&&t.samplingMode!==i&&t.updateSamplingMode(i)}if(t&&e.animations)for(let s=0;s<e.animations.length;s++){const i=e.animations[s],n=(0,x.q)("BABYLON.Animation");n&&t.animations.push(n.Parse(i))}s&&!n&&(null===(i=null==t?void 0:t._texture)||void 0===i||i._setUniqueId(e.internalTextureUniqueId))};return M.p4.Parse((()=>{var s,a,o;let l=!0;if(e.noMipmap&&(l=!1),e.mirrorPlane){const i=me._CreateMirror(e.name,e.renderTargetSize,t,l);return i._waitingRenderList=e.renderList,i.mirrorPlane=b.J.FromArray(e.mirrorPlane),r(i),i}if(e.isRenderTarget){let i=null;if(e.isCube){if(t.reflectionProbes)for(let s=0;s<t.reflectionProbes.length;s++){const i=t.reflectionProbes[s];if(i.name===e.name)return i.cubeTexture}}else i=me._CreateRenderTargetTexture(e.name,e.renderTargetSize,t,l,null!==(s=e._creationFlags)&&void 0!==s?s:0),i._waitingRenderList=e.renderList;return r(i),i}{let s;if(e.base64String&&!n)s=me.CreateFromBase64String(e.base64String,e.base64String,t,!l,e.invertY,e.samplingMode,(()=>{r(s)}),null!==(a=e._creationFlags)&&void 0!==a?a:0,null!==(o=e._useSRGBBuffer)&&void 0!==o&&o),s.name=e.name;else{let a;a=e.name&&e.name.indexOf("://")>0?e.name:i+e.name,e.url&&(e.url.startsWith("data:")||me.UseSerializedUrlIfAny)&&(a=e.url);const o={noMipmap:!l,invertY:e.invertY,samplingMode:e.samplingMode,onLoad:()=>{r(s)},internalTexture:n};s=new me(a,t,o)}return s}}),e,t)}static CreateFromBase64String(e,t,i,s,n){let r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:me.TRILINEAR_SAMPLINGMODE;return new me("data:"+t,i,s,n,r,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,e,!1,arguments.length>8&&void 0!==arguments[8]?arguments[8]:5,void 0,void 0,arguments.length>9?arguments[9]:void 0)}static LoadFromDataString(e,t,i){let s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],n=arguments.length>4?arguments[4]:void 0,r=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:me.TRILINEAR_SAMPLINGMODE,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,h=arguments.length>9&&void 0!==arguments[9]?arguments[9]:5,c=arguments.length>10?arguments[10]:void 0;return"data:"!==e.substr(0,5)&&(e="data:"+e),new me(e,i,n,r,a,o,l,t,s,h,void 0,void 0,c)}}me.SerializeBuffers=!0,me.ForceSerializeBuffers=!1,me.OnTextureLoadErrorObservable=new T.y$,me._SerializeInternalTextureUniqueId=!1,me._CubeTextureParser=(e,t,i)=>{throw(0,he.S)("CubeTexture")},me._CreateMirror=(e,t,i,s)=>{throw(0,he.S)("MirrorTexture")},me._CreateRenderTargetTexture=(e,t,i,s,n)=>{throw(0,he.S)("RenderTargetTexture")},me.NEAREST_SAMPLINGMODE=1,me.NEAREST_NEAREST_MIPLINEAR=8,me.BILINEAR_SAMPLINGMODE=2,me.LINEAR_LINEAR_MIPNEAREST=11,me.TRILINEAR_SAMPLINGMODE=3,me.LINEAR_LINEAR_MIPLINEAR=3,me.NEAREST_NEAREST_MIPNEAREST=4,me.NEAREST_LINEAR_MIPNEAREST=5,me.NEAREST_LINEAR_MIPLINEAR=6,me.NEAREST_LINEAR=7,me.NEAREST_NEAREST=1,me.LINEAR_NEAREST_MIPNEAREST=9,me.LINEAR_NEAREST_MIPLINEAR=10,me.LINEAR_LINEAR=2,me.LINEAR_NEAREST=12,me.EXPLICIT_MODE=0,me.SPHERICAL_MODE=1,me.PLANAR_MODE=2,me.CUBIC_MODE=3,me.PROJECTION_MODE=4,me.SKYBOX_MODE=5,me.INVCUBIC_MODE=6,me.EQUIRECTANGULAR_MODE=7,me.FIXED_EQUIRECTANGULAR_MODE=8,me.FIXED_EQUIRECTANGULAR_MIRRORED_MODE=9,me.CLAMP_ADDRESSMODE=0,me.WRAP_ADDRESSMODE=1,me.MIRROR_ADDRESSMODE=2,me.UseSerializedUrlIfAny=!1,(0,y.gn)([(0,M.qC)()],me.prototype,"url",void 0),(0,y.gn)([(0,M.qC)()],me.prototype,"uOffset",void 0),(0,y.gn)([(0,M.qC)()],me.prototype,"vOffset",void 0),(0,y.gn)([(0,M.qC)()],me.prototype,"uScale",void 0),(0,y.gn)([(0,M.qC)()],me.prototype,"vScale",void 0),(0,y.gn)([(0,M.qC)()],me.prototype,"uAng",void 0),(0,y.gn)([(0,M.qC)()],me.prototype,"vAng",void 0),(0,y.gn)([(0,M.qC)()],me.prototype,"wAng",void 0),(0,y.gn)([(0,M.qC)()],me.prototype,"uRotationCenter",void 0),(0,y.gn)([(0,M.qC)()],me.prototype,"vRotationCenter",void 0),(0,y.gn)([(0,M.qC)()],me.prototype,"wRotationCenter",void 0),(0,y.gn)([(0,M.qC)()],me.prototype,"homogeneousRotationInUVTransform",void 0),(0,y.gn)([(0,M.qC)()],me.prototype,"isBlocking",null),(0,x.H)("BABYLON.Texture",me),M.p4._TextureParser=me.Parse;class _e{static get DiffuseTextureEnabled(){return this._DiffuseTextureEnabled}static set DiffuseTextureEnabled(e){this._DiffuseTextureEnabled!==e&&(this._DiffuseTextureEnabled=e,n.D.MarkAllMaterialsAsDirty(1))}static get DetailTextureEnabled(){return this._DetailTextureEnabled}static set DetailTextureEnabled(e){this._DetailTextureEnabled!==e&&(this._DetailTextureEnabled=e,n.D.MarkAllMaterialsAsDirty(1))}static get DecalMapEnabled(){return this._DecalMapEnabled}static set DecalMapEnabled(e){this._DecalMapEnabled!==e&&(this._DecalMapEnabled=e,n.D.MarkAllMaterialsAsDirty(1))}static get AmbientTextureEnabled(){return this._AmbientTextureEnabled}static set AmbientTextureEnabled(e){this._AmbientTextureEnabled!==e&&(this._AmbientTextureEnabled=e,n.D.MarkAllMaterialsAsDirty(1))}static get OpacityTextureEnabled(){return this._OpacityTextureEnabled}static set OpacityTextureEnabled(e){this._OpacityTextureEnabled!==e&&(this._OpacityTextureEnabled=e,n.D.MarkAllMaterialsAsDirty(1))}static get ReflectionTextureEnabled(){return this._ReflectionTextureEnabled}static set ReflectionTextureEnabled(e){this._ReflectionTextureEnabled!==e&&(this._ReflectionTextureEnabled=e,n.D.MarkAllMaterialsAsDirty(1))}static get EmissiveTextureEnabled(){return this._EmissiveTextureEnabled}static set EmissiveTextureEnabled(e){this._EmissiveTextureEnabled!==e&&(this._EmissiveTextureEnabled=e,n.D.MarkAllMaterialsAsDirty(1))}static get SpecularTextureEnabled(){return this._SpecularTextureEnabled}static set SpecularTextureEnabled(e){this._SpecularTextureEnabled!==e&&(this._SpecularTextureEnabled=e,n.D.MarkAllMaterialsAsDirty(1))}static get BumpTextureEnabled(){return this._BumpTextureEnabled}static set BumpTextureEnabled(e){this._BumpTextureEnabled!==e&&(this._BumpTextureEnabled=e,n.D.MarkAllMaterialsAsDirty(1))}static get LightmapTextureEnabled(){return this._LightmapTextureEnabled}static set LightmapTextureEnabled(e){this._LightmapTextureEnabled!==e&&(this._LightmapTextureEnabled=e,n.D.MarkAllMaterialsAsDirty(1))}static get RefractionTextureEnabled(){return this._RefractionTextureEnabled}static set RefractionTextureEnabled(e){this._RefractionTextureEnabled!==e&&(this._RefractionTextureEnabled=e,n.D.MarkAllMaterialsAsDirty(1))}static get ColorGradingTextureEnabled(){return this._ColorGradingTextureEnabled}static set ColorGradingTextureEnabled(e){this._ColorGradingTextureEnabled!==e&&(this._ColorGradingTextureEnabled=e,n.D.MarkAllMaterialsAsDirty(1))}static get FresnelEnabled(){return this._FresnelEnabled}static set FresnelEnabled(e){this._FresnelEnabled!==e&&(this._FresnelEnabled=e,n.D.MarkAllMaterialsAsDirty(4))}static get ClearCoatTextureEnabled(){return this._ClearCoatTextureEnabled}static set ClearCoatTextureEnabled(e){this._ClearCoatTextureEnabled!==e&&(this._ClearCoatTextureEnabled=e,n.D.MarkAllMaterialsAsDirty(1))}static get ClearCoatBumpTextureEnabled(){return this._ClearCoatBumpTextureEnabled}static set ClearCoatBumpTextureEnabled(e){this._ClearCoatBumpTextureEnabled!==e&&(this._ClearCoatBumpTextureEnabled=e,n.D.MarkAllMaterialsAsDirty(1))}static get ClearCoatTintTextureEnabled(){return this._ClearCoatTintTextureEnabled}static set ClearCoatTintTextureEnabled(e){this._ClearCoatTintTextureEnabled!==e&&(this._ClearCoatTintTextureEnabled=e,n.D.MarkAllMaterialsAsDirty(1))}static get SheenTextureEnabled(){return this._SheenTextureEnabled}static set SheenTextureEnabled(e){this._SheenTextureEnabled!==e&&(this._SheenTextureEnabled=e,n.D.MarkAllMaterialsAsDirty(1))}static get AnisotropicTextureEnabled(){return this._AnisotropicTextureEnabled}static set AnisotropicTextureEnabled(e){this._AnisotropicTextureEnabled!==e&&(this._AnisotropicTextureEnabled=e,n.D.MarkAllMaterialsAsDirty(1))}static get ThicknessTextureEnabled(){return this._ThicknessTextureEnabled}static set ThicknessTextureEnabled(e){this._ThicknessTextureEnabled!==e&&(this._ThicknessTextureEnabled=e,n.D.MarkAllMaterialsAsDirty(1))}static get RefractionIntensityTextureEnabled(){return this._ThicknessTextureEnabled}static set RefractionIntensityTextureEnabled(e){this._RefractionIntensityTextureEnabled!==e&&(this._RefractionIntensityTextureEnabled=e,n.D.MarkAllMaterialsAsDirty(1))}static get TranslucencyIntensityTextureEnabled(){return this._ThicknessTextureEnabled}static set TranslucencyIntensityTextureEnabled(e){this._TranslucencyIntensityTextureEnabled!==e&&(this._TranslucencyIntensityTextureEnabled=e,n.D.MarkAllMaterialsAsDirty(1))}static get IridescenceTextureEnabled(){return this._IridescenceTextureEnabled}static set IridescenceTextureEnabled(e){this._IridescenceTextureEnabled!==e&&(this._IridescenceTextureEnabled=e,n.D.MarkAllMaterialsAsDirty(1))}}_e._DiffuseTextureEnabled=!0,_e._DetailTextureEnabled=!0,_e._DecalMapEnabled=!0,_e._AmbientTextureEnabled=!0,_e._OpacityTextureEnabled=!0,_e._ReflectionTextureEnabled=!0,_e._EmissiveTextureEnabled=!0,_e._SpecularTextureEnabled=!0,_e._BumpTextureEnabled=!0,_e._LightmapTextureEnabled=!0,_e._RefractionTextureEnabled=!0,_e._ColorGradingTextureEnabled=!0,_e._FresnelEnabled=!0,_e._ClearCoatTextureEnabled=!0,_e._ClearCoatBumpTextureEnabled=!0,_e._ClearCoatTintTextureEnabled=!0,_e._SheenTextureEnabled=!0,_e._AnisotropicTextureEnabled=!0,_e._ThicknessTextureEnabled=!0,_e._RefractionIntensityTextureEnabled=!0,_e._TranslucencyIntensityTextureEnabled=!0,_e._IridescenceTextureEnabled=!0;var ve=i(8084);const be="decalFragmentDeclaration",Ee="#ifdef DECAL\nuniform vec4 vDecalInfos;\n#endif\n";ve.v.IncludesShadersStore[be]=Ee;const ye="defaultFragmentDeclaration",Me="uniform vec4 vEyePosition;\nuniform vec4 vDiffuseColor;\n#ifdef SPECULARTERM\nuniform vec4 vSpecularColor;\n#endif\nuniform vec3 vEmissiveColor;\nuniform vec3 vAmbientColor;\nuniform float visibility;\n#ifdef DIFFUSE\nuniform vec2 vDiffuseInfos;\n#endif\n#ifdef AMBIENT\nuniform vec2 vAmbientInfos;\n#endif\n#ifdef OPACITY \nuniform vec2 vOpacityInfos;\n#endif\n#ifdef EMISSIVE\nuniform vec2 vEmissiveInfos;\n#endif\n#ifdef LIGHTMAP\nuniform vec2 vLightmapInfos;\n#endif\n#ifdef BUMP\nuniform vec3 vBumpInfos;\nuniform vec2 vTangentSpaceParams;\n#endif\n#ifdef ALPHATEST\nuniform float alphaCutOff;\n#endif\n#if defined(REFLECTIONMAP_SPHERICAL) || defined(REFLECTIONMAP_PROJECTION) || defined(REFRACTION) || defined(PREPASS)\nuniform mat4 view;\n#endif\n#ifdef REFRACTION\nuniform vec4 vRefractionInfos;\n#ifndef REFRACTIONMAP_3D\nuniform mat4 refractionMatrix;\n#endif\n#ifdef REFRACTIONFRESNEL\nuniform vec4 refractionLeftColor;\nuniform vec4 refractionRightColor;\n#endif\n#if defined(USE_LOCAL_REFRACTIONMAP_CUBIC) && defined(REFRACTIONMAP_3D)\nuniform vec3 vRefractionPosition;\nuniform vec3 vRefractionSize; \n#endif\n#endif\n#if defined(SPECULAR) && defined(SPECULARTERM)\nuniform vec2 vSpecularInfos;\n#endif\n#ifdef DIFFUSEFRESNEL\nuniform vec4 diffuseLeftColor;\nuniform vec4 diffuseRightColor;\n#endif\n#ifdef OPACITYFRESNEL\nuniform vec4 opacityParts;\n#endif\n#ifdef EMISSIVEFRESNEL\nuniform vec4 emissiveLeftColor;\nuniform vec4 emissiveRightColor;\n#endif\n#ifdef REFLECTION\nuniform vec2 vReflectionInfos;\n#if defined(REFLECTIONMAP_PLANAR) || defined(REFLECTIONMAP_CUBIC) || defined(REFLECTIONMAP_PROJECTION) || defined(REFLECTIONMAP_EQUIRECTANGULAR) || defined(REFLECTIONMAP_SPHERICAL) || defined(REFLECTIONMAP_SKYBOX)\nuniform mat4 reflectionMatrix;\n#endif\n#ifndef REFLECTIONMAP_SKYBOX\n#if defined(USE_LOCAL_REFLECTIONMAP_CUBIC) && defined(REFLECTIONMAP_CUBIC)\nuniform vec3 vReflectionPosition;\nuniform vec3 vReflectionSize; \n#endif\n#endif\n#ifdef REFLECTIONFRESNEL\nuniform vec4 reflectionLeftColor;\nuniform vec4 reflectionRightColor;\n#endif\n#endif\n#ifdef DETAIL\nuniform vec4 vDetailInfos;\n#endif\n#include<decalFragmentDeclaration>\n#define ADDITIONAL_FRAGMENT_DECLARATION\n";ve.v.IncludesShadersStore[ye]=Me;const Te="sceneUboDeclaration",Ae="layout(std140,column_major) uniform;\nuniform Scene {\nmat4 viewProjection;\n#ifdef MULTIVIEW\nmat4 viewProjectionR;\n#endif \nmat4 view;\nmat4 projection;\nvec4 vEyePosition;\n};\n";ve.v.IncludesShadersStore[Te]=Ae;const Se="meshUboDeclaration",Ie="#ifdef WEBGL2\nuniform mat4 world;\nuniform float visibility;\n#else\nlayout(std140,column_major) uniform;\nuniform Mesh\n{\nmat4 world;\nfloat visibility;\n};\n#endif\n#define WORLD_UBO\n";ve.v.IncludesShadersStore[Se]=Ie;const Ce="defaultUboDeclaration",De="layout(std140,column_major) uniform;\nuniform Material\n{\nvec4 diffuseLeftColor;\nvec4 diffuseRightColor;\nvec4 opacityParts;\nvec4 reflectionLeftColor;\nvec4 reflectionRightColor;\nvec4 refractionLeftColor;\nvec4 refractionRightColor;\nvec4 emissiveLeftColor;\nvec4 emissiveRightColor;\nvec2 vDiffuseInfos;\nvec2 vAmbientInfos;\nvec2 vOpacityInfos;\nvec2 vReflectionInfos;\nvec3 vReflectionPosition;\nvec3 vReflectionSize;\nvec2 vEmissiveInfos;\nvec2 vLightmapInfos;\nvec2 vSpecularInfos;\nvec3 vBumpInfos;\nmat4 diffuseMatrix;\nmat4 ambientMatrix;\nmat4 opacityMatrix;\nmat4 reflectionMatrix;\nmat4 emissiveMatrix;\nmat4 lightmapMatrix;\nmat4 specularMatrix;\nmat4 bumpMatrix;\nvec2 vTangentSpaceParams;\nfloat pointSize;\nfloat alphaCutOff;\nmat4 refractionMatrix;\nvec4 vRefractionInfos;\nvec3 vRefractionPosition;\nvec3 vRefractionSize;\nvec4 vSpecularColor;\nvec3 vEmissiveColor;\nvec4 vDiffuseColor;\nvec3 vAmbientColor;\n#define ADDITIONAL_UBO_DECLARATION\n};\n#include<sceneUboDeclaration>\n#include<meshUboDeclaration>\n";ve.v.IncludesShadersStore[Ce]=De;const Pe="prePassDeclaration",xe="#ifdef PREPASS\n#extension GL_EXT_draw_buffers : require\nlayout(location=0) out highp vec4 glFragData[{X}];highp vec4 gl_FragColor;\n#ifdef PREPASS_DEPTH\nvarying highp vec3 vViewPos;\n#endif\n#ifdef PREPASS_VELOCITY\nvarying highp vec4 vCurrentPosition;varying highp vec4 vPreviousPosition;\n#endif\n#endif\n";ve.v.IncludesShadersStore[Pe]=xe;const Re="oitDeclaration",Oe="#ifdef ORDER_INDEPENDENT_TRANSPARENCY\n#extension GL_EXT_draw_buffers : require\nlayout(location=0) out vec2 depth; \nlayout(location=1) out vec4 frontColor;\nlayout(location=2) out vec4 backColor;\n#define MAX_DEPTH 99999.0\nhighp vec4 gl_FragColor;\nuniform sampler2D oitDepthSampler;\nuniform sampler2D oitFrontColorSampler;\n#endif\n";ve.v.IncludesShadersStore[Re]=Oe;const Ne="mainUVVaryingDeclaration",we="#ifdef MAINUV{X}\nvarying vec2 vMainUV{X};\n#endif\n";ve.v.IncludesShadersStore[Ne]=we;const Le="helperFunctions",Fe="const float PI=3.1415926535897932384626433832795;\nconst float HALF_MIN=5.96046448e-08; \nconst float LinearEncodePowerApprox=2.2;\nconst float GammaEncodePowerApprox=1.0/LinearEncodePowerApprox;\nconst vec3 LuminanceEncodeApprox=vec3(0.2126,0.7152,0.0722);\nconst float Epsilon=0.0000001;\n#define saturate(x) clamp(x,0.0,1.0)\n#define absEps(x) abs(x)+Epsilon\n#define maxEps(x) max(x,Epsilon)\n#define saturateEps(x) clamp(x,Epsilon,1.0)\nmat3 transposeMat3(mat3 inMatrix) {\nvec3 i0=inMatrix[0];\nvec3 i1=inMatrix[1];\nvec3 i2=inMatrix[2];\nmat3 outMatrix=mat3(\nvec3(i0.x,i1.x,i2.x),\nvec3(i0.y,i1.y,i2.y),\nvec3(i0.z,i1.z,i2.z)\n);\nreturn outMatrix;\n}\nmat3 inverseMat3(mat3 inMatrix) {\nfloat a00=inMatrix[0][0],a01=inMatrix[0][1],a02=inMatrix[0][2];\nfloat a10=inMatrix[1][0],a11=inMatrix[1][1],a12=inMatrix[1][2];\nfloat a20=inMatrix[2][0],a21=inMatrix[2][1],a22=inMatrix[2][2];\nfloat b01=a22*a11-a12*a21;\nfloat b11=-a22*a10+a12*a20;\nfloat b21=a21*a10-a11*a20;\nfloat det=a00*b01+a01*b11+a02*b21;\nreturn mat3(b01,(-a22*a01+a02*a21),(a12*a01-a02*a11),\nb11,(a22*a00-a02*a20),(-a12*a00+a02*a10),\nb21,(-a21*a00+a01*a20),(a11*a00-a01*a10))/det;\n}\n#if USE_EXACT_SRGB_CONVERSIONS\nvec3 toLinearSpaceExact(vec3 color)\n{\nvec3 nearZeroSection=0.0773993808*color;\nvec3 remainingSection=pow(0.947867299*(color+vec3(0.055)),vec3(2.4));\n#if defined(WEBGL2) || defined(WEBGPU) || defined(NATIVE)\nreturn mix(remainingSection,nearZeroSection,lessThanEqual(color,vec3(0.04045)));\n#else\nreturn\nvec3(\ncolor.r<=0.04045 ? nearZeroSection.r : remainingSection.r,\ncolor.g<=0.04045 ? nearZeroSection.g : remainingSection.g,\ncolor.b<=0.04045 ? nearZeroSection.b : remainingSection.b);\n#endif\n}\nvec3 toGammaSpaceExact(vec3 color)\n{\nvec3 nearZeroSection=12.92*color;\nvec3 remainingSection=1.055*pow(color,vec3(0.41666))-vec3(0.055);\n#if defined(WEBGL2) || defined(WEBGPU) || defined(NATIVE)\nreturn mix(remainingSection,nearZeroSection,lessThanEqual(color,vec3(0.0031308)));\n#else\nreturn\nvec3(\ncolor.r<=0.0031308 ? nearZeroSection.r : remainingSection.r,\ncolor.g<=0.0031308 ? nearZeroSection.g : remainingSection.g,\ncolor.b<=0.0031308 ? nearZeroSection.b : remainingSection.b);\n#endif\n}\n#endif\nfloat toLinearSpace(float color)\n{\n#if USE_EXACT_SRGB_CONVERSIONS\nfloat nearZeroSection=0.0773993808*color;\nfloat remainingSection=pow(0.947867299*(color+0.055),2.4);\nreturn color<=0.04045 ? nearZeroSection : remainingSection;\n#else\nreturn pow(color,LinearEncodePowerApprox);\n#endif\n}\nvec3 toLinearSpace(vec3 color)\n{\n#if USE_EXACT_SRGB_CONVERSIONS\nreturn toLinearSpaceExact(color);\n#else\nreturn pow(color,vec3(LinearEncodePowerApprox));\n#endif\n}\nvec4 toLinearSpace(vec4 color)\n{\n#if USE_EXACT_SRGB_CONVERSIONS\nreturn vec4(toLinearSpaceExact(color.rgb),color.a);\n#else\nreturn vec4(pow(color.rgb,vec3(LinearEncodePowerApprox)),color.a);\n#endif\n}\nfloat toGammaSpace(float color)\n{\n#if USE_EXACT_SRGB_CONVERSIONS\nfloat nearZeroSection=12.92*color;\nfloat remainingSection=1.055*pow(color,0.41666)-0.055;\nreturn color<=0.0031308 ? nearZeroSection : remainingSection;\n#else\nreturn pow(color,GammaEncodePowerApprox);\n#endif\n}\nvec3 toGammaSpace(vec3 color)\n{\n#if USE_EXACT_SRGB_CONVERSIONS\nreturn toGammaSpaceExact(color);\n#else\nreturn pow(color,vec3(GammaEncodePowerApprox));\n#endif\n}\nvec4 toGammaSpace(vec4 color)\n{\n#if USE_EXACT_SRGB_CONVERSIONS\nreturn vec4(toGammaSpaceExact(color.rgb),color.a);\n#else\nreturn vec4(pow(color.rgb,vec3(GammaEncodePowerApprox)),color.a);\n#endif\n}\nfloat square(float value)\n{\nreturn value*value;\n}\nvec3 square(vec3 value)\n{\nreturn value*value;\n}\nfloat pow5(float value) {\nfloat sq=value*value;\nreturn sq*sq*value;\n}\nfloat getLuminance(vec3 color)\n{\nreturn clamp(dot(color,LuminanceEncodeApprox),0.,1.);\n}\nfloat getRand(vec2 seed) {\nreturn fract(sin(dot(seed.xy ,vec2(12.9898,78.233)))*43758.5453);\n}\nfloat dither(vec2 seed,float varianceAmount) {\nfloat rand=getRand(seed);\nfloat normVariance=varianceAmount/255.0;\nfloat dither=mix(-normVariance,normVariance,rand);\nreturn dither;\n}\nconst float rgbdMaxRange=255.0;\nvec4 toRGBD(vec3 color) {\nfloat maxRGB=maxEps(max(color.r,max(color.g,color.b)));\nfloat D =max(rgbdMaxRange/maxRGB,1.);\nD =clamp(floor(D)/255.0,0.,1.);\nvec3 rgb=color.rgb*D;\nrgb=toGammaSpace(rgb);\nreturn vec4(clamp(rgb,0.,1.),D); \n}\nvec3 fromRGBD(vec4 rgbd) {\nrgbd.rgb=toLinearSpace(rgbd.rgb);\nreturn rgbd.rgb/rgbd.a;\n}\nvec3 parallaxCorrectNormal( vec3 vertexPos,vec3 origVec,vec3 cubeSize,vec3 cubePos ) {\nvec3 invOrigVec=vec3(1.0,1.0,1.0)/origVec;\nvec3 halfSize=cubeSize*0.5;\nvec3 intersecAtMaxPlane=(cubePos+halfSize-vertexPos)*invOrigVec;\nvec3 intersecAtMinPlane=(cubePos-halfSize-vertexPos)*invOrigVec;\nvec3 largestIntersec=max(intersecAtMaxPlane,intersecAtMinPlane);\nfloat distance=min(min(largestIntersec.x,largestIntersec.y),largestIntersec.z);\nvec3 intersectPositionWS=vertexPos+origVec*distance;\nreturn intersectPositionWS-cubePos;\n}\n";ve.v.IncludesShadersStore[Le]=Fe;const Be="lightFragmentDeclaration",Ue="#ifdef LIGHT{X}\nuniform vec4 vLightData{X};\nuniform vec4 vLightDiffuse{X};\n#ifdef SPECULARTERM\nuniform vec4 vLightSpecular{X};\n#else\nvec4 vLightSpecular{X}=vec4(0.);\n#endif\n#ifdef SHADOW{X}\n#ifdef SHADOWCSM{X}\nuniform mat4 lightMatrix{X}[SHADOWCSMNUM_CASCADES{X}];\nuniform float viewFrustumZ{X}[SHADOWCSMNUM_CASCADES{X}];\nuniform float frustumLengths{X}[SHADOWCSMNUM_CASCADES{X}];\nuniform float cascadeBlendFactor{X};\nvarying vec4 vPositionFromLight{X}[SHADOWCSMNUM_CASCADES{X}];\nvarying float vDepthMetric{X}[SHADOWCSMNUM_CASCADES{X}];\nvarying vec4 vPositionFromCamera{X};\n#if defined(SHADOWPCSS{X})\nuniform highp sampler2DArrayShadow shadowSampler{X};\nuniform highp sampler2DArray depthSampler{X};\nuniform vec2 lightSizeUVCorrection{X}[SHADOWCSMNUM_CASCADES{X}];\nuniform float depthCorrection{X}[SHADOWCSMNUM_CASCADES{X}];\nuniform float penumbraDarkness{X};\n#elif defined(SHADOWPCF{X})\nuniform highp sampler2DArrayShadow shadowSampler{X};\n#else\nuniform highp sampler2DArray shadowSampler{X};\n#endif\n#ifdef SHADOWCSMDEBUG{X}\nconst vec3 vCascadeColorsMultiplier{X}[8]=vec3[8]\n(\nvec3 ( 1.5,0.0,0.0 ),\nvec3 ( 0.0,1.5,0.0 ),\nvec3 ( 0.0,0.0,5.5 ),\nvec3 ( 1.5,0.0,5.5 ),\nvec3 ( 1.5,1.5,0.0 ),\nvec3 ( 1.0,1.0,1.0 ),\nvec3 ( 0.0,1.0,5.5 ),\nvec3 ( 0.5,3.5,0.75 )\n);\nvec3 shadowDebug{X};\n#endif\n#ifdef SHADOWCSMUSESHADOWMAXZ{X}\nint index{X}=-1;\n#else\nint index{X}=SHADOWCSMNUM_CASCADES{X}-1;\n#endif\nfloat diff{X}=0.;\n#elif defined(SHADOWCUBE{X})\nuniform samplerCube shadowSampler{X};\n#else\nvarying vec4 vPositionFromLight{X};\nvarying float vDepthMetric{X};\n#if defined(SHADOWPCSS{X})\nuniform highp sampler2DShadow shadowSampler{X};\nuniform highp sampler2D depthSampler{X};\n#elif defined(SHADOWPCF{X})\nuniform highp sampler2DShadow shadowSampler{X};\n#else\nuniform sampler2D shadowSampler{X};\n#endif\nuniform mat4 lightMatrix{X};\n#endif\nuniform vec4 shadowsInfo{X};\nuniform vec2 depthValues{X};\n#endif\n#ifdef SPOTLIGHT{X}\nuniform vec4 vLightDirection{X};\nuniform vec4 vLightFalloff{X};\n#elif defined(POINTLIGHT{X})\nuniform vec4 vLightFalloff{X};\n#elif defined(HEMILIGHT{X})\nuniform vec3 vLightGround{X};\n#endif\n#ifdef PROJECTEDLIGHTTEXTURE{X}\nuniform mat4 textureProjectionMatrix{X};\nuniform sampler2D projectionLightSampler{X};\n#endif\n#endif\n";ve.v.IncludesShadersStore[Be]=Ue;const ke="lightUboDeclaration",Ve="#ifdef LIGHT{X}\nuniform Light{X}\n{\nvec4 vLightData;\nvec4 vLightDiffuse;\nvec4 vLightSpecular;\n#ifdef SPOTLIGHT{X}\nvec4 vLightDirection;\nvec4 vLightFalloff;\n#elif defined(POINTLIGHT{X})\nvec4 vLightFalloff;\n#elif defined(HEMILIGHT{X})\nvec3 vLightGround;\n#endif\nvec4 shadowsInfo;\nvec2 depthValues;\n} light{X};\n#ifdef PROJECTEDLIGHTTEXTURE{X}\nuniform mat4 textureProjectionMatrix{X};\nuniform sampler2D projectionLightSampler{X};\n#endif\n#ifdef SHADOW{X}\n#ifdef SHADOWCSM{X}\nuniform mat4 lightMatrix{X}[SHADOWCSMNUM_CASCADES{X}];\nuniform float viewFrustumZ{X}[SHADOWCSMNUM_CASCADES{X}];\nuniform float frustumLengths{X}[SHADOWCSMNUM_CASCADES{X}];\nuniform float cascadeBlendFactor{X};\nvarying vec4 vPositionFromLight{X}[SHADOWCSMNUM_CASCADES{X}];\nvarying float vDepthMetric{X}[SHADOWCSMNUM_CASCADES{X}];\nvarying vec4 vPositionFromCamera{X};\n#if defined(SHADOWPCSS{X})\nuniform highp sampler2DArrayShadow shadowSampler{X};\nuniform highp sampler2DArray depthSampler{X};\nuniform vec2 lightSizeUVCorrection{X}[SHADOWCSMNUM_CASCADES{X}];\nuniform float depthCorrection{X}[SHADOWCSMNUM_CASCADES{X}];\nuniform float penumbraDarkness{X};\n#elif defined(SHADOWPCF{X})\nuniform highp sampler2DArrayShadow shadowSampler{X};\n#else\nuniform highp sampler2DArray shadowSampler{X};\n#endif\n#ifdef SHADOWCSMDEBUG{X}\nconst vec3 vCascadeColorsMultiplier{X}[8]=vec3[8]\n(\nvec3 ( 1.5,0.0,0.0 ),\nvec3 ( 0.0,1.5,0.0 ),\nvec3 ( 0.0,0.0,5.5 ),\nvec3 ( 1.5,0.0,5.5 ),\nvec3 ( 1.5,1.5,0.0 ),\nvec3 ( 1.0,1.0,1.0 ),\nvec3 ( 0.0,1.0,5.5 ),\nvec3 ( 0.5,3.5,0.75 )\n);\nvec3 shadowDebug{X};\n#endif\n#ifdef SHADOWCSMUSESHADOWMAXZ{X}\nint index{X}=-1;\n#else\nint index{X}=SHADOWCSMNUM_CASCADES{X}-1;\n#endif\nfloat diff{X}=0.;\n#elif defined(SHADOWCUBE{X})\nuniform samplerCube shadowSampler{X}; \n#else\nvarying vec4 vPositionFromLight{X};\nvarying float vDepthMetric{X};\n#if defined(SHADOWPCSS{X})\nuniform highp sampler2DShadow shadowSampler{X};\nuniform highp sampler2D depthSampler{X};\n#elif defined(SHADOWPCF{X})\nuniform highp sampler2DShadow shadowSampler{X};\n#else\nuniform sampler2D shadowSampler{X};\n#endif\nuniform mat4 lightMatrix{X};\n#endif\n#endif\n#endif\n";ve.v.IncludesShadersStore[ke]=Ve;const Ge="lightsFragmentFunctions",We="struct lightingInfo\n{\nvec3 diffuse;\n#ifdef SPECULARTERM\nvec3 specular;\n#endif\n#ifdef NDOTL\nfloat ndl;\n#endif\n};\nlightingInfo computeLighting(vec3 viewDirectionW,vec3 vNormal,vec4 lightData,vec3 diffuseColor,vec3 specularColor,float range,float glossiness) {\nlightingInfo result;\nvec3 lightVectorW;\nfloat attenuation=1.0;\nif (lightData.w==0.)\n{\nvec3 direction=lightData.xyz-vPositionW;\nattenuation=max(0.,1.0-length(direction)/range);\nlightVectorW=normalize(direction);\n}\nelse\n{\nlightVectorW=normalize(-lightData.xyz);\n}\nfloat ndl=max(0.,dot(vNormal,lightVectorW));\n#ifdef NDOTL\nresult.ndl=ndl;\n#endif\nresult.diffuse=ndl*diffuseColor*attenuation;\n#ifdef SPECULARTERM\nvec3 angleW=normalize(viewDirectionW+lightVectorW);\nfloat specComp=max(0.,dot(vNormal,angleW));\nspecComp=pow(specComp,max(1.,glossiness));\nresult.specular=specComp*specularColor*attenuation;\n#endif\nreturn result;\n}\nlightingInfo computeSpotLighting(vec3 viewDirectionW,vec3 vNormal,vec4 lightData,vec4 lightDirection,vec3 diffuseColor,vec3 specularColor,float range,float glossiness) {\nlightingInfo result;\nvec3 direction=lightData.xyz-vPositionW;\nvec3 lightVectorW=normalize(direction);\nfloat attenuation=max(0.,1.0-length(direction)/range);\nfloat cosAngle=max(0.,dot(lightDirection.xyz,-lightVectorW));\nif (cosAngle>=lightDirection.w)\n{\ncosAngle=max(0.,pow(cosAngle,lightData.w));\nattenuation*=cosAngle;\nfloat ndl=max(0.,dot(vNormal,lightVectorW));\n#ifdef NDOTL\nresult.ndl=ndl;\n#endif\nresult.diffuse=ndl*diffuseColor*attenuation;\n#ifdef SPECULARTERM\nvec3 angleW=normalize(viewDirectionW+lightVectorW);\nfloat specComp=max(0.,dot(vNormal,angleW));\nspecComp=pow(specComp,max(1.,glossiness));\nresult.specular=specComp*specularColor*attenuation;\n#endif\nreturn result;\n}\nresult.diffuse=vec3(0.);\n#ifdef SPECULARTERM\nresult.specular=vec3(0.);\n#endif\n#ifdef NDOTL\nresult.ndl=0.;\n#endif\nreturn result;\n}\nlightingInfo computeHemisphericLighting(vec3 viewDirectionW,vec3 vNormal,vec4 lightData,vec3 diffuseColor,vec3 specularColor,vec3 groundColor,float glossiness) {\nlightingInfo result;\nfloat ndl=dot(vNormal,lightData.xyz)*0.5+0.5;\n#ifdef NDOTL\nresult.ndl=ndl;\n#endif\nresult.diffuse=mix(groundColor,diffuseColor,ndl);\n#ifdef SPECULARTERM\nvec3 angleW=normalize(viewDirectionW+lightData.xyz);\nfloat specComp=max(0.,dot(vNormal,angleW));\nspecComp=pow(specComp,max(1.,glossiness));\nresult.specular=specComp*specularColor;\n#endif\nreturn result;\n}\n#define inline\nvec3 computeProjectionTextureDiffuseLighting(sampler2D projectionLightSampler,mat4 textureProjectionMatrix){\nvec4 strq=textureProjectionMatrix*vec4(vPositionW,1.0);\nstrq/=strq.w;\nvec3 textureColor=texture2D(projectionLightSampler,strq.xy).rgb;\nreturn textureColor;\n}";ve.v.IncludesShadersStore[Ge]=We;const ze="shadowsFragmentFunctions",He="#ifdef SHADOWS\n#if defined(WEBGL2) || defined(WEBGPU) || defined(NATIVE)\n#define TEXTUREFUNC(s,c,l) texture2DLodEXT(s,c,l)\n#else\n#define TEXTUREFUNC(s,c,b) texture2D(s,c,b)\n#endif\n#ifndef SHADOWFLOAT\nfloat unpack(vec4 color)\n{\nconst vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);\nreturn dot(color,bit_shift);\n}\n#endif\nfloat computeFallOff(float value,vec2 clipSpace,float frustumEdgeFalloff)\n{\nfloat mask=smoothstep(1.0-frustumEdgeFalloff,1.00000012,clamp(dot(clipSpace,clipSpace),0.,1.));\nreturn mix(value,1.0,mask);\n}\n#define inline\nfloat computeShadowCube(vec3 lightPosition,samplerCube shadowSampler,float darkness,vec2 depthValues)\n{\nvec3 directionToLight=vPositionW-lightPosition;\nfloat depth=length(directionToLight);\ndepth=(depth+depthValues.x)/(depthValues.y);\ndepth=clamp(depth,0.,1.0);\ndirectionToLight=normalize(directionToLight);\ndirectionToLight.y=-directionToLight.y;\n#ifndef SHADOWFLOAT\nfloat shadow=unpack(textureCube(shadowSampler,directionToLight));\n#else\nfloat shadow=textureCube(shadowSampler,directionToLight).x;\n#endif\nreturn depth>shadow ? darkness : 1.0;\n}\n#define inline\nfloat computeShadowWithPoissonSamplingCube(vec3 lightPosition,samplerCube shadowSampler,float mapSize,float darkness,vec2 depthValues)\n{\nvec3 directionToLight=vPositionW-lightPosition;\nfloat depth=length(directionToLight);\ndepth=(depth+depthValues.x)/(depthValues.y);\ndepth=clamp(depth,0.,1.0);\ndirectionToLight=normalize(directionToLight);\ndirectionToLight.y=-directionToLight.y;\nfloat visibility=1.;\nvec3 poissonDisk[4];\npoissonDisk[0]=vec3(-1.0,1.0,-1.0);\npoissonDisk[1]=vec3(1.0,-1.0,-1.0);\npoissonDisk[2]=vec3(-1.0,-1.0,-1.0);\npoissonDisk[3]=vec3(1.0,-1.0,1.0);\n#ifndef SHADOWFLOAT\nif (unpack(textureCube(shadowSampler,directionToLight+poissonDisk[0]*mapSize))<depth) visibility-=0.25;\nif (unpack(textureCube(shadowSampler,directionToLight+poissonDisk[1]*mapSize))<depth) visibility-=0.25;\nif (unpack(textureCube(shadowSampler,directionToLight+poissonDisk[2]*mapSize))<depth) visibility-=0.25;\nif (unpack(textureCube(shadowSampler,directionToLight+poissonDisk[3]*mapSize))<depth) visibility-=0.25;\n#else\nif (textureCube(shadowSampler,directionToLight+poissonDisk[0]*mapSize).x<depth) visibility-=0.25;\nif (textureCube(shadowSampler,directionToLight+poissonDisk[1]*mapSize).x<depth) visibility-=0.25;\nif (textureCube(shadowSampler,directionToLight+poissonDisk[2]*mapSize).x<depth) visibility-=0.25;\nif (textureCube(shadowSampler,directionToLight+poissonDisk[3]*mapSize).x<depth) visibility-=0.25;\n#endif\nreturn min(1.0,visibility+darkness);\n}\n#define inline\nfloat computeShadowWithESMCube(vec3 lightPosition,samplerCube shadowSampler,float darkness,float depthScale,vec2 depthValues)\n{\nvec3 directionToLight=vPositionW-lightPosition;\nfloat depth=length(directionToLight);\ndepth=(depth+depthValues.x)/(depthValues.y);\nfloat shadowPixelDepth=clamp(depth,0.,1.0);\ndirectionToLight=normalize(directionToLight);\ndirectionToLight.y=-directionToLight.y;\n#ifndef SHADOWFLOAT\nfloat shadowMapSample=unpack(textureCube(shadowSampler,directionToLight));\n#else\nfloat shadowMapSample=textureCube(shadowSampler,directionToLight).x;\n#endif\nfloat esm=1.0-clamp(exp(min(87.,depthScale*shadowPixelDepth))*shadowMapSample,0.,1.-darkness); \nreturn esm;\n}\n#define inline\nfloat computeShadowWithCloseESMCube(vec3 lightPosition,samplerCube shadowSampler,float darkness,float depthScale,vec2 depthValues)\n{\nvec3 directionToLight=vPositionW-lightPosition;\nfloat depth=length(directionToLight);\ndepth=(depth+depthValues.x)/(depthValues.y);\nfloat shadowPixelDepth=clamp(depth,0.,1.0);\ndirectionToLight=normalize(directionToLight);\ndirectionToLight.y=-directionToLight.y;\n#ifndef SHADOWFLOAT\nfloat shadowMapSample=unpack(textureCube(shadowSampler,directionToLight));\n#else\nfloat shadowMapSample=textureCube(shadowSampler,directionToLight).x;\n#endif\nfloat esm=clamp(exp(min(87.,-depthScale*(shadowPixelDepth-shadowMapSample))),darkness,1.);\nreturn esm;\n}\n#if defined(WEBGL2) || defined(WEBGPU) || defined(NATIVE)\n#define inline\nfloat computeShadowCSM(float layer,vec4 vPositionFromLight,float depthMetric,highp sampler2DArray shadowSampler,float darkness,float frustumEdgeFalloff)\n{\nvec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;\nvec2 uv=0.5*clipSpace.xy+vec2(0.5);\nvec3 uvLayer=vec3(uv.x,uv.y,layer);\nfloat shadowPixelDepth=clamp(depthMetric,0.,1.0);\n#ifndef SHADOWFLOAT\nfloat shadow=unpack(texture2D(shadowSampler,uvLayer));\n#else\nfloat shadow=texture2D(shadowSampler,uvLayer).x;\n#endif\nreturn shadowPixelDepth>shadow ? computeFallOff(darkness,clipSpace.xy,frustumEdgeFalloff) : 1.;\n}\n#endif\n#define inline\nfloat computeShadow(vec4 vPositionFromLight,float depthMetric,sampler2D shadowSampler,float darkness,float frustumEdgeFalloff)\n{\nvec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;\nvec2 uv=0.5*clipSpace.xy+vec2(0.5);\nif (uv.x<0. || uv.x>1.0 || uv.y<0. || uv.y>1.0)\n{\nreturn 1.0;\n}\nelse\n{\nfloat shadowPixelDepth=clamp(depthMetric,0.,1.0);\n#ifndef SHADOWFLOAT\nfloat shadow=unpack(TEXTUREFUNC(shadowSampler,uv,0.));\n#else\nfloat shadow=TEXTUREFUNC(shadowSampler,uv,0.).x;\n#endif\nreturn shadowPixelDepth>shadow ? computeFallOff(darkness,clipSpace.xy,frustumEdgeFalloff) : 1.;\n}\n}\n#define inline\nfloat computeShadowWithPoissonSampling(vec4 vPositionFromLight,float depthMetric,sampler2D shadowSampler,float mapSize,float darkness,float frustumEdgeFalloff)\n{\nvec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;\nvec2 uv=0.5*clipSpace.xy+vec2(0.5);\nif (uv.x<0. || uv.x>1.0 || uv.y<0. || uv.y>1.0)\n{\nreturn 1.0;\n}\nelse\n{\nfloat shadowPixelDepth=clamp(depthMetric,0.,1.0);\nfloat visibility=1.;\nvec2 poissonDisk[4];\npoissonDisk[0]=vec2(-0.94201624,-0.39906216);\npoissonDisk[1]=vec2(0.94558609,-0.76890725);\npoissonDisk[2]=vec2(-0.094184101,-0.92938870);\npoissonDisk[3]=vec2(0.34495938,0.29387760);\n#ifndef SHADOWFLOAT\nif (unpack(TEXTUREFUNC(shadowSampler,uv+poissonDisk[0]*mapSize,0.))<shadowPixelDepth) visibility-=0.25;\nif (unpack(TEXTUREFUNC(shadowSampler,uv+poissonDisk[1]*mapSize,0.))<shadowPixelDepth) visibility-=0.25;\nif (unpack(TEXTUREFUNC(shadowSampler,uv+poissonDisk[2]*mapSize,0.))<shadowPixelDepth) visibility-=0.25;\nif (unpack(TEXTUREFUNC(shadowSampler,uv+poissonDisk[3]*mapSize,0.))<shadowPixelDepth) visibility-=0.25;\n#else\nif (TEXTUREFUNC(shadowSampler,uv+poissonDisk[0]*mapSize,0.).x<shadowPixelDepth) visibility-=0.25;\nif (TEXTUREFUNC(shadowSampler,uv+poissonDisk[1]*mapSize,0.).x<shadowPixelDepth) visibility-=0.25;\nif (TEXTUREFUNC(shadowSampler,uv+poissonDisk[2]*mapSize,0.).x<shadowPixelDepth) visibility-=0.25;\nif (TEXTUREFUNC(shadowSampler,uv+poissonDisk[3]*mapSize,0.).x<shadowPixelDepth) visibility-=0.25;\n#endif\nreturn computeFallOff(min(1.0,visibility+darkness),clipSpace.xy,frustumEdgeFalloff);\n}\n}\n#define inline\nfloat computeShadowWithESM(vec4 vPositionFromLight,float depthMetric,sampler2D shadowSampler,float darkness,float depthScale,float frustumEdgeFalloff)\n{\nvec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;\nvec2 uv=0.5*clipSpace.xy+vec2(0.5);\nif (uv.x<0. || uv.x>1.0 || uv.y<0. || uv.y>1.0)\n{\nreturn 1.0;\n}\nelse\n{\nfloat shadowPixelDepth=clamp(depthMetric,0.,1.0);\n#ifndef SHADOWFLOAT\nfloat shadowMapSample=unpack(TEXTUREFUNC(shadowSampler,uv,0.));\n#else\nfloat shadowMapSample=TEXTUREFUNC(shadowSampler,uv,0.).x;\n#endif\nfloat esm=1.0-clamp(exp(min(87.,depthScale*shadowPixelDepth))*shadowMapSample,0.,1.-darkness);\nreturn computeFallOff(esm,clipSpace.xy,frustumEdgeFalloff);\n}\n}\n#define inline\nfloat computeShadowWithCloseESM(vec4 vPositionFromLight,float depthMetric,sampler2D shadowSampler,float darkness,float depthScale,float frustumEdgeFalloff)\n{\nvec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;\nvec2 uv=0.5*clipSpace.xy+vec2(0.5);\nif (uv.x<0. || uv.x>1.0 || uv.y<0. || uv.y>1.0)\n{\nreturn 1.0;\n}\nelse\n{\nfloat shadowPixelDepth=clamp(depthMetric,0.,1.0); \n#ifndef SHADOWFLOAT\nfloat shadowMapSample=unpack(TEXTUREFUNC(shadowSampler,uv,0.));\n#else\nfloat shadowMapSample=TEXTUREFUNC(shadowSampler,uv,0.).x;\n#endif\nfloat esm=clamp(exp(min(87.,-depthScale*(shadowPixelDepth-shadowMapSample))),darkness,1.);\nreturn computeFallOff(esm,clipSpace.xy,frustumEdgeFalloff);\n}\n}\n#ifdef IS_NDC_HALF_ZRANGE\n#define ZINCLIP clipSpace.z\n#else\n#define ZINCLIP uvDepth.z\n#endif\n#if defined(WEBGL2) || defined(WEBGPU) || defined(NATIVE)\n#define GREATEST_LESS_THAN_ONE 0.99999994\n#define inline\nfloat computeShadowWithCSMPCF1(float layer,vec4 vPositionFromLight,float depthMetric,highp sampler2DArrayShadow shadowSampler,float darkness,float frustumEdgeFalloff)\n{\nvec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;\nvec3 uvDepth=vec3(0.5*clipSpace.xyz+vec3(0.5));\nuvDepth.z=clamp(ZINCLIP,0.,GREATEST_LESS_THAN_ONE);\nvec4 uvDepthLayer=vec4(uvDepth.x,uvDepth.y,layer,uvDepth.z);\nfloat shadow=texture2D(shadowSampler,uvDepthLayer);\nshadow=mix(darkness,1.,shadow);\nreturn computeFallOff(shadow,clipSpace.xy,frustumEdgeFalloff);\n}\n#define inline\nfloat computeShadowWithCSMPCF3(float layer,vec4 vPositionFromLight,float depthMetric,highp sampler2DArrayShadow shadowSampler,vec2 shadowMapSizeAndInverse,float darkness,float frustumEdgeFalloff)\n{\nvec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;\nvec3 uvDepth=vec3(0.5*clipSpace.xyz+vec3(0.5));\nuvDepth.z=clamp(ZINCLIP,0.,GREATEST_LESS_THAN_ONE);\nvec2 uv=uvDepth.xy*shadowMapSizeAndInverse.x; \nuv+=0.5; \nvec2 st=fract(uv); \nvec2 base_uv=floor(uv)-0.5; \nbase_uv*=shadowMapSizeAndInverse.y; \nvec2 uvw0=3.-2.*st;\nvec2 uvw1=1.+2.*st;\nvec2 u=vec2((2.-st.x)/uvw0.x-1.,st.x/uvw1.x+1.)*shadowMapSizeAndInverse.y;\nvec2 v=vec2((2.-st.y)/uvw0.y-1.,st.y/uvw1.y+1.)*shadowMapSizeAndInverse.y;\nfloat shadow=0.;\nshadow+=uvw0.x*uvw0.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[0],v[0]),layer,uvDepth.z));\nshadow+=uvw1.x*uvw0.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[1],v[0]),layer,uvDepth.z));\nshadow+=uvw0.x*uvw1.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[0],v[1]),layer,uvDepth.z));\nshadow+=uvw1.x*uvw1.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[1],v[1]),layer,uvDepth.z));\nshadow=shadow/16.;\nshadow=mix(darkness,1.,shadow);\nreturn computeFallOff(shadow,clipSpace.xy,frustumEdgeFalloff);\n}\n#define inline\nfloat computeShadowWithCSMPCF5(float layer,vec4 vPositionFromLight,float depthMetric,highp sampler2DArrayShadow shadowSampler,vec2 shadowMapSizeAndInverse,float darkness,float frustumEdgeFalloff)\n{\nvec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;\nvec3 uvDepth=vec3(0.5*clipSpace.xyz+vec3(0.5));\nuvDepth.z=clamp(ZINCLIP,0.,GREATEST_LESS_THAN_ONE);\nvec2 uv=uvDepth.xy*shadowMapSizeAndInverse.x; \nuv+=0.5; \nvec2 st=fract(uv); \nvec2 base_uv=floor(uv)-0.5; \nbase_uv*=shadowMapSizeAndInverse.y; \nvec2 uvw0=4.-3.*st;\nvec2 uvw1=vec2(7.);\nvec2 uvw2=1.+3.*st;\nvec3 u=vec3((3.-2.*st.x)/uvw0.x-2.,(3.+st.x)/uvw1.x,st.x/uvw2.x+2.)*shadowMapSizeAndInverse.y;\nvec3 v=vec3((3.-2.*st.y)/uvw0.y-2.,(3.+st.y)/uvw1.y,st.y/uvw2.y+2.)*shadowMapSizeAndInverse.y;\nfloat shadow=0.;\nshadow+=uvw0.x*uvw0.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[0],v[0]),layer,uvDepth.z));\nshadow+=uvw1.x*uvw0.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[1],v[0]),layer,uvDepth.z));\nshadow+=uvw2.x*uvw0.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[2],v[0]),layer,uvDepth.z));\nshadow+=uvw0.x*uvw1.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[0],v[1]),layer,uvDepth.z));\nshadow+=uvw1.x*uvw1.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[1],v[1]),layer,uvDepth.z));\nshadow+=uvw2.x*uvw1.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[2],v[1]),layer,uvDepth.z));\nshadow+=uvw0.x*uvw2.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[0],v[2]),layer,uvDepth.z));\nshadow+=uvw1.x*uvw2.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[1],v[2]),layer,uvDepth.z));\nshadow+=uvw2.x*uvw2.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[2],v[2]),layer,uvDepth.z));\nshadow=shadow/144.;\nshadow=mix(darkness,1.,shadow);\nreturn computeFallOff(shadow,clipSpace.xy,frustumEdgeFalloff);\n}\n#define inline\nfloat computeShadowWithPCF1(vec4 vPositionFromLight,float depthMetric,highp sampler2DShadow shadowSampler,float darkness,float frustumEdgeFalloff)\n{\nif (depthMetric>1.0 || depthMetric<0.0) {\nreturn 1.0;\n}\nelse\n{\nvec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;\nvec3 uvDepth=vec3(0.5*clipSpace.xyz+vec3(0.5));\nuvDepth.z=ZINCLIP;\nfloat shadow=TEXTUREFUNC(shadowSampler,uvDepth,0.);\nshadow=mix(darkness,1.,shadow);\nreturn computeFallOff(shadow,clipSpace.xy,frustumEdgeFalloff);\n}\n}\n#define inline\nfloat computeShadowWithPCF3(vec4 vPositionFromLight,float depthMetric,highp sampler2DShadow shadowSampler,vec2 shadowMapSizeAndInverse,float darkness,float frustumEdgeFalloff)\n{\nif (depthMetric>1.0 || depthMetric<0.0) {\nreturn 1.0;\n}\nelse\n{\nvec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;\nvec3 uvDepth=vec3(0.5*clipSpace.xyz+vec3(0.5));\nuvDepth.z=ZINCLIP;\nvec2 uv=uvDepth.xy*shadowMapSizeAndInverse.x; \nuv+=0.5; \nvec2 st=fract(uv); \nvec2 base_uv=floor(uv)-0.5; \nbase_uv*=shadowMapSizeAndInverse.y; \nvec2 uvw0=3.-2.*st;\nvec2 uvw1=1.+2.*st;\nvec2 u=vec2((2.-st.x)/uvw0.x-1.,st.x/uvw1.x+1.)*shadowMapSizeAndInverse.y;\nvec2 v=vec2((2.-st.y)/uvw0.y-1.,st.y/uvw1.y+1.)*shadowMapSizeAndInverse.y;\nfloat shadow=0.;\nshadow+=uvw0.x*uvw0.y*TEXTUREFUNC(shadowSampler,vec3(base_uv.xy+vec2(u[0],v[0]),uvDepth.z),0.);\nshadow+=uvw1.x*uvw0.y*TEXTUREFUNC(shadowSampler,vec3(base_uv.xy+vec2(u[1],v[0]),uvDepth.z),0.);\nshadow+=uvw0.x*uvw1.y*TEXTUREFUNC(shadowSampler,vec3(base_uv.xy+vec2(u[0],v[1]),uvDepth.z),0.);\nshadow+=uvw1.x*uvw1.y*TEXTUREFUNC(shadowSampler,vec3(base_uv.xy+vec2(u[1],v[1]),uvDepth.z),0.);\nshadow=shadow/16.;\nshadow=mix(darkness,1.,shadow);\nreturn computeFallOff(shadow,clipSpace.xy,frustumEdgeFalloff);\n}\n}\n#define inline\nfloat computeShadowWithPCF5(vec4 vPositionFromLight,float depthMetric,highp sampler2DShadow shadowSampler,vec2 shadowMapSizeAndInverse,float darkness,float frustumEdgeFalloff)\n{\nif (depthMetric>1.0 || depthMetric<0.0) {\nreturn 1.0;\n}\nelse\n{\nvec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;\nvec3 uvDepth=vec3(0.5*clipSpace.xyz+vec3(0.5));\nuvDepth.z=ZINCLIP;\nvec2 uv=uvDepth.xy*shadowMapSizeAndInverse.x; \nuv+=0.5; \nvec2 st=fract(uv); \nvec2 base_uv=floor(uv)-0.5; \nbase_uv*=shadowMapSizeAndInverse.y; \nvec2 uvw0=4.-3.*st;\nvec2 uvw1=vec2(7.);\nvec2 uvw2=1.+3.*st;\nvec3 u=vec3((3.-2.*st.x)/uvw0.x-2.,(3.+st.x)/uvw1.x,st.x/uvw2.x+2.)*shadowMapSizeAndInverse.y;\nvec3 v=vec3((3.-2.*st.y)/uvw0.y-2.,(3.+st.y)/uvw1.y,st.y/uvw2.y+2.)*shadowMapSizeAndInverse.y;\nfloat shadow=0.;\nshadow+=uvw0.x*uvw0.y*TEXTUREFUNC(shadowSampler,vec3(base_uv.xy+vec2(u[0],v[0]),uvDepth.z),0.);\nshadow+=uvw1.x*uvw0.y*TEXTUREFUNC(shadowSampler,vec3(base_uv.xy+vec2(u[1],v[0]),uvDepth.z),0.);\nshadow+=uvw2.x*uvw0.y*TEXTUREFUNC(shadowSampler,vec3(base_uv.xy+vec2(u[2],v[0]),uvDepth.z),0.);\nshadow+=uvw0.x*uvw1.y*TEXTUREFUNC(shadowSampler,vec3(base_uv.xy+vec2(u[0],v[1]),uvDepth.z),0.);\nshadow+=uvw1.x*uvw1.y*TEXTUREFUNC(shadowSampler,vec3(base_uv.xy+vec2(u[1],v[1]),uvDepth.z),0.);\nshadow+=uvw2.x*uvw1.y*TEXTUREFUNC(shadowSampler,vec3(base_uv.xy+vec2(u[2],v[1]),uvDepth.z),0.);\nshadow+=uvw0.x*uvw2.y*TEXTUREFUNC(shadowSampler,vec3(base_uv.xy+vec2(u[0],v[2]),uvDepth.z),0.);\nshadow+=uvw1.x*uvw2.y*TEXTUREFUNC(shadowSampler,vec3(base_uv.xy+vec2(u[1],v[2]),uvDepth.z),0.);\nshadow+=uvw2.x*uvw2.y*TEXTUREFUNC(shadowSampler,vec3(base_uv.xy+vec2(u[2],v[2]),uvDepth.z),0.);\nshadow=shadow/144.;\nshadow=mix(darkness,1.,shadow);\nreturn computeFallOff(shadow,clipSpace.xy,frustumEdgeFalloff);\n}\n}\nconst vec3 PoissonSamplers32[64]=vec3[64](\nvec3(0.06407013,0.05409927,0.),\nvec3(0.7366577,0.5789394,0.),\nvec3(-0.6270542,-0.5320278,0.),\nvec3(-0.4096107,0.8411095,0.),\nvec3(0.6849564,-0.4990818,0.),\nvec3(-0.874181,-0.04579735,0.),\nvec3(0.9989998,0.0009880066,0.),\nvec3(-0.004920578,-0.9151649,0.),\nvec3(0.1805763,0.9747483,0.),\nvec3(-0.2138451,0.2635818,0.),\nvec3(0.109845,0.3884785,0.),\nvec3(0.06876755,-0.3581074,0.),\nvec3(0.374073,-0.7661266,0.),\nvec3(0.3079132,-0.1216763,0.),\nvec3(-0.3794335,-0.8271583,0.),\nvec3(-0.203878,-0.07715034,0.),\nvec3(0.5912697,0.1469799,0.),\nvec3(-0.88069,0.3031784,0.),\nvec3(0.5040108,0.8283722,0.),\nvec3(-0.5844124,0.5494877,0.),\nvec3(0.6017799,-0.1726654,0.),\nvec3(-0.5554981,0.1559997,0.),\nvec3(-0.3016369,-0.3900928,0.),\nvec3(-0.5550632,-0.1723762,0.),\nvec3(0.925029,0.2995041,0.),\nvec3(-0.2473137,0.5538505,0.),\nvec3(0.9183037,-0.2862392,0.),\nvec3(0.2469421,0.6718712,0.),\nvec3(0.3916397,-0.4328209,0.),\nvec3(-0.03576927,-0.6220032,0.),\nvec3(-0.04661255,0.7995201,0.),\nvec3(0.4402924,0.3640312,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.)\n);\nconst vec3 PoissonSamplers64[64]=vec3[64](\nvec3(-0.613392,0.617481,0.),\nvec3(0.170019,-0.040254,0.),\nvec3(-0.299417,0.791925,0.),\nvec3(0.645680,0.493210,0.),\nvec3(-0.651784,0.717887,0.),\nvec3(0.421003,0.027070,0.),\nvec3(-0.817194,-0.271096,0.),\nvec3(-0.705374,-0.668203,0.),\nvec3(0.977050,-0.108615,0.),\nvec3(0.063326,0.142369,0.),\nvec3(0.203528,0.214331,0.),\nvec3(-0.667531,0.326090,0.),\nvec3(-0.098422,-0.295755,0.),\nvec3(-0.885922,0.215369,0.),\nvec3(0.566637,0.605213,0.),\nvec3(0.039766,-0.396100,0.),\nvec3(0.751946,0.453352,0.),\nvec3(0.078707,-0.715323,0.),\nvec3(-0.075838,-0.529344,0.),\nvec3(0.724479,-0.580798,0.),\nvec3(0.222999,-0.215125,0.),\nvec3(-0.467574,-0.405438,0.),\nvec3(-0.248268,-0.814753,0.),\nvec3(0.354411,-0.887570,0.),\nvec3(0.175817,0.382366,0.),\nvec3(0.487472,-0.063082,0.),\nvec3(-0.084078,0.898312,0.),\nvec3(0.488876,-0.783441,0.),\nvec3(0.470016,0.217933,0.),\nvec3(-0.696890,-0.549791,0.),\nvec3(-0.149693,0.605762,0.),\nvec3(0.034211,0.979980,0.),\nvec3(0.503098,-0.308878,0.),\nvec3(-0.016205,-0.872921,0.),\nvec3(0.385784,-0.393902,0.),\nvec3(-0.146886,-0.859249,0.),\nvec3(0.643361,0.164098,0.),\nvec3(0.634388,-0.049471,0.),\nvec3(-0.688894,0.007843,0.),\nvec3(0.464034,-0.188818,0.),\nvec3(-0.440840,0.137486,0.),\nvec3(0.364483,0.511704,0.),\nvec3(0.034028,0.325968,0.),\nvec3(0.099094,-0.308023,0.),\nvec3(0.693960,-0.366253,0.),\nvec3(0.678884,-0.204688,0.),\nvec3(0.001801,0.780328,0.),\nvec3(0.145177,-0.898984,0.),\nvec3(0.062655,-0.611866,0.),\nvec3(0.315226,-0.604297,0.),\nvec3(-0.780145,0.486251,0.),\nvec3(-0.371868,0.882138,0.),\nvec3(0.200476,0.494430,0.),\nvec3(-0.494552,-0.711051,0.),\nvec3(0.612476,0.705252,0.),\nvec3(-0.578845,-0.768792,0.),\nvec3(-0.772454,-0.090976,0.),\nvec3(0.504440,0.372295,0.),\nvec3(0.155736,0.065157,0.),\nvec3(0.391522,0.849605,0.),\nvec3(-0.620106,-0.328104,0.),\nvec3(0.789239,-0.419965,0.),\nvec3(-0.545396,0.538133,0.),\nvec3(-0.178564,-0.596057,0.)\n);\n#define inline\nfloat computeShadowWithCSMPCSS(float layer,vec4 vPositionFromLight,float depthMetric,highp sampler2DArray depthSampler,highp sampler2DArrayShadow shadowSampler,float shadowMapSizeInverse,float lightSizeUV,float darkness,float frustumEdgeFalloff,int searchTapCount,int pcfTapCount,vec3[64] poissonSamplers,vec2 lightSizeUVCorrection,float depthCorrection,float penumbraDarkness)\n{\nvec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;\nvec3 uvDepth=vec3(0.5*clipSpace.xyz+vec3(0.5));\nuvDepth.z=clamp(ZINCLIP,0.,GREATEST_LESS_THAN_ONE);\nvec4 uvDepthLayer=vec4(uvDepth.x,uvDepth.y,layer,uvDepth.z);\nfloat blockerDepth=0.0;\nfloat sumBlockerDepth=0.0;\nfloat numBlocker=0.0;\nfor (int i=0; i<searchTapCount; i ++) {\nblockerDepth=texture2D(depthSampler,vec3(uvDepth.xy+(lightSizeUV*lightSizeUVCorrection*shadowMapSizeInverse*PoissonSamplers32[i].xy),layer)).r;\nif (blockerDepth<depthMetric) {\nsumBlockerDepth+=blockerDepth;\nnumBlocker++;\n}\n}\nfloat avgBlockerDepth=sumBlockerDepth/numBlocker;\nfloat AAOffset=shadowMapSizeInverse*10.;\nfloat penumbraRatio=((depthMetric-avgBlockerDepth)*depthCorrection+AAOffset);\nvec4 filterRadius=vec4(penumbraRatio*lightSizeUV*lightSizeUVCorrection*shadowMapSizeInverse,0.,0.);\nfloat random=getRand(vPositionFromLight.xy);\nfloat rotationAngle=random*3.1415926;\nvec2 rotationVector=vec2(cos(rotationAngle),sin(rotationAngle));\nfloat shadow=0.;\nfor (int i=0; i<pcfTapCount; i++) {\nvec4 offset=vec4(poissonSamplers[i],0.);\noffset=vec4(offset.x*rotationVector.x-offset.y*rotationVector.y,offset.y*rotationVector.x+offset.x*rotationVector.y,0.,0.);\nshadow+=texture2D(shadowSampler,uvDepthLayer+offset*filterRadius);\n}\nshadow/=float(pcfTapCount);\nshadow=mix(shadow,1.,min((depthMetric-avgBlockerDepth)*depthCorrection*penumbraDarkness,1.));\nshadow=mix(darkness,1.,shadow);\nif (numBlocker<1.0) {\nreturn 1.0;\n}\nelse\n{\nreturn computeFallOff(shadow,clipSpace.xy,frustumEdgeFalloff);\n}\n}\n#define inline\nfloat computeShadowWithPCSS(vec4 vPositionFromLight,float depthMetric,sampler2D depthSampler,highp sampler2DShadow shadowSampler,float shadowMapSizeInverse,float lightSizeUV,float darkness,float frustumEdgeFalloff,int searchTapCount,int pcfTapCount,vec3[64] poissonSamplers)\n{\nif (depthMetric>1.0 || depthMetric<0.0) {\nreturn 1.0;\n}\nelse\n{\nvec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;\nvec3 uvDepth=vec3(0.5*clipSpace.xyz+vec3(0.5));\nuvDepth.z=ZINCLIP;\nfloat blockerDepth=0.0;\nfloat sumBlockerDepth=0.0;\nfloat numBlocker=0.0;\nfor (int i=0; i<searchTapCount; i ++) {\nblockerDepth=TEXTUREFUNC(depthSampler,uvDepth.xy+(lightSizeUV*shadowMapSizeInverse*PoissonSamplers32[i].xy),0.).r;\nif (blockerDepth<depthMetric) {\nsumBlockerDepth+=blockerDepth;\nnumBlocker++;\n}\n}\nif (numBlocker<1.0) {\nreturn 1.0;\n}\nelse\n{\nfloat avgBlockerDepth=sumBlockerDepth/numBlocker;\nfloat AAOffset=shadowMapSizeInverse*10.;\nfloat penumbraRatio=((depthMetric-avgBlockerDepth)+AAOffset);\nfloat filterRadius=penumbraRatio*lightSizeUV*shadowMapSizeInverse;\nfloat random=getRand(vPositionFromLight.xy);\nfloat rotationAngle=random*3.1415926;\nvec2 rotationVector=vec2(cos(rotationAngle),sin(rotationAngle));\nfloat shadow=0.;\nfor (int i=0; i<pcfTapCount; i++) {\nvec3 offset=poissonSamplers[i];\noffset=vec3(offset.x*rotationVector.x-offset.y*rotationVector.y,offset.y*rotationVector.x+offset.x*rotationVector.y,0.);\nshadow+=TEXTUREFUNC(shadowSampler,uvDepth+offset*filterRadius,0.);\n}\nshadow/=float(pcfTapCount);\nshadow=mix(shadow,1.,depthMetric-avgBlockerDepth);\nshadow=mix(darkness,1.,shadow);\nreturn computeFallOff(shadow,clipSpace.xy,frustumEdgeFalloff);\n}\n}\n}\n#define inline\nfloat computeShadowWithPCSS16(vec4 vPositionFromLight,float depthMetric,sampler2D depthSampler,highp sampler2DShadow shadowSampler,float shadowMapSizeInverse,float lightSizeUV,float darkness,float frustumEdgeFalloff)\n{\nreturn computeShadowWithPCSS(vPositionFromLight,depthMetric,depthSampler,shadowSampler,shadowMapSizeInverse,lightSizeUV,darkness,frustumEdgeFalloff,16,16,PoissonSamplers32);\n}\n#define inline\nfloat computeShadowWithPCSS32(vec4 vPositionFromLight,float depthMetric,sampler2D depthSampler,highp sampler2DShadow shadowSampler,float shadowMapSizeInverse,float lightSizeUV,float darkness,float frustumEdgeFalloff)\n{\nreturn computeShadowWithPCSS(vPositionFromLight,depthMetric,depthSampler,shadowSampler,shadowMapSizeInverse,lightSizeUV,darkness,frustumEdgeFalloff,16,32,PoissonSamplers32);\n}\n#define inline\nfloat computeShadowWithPCSS64(vec4 vPositionFromLight,float depthMetric,sampler2D depthSampler,highp sampler2DShadow shadowSampler,float shadowMapSizeInverse,float lightSizeUV,float darkness,float frustumEdgeFalloff)\n{\nreturn computeShadowWithPCSS(vPositionFromLight,depthMetric,depthSampler,shadowSampler,shadowMapSizeInverse,lightSizeUV,darkness,frustumEdgeFalloff,32,64,PoissonSamplers64);\n}\n#define inline\nfloat computeShadowWithCSMPCSS16(float layer,vec4 vPositionFromLight,float depthMetric,highp sampler2DArray depthSampler,highp sampler2DArrayShadow shadowSampler,float shadowMapSizeInverse,float lightSizeUV,float darkness,float frustumEdgeFalloff,vec2 lightSizeUVCorrection,float depthCorrection,float penumbraDarkness)\n{\nreturn computeShadowWithCSMPCSS(layer,vPositionFromLight,depthMetric,depthSampler,shadowSampler,shadowMapSizeInverse,lightSizeUV,darkness,frustumEdgeFalloff,16,16,PoissonSamplers32,lightSizeUVCorrection,depthCorrection,penumbraDarkness);\n}\n#define inline\nfloat computeShadowWithCSMPCSS32(float layer,vec4 vPositionFromLight,float depthMetric,highp sampler2DArray depthSampler,highp sampler2DArrayShadow shadowSampler,float shadowMapSizeInverse,float lightSizeUV,float darkness,float frustumEdgeFalloff,vec2 lightSizeUVCorrection,float depthCorrection,float penumbraDarkness)\n{\nreturn computeShadowWithCSMPCSS(layer,vPositionFromLight,depthMetric,depthSampler,shadowSampler,shadowMapSizeInverse,lightSizeUV,darkness,frustumEdgeFalloff,16,32,PoissonSamplers32,lightSizeUVCorrection,depthCorrection,penumbraDarkness);\n}\n#define inline\nfloat computeShadowWithCSMPCSS64(float layer,vec4 vPositionFromLight,float depthMetric,highp sampler2DArray depthSampler,highp sampler2DArrayShadow shadowSampler,float shadowMapSizeInverse,float lightSizeUV,float darkness,float frustumEdgeFalloff,vec2 lightSizeUVCorrection,float depthCorrection,float penumbraDarkness)\n{\nreturn computeShadowWithCSMPCSS(layer,vPositionFromLight,depthMetric,depthSampler,shadowSampler,shadowMapSizeInverse,lightSizeUV,darkness,frustumEdgeFalloff,32,64,PoissonSamplers64,lightSizeUVCorrection,depthCorrection,penumbraDarkness);\n}\n#endif\n#endif\n";ve.v.IncludesShadersStore[ze]=He;const Xe="samplerFragmentDeclaration",je="#ifdef _DEFINENAME_\n#if _DEFINENAME_DIRECTUV==1\n#define v_VARYINGNAME_UV vMainUV1\n#elif _DEFINENAME_DIRECTUV==2\n#define v_VARYINGNAME_UV vMainUV2\n#elif _DEFINENAME_DIRECTUV==3\n#define v_VARYINGNAME_UV vMainUV3\n#elif _DEFINENAME_DIRECTUV==4\n#define v_VARYINGNAME_UV vMainUV4\n#elif _DEFINENAME_DIRECTUV==5\n#define v_VARYINGNAME_UV vMainUV5\n#elif _DEFINENAME_DIRECTUV==6\n#define v_VARYINGNAME_UV vMainUV6\n#else\nvarying vec2 v_VARYINGNAME_UV;\n#endif\nuniform sampler2D _SAMPLERNAME_Sampler;\n#endif\n";ve.v.IncludesShadersStore[Xe]=je;const Ye="fresnelFunction",qe="#ifdef FRESNEL\nfloat computeFresnelTerm(vec3 viewDirection,vec3 worldNormal,float bias,float power)\n{\nfloat fresnelTerm=pow(bias+abs(dot(viewDirection,worldNormal)),power);\nreturn clamp(fresnelTerm,0.,1.);\n}\n#endif\n";ve.v.IncludesShadersStore[Ye]=qe;const Ke="reflectionFunction",Qe="vec3 computeFixedEquirectangularCoords(vec4 worldPos,vec3 worldNormal,vec3 direction)\n{\nfloat lon=atan(direction.z,direction.x);\nfloat lat=acos(direction.y);\nvec2 sphereCoords=vec2(lon,lat)*RECIPROCAL_PI2*2.0;\nfloat s=sphereCoords.x*0.5+0.5;\nfloat t=sphereCoords.y;\nreturn vec3(s,t,0); \n}\nvec3 computeMirroredFixedEquirectangularCoords(vec4 worldPos,vec3 worldNormal,vec3 direction)\n{\nfloat lon=atan(direction.z,direction.x);\nfloat lat=acos(direction.y);\nvec2 sphereCoords=vec2(lon,lat)*RECIPROCAL_PI2*2.0;\nfloat s=sphereCoords.x*0.5+0.5;\nfloat t=sphereCoords.y;\nreturn vec3(1.0-s,t,0); \n}\nvec3 computeEquirectangularCoords(vec4 worldPos,vec3 worldNormal,vec3 eyePosition,mat4 reflectionMatrix)\n{\nvec3 cameraToVertex=normalize(worldPos.xyz-eyePosition);\nvec3 r=normalize(reflect(cameraToVertex,worldNormal));\nr=vec3(reflectionMatrix*vec4(r,0));\nfloat lon=atan(r.z,r.x);\nfloat lat=acos(r.y);\nvec2 sphereCoords=vec2(lon,lat)*RECIPROCAL_PI2*2.0;\nfloat s=sphereCoords.x*0.5+0.5;\nfloat t=sphereCoords.y;\nreturn vec3(s,t,0);\n}\nvec3 computeSphericalCoords(vec4 worldPos,vec3 worldNormal,mat4 view,mat4 reflectionMatrix)\n{\nvec3 viewDir=normalize(vec3(view*worldPos));\nvec3 viewNormal=normalize(vec3(view*vec4(worldNormal,0.0)));\nvec3 r=reflect(viewDir,viewNormal);\nr=vec3(reflectionMatrix*vec4(r,0));\nr.z=r.z-1.0;\nfloat m=2.0*length(r);\nreturn vec3(r.x/m+0.5,1.0-r.y/m-0.5,0);\n}\nvec3 computePlanarCoords(vec4 worldPos,vec3 worldNormal,vec3 eyePosition,mat4 reflectionMatrix)\n{\nvec3 viewDir=worldPos.xyz-eyePosition;\nvec3 coords=normalize(reflect(viewDir,worldNormal));\nreturn vec3(reflectionMatrix*vec4(coords,1));\n}\nvec3 computeCubicCoords(vec4 worldPos,vec3 worldNormal,vec3 eyePosition,mat4 reflectionMatrix)\n{\nvec3 viewDir=normalize(worldPos.xyz-eyePosition);\nvec3 coords=reflect(viewDir,worldNormal);\ncoords=vec3(reflectionMatrix*vec4(coords,0));\n#ifdef INVERTCUBICMAP\ncoords.y*=-1.0;\n#endif\nreturn coords;\n}\nvec3 computeCubicLocalCoords(vec4 worldPos,vec3 worldNormal,vec3 eyePosition,mat4 reflectionMatrix,vec3 reflectionSize,vec3 reflectionPosition)\n{\nvec3 viewDir=normalize(worldPos.xyz-eyePosition);\nvec3 coords=reflect(viewDir,worldNormal);\ncoords=parallaxCorrectNormal(worldPos.xyz,coords,reflectionSize,reflectionPosition);\ncoords=vec3(reflectionMatrix*vec4(coords,0));\n#ifdef INVERTCUBICMAP\ncoords.y*=-1.0;\n#endif\nreturn coords;\n}\nvec3 computeProjectionCoords(vec4 worldPos,mat4 view,mat4 reflectionMatrix)\n{\nreturn vec3(reflectionMatrix*(view*worldPos));\n}\nvec3 computeSkyBoxCoords(vec3 positionW,mat4 reflectionMatrix)\n{\nreturn vec3(reflectionMatrix*vec4(positionW,1.));\n}\n#ifdef REFLECTION\nvec3 computeReflectionCoords(vec4 worldPos,vec3 worldNormal)\n{\n#ifdef REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED\nvec3 direction=normalize(vDirectionW);\nreturn computeMirroredFixedEquirectangularCoords(worldPos,worldNormal,direction);\n#endif\n#ifdef REFLECTIONMAP_EQUIRECTANGULAR_FIXED\nvec3 direction=normalize(vDirectionW);\nreturn computeFixedEquirectangularCoords(worldPos,worldNormal,direction);\n#endif\n#ifdef REFLECTIONMAP_EQUIRECTANGULAR\nreturn computeEquirectangularCoords(worldPos,worldNormal,vEyePosition.xyz,reflectionMatrix);\n#endif\n#ifdef REFLECTIONMAP_SPHERICAL\nreturn computeSphericalCoords(worldPos,worldNormal,view,reflectionMatrix);\n#endif\n#ifdef REFLECTIONMAP_PLANAR\nreturn computePlanarCoords(worldPos,worldNormal,vEyePosition.xyz,reflectionMatrix);\n#endif\n#ifdef REFLECTIONMAP_CUBIC\n#ifdef USE_LOCAL_REFLECTIONMAP_CUBIC\nreturn computeCubicLocalCoords(worldPos,worldNormal,vEyePosition.xyz,reflectionMatrix,vReflectionSize,vReflectionPosition);\n#else\nreturn computeCubicCoords(worldPos,worldNormal,vEyePosition.xyz,reflectionMatrix);\n#endif\n#endif\n#ifdef REFLECTIONMAP_PROJECTION\nreturn computeProjectionCoords(worldPos,view,reflectionMatrix);\n#endif\n#ifdef REFLECTIONMAP_SKYBOX\nreturn computeSkyBoxCoords(vPositionUVW,reflectionMatrix);\n#endif\n#ifdef REFLECTIONMAP_EXPLICIT\nreturn vec3(0,0,0);\n#endif\n}\n#endif\n";ve.v.IncludesShadersStore[Ke]=Qe;const Ze="imageProcessingDeclaration",$e="#ifdef EXPOSURE\nuniform float exposureLinear;\n#endif\n#ifdef CONTRAST\nuniform float contrast;\n#endif\n#if defined(VIGNETTE) || defined(DITHER)\nuniform vec2 vInverseScreenSize;\n#endif\n#ifdef VIGNETTE\nuniform vec4 vignetteSettings1;\nuniform vec4 vignetteSettings2;\n#endif\n#ifdef COLORCURVES\nuniform vec4 vCameraColorCurveNegative;\nuniform vec4 vCameraColorCurveNeutral;\nuniform vec4 vCameraColorCurvePositive;\n#endif\n#ifdef COLORGRADING\n#ifdef COLORGRADING3D\nuniform highp sampler3D txColorTransform;\n#else\nuniform sampler2D txColorTransform;\n#endif\nuniform vec4 colorTransformSettings;\n#endif\n#ifdef DITHER\nuniform float ditherIntensity;\n#endif\n";ve.v.IncludesShadersStore[Ze]=$e;const Je="imageProcessingFunctions",et="#if defined(COLORGRADING) && !defined(COLORGRADING3D)\n/** \n* Polyfill for SAMPLE_TEXTURE_3D,which is unsupported in WebGL.\n* sampler3dSetting.x=textureOffset (0.5/textureSize).\n* sampler3dSetting.y=textureSize.\n*/\n#define inline\nvec3 sampleTexture3D(sampler2D colorTransform,vec3 color,vec2 sampler3dSetting)\n{\nfloat sliceSize=2.0*sampler3dSetting.x; \n#ifdef SAMPLER3DGREENDEPTH\nfloat sliceContinuous=(color.g-sampler3dSetting.x)*sampler3dSetting.y;\n#else\nfloat sliceContinuous=(color.b-sampler3dSetting.x)*sampler3dSetting.y;\n#endif\nfloat sliceInteger=floor(sliceContinuous);\nfloat sliceFraction=sliceContinuous-sliceInteger;\n#ifdef SAMPLER3DGREENDEPTH\nvec2 sliceUV=color.rb;\n#else\nvec2 sliceUV=color.rg;\n#endif\nsliceUV.x*=sliceSize;\nsliceUV.x+=sliceInteger*sliceSize;\nsliceUV=saturate(sliceUV);\nvec4 slice0Color=texture2D(colorTransform,sliceUV);\nsliceUV.x+=sliceSize;\nsliceUV=saturate(sliceUV);\nvec4 slice1Color=texture2D(colorTransform,sliceUV);\nvec3 result=mix(slice0Color.rgb,slice1Color.rgb,sliceFraction);\n#ifdef SAMPLER3DBGRMAP\ncolor.rgb=result.rgb;\n#else\ncolor.rgb=result.bgr;\n#endif\nreturn color;\n}\n#endif\n#ifdef TONEMAPPING_ACES\nconst mat3 ACESInputMat=mat3(\nvec3(0.59719,0.07600,0.02840),\nvec3(0.35458,0.90834,0.13383),\nvec3(0.04823,0.01566,0.83777)\n);\nconst mat3 ACESOutputMat=mat3(\nvec3( 1.60475,-0.10208,-0.00327),\nvec3(-0.53108, 1.10813,-0.07276),\nvec3(-0.07367,-0.00605, 1.07602)\n);\nvec3 RRTAndODTFit(vec3 v)\n{\nvec3 a=v*(v+0.0245786)-0.000090537;\nvec3 b=v*(0.983729*v+0.4329510)+0.238081;\nreturn a/b;\n}\nvec3 ACESFitted(vec3 color)\n{\ncolor=ACESInputMat*color;\ncolor=RRTAndODTFit(color);\ncolor=ACESOutputMat*color;\ncolor=saturate(color);\nreturn color;\n}\n#endif\n#define CUSTOM_IMAGEPROCESSINGFUNCTIONS_DEFINITIONS\nvec4 applyImageProcessing(vec4 result) {\n#define CUSTOM_IMAGEPROCESSINGFUNCTIONS_UPDATERESULT_ATSTART\n#ifdef EXPOSURE\nresult.rgb*=exposureLinear;\n#endif\n#ifdef VIGNETTE\nvec2 viewportXY=gl_FragCoord.xy*vInverseScreenSize;\nviewportXY=viewportXY*2.0-1.0;\nvec3 vignetteXY1=vec3(viewportXY*vignetteSettings1.xy+vignetteSettings1.zw,1.0);\nfloat vignetteTerm=dot(vignetteXY1,vignetteXY1);\nfloat vignette=pow(vignetteTerm,vignetteSettings2.w);\nvec3 vignetteColor=vignetteSettings2.rgb;\n#ifdef VIGNETTEBLENDMODEMULTIPLY\nvec3 vignetteColorMultiplier=mix(vignetteColor,vec3(1,1,1),vignette);\nresult.rgb*=vignetteColorMultiplier;\n#endif\n#ifdef VIGNETTEBLENDMODEOPAQUE\nresult.rgb=mix(vignetteColor,result.rgb,vignette);\n#endif\n#endif\n#ifdef TONEMAPPING\n#ifdef TONEMAPPING_ACES\nresult.rgb=ACESFitted(result.rgb);\n#else\nconst float tonemappingCalibration=1.590579;\nresult.rgb=1.0-exp2(-tonemappingCalibration*result.rgb);\n#endif\n#endif\nresult.rgb=toGammaSpace(result.rgb);\nresult.rgb=saturate(result.rgb);\n#ifdef CONTRAST\nvec3 resultHighContrast=result.rgb*result.rgb*(3.0-2.0*result.rgb);\nif (contrast<1.0) {\nresult.rgb=mix(vec3(0.5,0.5,0.5),result.rgb,contrast);\n} else {\nresult.rgb=mix(result.rgb,resultHighContrast,contrast-1.0);\n}\n#endif\n#ifdef COLORGRADING\nvec3 colorTransformInput=result.rgb*colorTransformSettings.xxx+colorTransformSettings.yyy;\n#ifdef COLORGRADING3D\nvec3 colorTransformOutput=texture(txColorTransform,colorTransformInput).rgb;\n#else\nvec3 colorTransformOutput=sampleTexture3D(txColorTransform,colorTransformInput,colorTransformSettings.yz).rgb;\n#endif\nresult.rgb=mix(result.rgb,colorTransformOutput,colorTransformSettings.www);\n#endif\n#ifdef COLORCURVES\nfloat luma=getLuminance(result.rgb);\nvec2 curveMix=clamp(vec2(luma*3.0-1.5,luma*-3.0+1.5),vec2(0.0),vec2(1.0));\nvec4 colorCurve=vCameraColorCurveNeutral+curveMix.x*vCameraColorCurvePositive-curveMix.y*vCameraColorCurveNegative;\nresult.rgb*=colorCurve.rgb;\nresult.rgb=mix(vec3(luma),result.rgb,colorCurve.a);\n#endif\n#ifdef DITHER\nfloat rand=getRand(gl_FragCoord.xy*vInverseScreenSize);\nfloat dither=mix(-ditherIntensity,ditherIntensity,rand);\nresult.rgb=saturate(result.rgb+vec3(dither));\n#endif\n#define CUSTOM_IMAGEPROCESSINGFUNCTIONS_UPDATERESULT_ATEND\nreturn result;\n}";ve.v.IncludesShadersStore[Je]=et;const tt="bumpFragmentMainFunctions",it="#if defined(BUMP) || defined(CLEARCOAT_BUMP) || defined(ANISOTROPIC) || defined(DETAIL)\n#if defined(TANGENT) && defined(NORMAL) \nvarying mat3 vTBN;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\nuniform mat4 normalMatrix;\n#if defined(WEBGL2) || defined(WEBGPU)\nmat4 toNormalMatrix(mat4 wMatrix)\n{\nmat4 ret=inverse(wMatrix);\nret=transpose(ret);\nret[0][3]=0.;\nret[1][3]=0.;\nret[2][3]=0.;\nret[3]=vec4(0.,0.,0.,1.);\nreturn ret;\n}\n#else\nmat4 toNormalMatrix(mat4 m)\n{\nfloat\na00=m[0][0],a01=m[0][1],a02=m[0][2],a03=m[0][3],\na10=m[1][0],a11=m[1][1],a12=m[1][2],a13=m[1][3],\na20=m[2][0],a21=m[2][1],a22=m[2][2],a23=m[2][3],\na30=m[3][0],a31=m[3][1],a32=m[3][2],a33=m[3][3],\nb00=a00*a11-a01*a10,\nb01=a00*a12-a02*a10,\nb02=a00*a13-a03*a10,\nb03=a01*a12-a02*a11,\nb04=a01*a13-a03*a11,\nb05=a02*a13-a03*a12,\nb06=a20*a31-a21*a30,\nb07=a20*a32-a22*a30,\nb08=a20*a33-a23*a30,\nb09=a21*a32-a22*a31,\nb10=a21*a33-a23*a31,\nb11=a22*a33-a23*a32,\ndet=b00*b11-b01*b10+b02*b09+b03*b08-b04*b07+b05*b06;\nmat4 mi=mat4(\na11*b11-a12*b10+a13*b09,\na02*b10-a01*b11-a03*b09,\na31*b05-a32*b04+a33*b03,\na22*b04-a21*b05-a23*b03,\na12*b08-a10*b11-a13*b07,\na00*b11-a02*b08+a03*b07,\na32*b02-a30*b05-a33*b01,\na20*b05-a22*b02+a23*b01,\na10*b10-a11*b08+a13*b06,\na01*b08-a00*b10-a03*b06,\na30*b04-a31*b02+a33*b00,\na21*b02-a20*b04-a23*b00,\na11*b07-a10*b09-a12*b06,\na00*b09-a01*b07+a02*b06,\na31*b01-a30*b03-a32*b00,\na20*b03-a21*b01+a22*b00)/det;\nreturn mat4(mi[0][0],mi[1][0],mi[2][0],mi[3][0],\nmi[0][1],mi[1][1],mi[2][1],mi[3][1],\nmi[0][2],mi[1][2],mi[2][2],mi[3][2],\nmi[0][3],mi[1][3],mi[2][3],mi[3][3]);\n}\n#endif\n#endif\nvec3 perturbNormalBase(mat3 cotangentFrame,vec3 normal,float scale)\n{\n#ifdef NORMALXYSCALE\nnormal=normalize(normal*vec3(scale,scale,1.0));\n#endif\nreturn normalize(cotangentFrame*normal);\n}\nvec3 perturbNormal(mat3 cotangentFrame,vec3 textureSample,float scale)\n{\nreturn perturbNormalBase(cotangentFrame,textureSample*2.0-1.0,scale);\n}\nmat3 cotangent_frame(vec3 normal,vec3 p,vec2 uv,vec2 tangentSpaceParams)\n{\nvec3 dp1=dFdx(p);\nvec3 dp2=dFdy(p);\nvec2 duv1=dFdx(uv);\nvec2 duv2=dFdy(uv);\nvec3 dp2perp=cross(dp2,normal);\nvec3 dp1perp=cross(normal,dp1);\nvec3 tangent=dp2perp*duv1.x+dp1perp*duv2.x;\nvec3 bitangent=dp2perp*duv1.y+dp1perp*duv2.y;\ntangent*=tangentSpaceParams.x;\nbitangent*=tangentSpaceParams.y;\nfloat det=max(dot(tangent,tangent),dot(bitangent,bitangent));\nfloat invmax=det==0.0 ? 0.0 : inversesqrt(det);\nreturn mat3(tangent*invmax,bitangent*invmax,normal);\n}\n#endif\n";ve.v.IncludesShadersStore[tt]=it;const st="bumpFragmentFunctions",nt="#if defined(BUMP)\n#include<samplerFragmentDeclaration>(_DEFINENAME_,BUMP,_VARYINGNAME_,Bump,_SAMPLERNAME_,bump)\n#endif\n#if defined(DETAIL)\n#include<samplerFragmentDeclaration>(_DEFINENAME_,DETAIL,_VARYINGNAME_,Detail,_SAMPLERNAME_,detail)\n#endif\n#if defined(BUMP) && defined(PARALLAX)\nconst float minSamples=4.;\nconst float maxSamples=15.;\nconst int iMaxSamples=15;\nvec2 parallaxOcclusion(vec3 vViewDirCoT,vec3 vNormalCoT,vec2 texCoord,float parallaxScale) {\nfloat parallaxLimit=length(vViewDirCoT.xy)/vViewDirCoT.z;\nparallaxLimit*=parallaxScale;\nvec2 vOffsetDir=normalize(vViewDirCoT.xy);\nvec2 vMaxOffset=vOffsetDir*parallaxLimit;\nfloat numSamples=maxSamples+(dot(vViewDirCoT,vNormalCoT)*(minSamples-maxSamples));\nfloat stepSize=1.0/numSamples;\nfloat currRayHeight=1.0;\nvec2 vCurrOffset=vec2(0,0);\nvec2 vLastOffset=vec2(0,0);\nfloat lastSampledHeight=1.0;\nfloat currSampledHeight=1.0;\nbool keepWorking=true;\nfor (int i=0; i<iMaxSamples; i++)\n{\ncurrSampledHeight=texture2D(bumpSampler,texCoord+vCurrOffset).w;\nif (!keepWorking)\n{\n}\nelse if (currSampledHeight>currRayHeight)\n{\nfloat delta1=currSampledHeight-currRayHeight;\nfloat delta2=(currRayHeight+stepSize)-lastSampledHeight;\nfloat ratio=delta1/(delta1+delta2);\nvCurrOffset=(ratio)* vLastOffset+(1.0-ratio)*vCurrOffset;\nkeepWorking=false;\n}\nelse\n{\ncurrRayHeight-=stepSize;\nvLastOffset=vCurrOffset;\nvCurrOffset+=stepSize*vMaxOffset;\nlastSampledHeight=currSampledHeight;\n}\n}\nreturn vCurrOffset;\n}\nvec2 parallaxOffset(vec3 viewDir,float heightScale)\n{\nfloat height=texture2D(bumpSampler,vBumpUV).w;\nvec2 texCoordOffset=heightScale*viewDir.xy*height;\nreturn -texCoordOffset;\n}\n#endif\n";ve.v.IncludesShadersStore[st]=nt;const rt="clipPlaneFragmentDeclaration",at="#ifdef CLIPPLANE\nvarying float fClipDistance;\n#endif\n#ifdef CLIPPLANE2\nvarying float fClipDistance2;\n#endif\n#ifdef CLIPPLANE3\nvarying float fClipDistance3;\n#endif\n#ifdef CLIPPLANE4\nvarying float fClipDistance4;\n#endif\n#ifdef CLIPPLANE5\nvarying float fClipDistance5;\n#endif\n#ifdef CLIPPLANE6\nvarying float fClipDistance6;\n#endif\n";ve.v.IncludesShadersStore[rt]=at;const ot="logDepthDeclaration",lt="#ifdef LOGARITHMICDEPTH\nuniform float logarithmicDepthConstant;\nvarying float vFragmentDepth;\n#endif\n";ve.v.IncludesShadersStore[ot]=lt;const ht="fogFragmentDeclaration",ct="#ifdef FOG\n#define FOGMODE_NONE 0.\n#define FOGMODE_EXP 1.\n#define FOGMODE_EXP2 2.\n#define FOGMODE_LINEAR 3.\n#define E 2.71828\nuniform vec4 vFogInfos;\nuniform vec3 vFogColor;\nvarying vec3 vFogDistance;\nfloat CalcFogFactor()\n{\nfloat fogCoeff=1.0;\nfloat fogStart=vFogInfos.y;\nfloat fogEnd=vFogInfos.z;\nfloat fogDensity=vFogInfos.w;\nfloat fogDistance=length(vFogDistance);\nif (FOGMODE_LINEAR==vFogInfos.x)\n{\nfogCoeff=(fogEnd-fogDistance)/(fogEnd-fogStart);\n}\nelse if (FOGMODE_EXP==vFogInfos.x)\n{\nfogCoeff=1.0/pow(E,fogDistance*fogDensity);\n}\nelse if (FOGMODE_EXP2==vFogInfos.x)\n{\nfogCoeff=1.0/pow(E,fogDistance*fogDistance*fogDensity*fogDensity);\n}\nreturn clamp(fogCoeff,0.0,1.0);\n}\n#endif\n";ve.v.IncludesShadersStore[ht]=ct;const ut="clipPlaneFragment",dt="#if defined(CLIPPLANE) || defined(CLIPPLANE2) || defined(CLIPPLANE3) || defined(CLIPPLANE4) || defined(CLIPPLANE5) || defined(CLIPPLANE6)\nif (false) {}\n#endif\n#ifdef CLIPPLANE\nelse if (fClipDistance>0.0)\n{\ndiscard;\n}\n#endif\n#ifdef CLIPPLANE2\nelse if (fClipDistance2>0.0)\n{\ndiscard;\n}\n#endif\n#ifdef CLIPPLANE3\nelse if (fClipDistance3>0.0)\n{\ndiscard;\n}\n#endif\n#ifdef CLIPPLANE4\nelse if (fClipDistance4>0.0)\n{\ndiscard;\n}\n#endif\n#ifdef CLIPPLANE5\nelse if (fClipDistance5>0.0)\n{\ndiscard;\n}\n#endif\n#ifdef CLIPPLANE6\nelse if (fClipDistance6>0.0)\n{\ndiscard;\n}\n#endif\n";ve.v.IncludesShadersStore[ut]=dt;const ft="bumpFragment",pt="vec2 uvOffset=vec2(0.0,0.0);\n#if defined(BUMP) || defined(PARALLAX) || defined(DETAIL)\n#ifdef NORMALXYSCALE\nfloat normalScale=1.0;\n#elif defined(BUMP)\nfloat normalScale=vBumpInfos.y;\n#else\nfloat normalScale=1.0;\n#endif\n#if defined(TANGENT) && defined(NORMAL)\nmat3 TBN=vTBN;\n#elif defined(BUMP)\nvec2 TBNUV=gl_FrontFacing ? vBumpUV : -vBumpUV;\nmat3 TBN=cotangent_frame(normalW*normalScale,vPositionW,TBNUV,vTangentSpaceParams);\n#else\nvec2 TBNUV=gl_FrontFacing ? vDetailUV : -vDetailUV;\nmat3 TBN=cotangent_frame(normalW*normalScale,vPositionW,TBNUV,vec2(1.,1.));\n#endif\n#elif defined(ANISOTROPIC)\n#if defined(TANGENT) && defined(NORMAL)\nmat3 TBN=vTBN;\n#else\nvec2 TBNUV=gl_FrontFacing ? vMainUV1 : -vMainUV1;\nmat3 TBN=cotangent_frame(normalW,vPositionW,TBNUV,vec2(1.,1.));\n#endif\n#endif\n#ifdef PARALLAX\nmat3 invTBN=transposeMat3(TBN);\n#ifdef PARALLAXOCCLUSION\nuvOffset=parallaxOcclusion(invTBN*-viewDirectionW,invTBN*normalW,vBumpUV,vBumpInfos.z);\n#else\nuvOffset=parallaxOffset(invTBN*viewDirectionW,vBumpInfos.z);\n#endif\n#endif\n#ifdef DETAIL\nvec4 detailColor=texture2D(detailSampler,vDetailUV+uvOffset);\nvec2 detailNormalRG=detailColor.wy*2.0-1.0;\nfloat detailNormalB=sqrt(1.-saturate(dot(detailNormalRG,detailNormalRG)));\nvec3 detailNormal=vec3(detailNormalRG,detailNormalB);\n#endif\n#ifdef BUMP\n#ifdef OBJECTSPACE_NORMALMAP\n#define CUSTOM_FRAGMENT_BUMP_FRAGMENT\nnormalW=normalize(texture2D(bumpSampler,vBumpUV).xyz *2.0-1.0);\nnormalW=normalize(mat3(normalMatrix)*normalW);\n#elif !defined(DETAIL)\nnormalW=perturbNormal(TBN,texture2D(bumpSampler,vBumpUV+uvOffset).xyz,vBumpInfos.y);\n#else\nvec3 bumpNormal=texture2D(bumpSampler,vBumpUV+uvOffset).xyz*2.0-1.0;\n#if DETAIL_NORMALBLENDMETHOD==0 \ndetailNormal.xy*=vDetailInfos.z;\nvec3 blendedNormal=normalize(vec3(bumpNormal.xy+detailNormal.xy,bumpNormal.z*detailNormal.z));\n#elif DETAIL_NORMALBLENDMETHOD==1 \ndetailNormal.xy*=vDetailInfos.z;\nbumpNormal+=vec3(0.0,0.0,1.0);\ndetailNormal*=vec3(-1.0,-1.0,1.0);\nvec3 blendedNormal=bumpNormal*dot(bumpNormal,detailNormal)/bumpNormal.z-detailNormal;\n#endif\nnormalW=perturbNormalBase(TBN,blendedNormal,vBumpInfos.y);\n#endif\n#elif defined(DETAIL)\ndetailNormal.xy*=vDetailInfos.z;\nnormalW=perturbNormalBase(TBN,detailNormal,vDetailInfos.z);\n#endif\n";ve.v.IncludesShadersStore[ft]=pt;const gt="decalFragment",mt="#ifdef DECAL\n#ifdef GAMMADECAL\ndecalColor.rgb=toLinearSpace(decalColor.rgb);\n#endif\n#ifdef DECAL_SMOOTHALPHA\ndecalColor.a*=decalColor.a;\n#endif\nsurfaceAlbedo.rgb=mix(surfaceAlbedo.rgb,decalColor.rgb,decalColor.a);\n#endif\n";ve.v.IncludesShadersStore[gt]=mt;const _t="depthPrePass",vt="#ifdef DEPTHPREPASS\ngl_FragColor=vec4(0.,0.,0.,1.0);\nreturn;\n#endif\n";ve.v.IncludesShadersStore[_t]=vt;const bt="lightFragment",Et="#ifdef LIGHT{X}\n#if defined(SHADOWONLY) || defined(LIGHTMAP) && defined(LIGHTMAPEXCLUDED{X}) && defined(LIGHTMAPNOSPECULAR{X})\n#else\n#ifdef PBR\n#ifdef SPOTLIGHT{X}\npreInfo=computePointAndSpotPreLightingInfo(light{X}.vLightData,viewDirectionW,normalW);\n#elif defined(POINTLIGHT{X})\npreInfo=computePointAndSpotPreLightingInfo(light{X}.vLightData,viewDirectionW,normalW);\n#elif defined(HEMILIGHT{X})\npreInfo=computeHemisphericPreLightingInfo(light{X}.vLightData,viewDirectionW,normalW);\n#elif defined(DIRLIGHT{X})\npreInfo=computeDirectionalPreLightingInfo(light{X}.vLightData,viewDirectionW,normalW);\n#endif\npreInfo.NdotV=NdotV;\n#ifdef SPOTLIGHT{X}\n#ifdef LIGHT_FALLOFF_GLTF{X}\npreInfo.attenuation=computeDistanceLightFalloff_GLTF(preInfo.lightDistanceSquared,light{X}.vLightFalloff.y);\npreInfo.attenuation*=computeDirectionalLightFalloff_GLTF(light{X}.vLightDirection.xyz,preInfo.L,light{X}.vLightFalloff.z,light{X}.vLightFalloff.w);\n#elif defined(LIGHT_FALLOFF_PHYSICAL{X})\npreInfo.attenuation=computeDistanceLightFalloff_Physical(preInfo.lightDistanceSquared);\npreInfo.attenuation*=computeDirectionalLightFalloff_Physical(light{X}.vLightDirection.xyz,preInfo.L,light{X}.vLightDirection.w);\n#elif defined(LIGHT_FALLOFF_STANDARD{X})\npreInfo.attenuation=computeDistanceLightFalloff_Standard(preInfo.lightOffset,light{X}.vLightFalloff.x);\npreInfo.attenuation*=computeDirectionalLightFalloff_Standard(light{X}.vLightDirection.xyz,preInfo.L,light{X}.vLightDirection.w,light{X}.vLightData.w);\n#else\npreInfo.attenuation=computeDistanceLightFalloff(preInfo.lightOffset,preInfo.lightDistanceSquared,light{X}.vLightFalloff.x,light{X}.vLightFalloff.y);\npreInfo.attenuation*=computeDirectionalLightFalloff(light{X}.vLightDirection.xyz,preInfo.L,light{X}.vLightDirection.w,light{X}.vLightData.w,light{X}.vLightFalloff.z,light{X}.vLightFalloff.w);\n#endif\n#elif defined(POINTLIGHT{X})\n#ifdef LIGHT_FALLOFF_GLTF{X}\npreInfo.attenuation=computeDistanceLightFalloff_GLTF(preInfo.lightDistanceSquared,light{X}.vLightFalloff.y);\n#elif defined(LIGHT_FALLOFF_PHYSICAL{X})\npreInfo.attenuation=computeDistanceLightFalloff_Physical(preInfo.lightDistanceSquared);\n#elif defined(LIGHT_FALLOFF_STANDARD{X})\npreInfo.attenuation=computeDistanceLightFalloff_Standard(preInfo.lightOffset,light{X}.vLightFalloff.x);\n#else\npreInfo.attenuation=computeDistanceLightFalloff(preInfo.lightOffset,preInfo.lightDistanceSquared,light{X}.vLightFalloff.x,light{X}.vLightFalloff.y);\n#endif\n#else\npreInfo.attenuation=1.0;\n#endif\n#ifdef HEMILIGHT{X}\npreInfo.roughness=roughness;\n#else\npreInfo.roughness=adjustRoughnessFromLightProperties(roughness,light{X}.vLightSpecular.a,preInfo.lightDistance);\n#endif\n#ifdef IRIDESCENCE\npreInfo.iridescenceIntensity=iridescenceIntensity;\n#endif\n#ifdef HEMILIGHT{X}\ninfo.diffuse=computeHemisphericDiffuseLighting(preInfo,light{X}.vLightDiffuse.rgb,light{X}.vLightGround);\n#elif defined(SS_TRANSLUCENCY)\ninfo.diffuse=computeDiffuseAndTransmittedLighting(preInfo,light{X}.vLightDiffuse.rgb,subSurfaceOut.transmittance);\n#else\ninfo.diffuse=computeDiffuseLighting(preInfo,light{X}.vLightDiffuse.rgb);\n#endif\n#ifdef SPECULARTERM\n#ifdef ANISOTROPIC\ninfo.specular=computeAnisotropicSpecularLighting(preInfo,viewDirectionW,normalW,anisotropicOut.anisotropicTangent,anisotropicOut.anisotropicBitangent,anisotropicOut.anisotropy,clearcoatOut.specularEnvironmentR0,specularEnvironmentR90,AARoughnessFactors.x,light{X}.vLightDiffuse.rgb);\n#else\ninfo.specular=computeSpecularLighting(preInfo,normalW,clearcoatOut.specularEnvironmentR0,specularEnvironmentR90,AARoughnessFactors.x,light{X}.vLightDiffuse.rgb);\n#endif\n#endif\n#ifdef SHEEN\n#ifdef SHEEN_LINKWITHALBEDO\npreInfo.roughness=sheenOut.sheenIntensity;\n#else\n#ifdef HEMILIGHT{X}\npreInfo.roughness=sheenOut.sheenRoughness;\n#else\npreInfo.roughness=adjustRoughnessFromLightProperties(sheenOut.sheenRoughness,light{X}.vLightSpecular.a,preInfo.lightDistance);\n#endif\n#endif\ninfo.sheen=computeSheenLighting(preInfo,normalW,sheenOut.sheenColor,specularEnvironmentR90,AARoughnessFactors.x,light{X}.vLightDiffuse.rgb);\n#endif\n#ifdef CLEARCOAT\n#ifdef HEMILIGHT{X}\npreInfo.roughness=clearcoatOut.clearCoatRoughness;\n#else\npreInfo.roughness=adjustRoughnessFromLightProperties(clearcoatOut.clearCoatRoughness,light{X}.vLightSpecular.a,preInfo.lightDistance);\n#endif\ninfo.clearCoat=computeClearCoatLighting(preInfo,clearcoatOut.clearCoatNormalW,clearcoatOut.clearCoatAARoughnessFactors.x,clearcoatOut.clearCoatIntensity,light{X}.vLightDiffuse.rgb);\n#ifdef CLEARCOAT_TINT\nabsorption=computeClearCoatLightingAbsorption(clearcoatOut.clearCoatNdotVRefract,preInfo.L,clearcoatOut.clearCoatNormalW,clearcoatOut.clearCoatColor,clearcoatOut.clearCoatThickness,clearcoatOut.clearCoatIntensity);\ninfo.diffuse*=absorption;\n#ifdef SPECULARTERM\ninfo.specular*=absorption;\n#endif\n#endif\ninfo.diffuse*=info.clearCoat.w;\n#ifdef SPECULARTERM\ninfo.specular*=info.clearCoat.w;\n#endif\n#ifdef SHEEN\ninfo.sheen*=info.clearCoat.w;\n#endif\n#endif\n#else\n#ifdef SPOTLIGHT{X}\ninfo=computeSpotLighting(viewDirectionW,normalW,light{X}.vLightData,light{X}.vLightDirection,light{X}.vLightDiffuse.rgb,light{X}.vLightSpecular.rgb,light{X}.vLightDiffuse.a,glossiness);\n#elif defined(HEMILIGHT{X})\ninfo=computeHemisphericLighting(viewDirectionW,normalW,light{X}.vLightData,light{X}.vLightDiffuse.rgb,light{X}.vLightSpecular.rgb,light{X}.vLightGround,glossiness);\n#elif defined(POINTLIGHT{X}) || defined(DIRLIGHT{X})\ninfo=computeLighting(viewDirectionW,normalW,light{X}.vLightData,light{X}.vLightDiffuse.rgb,light{X}.vLightSpecular.rgb,light{X}.vLightDiffuse.a,glossiness);\n#endif\n#endif\n#ifdef PROJECTEDLIGHTTEXTURE{X}\ninfo.diffuse*=computeProjectionTextureDiffuseLighting(projectionLightSampler{X},textureProjectionMatrix{X});\n#endif\n#endif\n#ifdef SHADOW{X}\n#ifdef SHADOWCSM{X}\nfor (int i=0; i<SHADOWCSMNUM_CASCADES{X}; i++) \n{\n#ifdef SHADOWCSM_RIGHTHANDED{X}\ndiff{X}=viewFrustumZ{X}[i]+vPositionFromCamera{X}.z;\n#else\ndiff{X}=viewFrustumZ{X}[i]-vPositionFromCamera{X}.z;\n#endif\nif (diff{X}>=0.) {\nindex{X}=i;\nbreak;\n}\n}\n#ifdef SHADOWCSMUSESHADOWMAXZ{X}\nif (index{X}>=0)\n#endif\n{\n#if defined(SHADOWPCF{X})\n#if defined(SHADOWLOWQUALITY{X})\nshadow=computeShadowWithCSMPCF1(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],shadowSampler{X},light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);\n#elif defined(SHADOWMEDIUMQUALITY{X})\nshadow=computeShadowWithCSMPCF3(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],shadowSampler{X},light{X}.shadowsInfo.yz,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);\n#else\nshadow=computeShadowWithCSMPCF5(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],shadowSampler{X},light{X}.shadowsInfo.yz,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);\n#endif\n#elif defined(SHADOWPCSS{X})\n#if defined(SHADOWLOWQUALITY{X})\nshadow=computeShadowWithCSMPCSS16(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],depthSampler{X},shadowSampler{X},light{X}.shadowsInfo.y,light{X}.shadowsInfo.z,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w,lightSizeUVCorrection{X}[index{X}],depthCorrection{X}[index{X}],penumbraDarkness{X});\n#elif defined(SHADOWMEDIUMQUALITY{X})\nshadow=computeShadowWithCSMPCSS32(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],depthSampler{X},shadowSampler{X},light{X}.shadowsInfo.y,light{X}.shadowsInfo.z,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w,lightSizeUVCorrection{X}[index{X}],depthCorrection{X}[index{X}],penumbraDarkness{X});\n#else\nshadow=computeShadowWithCSMPCSS64(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],depthSampler{X},shadowSampler{X},light{X}.shadowsInfo.y,light{X}.shadowsInfo.z,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w,lightSizeUVCorrection{X}[index{X}],depthCorrection{X}[index{X}],penumbraDarkness{X});\n#endif\n#else\nshadow=computeShadowCSM(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],shadowSampler{X},light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);\n#endif\n#ifdef SHADOWCSMDEBUG{X}\nshadowDebug{X}=vec3(shadow)*vCascadeColorsMultiplier{X}[index{X}];\n#endif\n#ifndef SHADOWCSMNOBLEND{X}\nfloat frustumLength=frustumLengths{X}[index{X}];\nfloat diffRatio=clamp(diff{X}/frustumLength,0.,1.)*cascadeBlendFactor{X};\nif (index{X}<(SHADOWCSMNUM_CASCADES{X}-1) && diffRatio<1.)\n{\nindex{X}+=1;\nfloat nextShadow=0.;\n#if defined(SHADOWPCF{X})\n#if defined(SHADOWLOWQUALITY{X})\nnextShadow=computeShadowWithCSMPCF1(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],shadowSampler{X},light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);\n#elif defined(SHADOWMEDIUMQUALITY{X})\nnextShadow=computeShadowWithCSMPCF3(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],shadowSampler{X},light{X}.shadowsInfo.yz,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);\n#else\nnextShadow=computeShadowWithCSMPCF5(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],shadowSampler{X},light{X}.shadowsInfo.yz,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);\n#endif\n#elif defined(SHADOWPCSS{X})\n#if defined(SHADOWLOWQUALITY{X})\nnextShadow=computeShadowWithCSMPCSS16(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],depthSampler{X},shadowSampler{X},light{X}.shadowsInfo.y,light{X}.shadowsInfo.z,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w,lightSizeUVCorrection{X}[index{X}],depthCorrection{X}[index{X}],penumbraDarkness{X});\n#elif defined(SHADOWMEDIUMQUALITY{X})\nnextShadow=computeShadowWithCSMPCSS32(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],depthSampler{X},shadowSampler{X},light{X}.shadowsInfo.y,light{X}.shadowsInfo.z,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w,lightSizeUVCorrection{X}[index{X}],depthCorrection{X}[index{X}],penumbraDarkness{X});\n#else\nnextShadow=computeShadowWithCSMPCSS64(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],depthSampler{X},shadowSampler{X},light{X}.shadowsInfo.y,light{X}.shadowsInfo.z,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w,lightSizeUVCorrection{X}[index{X}],depthCorrection{X}[index{X}],penumbraDarkness{X});\n#endif\n#else\nnextShadow=computeShadowCSM(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],shadowSampler{X},light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);\n#endif\nshadow=mix(nextShadow,shadow,diffRatio);\n#ifdef SHADOWCSMDEBUG{X}\nshadowDebug{X}=mix(vec3(nextShadow)*vCascadeColorsMultiplier{X}[index{X}],shadowDebug{X},diffRatio);\n#endif\n}\n#endif\n}\n#elif defined(SHADOWCLOSEESM{X})\n#if defined(SHADOWCUBE{X})\nshadow=computeShadowWithCloseESMCube(light{X}.vLightData.xyz,shadowSampler{X},light{X}.shadowsInfo.x,light{X}.shadowsInfo.z,light{X}.depthValues);\n#else\nshadow=computeShadowWithCloseESM(vPositionFromLight{X},vDepthMetric{X},shadowSampler{X},light{X}.shadowsInfo.x,light{X}.shadowsInfo.z,light{X}.shadowsInfo.w);\n#endif\n#elif defined(SHADOWESM{X})\n#if defined(SHADOWCUBE{X})\nshadow=computeShadowWithESMCube(light{X}.vLightData.xyz,shadowSampler{X},light{X}.shadowsInfo.x,light{X}.shadowsInfo.z,light{X}.depthValues);\n#else\nshadow=computeShadowWithESM(vPositionFromLight{X},vDepthMetric{X},shadowSampler{X},light{X}.shadowsInfo.x,light{X}.shadowsInfo.z,light{X}.shadowsInfo.w);\n#endif\n#elif defined(SHADOWPOISSON{X})\n#if defined(SHADOWCUBE{X})\nshadow=computeShadowWithPoissonSamplingCube(light{X}.vLightData.xyz,shadowSampler{X},light{X}.shadowsInfo.y,light{X}.shadowsInfo.x,light{X}.depthValues);\n#else\nshadow=computeShadowWithPoissonSampling(vPositionFromLight{X},vDepthMetric{X},shadowSampler{X},light{X}.shadowsInfo.y,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);\n#endif\n#elif defined(SHADOWPCF{X})\n#if defined(SHADOWLOWQUALITY{X})\nshadow=computeShadowWithPCF1(vPositionFromLight{X},vDepthMetric{X},shadowSampler{X},light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);\n#elif defined(SHADOWMEDIUMQUALITY{X})\nshadow=computeShadowWithPCF3(vPositionFromLight{X},vDepthMetric{X},shadowSampler{X},light{X}.shadowsInfo.yz,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);\n#else\nshadow=computeShadowWithPCF5(vPositionFromLight{X},vDepthMetric{X},shadowSampler{X},light{X}.shadowsInfo.yz,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);\n#endif\n#elif defined(SHADOWPCSS{X})\n#if defined(SHADOWLOWQUALITY{X})\nshadow=computeShadowWithPCSS16(vPositionFromLight{X},vDepthMetric{X},depthSampler{X},shadowSampler{X},light{X}.shadowsInfo.y,light{X}.shadowsInfo.z,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);\n#elif defined(SHADOWMEDIUMQUALITY{X})\nshadow=computeShadowWithPCSS32(vPositionFromLight{X},vDepthMetric{X},depthSampler{X},shadowSampler{X},light{X}.shadowsInfo.y,light{X}.shadowsInfo.z,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);\n#else\nshadow=computeShadowWithPCSS64(vPositionFromLight{X},vDepthMetric{X},depthSampler{X},shadowSampler{X},light{X}.shadowsInfo.y,light{X}.shadowsInfo.z,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);\n#endif\n#else\n#if defined(SHADOWCUBE{X})\nshadow=computeShadowCube(light{X}.vLightData.xyz,shadowSampler{X},light{X}.shadowsInfo.x,light{X}.depthValues);\n#else\nshadow=computeShadow(vPositionFromLight{X},vDepthMetric{X},shadowSampler{X},light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);\n#endif\n#endif\n#ifdef SHADOWONLY\n#ifndef SHADOWINUSE\n#define SHADOWINUSE\n#endif\nglobalShadow+=shadow;\nshadowLightCount+=1.0;\n#endif\n#else\nshadow=1.;\n#endif\n#ifndef SHADOWONLY\n#ifdef CUSTOMUSERLIGHTING\ndiffuseBase+=computeCustomDiffuseLighting(info,diffuseBase,shadow);\n#ifdef SPECULARTERM\nspecularBase+=computeCustomSpecularLighting(info,specularBase,shadow);\n#endif\n#elif defined(LIGHTMAP) && defined(LIGHTMAPEXCLUDED{X})\ndiffuseBase+=lightmapColor.rgb*shadow;\n#ifdef SPECULARTERM\n#ifndef LIGHTMAPNOSPECULAR{X}\nspecularBase+=info.specular*shadow*lightmapColor.rgb;\n#endif\n#endif\n#ifdef CLEARCOAT\n#ifndef LIGHTMAPNOSPECULAR{X}\nclearCoatBase+=info.clearCoat.rgb*shadow*lightmapColor.rgb;\n#endif\n#endif\n#ifdef SHEEN\n#ifndef LIGHTMAPNOSPECULAR{X}\nsheenBase+=info.sheen.rgb*shadow;\n#endif\n#endif\n#else\n#ifdef SHADOWCSMDEBUG{X}\ndiffuseBase+=info.diffuse*shadowDebug{X};\n#else \ndiffuseBase+=info.diffuse*shadow;\n#endif\n#ifdef SPECULARTERM\nspecularBase+=info.specular*shadow;\n#endif\n#ifdef CLEARCOAT\nclearCoatBase+=info.clearCoat.rgb*shadow;\n#endif\n#ifdef SHEEN\nsheenBase+=info.sheen.rgb*shadow;\n#endif\n#endif\n#endif\n#endif\n";ve.v.IncludesShadersStore[bt]=Et;const yt="logDepthFragment",Mt="#ifdef LOGARITHMICDEPTH\ngl_FragDepthEXT=log2(vFragmentDepth)*logarithmicDepthConstant*0.5;\n#endif\n";ve.v.IncludesShadersStore[yt]=Mt;const Tt="fogFragment",At="#ifdef FOG\nfloat fog=CalcFogFactor();\n#ifdef PBR\nfog=toLinearSpace(fog);\n#endif\ncolor.rgb=mix(vFogColor,color.rgb,fog);\n#endif\n";ve.v.IncludesShadersStore[Tt]=At;const St="oitFragment",It="#ifdef ORDER_INDEPENDENT_TRANSPARENCY\nfloat fragDepth=gl_FragCoord.z; \n#ifdef ORDER_INDEPENDENT_TRANSPARENCY_16BITS\nuint halfFloat=packHalf2x16(vec2(fragDepth));\nvec2 full=unpackHalf2x16(halfFloat);\nfragDepth=full.x;\n#endif\nivec2 fragCoord=ivec2(gl_FragCoord.xy);\nvec2 lastDepth=texelFetch(oitDepthSampler,fragCoord,0).rg;\nvec4 lastFrontColor=texelFetch(oitFrontColorSampler,fragCoord,0);\ndepth.rg=vec2(-MAX_DEPTH);\nfrontColor=lastFrontColor;\nbackColor=vec4(0.0);\n#ifdef USE_REVERSE_DEPTHBUFFER\nfloat furthestDepth=-lastDepth.x;\nfloat nearestDepth=lastDepth.y;\n#else\nfloat nearestDepth=-lastDepth.x;\nfloat furthestDepth=lastDepth.y;\n#endif\nfloat alphaMultiplier=1.0-lastFrontColor.a;\n#ifdef USE_REVERSE_DEPTHBUFFER\nif (fragDepth>nearestDepth || fragDepth<furthestDepth) {\n#else\nif (fragDepth<nearestDepth || fragDepth>furthestDepth) {\n#endif\nreturn;\n}\n#ifdef USE_REVERSE_DEPTHBUFFER\nif (fragDepth<nearestDepth && fragDepth>furthestDepth) {\n#else\nif (fragDepth>nearestDepth && fragDepth<furthestDepth) {\n#endif\ndepth.rg=vec2(-fragDepth,fragDepth);\nreturn;\n}\n#endif\n";ve.v.IncludesShadersStore[St]=It;const Ct="defaultPixelShader",Dt="#include<__decl__defaultFragment>\n#if defined(BUMP) || !defined(NORMAL)\n#extension GL_OES_standard_derivatives : enable\n#endif\n#include<prePassDeclaration>[SCENE_MRT_COUNT]\n#include<oitDeclaration>\n#define CUSTOM_FRAGMENT_BEGIN\n#ifdef LOGARITHMICDEPTH\n#extension GL_EXT_frag_depth : enable\n#endif\n#define RECIPROCAL_PI2 0.15915494\nvarying vec3 vPositionW;\n#ifdef NORMAL\nvarying vec3 vNormalW;\n#endif\n#if defined(VERTEXCOLOR) || defined(INSTANCESCOLOR) && defined(INSTANCES)\nvarying vec4 vColor;\n#endif\n#include<mainUVVaryingDeclaration>[1..7]\n#include<helperFunctions>\n#include<__decl__lightFragment>[0..maxSimultaneousLights]\n#include<lightsFragmentFunctions>\n#include<shadowsFragmentFunctions>\n#include<samplerFragmentDeclaration>(_DEFINENAME_,DIFFUSE,_VARYINGNAME_,Diffuse,_SAMPLERNAME_,diffuse)\n#include<samplerFragmentDeclaration>(_DEFINENAME_,AMBIENT,_VARYINGNAME_,Ambient,_SAMPLERNAME_,ambient)\n#include<samplerFragmentDeclaration>(_DEFINENAME_,OPACITY,_VARYINGNAME_,Opacity,_SAMPLERNAME_,opacity)\n#include<samplerFragmentDeclaration>(_DEFINENAME_,EMISSIVE,_VARYINGNAME_,Emissive,_SAMPLERNAME_,emissive)\n#include<samplerFragmentDeclaration>(_DEFINENAME_,LIGHTMAP,_VARYINGNAME_,Lightmap,_SAMPLERNAME_,lightmap)\n#include<samplerFragmentDeclaration>(_DEFINENAME_,DECAL,_VARYINGNAME_,Decal,_SAMPLERNAME_,decal)\n#ifdef REFRACTION\n#ifdef REFRACTIONMAP_3D\nuniform samplerCube refractionCubeSampler;\n#else\nuniform sampler2D refraction2DSampler;\n#endif\n#endif\n#if defined(SPECULARTERM)\n#include<samplerFragmentDeclaration>(_DEFINENAME_,SPECULAR,_VARYINGNAME_,Specular,_SAMPLERNAME_,specular)\n#endif\n#include<fresnelFunction>\n#ifdef REFLECTION\n#ifdef REFLECTIONMAP_3D\nuniform samplerCube reflectionCubeSampler;\n#else\nuniform sampler2D reflection2DSampler;\n#endif\n#ifdef REFLECTIONMAP_SKYBOX\nvarying vec3 vPositionUVW;\n#else\n#if defined(REFLECTIONMAP_EQUIRECTANGULAR_FIXED) || defined(REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED)\nvarying vec3 vDirectionW;\n#endif\n#endif\n#include<reflectionFunction>\n#endif\n#include<imageProcessingDeclaration>\n#include<imageProcessingFunctions>\n#include<bumpFragmentMainFunctions>\n#include<bumpFragmentFunctions>\n#include<clipPlaneFragmentDeclaration>\n#include<logDepthDeclaration>\n#include<fogFragmentDeclaration>\n#define CUSTOM_FRAGMENT_DEFINITIONS\nvoid main(void) {\n#define CUSTOM_FRAGMENT_MAIN_BEGIN\n#include<clipPlaneFragment>\nvec3 viewDirectionW=normalize(vEyePosition.xyz-vPositionW);\nvec4 baseColor=vec4(1.,1.,1.,1.);\nvec3 diffuseColor=vDiffuseColor.rgb;\nfloat alpha=vDiffuseColor.a;\n#ifdef NORMAL\nvec3 normalW=normalize(vNormalW);\n#else\nvec3 normalW=normalize(-cross(dFdx(vPositionW),dFdy(vPositionW)));\n#endif\n#include<bumpFragment>\n#ifdef TWOSIDEDLIGHTING\nnormalW=gl_FrontFacing ? normalW : -normalW;\n#endif\n#ifdef DIFFUSE\nbaseColor=texture2D(diffuseSampler,vDiffuseUV+uvOffset);\n#if defined(ALPHATEST) && !defined(ALPHATEST_AFTERALLALPHACOMPUTATIONS)\nif (baseColor.a<alphaCutOff)\ndiscard;\n#endif\n#ifdef ALPHAFROMDIFFUSE\nalpha*=baseColor.a;\n#endif\n#define CUSTOM_FRAGMENT_UPDATE_ALPHA\nbaseColor.rgb*=vDiffuseInfos.y;\n#endif\n#ifdef DECAL\nvec4 decalColor=texture2D(decalSampler,vDecalUV+uvOffset);\n#include<decalFragment>(surfaceAlbedo,baseColor,GAMMADECAL,_GAMMADECAL_NOTUSED_)\n#endif\n#include<depthPrePass>\n#if defined(VERTEXCOLOR) || defined(INSTANCESCOLOR) && defined(INSTANCES)\nbaseColor.rgb*=vColor.rgb;\n#endif\n#ifdef DETAIL\nbaseColor.rgb=baseColor.rgb*2.0*mix(0.5,detailColor.r,vDetailInfos.y);\n#endif\n#define CUSTOM_FRAGMENT_UPDATE_DIFFUSE\nvec3 baseAmbientColor=vec3(1.,1.,1.);\n#ifdef AMBIENT\nbaseAmbientColor=texture2D(ambientSampler,vAmbientUV+uvOffset).rgb*vAmbientInfos.y;\n#endif\n#define CUSTOM_FRAGMENT_BEFORE_LIGHTS\n#ifdef SPECULARTERM\nfloat glossiness=vSpecularColor.a;\nvec3 specularColor=vSpecularColor.rgb;\n#ifdef SPECULAR\nvec4 specularMapColor=texture2D(specularSampler,vSpecularUV+uvOffset);\nspecularColor=specularMapColor.rgb;\n#ifdef GLOSSINESS\nglossiness=glossiness*specularMapColor.a;\n#endif\n#endif\n#else\nfloat glossiness=0.;\n#endif\nvec3 diffuseBase=vec3(0.,0.,0.);\nlightingInfo info;\n#ifdef SPECULARTERM\nvec3 specularBase=vec3(0.,0.,0.);\n#endif\nfloat shadow=1.;\n#ifdef LIGHTMAP\nvec4 lightmapColor=texture2D(lightmapSampler,vLightmapUV+uvOffset);\n#ifdef RGBDLIGHTMAP\nlightmapColor.rgb=fromRGBD(lightmapColor);\n#endif\nlightmapColor.rgb*=vLightmapInfos.y;\n#endif\n#include<lightFragment>[0..maxSimultaneousLights]\nvec4 refractionColor=vec4(0.,0.,0.,1.);\n#ifdef REFRACTION\nvec3 refractionVector=normalize(refract(-viewDirectionW,normalW,vRefractionInfos.y));\n#ifdef REFRACTIONMAP_3D\n#ifdef USE_LOCAL_REFRACTIONMAP_CUBIC\nrefractionVector=parallaxCorrectNormal(vPositionW,refractionVector,vRefractionSize,vRefractionPosition);\n#endif\nrefractionVector.y=refractionVector.y*vRefractionInfos.w;\nif (dot(refractionVector,viewDirectionW)<1.0) {\nrefractionColor=textureCube(refractionCubeSampler,refractionVector);\n}\n#else\nvec3 vRefractionUVW=vec3(refractionMatrix*(view*vec4(vPositionW+refractionVector*vRefractionInfos.z,1.0)));\nvec2 refractionCoords=vRefractionUVW.xy/vRefractionUVW.z;\nrefractionCoords.y=1.0-refractionCoords.y;\nrefractionColor=texture2D(refraction2DSampler,refractionCoords);\n#endif\n#ifdef RGBDREFRACTION\nrefractionColor.rgb=fromRGBD(refractionColor);\n#endif\n#ifdef IS_REFRACTION_LINEAR\nrefractionColor.rgb=toGammaSpace(refractionColor.rgb);\n#endif\nrefractionColor.rgb*=vRefractionInfos.x;\n#endif\nvec4 reflectionColor=vec4(0.,0.,0.,1.);\n#ifdef REFLECTION\nvec3 vReflectionUVW=computeReflectionCoords(vec4(vPositionW,1.0),normalW);\n#ifdef REFLECTIONMAP_OPPOSITEZ\nvReflectionUVW.z*=-1.0;\n#endif\n#ifdef REFLECTIONMAP_3D\n#ifdef ROUGHNESS\nfloat bias=vReflectionInfos.y;\n#ifdef SPECULARTERM\n#ifdef SPECULAR\n#ifdef GLOSSINESS\nbias*=(1.0-specularMapColor.a);\n#endif\n#endif\n#endif\nreflectionColor=textureCube(reflectionCubeSampler,vReflectionUVW,bias);\n#else\nreflectionColor=textureCube(reflectionCubeSampler,vReflectionUVW);\n#endif\n#else\nvec2 coords=vReflectionUVW.xy;\n#ifdef REFLECTIONMAP_PROJECTION\ncoords/=vReflectionUVW.z;\n#endif\ncoords.y=1.0-coords.y;\nreflectionColor=texture2D(reflection2DSampler,coords);\n#endif\n#ifdef RGBDREFLECTION\nreflectionColor.rgb=fromRGBD(reflectionColor);\n#endif\n#ifdef IS_REFLECTION_LINEAR\nreflectionColor.rgb=toGammaSpace(reflectionColor.rgb);\n#endif\nreflectionColor.rgb*=vReflectionInfos.x;\n#ifdef REFLECTIONFRESNEL\nfloat reflectionFresnelTerm=computeFresnelTerm(viewDirectionW,normalW,reflectionRightColor.a,reflectionLeftColor.a);\n#ifdef REFLECTIONFRESNELFROMSPECULAR\n#ifdef SPECULARTERM\nreflectionColor.rgb*=specularColor.rgb*(1.0-reflectionFresnelTerm)+reflectionFresnelTerm*reflectionRightColor.rgb;\n#else\nreflectionColor.rgb*=reflectionLeftColor.rgb*(1.0-reflectionFresnelTerm)+reflectionFresnelTerm*reflectionRightColor.rgb;\n#endif\n#else\nreflectionColor.rgb*=reflectionLeftColor.rgb*(1.0-reflectionFresnelTerm)+reflectionFresnelTerm*reflectionRightColor.rgb;\n#endif\n#endif\n#endif\n#ifdef REFRACTIONFRESNEL\nfloat refractionFresnelTerm=computeFresnelTerm(viewDirectionW,normalW,refractionRightColor.a,refractionLeftColor.a);\nrefractionColor.rgb*=refractionLeftColor.rgb*(1.0-refractionFresnelTerm)+refractionFresnelTerm*refractionRightColor.rgb;\n#endif\n#ifdef OPACITY\nvec4 opacityMap=texture2D(opacitySampler,vOpacityUV+uvOffset);\n#ifdef OPACITYRGB\nopacityMap.rgb=opacityMap.rgb*vec3(0.3,0.59,0.11);\nalpha*=(opacityMap.x+opacityMap.y+opacityMap.z)* vOpacityInfos.y;\n#else\nalpha*=opacityMap.a*vOpacityInfos.y;\n#endif\n#endif\n#if defined(VERTEXALPHA) || defined(INSTANCESCOLOR) && defined(INSTANCES)\nalpha*=vColor.a;\n#endif\n#ifdef OPACITYFRESNEL\nfloat opacityFresnelTerm=computeFresnelTerm(viewDirectionW,normalW,opacityParts.z,opacityParts.w);\nalpha+=opacityParts.x*(1.0-opacityFresnelTerm)+opacityFresnelTerm*opacityParts.y;\n#endif\n#ifdef ALPHATEST\n#ifdef ALPHATEST_AFTERALLALPHACOMPUTATIONS\nif (alpha<alphaCutOff)\ndiscard;\n#endif\n#ifndef ALPHABLEND\nalpha=1.0;\n#endif\n#endif\nvec3 emissiveColor=vEmissiveColor;\n#ifdef EMISSIVE\nemissiveColor+=texture2D(emissiveSampler,vEmissiveUV+uvOffset).rgb*vEmissiveInfos.y;\n#endif\n#ifdef EMISSIVEFRESNEL\nfloat emissiveFresnelTerm=computeFresnelTerm(viewDirectionW,normalW,emissiveRightColor.a,emissiveLeftColor.a);\nemissiveColor*=emissiveLeftColor.rgb*(1.0-emissiveFresnelTerm)+emissiveFresnelTerm*emissiveRightColor.rgb;\n#endif\n#ifdef DIFFUSEFRESNEL\nfloat diffuseFresnelTerm=computeFresnelTerm(viewDirectionW,normalW,diffuseRightColor.a,diffuseLeftColor.a);\ndiffuseBase*=diffuseLeftColor.rgb*(1.0-diffuseFresnelTerm)+diffuseFresnelTerm*diffuseRightColor.rgb;\n#endif\n#ifdef EMISSIVEASILLUMINATION\nvec3 finalDiffuse=clamp(diffuseBase*diffuseColor+vAmbientColor,0.0,1.0)*baseColor.rgb;\n#else\n#ifdef LINKEMISSIVEWITHDIFFUSE\nvec3 finalDiffuse=clamp((diffuseBase+emissiveColor)*diffuseColor+vAmbientColor,0.0,1.0)*baseColor.rgb;\n#else\nvec3 finalDiffuse=clamp(diffuseBase*diffuseColor+emissiveColor+vAmbientColor,0.0,1.0)*baseColor.rgb;\n#endif\n#endif\n#ifdef SPECULARTERM\nvec3 finalSpecular=specularBase*specularColor;\n#ifdef SPECULAROVERALPHA\nalpha=clamp(alpha+dot(finalSpecular,vec3(0.3,0.59,0.11)),0.,1.);\n#endif\n#else\nvec3 finalSpecular=vec3(0.0);\n#endif\n#ifdef REFLECTIONOVERALPHA\nalpha=clamp(alpha+dot(reflectionColor.rgb,vec3(0.3,0.59,0.11)),0.,1.);\n#endif\n#ifdef EMISSIVEASILLUMINATION\nvec4 color=vec4(clamp(finalDiffuse*baseAmbientColor+finalSpecular+reflectionColor.rgb+emissiveColor+refractionColor.rgb,0.0,1.0),alpha);\n#else\nvec4 color=vec4(finalDiffuse*baseAmbientColor+finalSpecular+reflectionColor.rgb+refractionColor.rgb,alpha);\n#endif\n#ifdef LIGHTMAP\n#ifndef LIGHTMAPEXCLUDED\n#ifdef USELIGHTMAPASSHADOWMAP\ncolor.rgb*=lightmapColor.rgb;\n#else\ncolor.rgb+=lightmapColor.rgb;\n#endif\n#endif\n#endif\n#define CUSTOM_FRAGMENT_BEFORE_FOG\ncolor.rgb=max(color.rgb,0.);\n#include<logDepthFragment>\n#include<fogFragment>\n#ifdef IMAGEPROCESSINGPOSTPROCESS\ncolor.rgb=toLinearSpace(color.rgb);\n#else\n#ifdef IMAGEPROCESSING\ncolor.rgb=toLinearSpace(color.rgb);\ncolor=applyImageProcessing(color);\n#endif\n#endif\ncolor.a*=visibility;\n#ifdef PREMULTIPLYALPHA\ncolor.rgb*=color.a;\n#endif\n#define CUSTOM_FRAGMENT_BEFORE_FRAGCOLOR\n#ifdef PREPASS\nfloat writeGeometryInfo=color.a>0.4 ? 1.0 : 0.0;\ngl_FragData[0]=color; \n#ifdef PREPASS_POSITION\ngl_FragData[PREPASS_POSITION_INDEX]=vec4(vPositionW,writeGeometryInfo);\n#endif\n#ifdef PREPASS_VELOCITY\nvec2 a=(vCurrentPosition.xy/vCurrentPosition.w)*0.5+0.5;\nvec2 b=(vPreviousPosition.xy/vPreviousPosition.w)*0.5+0.5;\nvec2 velocity=abs(a-b);\nvelocity=vec2(pow(velocity.x,1.0/3.0),pow(velocity.y,1.0/3.0))*sign(a-b)*0.5+0.5;\ngl_FragData[PREPASS_VELOCITY_INDEX]=vec4(velocity,0.0,writeGeometryInfo);\n#endif\n#ifdef PREPASS_IRRADIANCE\ngl_FragData[PREPASS_IRRADIANCE_INDEX]=vec4(0.0,0.0,0.0,writeGeometryInfo); \n#endif\n#ifdef PREPASS_DEPTH\ngl_FragData[PREPASS_DEPTH_INDEX]=vec4(vViewPos.z,0.0,0.0,writeGeometryInfo); \n#endif\n#ifdef PREPASS_NORMAL\ngl_FragData[PREPASS_NORMAL_INDEX]=vec4(normalize((view*vec4(normalW,0.0)).rgb),writeGeometryInfo); \n#endif\n#ifdef PREPASS_ALBEDO_SQRT\ngl_FragData[PREPASS_ALBEDO_SQRT_INDEX]=vec4(0.0,0.0,0.0,writeGeometryInfo); \n#endif\n#ifdef PREPASS_REFLECTIVITY\n#if defined(SPECULARTERM)\n#if defined(SPECULAR)\ngl_FragData[PREPASS_REFLECTIVITY_INDEX]=vec4(toLinearSpace(specularMapColor))*writeGeometryInfo; \n#else\ngl_FragData[PREPASS_REFLECTIVITY_INDEX]=vec4(toLinearSpace(specularColor),1.0)*writeGeometryInfo;\n#endif\n#else\ngl_FragData[PREPASS_REFLECTIVITY_INDEX]=vec4(0.0,0.0,0.0,1.0)*writeGeometryInfo;\n#endif\n#endif\n#endif\n#if !defined(PREPASS) || defined(WEBGL2)\ngl_FragColor=color;\n#endif\n#include<oitFragment>\n#if ORDER_INDEPENDENT_TRANSPARENCY\nif (fragDepth==nearestDepth) {\nfrontColor.rgb+=color.rgb*color.a*alphaMultiplier;\nfrontColor.a=1.0-alphaMultiplier*(1.0-color.a);\n} else {\nbackColor+=color;\n}\n#endif\n#define CUSTOM_FRAGMENT_MAIN_END\n}\n";ve.v.ShadersStore[Ct]=Dt;const Pt="decalVertexDeclaration",xt="#ifdef DECAL\nuniform vec4 vDecalInfos;\nuniform mat4 decalMatrix;\n#endif\n";ve.v.IncludesShadersStore[Pt]=xt;const Rt="defaultVertexDeclaration",Ot="uniform mat4 viewProjection;\nuniform mat4 view;\n#ifdef DIFFUSE\nuniform mat4 diffuseMatrix;\nuniform vec2 vDiffuseInfos;\n#endif\n#ifdef AMBIENT\nuniform mat4 ambientMatrix;\nuniform vec2 vAmbientInfos;\n#endif\n#ifdef OPACITY\nuniform mat4 opacityMatrix;\nuniform vec2 vOpacityInfos;\n#endif\n#ifdef EMISSIVE\nuniform vec2 vEmissiveInfos;\nuniform mat4 emissiveMatrix;\n#endif\n#ifdef LIGHTMAP\nuniform vec2 vLightmapInfos;\nuniform mat4 lightmapMatrix;\n#endif\n#if defined(SPECULAR) && defined(SPECULARTERM)\nuniform vec2 vSpecularInfos;\nuniform mat4 specularMatrix;\n#endif\n#ifdef BUMP\nuniform vec3 vBumpInfos;\nuniform mat4 bumpMatrix;\n#endif\n#ifdef REFLECTION\nuniform mat4 reflectionMatrix;\n#endif\n#ifdef POINTSIZE\nuniform float pointSize;\n#endif\n#ifdef DETAIL\nuniform vec4 vDetailInfos;\nuniform mat4 detailMatrix;\n#endif\n#include<decalVertexDeclaration>\n#define ADDITIONAL_VERTEX_DECLARATION\n";ve.v.IncludesShadersStore[Rt]=Ot;const Nt="uvAttributeDeclaration",wt="#ifdef UV{X}\nattribute vec2 uv{X};\n#endif\n";ve.v.IncludesShadersStore[Nt]=wt;const Lt="bonesDeclaration",Ft="#if NUM_BONE_INFLUENCERS>0\nattribute vec4 matricesIndices;\nattribute vec4 matricesWeights;\n#if NUM_BONE_INFLUENCERS>4\nattribute vec4 matricesIndicesExtra;\nattribute vec4 matricesWeightsExtra;\n#endif\n#ifndef BAKED_VERTEX_ANIMATION_TEXTURE\n#ifdef BONETEXTURE\nuniform sampler2D boneSampler;\nuniform float boneTextureWidth;\n#else\nuniform mat4 mBones[BonesPerMesh];\n#ifdef BONES_VELOCITY_ENABLED\nuniform mat4 mPreviousBones[BonesPerMesh];\n#endif\n#endif\n#ifdef BONETEXTURE\n#define inline\nmat4 readMatrixFromRawSampler(sampler2D smp,float index)\n{\nfloat offset=index *4.0;\nfloat dx=1.0/boneTextureWidth;\nvec4 m0=texture2D(smp,vec2(dx*(offset+0.5),0.));\nvec4 m1=texture2D(smp,vec2(dx*(offset+1.5),0.));\nvec4 m2=texture2D(smp,vec2(dx*(offset+2.5),0.));\nvec4 m3=texture2D(smp,vec2(dx*(offset+3.5),0.));\nreturn mat4(m0,m1,m2,m3);\n}\n#endif\n#endif\n#endif\n";ve.v.IncludesShadersStore[Lt]=Ft;const Bt="bakedVertexAnimationDeclaration",Ut="#ifdef BAKED_VERTEX_ANIMATION_TEXTURE\nuniform float bakedVertexAnimationTime;\nuniform vec2 bakedVertexAnimationTextureSizeInverted;\nuniform vec4 bakedVertexAnimationSettings;\nuniform sampler2D bakedVertexAnimationTexture;\n#ifdef INSTANCES\nattribute vec4 bakedVertexAnimationSettingsInstanced;\n#endif\n#define inline\nmat4 readMatrixFromRawSamplerVAT(sampler2D smp,float index,float frame)\n{\nfloat offset=index*4.0;\nfloat frameUV=(frame+0.5)*bakedVertexAnimationTextureSizeInverted.y;\nfloat dx=bakedVertexAnimationTextureSizeInverted.x;\nvec4 m0=texture2D(smp,vec2(dx*(offset+0.5),frameUV));\nvec4 m1=texture2D(smp,vec2(dx*(offset+1.5),frameUV));\nvec4 m2=texture2D(smp,vec2(dx*(offset+2.5),frameUV));\nvec4 m3=texture2D(smp,vec2(dx*(offset+3.5),frameUV));\nreturn mat4(m0,m1,m2,m3);\n}\n#endif\n";ve.v.IncludesShadersStore[Bt]=Ut;const kt="instancesDeclaration",Vt="#ifdef INSTANCES\nattribute vec4 world0;\nattribute vec4 world1;\nattribute vec4 world2;\nattribute vec4 world3;\n#ifdef INSTANCESCOLOR\nattribute vec4 instanceColor;\n#endif\n#if defined(THIN_INSTANCES) && !defined(WORLD_UBO)\nuniform mat4 world;\n#endif\n#if defined(VELOCITY) || defined(PREPASS_VELOCITY)\nattribute vec4 previousWorld0;\nattribute vec4 previousWorld1;\nattribute vec4 previousWorld2;\nattribute vec4 previousWorld3;\n#ifdef THIN_INSTANCES\nuniform mat4 previousWorld;\n#endif\n#endif\n#else\n#if !defined(WORLD_UBO)\nuniform mat4 world;\n#endif\n#if defined(VELOCITY) || defined(PREPASS_VELOCITY)\nuniform mat4 previousWorld;\n#endif\n#endif\n";ve.v.IncludesShadersStore[kt]=Vt;const Gt="prePassVertexDeclaration",Wt="#ifdef PREPASS\n#ifdef PREPASS_DEPTH\nvarying vec3 vViewPos;\n#endif\n#ifdef PREPASS_VELOCITY\nuniform mat4 previousViewProjection;\nvarying vec4 vCurrentPosition;\nvarying vec4 vPreviousPosition;\n#endif\n#endif\n";ve.v.IncludesShadersStore[Gt]=Wt;const zt="samplerVertexDeclaration",Ht="#if defined(_DEFINENAME_) && _DEFINENAME_DIRECTUV==0\nvarying vec2 v_VARYINGNAME_UV;\n#endif\n";ve.v.IncludesShadersStore[zt]=Ht;const Xt="bumpVertexDeclaration",jt="#if defined(BUMP) || defined(PARALLAX) || defined(CLEARCOAT_BUMP) || defined(ANISOTROPIC)\n#if defined(TANGENT) && defined(NORMAL) \nvarying mat3 vTBN;\n#endif\n#endif\n";ve.v.IncludesShadersStore[Xt]=jt;const Yt="clipPlaneVertexDeclaration",qt="#ifdef CLIPPLANE\nuniform vec4 vClipPlane;\nvarying float fClipDistance;\n#endif\n#ifdef CLIPPLANE2\nuniform vec4 vClipPlane2;\nvarying float fClipDistance2;\n#endif\n#ifdef CLIPPLANE3\nuniform vec4 vClipPlane3;\nvarying float fClipDistance3;\n#endif\n#ifdef CLIPPLANE4\nuniform vec4 vClipPlane4;\nvarying float fClipDistance4;\n#endif\n#ifdef CLIPPLANE5\nuniform vec4 vClipPlane5;\nvarying float fClipDistance5;\n#endif\n#ifdef CLIPPLANE6\nuniform vec4 vClipPlane6;\nvarying float fClipDistance6;\n#endif\n";ve.v.IncludesShadersStore[Yt]=qt;const Kt="fogVertexDeclaration",Qt="#ifdef FOG\nvarying vec3 vFogDistance;\n#endif\n";ve.v.IncludesShadersStore[Kt]=Qt;const Zt="lightVxFragmentDeclaration",$t="#ifdef LIGHT{X}\nuniform vec4 vLightData{X};\nuniform vec4 vLightDiffuse{X};\n#ifdef SPECULARTERM\nuniform vec4 vLightSpecular{X};\n#else\nvec4 vLightSpecular{X}=vec4(0.);\n#endif\n#ifdef SHADOW{X}\n#ifdef SHADOWCSM{X}\nuniform mat4 lightMatrix{X}[SHADOWCSMNUM_CASCADES{X}];\nvarying vec4 vPositionFromLight{X}[SHADOWCSMNUM_CASCADES{X}];\nvarying float vDepthMetric{X}[SHADOWCSMNUM_CASCADES{X}];\nvarying vec4 vPositionFromCamera{X};\n#elif defined(SHADOWCUBE{X})\n#else\nvarying vec4 vPositionFromLight{X};\nvarying float vDepthMetric{X};\nuniform mat4 lightMatrix{X};\n#endif\nuniform vec4 shadowsInfo{X};\nuniform vec2 depthValues{X};\n#endif\n#ifdef SPOTLIGHT{X}\nuniform vec4 vLightDirection{X};\nuniform vec4 vLightFalloff{X};\n#elif defined(POINTLIGHT{X})\nuniform vec4 vLightFalloff{X};\n#elif defined(HEMILIGHT{X})\nuniform vec3 vLightGround{X};\n#endif\n#endif\n";ve.v.IncludesShadersStore[Zt]=$t;const Jt="lightVxUboDeclaration",ei="#ifdef LIGHT{X}\nuniform Light{X}\n{\nvec4 vLightData;\nvec4 vLightDiffuse;\nvec4 vLightSpecular;\n#ifdef SPOTLIGHT{X}\nvec4 vLightDirection;\nvec4 vLightFalloff;\n#elif defined(POINTLIGHT{X})\nvec4 vLightFalloff;\n#elif defined(HEMILIGHT{X})\nvec3 vLightGround;\n#endif\nvec4 shadowsInfo;\nvec2 depthValues;\n} light{X};\n#ifdef SHADOW{X}\n#ifdef SHADOWCSM{X}\nuniform mat4 lightMatrix{X}[SHADOWCSMNUM_CASCADES{X}];\nvarying vec4 vPositionFromLight{X}[SHADOWCSMNUM_CASCADES{X}];\nvarying float vDepthMetric{X}[SHADOWCSMNUM_CASCADES{X}];\nvarying vec4 vPositionFromCamera{X};\n#elif defined(SHADOWCUBE{X})\n#else\nvarying vec4 vPositionFromLight{X};\nvarying float vDepthMetric{X};\nuniform mat4 lightMatrix{X};\n#endif\n#endif\n#endif\n";ve.v.IncludesShadersStore[Jt]=ei;const ti="morphTargetsVertexGlobalDeclaration",ii="#ifdef MORPHTARGETS\nuniform float morphTargetInfluences[NUM_MORPH_INFLUENCERS];\n#ifdef MORPHTARGETS_TEXTURE \nprecision mediump sampler2DArray; \nuniform float morphTargetTextureIndices[NUM_MORPH_INFLUENCERS];\nuniform vec3 morphTargetTextureInfo;\nuniform sampler2DArray morphTargets;\nvec3 readVector3FromRawSampler(int targetIndex,float vertexIndex)\n{ \nfloat y=floor(vertexIndex/morphTargetTextureInfo.y);\nfloat x=vertexIndex-y*morphTargetTextureInfo.y;\nvec3 textureUV=vec3((x+0.5)/morphTargetTextureInfo.y,(y+0.5)/morphTargetTextureInfo.z,morphTargetTextureIndices[targetIndex]);\nreturn texture(morphTargets,textureUV).xyz;\n}\n#endif\n#endif\n";ve.v.IncludesShadersStore[ti]=ii;const si="morphTargetsVertexDeclaration",ni="#ifdef MORPHTARGETS\n#ifndef MORPHTARGETS_TEXTURE\nattribute vec3 position{X};\n#ifdef MORPHTARGETS_NORMAL\nattribute vec3 normal{X};\n#endif\n#ifdef MORPHTARGETS_TANGENT\nattribute vec3 tangent{X};\n#endif\n#ifdef MORPHTARGETS_UV\nattribute vec2 uv_{X};\n#endif\n#endif\n#endif\n";ve.v.IncludesShadersStore[si]=ni;const ri="morphTargetsVertexGlobal",ai="#ifdef MORPHTARGETS\n#ifdef MORPHTARGETS_TEXTURE\nfloat vertexID;\n#endif\n#endif\n";ve.v.IncludesShadersStore[ri]=ai;const oi="morphTargetsVertex",li="#ifdef MORPHTARGETS\n#ifdef MORPHTARGETS_TEXTURE \nvertexID=float(gl_VertexID)*morphTargetTextureInfo.x;\npositionUpdated+=(readVector3FromRawSampler({X},vertexID)-position)*morphTargetInfluences[{X}];\nvertexID+=1.0;\n#ifdef MORPHTARGETS_NORMAL\nnormalUpdated+=(readVector3FromRawSampler({X},vertexID) -normal)*morphTargetInfluences[{X}];\nvertexID+=1.0;\n#endif\n#ifdef MORPHTARGETS_UV\nuvUpdated+=(readVector3FromRawSampler({X},vertexID).xy-uv)*morphTargetInfluences[{X}];\nvertexID+=1.0;\n#endif\n#ifdef MORPHTARGETS_TANGENT\ntangentUpdated.xyz+=(readVector3FromRawSampler({X},vertexID) -tangent.xyz)*morphTargetInfluences[{X}];\n#endif\n#else\npositionUpdated+=(position{X}-position)*morphTargetInfluences[{X}];\n#ifdef MORPHTARGETS_NORMAL\nnormalUpdated+=(normal{X}-normal)*morphTargetInfluences[{X}];\n#endif\n#ifdef MORPHTARGETS_TANGENT\ntangentUpdated.xyz+=(tangent{X}-tangent.xyz)*morphTargetInfluences[{X}];\n#endif\n#ifdef MORPHTARGETS_UV\nuvUpdated+=(uv_{X}-uv)*morphTargetInfluences[{X}];\n#endif\n#endif\n#endif\n";ve.v.IncludesShadersStore[oi]=li;const hi="instancesVertex",ci="#ifdef INSTANCES\nmat4 finalWorld=mat4(world0,world1,world2,world3);\n#if defined(PREPASS_VELOCITY) || defined(VELOCITY)\nmat4 finalPreviousWorld=mat4(previousWorld0,previousWorld1,previousWorld2,previousWorld3);\n#endif\n#ifdef THIN_INSTANCES\nfinalWorld=world*finalWorld;\n#if defined(PREPASS_VELOCITY) || defined(VELOCITY)\nfinalPreviousWorld=previousWorld*finalPreviousWorld;\n#endif\n#endif\n#else\nmat4 finalWorld=world;\n#if defined(PREPASS_VELOCITY) || defined(VELOCITY)\nmat4 finalPreviousWorld=previousWorld;\n#endif\n#endif\n";ve.v.IncludesShadersStore[hi]=ci;const ui="bonesVertex",di="#ifndef BAKED_VERTEX_ANIMATION_TEXTURE\n#if NUM_BONE_INFLUENCERS>0\nmat4 influence;\n#ifdef BONETEXTURE\ninfluence=readMatrixFromRawSampler(boneSampler,matricesIndices[0])*matricesWeights[0];\n#if NUM_BONE_INFLUENCERS>1\ninfluence+=readMatrixFromRawSampler(boneSampler,matricesIndices[1])*matricesWeights[1];\n#endif\n#if NUM_BONE_INFLUENCERS>2\ninfluence+=readMatrixFromRawSampler(boneSampler,matricesIndices[2])*matricesWeights[2];\n#endif\n#if NUM_BONE_INFLUENCERS>3\ninfluence+=readMatrixFromRawSampler(boneSampler,matricesIndices[3])*matricesWeights[3];\n#endif\n#if NUM_BONE_INFLUENCERS>4\ninfluence+=readMatrixFromRawSampler(boneSampler,matricesIndicesExtra[0])*matricesWeightsExtra[0];\n#endif\n#if NUM_BONE_INFLUENCERS>5\ninfluence+=readMatrixFromRawSampler(boneSampler,matricesIndicesExtra[1])*matricesWeightsExtra[1];\n#endif\n#if NUM_BONE_INFLUENCERS>6\ninfluence+=readMatrixFromRawSampler(boneSampler,matricesIndicesExtra[2])*matricesWeightsExtra[2];\n#endif\n#if NUM_BONE_INFLUENCERS>7\ninfluence+=readMatrixFromRawSampler(boneSampler,matricesIndicesExtra[3])*matricesWeightsExtra[3];\n#endif\n#else\ninfluence=mBones[int(matricesIndices[0])]*matricesWeights[0];\n#if NUM_BONE_INFLUENCERS>1\ninfluence+=mBones[int(matricesIndices[1])]*matricesWeights[1];\n#endif\n#if NUM_BONE_INFLUENCERS>2\ninfluence+=mBones[int(matricesIndices[2])]*matricesWeights[2];\n#endif\n#if NUM_BONE_INFLUENCERS>3\ninfluence+=mBones[int(matricesIndices[3])]*matricesWeights[3];\n#endif\n#if NUM_BONE_INFLUENCERS>4\ninfluence+=mBones[int(matricesIndicesExtra[0])]*matricesWeightsExtra[0];\n#endif\n#if NUM_BONE_INFLUENCERS>5\ninfluence+=mBones[int(matricesIndicesExtra[1])]*matricesWeightsExtra[1];\n#endif\n#if NUM_BONE_INFLUENCERS>6\ninfluence+=mBones[int(matricesIndicesExtra[2])]*matricesWeightsExtra[2];\n#endif\n#if NUM_BONE_INFLUENCERS>7\ninfluence+=mBones[int(matricesIndicesExtra[3])]*matricesWeightsExtra[3];\n#endif\n#endif\nfinalWorld=finalWorld*influence;\n#endif\n#endif\n";ve.v.IncludesShadersStore[ui]=di;const fi="bakedVertexAnimation",pi="#ifdef BAKED_VERTEX_ANIMATION_TEXTURE\n{\n#ifdef INSTANCES\n#define BVASNAME bakedVertexAnimationSettingsInstanced\n#else\n#define BVASNAME bakedVertexAnimationSettings\n#endif\nfloat VATStartFrame=BVASNAME.x;\nfloat VATEndFrame=BVASNAME.y;\nfloat VATOffsetFrame=BVASNAME.z;\nfloat VATSpeed=BVASNAME.w;\nfloat totalFrames=VATEndFrame-VATStartFrame+1.0;\nfloat time=bakedVertexAnimationTime*VATSpeed/totalFrames;\nfloat frameCorrection=time<1.0 ? 0.0 : 1.0;\nfloat numOfFrames=totalFrames-frameCorrection;\nfloat VATFrameNum=fract(time)*numOfFrames;\nVATFrameNum=mod(VATFrameNum+VATOffsetFrame,numOfFrames);\nVATFrameNum=floor(VATFrameNum);\nVATFrameNum+=VATStartFrame+frameCorrection;\nmat4 VATInfluence;\nVATInfluence=readMatrixFromRawSamplerVAT(bakedVertexAnimationTexture,matricesIndices[0],VATFrameNum)*matricesWeights[0];\n#if NUM_BONE_INFLUENCERS>1\nVATInfluence+=readMatrixFromRawSamplerVAT(bakedVertexAnimationTexture,matricesIndices[1],VATFrameNum)*matricesWeights[1];\n#endif\n#if NUM_BONE_INFLUENCERS>2\nVATInfluence+=readMatrixFromRawSamplerVAT(bakedVertexAnimationTexture,matricesIndices[2],VATFrameNum)*matricesWeights[2];\n#endif\n#if NUM_BONE_INFLUENCERS>3\nVATInfluence+=readMatrixFromRawSamplerVAT(bakedVertexAnimationTexture,matricesIndices[3],VATFrameNum)*matricesWeights[3];\n#endif\n#if NUM_BONE_INFLUENCERS>4\nVATInfluence+=readMatrixFromRawSamplerVAT(bakedVertexAnimationTexture,matricesIndicesExtra[0],VATFrameNum)*matricesWeightsExtra[0];\n#endif\n#if NUM_BONE_INFLUENCERS>5\nVATInfluence+=readMatrixFromRawSamplerVAT(bakedVertexAnimationTexture,matricesIndicesExtra[1],VATFrameNum)*matricesWeightsExtra[1];\n#endif\n#if NUM_BONE_INFLUENCERS>6\nVATInfluence+=readMatrixFromRawSamplerVAT(bakedVertexAnimationTexture,matricesIndicesExtra[2],VATFrameNum)*matricesWeightsExtra[2];\n#endif\n#if NUM_BONE_INFLUENCERS>7\nVATInfluence+=readMatrixFromRawSamplerVAT(bakedVertexAnimationTexture,matricesIndicesExtra[3],VATFrameNum)*matricesWeightsExtra[3];\n#endif\nfinalWorld=finalWorld*VATInfluence;\n}\n#endif\n";ve.v.IncludesShadersStore[fi]=pi;const gi="prePassVertex",mi="#ifdef PREPASS_DEPTH\nvViewPos=(view*worldPos).rgb;\n#endif\n#if defined(PREPASS_VELOCITY) && defined(BONES_VELOCITY_ENABLED)\nvCurrentPosition=viewProjection*worldPos;\n#if NUM_BONE_INFLUENCERS>0\nmat4 previousInfluence;\npreviousInfluence=mPreviousBones[int(matricesIndices[0])]*matricesWeights[0];\n#if NUM_BONE_INFLUENCERS>1\npreviousInfluence+=mPreviousBones[int(matricesIndices[1])]*matricesWeights[1];\n#endif \n#if NUM_BONE_INFLUENCERS>2\npreviousInfluence+=mPreviousBones[int(matricesIndices[2])]*matricesWeights[2];\n#endif \n#if NUM_BONE_INFLUENCERS>3\npreviousInfluence+=mPreviousBones[int(matricesIndices[3])]*matricesWeights[3];\n#endif\n#if NUM_BONE_INFLUENCERS>4\npreviousInfluence+=mPreviousBones[int(matricesIndicesExtra[0])]*matricesWeightsExtra[0];\n#endif \n#if NUM_BONE_INFLUENCERS>5\npreviousInfluence+=mPreviousBones[int(matricesIndicesExtra[1])]*matricesWeightsExtra[1];\n#endif \n#if NUM_BONE_INFLUENCERS>6\npreviousInfluence+=mPreviousBones[int(matricesIndicesExtra[2])]*matricesWeightsExtra[2];\n#endif \n#if NUM_BONE_INFLUENCERS>7\npreviousInfluence+=mPreviousBones[int(matricesIndicesExtra[3])]*matricesWeightsExtra[3];\n#endif\nvPreviousPosition=previousViewProjection*finalPreviousWorld*previousInfluence*vec4(positionUpdated,1.0);\n#else\nvPreviousPosition=previousViewProjection*finalPreviousWorld*vec4(positionUpdated,1.0);\n#endif\n#endif\n";ve.v.IncludesShadersStore[gi]=mi;const _i="uvVariableDeclaration",vi="#if !defined(UV{X}) && defined(MAINUV{X})\nvec2 uv{X}=vec2(0.,0.);\n#endif\n#ifdef MAINUV{X}\nvMainUV{X}=uv{X};\n#endif\n";ve.v.IncludesShadersStore[_i]=vi;const bi="samplerVertexImplementation",Ei="#if defined(_DEFINENAME_) && _DEFINENAME_DIRECTUV==0\nif (v_INFONAME_==0.)\n{\nv_VARYINGNAME_UV=vec2(_MATRIXNAME_Matrix*vec4(uvUpdated,1.0,0.0));\n}\n#ifdef UV2\nelse if (v_INFONAME_==1.)\n{\nv_VARYINGNAME_UV=vec2(_MATRIXNAME_Matrix*vec4(uv2,1.0,0.0));\n}\n#endif\n#ifdef UV3\nelse if (v_INFONAME_==2.)\n{\nv_VARYINGNAME_UV=vec2(_MATRIXNAME_Matrix*vec4(uv3,1.0,0.0));\n}\n#endif\n#ifdef UV4\nelse if (v_INFONAME_==3.)\n{\nv_VARYINGNAME_UV=vec2(_MATRIXNAME_Matrix*vec4(uv4,1.0,0.0));\n}\n#endif\n#ifdef UV5\nelse if (v_INFONAME_==4.)\n{\nv_VARYINGNAME_UV=vec2(_MATRIXNAME_Matrix*vec4(uv5,1.0,0.0));\n}\n#endif\n#ifdef UV6\nelse if (v_INFONAME_==5.)\n{\nv_VARYINGNAME_UV=vec2(_MATRIXNAME_Matrix*vec4(uv6,1.0,0.0));\n}\n#endif\n#endif\n";ve.v.IncludesShadersStore[bi]=Ei;const yi="bumpVertex",Mi="#if defined(BUMP) || defined(PARALLAX) || defined(CLEARCOAT_BUMP) || defined(ANISOTROPIC)\n#if defined(TANGENT) && defined(NORMAL)\nvec3 tbnNormal=normalize(normalUpdated);\nvec3 tbnTangent=normalize(tangentUpdated.xyz);\nvec3 tbnBitangent=cross(tbnNormal,tbnTangent)*tangentUpdated.w;\nvTBN=mat3(finalWorld)*mat3(tbnTangent,tbnBitangent,tbnNormal);\n#endif\n#endif\n";ve.v.IncludesShadersStore[yi]=Mi;const Ti="clipPlaneVertex",Ai="#ifdef CLIPPLANE\nfClipDistance=dot(worldPos,vClipPlane);\n#endif\n#ifdef CLIPPLANE2\nfClipDistance2=dot(worldPos,vClipPlane2);\n#endif\n#ifdef CLIPPLANE3\nfClipDistance3=dot(worldPos,vClipPlane3);\n#endif\n#ifdef CLIPPLANE4\nfClipDistance4=dot(worldPos,vClipPlane4);\n#endif\n#ifdef CLIPPLANE5\nfClipDistance5=dot(worldPos,vClipPlane5);\n#endif\n#ifdef CLIPPLANE6\nfClipDistance6=dot(worldPos,vClipPlane6);\n#endif\n";ve.v.IncludesShadersStore[Ti]=Ai;const Si="fogVertex",Ii="#ifdef FOG\nvFogDistance=(view*worldPos).xyz;\n#endif\n";ve.v.IncludesShadersStore[Si]=Ii;const Ci="shadowsVertex",Di="#ifdef SHADOWS\n#if defined(SHADOWCSM{X})\nvPositionFromCamera{X}=view*worldPos;\nfor (int i=0; i<SHADOWCSMNUM_CASCADES{X}; i++) {\nvPositionFromLight{X}[i]=lightMatrix{X}[i]*worldPos;\n#ifdef USE_REVERSE_DEPTHBUFFER\nvDepthMetric{X}[i]=(-vPositionFromLight{X}[i].z+light{X}.depthValues.x)/light{X}.depthValues.y;\n#else\nvDepthMetric{X}[i]=(vPositionFromLight{X}[i].z+light{X}.depthValues.x)/light{X}.depthValues.y;\n#endif\n}\n#elif defined(SHADOW{X}) && !defined(SHADOWCUBE{X})\nvPositionFromLight{X}=lightMatrix{X}*worldPos;\n#ifdef USE_REVERSE_DEPTHBUFFER\nvDepthMetric{X}=(-vPositionFromLight{X}.z+light{X}.depthValues.x)/light{X}.depthValues.y;\n#else\nvDepthMetric{X}=(vPositionFromLight{X}.z+light{X}.depthValues.x)/light{X}.depthValues.y;\n#endif\n#endif\n#endif\n";ve.v.IncludesShadersStore[Ci]=Di;const Pi="vertexColorMixing",xi="#if defined(VERTEXCOLOR) || defined(INSTANCESCOLOR) && defined(INSTANCES)\nvColor=vec4(1.0);\n#ifdef VERTEXCOLOR\n#ifdef VERTEXALPHA\nvColor*=color;\n#else\nvColor.rgb*=color.rgb;\n#endif\n#endif\n#ifdef INSTANCESCOLOR\nvColor*=instanceColor;\n#endif\n#endif\n";ve.v.IncludesShadersStore[Pi]=xi;const Ri="pointCloudVertex",Oi="#if defined(POINTSIZE) && !defined(WEBGPU)\ngl_PointSize=pointSize;\n#endif\n";ve.v.IncludesShadersStore[Ri]=Oi;const Ni="logDepthVertex",wi="#ifdef LOGARITHMICDEPTH\nvFragmentDepth=1.0+gl_Position.w;\ngl_Position.z=log2(max(0.000001,vFragmentDepth))*logarithmicDepthConstant;\n#endif\n";ve.v.IncludesShadersStore[Ni]=wi;const Li="defaultVertexShader",Fi="#include<__decl__defaultVertex>\n#define CUSTOM_VERTEX_BEGIN\nattribute vec3 position;\n#ifdef NORMAL\nattribute vec3 normal;\n#endif\n#ifdef TANGENT\nattribute vec4 tangent;\n#endif\n#ifdef UV1\nattribute vec2 uv;\n#endif\n#include<uvAttributeDeclaration>[2..7]\n#ifdef VERTEXCOLOR\nattribute vec4 color;\n#endif\n#include<helperFunctions>\n#include<bonesDeclaration>\n#include<bakedVertexAnimationDeclaration>\n#include<instancesDeclaration>\n#include<prePassVertexDeclaration>\n#include<mainUVVaryingDeclaration>[1..7]\n#include<samplerVertexDeclaration>(_DEFINENAME_,DIFFUSE,_VARYINGNAME_,Diffuse)\n#include<samplerVertexDeclaration>(_DEFINENAME_,DETAIL,_VARYINGNAME_,Detail)\n#include<samplerVertexDeclaration>(_DEFINENAME_,AMBIENT,_VARYINGNAME_,Ambient)\n#include<samplerVertexDeclaration>(_DEFINENAME_,OPACITY,_VARYINGNAME_,Opacity)\n#include<samplerVertexDeclaration>(_DEFINENAME_,EMISSIVE,_VARYINGNAME_,Emissive)\n#include<samplerVertexDeclaration>(_DEFINENAME_,LIGHTMAP,_VARYINGNAME_,Lightmap)\n#if defined(SPECULARTERM)\n#include<samplerVertexDeclaration>(_DEFINENAME_,SPECULAR,_VARYINGNAME_,Specular)\n#endif\n#include<samplerVertexDeclaration>(_DEFINENAME_,BUMP,_VARYINGNAME_,Bump)\n#include<samplerVertexDeclaration>(_DEFINENAME_,DECAL,_VARYINGNAME_,Decal)\nvarying vec3 vPositionW;\n#ifdef NORMAL\nvarying vec3 vNormalW;\n#endif\n#if defined(VERTEXCOLOR) || defined(INSTANCESCOLOR) && defined(INSTANCES)\nvarying vec4 vColor;\n#endif\n#include<bumpVertexDeclaration>\n#include<clipPlaneVertexDeclaration>\n#include<fogVertexDeclaration>\n#include<__decl__lightVxFragment>[0..maxSimultaneousLights]\n#include<morphTargetsVertexGlobalDeclaration>\n#include<morphTargetsVertexDeclaration>[0..maxSimultaneousMorphTargets]\n#ifdef REFLECTIONMAP_SKYBOX\nvarying vec3 vPositionUVW;\n#endif\n#if defined(REFLECTIONMAP_EQUIRECTANGULAR_FIXED) || defined(REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED)\nvarying vec3 vDirectionW;\n#endif\n#include<logDepthDeclaration>\n#define CUSTOM_VERTEX_DEFINITIONS\nvoid main(void) {\n#define CUSTOM_VERTEX_MAIN_BEGIN\nvec3 positionUpdated=position;\n#ifdef NORMAL\nvec3 normalUpdated=normal;\n#endif\n#ifdef TANGENT\nvec4 tangentUpdated=tangent;\n#endif\n#ifdef UV1\nvec2 uvUpdated=uv;\n#endif\n#include<morphTargetsVertexGlobal>\n#include<morphTargetsVertex>[0..maxSimultaneousMorphTargets]\n#ifdef REFLECTIONMAP_SKYBOX\nvPositionUVW=positionUpdated;\n#endif\n#define CUSTOM_VERTEX_UPDATE_POSITION\n#define CUSTOM_VERTEX_UPDATE_NORMAL\n#include<instancesVertex>\n#if defined(PREPASS) && defined(PREPASS_VELOCITY) && !defined(BONES_VELOCITY_ENABLED)\nvCurrentPosition=viewProjection*finalWorld*vec4(positionUpdated,1.0);\nvPreviousPosition=previousViewProjection*finalPreviousWorld*vec4(positionUpdated,1.0);\n#endif\n#include<bonesVertex>\n#include<bakedVertexAnimation>\nvec4 worldPos=finalWorld*vec4(positionUpdated,1.0);\n#ifdef NORMAL\nmat3 normalWorld=mat3(finalWorld);\n#if defined(INSTANCES) && defined(THIN_INSTANCES)\nvNormalW=normalUpdated/vec3(dot(normalWorld[0],normalWorld[0]),dot(normalWorld[1],normalWorld[1]),dot(normalWorld[2],normalWorld[2]));\nvNormalW=normalize(normalWorld*vNormalW);\n#else\n#ifdef NONUNIFORMSCALING\nnormalWorld=transposeMat3(inverseMat3(normalWorld));\n#endif\nvNormalW=normalize(normalWorld*normalUpdated);\n#endif\n#endif\n#define CUSTOM_VERTEX_UPDATE_WORLDPOS\n#ifdef MULTIVIEW\nif (gl_ViewID_OVR==0u) {\ngl_Position=viewProjection*worldPos;\n} else {\ngl_Position=viewProjectionR*worldPos;\n}\n#else\ngl_Position=viewProjection*worldPos;\n#endif\nvPositionW=vec3(worldPos);\n#include<prePassVertex>\n#if defined(REFLECTIONMAP_EQUIRECTANGULAR_FIXED) || defined(REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED)\nvDirectionW=normalize(vec3(finalWorld*vec4(positionUpdated,0.0)));\n#endif\n#ifndef UV1\nvec2 uvUpdated=vec2(0.,0.);\n#endif\n#ifdef MAINUV1\nvMainUV1=uvUpdated;\n#endif\n#include<uvVariableDeclaration>[2..7]\n#include<samplerVertexImplementation>(_DEFINENAME_,DIFFUSE,_VARYINGNAME_,Diffuse,_MATRIXNAME_,diffuse,_INFONAME_,DiffuseInfos.x)\n#include<samplerVertexImplementation>(_DEFINENAME_,DETAIL,_VARYINGNAME_,Detail,_MATRIXNAME_,detail,_INFONAME_,DetailInfos.x)\n#include<samplerVertexImplementation>(_DEFINENAME_,AMBIENT,_VARYINGNAME_,Ambient,_MATRIXNAME_,ambient,_INFONAME_,AmbientInfos.x)\n#include<samplerVertexImplementation>(_DEFINENAME_,OPACITY,_VARYINGNAME_,Opacity,_MATRIXNAME_,opacity,_INFONAME_,OpacityInfos.x)\n#include<samplerVertexImplementation>(_DEFINENAME_,EMISSIVE,_VARYINGNAME_,Emissive,_MATRIXNAME_,emissive,_INFONAME_,EmissiveInfos.x)\n#include<samplerVertexImplementation>(_DEFINENAME_,LIGHTMAP,_VARYINGNAME_,Lightmap,_MATRIXNAME_,lightmap,_INFONAME_,LightmapInfos.x)\n#if defined(SPECULARTERM)\n#include<samplerVertexImplementation>(_DEFINENAME_,SPECULAR,_VARYINGNAME_,Specular,_MATRIXNAME_,specular,_INFONAME_,SpecularInfos.x)\n#endif\n#include<samplerVertexImplementation>(_DEFINENAME_,BUMP,_VARYINGNAME_,Bump,_MATRIXNAME_,bump,_INFONAME_,BumpInfos.x)\n#include<samplerVertexImplementation>(_DEFINENAME_,DECAL,_VARYINGNAME_,Decal,_MATRIXNAME_,decal,_INFONAME_,DecalInfos.x)\n#include<bumpVertex>\n#include<clipPlaneVertex>\n#include<fogVertex>\n#include<shadowsVertex>[0..maxSimultaneousLights]\n#include<vertexColorMixing>\n#include<pointCloudVertex>\n#include<logDepthVertex>\n#define CUSTOM_VERTEX_MAIN_END\n}\n";ve.v.ShadersStore[Li]=Fi;class Bi{constructor(){this._defines={},this._currentRank=32,this._maxRank=-1,this._mesh=null}unBindMesh(){this._mesh=null}addFallback(e,t){this._defines[e]||(e<this._currentRank&&(this._currentRank=e),e>this._maxRank&&(this._maxRank=e),this._defines[e]=new Array),this._defines[e].push(t)}addCPUSkinningFallback(e,t){this._mesh=t,e<this._currentRank&&(this._currentRank=e),e>this._maxRank&&(this._maxRank=e)}get hasMoreFallbacks(){return this._currentRank<=this._maxRank}reduce(e,t){if(this._mesh&&this._mesh.computeBonesUsingShaders&&this._mesh.numBoneInfluencers>0){this._mesh.computeBonesUsingShaders=!1,e=e.replace("#define NUM_BONE_INFLUENCERS "+this._mesh.numBoneInfluencers,"#define NUM_BONE_INFLUENCERS 0"),t._bonesComputationForcedToCPU=!0;const i=this._mesh.getScene();for(let e=0;e<i.meshes.length;e++){const s=i.meshes[e];if(s.material){if(s.computeBonesUsingShaders&&0!==s.numBoneInfluencers)if(s.material.getEffect()===t)s.computeBonesUsingShaders=!1;else if(s.subMeshes)for(const e of s.subMeshes){if(e.effect===t){s.computeBonesUsingShaders=!1;break}}}else!this._mesh.material&&s.computeBonesUsingShaders&&s.numBoneInfluencers>0&&(s.computeBonesUsingShaders=!1)}}else{const t=this._defines[this._currentRank];if(t)for(let i=0;i<t.length;i++)e=e.replace("#define "+t[i],"");this._currentRank++}return e}}const Ui=new RegExp("^([gimus]+)!");class ki{constructor(e){this._plugins=[],this._activePlugins=[],this._activePluginsForExtraEvents=[],this._material=e,this._scene=e.getScene(),this._engine=this._scene.getEngine()}_addPlugin(e){for(let s=0;s<this._plugins.length;++s)if(this._plugins[s].name===e.name)throw'Plugin "'.concat(e.name,'" already added to the material "').concat(this._material.name,'"!');if(this._material._uniformBufferLayoutBuilt)throw'The plugin "'.concat(e.name,'" can\'t be added to the material "').concat(this._material.name,'" because this material has already been used for rendering! Please add plugins to materials before any rendering with this material occurs.');const t=e.getClassName();ki._MaterialPluginClassToMainDefine[t]||(ki._MaterialPluginClassToMainDefine[t]="MATERIALPLUGIN_"+ ++ki._MaterialPluginCounter),this._material._callbackPluginEventGeneric=this._handlePluginEvent.bind(this),this._plugins.push(e),this._plugins.sort(((e,t)=>e.priority-t.priority)),this._codeInjectionPoints={};const i={};i[ki._MaterialPluginClassToMainDefine[t]]={type:"boolean",default:!0};for(const s of this._plugins)s.collectDefines(i),this._collectPointNames("vertex",s.getCustomCode("vertex")),this._collectPointNames("fragment",s.getCustomCode("fragment"));this._defineNamesFromPlugins=i}_activatePlugin(e){-1===this._activePlugins.indexOf(e)&&(this._activePlugins.push(e),this._activePlugins.sort(((e,t)=>e.priority-t.priority)),this._material._callbackPluginEventIsReadyForSubMesh=this._handlePluginEventIsReadyForSubMesh.bind(this),this._material._callbackPluginEventPrepareDefinesBeforeAttributes=this._handlePluginEventPrepareDefinesBeforeAttributes.bind(this),this._material._callbackPluginEventPrepareDefines=this._handlePluginEventPrepareDefines.bind(this),this._material._callbackPluginEventBindForSubMesh=this._handlePluginEventBindForSubMesh.bind(this),e.registerForExtraEvents&&(this._activePluginsForExtraEvents.push(e),this._activePluginsForExtraEvents.sort(((e,t)=>e.priority-t.priority)),this._material._callbackPluginEventHasRenderTargetTextures=this._handlePluginEventHasRenderTargetTextures.bind(this),this._material._callbackPluginEventFillRenderTargetTextures=this._handlePluginEventFillRenderTargetTextures.bind(this),this._material._callbackPluginEventHardBindForSubMesh=this._handlePluginEventHardBindForSubMesh.bind(this)))}getPlugin(e){for(let t=0;t<this._plugins.length;++t)if(this._plugins[t].name===e)return this._plugins[t];return null}_handlePluginEventIsReadyForSubMesh(e){let t=!0;for(const i of this._activePlugins)t=t&&i.isReadyForSubMesh(e.defines,this._scene,this._engine,e.subMesh);e.isReadyForSubMesh=t}_handlePluginEventPrepareDefinesBeforeAttributes(e){for(const t of this._activePlugins)t.prepareDefinesBeforeAttributes(e.defines,this._scene,e.mesh)}_handlePluginEventPrepareDefines(e){for(const t of this._activePlugins)t.prepareDefines(e.defines,this._scene,e.mesh)}_handlePluginEventHardBindForSubMesh(e){for(const t of this._activePluginsForExtraEvents)t.hardBindForSubMesh(this._material._uniformBuffer,this._scene,this._engine,e.subMesh)}_handlePluginEventBindForSubMesh(e){for(const t of this._activePlugins)t.bindForSubMesh(this._material._uniformBuffer,this._scene,this._engine,e.subMesh)}_handlePluginEventHasRenderTargetTextures(e){let t=!1;for(const i of this._activePluginsForExtraEvents)if(t=i.hasRenderTargetTextures(),t)break;e.hasRenderTargetTextures=t}_handlePluginEventFillRenderTargetTextures(e){for(const t of this._activePluginsForExtraEvents)t.fillRenderTargetTextures(e.renderTargets)}_handlePluginEvent(e,t){var i;switch(e){case te.S.GetActiveTextures:{const e=t;for(const t of this._activePlugins)t.getActiveTextures(e.activeTextures);break}case te.S.GetAnimatables:{const e=t;for(const t of this._activePlugins)t.getAnimatables(e.animatables);break}case te.S.HasTexture:{const e=t;let i=!1;for(const t of this._activePlugins)if(i=t.hasTexture(e.texture),i)break;e.hasTexture=i;break}case te.S.Disposed:{const e=t;for(const t of this._plugins)t.dispose(e.forceDisposeTextures);break}case te.S.GetDefineNames:t.defineNames=this._defineNamesFromPlugins;break;case te.S.PrepareEffect:{const e=t;for(const t of this._activePlugins)e.fallbackRank=t.addFallbacks(e.defines,e.fallbacks,e.fallbackRank),t.getAttributes(e.attributes,this._scene,e.mesh);this._uniformList.length>0&&e.uniforms.push(...this._uniformList),this._samplerList.length>0&&e.samplers.push(...this._samplerList),this._uboList.length>0&&e.uniformBuffersNames.push(...this._uboList),e.customCode=this._injectCustomCode(e.customCode);break}case te.S.PrepareUniformBuffer:{const e=t;this._uboDeclaration="",this._vertexDeclaration="",this._fragmentDeclaration="",this._uniformList=[],this._samplerList=[],this._uboList=[];for(const t of this._plugins){const s=t.getUniforms();if(s){if(s.ubo)for(const t of s.ubo){if(t.size&&t.type){const s=null!==(i=t.arraySize)&&void 0!==i?i:0;e.ubo.addUniform(t.name,t.size,s),this._uboDeclaration+="".concat(t.type," ").concat(t.name).concat(s>0?"[".concat(s,"]"):"",";\r\n")}this._uniformList.push(t.name)}s.vertex&&(this._vertexDeclaration+=s.vertex+"\r\n"),s.fragment&&(this._fragmentDeclaration+=s.fragment+"\r\n")}t.getSamplers(this._samplerList),t.getUniformBuffersNames(this._uboList)}break}}}_collectPointNames(e,t){if(t)for(const i in t)this._codeInjectionPoints[e]||(this._codeInjectionPoints[e]={}),this._codeInjectionPoints[e][i]=!0}_injectCustomCode(e){return(t,i)=>{var s;e&&(i=e(t,i)),this._uboDeclaration&&(i=i.replace("#define ADDITIONAL_UBO_DECLARATION",this._uboDeclaration)),this._vertexDeclaration&&(i=i.replace("#define ADDITIONAL_VERTEX_DECLARATION",this._vertexDeclaration)),this._fragmentDeclaration&&(i=i.replace("#define ADDITIONAL_FRAGMENT_DECLARATION",this._fragmentDeclaration));const n=null===(s=this._codeInjectionPoints)||void 0===s?void 0:s[t];if(!n)return i;for(let e in n){let s="";for(const i of this._activePlugins){const n=i.getCustomCode(t);(null==n?void 0:n[e])&&(s+=n[e]+"\r\n")}if(s.length>0)if("!"===e.charAt(0)){e=e.substring(1);let t="g";if("!"===e.charAt(0))t="",e=e.substring(1);else{const i=Ui.exec(e);i&&i.length>=2&&(t=i[1],e=e.substring(t.length+1))}t.indexOf("g")<0&&(t+="g");const n=i,r=new RegExp(e,t);let a=r.exec(n);for(;null!==a;){let e=s;for(let t=0;t<a.length;++t)e=e.replace("$"+t,a[t]);i=i.replace(a[0],e),a=r.exec(n)}}else{const t="#define "+e;i=i.replace(t,"\r\n"+s+"\r\n"+t)}}return i}}}ki._MaterialPluginClassToMainDefine={},ki._MaterialPluginCounter=0;class Vi{_enable(e){e&&this._pluginManager._activatePlugin(this)}constructor(e,t,i,s){let n=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],r=arguments.length>5&&void 0!==arguments[5]&&arguments[5];this.priority=500,this.registerForExtraEvents=!1,this._material=e,this.name=t,this.priority=i,e.pluginManager||(e.pluginManager=new ki(e),e.onDisposeObservable.add((()=>{e.pluginManager=void 0}))),this._pluginDefineNames=s,this._pluginManager=e.pluginManager,n&&this._pluginManager._addPlugin(this),r&&this._enable(!0),this.markAllDefinesAsDirty=e._dirtyCallbacks[63]}getClassName(){return"MaterialPluginBase"}isReadyForSubMesh(e,t,i,s){return!0}hardBindForSubMesh(e,t,i,s){}bindForSubMesh(e,t,i,s){}dispose(e){}getCustomCode(e){return null}collectDefines(e){if(this._pluginDefineNames)for(const t of Object.keys(this._pluginDefineNames)){if("_"===t[0])continue;const i=typeof this._pluginDefineNames[t];e[t]={type:"number"===i?"number":"string"===i?"string":"boolean"===i?"boolean":"object",default:this._pluginDefineNames[t]}}}prepareDefinesBeforeAttributes(e,t,i){}prepareDefines(e,t,i){}hasTexture(e){return!1}hasRenderTargetTextures(){return!1}fillRenderTargetTextures(e){}getActiveTextures(e){}getAnimatables(e){}addFallbacks(e,t,i){return i}getSamplers(e){}getAttributes(e,t,i){}getUniformBuffersNames(e){}getUniforms(){return{}}copyTo(e){M.p4.Clone((()=>e),this)}serialize(){return M.p4.Serialize(this)}parse(e,t,i){M.p4.Parse((()=>this),e,t,i)}}(0,y.gn)([(0,M.qC)()],Vi.prototype,"name",void 0),(0,y.gn)([(0,M.qC)()],Vi.prototype,"priority",void 0),(0,y.gn)([(0,M.qC)()],Vi.prototype,"registerForExtraEvents",void 0);class Gi extends ie.H{constructor(){super(...arguments),this.DETAIL=!1,this.DETAILDIRECTUV=0,this.DETAIL_NORMALBLENDMETHOD=0}}class Wi extends Vi{_markAllSubMeshesAsTexturesDirty(){this._enable(this._isEnabled),this._internalMarkAllSubMeshesAsTexturesDirty()}constructor(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];super(e,"DetailMap",140,new Gi,t),this._texture=null,this.diffuseBlendLevel=1,this.roughnessBlendLevel=1,this.bumpLevel=1,this._normalBlendMethod=ee.F.MATERIAL_NORMALBLENDMETHOD_WHITEOUT,this._isEnabled=!1,this.isEnabled=!1,this._internalMarkAllSubMeshesAsTexturesDirty=e._dirtyCallbacks[1]}isReadyForSubMesh(e,t,i){return!this._isEnabled||!(e._areTexturesDirty&&t.texturesEnabled&&i.getCaps().standardDerivatives&&this._texture&&_e.DetailTextureEnabled&&!this._texture.isReady())}prepareDefines(e,t){if(this._isEnabled){e.DETAIL_NORMALBLENDMETHOD=this._normalBlendMethod;const i=t.getEngine();e._areTexturesDirty&&(i.getCaps().standardDerivatives&&this._texture&&_e.DetailTextureEnabled&&this._isEnabled?(ne.G.PrepareDefinesForMergedUV(this._texture,e,"DETAIL"),e.DETAIL_NORMALBLENDMETHOD=this._normalBlendMethod):e.DETAIL=!1)}else e.DETAIL=!1}bindForSubMesh(e,t){if(!this._isEnabled)return;const i=this._material.isFrozen;e.useUbo&&i&&e.isSync||this._texture&&_e.DetailTextureEnabled&&(e.updateFloat4("vDetailInfos",this._texture.coordinatesIndex,this.diffuseBlendLevel,this.bumpLevel,this.roughnessBlendLevel),ne.G.BindTextureMatrix(this._texture,e,"detail")),t.texturesEnabled&&this._texture&&_e.DetailTextureEnabled&&e.setTexture("detailSampler",this._texture)}hasTexture(e){return this._texture===e}getActiveTextures(e){this._texture&&e.push(this._texture)}getAnimatables(e){this._texture&&this._texture.animations&&this._texture.animations.length>0&&e.push(this._texture)}dispose(e){var t;e&&(null===(t=this._texture)||void 0===t||t.dispose())}getClassName(){return"DetailMapConfiguration"}getSamplers(e){e.push("detailSampler")}getUniforms(){return{ubo:[{name:"vDetailInfos",size:4,type:"vec4"},{name:"detailMatrix",size:16,type:"mat4"}]}}}(0,y.gn)([(0,M.oU)("detailTexture"),(0,M.wz)("_markAllSubMeshesAsTexturesDirty")],Wi.prototype,"texture",void 0),(0,y.gn)([(0,M.qC)()],Wi.prototype,"diffuseBlendLevel",void 0),(0,y.gn)([(0,M.qC)()],Wi.prototype,"roughnessBlendLevel",void 0),(0,y.gn)([(0,M.qC)()],Wi.prototype,"bumpLevel",void 0),(0,y.gn)([(0,M.qC)(),(0,M.wz)("_markAllSubMeshesAsTexturesDirty")],Wi.prototype,"normalBlendMethod",void 0),(0,y.gn)([(0,M.qC)(),(0,M.wz)("_markAllSubMeshesAsTexturesDirty")],Wi.prototype,"isEnabled",void 0);var zi=i(1401);const Hi={effect:null,subMesh:null};class Xi extends ie.H{constructor(e){super(e),this.MAINUV1=!1,this.MAINUV2=!1,this.MAINUV3=!1,this.MAINUV4=!1,this.MAINUV5=!1,this.MAINUV6=!1,this.DIFFUSE=!1,this.DIFFUSEDIRECTUV=0,this.BAKED_VERTEX_ANIMATION_TEXTURE=!1,this.AMBIENT=!1,this.AMBIENTDIRECTUV=0,this.OPACITY=!1,this.OPACITYDIRECTUV=0,this.OPACITYRGB=!1,this.REFLECTION=!1,this.EMISSIVE=!1,this.EMISSIVEDIRECTUV=0,this.SPECULAR=!1,this.SPECULARDIRECTUV=0,this.BUMP=!1,this.BUMPDIRECTUV=0,this.PARALLAX=!1,this.PARALLAXOCCLUSION=!1,this.SPECULAROVERALPHA=!1,this.CLIPPLANE=!1,this.CLIPPLANE2=!1,this.CLIPPLANE3=!1,this.CLIPPLANE4=!1,this.CLIPPLANE5=!1,this.CLIPPLANE6=!1,this.ALPHATEST=!1,this.DEPTHPREPASS=!1,this.ALPHAFROMDIFFUSE=!1,this.POINTSIZE=!1,this.FOG=!1,this.SPECULARTERM=!1,this.DIFFUSEFRESNEL=!1,this.OPACITYFRESNEL=!1,this.REFLECTIONFRESNEL=!1,this.REFRACTIONFRESNEL=!1,this.EMISSIVEFRESNEL=!1,this.FRESNEL=!1,this.NORMAL=!1,this.TANGENT=!1,this.UV1=!1,this.UV2=!1,this.UV3=!1,this.UV4=!1,this.UV5=!1,this.UV6=!1,this.VERTEXCOLOR=!1,this.VERTEXALPHA=!1,this.NUM_BONE_INFLUENCERS=0,this.BonesPerMesh=0,this.BONETEXTURE=!1,this.BONES_VELOCITY_ENABLED=!1,this.INSTANCES=!1,this.THIN_INSTANCES=!1,this.INSTANCESCOLOR=!1,this.GLOSSINESS=!1,this.ROUGHNESS=!1,this.EMISSIVEASILLUMINATION=!1,this.LINKEMISSIVEWITHDIFFUSE=!1,this.REFLECTIONFRESNELFROMSPECULAR=!1,this.LIGHTMAP=!1,this.LIGHTMAPDIRECTUV=0,this.OBJECTSPACE_NORMALMAP=!1,this.USELIGHTMAPASSHADOWMAP=!1,this.REFLECTIONMAP_3D=!1,this.REFLECTIONMAP_SPHERICAL=!1,this.REFLECTIONMAP_PLANAR=!1,this.REFLECTIONMAP_CUBIC=!1,this.USE_LOCAL_REFLECTIONMAP_CUBIC=!1,this.USE_LOCAL_REFRACTIONMAP_CUBIC=!1,this.REFLECTIONMAP_PROJECTION=!1,this.REFLECTIONMAP_SKYBOX=!1,this.REFLECTIONMAP_EXPLICIT=!1,this.REFLECTIONMAP_EQUIRECTANGULAR=!1,this.REFLECTIONMAP_EQUIRECTANGULAR_FIXED=!1,this.REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED=!1,this.REFLECTIONMAP_OPPOSITEZ=!1,this.INVERTCUBICMAP=!1,this.LOGARITHMICDEPTH=!1,this.REFRACTION=!1,this.REFRACTIONMAP_3D=!1,this.REFLECTIONOVERALPHA=!1,this.TWOSIDEDLIGHTING=!1,this.SHADOWFLOAT=!1,this.MORPHTARGETS=!1,this.MORPHTARGETS_NORMAL=!1,this.MORPHTARGETS_TANGENT=!1,this.MORPHTARGETS_UV=!1,this.NUM_MORPH_INFLUENCERS=0,this.MORPHTARGETS_TEXTURE=!1,this.NONUNIFORMSCALING=!1,this.PREMULTIPLYALPHA=!1,this.ALPHATEST_AFTERALLALPHACOMPUTATIONS=!1,this.ALPHABLEND=!0,this.PREPASS=!1,this.PREPASS_IRRADIANCE=!1,this.PREPASS_IRRADIANCE_INDEX=-1,this.PREPASS_ALBEDO_SQRT=!1,this.PREPASS_ALBEDO_SQRT_INDEX=-1,this.PREPASS_DEPTH=!1,this.PREPASS_DEPTH_INDEX=-1,this.PREPASS_NORMAL=!1,this.PREPASS_NORMAL_INDEX=-1,this.PREPASS_POSITION=!1,this.PREPASS_POSITION_INDEX=-1,this.PREPASS_VELOCITY=!1,this.PREPASS_VELOCITY_INDEX=-1,this.PREPASS_REFLECTIVITY=!1,this.PREPASS_REFLECTIVITY_INDEX=-1,this.SCENE_MRT_COUNT=0,this.RGBDLIGHTMAP=!1,this.RGBDREFLECTION=!1,this.RGBDREFRACTION=!1,this.IMAGEPROCESSING=!1,this.VIGNETTE=!1,this.VIGNETTEBLENDMODEMULTIPLY=!1,this.VIGNETTEBLENDMODEOPAQUE=!1,this.TONEMAPPING=!1,this.TONEMAPPING_ACES=!1,this.CONTRAST=!1,this.COLORCURVES=!1,this.COLORGRADING=!1,this.COLORGRADING3D=!1,this.SAMPLER3DGREENDEPTH=!1,this.SAMPLER3DBGRMAP=!1,this.DITHER=!1,this.IMAGEPROCESSINGPOSTPROCESS=!1,this.SKIPFINALCOLORCLAMP=!1,this.MULTIVIEW=!1,this.ORDER_INDEPENDENT_TRANSPARENCY=!1,this.ORDER_INDEPENDENT_TRANSPARENCY_16BITS=!1,this.CAMERA_ORTHOGRAPHIC=!1,this.CAMERA_PERSPECTIVE=!1,this.IS_REFLECTION_LINEAR=!1,this.IS_REFRACTION_LINEAR=!1,this.EXPOSURE=!1,this.rebuild()}setReflectionMode(e){const t=["REFLECTIONMAP_CUBIC","REFLECTIONMAP_EXPLICIT","REFLECTIONMAP_PLANAR","REFLECTIONMAP_PROJECTION","REFLECTIONMAP_PROJECTION","REFLECTIONMAP_SKYBOX","REFLECTIONMAP_SPHERICAL","REFLECTIONMAP_EQUIRECTANGULAR","REFLECTIONMAP_EQUIRECTANGULAR_FIXED","REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED"];for(const i of t)this[i]=i===e}}class ji extends se{get imageProcessingConfiguration(){return this._imageProcessingConfiguration}set imageProcessingConfiguration(e){this._attachImageProcessingConfiguration(e),this._markAllSubMeshesAsTexturesDirty()}_attachImageProcessingConfiguration(e){e!==this._imageProcessingConfiguration&&(this._imageProcessingConfiguration&&this._imageProcessingObserver&&this._imageProcessingConfiguration.onUpdateParameters.remove(this._imageProcessingObserver),this._imageProcessingConfiguration=e||this.getScene().imageProcessingConfiguration,this._imageProcessingConfiguration&&(this._imageProcessingObserver=this._imageProcessingConfiguration.onUpdateParameters.add((()=>{this._markAllSubMeshesAsImageProcessingDirty()}))))}get isPrePassCapable(){return!this.disableDepthWrite}get cameraColorCurvesEnabled(){return this.imageProcessingConfiguration.colorCurvesEnabled}set cameraColorCurvesEnabled(e){this.imageProcessingConfiguration.colorCurvesEnabled=e}get cameraColorGradingEnabled(){return this.imageProcessingConfiguration.colorGradingEnabled}set cameraColorGradingEnabled(e){this.imageProcessingConfiguration.colorGradingEnabled=e}get cameraToneMappingEnabled(){return this._imageProcessingConfiguration.toneMappingEnabled}set cameraToneMappingEnabled(e){this._imageProcessingConfiguration.toneMappingEnabled=e}get cameraExposure(){return this._imageProcessingConfiguration.exposure}set cameraExposure(e){this._imageProcessingConfiguration.exposure=e}get cameraContrast(){return this._imageProcessingConfiguration.contrast}set cameraContrast(e){this._imageProcessingConfiguration.contrast=e}get cameraColorGradingTexture(){return this._imageProcessingConfiguration.colorGradingTexture}set cameraColorGradingTexture(e){this._imageProcessingConfiguration.colorGradingTexture=e}get cameraColorCurves(){return this._imageProcessingConfiguration.colorCurves}set cameraColorCurves(e){this._imageProcessingConfiguration.colorCurves=e}get canRenderToMRT(){return!0}constructor(e,t){super(e,t),this._diffuseTexture=null,this._ambientTexture=null,this._opacityTexture=null,this._reflectionTexture=null,this._emissiveTexture=null,this._specularTexture=null,this._bumpTexture=null,this._lightmapTexture=null,this._refractionTexture=null,this.ambientColor=new d.Wo(0,0,0),this.diffuseColor=new d.Wo(1,1,1),this.specularColor=new d.Wo(1,1,1),this.emissiveColor=new d.Wo(0,0,0),this.specularPower=64,this._useAlphaFromDiffuseTexture=!1,this._useEmissiveAsIllumination=!1,this._linkEmissiveWithDiffuse=!1,this._useSpecularOverAlpha=!1,this._useReflectionOverAlpha=!1,this._disableLighting=!1,this._useObjectSpaceNormalMap=!1,this._useParallax=!1,this._useParallaxOcclusion=!1,this.parallaxScaleBias=.05,this._roughness=0,this.indexOfRefraction=.98,this.invertRefractionY=!0,this.alphaCutOff=.4,this._useLightmapAsShadowmap=!1,this._useReflectionFresnelFromSpecular=!1,this._useGlossinessFromSpecularMapAlpha=!1,this._maxSimultaneousLights=4,this._invertNormalMapX=!1,this._invertNormalMapY=!1,this._twoSidedLighting=!1,this._renderTargets=new Q.t(16),this._worldViewProjectionMatrix=u.y3.Zero(),this._globalAmbientColor=new d.Wo(0,0,0),this._cacheHasRenderTargetTextures=!1,this.detailMap=new Wi(this),this._attachImageProcessingConfiguration(null),this.prePassConfiguration=new $,this.getRenderTargetTextures=()=>(this._renderTargets.reset(),ji.ReflectionTextureEnabled&&this._reflectionTexture&&this._reflectionTexture.isRenderTarget&&this._renderTargets.push(this._reflectionTexture),ji.RefractionTextureEnabled&&this._refractionTexture&&this._refractionTexture.isRenderTarget&&this._renderTargets.push(this._refractionTexture),this._eventInfo.renderTargets=this._renderTargets,this._callbackPluginEventFillRenderTargetTextures(this._eventInfo),this._renderTargets)}get hasRenderTargetTextures(){return!!(ji.ReflectionTextureEnabled&&this._reflectionTexture&&this._reflectionTexture.isRenderTarget)||(!!(ji.RefractionTextureEnabled&&this._refractionTexture&&this._refractionTexture.isRenderTarget)||this._cacheHasRenderTargetTextures)}getClassName(){return"StandardMaterial"}get useLogarithmicDepth(){return this._useLogarithmicDepth}set useLogarithmicDepth(e){this._useLogarithmicDepth=e&&this.getScene().getEngine().getCaps().fragmentDepthSupported,this._markAllSubMeshesAsMiscDirty()}needAlphaBlending(){return!this._disableAlphaBlending&&(this.alpha<1||null!=this._opacityTexture||this._shouldUseAlphaFromDiffuseTexture()||this._opacityFresnelParameters&&this._opacityFresnelParameters.isEnabled)}needAlphaTesting(){return!!this._forceAlphaTest||this._hasAlphaChannel()&&(null==this._transparencyMode||this._transparencyMode===ee.F.MATERIAL_ALPHATEST)}_shouldUseAlphaFromDiffuseTexture(){return null!=this._diffuseTexture&&this._diffuseTexture.hasAlpha&&this._useAlphaFromDiffuseTexture&&this._transparencyMode!==ee.F.MATERIAL_OPAQUE}_hasAlphaChannel(){return null!=this._diffuseTexture&&this._diffuseTexture.hasAlpha||null!=this._opacityTexture}getAlphaTestTexture(){return this._diffuseTexture}isReadyForSubMesh(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this._uniformBufferLayoutBuilt||this.buildUniformLayout(),t.effect&&this.isFrozen&&t.effect._wasPreviouslyReady&&t.effect._wasPreviouslyUsingInstances===i)return!0;t.materialDefines||(this._callbackPluginEventGeneric(te.S.GetDefineNames,this._eventInfo),t.materialDefines=new Xi(this._eventInfo.defineNames));const s=this.getScene(),n=t.materialDefines;if(this._isReadyForSubMesh(t))return!0;const r=s.getEngine();n._needNormals=ne.G.PrepareDefinesForLights(s,e,n,!0,this._maxSimultaneousLights,this._disableLighting),ne.G.PrepareDefinesForMultiview(s,n);const a=this.needAlphaBlendingForMesh(e)&&this.getScene().useOrderIndependentTransparency;if(ne.G.PrepareDefinesForPrePass(s,n,this.canRenderToMRT&&!a),ne.G.PrepareDefinesForOIT(s,n,a),n._areTexturesDirty){this._eventInfo.hasRenderTargetTextures=!1,this._callbackPluginEventHasRenderTargetTextures(this._eventInfo),this._cacheHasRenderTargetTextures=this._eventInfo.hasRenderTargetTextures,n._needUVs=!1;for(let e=1;e<=6;++e)n["MAINUV"+e]=!1;if(s.texturesEnabled){if(n.DIFFUSEDIRECTUV=0,n.BUMPDIRECTUV=0,n.AMBIENTDIRECTUV=0,n.OPACITYDIRECTUV=0,n.EMISSIVEDIRECTUV=0,n.SPECULARDIRECTUV=0,n.LIGHTMAPDIRECTUV=0,this._diffuseTexture&&ji.DiffuseTextureEnabled){if(!this._diffuseTexture.isReadyOrNotBlocking())return!1;ne.G.PrepareDefinesForMergedUV(this._diffuseTexture,n,"DIFFUSE")}else n.DIFFUSE=!1;if(this._ambientTexture&&ji.AmbientTextureEnabled){if(!this._ambientTexture.isReadyOrNotBlocking())return!1;ne.G.PrepareDefinesForMergedUV(this._ambientTexture,n,"AMBIENT")}else n.AMBIENT=!1;if(this._opacityTexture&&ji.OpacityTextureEnabled){if(!this._opacityTexture.isReadyOrNotBlocking())return!1;ne.G.PrepareDefinesForMergedUV(this._opacityTexture,n,"OPACITY"),n.OPACITYRGB=this._opacityTexture.getAlphaFromRGB}else n.OPACITY=!1;if(this._reflectionTexture&&ji.ReflectionTextureEnabled){if(!this._reflectionTexture.isReadyOrNotBlocking())return!1;switch(n._needNormals=!0,n.REFLECTION=!0,n.ROUGHNESS=this._roughness>0,n.REFLECTIONOVERALPHA=this._useReflectionOverAlpha,n.INVERTCUBICMAP=this._reflectionTexture.coordinatesMode===me.INVCUBIC_MODE,n.REFLECTIONMAP_3D=this._reflectionTexture.isCube,n.REFLECTIONMAP_OPPOSITEZ=n.REFLECTIONMAP_3D&&this.getScene().useRightHandedSystem?!this._reflectionTexture.invertZ:this._reflectionTexture.invertZ,n.RGBDREFLECTION=this._reflectionTexture.isRGBD,this._reflectionTexture.coordinatesMode){case me.EXPLICIT_MODE:n.setReflectionMode("REFLECTIONMAP_EXPLICIT");break;case me.PLANAR_MODE:n.setReflectionMode("REFLECTIONMAP_PLANAR");break;case me.PROJECTION_MODE:n.setReflectionMode("REFLECTIONMAP_PROJECTION");break;case me.SKYBOX_MODE:n.setReflectionMode("REFLECTIONMAP_SKYBOX");break;case me.SPHERICAL_MODE:n.setReflectionMode("REFLECTIONMAP_SPHERICAL");break;case me.EQUIRECTANGULAR_MODE:n.setReflectionMode("REFLECTIONMAP_EQUIRECTANGULAR");break;case me.FIXED_EQUIRECTANGULAR_MODE:n.setReflectionMode("REFLECTIONMAP_EQUIRECTANGULAR_FIXED");break;case me.FIXED_EQUIRECTANGULAR_MIRRORED_MODE:n.setReflectionMode("REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED");break;case me.CUBIC_MODE:case me.INVCUBIC_MODE:default:n.setReflectionMode("REFLECTIONMAP_CUBIC")}n.USE_LOCAL_REFLECTIONMAP_CUBIC=!!this._reflectionTexture.boundingBoxSize}else n.REFLECTION=!1,n.REFLECTIONMAP_OPPOSITEZ=!1;if(this._emissiveTexture&&ji.EmissiveTextureEnabled){if(!this._emissiveTexture.isReadyOrNotBlocking())return!1;ne.G.PrepareDefinesForMergedUV(this._emissiveTexture,n,"EMISSIVE")}else n.EMISSIVE=!1;if(this._lightmapTexture&&ji.LightmapTextureEnabled){if(!this._lightmapTexture.isReadyOrNotBlocking())return!1;ne.G.PrepareDefinesForMergedUV(this._lightmapTexture,n,"LIGHTMAP"),n.USELIGHTMAPASSHADOWMAP=this._useLightmapAsShadowmap,n.RGBDLIGHTMAP=this._lightmapTexture.isRGBD}else n.LIGHTMAP=!1;if(this._specularTexture&&ji.SpecularTextureEnabled){if(!this._specularTexture.isReadyOrNotBlocking())return!1;ne.G.PrepareDefinesForMergedUV(this._specularTexture,n,"SPECULAR"),n.GLOSSINESS=this._useGlossinessFromSpecularMapAlpha}else n.SPECULAR=!1;if(s.getEngine().getCaps().standardDerivatives&&this._bumpTexture&&ji.BumpTextureEnabled){if(!this._bumpTexture.isReady())return!1;ne.G.PrepareDefinesForMergedUV(this._bumpTexture,n,"BUMP"),n.PARALLAX=this._useParallax,n.PARALLAXOCCLUSION=this._useParallaxOcclusion,n.OBJECTSPACE_NORMALMAP=this._useObjectSpaceNormalMap}else n.BUMP=!1,n.PARALLAX=!1,n.PARALLAXOCCLUSION=!1;if(this._refractionTexture&&ji.RefractionTextureEnabled){if(!this._refractionTexture.isReadyOrNotBlocking())return!1;n._needUVs=!0,n.REFRACTION=!0,n.REFRACTIONMAP_3D=this._refractionTexture.isCube,n.RGBDREFRACTION=this._refractionTexture.isRGBD,n.USE_LOCAL_REFRACTIONMAP_CUBIC=!!this._refractionTexture.boundingBoxSize}else n.REFRACTION=!1;n.TWOSIDEDLIGHTING=!this._backFaceCulling&&this._twoSidedLighting}else n.DIFFUSE=!1,n.AMBIENT=!1,n.OPACITY=!1,n.REFLECTION=!1,n.EMISSIVE=!1,n.LIGHTMAP=!1,n.BUMP=!1,n.REFRACTION=!1;n.ALPHAFROMDIFFUSE=this._shouldUseAlphaFromDiffuseTexture(),n.EMISSIVEASILLUMINATION=this._useEmissiveAsIllumination,n.LINKEMISSIVEWITHDIFFUSE=this._linkEmissiveWithDiffuse,n.SPECULAROVERALPHA=this._useSpecularOverAlpha,n.PREMULTIPLYALPHA=7===this.alphaMode||8===this.alphaMode,n.ALPHATEST_AFTERALLALPHACOMPUTATIONS=null!==this.transparencyMode,n.ALPHABLEND=null===this.transparencyMode||this.needAlphaBlendingForMesh(e)}if(this._eventInfo.isReadyForSubMesh=!0,this._eventInfo.defines=n,this._eventInfo.subMesh=t,this._callbackPluginEventIsReadyForSubMesh(this._eventInfo),!this._eventInfo.isReadyForSubMesh)return!1;if(n._areImageProcessingDirty&&this._imageProcessingConfiguration){if(!this._imageProcessingConfiguration.isReady())return!1;this._imageProcessingConfiguration.prepareDefines(n),n.IS_REFLECTION_LINEAR=null!=this.reflectionTexture&&!this.reflectionTexture.gammaSpace,n.IS_REFRACTION_LINEAR=null!=this.refractionTexture&&!this.refractionTexture.gammaSpace}n._areFresnelDirty&&(ji.FresnelEnabled?(this._diffuseFresnelParameters||this._opacityFresnelParameters||this._emissiveFresnelParameters||this._refractionFresnelParameters||this._reflectionFresnelParameters)&&(n.DIFFUSEFRESNEL=this._diffuseFresnelParameters&&this._diffuseFresnelParameters.isEnabled,n.OPACITYFRESNEL=this._opacityFresnelParameters&&this._opacityFresnelParameters.isEnabled,n.REFLECTIONFRESNEL=this._reflectionFresnelParameters&&this._reflectionFresnelParameters.isEnabled,n.REFLECTIONFRESNELFROMSPECULAR=this._useReflectionFresnelFromSpecular,n.REFRACTIONFRESNEL=this._refractionFresnelParameters&&this._refractionFresnelParameters.isEnabled,n.EMISSIVEFRESNEL=this._emissiveFresnelParameters&&this._emissiveFresnelParameters.isEnabled,n._needNormals=!0,n.FRESNEL=!0):n.FRESNEL=!1),ne.G.PrepareDefinesForMisc(e,s,this._useLogarithmicDepth,this.pointsCloud,this.fogEnabled,this._shouldTurnAlphaTestOn(e)||this._forceAlphaTest,n),ne.G.PrepareDefinesForFrameBoundValues(s,r,this,n,i,null,t.getRenderingMesh().hasThinInstances),this._eventInfo.defines=n,this._eventInfo.mesh=e,this._callbackPluginEventPrepareDefinesBeforeAttributes(this._eventInfo),ne.G.PrepareDefinesForAttributes(e,n,!0,!0,!0),this._callbackPluginEventPrepareDefines(this._eventInfo);let o=!1;if(n.isDirty){const i=n._areLightsDisposed;n.markAsProcessed();const a=new Bi;n.REFLECTION&&a.addFallback(0,"REFLECTION"),n.SPECULAR&&a.addFallback(0,"SPECULAR"),n.BUMP&&a.addFallback(0,"BUMP"),n.PARALLAX&&a.addFallback(1,"PARALLAX"),n.PARALLAXOCCLUSION&&a.addFallback(0,"PARALLAXOCCLUSION"),n.SPECULAROVERALPHA&&a.addFallback(0,"SPECULAROVERALPHA"),n.FOG&&a.addFallback(1,"FOG"),n.POINTSIZE&&a.addFallback(0,"POINTSIZE"),n.LOGARITHMICDEPTH&&a.addFallback(0,"LOGARITHMICDEPTH"),ne.G.HandleFallbacksForShadows(n,a,this._maxSimultaneousLights),n.SPECULARTERM&&a.addFallback(0,"SPECULARTERM"),n.DIFFUSEFRESNEL&&a.addFallback(1,"DIFFUSEFRESNEL"),n.OPACITYFRESNEL&&a.addFallback(2,"OPACITYFRESNEL"),n.REFLECTIONFRESNEL&&a.addFallback(3,"REFLECTIONFRESNEL"),n.EMISSIVEFRESNEL&&a.addFallback(4,"EMISSIVEFRESNEL"),n.FRESNEL&&a.addFallback(4,"FRESNEL"),n.MULTIVIEW&&a.addFallback(0,"MULTIVIEW");const l=[Z.o.PositionKind];n.NORMAL&&l.push(Z.o.NormalKind),n.TANGENT&&l.push(Z.o.TangentKind);for(let e=1;e<=6;++e)n["UV"+e]&&l.push("uv".concat(1===e?"":e));n.VERTEXCOLOR&&l.push(Z.o.ColorKind),ne.G.PrepareAttributesForBones(l,e,n,a),ne.G.PrepareAttributesForInstances(l,n),ne.G.PrepareAttributesForMorphTargets(l,e,n),ne.G.PrepareAttributesForBakedVertexAnimation(l,e,n);let h="default";const c=["world","view","viewProjection","vEyePosition","vLightsType","vAmbientColor","vDiffuseColor","vSpecularColor","vEmissiveColor","visibility","vFogInfos","vFogColor","pointSize","vDiffuseInfos","vAmbientInfos","vOpacityInfos","vReflectionInfos","vEmissiveInfos","vSpecularInfos","vBumpInfos","vLightmapInfos","vRefractionInfos","mBones","diffuseMatrix","ambientMatrix","opacityMatrix","reflectionMatrix","emissiveMatrix","specularMatrix","bumpMatrix","normalMatrix","lightmapMatrix","refractionMatrix","diffuseLeftColor","diffuseRightColor","opacityParts","reflectionLeftColor","reflectionRightColor","emissiveLeftColor","emissiveRightColor","refractionLeftColor","refractionRightColor","vReflectionPosition","vReflectionSize","vRefractionPosition","vRefractionSize","logarithmicDepthConstant","vTangentSpaceParams","alphaCutOff","boneTextureWidth","morphTargetTextureInfo","morphTargetTextureIndices"],u=["diffuseSampler","ambientSampler","opacitySampler","reflectionCubeSampler","reflection2DSampler","emissiveSampler","specularSampler","bumpSampler","lightmapSampler","refractionCubeSampler","refraction2DSampler","boneSampler","morphTargets","oitDepthSampler","oitFrontColorSampler"],d=["Material","Scene","Mesh"];this._eventInfo.fallbacks=a,this._eventInfo.fallbackRank=0,this._eventInfo.defines=n,this._eventInfo.uniforms=c,this._eventInfo.attributes=l,this._eventInfo.samplers=u,this._eventInfo.uniformBuffersNames=d,this._eventInfo.customCode=void 0,this._eventInfo.mesh=e,this._callbackPluginEventGeneric(te.S.PrepareEffect,this._eventInfo),$.AddUniforms(c),$.AddSamplers(u),J.$&&(J.$.PrepareUniforms(c,n),J.$.PrepareSamplers(u,n)),ne.G.PrepareUniformsAndSamplersList({uniformsNames:c,uniformBuffersNames:d,samplers:u,defines:n,maxSimultaneousLights:this._maxSimultaneousLights}),(0,zi.qx)(c);const f={};this.customShaderNameResolve&&(h=this.customShaderNameResolve(h,c,d,u,n,l,f));const p=n.toString(),g=t.effect;let m=s.getEngine().createEffect(h,{attributes:l,uniformsNames:c,uniformBuffersNames:d,samplers:u,defines:p,fallbacks:a,onCompiled:this.onCompiled,onError:this.onError,indexParameters:{maxSimultaneousLights:this._maxSimultaneousLights,maxSimultaneousMorphTargets:n.NUM_MORPH_INFLUENCERS},processFinalCode:f.processFinalCode,processCodeAfterIncludes:this._eventInfo.customCode,multiTarget:n.PREPASS},r);if(this._eventInfo.customCode=void 0,m)if(this._onEffectCreatedObservable&&(Hi.effect=m,Hi.subMesh=t,this._onEffectCreatedObservable.notifyObservers(Hi)),this.allowShaderHotSwapping&&g&&!m.isReady()){if(m=g,n.markAsUnprocessed(),o=this.isFrozen,i)return n._areLightsDisposed=!0,!1}else s.resetCachedMaterial(),t.setEffect(m,n,this._materialContext)}return!(!t.effect||!t.effect.isReady())&&(n._renderId=s.getRenderId(),t.effect._wasPreviouslyReady=!o,t.effect._wasPreviouslyUsingInstances=i,this._checkScenePerformancePriority(),!0)}buildUniformLayout(){const e=this._uniformBuffer;e.addUniform("diffuseLeftColor",4),e.addUniform("diffuseRightColor",4),e.addUniform("opacityParts",4),e.addUniform("reflectionLeftColor",4),e.addUniform("reflectionRightColor",4),e.addUniform("refractionLeftColor",4),e.addUniform("refractionRightColor",4),e.addUniform("emissiveLeftColor",4),e.addUniform("emissiveRightColor",4),e.addUniform("vDiffuseInfos",2),e.addUniform("vAmbientInfos",2),e.addUniform("vOpacityInfos",2),e.addUniform("vReflectionInfos",2),e.addUniform("vReflectionPosition",3),e.addUniform("vReflectionSize",3),e.addUniform("vEmissiveInfos",2),e.addUniform("vLightmapInfos",2),e.addUniform("vSpecularInfos",2),e.addUniform("vBumpInfos",3),e.addUniform("diffuseMatrix",16),e.addUniform("ambientMatrix",16),e.addUniform("opacityMatrix",16),e.addUniform("reflectionMatrix",16),e.addUniform("emissiveMatrix",16),e.addUniform("lightmapMatrix",16),e.addUniform("specularMatrix",16),e.addUniform("bumpMatrix",16),e.addUniform("vTangentSpaceParams",2),e.addUniform("pointSize",1),e.addUniform("alphaCutOff",1),e.addUniform("refractionMatrix",16),e.addUniform("vRefractionInfos",4),e.addUniform("vRefractionPosition",3),e.addUniform("vRefractionSize",3),e.addUniform("vSpecularColor",4),e.addUniform("vEmissiveColor",3),e.addUniform("vDiffuseColor",4),e.addUniform("vAmbientColor",3),super.buildUniformLayout()}bindForSubMesh(e,t,i){var s;const n=this.getScene(),a=i.materialDefines;if(!a)return;const o=i.effect;if(!o)return;this._activeEffect=o,t.getMeshUniformBuffer().bindToEffect(o,"Mesh"),t.transferToEffect(e),this._uniformBuffer.bindToEffect(o,"Material"),this.prePassConfiguration.bindForSubMesh(this._activeEffect,n,t,e,this.isFrozen),this._eventInfo.subMesh=i,this._callbackPluginEventHardBindForSubMesh(this._eventInfo),a.OBJECTSPACE_NORMALMAP&&(e.toNormalMatrix(this._normalMatrix),this.bindOnlyNormalMatrix(this._normalMatrix));const l=o._forceRebindOnNextCall||this._mustRebind(n,o,t.visibility);ne.G.BindBonesParameters(t,o);const h=this._uniformBuffer;if(l){if(this.bindViewProjection(o),!h.useUbo||!this.isFrozen||!h.isSync||o._forceRebindOnNextCall){if(ji.FresnelEnabled&&a.FRESNEL&&(this.diffuseFresnelParameters&&this.diffuseFresnelParameters.isEnabled&&(h.updateColor4("diffuseLeftColor",this.diffuseFresnelParameters.leftColor,this.diffuseFresnelParameters.power),h.updateColor4("diffuseRightColor",this.diffuseFresnelParameters.rightColor,this.diffuseFresnelParameters.bias)),this.opacityFresnelParameters&&this.opacityFresnelParameters.isEnabled&&h.updateColor4("opacityParts",new d.Wo(this.opacityFresnelParameters.leftColor.toLuminance(),this.opacityFresnelParameters.rightColor.toLuminance(),this.opacityFresnelParameters.bias),this.opacityFresnelParameters.power),this.reflectionFresnelParameters&&this.reflectionFresnelParameters.isEnabled&&(h.updateColor4("reflectionLeftColor",this.reflectionFresnelParameters.leftColor,this.reflectionFresnelParameters.power),h.updateColor4("reflectionRightColor",this.reflectionFresnelParameters.rightColor,this.reflectionFresnelParameters.bias)),this.refractionFresnelParameters&&this.refractionFresnelParameters.isEnabled&&(h.updateColor4("refractionLeftColor",this.refractionFresnelParameters.leftColor,this.refractionFresnelParameters.power),h.updateColor4("refractionRightColor",this.refractionFresnelParameters.rightColor,this.refractionFresnelParameters.bias)),this.emissiveFresnelParameters&&this.emissiveFresnelParameters.isEnabled&&(h.updateColor4("emissiveLeftColor",this.emissiveFresnelParameters.leftColor,this.emissiveFresnelParameters.power),h.updateColor4("emissiveRightColor",this.emissiveFresnelParameters.rightColor,this.emissiveFresnelParameters.bias))),n.texturesEnabled){if(this._diffuseTexture&&ji.DiffuseTextureEnabled&&(h.updateFloat2("vDiffuseInfos",this._diffuseTexture.coordinatesIndex,this._diffuseTexture.level),ne.G.BindTextureMatrix(this._diffuseTexture,h,"diffuse")),this._ambientTexture&&ji.AmbientTextureEnabled&&(h.updateFloat2("vAmbientInfos",this._ambientTexture.coordinatesIndex,this._ambientTexture.level),ne.G.BindTextureMatrix(this._ambientTexture,h,"ambient")),this._opacityTexture&&ji.OpacityTextureEnabled&&(h.updateFloat2("vOpacityInfos",this._opacityTexture.coordinatesIndex,this._opacityTexture.level),ne.G.BindTextureMatrix(this._opacityTexture,h,"opacity")),this._hasAlphaChannel()&&h.updateFloat("alphaCutOff",this.alphaCutOff),this._reflectionTexture&&ji.ReflectionTextureEnabled&&(h.updateFloat2("vReflectionInfos",this._reflectionTexture.level,this.roughness),h.updateMatrix("reflectionMatrix",this._reflectionTexture.getReflectionTextureMatrix()),this._reflectionTexture.boundingBoxSize)){const e=this._reflectionTexture;h.updateVector3("vReflectionPosition",e.boundingBoxPosition),h.updateVector3("vReflectionSize",e.boundingBoxSize)}if(this._emissiveTexture&&ji.EmissiveTextureEnabled&&(h.updateFloat2("vEmissiveInfos",this._emissiveTexture.coordinatesIndex,this._emissiveTexture.level),ne.G.BindTextureMatrix(this._emissiveTexture,h,"emissive")),this._lightmapTexture&&ji.LightmapTextureEnabled&&(h.updateFloat2("vLightmapInfos",this._lightmapTexture.coordinatesIndex,this._lightmapTexture.level),ne.G.BindTextureMatrix(this._lightmapTexture,h,"lightmap")),this._specularTexture&&ji.SpecularTextureEnabled&&(h.updateFloat2("vSpecularInfos",this._specularTexture.coordinatesIndex,this._specularTexture.level),ne.G.BindTextureMatrix(this._specularTexture,h,"specular")),this._bumpTexture&&n.getEngine().getCaps().standardDerivatives&&ji.BumpTextureEnabled&&(h.updateFloat3("vBumpInfos",this._bumpTexture.coordinatesIndex,1/this._bumpTexture.level,this.parallaxScaleBias),ne.G.BindTextureMatrix(this._bumpTexture,h,"bump"),n._mirroredCameraPosition?h.updateFloat2("vTangentSpaceParams",this._invertNormalMapX?1:-1,this._invertNormalMapY?1:-1):h.updateFloat2("vTangentSpaceParams",this._invertNormalMapX?-1:1,this._invertNormalMapY?-1:1)),this._refractionTexture&&ji.RefractionTextureEnabled){let e=1;if(this._refractionTexture.isCube||(h.updateMatrix("refractionMatrix",this._refractionTexture.getReflectionTextureMatrix()),this._refractionTexture.depth&&(e=this._refractionTexture.depth)),h.updateFloat4("vRefractionInfos",this._refractionTexture.level,this.indexOfRefraction,e,this.invertRefractionY?-1:1),this._refractionTexture.boundingBoxSize){const e=this._refractionTexture;h.updateVector3("vRefractionPosition",e.boundingBoxPosition),h.updateVector3("vRefractionSize",e.boundingBoxSize)}}}this.pointsCloud&&h.updateFloat("pointSize",this.pointSize),a.SPECULARTERM&&h.updateColor4("vSpecularColor",this.specularColor,this.specularPower),h.updateColor3("vEmissiveColor",ji.EmissiveTextureEnabled?this.emissiveColor:d.Wo.BlackReadOnly),h.updateColor4("vDiffuseColor",this.diffuseColor,this.alpha),n.ambientColor.multiplyToRef(this.ambientColor,this._globalAmbientColor),h.updateColor3("vAmbientColor",this._globalAmbientColor)}n.texturesEnabled&&(this._diffuseTexture&&ji.DiffuseTextureEnabled&&o.setTexture("diffuseSampler",this._diffuseTexture),this._ambientTexture&&ji.AmbientTextureEnabled&&o.setTexture("ambientSampler",this._ambientTexture),this._opacityTexture&&ji.OpacityTextureEnabled&&o.setTexture("opacitySampler",this._opacityTexture),this._reflectionTexture&&ji.ReflectionTextureEnabled&&(this._reflectionTexture.isCube?o.setTexture("reflectionCubeSampler",this._reflectionTexture):o.setTexture("reflection2DSampler",this._reflectionTexture)),this._emissiveTexture&&ji.EmissiveTextureEnabled&&o.setTexture("emissiveSampler",this._emissiveTexture),this._lightmapTexture&&ji.LightmapTextureEnabled&&o.setTexture("lightmapSampler",this._lightmapTexture),this._specularTexture&&ji.SpecularTextureEnabled&&o.setTexture("specularSampler",this._specularTexture),this._bumpTexture&&n.getEngine().getCaps().standardDerivatives&&ji.BumpTextureEnabled&&o.setTexture("bumpSampler",this._bumpTexture),this._refractionTexture&&ji.RefractionTextureEnabled&&(this._refractionTexture.isCube?o.setTexture("refractionCubeSampler",this._refractionTexture):o.setTexture("refraction2DSampler",this._refractionTexture))),this.getScene().useOrderIndependentTransparency&&this.needAlphaBlendingForMesh(t)&&this.getScene().depthPeelingRenderer.bind(o),this._eventInfo.subMesh=i,this._callbackPluginEventBindForSubMesh(this._eventInfo),(0,zi.an)(o,this,n),this.bindEyePosition(o)}else n.getEngine()._features.needToAlwaysBindUniformBuffers&&(this._needToBindSceneUbo=!0);!l&&this.isFrozen||(n.lightsEnabled&&!this._disableLighting&&ne.G.BindLights(n,t,o,a,this._maxSimultaneousLights),(n.fogEnabled&&t.applyFog&&n.fogMode!==r.x.FOGMODE_NONE||this._reflectionTexture||this._refractionTexture||t.receiveShadows||a.PREPASS)&&this.bindView(o),ne.G.BindFogParameters(n,t,o),a.NUM_MORPH_INFLUENCERS&&ne.G.BindMorphTargetParameters(t,o),a.BAKED_VERTEX_ANIMATION_TEXTURE&&(null===(s=t.bakedVertexAnimationManager)||void 0===s||s.bind(o,a.INSTANCES)),this.useLogarithmicDepth&&ne.G.BindLogDepth(a,o,n),this._imageProcessingConfiguration&&!this._imageProcessingConfiguration.applyByPostProcess&&this._imageProcessingConfiguration.bind(this._activeEffect)),this._afterBind(t,this._activeEffect),h.update()}getAnimatables(){const e=super.getAnimatables();return this._diffuseTexture&&this._diffuseTexture.animations&&this._diffuseTexture.animations.length>0&&e.push(this._diffuseTexture),this._ambientTexture&&this._ambientTexture.animations&&this._ambientTexture.animations.length>0&&e.push(this._ambientTexture),this._opacityTexture&&this._opacityTexture.animations&&this._opacityTexture.animations.length>0&&e.push(this._opacityTexture),this._reflectionTexture&&this._reflectionTexture.animations&&this._reflectionTexture.animations.length>0&&e.push(this._reflectionTexture),this._emissiveTexture&&this._emissiveTexture.animations&&this._emissiveTexture.animations.length>0&&e.push(this._emissiveTexture),this._specularTexture&&this._specularTexture.animations&&this._specularTexture.animations.length>0&&e.push(this._specularTexture),this._bumpTexture&&this._bumpTexture.animations&&this._bumpTexture.animations.length>0&&e.push(this._bumpTexture),this._lightmapTexture&&this._lightmapTexture.animations&&this._lightmapTexture.animations.length>0&&e.push(this._lightmapTexture),this._refractionTexture&&this._refractionTexture.animations&&this._refractionTexture.animations.length>0&&e.push(this._refractionTexture),e}getActiveTextures(){const e=super.getActiveTextures();return this._diffuseTexture&&e.push(this._diffuseTexture),this._ambientTexture&&e.push(this._ambientTexture),this._opacityTexture&&e.push(this._opacityTexture),this._reflectionTexture&&e.push(this._reflectionTexture),this._emissiveTexture&&e.push(this._emissiveTexture),this._specularTexture&&e.push(this._specularTexture),this._bumpTexture&&e.push(this._bumpTexture),this._lightmapTexture&&e.push(this._lightmapTexture),this._refractionTexture&&e.push(this._refractionTexture),e}hasTexture(e){return!!super.hasTexture(e)||(this._diffuseTexture===e||(this._ambientTexture===e||(this._opacityTexture===e||(this._reflectionTexture===e||(this._emissiveTexture===e||(this._specularTexture===e||(this._bumpTexture===e||(this._lightmapTexture===e||this._refractionTexture===e))))))))}dispose(e,t){var i,s,n,r,a,o,l,h,c;t&&(null===(i=this._diffuseTexture)||void 0===i||i.dispose(),null===(s=this._ambientTexture)||void 0===s||s.dispose(),null===(n=this._opacityTexture)||void 0===n||n.dispose(),null===(r=this._reflectionTexture)||void 0===r||r.dispose(),null===(a=this._emissiveTexture)||void 0===a||a.dispose(),null===(o=this._specularTexture)||void 0===o||o.dispose(),null===(l=this._bumpTexture)||void 0===l||l.dispose(),null===(h=this._lightmapTexture)||void 0===h||h.dispose(),null===(c=this._refractionTexture)||void 0===c||c.dispose()),this._imageProcessingConfiguration&&this._imageProcessingObserver&&this._imageProcessingConfiguration.onUpdateParameters.remove(this._imageProcessingObserver),super.dispose(e,t)}clone(e){const t=M.p4.Clone((()=>new ji(e,this.getScene())),this);return t.name=e,t.id=e,this.stencil.copyTo(t.stencil),t}static Parse(e,t,i){const s=M.p4.Parse((()=>new ji(e.name,t)),e,t,i);return e.stencil&&s.stencil.parse(e.stencil,t,i),s}static get DiffuseTextureEnabled(){return _e.DiffuseTextureEnabled}static set DiffuseTextureEnabled(e){_e.DiffuseTextureEnabled=e}static get DetailTextureEnabled(){return _e.DetailTextureEnabled}static set DetailTextureEnabled(e){_e.DetailTextureEnabled=e}static get AmbientTextureEnabled(){return _e.AmbientTextureEnabled}static set AmbientTextureEnabled(e){_e.AmbientTextureEnabled=e}static get OpacityTextureEnabled(){return _e.OpacityTextureEnabled}static set OpacityTextureEnabled(e){_e.OpacityTextureEnabled=e}static get ReflectionTextureEnabled(){return _e.ReflectionTextureEnabled}static set ReflectionTextureEnabled(e){_e.ReflectionTextureEnabled=e}static get EmissiveTextureEnabled(){return _e.EmissiveTextureEnabled}static set EmissiveTextureEnabled(e){_e.EmissiveTextureEnabled=e}static get SpecularTextureEnabled(){return _e.SpecularTextureEnabled}static set SpecularTextureEnabled(e){_e.SpecularTextureEnabled=e}static get BumpTextureEnabled(){return _e.BumpTextureEnabled}static set BumpTextureEnabled(e){_e.BumpTextureEnabled=e}static get LightmapTextureEnabled(){return _e.LightmapTextureEnabled}static set LightmapTextureEnabled(e){_e.LightmapTextureEnabled=e}static get RefractionTextureEnabled(){return _e.RefractionTextureEnabled}static set RefractionTextureEnabled(e){_e.RefractionTextureEnabled=e}static get ColorGradingTextureEnabled(){return _e.ColorGradingTextureEnabled}static set ColorGradingTextureEnabled(e){_e.ColorGradingTextureEnabled=e}static get FresnelEnabled(){return _e.FresnelEnabled}static set FresnelEnabled(e){_e.FresnelEnabled=e}}(0,y.gn)([(0,M.oU)("diffuseTexture")],ji.prototype,"_diffuseTexture",void 0),(0,y.gn)([(0,M.wz)("_markAllSubMeshesAsTexturesAndMiscDirty")],ji.prototype,"diffuseTexture",void 0),(0,y.gn)([(0,M.oU)("ambientTexture")],ji.prototype,"_ambientTexture",void 0),(0,y.gn)([(0,M.wz)("_markAllSubMeshesAsTexturesDirty")],ji.prototype,"ambientTexture",void 0),(0,y.gn)([(0,M.oU)("opacityTexture")],ji.prototype,"_opacityTexture",void 0),(0,y.gn)([(0,M.wz)("_markAllSubMeshesAsTexturesAndMiscDirty")],ji.prototype,"opacityTexture",void 0),(0,y.gn)([(0,M.oU)("reflectionTexture")],ji.prototype,"_reflectionTexture",void 0),(0,y.gn)([(0,M.wz)("_markAllSubMeshesAsTexturesDirty")],ji.prototype,"reflectionTexture",void 0),(0,y.gn)([(0,M.oU)("emissiveTexture")],ji.prototype,"_emissiveTexture",void 0),(0,y.gn)([(0,M.wz)("_markAllSubMeshesAsTexturesDirty")],ji.prototype,"emissiveTexture",void 0),(0,y.gn)([(0,M.oU)("specularTexture")],ji.prototype,"_specularTexture",void 0),(0,y.gn)([(0,M.wz)("_markAllSubMeshesAsTexturesDirty")],ji.prototype,"specularTexture",void 0),(0,y.gn)([(0,M.oU)("bumpTexture")],ji.prototype,"_bumpTexture",void 0),(0,y.gn)([(0,M.wz)("_markAllSubMeshesAsTexturesDirty")],ji.prototype,"bumpTexture",void 0),(0,y.gn)([(0,M.oU)("lightmapTexture")],ji.prototype,"_lightmapTexture",void 0),(0,y.gn)([(0,M.wz)("_markAllSubMeshesAsTexturesDirty")],ji.prototype,"lightmapTexture",void 0),(0,y.gn)([(0,M.oU)("refractionTexture")],ji.prototype,"_refractionTexture",void 0),(0,y.gn)([(0,M.wz)("_markAllSubMeshesAsTexturesDirty")],ji.prototype,"refractionTexture",void 0),(0,y.gn)([(0,M.n9)("ambient")],ji.prototype,"ambientColor",void 0),(0,y.gn)([(0,M.n9)("diffuse")],ji.prototype,"diffuseColor",void 0),(0,y.gn)([(0,M.n9)("specular")],ji.prototype,"specularColor",void 0),(0,y.gn)([(0,M.n9)("emissive")],ji.prototype,"emissiveColor",void 0),(0,y.gn)([(0,M.qC)()],ji.prototype,"specularPower",void 0),(0,y.gn)([(0,M.qC)("useAlphaFromDiffuseTexture")],ji.prototype,"_useAlphaFromDiffuseTexture",void 0),(0,y.gn)([(0,M.wz)("_markAllSubMeshesAsTexturesAndMiscDirty")],ji.prototype,"useAlphaFromDiffuseTexture",void 0),(0,y.gn)([(0,M.qC)("useEmissiveAsIllumination")],ji.prototype,"_useEmissiveAsIllumination",void 0),(0,y.gn)([(0,M.wz)("_markAllSubMeshesAsTexturesDirty")],ji.prototype,"useEmissiveAsIllumination",void 0),(0,y.gn)([(0,M.qC)("linkEmissiveWithDiffuse")],ji.prototype,"_linkEmissiveWithDiffuse",void 0),(0,y.gn)([(0,M.wz)("_markAllSubMeshesAsTexturesDirty")],ji.prototype,"linkEmissiveWithDiffuse",void 0),(0,y.gn)([(0,M.qC)("useSpecularOverAlpha")],ji.prototype,"_useSpecularOverAlpha",void 0),(0,y.gn)([(0,M.wz)("_markAllSubMeshesAsTexturesDirty")],ji.prototype,"useSpecularOverAlpha",void 0),(0,y.gn)([(0,M.qC)("useReflectionOverAlpha")],ji.prototype,"_useReflectionOverAlpha",void 0),(0,y.gn)([(0,M.wz)("_markAllSubMeshesAsTexturesDirty")],ji.prototype,"useReflectionOverAlpha",void 0),(0,y.gn)([(0,M.qC)("disableLighting")],ji.prototype,"_disableLighting",void 0),(0,y.gn)([(0,M.wz)("_markAllSubMeshesAsLightsDirty")],ji.prototype,"disableLighting",void 0),(0,y.gn)([(0,M.qC)("useObjectSpaceNormalMap")],ji.prototype,"_useObjectSpaceNormalMap",void 0),(0,y.gn)([(0,M.wz)("_markAllSubMeshesAsTexturesDirty")],ji.prototype,"useObjectSpaceNormalMap",void 0),(0,y.gn)([(0,M.qC)("useParallax")],ji.prototype,"_useParallax",void 0),(0,y.gn)([(0,M.wz)("_markAllSubMeshesAsTexturesDirty")],ji.prototype,"useParallax",void 0),(0,y.gn)([(0,M.qC)("useParallaxOcclusion")],ji.prototype,"_useParallaxOcclusion",void 0),(0,y.gn)([(0,M.wz)("_markAllSubMeshesAsTexturesDirty")],ji.prototype,"useParallaxOcclusion",void 0),(0,y.gn)([(0,M.qC)()],ji.prototype,"parallaxScaleBias",void 0),(0,y.gn)([(0,M.qC)("roughness")],ji.prototype,"_roughness",void 0),(0,y.gn)([(0,M.wz)("_markAllSubMeshesAsTexturesDirty")],ji.prototype,"roughness",void 0),(0,y.gn)([(0,M.qC)()],ji.prototype,"indexOfRefraction",void 0),(0,y.gn)([(0,M.qC)()],ji.prototype,"invertRefractionY",void 0),(0,y.gn)([(0,M.qC)()],ji.prototype,"alphaCutOff",void 0),(0,y.gn)([(0,M.qC)("useLightmapAsShadowmap")],ji.prototype,"_useLightmapAsShadowmap",void 0),(0,y.gn)([(0,M.wz)("_markAllSubMeshesAsTexturesDirty")],ji.prototype,"useLightmapAsShadowmap",void 0),(0,y.gn)([(0,M.qQ)("diffuseFresnelParameters")],ji.prototype,"_diffuseFresnelParameters",void 0),(0,y.gn)([(0,M.wz)("_markAllSubMeshesAsFresnelDirty")],ji.prototype,"diffuseFresnelParameters",void 0),(0,y.gn)([(0,M.qQ)("opacityFresnelParameters")],ji.prototype,"_opacityFresnelParameters",void 0),(0,y.gn)([(0,M.wz)("_markAllSubMeshesAsFresnelAndMiscDirty")],ji.prototype,"opacityFresnelParameters",void 0),(0,y.gn)([(0,M.qQ)("reflectionFresnelParameters")],ji.prototype,"_reflectionFresnelParameters",void 0),(0,y.gn)([(0,M.wz)("_markAllSubMeshesAsFresnelDirty")],ji.prototype,"reflectionFresnelParameters",void 0),(0,y.gn)([(0,M.qQ)("refractionFresnelParameters")],ji.prototype,"_refractionFresnelParameters",void 0),(0,y.gn)([(0,M.wz)("_markAllSubMeshesAsFresnelDirty")],ji.prototype,"refractionFresnelParameters",void 0),(0,y.gn)([(0,M.qQ)("emissiveFresnelParameters")],ji.prototype,"_emissiveFresnelParameters",void 0),(0,y.gn)([(0,M.wz)("_markAllSubMeshesAsFresnelDirty")],ji.prototype,"emissiveFresnelParameters",void 0),(0,y.gn)([(0,M.qC)("useReflectionFresnelFromSpecular")],ji.prototype,"_useReflectionFresnelFromSpecular",void 0),(0,y.gn)([(0,M.wz)("_markAllSubMeshesAsFresnelDirty")],ji.prototype,"useReflectionFresnelFromSpecular",void 0),(0,y.gn)([(0,M.qC)("useGlossinessFromSpecularMapAlpha")],ji.prototype,"_useGlossinessFromSpecularMapAlpha",void 0),(0,y.gn)([(0,M.wz)("_markAllSubMeshesAsTexturesDirty")],ji.prototype,"useGlossinessFromSpecularMapAlpha",void 0),(0,y.gn)([(0,M.qC)("maxSimultaneousLights")],ji.prototype,"_maxSimultaneousLights",void 0),(0,y.gn)([(0,M.wz)("_markAllSubMeshesAsLightsDirty")],ji.prototype,"maxSimultaneousLights",void 0),(0,y.gn)([(0,M.qC)("invertNormalMapX")],ji.prototype,"_invertNormalMapX",void 0),(0,y.gn)([(0,M.wz)("_markAllSubMeshesAsTexturesDirty")],ji.prototype,"invertNormalMapX",void 0),(0,y.gn)([(0,M.qC)("invertNormalMapY")],ji.prototype,"_invertNormalMapY",void 0),(0,y.gn)([(0,M.wz)("_markAllSubMeshesAsTexturesDirty")],ji.prototype,"invertNormalMapY",void 0),(0,y.gn)([(0,M.qC)("twoSidedLighting")],ji.prototype,"_twoSidedLighting",void 0),(0,y.gn)([(0,M.wz)("_markAllSubMeshesAsTexturesDirty")],ji.prototype,"twoSidedLighting",void 0),(0,y.gn)([(0,M.qC)()],ji.prototype,"useLogarithmicDepth",null),(0,x.H)("BABYLON.StandardMaterial",ji),r.x.DefaultMaterialFactory=e=>new ji("default material",e);var Yi=i(2668),qi=i(9370),Ki=i(3192);a.Kj._instancedMeshFactory=(e,t)=>{const i=new Qi(e,t);if(t.instancedBuffers){i.instancedBuffers={};for(const e in t.instancedBuffers)i.instancedBuffers[e]=t.instancedBuffers[e]}return i};class Qi extends qi.x{constructor(e,t){super(e,t.getScene()),this._indexInSourceMeshInstanceArray=-1,this._distanceToCamera=0,t.addInstance(this),this._sourceMesh=t,this._unIndexed=t._unIndexed,this.position.copyFrom(t.position),this.rotation.copyFrom(t.rotation),this.scaling.copyFrom(t.scaling),t.rotationQuaternion&&(this.rotationQuaternion=t.rotationQuaternion.clone()),this.animations=t.animations.slice();for(const i of t.getAnimationRanges())null!=i&&this.createAnimationRange(i.name,i.from,i.to);this.infiniteDistance=t.infiniteDistance,this.setPivotMatrix(t.getPivotMatrix()),this.refreshBoundingInfo(!0,!0),this._syncSubMeshes()}getClassName(){return"InstancedMesh"}get lightSources(){return this._sourceMesh._lightSources}_resyncLightSources(){}_resyncLightSource(){}_removeLightSource(){}get receiveShadows(){return this._sourceMesh.receiveShadows}get material(){return this._sourceMesh.material}get visibility(){return this._sourceMesh.visibility}get skeleton(){return this._sourceMesh.skeleton}get renderingGroupId(){return this._sourceMesh.renderingGroupId}set renderingGroupId(e){this._sourceMesh&&e!==this._sourceMesh.renderingGroupId&&U.Y.Warn("Note - setting renderingGroupId of an instanced mesh has no effect on the scene")}getTotalVertices(){return this._sourceMesh?this._sourceMesh.getTotalVertices():0}getTotalIndices(){return this._sourceMesh.getTotalIndices()}get sourceMesh(){return this._sourceMesh}createInstance(e){return this._sourceMesh.createInstance(e)}isReady(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._sourceMesh.isReady(e,!0)}getVerticesData(e,t,i){return this._sourceMesh.getVerticesData(e,t,i)}setVerticesData(e,t,i,s){return this.sourceMesh&&this.sourceMesh.setVerticesData(e,t,i,s),this.sourceMesh}updateVerticesData(e,t,i,s){return this.sourceMesh&&this.sourceMesh.updateVerticesData(e,t,i,s),this.sourceMesh}setIndices(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.sourceMesh&&this.sourceMesh.setIndices(e,t),this.sourceMesh}isVerticesDataPresent(e){return this._sourceMesh.isVerticesDataPresent(e)}getIndices(){return this._sourceMesh.getIndices()}get _positions(){return this._sourceMesh._positions}refreshBoundingInfo(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.hasBoundingInfo&&this.getBoundingInfo().isLocked)return this;const i=this._sourceMesh.geometry?this._sourceMesh.geometry.boundingBias:null;return this._refreshBoundingInfo(this._sourceMesh._getPositionData(e,t),i),this}_preActivate(){return this._currentLOD&&this._currentLOD._preActivate(),this}_activate(e,t){if(super._activate(e,t),this._sourceMesh.subMeshes||U.Y.Warn("Instances should only be created for meshes with geometry."),this._currentLOD){if(this._currentLOD._getWorldMatrixDeterminant()>=0!=this._getWorldMatrixDeterminant()>=0)return this._internalAbstractMeshDataInfo._actAsRegularMesh=!0,!0;if(this._internalAbstractMeshDataInfo._actAsRegularMesh=!1,this._currentLOD._registerInstanceForRenderId(this,e),t){if(!this._currentLOD._internalAbstractMeshDataInfo._isActiveIntermediate)return this._currentLOD._internalAbstractMeshDataInfo._onlyForInstancesIntermediate=!0,!0}else if(!this._currentLOD._internalAbstractMeshDataInfo._isActive)return this._currentLOD._internalAbstractMeshDataInfo._onlyForInstances=!0,!0}return!1}_postActivate(){this._sourceMesh.edgesShareWithInstances&&this._sourceMesh._edgesRenderer&&this._sourceMesh._edgesRenderer.isEnabled&&this._sourceMesh._renderingGroup?(this._sourceMesh._renderingGroup._edgesRenderers.pushNoDuplicate(this._sourceMesh._edgesRenderer),this._sourceMesh._edgesRenderer.customInstances.push(this.getWorldMatrix())):this._edgesRenderer&&this._edgesRenderer.isEnabled&&this._sourceMesh._renderingGroup&&this._sourceMesh._renderingGroup._edgesRenderers.push(this._edgesRenderer)}getWorldMatrix(){if(this._currentLOD&&this._currentLOD.billboardMode!==Yi.Y.BILLBOARDMODE_NONE&&this._currentLOD._masterMesh!==this){this._billboardWorldMatrix||(this._billboardWorldMatrix=new u.y3);const e=this._currentLOD._masterMesh;return this._currentLOD._masterMesh=this,u.jp.Vector3[7].copyFrom(this._currentLOD.position),this._currentLOD.position.set(0,0,0),this._billboardWorldMatrix.copyFrom(this._currentLOD.computeWorldMatrix(!0)),this._currentLOD.position.copyFrom(u.jp.Vector3[7]),this._currentLOD._masterMesh=e,this._billboardWorldMatrix}return super.getWorldMatrix()}get isAnInstance(){return!0}getLOD(e){if(!e)return this;const t=this.sourceMesh.getLODLevels();if(t&&0!==t.length){const t=this.getBoundingInfo();this._currentLOD=this.sourceMesh.getLOD(e,t.boundingSphere)}else this._currentLOD=this.sourceMesh;return this._currentLOD}_preActivateForIntermediateRendering(e){return this.sourceMesh._preActivateForIntermediateRendering(e)}_syncSubMeshes(){if(this.releaseSubMeshes(),this._sourceMesh.subMeshes)for(let e=0;e<this._sourceMesh.subMeshes.length;e++)this._sourceMesh.subMeshes[e].clone(this,this._sourceMesh);return this}_generatePointsArray(){return this._sourceMesh._generatePointsArray()}_updateBoundingInfo(){return this.hasBoundingInfo?this.getBoundingInfo().update(this.worldMatrixFromCache):this.buildBoundingInfo(this.absolutePosition,this.absolutePosition,this.worldMatrixFromCache),this._updateSubMeshesBoundingInfo(this.worldMatrixFromCache),this}clone(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2?arguments[2]:void 0;const s=((arguments.length>3?arguments[3]:void 0)||this._sourceMesh).createInstance(e);if(Ki.j.DeepCopy(this,s,["name","subMeshes","uniqueId","parent","lightSources","receiveShadows","material","visibility","skeleton","sourceMesh","isAnInstance","facetNb","isFacetDataEnabled","isBlocked","useBones","hasInstances","collider","edgesRenderer","forward","up","right","absolutePosition","absoluteScaling","absoluteRotationQuaternion","isWorldMatrixFrozen","nonUniformScaling","behaviors","worldMatrixFromCache","hasThinInstances","hasBoundingInfo"],[]),this.refreshBoundingInfo(),t&&(s.parent=t),!i)for(let n=0;n<this.getScene().meshes.length;n++){const e=this.getScene().meshes[n];e.parent===this&&e.clone(e.name,s)}return s.computeWorldMatrix(!0),this.onClonedObservable.notifyObservers(s),s}dispose(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._sourceMesh.removeInstance(this),super.dispose(e,t)}_serializeAsParent(e){super._serializeAsParent(e),e.parentId=this._sourceMesh.uniqueId,e.parentInstanceIndex=this._indexInSourceMeshInstanceArray}instantiateHierarchy(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0;const s=this.clone("Clone of "+(this.name||this.id),e||this.parent,!0,t&&t.newSourcedMesh);s&&i&&i(this,s);for(const n of this.getChildTransformNodes(!0))n.instantiateHierarchy(s,t,i);return s}}a.Kj.prototype.registerInstancedBuffer=function(e,t){var i,s;if(null===(s=null===(i=this._userInstancedBuffersStorage)||void 0===i?void 0:i.vertexBuffers[e])||void 0===s||s.dispose(),!this.instancedBuffers){this.instancedBuffers={};for(const e of this.instances)e.instancedBuffers={};this._userInstancedBuffersStorage||(this._userInstancedBuffersStorage={data:{},vertexBuffers:{},strides:{},sizes:{},vertexArrayObjects:this.getEngine().getCaps().vertexArrayObject?{}:void 0})}this.instancedBuffers[e]=null,this._userInstancedBuffersStorage.strides[e]=t,this._userInstancedBuffersStorage.sizes[e]=32*t,this._userInstancedBuffersStorage.data[e]=new Float32Array(this._userInstancedBuffersStorage.sizes[e]),this._userInstancedBuffersStorage.vertexBuffers[e]=new Z.o(this.getEngine(),this._userInstancedBuffersStorage.data[e],e,!0,!1,t,!0);for(const n of this.instances)n.instancedBuffers[e]=null;this._invalidateInstanceVertexArrayObject(),this._markSubMeshesAsAttributesDirty()},a.Kj.prototype._processInstancedBuffers=function(e,t){const i=e?e.length:0;for(const s in this.instancedBuffers){let n=this._userInstancedBuffersStorage.sizes[s];const r=this._userInstancedBuffersStorage.strides[s],a=(i+1)*r;for(;n<a;)n*=2;this._userInstancedBuffersStorage.data[s].length!=n&&(this._userInstancedBuffersStorage.data[s]=new Float32Array(n),this._userInstancedBuffersStorage.sizes[s]=n,this._userInstancedBuffersStorage.vertexBuffers[s]&&(this._userInstancedBuffersStorage.vertexBuffers[s].dispose(),this._userInstancedBuffersStorage.vertexBuffers[s]=null));const o=this._userInstancedBuffersStorage.data[s];let l=0;if(t){const e=this.instancedBuffers[s];e.toArray?e.toArray(o,l):e.copyToArray?e.copyToArray(o,l):o[l]=e,l+=r}for(let t=0;t<i;t++){const i=e[t].instancedBuffers[s];i.toArray?i.toArray(o,l):i.copyToArray?i.copyToArray(o,l):o[l]=i,l+=r}this._userInstancedBuffersStorage.vertexBuffers[s]?this._userInstancedBuffersStorage.vertexBuffers[s].updateDirectly(o,0):(this._userInstancedBuffersStorage.vertexBuffers[s]=new Z.o(this.getEngine(),this._userInstancedBuffersStorage.data[s],s,!0,!1,r,!0),this._invalidateInstanceVertexArrayObject())}},a.Kj.prototype._invalidateInstanceVertexArrayObject=function(){if(this._userInstancedBuffersStorage&&void 0!==this._userInstancedBuffersStorage.vertexArrayObjects){for(const e in this._userInstancedBuffersStorage.vertexArrayObjects)this.getEngine().releaseVertexArrayObject(this._userInstancedBuffersStorage.vertexArrayObjects[e]);this._userInstancedBuffersStorage.vertexArrayObjects={}}},a.Kj.prototype._disposeInstanceSpecificData=function(){for(this._instanceDataStorage.instancesBuffer&&(this._instanceDataStorage.instancesBuffer.dispose(),this._instanceDataStorage.instancesBuffer=null);this.instances.length;)this.instances[0].dispose();for(const e in this.instancedBuffers)this._userInstancedBuffersStorage.vertexBuffers[e]&&this._userInstancedBuffersStorage.vertexBuffers[e].dispose();this._invalidateInstanceVertexArrayObject(),this.instancedBuffers={}};const Zi=1.5,$i=1.5,Ji=.4,es=6,ts=-5,is=-5,ss=1.2,ns=[[0,0,0,0,0,0,1,1,1],[0,0,0,1,1,1,1,1,1],[0,0,0,1,1,1,1,1,1],[0,0,0,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1],[0,0,0,1,1,1,1,1,1],[0,0,0,1,1,1,1,1,1]],rs=e=>e+"-"+Math.random().toString(36).slice(2);let as=function(){function e(e,t){this.engine=null,this.scene=null,this.camera=null,this.viewportRatio=ss,this.nodes=[],this.frameCount=0,this.onFrame=()=>{const e=this.frameCount;for(let t=0;t<this.nodes.length;t++){const i=this.nodes[t];for(let s=0;s<i.length;s++){const n=i[s];n&&(n.position.y=Zi*(Math.sin(e*$i*.01-.2*s+(e*$i*.006+.3*t))/10+Math.sin(e*$i*.01-s*t*.2)/10+Math.cos(e*$i*.02-.2*s)/8-.25))}}this.frameCount=e+1,this.scene.render()},this.canvas=e,this.engine=new n.D(e,!0,{stencil:!0}),this.dark=t,this.createScene(),this.populateScene(),this.engine.runRenderLoop(this.onFrame)}var t=e.prototype;return t.createScene=function(){this.scene=new r.x(this.engine),this.camera=new K("cam",0,0,0,u.P.Zero(),this.scene,!0),this.camera.minZ=.1,this.camera.setPosition(new u.P(5,5,-5)),this.camera.mode=1,this.camera.orthoTop=1.25*es,this.camera.orthoBottom=-es,this.camera.orthoLeft=-es*this.viewportRatio,this.camera.orthoRight=es*this.viewportRatio},t.createBlock=function(e){const t={faceUV:[new u.Lt(0,0,1,1),new u.Lt(0,0,.9,.9),new u.Lt(0,0,1,.9),new u.Lt(0,0,1,1),new u.Lt(0,0,1,1),new u.Lt(0,0,1,0)],wrap:!0},i=new ji(rs("mat"));i.emissiveColor=d.Wo.White(),i.diffuseColor=d.Wo.White(),i.emissiveColor=d.Wo.White(),i.diffuseTexture=e;const s=p(rs("box"),{size:1,height:2,...t},this.scene);return s.material=i,s},t.populateScene=function(){const e=c("foor",{size:150},this.scene);e.material=new ji(rs("mat")),this.dark?e.material.emissiveColor=new d.Wo(.08,.12,.19):e.material.emissiveColor=d.Wo.White(),e.rotation.x=Math.PI/2,e.position.y=0;const t=new Yi.Y("root");t.position.x=ts,t.position.z=is;const i=new me(this.dark?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQQAAAEECAIAAABBat1dAAAAAXNSR0IArs4c6QAAAoxJREFUeJzt1bENg0AQAMG3RTdEiAJcAkVQr+XI/ThZITp4BzPRXXbJ6h6v4xzAGM/ZB8C/EANEDJDlvnw/71l3wBTrtl+zzwARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMkOW+rNs+6w6YzmeAiAEiBsgPeloGjEmClbsAAAAASUVORK5CYII=":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQQAAAEECAIAAABBat1dAAAEtGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNS41LjAiPgogPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iCiAgICB4bWxuczpleGlmPSJodHRwOi8vbnMuYWRvYmUuY29tL2V4aWYvMS4wLyIKICAgIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIKICAgIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIKICAgIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIgogICAgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIKICAgdGlmZjpJbWFnZUxlbmd0aD0iMjYwIgogICB0aWZmOkltYWdlV2lkdGg9IjI2MCIKICAgdGlmZjpSZXNvbHV0aW9uVW5pdD0iMiIKICAgdGlmZjpYUmVzb2x1dGlvbj0iNzIvMSIKICAgdGlmZjpZUmVzb2x1dGlvbj0iNzIvMSIKICAgZXhpZjpQaXhlbFhEaW1lbnNpb249IjI2MCIKICAgZXhpZjpQaXhlbFlEaW1lbnNpb249IjI2MCIKICAgZXhpZjpDb2xvclNwYWNlPSIxIgogICBwaG90b3Nob3A6Q29sb3JNb2RlPSIzIgogICBwaG90b3Nob3A6SUNDUHJvZmlsZT0ic1JHQiBJRUM2MTk2Ni0yLjEiCiAgIHhtcDpNb2RpZnlEYXRlPSIyMDIzLTAzLTMwVDEyOjIxOjQ0KzAyOjAwIgogICB4bXA6TWV0YWRhdGFEYXRlPSIyMDIzLTAzLTMwVDEyOjIxOjQ0KzAyOjAwIj4KICAgPHhtcE1NOkhpc3Rvcnk+CiAgICA8cmRmOlNlcT4KICAgICA8cmRmOmxpCiAgICAgIHN0RXZ0OmFjdGlvbj0icHJvZHVjZWQiCiAgICAgIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFmZmluaXR5IFBob3RvIDEuMTAuNSIKICAgICAgc3RFdnQ6d2hlbj0iMjAyMy0wMy0zMFQxMjoyMTo0NCswMjowMCIvPgogICAgPC9yZGY6U2VxPgogICA8L3htcE1NOkhpc3Rvcnk+CiAgPC9yZGY6RGVzY3JpcHRpb24+CiA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgo8P3hwYWNrZXQgZW5kPSJyIj8+KyXU8wAAAYBpQ0NQc1JHQiBJRUM2MTk2Ni0yLjEAACiRdZHfK4NRGMc/24hmmuLChbQ0rkZDLW6ULY1aWjNluNne/VL78fa+k+RWuV1R4savC/4CbpVrpYiU3HJN3LBez2tqkj2n5zyf8z3neTrnOWCN5pS83uCFfKGkRYJ+11xs3tX0hI1u7LThiCu6Oh4Oh6hr77dYzHjdb9aqf+5fa0mmdAUszcJjiqqVhCeFQysl1eQt4Q4lG08Knwh7NLmg8I2pJ6r8bHKmyp8ma9FIAKxtwq7ML078YiWr5YXl5bjzuWXl5z7mSxypwuyMxB7xLnQiBPHjYooJAvgYZFRmH/0MMSAr6uR7v/OnKUquIrPKKhpLZMhSwiPqslRPSUyLnpKRY9Xs/9++6unhoWp1hx8aHw3jtReaNqFSNoyPA8OoHILtAc4LtfziPoy8iV6uae49cK7D6UVNS2zD2QZ03qtxLf4t2cSt6TS8HENrDNqvwL5Q7dnPPkd3EF2Tr7qEnV3ok/POxS8WjGfBOfyPugAAAAlwSFlzAAALEwAACxMBAJqcGAAAAolJREFUeJzt1SEOw0AMAMFrFRpUqf//XqOENB8oWUX5wRXMIJuZrPz47N8BjPGcfQD8CzFAxABZ7sv7tc66A6bYjvOafQaIGCBigIgBIgaIGCBigIgBIgaIGCBigIgBIgaIGCBigIgBIgaIGCBigIgBIgaIGCBigIgBIgaIGCBigIgBIgaIGCBigIgBIgaIGCBigIgBIgaIGCBigIgBIgaIGCBigIgBIgaIGCBigIgBIgaIGCBigIgBIgaIGCBigIgBIgaIGCBigIgBIgaIGCBigIgBIgaIGCBigIgBIgaIGCBigIgBIgaIGCBigIgBIgaIGCBigIgBIgaIGCBigIgBIgaIGCBigIgBIgaIGCBigIgBIgaIGCBigIgBIgaIGCBigIgBIgaIGCBigIgBIgaIGCBigIgBIgaIGCBigIgBIgaIGCBigIgBIgaIGCBigIgBIgaIGCBigIgBIgaIGCBigIgBIgaIGCBigIgBIgaIGCBigIgBIgaIGCBigIgBIgaIGCBigIgBIgaIGCBigIgBIgaIGCBigIgBIgaIGCBigIgBIgaIGCBigIgBIgaIGCBigIgBIgaIGCBigIgBIgaIGCBigIgBIgaIGCBigIgBIgaIGCBigIgBIgaIGCBigIgBIgaIGCBigIgBIgaIGCBigIgBIgaIGCBigIgBIgaIGCBigIgBIgaIGCBigIgBIgaIGCBigIgBIgaIGCBigIgBIgaIGCBigIgBIgaIGCBigIgBIgaIGCBigIgBIgaIGCBigIgBIgaIGCBigIgBIgaIGCBigIgBIgaIGCBigIgBIgaIGCBigIgBIgaIGCBigIgBIgaIGCBigCz3ZTvOWXfAdD4DRAwQMUB+lVEKnWnIPoMAAAAASUVORK5CYII="),s=this.createBlock(i);s.parent=t,s.setEnabled(!1),window.floor=e,window.root=t;for(let n=0;n<9;n++){const e=[];this.nodes[n]=e;for(let i=0;i<9;i++)if(ns[n][i]){const r=s.createInstance();r.position.x=(1+Ji)*n,r.position.z=(1+Ji)*i,r.parent=t,r.setEnabled(!0),e[i]=r}else e[i]=!1}},t.onResize=function(){this.engine.resize()},t.dispose=function(){this.camera.dispose(),this.scene.dispose(),this.engine.dispose()},e}();var os=e=>{let{dark:t=!1}=e;const i=(0,s.useRef)(null);return(0,s.useEffect)((()=>{if(!i.current)return;const e=new as(i.current,t);i.current.classList.add("visible");const s=()=>e.onResize();return window.addEventListener("resize",s),()=>{e.dispose(),window.removeEventListener("resize",s)}}),[i]),s.createElement("div",{className:"animated-grid"},s.createElement("canvas",{className:"viewport",ref:i}))}},6553:function(e,t,i){"use strict";var s=i(7294),n=i(1562),r=i(6733);t.Z=e=>{const t=(0,r.W)();if(e.to&&e.to.startsWith("http"))return s.createElement(n.ZP,e);{const i=t(e.to);return s.createElement(n.ZP,Object.assign({},e,{to:i}))}}},6448:function(e,t,i){"use strict";var s=i(7294),n=i(5900),r=i.n(n),a=i(3698);t.Z=e=>{let{label:t,disabled:i,clear:n=!1,children:o,icon:l}=e;const h=(0,a.Z)(),c=r()("button",{"is-clear":n,"is-disabled":i}),u=s.createElement("div",{className:"button-content"},l?s.createElement("span",{className:"icon"},l):null,t?s.createElement("span",{className:"button-text"},h(t)):null,s.createElement("span",{className:"button-shadow"}));return s.createElement(s.Fragment,null,o({buttonClasses:c,buttonContent:u}))}},1819:function(e,t,i){"use strict";i.d(t,{Z:function(){return u}});var s=i(7294),n=i(78),r=i(3964),a=i.n(r),o=i(8157),l=i(1082);const h=(e,t)=>{const i=(0,o.TG)(t);return e!==o.ZW?"/"+e+i:i};var c=function(e,t,i){const s=function(){if("undefined"!=typeof window)return localStorage.getItem("content-language")}(),n=(0,o.Q3)(),{messages:r,locale:a}=(0,o.E5)(i||o.ZW),c=e?"/":t.pathname||window.location.pathname;return void 0===i||i===s||e||(console.log("--\x3e Removed forced locale"),localStorage.removeItem("content-language")),!i&&s&&s!==a?(console.log("--\x3e Redirect! (A)"),(0,l.navigate)(h(s,c),{replace:!0})):i||s||a===n||e||(console.log("--\x3e Redirect! (B)"),(0,l.navigate)(h(n,c),{replace:!0})),{messages:r,locale:a}};var u=e=>{var t;let{children:i,location:r={},lang:o}=e;const l="undefined"==typeof window,{messages:h,locale:u}=c(l,r,o);return"en"!==u&&a().locale(u,{months:null===(t=h.months)||void 0===t?void 0:t.split("")}),(0,s.useEffect)((()=>{document.querySelector("html").setAttribute("lang",u),document.body.classList.value=u}),[u]),s.createElement(n.Z,{messages:h,locale:u,textComponent:s.Fragment},i)}}}]);
//# sourceMappingURL=commons-4ba9077955db32d8bb93.js.map