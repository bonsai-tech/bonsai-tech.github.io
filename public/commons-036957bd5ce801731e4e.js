/*! For license information please see commons-036957bd5ce801731e4e.js.LICENSE.txt */
(self.webpackChunkbonsai_web=self.webpackChunkbonsai_web||[]).push([[351],{8159:function(e,t,n){"use strict";n(7294);t.Z="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTM3IiBoZWlnaHQ9IjMyIiB2aWV3Qm94PSIwIDAgMTM3IDMyIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8cGF0aCBkPSJNMTIuMDI4IDMxLjQyQzEwLjY1NiAzMS40MiA5LjM5NiAzMS4xNCA4LjI0OCAzMC41OEM3LjEgMjkuOTkyIDYuMTYyIDI5LjIyMiA1LjQzNCAyOC4yN0M0LjcwNiAyNy4yOSA0LjI4NiAyNi4xOTggNC4xNzQgMjQuOTk0VjE2LjM4NEM0LjI4NiAxNS4xOCA0LjcwNiAxNC4xMTYgNS40MzQgMTMuMTkyQzYuMTYyIDEyLjI0IDcuMSAxMS40OTggOC4yNDggMTAuOTY2QzkuMzk2IDEwLjQzNCAxMC42NTYgMTAuMTY4IDEyLjAyOCAxMC4xNjhDMTMuOTYgMTAuMTY4IDE1LjY2OCAxMC42MyAxNy4xNTIgMTEuNTU0QzE4LjY2NCAxMi40NzggMTkuODQgMTMuNzM4IDIwLjY4IDE1LjMzNEMyMS41NDggMTYuOTMgMjEuOTgyIDE4Ljc1IDIxLjk4MiAyMC43OTRDMjEuOTgyIDIyLjgzOCAyMS41NDggMjQuNjU4IDIwLjY4IDI2LjI1NEMxOS44NCAyNy44NSAxOC42NjQgMjkuMTEgMTcuMTUyIDMwLjAzNEMxNS42NjggMzAuOTU4IDEzLjk2IDMxLjQyIDEyLjAyOCAzMS40MlpNMTAuODk0IDI1LjYyNEMxMS43OSAyNS42MjQgMTIuNTc0IDI1LjQxNCAxMy4yNDYgMjQuOTk0QzEzLjk0NiAyNC41NzQgMTQuNDkyIDI0IDE0Ljg4NCAyMy4yNzJDMTUuMjc2IDIyLjU0NCAxNS40NzIgMjEuNzE4IDE1LjQ3MiAyMC43OTRDMTUuNDcyIDE5Ljg0MiAxNS4yNzYgMTkuMDAyIDE0Ljg4NCAxOC4yNzRDMTQuNDkyIDE3LjU0NiAxMy45NDYgMTYuOTg2IDEzLjI0NiAxNi41OTRDMTIuNTc0IDE2LjE3NCAxMS43OSAxNS45NjQgMTAuODk0IDE1Ljk2NEM5Ljk5OCAxNS45NjQgOS4yIDE2LjE3NCA4LjUgMTYuNTk0QzcuOCAxNi45ODYgNy4yNTQgMTcuNTQ2IDYuODYyIDE4LjI3NEM2LjQ5OCAxOS4wMDIgNi4zMTYgMTkuODQyIDYuMzE2IDIwLjc5NEM2LjMxNiAyMS43NDYgNi41MTIgMjIuNTg2IDYuOTA0IDIzLjMxNEM3LjI5NiAyNC4wNDIgNy44MjggMjQuNjE2IDguNSAyNS4wMzZDOS4yIDI1LjQyOCA5Ljk5OCAyNS42MjQgMTAuODk0IDI1LjYyNFpNMC4yNjggMzFWMC41MDhINi42OTRWMTUuNTg2TDUuNjQ0IDIwLjU0Mkw2LjYxIDI1LjQ5OFYzMUgwLjI2OFpNMzUuMDc0NSAzMS40NjJDMzIuOTc0NSAzMS40NjIgMzEuMDcwNSAzMSAyOS4zNjI1IDMwLjA3NkMyNy42ODI1IDI5LjEyNCAyNi4zNTI1IDI3LjgzNiAyNS4zNzI1IDI2LjIxMkMyNC4zOTI1IDI0LjU4OCAyMy45MDI1IDIyLjc2OCAyMy45MDI1IDIwLjc1MkMyMy45MDI1IDE4LjczNiAyNC4zOTI1IDE2LjkzIDI1LjM3MjUgMTUuMzM0QzI2LjM1MjUgMTMuNzM4IDI3LjY4MjUgMTIuNDc4IDI5LjM2MjUgMTEuNTU0QzMxLjA0MjUgMTAuNjAyIDMyLjk0NjUgMTAuMTI2IDM1LjA3NDUgMTAuMTI2QzM3LjIwMjUgMTAuMTI2IDM5LjEwNjUgMTAuNTg4IDQwLjc4NjUgMTEuNTEyQzQyLjQ2NjUgMTIuNDM2IDQzLjc5NjUgMTMuNzEgNDQuNzc2NSAxNS4zMzRDNDUuNzU2NSAxNi45MyA0Ni4yNDY1IDE4LjczNiA0Ni4yNDY1IDIwLjc1MkM0Ni4yNDY1IDIyLjc2OCA0NS43NTY1IDI0LjU4OCA0NC43NzY1IDI2LjIxMkM0My43OTY1IDI3LjgzNiA0Mi40NjY1IDI5LjEyNCA0MC43ODY1IDMwLjA3NkMzOS4xMDY1IDMxIDM3LjIwMjUgMzEuNDYyIDM1LjA3NDUgMzEuNDYyWk0zNS4wNzQ1IDI1LjYyNEMzNS45OTg1IDI1LjYyNCAzNi44MTA1IDI1LjQyOCAzNy41MTA1IDI1LjAzNkMzOC4yMTA1IDI0LjYxNiAzOC43NDI1IDI0LjA0MiAzOS4xMDY1IDIzLjMxNEMzOS40OTg1IDIyLjU1OCAzOS42OTQ1IDIxLjcwNCAzOS42OTQ1IDIwLjc1MkMzOS42OTQ1IDE5LjggMzkuNDk4NSAxOC45NzQgMzkuMTA2NSAxOC4yNzRDMzguNzE0NSAxNy41NDYgMzguMTY4NSAxNi45ODYgMzcuNDY4NSAxNi41OTRDMzYuNzk2NSAxNi4xNzQgMzUuOTk4NSAxNS45NjQgMzUuMDc0NSAxNS45NjRDMzQuMTc4NSAxNS45NjQgMzMuMzgwNSAxNi4xNzQgMzIuNjgwNSAxNi41OTRDMzEuOTgwNSAxNi45ODYgMzEuNDM0NSAxNy41NDYgMzEuMDQyNSAxOC4yNzRDMzAuNjUwNSAxOS4wMDIgMzAuNDU0NSAxOS44NDIgMzAuNDU0NSAyMC43OTRDMzAuNDU0NSAyMS43MTggMzAuNjUwNSAyMi41NTggMzEuMDQyNSAyMy4zMTRDMzEuNDM0NSAyNC4wNDIgMzEuOTgwNSAyNC42MTYgMzIuNjgwNSAyNS4wMzZDMzMuMzgwNSAyNS40MjggMzQuMTc4NSAyNS42MjQgMzUuMDc0NSAyNS42MjRaTTYyLjkyNzcgMzFWMTkuMzY2QzYyLjkyNzcgMTguMzAyIDYyLjU5MTcgMTcuNDQ4IDYxLjkxOTcgMTYuODA0QzYxLjI3NTcgMTYuMTMyIDYwLjQ0OTcgMTUuNzk2IDU5LjQ0MTcgMTUuNzk2QzU4Ljc0MTcgMTUuNzk2IDU4LjEyNTcgMTUuOTUgNTcuNTkzNyAxNi4yNThDNTcuMDYxNyAxNi41MzggNTYuNjQxNyAxNi45NTggNTYuMzMzNyAxNy41MThDNTYuMDI1NyAxOC4wNSA1NS44NzE3IDE4LjY2NiA1NS44NzE3IDE5LjM2Nkw1My4zOTM3IDE4LjE0OEM1My4zOTM3IDE2LjU1MiA1My43NDM3IDE1LjE1MiA1NC40NDM3IDEzLjk0OEM1NS4xNDM3IDEyLjc0NCA1Ni4xMDk3IDExLjgyIDU3LjM0MTcgMTEuMTc2QzU4LjYwMTcgMTAuNTA0IDYwLjAxNTcgMTAuMTY4IDYxLjU4MzcgMTAuMTY4QzYzLjA5NTcgMTAuMTY4IDY0LjQyNTcgMTAuNTMyIDY1LjU3MzcgMTEuMjZDNjYuNzQ5NyAxMS45NiA2Ny42NzM3IDEyLjg5OCA2OC4zNDU3IDE0LjA3NEM2OS4wMTc3IDE1LjI1IDY5LjM1MzcgMTYuNTM4IDY5LjM1MzcgMTcuOTM4VjMxSDYyLjkyNzdaTTQ5LjQ0NTcgMzFWMTAuNTg4SDU1Ljg3MTdWMzFINDkuNDQ1N1pNODAuOTE0OSAzMS41MDRDNzkuNzEwOSAzMS41MDQgNzguNTIwOSAzMS4zNSA3Ny4zNDQ5IDMxLjA0MkM3Ni4xOTY5IDMwLjczNCA3NS4xMTg5IDMwLjMgNzQuMTEwOSAyOS43NEM3My4xMzA5IDI5LjE1MiA3Mi4yOTA5IDI4LjQ4IDcxLjU5MDkgMjcuNzI0TDc1LjI0NDkgMjQuMDI4Qzc1LjkxNjkgMjQuNzU2IDc2LjcxNDkgMjUuMzMgNzcuNjM4OSAyNS43NUM3OC41NjI5IDI2LjE0MiA3OS41NzA5IDI2LjMzOCA4MC42NjI5IDI2LjMzOEM4MS40MTg5IDI2LjMzOCA4MS45OTI5IDI2LjIyNiA4Mi4zODQ5IDI2LjAwMkM4Mi44MDQ5IDI1Ljc3OCA4My4wMTQ5IDI1LjQ3IDgzLjAxNDkgMjUuMDc4QzgzLjAxNDkgMjQuNTc0IDgyLjc2MjkgMjQuMTk2IDgyLjI1ODkgMjMuOTQ0QzgxLjc4MjkgMjMuNjY0IDgxLjE2NjkgMjMuNDI2IDgwLjQxMDkgMjMuMjNDNzkuNjU0OSAyMy4wMDYgNzguODU2OSAyMi43NjggNzguMDE2OSAyMi41MTZDNzcuMTc2OSAyMi4yNjQgNzYuMzc4OSAyMS45MTQgNzUuNjIyOSAyMS40NjZDNzQuODY2OSAyMS4wMTggNzQuMjUwOSAyMC40MDIgNzMuNzc0OSAxOS42MThDNzMuMjk4OSAxOC44MDYgNzMuMDYwOSAxNy43ODQgNzMuMDYwOSAxNi41NTJDNzMuMDYwOSAxNS4yMzYgNzMuMzk2OSAxNC4xMDIgNzQuMDY4OSAxMy4xNUM3NC43NDA5IDEyLjE3IDc1LjY5MjkgMTEuNCA3Ni45MjQ5IDEwLjg0Qzc4LjE1NjkgMTAuMjggNzkuNTk4OSAxMCA4MS4yNTA5IDEwQzgyLjk4NjkgMTAgODQuNTgyOSAxMC4zMDggODYuMDM4OSAxMC45MjRDODcuNTIyOSAxMS41MTIgODguNzI2OSAxMi4zOTQgODkuNjUwOSAxMy41N0w4NS45OTY5IDE3LjI2NkM4NS4zNTI5IDE2LjUxIDg0LjYyNDkgMTUuOTc4IDgzLjgxMjkgMTUuNjdDODMuMDI4OSAxNS4zNjIgODIuMjU4OSAxNS4yMDggODEuNTAyOSAxNS4yMDhDODAuNzc0OSAxNS4yMDggODAuMjI4OSAxNS4zMiA3OS44NjQ5IDE1LjU0NEM3OS41MDA5IDE1Ljc0IDc5LjMxODkgMTYuMDM0IDc5LjMxODkgMTYuNDI2Qzc5LjMxODkgMTYuODQ2IDc5LjU1NjkgMTcuMTgyIDgwLjAzMjkgMTcuNDM0QzgwLjUwODkgMTcuNjg2IDgxLjEyNDkgMTcuOTEgODEuODgwOSAxOC4xMDZDODIuNjM2OSAxOC4zMDIgODMuNDM0OSAxOC41NCA4NC4yNzQ5IDE4LjgyQzg1LjExNDkgMTkuMSA4NS45MTI5IDE5LjQ3OCA4Ni42Njg5IDE5Ljk1NEM4Ny40MjQ5IDIwLjQzIDg4LjA0MDkgMjEuMDc0IDg4LjUxNjkgMjEuODg2Qzg4Ljk5MjkgMjIuNjcgODkuMjMwOSAyMy43MDYgODkuMjMwOSAyNC45OTRDODkuMjMwOSAyNi45ODIgODguNDc0OSAyOC41NjQgODYuOTYyOSAyOS43NEM4NS40Nzg5IDMwLjkxNiA4My40NjI5IDMxLjUwNCA4MC45MTQ5IDMxLjUwNFpNMTAxLjI0MyAzMS40MkM5OS4zNjcyIDMxLjQyIDk3LjY4NzIgMzAuOTU4IDk2LjIwMzIgMzAuMDM0Qzk0Ljc0NzIgMjkuMTEgOTMuNTg1MiAyNy44NSA5Mi43MTcyIDI2LjI1NEM5MS44NzcyIDI0LjY1OCA5MS40NTcyIDIyLjgzOCA5MS40NTcyIDIwLjc5NEM5MS40NTcyIDE4Ljc1IDkxLjg3NzIgMTYuOTMgOTIuNzE3MiAxNS4zMzRDOTMuNTg1MiAxMy43MzggOTQuNzQ3MiAxMi40NzggOTYuMjAzMiAxMS41NTRDOTcuNjg3MiAxMC42MyA5OS4zNjcyIDEwLjE2OCAxMDEuMjQzIDEwLjE2OEMxMDIuNjE1IDEwLjE2OCAxMDMuODQ3IDEwLjQzNCAxMDQuOTM5IDEwLjk2NkMxMDYuMDU5IDExLjQ5OCAxMDYuOTY5IDEyLjI0IDEwNy42NjkgMTMuMTkyQzEwOC4zNjkgMTQuMTE2IDEwOC43NjEgMTUuMTggMTA4Ljg0NSAxNi4zODRWMjUuMjA0QzEwOC43NjEgMjYuNDA4IDEwOC4zNjkgMjcuNDg2IDEwNy42NjkgMjguNDM4QzEwNi45OTcgMjkuMzYyIDEwNi4xMDEgMzAuMDkgMTA0Ljk4MSAzMC42MjJDMTAzLjg2MSAzMS4xNTQgMTAyLjYxNSAzMS40MiAxMDEuMjQzIDMxLjQyWk0xMDIuNTQ1IDI1LjYyNEMxMDMuOTE3IDI1LjYyNCAxMDUuMDIzIDI1LjE3NiAxMDUuODYzIDI0LjI4QzEwNi43MDMgMjMuMzU2IDEwNy4xMjMgMjIuMTk0IDEwNy4xMjMgMjAuNzk0QzEwNy4xMjMgMTkuODQyIDEwNi45MjcgMTkuMDAyIDEwNi41MzUgMTguMjc0QzEwNi4xNzEgMTcuNTQ2IDEwNS42MzkgMTYuOTg2IDEwNC45MzkgMTYuNTk0QzEwNC4yNjcgMTYuMTc0IDEwMy40ODMgMTUuOTY0IDEwMi41ODcgMTUuOTY0QzEwMS42OTEgMTUuOTY0IDEwMC44OTMgMTYuMTc0IDEwMC4xOTMgMTYuNTk0Qzk5LjUyMTIgMTYuOTg2IDk4Ljk3NTIgMTcuNTQ2IDk4LjU1NTIgMTguMjc0Qzk4LjE2MzIgMTkuMDAyIDk3Ljk2NzIgMTkuODQyIDk3Ljk2NzIgMjAuNzk0Qzk3Ljk2NzIgMjEuNzE4IDk4LjE2MzIgMjIuNTQ0IDk4LjU1NTIgMjMuMjcyQzk4Ljk0NzIgMjQgOTkuNDkzMiAyNC41NzQgMTAwLjE5MyAyNC45OTRDMTAwLjg5MyAyNS40MTQgMTAxLjY3NyAyNS42MjQgMTAyLjU0NSAyNS42MjRaTTEwNi44NzEgMzFWMjUuNDk4TDEwNy44MzcgMjAuNTQyTDEwNi44NzEgMTUuNTg2VjEwLjU4OEgxMTMuMTcxVjMxSDEwNi44NzFaTTExNy42OTYgMzFWMTAuNTg4SDEyNC4xMjJWMzFIMTE3LjY5NlpNMTIwLjkzIDcuNzc0QzExOS45MjIgNy43NzQgMTE5LjA4MiA3LjQzOCAxMTguNDEgNi43NjZDMTE3Ljc2NiA2LjA2NiAxMTcuNDQ0IDUuMjI2IDExNy40NDQgNC4yNDZDMTE3LjQ0NCAzLjIzOCAxMTcuNzY2IDIuMzk4IDExOC40MSAxLjcyNkMxMTkuMDgyIDEuMDU0IDExOS45MjIgMC43MTc5OTkgMTIwLjkzIDAuNzE3OTk5QzEyMS45MzggMC43MTc5OTkgMTIyLjc2NCAxLjA1NCAxMjMuNDA4IDEuNzI2QzEyNC4wNTIgMi4zOTggMTI0LjM3NCAzLjIzOCAxMjQuMzc0IDQuMjQ2QzEyNC4zNzQgNS4yMjYgMTI0LjA1MiA2LjA2NiAxMjMuNDA4IDYuNzY2QzEyMi43NjQgNy40MzggMTIxLjkzOCA3Ljc3NCAxMjAuOTMgNy43NzRaTTEzMi42NzkgMzEuNDYyQzEzMS41ODcgMzEuNDYyIDEzMC42NzcgMzEuMDg0IDEyOS45NDkgMzAuMzI4QzEyOS4yMjEgMjkuNTcyIDEyOC44NTcgMjguNjYyIDEyOC44NTcgMjcuNTk4QzEyOC44NTcgMjYuNDc4IDEyOS4yMjEgMjUuNTU0IDEyOS45NDkgMjQuODI2QzEzMC42NzcgMjQuMDcgMTMxLjU4NyAyMy42OTIgMTMyLjY3OSAyMy42OTJDMTMzLjc5OSAyMy42OTIgMTM0LjcwOSAyNC4wNyAxMzUuNDA5IDI0LjgyNkMxMzYuMTM3IDI1LjU1NCAxMzYuNTAxIDI2LjQ3OCAxMzYuNTAxIDI3LjU5OEMxMzYuNTAxIDI4LjY2MiAxMzYuMTM3IDI5LjU3MiAxMzUuNDA5IDMwLjMyOEMxMzQuNzA5IDMxLjA4NCAxMzMuNzk5IDMxLjQ2MiAxMzIuNjc5IDMxLjQ2MloiIGZpbGw9IiMxNDFFMzAiLz4KPC9zdmc+Cg=="},8483:function(e,t,n){"use strict";n.d(t,{V:function(){return a}});var i=n(5671),r=n(3144),a=function(){function e(t,n,r,a,o,s){(0,i.Z)(this,e),this.source=t,this.pointerX=n,this.pointerY=r,this.meshUnderPointer=a,this.sourceEvent=o,this.additionalData=s}return(0,r.Z)(e,null,[{key:"CreateNew",value:function(t,n,i){var r=t.getScene();return new e(t,r.pointerX,r.pointerY,r.meshUnderPointer||t,n,i)}},{key:"CreateNewFromSprite",value:function(t,n,i,r){return new e(t,n.pointerX,n.pointerY,n.meshUnderPointer,i,r)}},{key:"CreateNewFromScene",value:function(t,n){return new e(null,t.pointerX,t.pointerY,t.meshUnderPointer,n)}},{key:"CreateNewFromPrimitive",value:function(t,n,i,r){return new e(t,n.x,n.y,null,i,r)}}]),e}()},2845:function(e,t,n){"use strict";n.d(t,{l:function(){return o},o:function(){return s}});var i=n(5671),r=n(3144),a=n(7818),o=function(){function e(t,n,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],u=arguments.length>5&&void 0!==arguments[5]&&arguments[5],l=arguments.length>6&&void 0!==arguments[6]&&arguments[6],c=arguments.length>7?arguments[7]:void 0;(0,i.Z)(this,e),this._isAlreadyOwned=!1,t.getScene?this._engine=t.getScene().getEngine():this._engine=t,this._updatable=r,this._instanced=u,this._divisor=c||1,n instanceof a.h?(this._data=null,this._buffer=n):(this._data=n,this._buffer=null),this.byteStride=l?o:o*Float32Array.BYTES_PER_ELEMENT,s||this.create()}return(0,r.Z)(e,[{key:"createVertexBuffer",value:function(e,t,n,i,r){var a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=arguments.length>6?arguments[6]:void 0,u=a?t:t*Float32Array.BYTES_PER_ELEMENT,l=i?a?i:i*Float32Array.BYTES_PER_ELEMENT:this.byteStride;return new s(this._engine,this,e,this._updatable,!0,l,void 0===r?this._instanced:r,u,n,void 0,void 0,!0,this._divisor||o)}},{key:"isUpdatable",value:function(){return this._updatable}},{key:"getData",value:function(){return this._data}},{key:"getBuffer",value:function(){return this._buffer}},{key:"getStrideSize",value:function(){return this.byteStride/Float32Array.BYTES_PER_ELEMENT}},{key:"create",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;!e&&this._buffer||(e=e||this._data)&&(this._buffer?this._updatable&&(this._engine.updateDynamicVertexBuffer(this._buffer,e),this._data=e):this._updatable?(this._buffer=this._engine.createDynamicVertexBuffer(e),this._data=e):this._buffer=this._engine.createVertexBuffer(e))}},{key:"_rebuild",value:function(){this._buffer=null,this.create(this._data)}},{key:"update",value:function(e){this.create(e)}},{key:"updateDirectly",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this._buffer&&this._updatable&&(this._engine.updateDynamicVertexBuffer(this._buffer,e,i?t:t*Float32Array.BYTES_PER_ELEMENT,n?n*this.byteStride:void 0),this._data=0===t&&void 0===n?e:null)}},{key:"_increaseReferences",value:function(){this._buffer&&(this._isAlreadyOwned?this._buffer.references++:this._isAlreadyOwned=!0)}},{key:"dispose",value:function(){this._buffer&&this._engine._releaseBuffer(this._buffer)&&(this._buffer=null,this._data=null)}}]),e}(),s=function(){function e(t,n,r,a,s,u,l,c,h,f){var d=arguments.length>10&&void 0!==arguments[10]&&arguments[10],p=arguments.length>11&&void 0!==arguments[11]&&arguments[11],v=arguments.length>12&&void 0!==arguments[12]?arguments[12]:1,m=arguments.length>13&&void 0!==arguments[13]&&arguments[13];if((0,i.Z)(this,e),n instanceof o?(this._buffer=n,this._ownsBuffer=m):(this._buffer=new o(t,n,a,u,s,l,p),this._ownsBuffer=!0),this.uniqueId=e._Counter++,this._kind=r,null==f){var g=this.getData();this.type=e.FLOAT,g instanceof Int8Array?this.type=e.BYTE:g instanceof Uint8Array?this.type=e.UNSIGNED_BYTE:g instanceof Int16Array?this.type=e.SHORT:g instanceof Uint16Array?this.type=e.UNSIGNED_SHORT:g instanceof Int32Array?this.type=e.INT:g instanceof Uint32Array&&(this.type=e.UNSIGNED_INT)}else this.type=f;var _=e.GetTypeByteLength(this.type);p?(this._size=h||(u?u/_:e.DeduceStride(r)),this.byteStride=u||this._buffer.byteStride||this._size*_,this.byteOffset=c||0):(this._size=h||u||e.DeduceStride(r),this.byteStride=u?u*_:this._buffer.byteStride||this._size*_,this.byteOffset=(c||0)*_),this.normalized=d,this._instanced=void 0!==l&&l,this._instanceDivisor=l?v:0,this._computeHashCode()}return(0,r.Z)(e,[{key:"instanceDivisor",get:function(){return this._instanceDivisor},set:function(e){var t=0!=e;this._instanceDivisor=e,t!==this._instanced&&(this._instanced=t,this._computeHashCode())}},{key:"_computeHashCode",value:function(){this.hashCode=(this.type-5120<<0)+((this.normalized?1:0)<<3)+(this._size<<4)+((this._instanced?1:0)<<6)+(this.byteStride<<12)}},{key:"_rebuild",value:function(){this._buffer&&this._buffer._rebuild()}},{key:"getKind",value:function(){return this._kind}},{key:"isUpdatable",value:function(){return this._buffer.isUpdatable()}},{key:"getData",value:function(){return this._buffer.getData()}},{key:"getFloatData",value:function(t,n){var i=this.getData();if(!i)return null;var r=this.getSize()*e.GetTypeByteLength(this.type),a=t*this.getSize();if(this.type!==e.FLOAT||this.byteStride!==r){var o=new Float32Array(a);return this.forEach(a,(function(e,t){return o[t]=e})),o}if(!(i instanceof Array||i instanceof Float32Array)||0!==this.byteOffset||i.length!==a){if(i instanceof Array){var s=this.byteOffset/4;return i.slice(s,s+a)}if(i instanceof ArrayBuffer)return new Float32Array(i,this.byteOffset,a);var u=i.byteOffset+this.byteOffset;if(n){var l=new Float32Array(a),c=new Float32Array(i.buffer,u,a);return l.set(c),l}var h=u%4;return h&&(u=Math.max(0,u-h)),new Float32Array(i.buffer,u,a)}return n?i.slice():i}},{key:"getBuffer",value:function(){return this._buffer.getBuffer()}},{key:"getStrideSize",value:function(){return this.byteStride/e.GetTypeByteLength(this.type)}},{key:"getOffset",value:function(){return this.byteOffset/e.GetTypeByteLength(this.type)}},{key:"getSize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return t?this._size*e.GetTypeByteLength(this.type):this._size}},{key:"getIsInstanced",value:function(){return this._instanced}},{key:"getInstanceDivisor",value:function(){return this._instanceDivisor}},{key:"create",value:function(e){this._buffer.create(e)}},{key:"update",value:function(e){this._buffer.update(e)}},{key:"updateDirectly",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this._buffer.updateDirectly(e,t,void 0,n)}},{key:"dispose",value:function(){this._ownsBuffer&&this._buffer.dispose()}},{key:"forEach",value:function(t,n){e.ForEach(this._buffer.getData(),this.byteOffset,this.byteStride,this._size,this.type,t,this.normalized,n)}}],[{key:"DeduceStride",value:function(t){switch(t){case e.UVKind:case e.UV2Kind:case e.UV3Kind:case e.UV4Kind:case e.UV5Kind:case e.UV6Kind:return 2;case e.NormalKind:case e.PositionKind:return 3;case e.ColorKind:case e.MatricesIndicesKind:case e.MatricesIndicesExtraKind:case e.MatricesWeightsKind:case e.MatricesWeightsExtraKind:case e.TangentKind:return 4;default:throw new Error("Invalid kind '"+t+"'")}}},{key:"GetTypeByteLength",value:function(t){switch(t){case e.BYTE:case e.UNSIGNED_BYTE:return 1;case e.SHORT:case e.UNSIGNED_SHORT:return 2;case e.INT:case e.UNSIGNED_INT:case e.FLOAT:return 4;default:throw new Error("Invalid type '".concat(t,"'"))}}},{key:"ForEach",value:function(t,n,i,r,a,o,s,u){if(t instanceof Array)for(var l=n/4,c=i/4,h=0;h<o;h+=r){for(var f=0;f<r;f++)u(t[l+f],h+f);l+=c}else for(var d=t instanceof ArrayBuffer?new DataView(t):new DataView(t.buffer,t.byteOffset,t.byteLength),p=e.GetTypeByteLength(a),v=0;v<o;v+=r){for(var m=n,g=0;g<r;g++){u(e._GetFloatValue(d,a,m,s),v+g),m+=p}n+=i}}},{key:"_GetFloatValue",value:function(t,n,i,r){switch(n){case e.BYTE:var a=t.getInt8(i);return r&&(a=Math.max(a/127,-1)),a;case e.UNSIGNED_BYTE:var o=t.getUint8(i);return r&&(o/=255),o;case e.SHORT:var s=t.getInt16(i,!0);return r&&(s=Math.max(s/32767,-1)),s;case e.UNSIGNED_SHORT:var u=t.getUint16(i,!0);return r&&(u/=65535),u;case e.INT:return t.getInt32(i,!0);case e.UNSIGNED_INT:return t.getUint32(i,!0);case e.FLOAT:return t.getFloat32(i,!0);default:throw new Error("Invalid component type ".concat(n))}}}]),e}();s._Counter=0,s.BYTE=5120,s.UNSIGNED_BYTE=5121,s.SHORT=5122,s.UNSIGNED_SHORT=5123,s.INT=5124,s.UNSIGNED_INT=5125,s.FLOAT=5126,s.PositionKind="position",s.NormalKind="normal",s.TangentKind="tangent",s.UVKind="uv",s.UV2Kind="uv2",s.UV3Kind="uv3",s.UV4Kind="uv4",s.UV5Kind="uv5",s.UV6Kind="uv6",s.ColorKind="color",s.ColorInstanceKind="instanceColor",s.MatricesIndicesKind="matricesIndices",s.MatricesWeightsKind="matricesWeights",s.MatricesIndicesExtraKind="matricesIndicesExtra",s.MatricesWeightsExtraKind="matricesWeightsExtra"},7818:function(e,t,n){"use strict";n.d(t,{h:function(){return a}});var i=n(5671),r=n(3144),a=function(){function e(){(0,i.Z)(this,e),this.references=0,this.capacity=0,this.is32Bits=!1,this.uniqueId=e._Counter++}return(0,r.Z)(e,[{key:"underlyingResource",get:function(){return null}}]),e}();a._Counter=0},7337:function(e,t,n){"use strict";n.d(t,{V:function(){return S}});var i=n(5671),r=n(3144),a=n(7326),o=n(1752),s=n(136),u=n(6215),l=n(1120),c=n(9477),h=n(9336),f=n(5934),d=n(8517),p=n(4174),v=n(6900),m=n(1396),g=n(2328),_=n(1704),y=n(5230),E=n(628),A=n(2465);function b(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return T(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return T(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function M(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,l.Z)(e);if(t){var r=(0,l.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,u.Z)(this,n)}}var S=function(e){(0,s.Z)(n,e);var t=M(n);function n(e,r,o){var s,u=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return(0,i.Z)(this,n),(s=t.call(this,e,o))._position=v.P.Zero(),s._upVector=v.P.Up(),s._orthoLeft=null,s._orthoRight=null,s._orthoBottom=null,s._orthoTop=null,s.fov=.8,s.projectionPlaneTilt=0,s.minZ=1,s.maxZ=1e4,s.inertia=.9,s._mode=n.PERSPECTIVE_CAMERA,s.isIntermediate=!1,s.viewport=new E.l(0,0,1,1),s.layerMask=268435455,s.fovMode=n.FOVMODE_VERTICAL_FIXED,s.cameraRigMode=n.RIG_MODE_NONE,s.customRenderTargets=new Array,s.outputRenderTarget=null,s.onViewMatrixChangedObservable=new p.y$,s.onProjectionMatrixChangedObservable=new p.y$,s.onAfterCheckInputsObservable=new p.y$,s.onRestoreStateObservable=new p.y$,s.isRigCamera=!1,s._rigCameras=new Array,s._webvrViewMatrix=v.y3.Identity(),s._skipRendering=!1,s._projectionMatrix=new v.y3,s._postProcesses=new Array,s._activeMeshes=new f.t(256),s._globalPosition=v.P.Zero(),s._computedViewMatrix=v.y3.Identity(),s._doNotComputeProjectionMatrix=!1,s._transformMatrix=v.y3.Zero(),s._refreshFrustumPlanes=!0,s._absoluteRotation=v._f.Identity(),s._isCamera=!0,s._isLeftCamera=!1,s._isRightCamera=!1,s.getScene().addCamera((0,a.Z)(s)),u&&!s.getScene().activeCamera&&(s.getScene().activeCamera=(0,a.Z)(s)),s.position=r,s.renderPassId=s.getScene().getEngine().createRenderPassId("Camera ".concat(e)),s}return(0,r.Z)(n,[{key:"position",get:function(){return this._position},set:function(e){this._position=e}},{key:"upVector",get:function(){return this._upVector},set:function(e){this._upVector=e}},{key:"screenArea",get:function(){var e=0,t=0;if(this.mode===n.PERSPECTIVE_CAMERA)this.fovMode===n.FOVMODE_VERTICAL_FIXED?(t=2*this.minZ*Math.tan(this.fov/2),e=this.getEngine().getAspectRatio(this)*t):t=(e=2*this.minZ*Math.tan(this.fov/2))/this.getEngine().getAspectRatio(this);else{var i,r,a,o,s=this.getEngine().getRenderWidth()/2,u=this.getEngine().getRenderHeight()/2;e=(null!==(i=this.orthoRight)&&void 0!==i?i:s)-(null!==(r=this.orthoLeft)&&void 0!==r?r:-s),t=(null!==(a=this.orthoTop)&&void 0!==a?a:u)-(null!==(o=this.orthoBottom)&&void 0!==o?o:-u)}return e*t}},{key:"orthoLeft",get:function(){return this._orthoLeft},set:function(e){this._orthoLeft=e;var t,n=b(this._rigCameras);try{for(n.s();!(t=n.n()).done;){t.value.orthoLeft=e}}catch(i){n.e(i)}finally{n.f()}}},{key:"orthoRight",get:function(){return this._orthoRight},set:function(e){this._orthoRight=e;var t,n=b(this._rigCameras);try{for(n.s();!(t=n.n()).done;){t.value.orthoRight=e}}catch(i){n.e(i)}finally{n.f()}}},{key:"orthoBottom",get:function(){return this._orthoBottom},set:function(e){this._orthoBottom=e;var t,n=b(this._rigCameras);try{for(n.s();!(t=n.n()).done;){t.value.orthoBottom=e}}catch(i){n.e(i)}finally{n.f()}}},{key:"orthoTop",get:function(){return this._orthoTop},set:function(e){this._orthoTop=e;var t,n=b(this._rigCameras);try{for(n.s();!(t=n.n()).done;){t.value.orthoTop=e}}catch(i){n.e(i)}finally{n.f()}}},{key:"mode",get:function(){return this._mode},set:function(e){this._mode=e;var t,n=b(this._rigCameras);try{for(n.s();!(t=n.n()).done;){t.value.mode=e}}catch(i){n.e(i)}finally{n.f()}}},{key:"storeState",value:function(){return this._stateStored=!0,this._storedFov=this.fov,this}},{key:"_restoreStateValues",value:function(){return!!this._stateStored&&(this.fov=this._storedFov,!0)}},{key:"restoreState",value:function(){return!!this._restoreStateValues()&&(this.onRestoreStateObservable.notifyObservers(this),!0)}},{key:"getClassName",value:function(){return"Camera"}},{key:"toString",value:function(e){var t="Name: "+this.name;if(t+=", type: "+this.getClassName(),this.animations)for(var n=0;n<this.animations.length;n++)t+=", animation[0]: "+this.animations[n].toString(e);return t}},{key:"applyVerticalCorrection",value:function(){var e=this.absoluteRotation.toEulerAngles();this.projectionPlaneTilt=this._scene.useRightHandedSystem?-e.x:e.x}},{key:"globalPosition",get:function(){return this._globalPosition}},{key:"getActiveMeshes",value:function(){return this._activeMeshes}},{key:"isActiveMesh",value:function(e){return-1!==this._activeMeshes.indexOf(e)}},{key:"isReady",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(e){var t,i=b(this._postProcesses);try{for(i.s();!(t=i.n()).done;){var r=t.value;if(r&&!r.isReady())return!1}}catch(a){i.e(a)}finally{i.f()}}return(0,o.Z)((0,l.Z)(n.prototype),"isReady",this).call(this,e)}},{key:"_initCache",value:function(){(0,o.Z)((0,l.Z)(n.prototype),"_initCache",this).call(this),this._cache.position=new v.P(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),this._cache.upVector=new v.P(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),this._cache.mode=void 0,this._cache.minZ=void 0,this._cache.maxZ=void 0,this._cache.fov=void 0,this._cache.fovMode=void 0,this._cache.aspectRatio=void 0,this._cache.orthoLeft=void 0,this._cache.orthoRight=void 0,this._cache.orthoBottom=void 0,this._cache.orthoTop=void 0,this._cache.renderWidth=void 0,this._cache.renderHeight=void 0}},{key:"_updateCache",value:function(e){e||(0,o.Z)((0,l.Z)(n.prototype),"_updateCache",this).call(this),this._cache.position.copyFrom(this.position),this._cache.upVector.copyFrom(this.upVector)}},{key:"_isSynchronized",value:function(){return this._isSynchronizedViewMatrix()&&this._isSynchronizedProjectionMatrix()}},{key:"_isSynchronizedViewMatrix",value:function(){return!!(0,o.Z)((0,l.Z)(n.prototype),"_isSynchronized",this).call(this)&&(this._cache.position.equals(this.position)&&this._cache.upVector.equals(this.upVector)&&this.isSynchronizedWithParent())}},{key:"_isSynchronizedProjectionMatrix",value:function(){var e=this._cache.mode===this.mode&&this._cache.minZ===this.minZ&&this._cache.maxZ===this.maxZ;if(!e)return!1;var t=this.getEngine();return e=this.mode===n.PERSPECTIVE_CAMERA?this._cache.fov===this.fov&&this._cache.fovMode===this.fovMode&&this._cache.aspectRatio===t.getAspectRatio(this)&&this._cache.projectionPlaneTilt===this.projectionPlaneTilt:this._cache.orthoLeft===this.orthoLeft&&this._cache.orthoRight===this.orthoRight&&this._cache.orthoBottom===this.orthoBottom&&this._cache.orthoTop===this.orthoTop&&this._cache.renderWidth===t.getRenderWidth()&&this._cache.renderHeight===t.getRenderHeight()}},{key:"attachControl",value:function(e,t){}},{key:"detachControl",value:function(e){}},{key:"update",value:function(){this._checkInputs(),this.cameraRigMode!==n.RIG_MODE_NONE&&this._updateRigCameras()}},{key:"_checkInputs",value:function(){this.onAfterCheckInputsObservable.notifyObservers(this)}},{key:"rigCameras",get:function(){return this._rigCameras}},{key:"rigPostProcess",get:function(){return this._rigPostProcess}},{key:"_getFirstPostProcess",value:function(){for(var e=0;e<this._postProcesses.length;e++)if(null!==this._postProcesses[e])return this._postProcesses[e];return null}},{key:"_cascadePostProcessesToRigCams",value:function(){var e=this._getFirstPostProcess();e&&e.markTextureDirty();for(var t=0,n=this._rigCameras.length;t<n;t++){var i=this._rigCameras[t],r=i._rigPostProcess;if(r)"pass"===r.getEffectName()&&(i.isIntermediate=0===this._postProcesses.length),i._postProcesses=this._postProcesses.slice(0).concat(r),r.markTextureDirty();else i._postProcesses=this._postProcesses.slice(0)}}},{key:"attachPostProcess",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return!e.isReusable()&&this._postProcesses.indexOf(e)>-1?(g.Y.Error("You're trying to reuse a post process not defined as reusable."),0):(null==t||t<0?this._postProcesses.push(e):null===this._postProcesses[t]?this._postProcesses[t]=e:this._postProcesses.splice(t,0,e),this._cascadePostProcessesToRigCams(),this._scene.prePassRenderer&&this._scene.prePassRenderer.markAsDirty(),this._postProcesses.indexOf(e))}},{key:"detachPostProcess",value:function(e){var t=this._postProcesses.indexOf(e);-1!==t&&(this._postProcesses[t]=null),this._scene.prePassRenderer&&this._scene.prePassRenderer.markAsDirty(),this._cascadePostProcessesToRigCams()}},{key:"getWorldMatrix",value:function(){return this._isSynchronizedViewMatrix()||this.getViewMatrix(),this._worldMatrix}},{key:"_getViewMatrix",value:function(){return v.y3.Identity()}},{key:"getViewMatrix",value:function(e){return!e&&this._isSynchronizedViewMatrix()||(this.updateCache(),this._computedViewMatrix=this._getViewMatrix(),this._currentRenderId=this.getScene().getRenderId(),this._childUpdateId++,this._refreshFrustumPlanes=!0,this._cameraRigParams&&this._cameraRigParams.vrPreViewMatrix&&this._computedViewMatrix.multiplyToRef(this._cameraRigParams.vrPreViewMatrix,this._computedViewMatrix),this.parent&&this.parent.onViewMatrixChangedObservable&&this.parent.onViewMatrixChangedObservable.notifyObservers(this.parent),this.onViewMatrixChangedObservable.notifyObservers(this),this._computedViewMatrix.invertToRef(this._worldMatrix)),this._computedViewMatrix}},{key:"freezeProjectionMatrix",value:function(e){this._doNotComputeProjectionMatrix=!0,void 0!==e&&(this._projectionMatrix=e)}},{key:"unfreezeProjectionMatrix",value:function(){this._doNotComputeProjectionMatrix=!1}},{key:"getProjectionMatrix",value:function(e){if(this._doNotComputeProjectionMatrix||!e&&this._isSynchronizedProjectionMatrix())return this._projectionMatrix;this._cache.mode=this.mode,this._cache.minZ=this.minZ,this._cache.maxZ=this.maxZ,this._refreshFrustumPlanes=!0;var t=this.getEngine(),i=this.getScene();if(this.mode===n.PERSPECTIVE_CAMERA){this._cache.fov=this.fov,this._cache.fovMode=this.fovMode,this._cache.aspectRatio=t.getAspectRatio(this),this._cache.projectionPlaneTilt=this.projectionPlaneTilt,this.minZ<=0&&(this.minZ=.1);var r,a=t.useReverseDepthBuffer;r=i.useRightHandedSystem?v.y3.PerspectiveFovRHToRef:v.y3.PerspectiveFovLHToRef,r(this.fov,t.getAspectRatio(this),a?this.maxZ:this.minZ,a?this.minZ:this.maxZ,this._projectionMatrix,this.fovMode===n.FOVMODE_VERTICAL_FIXED,t.isNDCHalfZRange,this.projectionPlaneTilt,t.useReverseDepthBuffer)}else{var o,s,u,l,c,h,f,d,p=t.getRenderWidth()/2,m=t.getRenderHeight()/2;if(i.useRightHandedSystem)v.y3.OrthoOffCenterRHToRef(null!==(o=this.orthoLeft)&&void 0!==o?o:-p,null!==(s=this.orthoRight)&&void 0!==s?s:p,null!==(u=this.orthoBottom)&&void 0!==u?u:-m,null!==(l=this.orthoTop)&&void 0!==l?l:m,this.minZ,this.maxZ,this._projectionMatrix,t.isNDCHalfZRange);else v.y3.OrthoOffCenterLHToRef(null!==(c=this.orthoLeft)&&void 0!==c?c:-p,null!==(h=this.orthoRight)&&void 0!==h?h:p,null!==(f=this.orthoBottom)&&void 0!==f?f:-m,null!==(d=this.orthoTop)&&void 0!==d?d:m,this.minZ,this.maxZ,this._projectionMatrix,t.isNDCHalfZRange);this._cache.orthoLeft=this.orthoLeft,this._cache.orthoRight=this.orthoRight,this._cache.orthoBottom=this.orthoBottom,this._cache.orthoTop=this.orthoTop,this._cache.renderWidth=t.getRenderWidth(),this._cache.renderHeight=t.getRenderHeight()}return this.onProjectionMatrixChangedObservable.notifyObservers(this),this._projectionMatrix}},{key:"getTransformationMatrix",value:function(){return this._computedViewMatrix.multiplyToRef(this._projectionMatrix,this._transformMatrix),this._transformMatrix}},{key:"_updateFrustumPlanes",value:function(){this._refreshFrustumPlanes&&(this.getTransformationMatrix(),this._frustumPlanes?A.i.GetPlanesToRef(this._transformMatrix,this._frustumPlanes):this._frustumPlanes=A.i.GetPlanes(this._transformMatrix),this._refreshFrustumPlanes=!1)}},{key:"isInFrustum",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this._updateFrustumPlanes(),t&&this.rigCameras.length>0){var n=!1;return this.rigCameras.forEach((function(t){t._updateFrustumPlanes(),n=n||e.isInFrustum(t._frustumPlanes)})),n}return e.isInFrustum(this._frustumPlanes)}},{key:"isCompletelyInFrustum",value:function(e){return this._updateFrustumPlanes(),e.isCompletelyInFrustum(this._frustumPlanes)}},{key:"getForwardRay",value:function(){throw(0,y.S)("Ray")}},{key:"getForwardRayToRef",value:function(e){throw(0,y.S)("Ray")}},{key:"dispose",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];for(this.onViewMatrixChangedObservable.clear(),this.onProjectionMatrixChangedObservable.clear(),this.onAfterCheckInputsObservable.clear(),this.onRestoreStateObservable.clear(),this.inputs&&this.inputs.clear(),this.getScene().stopAnimation(this),this.getScene().removeCamera(this);this._rigCameras.length>0;){var i=this._rigCameras.pop();i&&i.dispose()}if(this._parentContainer){var r=this._parentContainer.cameras.indexOf(this);r>-1&&this._parentContainer.cameras.splice(r,1),this._parentContainer=null}if(this._rigPostProcess)this._rigPostProcess.dispose(this),this._rigPostProcess=null,this._postProcesses.length=0;else if(this.cameraRigMode!==n.RIG_MODE_NONE)this._rigPostProcess=null,this._postProcesses.length=0;else for(var a=this._postProcesses.length;--a>=0;){var s=this._postProcesses[a];s&&s.dispose(this)}for(var u=this.customRenderTargets.length;--u>=0;)this.customRenderTargets[u].dispose();this.customRenderTargets.length=0,this._activeMeshes.dispose(),this.getScene().getEngine().releaseRenderPassId(this.renderPassId),(0,o.Z)((0,l.Z)(n.prototype),"dispose",this).call(this,e,t)}},{key:"isLeftCamera",get:function(){return this._isLeftCamera}},{key:"isRightCamera",get:function(){return this._isRightCamera}},{key:"leftCamera",get:function(){return this._rigCameras.length<1?null:this._rigCameras[0]}},{key:"rightCamera",get:function(){return this._rigCameras.length<2?null:this._rigCameras[1]}},{key:"getLeftTarget",value:function(){return this._rigCameras.length<1?null:this._rigCameras[0].getTarget()}},{key:"getRightTarget",value:function(){return this._rigCameras.length<2?null:this._rigCameras[1].getTarget()}},{key:"setCameraRigMode",value:function(e,t){if(this.cameraRigMode!==e){for(;this._rigCameras.length>0;){var i=this._rigCameras.pop();i&&i.dispose()}if(this.cameraRigMode=e,this._cameraRigParams={},this._cameraRigParams.interaxialDistance=t.interaxialDistance||.0637,this._cameraRigParams.stereoHalfAngle=d.w1.ToRadians(this._cameraRigParams.interaxialDistance/.0637),this.cameraRigMode!==n.RIG_MODE_NONE){var r=this.createRigCamera(this.name+"_L",0);r&&(r._isLeftCamera=!0);var a=this.createRigCamera(this.name+"_R",1);a&&(a._isRightCamera=!0),r&&a&&(this._rigCameras.push(r),this._rigCameras.push(a))}this._setRigMode(t),this._cascadePostProcessesToRigCams(),this.update()}}},{key:"_setRigMode",value:function(e){}},{key:"_getVRProjectionMatrix",value:function(){return v.y3.PerspectiveFovLHToRef(this._cameraRigParams.vrMetrics.aspectRatioFov,this._cameraRigParams.vrMetrics.aspectRatio,this.minZ,this.maxZ,this._cameraRigParams.vrWorkMatrix,!0,this.getEngine().isNDCHalfZRange),this._cameraRigParams.vrWorkMatrix.multiplyToRef(this._cameraRigParams.vrHMatrix,this._projectionMatrix),this._projectionMatrix}},{key:"_updateCameraRotationMatrix",value:function(){}},{key:"_updateWebVRCameraRotationMatrix",value:function(){}},{key:"_getWebVRProjectionMatrix",value:function(){return v.y3.Identity()}},{key:"_getWebVRViewMatrix",value:function(){return v.y3.Identity()}},{key:"setCameraRigParameter",value:function(e,t){this._cameraRigParams||(this._cameraRigParams={}),this._cameraRigParams[e]=t,"interaxialDistance"===e&&(this._cameraRigParams.stereoHalfAngle=d.w1.ToRadians(t/.0637))}},{key:"createRigCamera",value:function(e,t){return null}},{key:"_updateRigCameras",value:function(){for(var e=0;e<this._rigCameras.length;e++)this._rigCameras[e].minZ=this.minZ,this._rigCameras[e].maxZ=this.maxZ,this._rigCameras[e].fov=this.fov,this._rigCameras[e].upVector.copyFrom(this.upVector);this.cameraRigMode===n.RIG_MODE_STEREOSCOPIC_ANAGLYPH&&(this._rigCameras[0].viewport=this._rigCameras[1].viewport=this.viewport)}},{key:"_setupInputs",value:function(){}},{key:"serialize",value:function(){var e=h.p4.Serialize(this);return e.uniqueId=this.uniqueId,e.type=this.getClassName(),this.parent&&this.parent._serializeAsParent(e),this.inputs&&this.inputs.serialize(e),h.p4.AppendSerializedAnimations(this,e),e.ranges=this.serializeAnimationRanges(),e.isEnabled=this.isEnabled(),e}},{key:"clone",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=h.p4.Clone(n.GetConstructorFromName(this.getClassName(),e,this.getScene(),this.interaxialDistance,this.isStereoscopicSideBySide),this);return i.name=e,i.parent=t,this.onClonedObservable.notifyObservers(i),i}},{key:"getDirection",value:function(e){var t=v.P.Zero();return this.getDirectionToRef(e,t),t}},{key:"absoluteRotation",get:function(){return this.getWorldMatrix().decompose(void 0,this._absoluteRotation),this._absoluteRotation}},{key:"getDirectionToRef",value:function(e,t){v.P.TransformNormalToRef(e,this.getWorldMatrix(),t)}},{key:"computeWorldMatrix",value:function(){return this.getWorldMatrix()}}],[{key:"GetConstructorFromName",value:function(e,t,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],o=m.N.Construct(e,t,i,{interaxial_distance:r,isStereoscopicSideBySide:a});return o||function(){return n._CreateDefaultParsedCamera(t,i)}}},{key:"Parse",value:function(e,t){var i=e.type,r=n.GetConstructorFromName(i,e.name,t,e.interaxial_distance,e.isStereoscopicSideBySide),a=h.p4.Parse(r,e,t);if(void 0!==e.parentId&&(a._waitingParentId=e.parentId),void 0!==e.parentInstanceIndex&&(a._waitingParentInstanceIndex=e.parentInstanceIndex),a.inputs&&(a.inputs.parse(e),a._setupInputs()),e.upVector&&(a.upVector=v.P.FromArray(e.upVector)),a.setPosition&&(a.position.copyFromFloats(0,0,0),a.setPosition(v.P.FromArray(e.position))),e.target&&a.setTarget&&a.setTarget(v.P.FromArray(e.target)),e.cameraRigMode){var o=e.interaxial_distance?{interaxialDistance:e.interaxial_distance}:{};a.setCameraRigMode(e.cameraRigMode,o)}if(e.animations){for(var s=0;s<e.animations.length;s++){var u=e.animations[s],l=(0,_.q)("BABYLON.Animation");l&&a.animations.push(l.Parse(u))}m.N.ParseAnimationRanges(a,e,t)}return e.autoAnimate&&t.beginAnimation(a,e.autoAnimateFrom,e.autoAnimateTo,e.autoAnimateLoop,e.autoAnimateSpeed||1),void 0!==e.isEnabled&&a.setEnabled(e.isEnabled),a}}]),n}(m.N);S._CreateDefaultParsedCamera=function(e,t){throw(0,y.S)("UniversalCamera")},S.PERSPECTIVE_CAMERA=0,S.ORTHOGRAPHIC_CAMERA=1,S.FOVMODE_VERTICAL_FIXED=0,S.FOVMODE_HORIZONTAL_FIXED=1,S.RIG_MODE_NONE=0,S.RIG_MODE_STEREOSCOPIC_ANAGLYPH=10,S.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL=11,S.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED=12,S.RIG_MODE_STEREOSCOPIC_OVERUNDER=13,S.RIG_MODE_STEREOSCOPIC_INTERLACED=14,S.RIG_MODE_VR=20,S.RIG_MODE_WEBVR=21,S.RIG_MODE_CUSTOM=22,S.ForceAttachControlToAlwaysPreventDefault=!1,(0,c.gn)([(0,h.hd)("position")],S.prototype,"_position",void 0),(0,c.gn)([(0,h.hd)("upVector")],S.prototype,"_upVector",void 0),(0,c.gn)([(0,h.qC)()],S.prototype,"orthoLeft",null),(0,c.gn)([(0,h.qC)()],S.prototype,"orthoRight",null),(0,c.gn)([(0,h.qC)()],S.prototype,"orthoBottom",null),(0,c.gn)([(0,h.qC)()],S.prototype,"orthoTop",null),(0,c.gn)([(0,h.qC)()],S.prototype,"fov",void 0),(0,c.gn)([(0,h.qC)()],S.prototype,"projectionPlaneTilt",void 0),(0,c.gn)([(0,h.qC)()],S.prototype,"minZ",void 0),(0,c.gn)([(0,h.qC)()],S.prototype,"maxZ",void 0),(0,c.gn)([(0,h.qC)()],S.prototype,"inertia",void 0),(0,c.gn)([(0,h.qC)()],S.prototype,"mode",null),(0,c.gn)([(0,h.qC)()],S.prototype,"layerMask",void 0),(0,c.gn)([(0,h.qC)()],S.prototype,"fovMode",void 0),(0,c.gn)([(0,h.qC)()],S.prototype,"cameraRigMode",void 0),(0,c.gn)([(0,h.qC)()],S.prototype,"interaxialDistance",void 0),(0,c.gn)([(0,h.qC)()],S.prototype,"isStereoscopicSideBySide",void 0)},3541:function(e,t,n){"use strict";n.d(t,{p:function(){return s}});var i=n(5671),r=n(3144),a=n(6900),o=n(2845),s=function(){function e(){(0,i.Z)(this,e),this._pickingUnavailable=!1,this.hit=!1,this.distance=0,this.pickedPoint=null,this.pickedMesh=null,this.bu=0,this.bv=0,this.faceId=-1,this.subMeshFaceId=-1,this.subMeshId=0,this.pickedSprite=null,this.thinInstanceIndex=-1,this.ray=null,this.originMesh=null,this.aimTransform=null,this.gripTransform=null}return(0,r.Z)(e,[{key:"getNormal",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!this.pickedMesh||!this.pickedMesh.isVerticesDataPresent(o.o.NormalKind))return null;var n,i=this.pickedMesh.getIndices();if(!i)return null;if(t){var r=this.pickedMesh.getVerticesData(o.o.NormalKind),s=a.P.FromArray(r,3*i[3*this.faceId]),u=a.P.FromArray(r,3*i[3*this.faceId+1]),l=a.P.FromArray(r,3*i[3*this.faceId+2]);s=s.scale(this.bu),u=u.scale(this.bv),l=l.scale(1-this.bu-this.bv),n=new a.P(s.x+u.x+l.x,s.y+u.y+l.y,s.z+u.z+l.z)}else{var c=this.pickedMesh.getVerticesData(o.o.PositionKind),h=a.P.FromArray(c,3*i[3*this.faceId]),f=a.P.FromArray(c,3*i[3*this.faceId+1]),d=a.P.FromArray(c,3*i[3*this.faceId+2]),p=h.subtract(f),v=d.subtract(f);n=a.P.Cross(p,v)}if(e){var m=this.pickedMesh.getWorldMatrix();this.pickedMesh.nonUniformScaling&&(a.jp.Matrix[0].copyFrom(m),(m=a.jp.Matrix[0]).setTranslationFromFloats(0,0,0),m.invert(),m.transposeToRef(a.jp.Matrix[1]),m=a.jp.Matrix[1]),n=a.P.TransformNormal(n,m)}return n.normalize(),n}},{key:"getTextureCoordinates",value:function(){if(!this.pickedMesh||!this.pickedMesh.isVerticesDataPresent(o.o.UVKind))return null;var e=this.pickedMesh.getIndices();if(!e)return null;var t=this.pickedMesh.getVerticesData(o.o.UVKind);if(!t)return null;var n=a.FM.FromArray(t,2*e[3*this.faceId]),i=a.FM.FromArray(t,2*e[3*this.faceId+1]),r=a.FM.FromArray(t,2*e[3*this.faceId+2]);return n=n.scale(this.bu),i=i.scale(this.bv),r=r.scale(1-this.bu-this.bv),new a.FM(n.x+i.x+r.x,n.y+i.y+r.y)}}]),e}()},6176:function(e,t,n){"use strict";n.d(t,{e:function(){return a}});var i=n(3144),r=n(5671),a=(0,i.Z)((function e(){(0,r.Z)(this,e)}));a.UseOpenGLOrientationForUV=!1},9115:function(e,t,n){"use strict";n.d(t,{j:function(){return p}});var i=n(5671),r=n(3144),a=n(8134),o=n(6900),s=n(3681),u=function(){function e(t,n,r){(0,i.Z)(this,e),this.vectors=a.B.BuildArray(8,o.P.Zero),this.center=o.P.Zero(),this.centerWorld=o.P.Zero(),this.extendSize=o.P.Zero(),this.extendSizeWorld=o.P.Zero(),this.directions=a.B.BuildArray(3,o.P.Zero),this.vectorsWorld=a.B.BuildArray(8,o.P.Zero),this.minimumWorld=o.P.Zero(),this.maximumWorld=o.P.Zero(),this.minimum=o.P.Zero(),this.maximum=o.P.Zero(),this._drawWrapperFront=null,this._drawWrapperBack=null,this.reConstruct(t,n,r)}return(0,r.Z)(e,[{key:"reConstruct",value:function(e,t,n){var i=e.x,r=e.y,a=e.z,s=t.x,u=t.y,l=t.z,c=this.vectors;this.minimum.copyFromFloats(i,r,a),this.maximum.copyFromFloats(s,u,l),c[0].copyFromFloats(i,r,a),c[1].copyFromFloats(s,u,l),c[2].copyFromFloats(s,r,a),c[3].copyFromFloats(i,u,a),c[4].copyFromFloats(i,r,l),c[5].copyFromFloats(s,u,a),c[6].copyFromFloats(i,u,l),c[7].copyFromFloats(s,r,l),t.addToRef(e,this.center).scaleInPlace(.5),t.subtractToRef(e,this.extendSize).scaleInPlace(.5),this._worldMatrix=n||o.y3.IdentityReadOnly,this._update(this._worldMatrix)}},{key:"scale",value:function(t){var n=e._TmpVector3,i=this.maximum.subtractToRef(this.minimum,n[0]),r=i.length();i.normalizeFromLength(r);var a=r*t,o=i.scaleInPlace(.5*a),s=this.center.subtractToRef(o,n[1]),u=this.center.addToRef(o,n[2]);return this.reConstruct(s,u,this._worldMatrix),this}},{key:"getWorldMatrix",value:function(){return this._worldMatrix}},{key:"_update",value:function(e){var t=this.minimumWorld,n=this.maximumWorld,i=this.directions,r=this.vectorsWorld,a=this.vectors;if(e.isIdentity()){t.copyFrom(this.minimum),n.copyFrom(this.maximum);for(var s=0;s<8;++s)r[s].copyFrom(a[s]);this.extendSizeWorld.copyFrom(this.extendSize),this.centerWorld.copyFrom(this.center)}else{t.setAll(Number.MAX_VALUE),n.setAll(-Number.MAX_VALUE);for(var u=0;u<8;++u){var l=r[u];o.P.TransformCoordinatesToRef(a[u],e,l),t.minimizeInPlace(l),n.maximizeInPlace(l)}n.subtractToRef(t,this.extendSizeWorld).scaleInPlace(.5),n.addToRef(t,this.centerWorld).scaleInPlace(.5)}o.P.FromArrayToRef(e.m,0,i[0]),o.P.FromArrayToRef(e.m,4,i[1]),o.P.FromArrayToRef(e.m,8,i[2]),this._worldMatrix=e}},{key:"isInFrustum",value:function(t){return e.IsInFrustum(this.vectorsWorld,t)}},{key:"isCompletelyInFrustum",value:function(t){return e.IsCompletelyInFrustum(this.vectorsWorld,t)}},{key:"intersectsPoint",value:function(e){var t=this.minimumWorld,n=this.maximumWorld,i=t.x,r=t.y,a=t.z,o=n.x,u=n.y,l=n.z,c=e.x,h=e.y,f=e.z,d=-s.kn;return!(o-c<d||d>c-i)&&(!(u-h<d||d>h-r)&&!(l-f<d||d>f-a))}},{key:"intersectsSphere",value:function(t){return e.IntersectsSphere(this.minimumWorld,this.maximumWorld,t.centerWorld,t.radiusWorld)}},{key:"intersectsMinMax",value:function(e,t){var n=this.minimumWorld,i=this.maximumWorld,r=n.x,a=n.y,o=n.z,s=i.x,u=i.y,l=i.z,c=e.x,h=e.y,f=e.z,d=t.x,p=t.y,v=t.z;return!(s<c||r>d)&&(!(u<h||a>p)&&!(l<f||o>v))}},{key:"dispose",value:function(){var e,t;null===(e=this._drawWrapperFront)||void 0===e||e.dispose(),null===(t=this._drawWrapperBack)||void 0===t||t.dispose()}}],[{key:"Intersects",value:function(e,t){return e.intersectsMinMax(t.minimumWorld,t.maximumWorld)}},{key:"IntersectsSphere",value:function(t,n,i,r){var a=e._TmpVector3[0];return o.P.ClampToRef(i,t,n,a),o.P.DistanceSquared(i,a)<=r*r}},{key:"IsCompletelyInFrustum",value:function(e,t){for(var n=0;n<6;++n)for(var i=t[n],r=0;r<8;++r)if(i.dotCoordinate(e[r])<0)return!1;return!0}},{key:"IsInFrustum",value:function(e,t){for(var n=0;n<6;++n){for(var i=!0,r=t[n],a=0;a<8;++a)if(r.dotCoordinate(e[a])>=0){i=!1;break}if(i)return!1}return!0}}]),e}();u._TmpVector3=a.B.BuildArray(3,o.P.Zero);var l=function(){function e(t,n,r){(0,i.Z)(this,e),this.center=o.P.Zero(),this.centerWorld=o.P.Zero(),this.minimum=o.P.Zero(),this.maximum=o.P.Zero(),this.reConstruct(t,n,r)}return(0,r.Z)(e,[{key:"reConstruct",value:function(e,t,n){this.minimum.copyFrom(e),this.maximum.copyFrom(t);var i=o.P.Distance(e,t);t.addToRef(e,this.center).scaleInPlace(.5),this.radius=.5*i,this._update(n||o.y3.IdentityReadOnly)}},{key:"scale",value:function(t){var n=this.radius*t,i=e._TmpVector3,r=i[0].setAll(n),a=this.center.subtractToRef(r,i[1]),o=this.center.addToRef(r,i[2]);return this.reConstruct(a,o,this._worldMatrix),this}},{key:"getWorldMatrix",value:function(){return this._worldMatrix}},{key:"_update",value:function(t){if(t.isIdentity())this.centerWorld.copyFrom(this.center),this.radiusWorld=this.radius;else{o.P.TransformCoordinatesToRef(this.center,t,this.centerWorld);var n=e._TmpVector3[0];o.P.TransformNormalFromFloatsToRef(1,1,1,t,n),this.radiusWorld=Math.max(Math.abs(n.x),Math.abs(n.y),Math.abs(n.z))*this.radius}}},{key:"isInFrustum",value:function(e){for(var t=this.centerWorld,n=this.radiusWorld,i=0;i<6;i++)if(e[i].dotCoordinate(t)<=-n)return!1;return!0}},{key:"isCenterInFrustum",value:function(e){for(var t=this.centerWorld,n=0;n<6;n++)if(e[n].dotCoordinate(t)<0)return!1;return!0}},{key:"intersectsPoint",value:function(e){var t=o.P.DistanceSquared(this.centerWorld,e);return!(this.radiusWorld*this.radiusWorld<t)}}],[{key:"Intersects",value:function(e,t){var n=o.P.DistanceSquared(e.centerWorld,t.centerWorld),i=e.radiusWorld+t.radiusWorld;return!(i*i<n)}},{key:"CreateFromCenterAndRadius",value:function(t,n,i){this._TmpVector3[0].copyFrom(t),this._TmpVector3[1].copyFromFloats(0,0,n),this._TmpVector3[2].copyFrom(t),this._TmpVector3[0].addInPlace(this._TmpVector3[1]),this._TmpVector3[2].subtractInPlace(this._TmpVector3[1]);var r=new e(this._TmpVector3[0],this._TmpVector3[2]);return r._worldMatrix=i||o.y3.Identity(),r}}]),e}();l._TmpVector3=a.B.BuildArray(3,o.P.Zero);var c={min:0,max:0},h={min:0,max:0},f=function(e,t,n){var i=o.P.Dot(t.centerWorld,e),r=Math.abs(o.P.Dot(t.directions[0],e))*t.extendSize.x+Math.abs(o.P.Dot(t.directions[1],e))*t.extendSize.y+Math.abs(o.P.Dot(t.directions[2],e))*t.extendSize.z;n.min=i-r,n.max=i+r},d=function(e,t,n){return f(e,t,c),f(e,n,h),!(c.min>h.max||h.min>c.max)},p=function(){function e(t,n,r){(0,i.Z)(this,e),this._isLocked=!1,this.boundingBox=new u(t,n,r),this.boundingSphere=new l(t,n,r)}return(0,r.Z)(e,[{key:"reConstruct",value:function(e,t,n){this.boundingBox.reConstruct(e,t,n),this.boundingSphere.reConstruct(e,t,n)}},{key:"minimum",get:function(){return this.boundingBox.minimum}},{key:"maximum",get:function(){return this.boundingBox.maximum}},{key:"isLocked",get:function(){return this._isLocked},set:function(e){this._isLocked=e}},{key:"update",value:function(e){this._isLocked||(this.boundingBox._update(e),this.boundingSphere._update(e))}},{key:"centerOn",value:function(t,n){var i=e._TmpVector3[0].copyFrom(t).subtractInPlace(n),r=e._TmpVector3[1].copyFrom(t).addInPlace(n);return this.boundingBox.reConstruct(i,r,this.boundingBox.getWorldMatrix()),this.boundingSphere.reConstruct(i,r,this.boundingBox.getWorldMatrix()),this}},{key:"encapsulate",value:function(e){var t=o.P.Minimize(this.minimum,e),n=o.P.Maximize(this.maximum,e);return this.reConstruct(t,n,this.boundingBox.getWorldMatrix()),this}},{key:"encapsulateBoundingInfo",value:function(e){return this.encapsulate(e.boundingBox.centerWorld.subtract(e.boundingBox.extendSizeWorld)),this.encapsulate(e.boundingBox.centerWorld.add(e.boundingBox.extendSizeWorld)),this}},{key:"scale",value:function(e){return this.boundingBox.scale(e),this.boundingSphere.scale(e),this}},{key:"isInFrustum",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=2===t||3===t;if(n&&this.boundingSphere.isCenterInFrustum(e))return!0;if(!this.boundingSphere.isInFrustum(e))return!1;var i=1===t||3===t;return!!i||this.boundingBox.isInFrustum(e)}},{key:"diagonalLength",get:function(){var t=this.boundingBox;return t.maximumWorld.subtractToRef(t.minimumWorld,e._TmpVector3[0]).length()}},{key:"isCompletelyInFrustum",value:function(e){return this.boundingBox.isCompletelyInFrustum(e)}},{key:"_checkCollision",value:function(e){return e._canDoCollision(this.boundingSphere.centerWorld,this.boundingSphere.radiusWorld,this.boundingBox.minimumWorld,this.boundingBox.maximumWorld)}},{key:"intersectsPoint",value:function(e){return!!this.boundingSphere.centerWorld&&(!!this.boundingSphere.intersectsPoint(e)&&!!this.boundingBox.intersectsPoint(e))}},{key:"intersects",value:function(e,t){if(!l.Intersects(this.boundingSphere,e.boundingSphere))return!1;if(!u.Intersects(this.boundingBox,e.boundingBox))return!1;if(!t)return!0;var n=this.boundingBox,i=e.boundingBox;return!!d(n.directions[0],n,i)&&(!!d(n.directions[1],n,i)&&(!!d(n.directions[2],n,i)&&(!!d(i.directions[0],n,i)&&(!!d(i.directions[1],n,i)&&(!!d(i.directions[2],n,i)&&(!!d(o.P.Cross(n.directions[0],i.directions[0]),n,i)&&(!!d(o.P.Cross(n.directions[0],i.directions[1]),n,i)&&(!!d(o.P.Cross(n.directions[0],i.directions[2]),n,i)&&(!!d(o.P.Cross(n.directions[1],i.directions[0]),n,i)&&(!!d(o.P.Cross(n.directions[1],i.directions[1]),n,i)&&(!!d(o.P.Cross(n.directions[1],i.directions[2]),n,i)&&(!!d(o.P.Cross(n.directions[2],i.directions[0]),n,i)&&(!!d(o.P.Cross(n.directions[2],i.directions[1]),n,i)&&!!d(o.P.Cross(n.directions[2],i.directions[2]),n,i))))))))))))))}}]),e}();p._TmpVector3=a.B.BuildArray(2,o.P.Zero)},9776:function(e,t,n){"use strict";n.d(t,{L:function(){return N}});var i=n(5671),r=n(3144),a=function(){function e(){(0,i.Z)(this,e),this.children=[]}return(0,r.Z)(e,[{key:"isValid",value:function(e){return!0}},{key:"process",value:function(e,t){var n="";if(this.line){var i=this.line,r=t.processor;if(r){if(r.lineProcessor&&(i=r.lineProcessor(i,t.isFragment,t.processingContext)),r.attributeProcessor&&this.line.startsWith("attribute"))i=r.attributeProcessor(this.line,e,t.processingContext);else if(r.varyingProcessor&&this.line.startsWith("varying"))i=r.varyingProcessor(this.line,t.isFragment,e,t.processingContext);else if(r.uniformProcessor&&r.uniformRegexp&&r.uniformRegexp.test(this.line))t.lookForClosingBracketForUniformBuffer||(i=r.uniformProcessor(this.line,t.isFragment,e,t.processingContext));else if(r.uniformBufferProcessor&&r.uniformBufferRegexp&&r.uniformBufferRegexp.test(this.line))t.lookForClosingBracketForUniformBuffer||(i=r.uniformBufferProcessor(this.line,t.isFragment,t.processingContext),t.lookForClosingBracketForUniformBuffer=!0);else if(r.textureProcessor&&r.textureRegexp&&r.textureRegexp.test(this.line))i=r.textureProcessor(this.line,t.isFragment,e,t.processingContext);else if((r.uniformProcessor||r.uniformBufferProcessor)&&this.line.startsWith("uniform")&&!t.lookForClosingBracketForUniformBuffer){/uniform\s+(?:(?:highp)?|(?:lowp)?)\s*(\S+)\s+(\S+)\s*;/.test(this.line)?r.uniformProcessor&&(i=r.uniformProcessor(this.line,t.isFragment,e,t.processingContext)):r.uniformBufferProcessor&&(i=r.uniformBufferProcessor(this.line,t.isFragment,t.processingContext),t.lookForClosingBracketForUniformBuffer=!0)}t.lookForClosingBracketForUniformBuffer&&-1!==this.line.indexOf("}")&&(t.lookForClosingBracketForUniformBuffer=!1,r.endOfUniformBufferProcessor&&(i=r.endOfUniformBufferProcessor(this.line,t.isFragment,t.processingContext)))}n+=i+"\r\n"}return this.children.forEach((function(i){n+=i.process(e,t)})),this.additionalDefineKey&&(e[this.additionalDefineKey]=this.additionalDefineValue||"true"),n}}]),e}();function o(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){u=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(u)throw a}}}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var u=function(){function e(){(0,i.Z)(this,e),this._lines=[]}return(0,r.Z)(e,[{key:"currentLine",get:function(){return this._lines[this.lineIndex]}},{key:"canRead",get:function(){return this.lineIndex<this._lines.length-1}},{key:"lines",set:function(e){this._lines.length=0;var t,n=o(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;if("#"!==i[0])if(i.trim().startsWith("//"))this._lines.push(i);else for(var r=i.split(";"),a=0;a<r.length;a++){var s=r[a];(s=s.trim())&&this._lines.push(s+(a!==r.length-1?";":""))}else this._lines.push(i)}}catch(u){n.e(u)}finally{n.f()}}}]),e}(),l=n(136),c=n(6215),h=n(1120);function f(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,h.Z)(e);if(t){var r=(0,h.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,c.Z)(this,n)}}var d=function(e){(0,l.Z)(n,e);var t=f(n);function n(){return(0,i.Z)(this,n),t.apply(this,arguments)}return(0,r.Z)(n,[{key:"process",value:function(e,t){for(var n=0;n<this.children.length;n++){var i=this.children[n];if(i.isValid(e))return i.process(e,t)}return""}}]),n}(a);function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,h.Z)(e);if(t){var r=(0,h.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,c.Z)(this,n)}}var v=function(e){(0,l.Z)(n,e);var t=p(n);function n(){return(0,i.Z)(this,n),t.apply(this,arguments)}return(0,r.Z)(n,[{key:"isValid",value:function(e){return this.testExpression.isTrue(e)}}]),n}(a);function m(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return g(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var _=function(){function e(){(0,i.Z)(this,e)}return(0,r.Z)(e,[{key:"isTrue",value:function(e){return!0}}],[{key:"postfixToInfix",value:function(t){var n,i=[],r=m(t);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(void 0===e._OperatorPriority[a])i.push(a);else{var o=i[i.length-1],s=i[i.length-2];i.length-=2,i.push("(".concat(s).concat(a).concat(o,")"))}}}catch(u){r.e(u)}finally{r.f()}return i[i.length-1]}},{key:"infixToPostfix",value:function(t){for(var n=[],i=-1,r=function(){""!==(l=l.trim())&&(n.push(l),l="")},a=function(t){i<e._Stack.length-1&&(e._Stack[++i]=t)},o=function(){return e._Stack[i]},s=function(){return-1===i?"!!INVALID EXPRESSION!!":e._Stack[i--]},u=0,l="";u<t.length;){var c=t.charAt(u),h=u<t.length-1?t.substr(u,2):"";if("("===c)l="",a(c);else if(")"===c){for(r();-1!==i&&"("!==o();)n.push(s());s()}else if(e._OperatorPriority[h]>1){for(r();-1!==i&&e._OperatorPriority[o()]>=e._OperatorPriority[h];)n.push(s());a(h),u++}else l+=c;u++}for(r();-1!==i;)"("===o()?s():n.push(s());return n}}]),e}();function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,h.Z)(e);if(t){var r=(0,h.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,c.Z)(this,n)}}_._OperatorPriority={")":0,"(":1,"||":2,"&&":3},_._Stack=["","","","","","","","","","","","","","","","","","","",""];var E=function(e){(0,l.Z)(n,e);var t=y(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(0,i.Z)(this,n),(r=t.call(this)).define=e,r.not=a,r}return(0,r.Z)(n,[{key:"isTrue",value:function(e){var t=void 0!==e[this.define];return this.not&&(t=!t),t}}]),n}(_);function A(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,h.Z)(e);if(t){var r=(0,h.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,c.Z)(this,n)}}var b=function(e){(0,l.Z)(n,e);var t=A(n);function n(){return(0,i.Z)(this,n),t.apply(this,arguments)}return(0,r.Z)(n,[{key:"isTrue",value:function(e){return this.leftOperand.isTrue(e)||this.rightOperand.isTrue(e)}}]),n}(_);function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,h.Z)(e);if(t){var r=(0,h.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,c.Z)(this,n)}}var M=function(e){(0,l.Z)(n,e);var t=T(n);function n(){return(0,i.Z)(this,n),t.apply(this,arguments)}return(0,r.Z)(n,[{key:"isTrue",value:function(e){return this.leftOperand.isTrue(e)&&this.rightOperand.isTrue(e)}}]),n}(_);function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,h.Z)(e);if(t){var r=(0,h.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,c.Z)(this,n)}}var I=function(e){(0,l.Z)(n,e);var t=S(n);function n(e,r,a){var o;return(0,i.Z)(this,n),(o=t.call(this)).define=e,o.operand=r,o.testValue=a,o}return(0,r.Z)(n,[{key:"isTrue",value:function(e){var t=e[this.define];void 0===t&&(t=this.define);var n=!1,i=parseInt(t),r=parseInt(this.testValue);switch(this.operand){case">":n=i>r;break;case"<":n=i<r;break;case"<=":n=i<=r;break;case">=":n=i>=r;break;case"==":n=i===r}return n}}]),n}(_),x=n(5230),C=n(2223);function P(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return D(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return D(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function D(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var R=/defined\s*?\((.+?)\)/g,k=/defined\s*?\[(.+?)\]/g,O=/#include\s?<(.+)>(\((.*)\))*(\[(.*)\])*/g,N=function(){function e(){(0,i.Z)(this,e)}return(0,r.Z)(e,null,[{key:"Initialize",value:function(e){e.processor&&e.processor.initializeShaders&&e.processor.initializeShaders(e.processingContext)}},{key:"Process",value:function(e,t,n,i){var r,a=this;null!==(r=t.processor)&&void 0!==r&&r.preProcessShaderCode&&(e=t.processor.preProcessShaderCode(e,t.isFragment)),this._ProcessIncludes(e,t,(function(e){t.processCodeAfterIncludes&&(e=t.processCodeAfterIncludes(t.isFragment?"fragment":"vertex",e));var r=a._ProcessShaderConversion(e,t,i);n(r)}))}},{key:"PreProcess",value:function(e,t,n,i){var r,a=this;null!==(r=t.processor)&&void 0!==r&&r.preProcessShaderCode&&(e=t.processor.preProcessShaderCode(e,t.isFragment)),this._ProcessIncludes(e,t,(function(e){t.processCodeAfterIncludes&&(e=t.processCodeAfterIncludes(t.isFragment?"fragment":"vertex",e));var r=a._ApplyPreProcessing(e,t,i);n(r)}))}},{key:"Finalize",value:function(e,t,n){return n.processor&&n.processor.finalizeShaders?n.processor.finalizeShaders(e,t,n.processingContext):{vertexCode:e,fragmentCode:t}}},{key:"_ProcessPrecision",value:function(e,t){var n;if(null!==(n=t.processor)&&void 0!==n&&n.noPrecision)return e;var i=t.shouldUseHighPrecisionShader;return-1===e.indexOf("precision highp float")?e=i?"precision highp float;\n"+e:"precision mediump float;\n"+e:i||(e=e.replace("precision highp float","precision mediump float")),e}},{key:"_ExtractOperation",value:function(e){var t=/defined\((.+)\)/.exec(e);if(t&&t.length)return new E(t[1].trim(),"!"===e[0]);for(var n="",i=0,r=0,a=["==",">=","<=","<",">"];r<a.length&&(n=a[r],!((i=e.indexOf(n))>-1));r++);if(-1===i)return new E(e);var o=e.substring(0,i).trim(),s=e.substring(i+n.length).trim();return new I(o,n,s)}},{key:"_BuildSubExpression",value:function(e){e=e.replace(R,"defined[$1]");var t,n=[],i=P(_.infixToPostfix(e));try{for(i.s();!(t=i.n()).done;){var r=t.value;if("||"!==r&&"&&"!==r)n.push(r);else if(n.length>=2){var a=n[n.length-1],o=n[n.length-2];n.length-=2;var s="&&"==r?new M:new b;"string"==typeof a&&(a=a.replace(k,"defined($1)")),"string"==typeof o&&(o=o.replace(k,"defined($1)")),s.leftOperand="string"==typeof o?this._ExtractOperation(o):o,s.rightOperand="string"==typeof a?this._ExtractOperation(a):a,n.push(s)}}}catch(l){i.e(l)}finally{i.f()}var u=n[n.length-1];return"string"==typeof u&&(u=u.replace(k,"defined($1)")),"string"==typeof u?this._ExtractOperation(u):u}},{key:"_BuildExpression",value:function(e,t){var n=new v,i=e.substring(0,t),r=e.substring(t);return r=r.substring(0,(r.indexOf("//")+1||r.length+1)-1).trim(),n.testExpression="#ifdef"===i?new E(r):"#ifndef"===i?new E(r,!0):this._BuildSubExpression(r),n}},{key:"_MoveCursorWithinIf",value:function(e,t,n){for(var i=e.currentLine;this._MoveCursor(e,n);){var r=(i=e.currentLine).substring(0,5).toLowerCase();if("#else"===r){var o=new a;return t.children.push(o),void this._MoveCursor(e,o)}if("#elif"===r){var s=this._BuildExpression(i,5);t.children.push(s),n=s}}}},{key:"_MoveCursor",value:function(e,t){for(;e.canRead;){e.lineIndex++;var n=e.currentLine,i=/(#ifdef)|(#else)|(#elif)|(#endif)|(#ifndef)|(#if)/.exec(n);if(i&&i.length){switch(i[0]){case"#ifdef":var r=new d;t.children.push(r);var o=this._BuildExpression(n,6);r.children.push(o),this._MoveCursorWithinIf(e,r,o);break;case"#else":case"#elif":return!0;case"#endif":return!1;case"#ifndef":var s=new d;t.children.push(s);var u=this._BuildExpression(n,7);s.children.push(u),this._MoveCursorWithinIf(e,s,u);break;case"#if":var l=new d,c=this._BuildExpression(n,3);t.children.push(l),l.children.push(c),this._MoveCursorWithinIf(e,l,c)}}else{var h=new a;if(h.line=n,t.children.push(h),"#"===n[0]&&"d"===n[1]){var f=n.replace(";","").split(" ");h.additionalDefineKey=f[1],3===f.length&&(h.additionalDefineValue=f[2])}}}return!1}},{key:"_EvaluatePreProcessors",value:function(e,t,n){var i=new a,r=new u;return r.lineIndex=-1,r.lines=e.split("\n"),this._MoveCursor(r,i),i.process(t,n)}},{key:"_PreparePreProcessors",value:function(e,t){var n,i,r={},a=P(e.defines);try{for(a.s();!(i=a.n()).done;){var o=i.value.replace("#define","").replace(";","").trim().split(" ");r[o[0]]=o.length>1?o[1]:""}}catch(s){a.e(s)}finally{a.f()}return(null===(n=e.processor)||void 0===n?void 0:n.shaderLanguage)===C.x.GLSL&&(r.GL_ES="true"),r.__VERSION__=e.version,r[e.platformName]="true",t._getGlobalDefines(r),r}},{key:"_ProcessShaderConversion",value:function(e,t,n){var i=this._ProcessPrecision(e,t);if(!t.processor)return i;if(t.processor.shaderLanguage===C.x.GLSL&&-1!==i.indexOf("#version 3"))return i.replace("#version 300 es","");var r=t.defines,a=this._PreparePreProcessors(t,n);return t.processor.preProcessor&&(i=t.processor.preProcessor(i,r,t.isFragment,t.processingContext)),i=this._EvaluatePreProcessors(i,a,t),t.processor.postProcessor&&(i=t.processor.postProcessor(i,r,t.isFragment,t.processingContext,n)),n._features.needShaderCodeInlining&&(i=n.inlineShaderCode(i)),i}},{key:"_ApplyPreProcessing",value:function(e,t,n){var i,r,a=e,o=t.defines,s=this._PreparePreProcessors(t,n);return null!==(i=t.processor)&&void 0!==i&&i.preProcessor&&(a=t.processor.preProcessor(a,o,t.isFragment,t.processingContext)),a=this._EvaluatePreProcessors(a,s,t),null!==(r=t.processor)&&void 0!==r&&r.postProcessor&&(a=t.processor.postProcessor(a,o,t.isFragment,t.processingContext,n)),n._features.needShaderCodeInlining&&(a=n.inlineShaderCode(a)),a}},{key:"_ProcessIncludes",value:function(t,n,i){for(var r=this,a=O.exec(t),o=new String(t),s=!1,u=function(){var u=a[1];if(-1!==u.indexOf("__decl__")&&(u=u.replace(/__decl__/,""),n.supportsUniformBuffers&&(u=(u=u.replace(/Vertex/,"Ubo")).replace(/Fragment/,"Ubo")),u+="Declaration"),!n.includesShadersStore[u]){var l=n.shadersRepository+"ShadersInclude/"+u+".fx";return e._FileToolsLoadFile(l,(function(e){n.includesShadersStore[u]=e,r._ProcessIncludes(o,n,i)})),{v:void 0}}var c=n.includesShadersStore[u];if(a[2])for(var h=a[3].split(","),f=0;f<h.length;f+=2){var d=new RegExp(h[f],"g"),p=h[f+1];c=c.replace(d,p)}if(a[4]){var v=a[5];if(-1!==v.indexOf("..")){var m=v.split(".."),g=parseInt(m[0]),_=parseInt(m[1]),y=c.slice(0);c="",isNaN(_)&&(_=n.indexParameters[m[1]]);for(var E=g;E<_;E++)n.supportsUniformBuffers||(y=y.replace(/light\{X\}.(\w*)/g,(function(e,t){return t+"{X}"}))),c+=y.replace(/\{X\}/g,E.toString())+"\n"}else n.supportsUniformBuffers||(c=c.replace(/light\{X\}.(\w*)/g,(function(e,t){return t+"{X}"}))),c=c.replace(/\{X\}/g,v)}o=o.replace(a[0],c),s=s||c.indexOf("#include<")>=0||c.indexOf("#include <")>=0,a=O.exec(t)};null!=a;){var l=u();if("object"==typeof l)return l.v}s?this._ProcessIncludes(o.toString(),n,i):i(o)}},{key:"_FileToolsLoadFile",value:function(e,t,n,i,r,a){throw(0,x.S)("FileTools")}}]),e}()},938:function(e,t,n){"use strict";n.d(t,{C:function(){return o}});var i=n(5671),r=n(3144),a=n(2223),o=function(){function e(){(0,i.Z)(this,e),this.shaderLanguage=a.x.GLSL}return(0,r.Z)(e,[{key:"attributeProcessor",value:function(e){return e.replace("attribute","in")}},{key:"varyingProcessor",value:function(e,t){return e.replace("varying",t?"in":"out")}},{key:"postProcessor",value:function(e,t,n){var i=-1!==e.search(/#extension.+GL_EXT_draw_buffers.+require/);if(e=(e=e.replace(/#extension.+(GL_OVR_multiview2|GL_OES_standard_derivatives|GL_EXT_shader_texture_lod|GL_EXT_frag_depth|GL_EXT_draw_buffers).+(enable|require)/g,"")).replace(/texture2D\s*\(/g,"texture("),n)e=(e=(e=(e=(e=(e=(e=e.replace(/texture2DLodEXT\s*\(/g,"textureLod(")).replace(/textureCubeLodEXT\s*\(/g,"textureLod(")).replace(/textureCube\s*\(/g,"texture(")).replace(/gl_FragDepthEXT/g,"gl_FragDepth")).replace(/gl_FragColor/g,"glFragColor")).replace(/gl_FragData/g,"glFragData")).replace(/void\s+?main\s*\(/g,(i?"":"out vec4 glFragColor;\n")+"void main(");else if(-1!==t.indexOf("#define MULTIVIEW"))return"#extension GL_OVR_multiview2 : require\nlayout (num_views = 2) in;\n"+e;return e}}]),e}()},6431:function(e,t,n){"use strict";n.d(t,{B:function(){return a}});var i=n(5671),r=n(3144),a=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1?arguments[1]:void 0;if((0,i.Z)(this,e),this._MSAARenderBuffer=null,this._context=n,!t&&!(t=n.createTexture()))throw new Error("Unable to create webGL texture");this.set(t)}return(0,r.Z)(e,[{key:"underlyingResource",get:function(){return this._webGLTexture}},{key:"setUsage",value:function(){}},{key:"set",value:function(e){this._webGLTexture=e}},{key:"reset",value:function(){this._webGLTexture=null,this._MSAARenderBuffer=null}},{key:"release",value:function(){this._MSAARenderBuffer&&(this._context.deleteRenderbuffer(this._MSAARenderBuffer),this._MSAARenderBuffer=null),this._webGLTexture&&this._context.deleteTexture(this._webGLTexture),this.reset()}}]),e}()},8099:function(e,t,n){"use strict";n.d(t,{y:function(){return u}});var i=n(5671),r=n(3144);function a(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){u=!0,a=e},f:function(){try{s||null==n.return||n.return()}finally{if(u)throw a}}}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var s=["Int2","Int","Int3","Int4","Vector2","Vector3","Vector4","Float2","Float","Float3","Float4","Quaternion","Color3","Color4","DirectColor4"],u=function(){function e(){var t=this;(0,i.Z)(this,e),this._valueCache={},this.vertexCompilationError=null,this.fragmentCompilationError=null,this.programLinkError=null,this.programValidationError=null;var n=[],r=function(){n.length=0,Array.prototype.push.apply(n,arguments),n[0]=this._uniforms[n[0]]},a=function(e){var i=s.includes(e.substring(3))&&"FloatN";if(i){var a=t["_cache".concat(i)];return function(){var t=this.engine[e];r.apply(this,arguments),a.apply(this,arguments)&&(t.apply(this.engine,n)||(this._valueCache[arguments[0]]=null))}}return function(){var t=this.engine[e];r.apply(this,arguments),void 0!==arguments[1]&&(this._valueCache[arguments[0]]=null,t.apply(this.engine,n))}};["Int?","IntArray?","Array?","Float?","Matrices","Matrix3x3","Matrix2x2"].forEach((function(e){var n="set".concat(e);t[n]||(n.endsWith("?")?["",2,3,4].forEach((function(e){t[n.slice(0,-1)+e]=t[n.slice(0,-1)+e]||a(n.slice(0,-1)+e).bind(t)})):t[n]=t[n]||a(n).bind(t))}))}return(0,r.Z)(e,[{key:"isAsync",get:function(){return this.isParallelCompiled}},{key:"isReady",get:function(){return!!this.program&&(!this.isParallelCompiled||this.engine._isRenderingStateCompiled(this))}},{key:"_handlesSpectorRebuildCallback",value:function(e){e&&this.program&&e(this.program)}},{key:"_fillEffectInformation",value:function(e,t,n,i,r,o,s,u){var l,c=this.engine;if(c.supportsUniformBuffers)for(var h in t)e.bindUniformBlock(h,t[h]);for(this.engine.getUniforms(this,n).forEach((function(e,t){i[n[t]]=e})),this._uniforms=i,l=0;l<r.length;l++){null==e.getUniform(r[l])&&(r.splice(l,1),l--)}r.forEach((function(e,t){o[e]=t}));var f,d=a(c.getAttributes(this,s));try{for(d.s();!(f=d.n()).done;){var p=f.value;u.push(p)}}catch(v){d.e(v)}finally{d.f()}}},{key:"dispose",value:function(){this._uniforms={}}},{key:"_cacheMatrix",value:function(e,t){var n=this._valueCache[e],i=t.updateFlag;return(void 0===n||n!==i)&&(this._valueCache[e]=i,!0)}},{key:"_cacheFloatN",value:function(e,t,n,i,r){var a=this._valueCache[arguments[0]];if(!a||a.length!==arguments.length-1)return a=Array.prototype.slice.call(arguments,1),this._valueCache[arguments[0]]=a,!0;for(var o=!1,s=0;s<a.length;++s)a[s]!==arguments[s+1]&&(a[s]=arguments[s+1],o=!0);return o}},{key:"_cacheFloat2",value:function(e,t,n){return this._cacheFloatN(e,t,n)}},{key:"_cacheFloat3",value:function(e,t,n,i){return this._cacheFloatN(e,t,n,i)}},{key:"_cacheFloat4",value:function(e,t,n,i,r){return this._cacheFloatN(e,t,n,i,r)}},{key:"setMatrix",value:function(e,t){this._cacheMatrix(e,t)&&(this.engine.setMatrices(this._uniforms[e],t.toArray())||(this._valueCache[e]=null))}},{key:"setVector2",value:function(e,t){this.setFloat2(e,t.x,t.y)}},{key:"setVector3",value:function(e,t){this.setFloat3(e,t.x,t.y,t.z)}},{key:"setVector4",value:function(e,t){this.setFloat4(e,t.x,t.y,t.z,t.w)}},{key:"setQuaternion",value:function(e,t){this.setFloat4(e,t.x,t.y,t.z,t.w)}},{key:"setColor3",value:function(e,t){this.setFloat3(e,t.r,t.g,t.b)}},{key:"setColor4",value:function(e,t,n){this.setFloat4(e,t.r,t.g,t.b,n)}},{key:"setDirectColor4",value:function(e,t){this.setFloat4(e,t.r,t.g,t.b,t.a)}},{key:"_getVertexShaderCode",value:function(){return this.vertexShader?this.engine._getShaderSource(this.vertexShader):null}},{key:"_getFragmentShaderCode",value:function(){return this.fragmentShader?this.engine._getShaderSource(this.fragmentShader):null}}]),e}()},970:function(e,t,n){"use strict";n.d(t,{f:function(){return o}});var i=n(5671),r=n(3144),a=n(2223),o=function(){function e(){(0,i.Z)(this,e),this.shaderLanguage=a.x.GLSL}return(0,r.Z)(e,[{key:"postProcessor",value:function(e,t,n,i,r){if(!r.getCaps().drawBuffersExtension){e=e.replace(/#extension.+GL_EXT_draw_buffers.+(enable|require)/g,"")}return e}}]),e}()},2977:function(e,t,n){"use strict";n.d(t,{D:function(){return x}});var i=n(5671),r=n(3144),a=n(7326),o=n(1752),s=n(136),u=n(6215),l=n(1120),c=n(4174),h=n(1889),f=n(5092),d=n(4198),p=n(5230),v=n(4796),m=n(2786),g=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:30;(0,i.Z)(this,e),this._enabled=!0,this._rollingFrameTime=new _(t)}return(0,r.Z)(e,[{key:"sampleFrame",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m.F.Now;if(this._enabled){if(null!=this._lastFrameTimeMs){var t=e-this._lastFrameTimeMs;this._rollingFrameTime.add(t)}this._lastFrameTimeMs=e}}},{key:"averageFrameTime",get:function(){return this._rollingFrameTime.average}},{key:"averageFrameTimeVariance",get:function(){return this._rollingFrameTime.variance}},{key:"instantaneousFrameTime",get:function(){return this._rollingFrameTime.history(0)}},{key:"averageFPS",get:function(){return 1e3/this._rollingFrameTime.average}},{key:"instantaneousFPS",get:function(){var e=this._rollingFrameTime.history(0);return 0===e?0:1e3/e}},{key:"isSaturated",get:function(){return this._rollingFrameTime.isSaturated()}},{key:"enable",value:function(){this._enabled=!0}},{key:"disable",value:function(){this._enabled=!1,this._lastFrameTimeMs=null}},{key:"isEnabled",get:function(){return this._enabled}},{key:"reset",value:function(){this._lastFrameTimeMs=null,this._rollingFrameTime.reset()}}]),e}(),_=function(){function e(t){(0,i.Z)(this,e),this._samples=new Array(t),this.reset()}return(0,r.Z)(e,[{key:"add",value:function(e){var t;if(this.isSaturated()){var n=this._samples[this._pos];t=n-this.average,this.average-=t/(this._sampleCount-1),this._m2-=t*(n-this.average)}else this._sampleCount++;t=e-this.average,this.average+=t/this._sampleCount,this._m2+=t*(e-this.average),this.variance=this._m2/(this._sampleCount-1),this._samples[this._pos]=e,this._pos++,this._pos%=this._samples.length}},{key:"history",value:function(e){if(e>=this._sampleCount||e>=this._samples.length)return 0;var t=this._wrapPosition(this._pos-1);return this._samples[this._wrapPosition(t-e)]}},{key:"isSaturated",value:function(){return this._sampleCount>=this._samples.length}},{key:"reset",value:function(){this.average=0,this.variance=0,this._sampleCount=0,this._pos=0,this._m2=0}},{key:"_wrapPosition",value:function(e){var t=this._samples.length;return(e%t+t)%t}}]),e}(),y=n(2864),E=n(2628),A=n(2328),b=n(6431);function T(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3?arguments[3]:void 0;switch(e){case 3:var r=(ArrayBuffer,new Int8Array(t));return i&&r.set(new Int8Array(i)),r;case 0:var a=(ArrayBuffer,new Uint8Array(t));return i&&a.set(new Uint8Array(i)),a;case 4:var o=t instanceof ArrayBuffer?new Int16Array(t):new Int16Array(n?t/2:t);return i&&o.set(new Int16Array(i)),o;case 5:case 8:case 9:case 10:case 2:var s=t instanceof ArrayBuffer?new Uint16Array(t):new Uint16Array(n?t/2:t);return i&&s.set(new Uint16Array(i)),s;case 6:var u=t instanceof ArrayBuffer?new Int32Array(t):new Int32Array(n?t/4:t);return i&&u.set(new Int32Array(i)),u;case 7:case 11:case 12:case 13:case 14:case 15:var l=t instanceof ArrayBuffer?new Uint32Array(t):new Uint32Array(n?t/4:t);return i&&l.set(new Uint32Array(i)),l;case 1:var c=t instanceof ArrayBuffer?new Float32Array(t):new Float32Array(n?t/4:t);return i&&c.set(new Float32Array(i)),c}var h=(ArrayBuffer,new Uint8Array(t));return i&&h.set(new Uint8Array(i)),h}function M(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return S(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return S(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function I(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,l.Z)(e);if(t){var r=(0,l.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,u.Z)(this,n)}}v.B.prototype.setAlphaConstants=function(e,t,n,i){this._alphaState.setAlphaBlendConstants(e,t,n,i)},v.B.prototype.setAlphaMode=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this._alphaMode!==e){switch(e){case 0:this._alphaState.alphaBlend=!1;break;case 7:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA,this._gl.ONE,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 8:case 14:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA,this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA),this._alphaState.alphaBlend=!0;break;case 2:this._alphaState.setAlphaBlendFunctionParameters(this._gl.SRC_ALPHA,this._gl.ONE_MINUS_SRC_ALPHA,this._gl.ONE,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 6:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE,this._gl.ONE,this._gl.ZERO,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 1:this._alphaState.setAlphaBlendFunctionParameters(this._gl.SRC_ALPHA,this._gl.ONE,this._gl.ZERO,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 3:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ZERO,this._gl.ONE_MINUS_SRC_COLOR,this._gl.ONE,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 4:this._alphaState.setAlphaBlendFunctionParameters(this._gl.DST_COLOR,this._gl.ZERO,this._gl.ONE,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 5:this._alphaState.setAlphaBlendFunctionParameters(this._gl.SRC_ALPHA,this._gl.ONE_MINUS_SRC_COLOR,this._gl.ONE,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 9:this._alphaState.setAlphaBlendFunctionParameters(this._gl.CONSTANT_COLOR,this._gl.ONE_MINUS_CONSTANT_COLOR,this._gl.CONSTANT_ALPHA,this._gl.ONE_MINUS_CONSTANT_ALPHA),this._alphaState.alphaBlend=!0;break;case 10:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE,this._gl.ONE_MINUS_SRC_COLOR,this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA),this._alphaState.alphaBlend=!0;break;case 11:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE,this._gl.ONE,this._gl.ONE,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 12:this._alphaState.setAlphaBlendFunctionParameters(this._gl.DST_ALPHA,this._gl.ONE,this._gl.ZERO,this._gl.ZERO),this._alphaState.alphaBlend=!0;break;case 13:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE_MINUS_DST_COLOR,this._gl.ONE_MINUS_SRC_COLOR,this._gl.ONE_MINUS_DST_ALPHA,this._gl.ONE_MINUS_SRC_ALPHA),this._alphaState.alphaBlend=!0;break;case 15:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE,this._gl.ONE,this._gl.ONE,this._gl.ZERO),this._alphaState.alphaBlend=!0;break;case 16:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE_MINUS_DST_COLOR,this._gl.ONE_MINUS_SRC_COLOR,this._gl.ZERO,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 17:this._alphaState.setAlphaBlendFunctionParameters(this._gl.SRC_ALPHA,this._gl.ONE_MINUS_SRC_ALPHA,this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA),this._alphaState.alphaBlend=!0}t||(this.depthCullingState.depthMask=0===e),this._alphaMode=e}},v.B.prototype.getAlphaMode=function(){return this._alphaMode},v.B.prototype.setAlphaEquation=function(e){if(this._alphaEquation!==e){switch(e){case 0:this._alphaState.setAlphaEquationParameters(32774,32774);break;case 1:this._alphaState.setAlphaEquationParameters(32778,32778);break;case 2:this._alphaState.setAlphaEquationParameters(32779,32779);break;case 3:this._alphaState.setAlphaEquationParameters(32776,32776);break;case 4:this._alphaState.setAlphaEquationParameters(32775,32775);break;case 5:this._alphaState.setAlphaEquationParameters(32775,32774)}this._alphaEquation=e}},v.B.prototype.getAlphaEquation=function(){return this._alphaEquation},v.B.prototype._readTexturePixelsSync=function(e,t,n){var i,r,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,u=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],l=arguments.length>7&&void 0!==arguments[7]&&arguments[7],c=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,h=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0,f=this._gl;if(!f)throw new Error("Engine does not have gl rendering context.");if(!this._dummyFramebuffer){var d=f.createFramebuffer();if(!d)throw new Error("Unable to create dummy framebuffer");this._dummyFramebuffer=d}(f.bindFramebuffer(f.FRAMEBUFFER,this._dummyFramebuffer),a>-1)?f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_CUBE_MAP_POSITIVE_X+a,null===(i=e._hardwareTexture)||void 0===i?void 0:i.underlyingResource,o):f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,null===(r=e._hardwareTexture)||void 0===r?void 0:r.underlyingResource,o);var p=void 0!==e.type?this._getWebGLTextureType(e.type):f.UNSIGNED_BYTE;if(l)s||(s=T(e.type,4*t*n));else if(p===f.UNSIGNED_BYTE)s||(s=new Uint8Array(4*t*n)),p=f.UNSIGNED_BYTE;else s||(s=new Float32Array(4*t*n)),p=f.FLOAT;return u&&this.flushFramebuffer(),f.readPixels(c,h,t,n,f.RGBA,p,s),f.bindFramebuffer(f.FRAMEBUFFER,this._currentFramebuffer),s},v.B.prototype._readTexturePixels=function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],s=arguments.length>7&&void 0!==arguments[7]&&arguments[7],u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,l=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0;return Promise.resolve(this._readTexturePixelsSync(e,t,n,i,r,a,o,s,u,l))},v.B.prototype.updateDynamicIndexBuffer=function(e,t){var n;this._currentBoundBuffer[this._gl.ELEMENT_ARRAY_BUFFER]=null,this.bindIndexBuffer(e),n=e.is32Bits?t instanceof Uint32Array?t:new Uint32Array(t):t instanceof Uint16Array?t:new Uint16Array(t),this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,n,this._gl.DYNAMIC_DRAW),this._resetIndexBufferBinding()},v.B.prototype.updateDynamicVertexBuffer=function(e,t,n,i){this.bindArrayBuffer(e),void 0===n&&(n=0);var r=t.byteLength||t.length;void 0===i||i>=r&&0===n?t instanceof Array?this._gl.bufferSubData(this._gl.ARRAY_BUFFER,n,new Float32Array(t)):this._gl.bufferSubData(this._gl.ARRAY_BUFFER,n,t):t instanceof Array?this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,new Float32Array(t).subarray(n,n+i)):(t=t instanceof ArrayBuffer?new Uint8Array(t,n,i):new Uint8Array(t.buffer,t.byteOffset+n,i),this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,t)),this._resetVertexBufferBinding()};var x=function(e){(0,s.Z)(n,e);var t=I(n);function n(e,r,o){var s,l=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if((0,i.Z)(this,n),(s=t.call(this,e,r,o,l)).enableOfflineSupport=!1,s.disableManifestCheck=!1,s.disableContextMenu=!0,s.scenes=new Array,s._virtualScenes=new Array,s.onNewSceneAddedObservable=new c.y$,s.postProcesses=new Array,s.isPointerLock=!1,s.onResizeObservable=new c.y$,s.onCanvasBlurObservable=new c.y$,s.onCanvasFocusObservable=new c.y$,s.onCanvasPointerOutObservable=new c.y$,s.onBeginFrameObservable=new c.y$,s.customAnimationFrameRequester=null,s.onEndFrameObservable=new c.y$,s.onBeforeShaderCompilationObservable=new c.y$,s.onAfterShaderCompilationObservable=new c.y$,s._deterministicLockstep=!1,s._lockstepMaxSteps=4,s._timeStep=1/60,s._fps=60,s._deltaTime=0,s._drawCalls=new y.z,s.canvasTabIndex=1,s.disablePerformanceMonitorInBackground=!1,s._performanceMonitor=new g,s._compatibilityMode=!0,s.currentRenderPassId=0,s._renderPassNames=["main"],n.Instances.push((0,a.Z)(s)),!e)return(0,u.Z)(s);if(s._features.supportRenderPasses=!0,o=s._creationOptions,e.getContext){var h=e;if(s._sharedInit(h,!!o.doNotHandleTouchAction,o.audioEngine),(0,f.CG)()){var d=document;s._onFullscreenChange=function(){void 0!==d.fullscreen?s.isFullscreen=d.fullscreen:void 0!==d.mozFullScreen?s.isFullscreen=d.mozFullScreen:void 0!==d.webkitIsFullScreen?s.isFullscreen=d.webkitIsFullScreen:void 0!==d.msIsFullScreen&&(s.isFullscreen=d.msIsFullScreen),s.isFullscreen&&s._pointerLockRequested&&h&&n._RequestPointerlock(h)},document.addEventListener("fullscreenchange",s._onFullscreenChange,!1),document.addEventListener("mozfullscreenchange",s._onFullscreenChange,!1),document.addEventListener("webkitfullscreenchange",s._onFullscreenChange,!1),document.addEventListener("msfullscreenchange",s._onFullscreenChange,!1),s._onPointerLockChange=function(){s.isPointerLock=d.mozPointerLockElement===h||d.webkitPointerLockElement===h||d.msPointerLockElement===h||d.pointerLockElement===h},document.addEventListener("pointerlockchange",s._onPointerLockChange,!1),document.addEventListener("mspointerlockchange",s._onPointerLockChange,!1),document.addEventListener("mozpointerlockchange",s._onPointerLockChange,!1),document.addEventListener("webkitpointerlockchange",s._onPointerLockChange,!1),!n.audioEngine&&o.audioEngine&&n.AudioEngineFactory&&(n.audioEngine=n.AudioEngineFactory(s.getRenderingCanvas(),s.getAudioContext(),s.getAudioDestination()))}s._connectVREvents(),s.enableOfflineSupport=void 0!==n.OfflineProviderFactory,s._deterministicLockstep=!!o.deterministicLockstep,s._lockstepMaxSteps=o.lockstepMaxSteps||0,s._timeStep=o.timeStep||1/60}return s._prepareVRComponent(),o.autoEnableWebVR&&s.initWebVR(),s}return(0,r.Z)(n,[{key:"_createImageBitmapFromSource",value:function(e,t){var n=this;return new Promise((function(i,r){var a=new Image;a.onload=function(){a.decode().then((function(){n.createImageBitmap(a,t).then((function(e){i(e)}))}))},a.onerror=function(){r("Error loading image ".concat(a.src))},a.src=e}))}},{key:"createImageBitmap",value:function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t){return createImageBitmap(e,t)}))},{key:"resizeImageBitmap",value:function(e,t,n){var i=this.createCanvas(t,n).getContext("2d");if(!i)throw new Error("Unable to get 2d context for resizeImageBitmap");return i.drawImage(e,0,0),i.getImageData(0,0,t,n).data}},{key:"_supportsHardwareTextureRescaling",get:function(){return!!n._RescalePostProcessFactory}},{key:"performanceMonitor",get:function(){return this._performanceMonitor}},{key:"compatibilityMode",get:function(){return this._compatibilityMode},set:function(e){this._compatibilityMode=!0}},{key:"getInputElement",value:function(){return this._renderingCanvas}},{key:"_sharedInit",value:function(e,t,i){var r=this;if((0,o.Z)((0,l.Z)(n.prototype),"_sharedInit",this).call(this,e,t,i),this._onCanvasFocus=function(){r.onCanvasFocusObservable.notifyObservers(r)},this._onCanvasBlur=function(){r.onCanvasBlurObservable.notifyObservers(r)},this._onCanvasContextMenu=function(e){r.disableContextMenu&&e.preventDefault()},e.addEventListener("focus",this._onCanvasFocus),e.addEventListener("blur",this._onCanvasBlur),e.addEventListener("contextmenu",this._onCanvasContextMenu),this._onBlur=function(){r.disablePerformanceMonitorInBackground&&r._performanceMonitor.disable(),r._windowIsBackground=!0},this._onFocus=function(){r.disablePerformanceMonitorInBackground&&r._performanceMonitor.enable(),r._windowIsBackground=!1},this._onCanvasPointerOut=function(t){document.elementFromPoint(t.clientX,t.clientY)!==e&&r.onCanvasPointerOutObservable.notifyObservers(t)},(0,f.CG)()){var a=this.getHostWindow();a&&(a.addEventListener("blur",this._onBlur),a.addEventListener("focus",this._onFocus))}e.addEventListener("pointerout",this._onCanvasPointerOut),t||this._disableTouchAction(),!n.audioEngine&&i&&n.AudioEngineFactory&&(n.audioEngine=n.AudioEngineFactory(this.getRenderingCanvas(),this.getAudioContext(),this.getAudioDestination()))}},{key:"getAspectRatio",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.viewport;return this.getRenderWidth(t)*n.width/(this.getRenderHeight(t)*n.height)}},{key:"getScreenAspectRatio",value:function(){return this.getRenderWidth(!0)/this.getRenderHeight(!0)}},{key:"getRenderingCanvasClientRect",value:function(){return this._renderingCanvas?this._renderingCanvas.getBoundingClientRect():null}},{key:"getInputElementClientRect",value:function(){return this._renderingCanvas?this.getInputElement().getBoundingClientRect():null}},{key:"isDeterministicLockStep",value:function(){return this._deterministicLockstep}},{key:"getLockstepMaxSteps",value:function(){return this._lockstepMaxSteps}},{key:"getTimeStep",value:function(){return 1e3*this._timeStep}},{key:"generateMipMapsForCubemap",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(e.generateMipMaps){var n=this._gl;this._bindTextureDirectly(n.TEXTURE_CUBE_MAP,e,!0),n.generateMipmap(n.TEXTURE_CUBE_MAP),t&&this._bindTextureDirectly(n.TEXTURE_CUBE_MAP,null)}}},{key:"getDepthWrite",value:function(){return this._depthCullingState.depthMask}},{key:"setDepthWrite",value:function(e){this._depthCullingState.depthMask=e}},{key:"getStencilBuffer",value:function(){return this._stencilState.stencilTest}},{key:"setStencilBuffer",value:function(e){this._stencilState.stencilTest=e}},{key:"getStencilMask",value:function(){return this._stencilState.stencilMask}},{key:"setStencilMask",value:function(e){this._stencilState.stencilMask=e}},{key:"getStencilFunction",value:function(){return this._stencilState.stencilFunc}},{key:"getStencilFunctionReference",value:function(){return this._stencilState.stencilFuncRef}},{key:"getStencilFunctionMask",value:function(){return this._stencilState.stencilFuncMask}},{key:"setStencilFunction",value:function(e){this._stencilState.stencilFunc=e}},{key:"setStencilFunctionReference",value:function(e){this._stencilState.stencilFuncRef=e}},{key:"setStencilFunctionMask",value:function(e){this._stencilState.stencilFuncMask=e}},{key:"getStencilOperationFail",value:function(){return this._stencilState.stencilOpStencilFail}},{key:"getStencilOperationDepthFail",value:function(){return this._stencilState.stencilOpDepthFail}},{key:"getStencilOperationPass",value:function(){return this._stencilState.stencilOpStencilDepthPass}},{key:"setStencilOperationFail",value:function(e){this._stencilState.stencilOpStencilFail=e}},{key:"setStencilOperationDepthFail",value:function(e){this._stencilState.stencilOpDepthFail=e}},{key:"setStencilOperationPass",value:function(e){this._stencilState.stencilOpStencilDepthPass=e}},{key:"setDitheringState",value:function(e){e?this._gl.enable(this._gl.DITHER):this._gl.disable(this._gl.DITHER)}},{key:"setRasterizerState",value:function(e){e?this._gl.disable(this._gl.RASTERIZER_DISCARD):this._gl.enable(this._gl.RASTERIZER_DISCARD)}},{key:"getDepthFunction",value:function(){return this._depthCullingState.depthFunc}},{key:"setDepthFunction",value:function(e){this._depthCullingState.depthFunc=e}},{key:"setDepthFunctionToGreater",value:function(){this.setDepthFunction(516)}},{key:"setDepthFunctionToGreaterOrEqual",value:function(){this.setDepthFunction(518)}},{key:"setDepthFunctionToLess",value:function(){this.setDepthFunction(513)}},{key:"setDepthFunctionToLessOrEqual",value:function(){this.setDepthFunction(515)}},{key:"cacheStencilState",value:function(){this._cachedStencilBuffer=this.getStencilBuffer(),this._cachedStencilFunction=this.getStencilFunction(),this._cachedStencilMask=this.getStencilMask(),this._cachedStencilOperationPass=this.getStencilOperationPass(),this._cachedStencilOperationFail=this.getStencilOperationFail(),this._cachedStencilOperationDepthFail=this.getStencilOperationDepthFail(),this._cachedStencilReference=this.getStencilFunctionReference()}},{key:"restoreStencilState",value:function(){this.setStencilFunction(this._cachedStencilFunction),this.setStencilMask(this._cachedStencilMask),this.setStencilBuffer(this._cachedStencilBuffer),this.setStencilOperationPass(this._cachedStencilOperationPass),this.setStencilOperationFail(this._cachedStencilOperationFail),this.setStencilOperationDepthFail(this._cachedStencilOperationDepthFail),this.setStencilFunctionReference(this._cachedStencilReference)}},{key:"setDirectViewport",value:function(e,t,n,i){var r=this._cachedViewport;return this._cachedViewport=null,this._viewport(e,t,n,i),r}},{key:"scissorClear",value:function(e,t,n,i,r){this.enableScissor(e,t,n,i),this.clear(r,!0,!0,!0),this.disableScissor()}},{key:"enableScissor",value:function(e,t,n,i){var r=this._gl;r.enable(r.SCISSOR_TEST),r.scissor(e,t,n,i)}},{key:"disableScissor",value:function(){var e=this._gl;e.disable(e.SCISSOR_TEST)}},{key:"_reportDrawCall",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this._drawCalls.addCount(e,!1)}},{key:"initWebVR",value:function(){throw(0,p.S)("WebVRCamera")}},{key:"_prepareVRComponent",value:function(){}},{key:"_connectVREvents",value:function(e,t){}},{key:"_submitVRFrame",value:function(){}},{key:"disableVR",value:function(){}},{key:"isVRPresenting",value:function(){return!1}},{key:"_requestVRFrame",value:function(){}},{key:"_loadFileAsync",value:function(e,t,n){var i=this;return new Promise((function(r,a){i._loadFile(e,(function(e){r(e)}),void 0,t,n,(function(e,t){a(t)}))}))}},{key:"getVertexShaderSource",value:function(e){var t=this._gl.getAttachedShaders(e);return t?this._gl.getShaderSource(t[0]):null}},{key:"getFragmentShaderSource",value:function(e){var t=this._gl.getAttachedShaders(e);return t?this._gl.getShaderSource(t[1]):null}},{key:"setDepthStencilTexture",value:function(e,t,n,i){void 0!==e&&(t&&(this._boundUniforms[e]=t),n&&n.depthStencilTexture?this._setTexture(e,n,!1,!0,i):this._setTexture(e,null,void 0,void 0,i))}},{key:"setTextureFromPostProcess",value:function(e,t,n){var i,r,a=null;t&&(t._textures.data[t._currentRenderTextureInd]?a=t._textures.data[t._currentRenderTextureInd]:t._forcedOutputTexture&&(a=t._forcedOutputTexture)),this._bindTexture(e,null!==(i=null===(r=a)||void 0===r?void 0:r.texture)&&void 0!==i?i:null,n)}},{key:"setTextureFromPostProcessOutput",value:function(e,t,n){var i,r;this._bindTexture(e,null!==(i=null==t||null===(r=t._outputTexture)||void 0===r?void 0:r.texture)&&void 0!==i?i:null,n)}},{key:"_rebuildBuffers",value:function(){var e,t=M(this.scenes);try{for(t.s();!(e=t.n()).done;){var i=e.value;i.resetCachedMaterial(),i._rebuildGeometries(),i._rebuildTextures()}}catch(u){t.e(u)}finally{t.f()}var r,a=M(this._virtualScenes);try{for(a.s();!(r=a.n()).done;){var s=r.value;s.resetCachedMaterial(),s._rebuildGeometries(),s._rebuildTextures()}}catch(u){a.e(u)}finally{a.f()}(0,o.Z)((0,l.Z)(n.prototype),"_rebuildBuffers",this).call(this)}},{key:"_renderFrame",value:function(){for(var e=0;e<this._activeRenderLoops.length;e++){(0,this._activeRenderLoops[e])()}}},{key:"_renderLoop",value:function(){if(!this._contextWasLost){var e=!0;!this.renderEvenInBackground&&this._windowIsBackground&&(e=!1),e&&(this.beginFrame(),this._renderViews()||this._renderFrame(),this.endFrame())}this._activeRenderLoops.length>0?this.customAnimationFrameRequester?(this.customAnimationFrameRequester.requestID=this._queueNewFrame(this.customAnimationFrameRequester.renderFunction||this._boundRenderFunction,this.customAnimationFrameRequester),this._frameHandler=this.customAnimationFrameRequester.requestID):this.isVRPresenting()?this._requestVRFrame():this._frameHandler=this._queueNewFrame(this._boundRenderFunction,this.getHostWindow()):this._renderingQueueLaunched=!1}},{key:"_renderViews",value:function(){return!1}},{key:"switchFullscreen",value:function(e){this.isFullscreen?this.exitFullscreen():this.enterFullscreen(e)}},{key:"enterFullscreen",value:function(e){this.isFullscreen||(this._pointerLockRequested=e,this._renderingCanvas&&n._RequestFullscreen(this._renderingCanvas))}},{key:"exitFullscreen",value:function(){this.isFullscreen&&n._ExitFullscreen()}},{key:"enterPointerlock",value:function(){this._renderingCanvas&&n._RequestPointerlock(this._renderingCanvas)}},{key:"exitPointerlock",value:function(){n._ExitPointerlock()}},{key:"beginFrame",value:function(){this._measureFps(),this.onBeginFrameObservable.notifyObservers(this),(0,o.Z)((0,l.Z)(n.prototype),"beginFrame",this).call(this)}},{key:"endFrame",value:function(){(0,o.Z)((0,l.Z)(n.prototype),"endFrame",this).call(this),this._submitVRFrame(),this.onEndFrameObservable.notifyObservers(this)}},{key:"resize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isVRPresenting()||(0,o.Z)((0,l.Z)(n.prototype),"resize",this).call(this,e)}},{key:"setSize",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!this._renderingCanvas)return!1;if(!(0,o.Z)((0,l.Z)(n.prototype),"setSize",this).call(this,e,t,i))return!1;if(this.scenes){for(var r=0;r<this.scenes.length;r++)for(var a=this.scenes[r],s=0;s<a.cameras.length;s++){var u=a.cameras[s];u._currentRenderId=0}this.onResizeObservable.hasObservers()&&this.onResizeObservable.notifyObservers(this)}return!0}},{key:"_deletePipelineContext",value:function(e){var t=e;t&&t.program&&t.transformFeedback&&(this.deleteTransformFeedback(t.transformFeedback),t.transformFeedback=null),(0,o.Z)((0,l.Z)(n.prototype),"_deletePipelineContext",this).call(this,e)}},{key:"createShaderProgram",value:function(e,t,i,r,a){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;a=a||this._gl,this.onBeforeShaderCompilationObservable.notifyObservers(this);var u=(0,o.Z)((0,l.Z)(n.prototype),"createShaderProgram",this).call(this,e,t,i,r,a,s);return this.onAfterShaderCompilationObservable.notifyObservers(this),u}},{key:"_createShaderProgram",value:function(e,t,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=i.createProgram();if(e.program=a,!a)throw new Error("Unable to create program");if(i.attachShader(a,t),i.attachShader(a,n),this.webGLVersion>1&&r){var o=this.createTransformFeedback();this.bindTransformFeedback(o),this.setTranformFeedbackVaryings(a,r),e.transformFeedback=o}return i.linkProgram(a),this.webGLVersion>1&&r&&this.bindTransformFeedback(null),e.context=i,e.vertexShader=t,e.fragmentShader=n,e.isParallelCompiled||this._finalizePipelineContext(e),a}},{key:"_releaseTexture",value:function(e){(0,o.Z)((0,l.Z)(n.prototype),"_releaseTexture",this).call(this,e)}},{key:"_releaseRenderTargetWrapper",value:function(e){(0,o.Z)((0,l.Z)(n.prototype),"_releaseRenderTargetWrapper",this).call(this,e),this.scenes.forEach((function(t){t.postProcesses.forEach((function(t){t._outputTexture===e&&(t._outputTexture=null)})),t.cameras.forEach((function(t){t._postProcesses.forEach((function(t){t&&t._outputTexture===e&&(t._outputTexture=null)}))}))}))}},{key:"getRenderPassNames",value:function(){return this._renderPassNames}},{key:"getCurrentRenderPassName",value:function(){return this._renderPassNames[this.currentRenderPassId]}},{key:"createRenderPassId",value:function(e){var t=++n._RenderPassIdCounter;return this._renderPassNames[t]=null!=e?e:"NONAME",t}},{key:"releaseRenderPassId",value:function(e){this._renderPassNames[e]=void 0;for(var t=0;t<this.scenes.length;++t)for(var n=this.scenes[t],i=0;i<n.meshes.length;++i){var r=n.meshes[i];if(r.subMeshes)for(var a=0;a<r.subMeshes.length;++a){r.subMeshes[a]._removeDrawWrapper(e)}}}},{key:"_rescaleTexture",value:function(e,t,i,r,a){var o=this;this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.LINEAR),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl.LINEAR),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE);var s=this.createRenderTargetTexture({width:t.width,height:t.height},{generateMipMaps:!1,type:0,samplingMode:2,generateDepthBuffer:!1,generateStencilBuffer:!1});!this._rescalePostProcess&&n._RescalePostProcessFactory&&(this._rescalePostProcess=n._RescalePostProcessFactory(this)),this._rescalePostProcess.externalTextureSamplerBinding=!0,this._rescalePostProcess.getEffect().executeWhenCompiled((function(){o._rescalePostProcess.onApply=function(t){t._bindTexture("textureSampler",e)};var n=i;n||(n=o.scenes[o.scenes.length-1]),n.postProcessManager.directRender([o._rescalePostProcess],s,!0),o._bindTextureDirectly(o._gl.TEXTURE_2D,t,!0),o._gl.copyTexImage2D(o._gl.TEXTURE_2D,0,r,0,0,t.width,t.height,0),o.unBindFramebuffer(s),s.dispose(),a&&a()}))}},{key:"getFps",value:function(){return this._fps}},{key:"getDeltaTime",value:function(){return this._deltaTime}},{key:"_measureFps",value:function(){this._performanceMonitor.sampleFrame(),this._fps=this._performanceMonitor.averageFPS,this._deltaTime=this._performanceMonitor.instantaneousFrameTime||0}},{key:"wrapWebGLTexture",value:function(e){var t=new b.B(e,this._gl),n=new h.l(this,h.S.Unknown,!0);return n._hardwareTexture=t,n.isReady=!0,n}},{key:"_uploadImageToTexture",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=this._gl,a=this._getWebGLTextureType(e.type),o=this._getInternalFormat(e.format),s=this._getRGBABufferInternalSizedFormat(e.type,o),u=e.isCube?r.TEXTURE_CUBE_MAP:r.TEXTURE_2D;this._bindTextureDirectly(u,e,!0),this._unpackFlipY(e.invertY);var l=r.TEXTURE_2D;e.isCube&&(l=r.TEXTURE_CUBE_MAP_POSITIVE_X+n),r.texImage2D(l,i,s,o,a,t),this._bindTextureDirectly(u,null,!0)}},{key:"updateTextureComparisonFunction",value:function(e,t){if(1!==this.webGLVersion){var n=this._gl;e.isCube?(this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP,e,!0),0===t?(n.texParameteri(n.TEXTURE_CUBE_MAP,n.TEXTURE_COMPARE_FUNC,515),n.texParameteri(n.TEXTURE_CUBE_MAP,n.TEXTURE_COMPARE_MODE,n.NONE)):(n.texParameteri(n.TEXTURE_CUBE_MAP,n.TEXTURE_COMPARE_FUNC,t),n.texParameteri(n.TEXTURE_CUBE_MAP,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE)),this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP,null)):(this._bindTextureDirectly(this._gl.TEXTURE_2D,e,!0),0===t?(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_COMPARE_FUNC,515),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_COMPARE_MODE,n.NONE)):(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_COMPARE_FUNC,t),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE)),this._bindTextureDirectly(this._gl.TEXTURE_2D,null)),e._comparisonFunction=t}else A.Y.Error("WebGL 1 does not support texture comparison.")}},{key:"createInstancesBuffer",value:function(e){var t=this._gl.createBuffer();if(!t)throw new Error("Unable to create instance buffer");var n=new E.M(t);return n.capacity=e,this.bindArrayBuffer(n),this._gl.bufferData(this._gl.ARRAY_BUFFER,e,this._gl.DYNAMIC_DRAW),n.references=1,n}},{key:"deleteInstancesBuffer",value:function(e){this._gl.deleteBuffer(e)}},{key:"_clientWaitAsync",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,i=this._gl;return new Promise((function(r,a){!function o(){var s=i.clientWaitSync(e,t,0);s!=i.WAIT_FAILED?s!=i.TIMEOUT_EXPIRED?r():setTimeout(o,n):a()}()}))}},{key:"_readPixelsAsync",value:function(e,t,n,i,r,a,o){if(this._webGLVersion<2)throw new Error("_readPixelsAsync only work on WebGL2+");var s=this._gl,u=s.createBuffer();s.bindBuffer(s.PIXEL_PACK_BUFFER,u),s.bufferData(s.PIXEL_PACK_BUFFER,o.byteLength,s.STREAM_READ),s.readPixels(e,t,n,i,r,a,0),s.bindBuffer(s.PIXEL_PACK_BUFFER,null);var l=s.fenceSync(s.SYNC_GPU_COMMANDS_COMPLETE,0);return l?(s.flush(),this._clientWaitAsync(l,0,10).then((function(){return s.deleteSync(l),s.bindBuffer(s.PIXEL_PACK_BUFFER,u),s.getBufferSubData(s.PIXEL_PACK_BUFFER,0,o),s.bindBuffer(s.PIXEL_PACK_BUFFER,null),s.deleteBuffer(u),o}))):null}},{key:"dispose",value:function(){for(this.hideLoadingUI(),this.onNewSceneAddedObservable.clear();this.postProcesses.length;)this.postProcesses[0].dispose();for(this._rescalePostProcess&&this._rescalePostProcess.dispose();this.scenes.length;)this.scenes[0].dispose();for(;this._virtualScenes.length;)this._virtualScenes[0].dispose();1===n.Instances.length&&n.audioEngine&&(n.audioEngine.dispose(),n.audioEngine=null),this.disableVR(),(0,f.CG)()&&(window.removeEventListener("blur",this._onBlur),window.removeEventListener("focus",this._onFocus),this._renderingCanvas&&(this._renderingCanvas.removeEventListener("focus",this._onCanvasFocus),this._renderingCanvas.removeEventListener("blur",this._onCanvasBlur),this._renderingCanvas.removeEventListener("pointerout",this._onCanvasPointerOut),this._renderingCanvas.removeEventListener("contextmenu",this._onCanvasContextMenu)),(0,f.n5)()&&(document.removeEventListener("fullscreenchange",this._onFullscreenChange),document.removeEventListener("mozfullscreenchange",this._onFullscreenChange),document.removeEventListener("webkitfullscreenchange",this._onFullscreenChange),document.removeEventListener("msfullscreenchange",this._onFullscreenChange),document.removeEventListener("pointerlockchange",this._onPointerLockChange),document.removeEventListener("mspointerlockchange",this._onPointerLockChange),document.removeEventListener("mozpointerlockchange",this._onPointerLockChange),document.removeEventListener("webkitpointerlockchange",this._onPointerLockChange))),(0,o.Z)((0,l.Z)(n.prototype),"dispose",this).call(this);var e=n.Instances.indexOf(this);e>=0&&n.Instances.splice(e,1),this.onResizeObservable.clear(),this.onCanvasBlurObservable.clear(),this.onCanvasFocusObservable.clear(),this.onCanvasPointerOutObservable.clear(),this.onBeginFrameObservable.clear(),this.onEndFrameObservable.clear()}},{key:"_disableTouchAction",value:function(){this._renderingCanvas&&this._renderingCanvas.setAttribute&&(this._renderingCanvas.setAttribute("touch-action","none"),this._renderingCanvas.style.touchAction="none",this._renderingCanvas.style.msTouchAction="none",this._renderingCanvas.style.webkitTapHighlightColor="transparent")}},{key:"displayLoadingUI",value:function(){if((0,f.CG)()){var e=this.loadingScreen;e&&e.displayLoadingUI()}}},{key:"hideLoadingUI",value:function(){if((0,f.CG)()){var e=this._loadingScreen;e&&e.hideLoadingUI()}}},{key:"loadingScreen",get:function(){return!this._loadingScreen&&this._renderingCanvas&&(this._loadingScreen=n.DefaultLoadingScreenFactory(this._renderingCanvas)),this._loadingScreen},set:function(e){this._loadingScreen=e}},{key:"loadingUIText",set:function(e){this.loadingScreen.loadingUIText=e}},{key:"loadingUIBackgroundColor",set:function(e){this.loadingScreen.loadingUIBackgroundColor=e}},{key:"createVideoElement",value:function(e){return document.createElement("video")}},{key:"getFontOffset",value:function(e){var t=document.createElement("span");t.innerHTML="Hg",t.setAttribute("style","font: ".concat(e," !important"));var n=document.createElement("div");n.style.display="inline-block",n.style.width="1px",n.style.height="0px",n.style.verticalAlign="bottom";var i=document.createElement("div");i.style.whiteSpace="nowrap",i.appendChild(t),i.appendChild(n),document.body.appendChild(i);var r=0,a=0;try{a=n.getBoundingClientRect().top-t.getBoundingClientRect().top,n.style.verticalAlign="baseline",r=n.getBoundingClientRect().top-t.getBoundingClientRect().top}finally{document.body.removeChild(i)}return{ascent:r,height:a,descent:a-r}}}],[{key:"NpmPackage",get:function(){return v.B.NpmPackage}},{key:"Version",get:function(){return v.B.Version}},{key:"Instances",get:function(){return d.l.Instances}},{key:"LastCreatedEngine",get:function(){return d.l.LastCreatedEngine}},{key:"LastCreatedScene",get:function(){return d.l.LastCreatedScene}},{key:"MarkAllMaterialsAsDirty",value:function(e,t){for(var i=0;i<n.Instances.length;i++)for(var r=n.Instances[i],a=0;a<r.scenes.length;a++)r.scenes[a].markAllMaterialsAsDirty(e,t)}},{key:"DefaultLoadingScreenFactory",value:function(e){throw(0,p.S)("LoadingScreen")}},{key:"_RequestPointerlock",value:function(e){e.requestPointerLock=e.requestPointerLock||e.msRequestPointerLock||e.mozRequestPointerLock||e.webkitRequestPointerLock,e.requestPointerLock&&(e.requestPointerLock(),e.focus())}},{key:"_ExitPointerlock",value:function(){var e=document;document.exitPointerLock=document.exitPointerLock||e.msExitPointerLock||e.mozExitPointerLock||e.webkitExitPointerLock,document.exitPointerLock&&document.exitPointerLock()}},{key:"_RequestFullscreen",value:function(e){var t=e.requestFullscreen||e.msRequestFullscreen||e.webkitRequestFullscreen||e.mozRequestFullScreen;t&&t.call(e)}},{key:"_ExitFullscreen",value:function(){var e=document;document.exitFullscreen?document.exitFullscreen():e.mozCancelFullScreen?e.mozCancelFullScreen():e.webkitCancelFullScreen?e.webkitCancelFullScreen():e.msCancelFullScreen&&e.msCancelFullScreen()}}]),n}(v.B);x.ALPHA_DISABLE=0,x.ALPHA_ADD=1,x.ALPHA_COMBINE=2,x.ALPHA_SUBTRACT=3,x.ALPHA_MULTIPLY=4,x.ALPHA_MAXIMIZED=5,x.ALPHA_ONEONE=6,x.ALPHA_PREMULTIPLIED=7,x.ALPHA_PREMULTIPLIED_PORTERDUFF=8,x.ALPHA_INTERPOLATE=9,x.ALPHA_SCREENMODE=10,x.DELAYLOADSTATE_NONE=0,x.DELAYLOADSTATE_LOADED=1,x.DELAYLOADSTATE_LOADING=2,x.DELAYLOADSTATE_NOTLOADED=4,x.NEVER=512,x.ALWAYS=519,x.LESS=513,x.EQUAL=514,x.LEQUAL=515,x.GREATER=516,x.GEQUAL=518,x.NOTEQUAL=517,x.KEEP=7680,x.REPLACE=7681,x.INCR=7682,x.DECR=7683,x.INVERT=5386,x.INCR_WRAP=34055,x.DECR_WRAP=34056,x.TEXTURE_CLAMP_ADDRESSMODE=0,x.TEXTURE_WRAP_ADDRESSMODE=1,x.TEXTURE_MIRROR_ADDRESSMODE=2,x.TEXTUREFORMAT_ALPHA=0,x.TEXTUREFORMAT_LUMINANCE=1,x.TEXTUREFORMAT_LUMINANCE_ALPHA=2,x.TEXTUREFORMAT_RGB=4,x.TEXTUREFORMAT_RGBA=5,x.TEXTUREFORMAT_RED=6,x.TEXTUREFORMAT_R=6,x.TEXTUREFORMAT_RG=7,x.TEXTUREFORMAT_RED_INTEGER=8,x.TEXTUREFORMAT_R_INTEGER=8,x.TEXTUREFORMAT_RG_INTEGER=9,x.TEXTUREFORMAT_RGB_INTEGER=10,x.TEXTUREFORMAT_RGBA_INTEGER=11,x.TEXTURETYPE_UNSIGNED_BYTE=0,x.TEXTURETYPE_UNSIGNED_INT=0,x.TEXTURETYPE_FLOAT=1,x.TEXTURETYPE_HALF_FLOAT=2,x.TEXTURETYPE_BYTE=3,x.TEXTURETYPE_SHORT=4,x.TEXTURETYPE_UNSIGNED_SHORT=5,x.TEXTURETYPE_INT=6,x.TEXTURETYPE_UNSIGNED_INTEGER=7,x.TEXTURETYPE_UNSIGNED_SHORT_4_4_4_4=8,x.TEXTURETYPE_UNSIGNED_SHORT_5_5_5_1=9,x.TEXTURETYPE_UNSIGNED_SHORT_5_6_5=10,x.TEXTURETYPE_UNSIGNED_INT_2_10_10_10_REV=11,x.TEXTURETYPE_UNSIGNED_INT_24_8=12,x.TEXTURETYPE_UNSIGNED_INT_10F_11F_11F_REV=13,x.TEXTURETYPE_UNSIGNED_INT_5_9_9_9_REV=14,x.TEXTURETYPE_FLOAT_32_UNSIGNED_INT_24_8_REV=15,x.TEXTURE_NEAREST_SAMPLINGMODE=1,x.TEXTURE_BILINEAR_SAMPLINGMODE=2,x.TEXTURE_TRILINEAR_SAMPLINGMODE=3,x.TEXTURE_NEAREST_NEAREST_MIPLINEAR=8,x.TEXTURE_LINEAR_LINEAR_MIPNEAREST=11,x.TEXTURE_LINEAR_LINEAR_MIPLINEAR=3,x.TEXTURE_NEAREST_NEAREST_MIPNEAREST=4,x.TEXTURE_NEAREST_LINEAR_MIPNEAREST=5,x.TEXTURE_NEAREST_LINEAR_MIPLINEAR=6,x.TEXTURE_NEAREST_LINEAR=7,x.TEXTURE_NEAREST_NEAREST=1,x.TEXTURE_LINEAR_NEAREST_MIPNEAREST=9,x.TEXTURE_LINEAR_NEAREST_MIPLINEAR=10,x.TEXTURE_LINEAR_LINEAR=2,x.TEXTURE_LINEAR_NEAREST=12,x.TEXTURE_EXPLICIT_MODE=0,x.TEXTURE_SPHERICAL_MODE=1,x.TEXTURE_PLANAR_MODE=2,x.TEXTURE_CUBIC_MODE=3,x.TEXTURE_PROJECTION_MODE=4,x.TEXTURE_SKYBOX_MODE=5,x.TEXTURE_INVCUBIC_MODE=6,x.TEXTURE_EQUIRECTANGULAR_MODE=7,x.TEXTURE_FIXED_EQUIRECTANGULAR_MODE=8,x.TEXTURE_FIXED_EQUIRECTANGULAR_MIRRORED_MODE=9,x.SCALEMODE_FLOOR=1,x.SCALEMODE_NEAREST=2,x.SCALEMODE_CEILING=3,x._RescalePostProcessFactory=null,x._RenderPassIdCounter=0},4198:function(e,t,n){"use strict";n.d(t,{l:function(){return a}});var i=n(5671),r=n(3144),a=function(){function e(){(0,i.Z)(this,e)}return(0,r.Z)(e,null,[{key:"LastCreatedEngine",get:function(){return 0===this.Instances.length?null:this.Instances[this.Instances.length-1]}},{key:"LastCreatedScene",get:function(){return this._LastCreatedScene}}]),e}();a.Instances=new Array,a._LastCreatedScene=null,a.UseFallbackTexture=!0,a.FallbackTexture=""},6196:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var i=n(5671),r=n(3144),a=function(){function e(){(0,i.Z)(this,e)}return(0,r.Z)(e,null,[{key:"SetMatrixPrecision",value:function(t){if(e.MatrixTrackPrecisionChange=!1,t&&!e.MatrixUse64Bits&&e.MatrixTrackedMatrices)for(var n=0;n<e.MatrixTrackedMatrices.length;++n){var i=e.MatrixTrackedMatrices[n],r=i._m;i._m=new Array(16);for(var a=0;a<16;++a)i._m[a]=r[a]}e.MatrixUse64Bits=t,e.MatrixCurrentType=e.MatrixUse64Bits?Array:Float32Array,e.MatrixTrackedMatrices=null}}]),e}();a.MatrixUse64Bits=!1,a.MatrixTrackPrecisionChange=!0,a.MatrixCurrentType=Float32Array,a.MatrixTrackedMatrices=[]},8084:function(e,t,n){"use strict";n.d(t,{v:function(){return o}});var i=n(5671),r=n(3144),a=n(2223),o=function(){function e(){(0,i.Z)(this,e)}return(0,r.Z)(e,null,[{key:"GetShadersRepository",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a.x.GLSL;return t===a.x.GLSL?e.ShadersRepository:e.ShadersRepositoryWGSL}},{key:"GetShadersStore",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a.x.GLSL;return t===a.x.GLSL?e.ShadersStore:e.ShadersStoreWGSL}},{key:"GetIncludesShadersStore",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a.x.GLSL;return t===a.x.GLSL?e.IncludesShadersStore:e.IncludesShadersStoreWGSL}}]),e}();o.ShadersRepository="src/Shaders/",o.ShadersStore={},o.IncludesShadersStore={},o.ShadersRepositoryWGSL="src/ShadersWGSL/",o.ShadersStoreWGSL={},o.IncludesShadersStoreWGSL={}},1187:function(e,t,n){"use strict";n.d(t,{G:function(){return o}});var i,r=n(3144),a=n(5671);!function(e){e[e.PointerMove=0]="PointerMove",e[e.PointerDown=1]="PointerDown",e[e.PointerUp=2]="PointerUp"}(i||(i={}));var o=(0,r.Z)((function e(){(0,a.Z)(this,e)}));o.DOM_DELTA_PIXEL=0,o.DOM_DELTA_LINE=1,o.DOM_DELTA_PAGE=2},3531:function(e,t,n){"use strict";n.d(t,{NG:function(){return c},OG:function(){return l},WZ:function(){return h}});var i=n(136),r=n(6215),a=n(1120),o=n(3144),s=n(5671);function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,a.Z)(e);if(t){var o=(0,a.Z)(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return(0,r.Z)(this,n)}}var l=(0,o.Z)((function e(){(0,s.Z)(this,e)}));l.KEYDOWN=1,l.KEYUP=2;var c=(0,o.Z)((function e(t,n){(0,s.Z)(this,e),this.type=t,this.event=n})),h=function(e){(0,i.Z)(n,e);var t=u(n);function n(e,i){var r;return(0,s.Z)(this,n),(r=t.call(this,e,i)).type=e,r.event=i,r.skipOnKeyboardObservable=!1,r}return(0,o.Z)(n,[{key:"skipOnPointerObservable",get:function(){return this.skipOnKeyboardObservable},set:function(e){this.skipOnKeyboardObservable=e}}]),n}(c)},3365:function(e,t,n){"use strict";n.d(t,{FV:function(){return f},R5:function(){return d},kD:function(){return c}});var i=n(136),r=n(6215),a=n(1120),o=n(3144),s=n(5671),u=n(6900);function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,a.Z)(e);if(t){var o=(0,a.Z)(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return(0,r.Z)(this,n)}}var c=(0,o.Z)((function e(){(0,s.Z)(this,e)}));c.POINTERDOWN=1,c.POINTERUP=2,c.POINTERMOVE=4,c.POINTERWHEEL=8,c.POINTERPICK=16,c.POINTERTAP=32,c.POINTERDOUBLETAP=64;var h=(0,o.Z)((function e(t,n){(0,s.Z)(this,e),this.type=t,this.event=n})),f=function(e){(0,i.Z)(n,e);var t=l(n);function n(e,i,r,a){var o;return(0,s.Z)(this,n),(o=t.call(this,e,i)).ray=null,o.originalPickingInfo=null,o.skipOnPointerObservable=!1,o.localPosition=new u.FM(r,a),o}return(0,o.Z)(n)}(h),d=function(e){(0,i.Z)(n,e);var t=l(n);function n(e,i,r){var a;return(0,s.Z)(this,n),(a=t.call(this,e,i)).pickInfo=r,a}return(0,o.Z)(n)}(h)},8983:function(e,t,n){"use strict";n.d(t,{$:function(){return U}});var i=n(5671),r=n(3144),a=n(3365),o=function(){function e(){(0,i.Z)(this,e),this.hoverCursor="",this.actions=new Array,this.isRecursive=!1}return(0,r.Z)(e,null,[{key:"HasTriggers",get:function(){for(var t in e.Triggers)if(Object.prototype.hasOwnProperty.call(e.Triggers,t))return!0;return!1}},{key:"HasPickTriggers",get:function(){for(var t in e.Triggers)if(Object.prototype.hasOwnProperty.call(e.Triggers,t)){var n=parseInt(t);if(n>=1&&n<=7)return!0}return!1}},{key:"HasSpecificTrigger",value:function(t){for(var n in e.Triggers){if(Object.prototype.hasOwnProperty.call(e.Triggers,n))if(parseInt(n)===t)return!0}return!1}}]),e}();o.Triggers={};var s,u,l,c,h,f,d,p=n(3541),v=n(6900),m=n(8483),g=n(3531);!function(e){e[e.Generic=0]="Generic",e[e.Keyboard=1]="Keyboard",e[e.Mouse=2]="Mouse",e[e.Touch=3]="Touch",e[e.DualShock=4]="DualShock",e[e.Xbox=5]="Xbox",e[e.Switch=6]="Switch",e[e.DualSense=7]="DualSense"}(s||(s={})),function(e){e[e.Horizontal=0]="Horizontal",e[e.Vertical=1]="Vertical",e[e.LeftClick=2]="LeftClick",e[e.MiddleClick=3]="MiddleClick",e[e.RightClick=4]="RightClick",e[e.BrowserBack=5]="BrowserBack",e[e.BrowserForward=6]="BrowserForward",e[e.MouseWheelX=7]="MouseWheelX",e[e.MouseWheelY=8]="MouseWheelY",e[e.MouseWheelZ=9]="MouseWheelZ",e[e.Move=12]="Move"}(u||(u={})),function(e){e[e.Horizontal=0]="Horizontal",e[e.Vertical=1]="Vertical",e[e.LeftClick=2]="LeftClick",e[e.MiddleClick=3]="MiddleClick",e[e.RightClick=4]="RightClick",e[e.BrowserBack=5]="BrowserBack",e[e.BrowserForward=6]="BrowserForward",e[e.MouseWheelX=7]="MouseWheelX",e[e.MouseWheelY=8]="MouseWheelY",e[e.MouseWheelZ=9]="MouseWheelZ",e[e.DeltaHorizontal=10]="DeltaHorizontal",e[e.DeltaVertical=11]="DeltaVertical"}(l||(l={})),function(e){e[e.Cross=0]="Cross",e[e.Circle=1]="Circle",e[e.Square=2]="Square",e[e.Triangle=3]="Triangle",e[e.L1=4]="L1",e[e.R1=5]="R1",e[e.L2=6]="L2",e[e.R2=7]="R2",e[e.Share=8]="Share",e[e.Options=9]="Options",e[e.L3=10]="L3",e[e.R3=11]="R3",e[e.DPadUp=12]="DPadUp",e[e.DPadDown=13]="DPadDown",e[e.DPadLeft=14]="DPadLeft",e[e.DPadRight=15]="DPadRight",e[e.Home=16]="Home",e[e.TouchPad=17]="TouchPad",e[e.LStickXAxis=18]="LStickXAxis",e[e.LStickYAxis=19]="LStickYAxis",e[e.RStickXAxis=20]="RStickXAxis",e[e.RStickYAxis=21]="RStickYAxis"}(c||(c={})),function(e){e[e.Cross=0]="Cross",e[e.Circle=1]="Circle",e[e.Square=2]="Square",e[e.Triangle=3]="Triangle",e[e.L1=4]="L1",e[e.R1=5]="R1",e[e.L2=6]="L2",e[e.R2=7]="R2",e[e.Create=8]="Create",e[e.Options=9]="Options",e[e.L3=10]="L3",e[e.R3=11]="R3",e[e.DPadUp=12]="DPadUp",e[e.DPadDown=13]="DPadDown",e[e.DPadLeft=14]="DPadLeft",e[e.DPadRight=15]="DPadRight",e[e.Home=16]="Home",e[e.TouchPad=17]="TouchPad",e[e.LStickXAxis=18]="LStickXAxis",e[e.LStickYAxis=19]="LStickYAxis",e[e.RStickXAxis=20]="RStickXAxis",e[e.RStickYAxis=21]="RStickYAxis"}(h||(h={})),function(e){e[e.A=0]="A",e[e.B=1]="B",e[e.X=2]="X",e[e.Y=3]="Y",e[e.LB=4]="LB",e[e.RB=5]="RB",e[e.LT=6]="LT",e[e.RT=7]="RT",e[e.Back=8]="Back",e[e.Start=9]="Start",e[e.LS=10]="LS",e[e.RS=11]="RS",e[e.DPadUp=12]="DPadUp",e[e.DPadDown=13]="DPadDown",e[e.DPadLeft=14]="DPadLeft",e[e.DPadRight=15]="DPadRight",e[e.Home=16]="Home",e[e.LStickXAxis=17]="LStickXAxis",e[e.LStickYAxis=18]="LStickYAxis",e[e.RStickXAxis=19]="RStickXAxis",e[e.RStickYAxis=20]="RStickYAxis"}(f||(f={})),function(e){e[e.B=0]="B",e[e.A=1]="A",e[e.Y=2]="Y",e[e.X=3]="X",e[e.L=4]="L",e[e.R=5]="R",e[e.ZL=6]="ZL",e[e.ZR=7]="ZR",e[e.Minus=8]="Minus",e[e.Plus=9]="Plus",e[e.LS=10]="LS",e[e.RS=11]="RS",e[e.DPadUp=12]="DPadUp",e[e.DPadDown=13]="DPadDown",e[e.DPadLeft=14]="DPadLeft",e[e.DPadRight=15]="DPadRight",e[e.Home=16]="Home",e[e.Capture=17]="Capture",e[e.LStickXAxis=18]="LStickXAxis",e[e.LStickYAxis=19]="LStickYAxis",e[e.RStickXAxis=20]="RStickXAxis",e[e.RStickYAxis=21]="RStickYAxis"}(d||(d={}));var _=n(4174),y=n(1187),E=function(){function e(){(0,i.Z)(this,e)}return(0,r.Z)(e,null,[{key:"CreateDeviceEvent",value:function(e,t,n,i,r,a){switch(e){case s.Keyboard:return this._CreateKeyboardEvent(n,i,r,a);case s.Mouse:if(n===u.MouseWheelX||n===u.MouseWheelY||n===u.MouseWheelZ)return this._CreateWheelEvent(e,t,n,i,r,a);case s.Touch:return this._CreatePointerEvent(e,t,n,i,r,a);default:throw"Unable to generate event for device ".concat(s[e])}}},{key:"_CreatePointerEvent",value:function(e,t,n,i,r,a){var o=this._CreateMouseEvent(e,t,n,i,r,a);return e===s.Mouse?(o.deviceType=s.Mouse,o.pointerId=1,o.pointerType="mouse"):(o.deviceType=s.Touch,o.pointerId=t,o.pointerType="touch"),n===u.Move?o.type="pointermove":n>=u.LeftClick&&n<=u.RightClick&&(o.type=1===i?"pointerdown":"pointerup",o.button=n-2),o}},{key:"_CreateWheelEvent",value:function(e,t,n,i,r,a){var o=this._CreateMouseEvent(e,t,n,i,r,a);switch(o.type="wheel",o.deltaMode=y.G.DOM_DELTA_PIXEL,o.deltaX=0,o.deltaY=0,o.deltaZ=0,n){case u.MouseWheelX:o.deltaX=i;break;case u.MouseWheelY:o.deltaY=i;break;case u.MouseWheelZ:o.deltaZ=i}return o}},{key:"_CreateMouseEvent",value:function(e,t,n,i,r,a){var o=this._CreateEvent(a),s=r.pollInput(e,t,u.Horizontal),c=r.pollInput(e,t,u.Vertical);return a?(o.movementX=0,o.movementY=0,o.offsetX=o.movementX-a.getBoundingClientRect().x,o.offsetY=o.movementY-a.getBoundingClientRect().y):(o.movementX=r.pollInput(e,t,l.DeltaHorizontal),o.movementY=r.pollInput(e,t,l.DeltaVertical),o.offsetX=0,o.offsetY=0),this._CheckNonCharacterKeys(o,r),o.clientX=s,o.clientY=c,o.x=s,o.y=c,o.deviceType=e,o.deviceSlot=t,o.inputIndex=n,o}},{key:"_CreateKeyboardEvent",value:function(e,t,n,i){var r=this._CreateEvent(i);return this._CheckNonCharacterKeys(r,n),r.deviceType=s.Keyboard,r.deviceSlot=0,r.inputIndex=e,r.type=1===t?"keydown":"keyup",r.key=String.fromCharCode(e),r.keyCode=e,r}},{key:"_CheckNonCharacterKeys",value:function(e,t){var n=t.isDeviceAvailable(s.Keyboard),i=n&&1===t.pollInput(s.Keyboard,0,18),r=n&&1===t.pollInput(s.Keyboard,0,17),a=n&&(1===t.pollInput(s.Keyboard,0,91)||1===t.pollInput(s.Keyboard,0,92)||1===t.pollInput(s.Keyboard,0,93)),o=n&&1===t.pollInput(s.Keyboard,0,16);e.altKey=i,e.ctrlKey=r,e.metaKey=a,e.shiftKey=o}},{key:"_CreateEvent",value:function(e){var t={preventDefault:function(){}};return t.target=e,t}}]),e}(),A=function(){function e(t,n,r){var a=this;(0,i.Z)(this,e),this._nativeInput=_native.DeviceInputSystem?new _native.DeviceInputSystem(t,n,(function(e,t,n,i){var o=E.CreateDeviceEvent(e,t,n,i,a);r(e,t,o)})):this._createDummyNativeInput()}return(0,r.Z)(e,[{key:"pollInput",value:function(e,t,n){return this._nativeInput.pollInput(e,t,n)}},{key:"isDeviceAvailable",value:function(e){return e===s.Mouse||e===s.Touch}},{key:"dispose",value:function(){this._nativeInput.dispose()}},{key:"_createDummyNativeInput",value:function(){return{pollInput:function(){return 0},isDeviceAvailable:function(){return!1},dispose:function(){}}}}]),e}(),b=n(5092),T=n(8517);function M(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return S(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return S(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var I=Object.keys(u).length/2,x=function(){function e(t,n,r,a){var o=this;(0,i.Z)(this,e),this._inputs=[],this._keyboardActive=!1,this._pointerActive=!1,this._usingSafari=T.w1.IsSafari(),this._usingMacOS=/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform),this._keyboardDownEvent=function(e){},this._keyboardUpEvent=function(e){},this._keyboardBlurEvent=function(e){},this._pointerMoveEvent=function(e){},this._pointerDownEvent=function(e){},this._pointerUpEvent=function(e){},this._pointerCancelEvent=function(e){},this._pointerWheelEvent=function(e){},this._pointerBlurEvent=function(e){},this._eventsAttached=!1,this._mouseId=-1,this._isUsingFirefox=b.MZ.IsNavigatorAvailable()&&navigator.userAgent&&-1!==navigator.userAgent.indexOf("Firefox"),this._maxTouchPoints=0,this._pointerInputClearObserver=null,this._gamepadConnectedEvent=function(e){},this._gamepadDisconnectedEvent=function(e){},this._eventPrefix=T.w1.GetPointerPrefix(t),this._engine=t,this._onDeviceConnected=n,this._onDeviceDisconnected=r,this._onInputChanged=a,this._enableEvents(),this._usingMacOS&&(this._metaKeys=[]),this._engine._onEngineViewChanged||(this._engine._onEngineViewChanged=function(){o._enableEvents()})}return(0,r.Z)(e,[{key:"pollInput",value:function(e,t,n){var i=this._inputs[e][t];if(!i)throw"Unable to find device ".concat(s[e]);e>=s.DualShock&&e<=s.DualSense&&this._updateDevice(e,t,n);var r=i[n];if(void 0===r)throw"Unable to find input ".concat(n," for device ").concat(s[e]," in slot ").concat(t);return n===u.Move&&T.w1.Warn("Unable to provide information for PointerInput.Move.  Try using PointerInput.Horizontal or PointerInput.Vertical for move data."),r}},{key:"isDeviceAvailable",value:function(e){return void 0!==this._inputs[e]}},{key:"dispose",value:function(){this._onDeviceConnected=function(){},this._onDeviceDisconnected=function(){},this._onInputChanged=function(){},delete this._engine._onEngineViewChanged,this._elementToAttachTo&&this._disableEvents()}},{key:"_enableEvents",value:function(){var e=null==this?void 0:this._engine.getInputElement();if(e&&(!this._eventsAttached||this._elementToAttachTo!==e)){if(this._disableEvents(),this._inputs){var t,n=M(this._inputs);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(i)for(var r in i){var a=i[+r];if(a)for(var o=0;o<a.length;o++)a[o]=0}}}catch(s){n.e(s)}finally{n.f()}}this._elementToAttachTo=e,this._elementToAttachTo.tabIndex=-1!==this._elementToAttachTo.tabIndex?this._elementToAttachTo.tabIndex:this._engine.canvasTabIndex,this._handleKeyActions(),this._handlePointerActions(),this._handleGamepadActions(),this._eventsAttached=!0,this._checkForConnectedDevices()}}},{key:"_disableEvents",value:function(){this._elementToAttachTo&&(this._elementToAttachTo.removeEventListener("blur",this._keyboardBlurEvent),this._elementToAttachTo.removeEventListener("blur",this._pointerBlurEvent),this._elementToAttachTo.removeEventListener("keydown",this._keyboardDownEvent),this._elementToAttachTo.removeEventListener("keyup",this._keyboardUpEvent),this._elementToAttachTo.removeEventListener(this._eventPrefix+"move",this._pointerMoveEvent),this._elementToAttachTo.removeEventListener(this._eventPrefix+"down",this._pointerDownEvent),this._elementToAttachTo.removeEventListener(this._eventPrefix+"up",this._pointerUpEvent),this._elementToAttachTo.removeEventListener(this._eventPrefix+"cancel",this._pointerCancelEvent),this._elementToAttachTo.removeEventListener(this._wheelEventName,this._pointerWheelEvent),window.removeEventListener("gamepadconnected",this._gamepadConnectedEvent),window.removeEventListener("gamepaddisconnected",this._gamepadDisconnectedEvent)),this._pointerInputClearObserver&&this._engine.onEndFrameObservable.remove(this._pointerInputClearObserver),this._eventsAttached=!1}},{key:"_checkForConnectedDevices",value:function(){if(navigator.getGamepads){var e,t=M(navigator.getGamepads());try{for(t.s();!(e=t.n()).done;){var n=e.value;n&&this._addGamePad(n)}}catch(i){t.e(i)}finally{t.f()}}"function"==typeof matchMedia&&matchMedia("(pointer:fine)").matches&&this._addPointerDevice(s.Mouse,0,0,0)}},{key:"_addGamePad",value:function(e){var t=this._getGamepadDeviceType(e.id),n=e.index;this._gamepads=this._gamepads||new Array(e.index+1),this._registerDevice(t,n,e.buttons.length+e.axes.length),this._gamepads[n]=t}},{key:"_addPointerDevice",value:function(e,t,n,i){this._pointerActive||(this._pointerActive=!0),this._registerDevice(e,t,I);var r=this._inputs[e][t];r[0]=n,r[1]=i}},{key:"_registerDevice",value:function(e,t,n){if(void 0===t)throw"Unable to register device ".concat(s[e]," to undefined slot.");if(this._inputs[e]||(this._inputs[e]={}),!this._inputs[e][t]){var i=new Array(n);i.fill(0),this._inputs[e][t]=i,this._onDeviceConnected(e,t)}}},{key:"_unregisterDevice",value:function(e,t){this._inputs[e][t]&&(delete this._inputs[e][t],this._onDeviceDisconnected(e,t))}},{key:"_handleKeyActions",value:function(){var e=this;this._keyboardDownEvent=function(t){e._keyboardActive||(e._keyboardActive=!0,e._registerDevice(s.Keyboard,0,255));var n=e._inputs[s.Keyboard][0];if(n){n[t.keyCode]=1;var i=t;i.inputIndex=t.keyCode,e._usingMacOS&&t.metaKey&&"Meta"!==t.key&&(e._metaKeys.includes(t.keyCode)||e._metaKeys.push(t.keyCode)),e._onInputChanged(s.Keyboard,0,i)}},this._keyboardUpEvent=function(t){e._keyboardActive||(e._keyboardActive=!0,e._registerDevice(s.Keyboard,0,255));var n=e._inputs[s.Keyboard][0];if(n){n[t.keyCode]=0;var i=t;if(i.inputIndex=t.keyCode,e._usingMacOS&&"Meta"===t.key&&e._metaKeys.length>0){var r,a=M(e._metaKeys);try{for(a.s();!(r=a.n()).done;){var o=r.value,u=E.CreateDeviceEvent(s.Keyboard,0,o,0,e,e._elementToAttachTo);n[o]=0,e._onInputChanged(s.Keyboard,0,u)}}catch(l){a.e(l)}finally{a.f()}e._metaKeys.splice(0,e._metaKeys.length)}e._onInputChanged(s.Keyboard,0,i)}},this._keyboardBlurEvent=function(){if(e._keyboardActive){for(var t=e._inputs[s.Keyboard][0],n=0;n<t.length;n++)if(0!==t[n]){t[n]=0;var i=E.CreateDeviceEvent(s.Keyboard,0,n,0,e,e._elementToAttachTo);e._onInputChanged(s.Keyboard,0,i)}e._usingMacOS&&e._metaKeys.splice(0,e._metaKeys.length)}},this._elementToAttachTo.addEventListener("keydown",this._keyboardDownEvent),this._elementToAttachTo.addEventListener("keyup",this._keyboardUpEvent),this._elementToAttachTo.addEventListener("blur",this._keyboardBlurEvent)}},{key:"_handlePointerActions",value:function(){var e=this;this._maxTouchPoints=b.MZ.IsNavigatorAvailable()&&navigator.maxTouchPoints||2,this._activeTouchIds||(this._activeTouchIds=new Array(this._maxTouchPoints));for(var t=0;t<this._maxTouchPoints;t++)this._activeTouchIds[t]=-1;this._pointerMoveEvent=function(t){var n=e._getPointerType(t),i=n===s.Mouse?0:e._activeTouchIds.indexOf(t.pointerId);e._inputs[n]||(e._inputs[n]={}),e._inputs[n][i]||e._addPointerDevice(n,i,t.clientX,t.clientY);var r=e._inputs[n][i];if(r){var a=t;a.inputIndex=u.Move,void 0===t.movementX&&(t.movementX=t.mozMovementX||t.webkitMovementX||t.msMovementX||t.clientX-r[u.Horizontal]),void 0===t.movementY&&(t.movementY=t.mozMovementY||t.webkitMovementY||t.msMovementY||t.clientY-r[u.Vertical]),r[u.Horizontal]=t.clientX,r[u.Vertical]=t.clientY,e._onInputChanged(n,i,a),e._usingSafari||-1===t.button||(a.inputIndex=t.button+2,r[t.button+2]=r[t.button+2]?0:1,e._onInputChanged(n,i,a))}},this._pointerDownEvent=function(t){var n=e._getPointerType(t),i=n===s.Mouse?0:t.pointerId;if(n===s.Touch){var r=e._activeTouchIds.indexOf(-1);if(!(r>=0))return void T.w1.Warn("Max number of touches exceeded.  Ignoring touches in excess of ".concat(e._maxTouchPoints));i=r,e._activeTouchIds[r]=t.pointerId}e._inputs[n]||(e._inputs[n]={}),e._inputs[n][i]?n===s.Touch&&e._onDeviceConnected(n,i):e._addPointerDevice(n,i,t.clientX,t.clientY);var a=e._inputs[n][i];if(a){var o=a[u.Horizontal],l=a[u.Vertical];if(n===s.Mouse){if(-1===e._mouseId&&(void 0===t.pointerId?e._mouseId=e._isUsingFirefox?0:1:e._mouseId=t.pointerId),!document.pointerLockElement)try{e._elementToAttachTo.setPointerCapture(e._mouseId)}catch(h){}}else if(t.pointerId&&!document.pointerLockElement)try{e._elementToAttachTo.setPointerCapture(t.pointerId)}catch(h){}a[u.Horizontal]=t.clientX,a[u.Vertical]=t.clientY,a[t.button+2]=1;var c=t;c.inputIndex=t.button+2,e._onInputChanged(n,i,c),o===t.clientX&&l===t.clientY||(c.inputIndex=u.Move,void 0===t.movementX&&(t.movementX=t.mozMovementX||t.webkitMovementX||t.msMovementX||t.clientX-a[u.Horizontal]),void 0===t.movementY&&(t.movementY=t.mozMovementY||t.webkitMovementY||t.msMovementY||t.clientY-a[u.Vertical]),e._onInputChanged(n,i,c))}},this._pointerUpEvent=function(t){var n,i=e._getPointerType(t),r=i===s.Mouse?0:e._activeTouchIds.indexOf(t.pointerId);if(i===s.Touch){if(-1===r)return;e._activeTouchIds[r]=-1}var a=null===(n=e._inputs[i])||void 0===n?void 0:n[r];if(a&&0!==a[t.button+2]){var o,l,c,h,f=a[u.Horizontal],d=a[u.Vertical];a[u.Horizontal]=t.clientX,a[u.Vertical]=t.clientY,a[t.button+2]=0;var p=t;f===t.clientX&&d===t.clientY||(p.inputIndex=u.Move,void 0===t.movementX&&(t.movementX=t.mozMovementX||t.webkitMovementX||t.msMovementX||t.clientX-a[u.Horizontal]),void 0===t.movementY&&(t.movementY=t.mozMovementY||t.webkitMovementY||t.msMovementY||t.clientY-a[u.Vertical]),e._onInputChanged(i,r,p)),p.inputIndex=t.button+2,i===s.Mouse&&e._mouseId>=0&&null!==(o=(l=e._elementToAttachTo).hasPointerCapture)&&void 0!==o&&o.call(l,e._mouseId)?e._elementToAttachTo.releasePointerCapture(e._mouseId):t.pointerId&&null!==(c=(h=e._elementToAttachTo).hasPointerCapture)&&void 0!==c&&c.call(h,t.pointerId)&&e._elementToAttachTo.releasePointerCapture(t.pointerId),e._onInputChanged(i,r,p),i===s.Touch&&e._onDeviceDisconnected(i,r)}},this._pointerCancelEvent=function(t){if("mouse"===t.pointerType){var n,i,r=e._inputs[s.Mouse][0];e._mouseId>=0&&null!==(n=(i=e._elementToAttachTo).hasPointerCapture)&&void 0!==n&&n.call(i,e._mouseId)&&e._elementToAttachTo.releasePointerCapture(e._mouseId);for(var a=u.LeftClick;a<=u.BrowserForward;a++)if(1===r[a]){r[a]=0;var o=E.CreateDeviceEvent(s.Mouse,0,a,0,e,e._elementToAttachTo);e._onInputChanged(s.Mouse,0,o)}}else{var l,c,h=e._activeTouchIds.indexOf(t.pointerId);null!==(l=(c=e._elementToAttachTo).hasPointerCapture)&&void 0!==l&&l.call(c,t.pointerId)&&e._elementToAttachTo.releasePointerCapture(t.pointerId),e._inputs[s.Touch][h][u.LeftClick]=0;var f=E.CreateDeviceEvent(s.Touch,h,u.LeftClick,0,e,e._elementToAttachTo);e._onInputChanged(s.Touch,h,f),e._activeTouchIds[h]=-1,e._onDeviceDisconnected(s.Touch,h)}},this._wheelEventName="onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll";var n=!1,i=function(){};try{var r=Object.defineProperty({},"passive",{get:function(){n=!0}});this._elementToAttachTo.addEventListener("test",i,r),this._elementToAttachTo.removeEventListener("test",i,r)}catch(a){}this._pointerBlurEvent=function(){if(e.isDeviceAvailable(s.Mouse)){var t,n,i=e._inputs[s.Mouse][0];e._mouseId>=0&&null!==(t=(n=e._elementToAttachTo).hasPointerCapture)&&void 0!==t&&t.call(n,e._mouseId)&&e._elementToAttachTo.releasePointerCapture(e._mouseId);for(var r=u.LeftClick;r<=u.BrowserForward;r++)if(1===i[r]){i[r]=0;var a=E.CreateDeviceEvent(s.Mouse,0,r,0,e,e._elementToAttachTo);e._onInputChanged(s.Mouse,0,a)}}if(e.isDeviceAvailable(s.Touch))for(var o=e._inputs[s.Touch],l=0;l<e._activeTouchIds.length;l++){var c,h,f,d=e._activeTouchIds[l];if(null!==(c=(h=e._elementToAttachTo).hasPointerCapture)&&void 0!==c&&c.call(h,d)&&e._elementToAttachTo.releasePointerCapture(d),-1!==d&&1===(null===(f=o[l])||void 0===f?void 0:f[u.LeftClick])){o[l][u.LeftClick]=0;var p=E.CreateDeviceEvent(s.Touch,l,u.LeftClick,0,e,e._elementToAttachTo);e._onInputChanged(s.Touch,l,p),e._activeTouchIds[l]=-1,e._onDeviceDisconnected(s.Touch,l)}}},this._pointerWheelEvent=function(t){var n=s.Mouse;e._inputs[n]||(e._inputs[n]=[]),e._inputs[n][0]||(e._pointerActive=!0,e._registerDevice(n,0,I));var i=e._inputs[n][0];if(i){i[u.MouseWheelX]=t.deltaX||0,i[u.MouseWheelY]=t.deltaY||t.wheelDelta||0,i[u.MouseWheelZ]=t.deltaZ||0;var r=t;0!==i[u.MouseWheelX]&&(r.inputIndex=u.MouseWheelX,e._onInputChanged(n,0,r)),0!==i[u.MouseWheelY]&&(r.inputIndex=u.MouseWheelY,e._onInputChanged(n,0,r)),0!==i[u.MouseWheelZ]&&(r.inputIndex=u.MouseWheelZ,e._onInputChanged(n,0,r))}},this._elementToAttachTo.addEventListener(this._eventPrefix+"move",this._pointerMoveEvent),this._elementToAttachTo.addEventListener(this._eventPrefix+"down",this._pointerDownEvent),this._elementToAttachTo.addEventListener(this._eventPrefix+"up",this._pointerUpEvent),this._elementToAttachTo.addEventListener(this._eventPrefix+"cancel",this._pointerCancelEvent),this._elementToAttachTo.addEventListener("blur",this._pointerBlurEvent),this._elementToAttachTo.addEventListener(this._wheelEventName,this._pointerWheelEvent,!!n&&{passive:!1}),this._pointerInputClearObserver=this._engine.onEndFrameObservable.add((function(){if(e.isDeviceAvailable(s.Mouse)){var t=e._inputs[s.Mouse][0];t[u.MouseWheelX]=0,t[u.MouseWheelY]=0,t[u.MouseWheelZ]=0}}))}},{key:"_handleGamepadActions",value:function(){var e=this;this._gamepadConnectedEvent=function(t){e._addGamePad(t.gamepad)},this._gamepadDisconnectedEvent=function(t){if(e._gamepads){var n=e._getGamepadDeviceType(t.gamepad.id),i=t.gamepad.index;e._unregisterDevice(n,i),delete e._gamepads[i]}},window.addEventListener("gamepadconnected",this._gamepadConnectedEvent),window.addEventListener("gamepaddisconnected",this._gamepadDisconnectedEvent)}},{key:"_updateDevice",value:function(e,t,n){var i=navigator.getGamepads()[t];if(i&&e===this._gamepads[t]){var r=this._inputs[e][t];n>=i.buttons.length?r[n]=i.axes[n-i.buttons.length].valueOf():r[n]=i.buttons[n].value}}},{key:"_getGamepadDeviceType",value:function(e){return-1!==e.indexOf("054c")?-1!==e.indexOf("0ce6")?s.DualSense:s.DualShock:-1!==e.indexOf("Xbox One")||-1!==e.search("Xbox 360")||-1!==e.search("xinput")?s.Xbox:-1!==e.indexOf("057e")?s.Switch:s.Generic}},{key:"_getPointerType",value:function(e){var t=s.Mouse;return("touch"===e.pointerType||"pen"===e.pointerType||e.touches)&&(t=s.Touch),t}}]),e}(),C=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;(0,i.Z)(this,e),this.deviceType=n,this.deviceSlot=r,this.onInputChangedObservable=new _.y$,this._deviceInputSystem=t}return(0,r.Z)(e,[{key:"getInput",value:function(e){return this._deviceInputSystem.pollInput(this.deviceType,this.deviceSlot,e)}}]),e}();function P(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return D(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return D(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function D(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var R=function(){function e(t){var n=this;(0,i.Z)(this,e),this._registeredManagers=new Array,this._refCount=0,this.registerManager=function(e){for(var t=0;t<n._devices.length;t++){var i=n._devices[t];for(var r in i){var a=+r;e._addDevice(new C(n._deviceInputSystem,t,a))}}n._registeredManagers.push(e)},this.unregisterManager=function(e){var t=n._registeredManagers.indexOf(e);t>-1&&n._registeredManagers.splice(t,1)};var r=Object.keys(s).length/2;this._devices=new Array(r);var a=function(e,t){n._devices[e]||(n._devices[e]=new Array),n._devices[e][t]||(n._devices[e][t]=t);var i,r=P(n._registeredManagers);try{for(r.s();!(i=r.n()).done;){var a=i.value,o=new C(n._deviceInputSystem,e,t);a._addDevice(o)}}catch(s){r.e(s)}finally{r.f()}},o=function(e,t){var i;null!==(i=n._devices[e])&&void 0!==i&&i[t]&&delete n._devices[e][t];var r,a=P(n._registeredManagers);try{for(a.s();!(r=a.n()).done;){r.value._removeDevice(e,t)}}catch(o){a.e(o)}finally{a.f()}},u=function(e,t,i){if(i){var r,a=P(n._registeredManagers);try{for(a.s();!(r=a.n()).done;){r.value._onInputChanged(e,t,i)}}catch(o){a.e(o)}finally{a.f()}}};"undefined"!=typeof _native?this._deviceInputSystem=new A(a,o,u):this._deviceInputSystem=new x(t,a,o,u)}return(0,r.Z)(e,[{key:"dispose",value:function(){this._deviceInputSystem.dispose()}}]),e}();function k(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return O(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return O(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function O(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var N=function(){function e(t){var n=this;(0,i.Z)(this,e);var r=Object.keys(s).length/2;this._devices=new Array(r),this._firstDevice=new Array(r),this._engine=t,this._engine._deviceSourceManager||(this._engine._deviceSourceManager=new R(t)),this._engine._deviceSourceManager._refCount++,this.onDeviceConnectedObservable=new _.y$((function(e){var t,i=k(n._devices);try{for(i.s();!(t=i.n()).done;){var r=t.value;if(r){var a,o=k(r);try{for(o.s();!(a=o.n()).done;){var s=a.value;s&&n.onDeviceConnectedObservable.notifyObserver(e,s)}}catch(u){o.e(u)}finally{o.f()}}}}catch(u){i.e(u)}finally{i.f()}})),this.onDeviceDisconnectedObservable=new _.y$,this._engine._deviceSourceManager.registerManager(this),this._onDisposeObserver=t.onDisposeObservable.add((function(){n.dispose()}))}return(0,r.Z)(e,[{key:"getDeviceSource",value:function(e,t){if(void 0===t){if(void 0===this._firstDevice[e])return null;t=this._firstDevice[e]}return this._devices[e]&&void 0!==this._devices[e][t]?this._devices[e][t]:null}},{key:"getDeviceSources",value:function(e){return this._devices[e]?this._devices[e].filter((function(e){return!!e})):[]}},{key:"dispose",value:function(){this.onDeviceConnectedObservable.clear(),this.onDeviceDisconnectedObservable.clear(),this._engine._deviceSourceManager&&(this._engine._deviceSourceManager.unregisterManager(this),--this._engine._deviceSourceManager._refCount<1&&(this._engine._deviceSourceManager.dispose(),delete this._engine._deviceSourceManager)),this._engine.onDisposeObservable.remove(this._onDisposeObserver)}},{key:"_addDevice",value:function(e){this._devices[e.deviceType]||(this._devices[e.deviceType]=new Array),this._devices[e.deviceType][e.deviceSlot]||(this._devices[e.deviceType][e.deviceSlot]=e,this._updateFirstDevices(e.deviceType)),this.onDeviceConnectedObservable.notifyObservers(e)}},{key:"_removeDevice",value:function(e,t){var n,i,r=null===(n=this._devices[e])||void 0===n?void 0:n[t];this.onDeviceDisconnectedObservable.notifyObservers(r),null!==(i=this._devices[e])&&void 0!==i&&i[t]&&delete this._devices[e][t],this._updateFirstDevices(e)}},{key:"_onInputChanged",value:function(e,t,n){var i,r;null===(i=this._devices[e])||void 0===i||null===(r=i[t])||void 0===r||r.onInputChangedObservable.notifyObservers(n)}},{key:"_updateFirstDevices",value:function(e){switch(e){case s.Keyboard:case s.Mouse:this._firstDevice[e]=0;break;case s.Touch:case s.DualSense:case s.DualShock:case s.Xbox:case s.Switch:case s.Generic:delete this._firstDevice[e];var t=this._devices[e];if(t)for(var n=0;n<t.length;n++)if(t[n]){this._firstDevice[e]=n;break}}}}]),e}(),w=n(4198);function L(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return F(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return F(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function F(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var B=function(){function e(){(0,i.Z)(this,e),this._singleClick=!1,this._doubleClick=!1,this._hasSwiped=!1,this._ignore=!1}return(0,r.Z)(e,[{key:"singleClick",get:function(){return this._singleClick},set:function(e){this._singleClick=e}},{key:"doubleClick",get:function(){return this._doubleClick},set:function(e){this._doubleClick=e}},{key:"hasSwiped",get:function(){return this._hasSwiped},set:function(e){this._hasSwiped=e}},{key:"ignore",get:function(){return this._ignore},set:function(e){this._ignore=e}}]),e}(),U=function(){function e(t){(0,i.Z)(this,e),this._alreadyAttached=!1,this._meshPickProceed=!1,this._currentPickResult=null,this._previousPickResult=null,this._totalPointersPressed=0,this._doubleClickOccured=!1,this._pointerX=0,this._pointerY=0,this._startingPointerPosition=new v.FM(0,0),this._previousStartingPointerPosition=new v.FM(0,0),this._startingPointerTime=0,this._previousStartingPointerTime=0,this._pointerCaptures={},this._meshUnderPointerId={},this._deviceSourceManager=null,this._scene=t||w.l.LastCreatedScene,this._scene}return(0,r.Z)(e,[{key:"meshUnderPointer",get:function(){return this._pointerOverMesh}},{key:"getMeshUnderPointerByPointerId",value:function(e){return this._meshUnderPointerId[e]||null}},{key:"unTranslatedPointer",get:function(){return new v.FM(this._unTranslatedPointerX,this._unTranslatedPointerY)}},{key:"pointerX",get:function(){return this._pointerX},set:function(e){this._pointerX=e}},{key:"pointerY",get:function(){return this._pointerY},set:function(e){this._pointerY=e}},{key:"_updatePointerPosition",value:function(e){var t=this._scene.getEngine().getInputElementClientRect();t&&(this._pointerX=e.clientX-t.left,this._pointerY=e.clientY-t.top,this._unTranslatedPointerX=this._pointerX,this._unTranslatedPointerY=this._pointerY)}},{key:"_processPointerMove",value:function(e,t){var n=this._scene,i=n.getEngine(),r=i.getInputElement();r&&(r.tabIndex=i.canvasTabIndex,n.doNotHandleCursors||(r.style.cursor=n.defaultCursor));var o=!!(e&&e.hit&&e.pickedMesh);if(o){if(n.setPointerOverMesh(e.pickedMesh,t.pointerId,e),!n.doNotHandleCursors&&r&&this._pointerOverMesh){var s=this._pointerOverMesh._getActionManagerForTrigger();s&&s.hasPointerTriggers&&(r.style.cursor=s.hoverCursor||n.hoverCursor)}}else n.setPointerOverMesh(null,t.pointerId,e);var l,c=L(n._pointerMoveStage);try{for(c.s();!(l=c.n()).done;){e=l.value.action(this._unTranslatedPointerX,this._unTranslatedPointerY,e,o,r)}}catch(d){c.e(d)}finally{c.f()}if(e){var h=t.inputIndex>=u.MouseWheelX&&t.inputIndex<=u.MouseWheelZ?a.kD.POINTERWHEEL:a.kD.POINTERMOVE;if(n.onPointerMove&&n.onPointerMove(t,e,h),n.onPointerObservable.hasObservers()){var f=new a.R5(h,t,e);this._setRayOnPointerInfo(f),n.onPointerObservable.notifyObservers(f,h)}}}},{key:"_setRayOnPointerInfo",value:function(e){var t=this._scene;e.pickInfo&&!e.pickInfo._pickingUnavailable&&(e.pickInfo.ray||(e.pickInfo.ray=t.createPickingRay(e.event.offsetX,e.event.offsetY,v.y3.Identity(),t.activeCamera)))}},{key:"_checkPrePointerObservable",value:function(e,t,n){var i=this._scene,r=new a.FV(n,t,this._unTranslatedPointerX,this._unTranslatedPointerY);return e&&(r.originalPickingInfo=e,r.ray=e.ray,e.originMesh&&(r.nearInteractionPickingInfo=e)),i.onPrePointerObservable.notifyObservers(r,n),!!r.skipOnPointerObservable}},{key:"simulatePointerMove",value:function(e,t){var n=new PointerEvent("pointermove",t);n.inputIndex=u.Move,this._checkPrePointerObservable(e,n,a.kD.POINTERMOVE)||this._processPointerMove(e,n)}},{key:"simulatePointerDown",value:function(e,t){var n=new PointerEvent("pointerdown",t);n.inputIndex=n.button+2,this._checkPrePointerObservable(e,n,a.kD.POINTERDOWN)||this._processPointerDown(e,n)}},{key:"_processPointerDown",value:function(t,n){var i=this,r=this._scene;if(t&&t.hit&&t.pickedMesh){this._pickedDownMesh=t.pickedMesh;var o=t.pickedMesh._getActionManagerForTrigger();if(o){if(o.hasPickTriggers)switch(o.processTrigger(5,m.V.CreateNew(t.pickedMesh,n)),n.button){case 0:o.processTrigger(2,m.V.CreateNew(t.pickedMesh,n));break;case 1:o.processTrigger(4,m.V.CreateNew(t.pickedMesh,n));break;case 2:o.processTrigger(3,m.V.CreateNew(t.pickedMesh,n))}o.hasSpecificTrigger(8)&&window.setTimeout((function(){var t=r.pick(i._unTranslatedPointerX,i._unTranslatedPointerY,(function(e){return e.isPickable&&e.isVisible&&e.isReady()&&e.actionManager&&e.actionManager.hasSpecificTrigger(8)&&e===i._pickedDownMesh}),!1,r.cameraToUseForPointers);t&&t.hit&&t.pickedMesh&&o&&0!==i._totalPointersPressed&&Date.now()-i._startingPointerTime>e.LongPressDelay&&!i._isPointerSwiping()&&(i._startingPointerTime=0,o.processTrigger(8,m.V.CreateNew(t.pickedMesh,n)))}),e.LongPressDelay)}}else{var s,u=L(r._pointerDownStage);try{for(u.s();!(s=u.n()).done;){t=s.value.action(this._unTranslatedPointerX,this._unTranslatedPointerY,t,n,!1)}}catch(h){u.e(h)}finally{u.f()}}if(t){var l=a.kD.POINTERDOWN;if(r.onPointerDown&&r.onPointerDown(n,t,l),r.onPointerObservable.hasObservers()){var c=new a.R5(l,n,t);this._setRayOnPointerInfo(c),r.onPointerObservable.notifyObservers(c,l)}}}},{key:"_isPointerSwiping",value:function(){return Math.abs(this._startingPointerPosition.x-this._pointerX)>e.DragMovementThreshold||Math.abs(this._startingPointerPosition.y-this._pointerY)>e.DragMovementThreshold}},{key:"simulatePointerUp",value:function(e,t,n){var i=new PointerEvent("pointerup",t);i.inputIndex=u.Move;var r=new B;n?r.doubleClick=!0:r.singleClick=!0,this._checkPrePointerObservable(e,i,a.kD.POINTERUP)||this._processPointerUp(e,i,r)}},{key:"_processPointerUp",value:function(e,t,n){var i=this._scene;if(e&&e.hit&&e.pickedMesh){if(this._pickedUpMesh=e.pickedMesh,this._pickedDownMesh===this._pickedUpMesh&&(i.onPointerPick&&i.onPointerPick(t,e),n.singleClick&&!n.ignore&&i.onPointerObservable.hasObservers())){var r=a.kD.POINTERPICK,o=new a.R5(r,t,e);this._setRayOnPointerInfo(o),i.onPointerObservable.notifyObservers(o,r)}var s=e.pickedMesh._getActionManagerForTrigger();if(s&&!n.ignore){s.processTrigger(7,m.V.CreateNew(e.pickedMesh,t,e)),!n.hasSwiped&&n.singleClick&&s.processTrigger(1,m.V.CreateNew(e.pickedMesh,t,e));var u=e.pickedMesh._getActionManagerForTrigger(6);n.doubleClick&&u&&u.processTrigger(6,m.V.CreateNew(e.pickedMesh,t,e))}}else if(!n.ignore){var l,c=L(i._pointerUpStage);try{for(c.s();!(l=c.n()).done;){e=l.value.action(this._unTranslatedPointerX,this._unTranslatedPointerY,e,t,n.doubleClick)}}catch(v){c.e(v)}finally{c.f()}}if(this._pickedDownMesh&&this._pickedDownMesh!==this._pickedUpMesh){var h=this._pickedDownMesh._getActionManagerForTrigger(16);h&&h.processTrigger(16,m.V.CreateNew(this._pickedDownMesh,t))}var f=0;if(i.onPointerObservable.hasObservers()){if(!n.ignore&&!n.hasSwiped&&(n.singleClick&&i.onPointerObservable.hasSpecificMask(a.kD.POINTERTAP)?f=a.kD.POINTERTAP:n.doubleClick&&i.onPointerObservable.hasSpecificMask(a.kD.POINTERDOUBLETAP)&&(f=a.kD.POINTERDOUBLETAP),f)){var d=new a.R5(f,t,e);this._setRayOnPointerInfo(d),i.onPointerObservable.notifyObservers(d,f)}if(!n.ignore){f=a.kD.POINTERUP;var p=new a.R5(f,t,e);this._setRayOnPointerInfo(p),i.onPointerObservable.notifyObservers(p,f)}}i.onPointerUp&&!n.ignore&&i.onPointerUp(t,e,f)}},{key:"isPointerCaptured",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this._pointerCaptures[e]}},{key:"attachControl",value:function(){var t=this,n=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,c=this._scene,h=c.getEngine();l||(l=h.getInputElement()),this._alreadyAttached&&this.detachControl(),l&&(this._alreadyAttachedTo=l),this._deviceSourceManager=new N(h),this._initActionManager=function(e){if(!t._meshPickProceed){var n=c.skipPointerUpPicking?null:c.pick(t._unTranslatedPointerX,t._unTranslatedPointerY,c.pointerUpPredicate,!1,c.cameraToUseForPointers);t._currentPickResult=n,n&&(e=n.hit&&n.pickedMesh?n.pickedMesh._getActionManagerForTrigger():null),t._meshPickProceed=!0}return e},this._delayedSimpleClick=function(n,i,r){(Date.now()-t._previousStartingPointerTime>e.DoubleClickDelay&&!t._doubleClickOccured||n!==t._previousButtonPressed)&&(t._doubleClickOccured=!1,i.singleClick=!0,i.ignore=!1,r(i,t._currentPickResult))},this._initClickEvent=function(n,i,r,s){var u=new B;t._currentPickResult=null;var l=null,c=n.hasSpecificMask(a.kD.POINTERPICK)||i.hasSpecificMask(a.kD.POINTERPICK)||n.hasSpecificMask(a.kD.POINTERTAP)||i.hasSpecificMask(a.kD.POINTERTAP)||n.hasSpecificMask(a.kD.POINTERDOUBLETAP)||i.hasSpecificMask(a.kD.POINTERDOUBLETAP);!c&&o&&(l=t._initActionManager(l,u))&&(c=l.hasPickTriggers);var h=!1;if(c){var f=r.button;if(u.hasSwiped=t._isPointerSwiping(),!u.hasSwiped){var d=!e.ExclusiveDoubleClickMode;d||(d=!n.hasSpecificMask(a.kD.POINTERDOUBLETAP)&&!i.hasSpecificMask(a.kD.POINTERDOUBLETAP))&&!o.HasSpecificTrigger(6)&&(l=t._initActionManager(l,u))&&(d=!l.hasSpecificTrigger(6)),d?(Date.now()-t._previousStartingPointerTime>e.DoubleClickDelay||f!==t._previousButtonPressed)&&(u.singleClick=!0,s(u,t._currentPickResult),h=!0):(t._previousDelayedSimpleClickTimeout=t._delayedSimpleClickTimeout,t._delayedSimpleClickTimeout=window.setTimeout(t._delayedSimpleClick.bind(t,f,u,s),e.DoubleClickDelay));var p=n.hasSpecificMask(a.kD.POINTERDOUBLETAP)||i.hasSpecificMask(a.kD.POINTERDOUBLETAP);!p&&o.HasSpecificTrigger(6)&&(l=t._initActionManager(l,u))&&(p=l.hasSpecificTrigger(6)),p&&(f===t._previousButtonPressed&&Date.now()-t._previousStartingPointerTime<e.DoubleClickDelay&&!t._doubleClickOccured?(u.hasSwiped||t._isPointerSwiping()?(t._doubleClickOccured=!1,t._previousStartingPointerTime=t._startingPointerTime,t._previousStartingPointerPosition.x=t._startingPointerPosition.x,t._previousStartingPointerPosition.y=t._startingPointerPosition.y,t._previousButtonPressed=f,e.ExclusiveDoubleClickMode?(t._previousDelayedSimpleClickTimeout&&clearTimeout(t._previousDelayedSimpleClickTimeout),t._previousDelayedSimpleClickTimeout=t._delayedSimpleClickTimeout,s(u,t._previousPickResult)):s(u,t._currentPickResult)):(t._previousStartingPointerTime=0,t._doubleClickOccured=!0,u.doubleClick=!0,u.ignore=!1,e.ExclusiveDoubleClickMode&&t._previousDelayedSimpleClickTimeout&&clearTimeout(t._previousDelayedSimpleClickTimeout),t._previousDelayedSimpleClickTimeout=t._delayedSimpleClickTimeout,s(u,t._currentPickResult)),h=!0):(t._doubleClickOccured=!1,t._previousStartingPointerTime=t._startingPointerTime,t._previousStartingPointerPosition.x=t._startingPointerPosition.x,t._previousStartingPointerPosition.y=t._startingPointerPosition.y,t._previousButtonPressed=f))}}h||s(u,t._currentPickResult)},this._onPointerMove=function(e){if(void 0===e.pointerId&&(e.pointerId=0),t._updatePointerPosition(e),!t._checkPrePointerObservable(null,e,e.inputIndex>=u.MouseWheelX&&e.inputIndex<=u.MouseWheelZ?a.kD.POINTERWHEEL:a.kD.POINTERMOVE)&&(c.cameraToUseForPointers||c.activeCamera))if(c.skipPointerMovePicking)t._processPointerMove(new p.p,e);else{c.pointerMovePredicate||(c.pointerMovePredicate=function(e){return e.isPickable&&e.isVisible&&e.isReady()&&e.isEnabled()&&(e.enablePointerMoveEvents||c.constantlyUpdateMeshUnderPointer||null!==e._getActionManagerForTrigger())&&(!c.cameraToUseForPointers||0!=(c.cameraToUseForPointers.layerMask&e.layerMask))});var n=c.pick(t._unTranslatedPointerX,t._unTranslatedPointerY,c.pointerMovePredicate,!1,c.cameraToUseForPointers,c.pointerMoveTrianglePredicate);t._processPointerMove(n,e)}},this._onPointerDown=function(e){var n;(t._totalPointersPressed++,t._pickedDownMesh=null,t._meshPickProceed=!1,void 0===e.pointerId&&(e.pointerId=0),t._updatePointerPosition(e),c.preventDefaultOnPointerDown&&l&&(e.preventDefault(),l.focus()),t._startingPointerPosition.x=t._pointerX,t._startingPointerPosition.y=t._pointerY,t._startingPointerTime=Date.now(),t._checkPrePointerObservable(null,e,a.kD.POINTERDOWN))||(c.cameraToUseForPointers||c.activeCamera)&&(t._pointerCaptures[e.pointerId]=!0,c.pointerDownPredicate||(c.pointerDownPredicate=function(e){return e.isPickable&&e.isVisible&&e.isReady()&&e.isEnabled()&&(!c.cameraToUseForPointers||0!=(c.cameraToUseForPointers.layerMask&e.layerMask))}),t._pickedDownMesh=null,n=c.skipPointerDownPicking?new p.p:c.pick(t._unTranslatedPointerX,t._unTranslatedPointerY,c.pointerDownPredicate,!1,c.cameraToUseForPointers),t._processPointerDown(n,e))},this._onPointerUp=function(e){0!==t._totalPointersPressed&&(t._totalPointersPressed--,t._pickedUpMesh=null,t._meshPickProceed=!1,void 0===e.pointerId&&(e.pointerId=0),t._updatePointerPosition(e),c.preventDefaultOnPointerUp&&l&&(e.preventDefault(),l.focus()),t._initClickEvent(c.onPrePointerObservable,c.onPointerObservable,e,(function(n,i){if(c.onPrePointerObservable.hasObservers()&&!n.ignore){if(!n.hasSwiped){if(n.singleClick&&c.onPrePointerObservable.hasSpecificMask(a.kD.POINTERTAP)&&t._checkPrePointerObservable(null,e,a.kD.POINTERTAP))return;if(n.doubleClick&&c.onPrePointerObservable.hasSpecificMask(a.kD.POINTERDOUBLETAP)&&t._checkPrePointerObservable(null,e,a.kD.POINTERDOUBLETAP))return}if(t._checkPrePointerObservable(null,e,a.kD.POINTERUP))return}t._pointerCaptures[e.pointerId]=!1,(c.cameraToUseForPointers||c.activeCamera)&&(c.pointerUpPredicate||(c.pointerUpPredicate=function(e){return e.isPickable&&e.isVisible&&e.isReady()&&e.isEnabled()&&(!c.cameraToUseForPointers||0!=(c.cameraToUseForPointers.layerMask&e.layerMask))}),!t._meshPickProceed&&(o&&o.HasTriggers||c.onPointerObservable.hasObservers())&&t._initActionManager(null,n),i||(i=t._currentPickResult),t._processPointerUp(i,e,n),t._previousPickResult=t._currentPickResult)})))},this._onKeyDown=function(e){var t=g.OG.KEYDOWN;if(c.onPreKeyboardObservable.hasObservers()){var n=new g.WZ(t,e);if(c.onPreKeyboardObservable.notifyObservers(n,t),n.skipOnKeyboardObservable)return}if(c.onKeyboardObservable.hasObservers()){var i=new g.NG(t,e);c.onKeyboardObservable.notifyObservers(i,t)}c.actionManager&&c.actionManager.processTrigger(14,m.V.CreateNewFromScene(c,e))},this._onKeyUp=function(e){var t=g.OG.KEYUP;if(c.onPreKeyboardObservable.hasObservers()){var n=new g.WZ(t,e);if(c.onPreKeyboardObservable.notifyObservers(n,t),n.skipOnKeyboardObservable)return}if(c.onKeyboardObservable.hasObservers()){var i=new g.NG(t,e);c.onKeyboardObservable.notifyObservers(i,t)}c.actionManager&&c.actionManager.processTrigger(15,m.V.CreateNewFromScene(c,e))},this._deviceSourceManager.onDeviceConnectedObservable.add((function(e){e.deviceType===s.Mouse?e.onInputChangedObservable.add((function(a){a.inputIndex===u.LeftClick||a.inputIndex===u.MiddleClick||a.inputIndex===u.RightClick||a.inputIndex===u.BrowserBack||a.inputIndex===u.BrowserForward?i&&1===e.getInput(a.inputIndex)?t._onPointerDown(a):n&&0===e.getInput(a.inputIndex)&&t._onPointerUp(a):r&&(a.inputIndex===u.Move?t._onPointerMove(a):a.inputIndex!==u.MouseWheelX&&a.inputIndex!==u.MouseWheelY&&a.inputIndex!==u.MouseWheelZ||t._onPointerMove(a))})):e.deviceType===s.Touch?e.onInputChangedObservable.add((function(a){a.inputIndex===u.LeftClick&&(i&&1===e.getInput(a.inputIndex)?t._onPointerDown(a):n&&0===e.getInput(a.inputIndex)&&t._onPointerUp(a)),r&&a.inputIndex===u.Move&&t._onPointerMove(a)})):e.deviceType===s.Keyboard&&e.onInputChangedObservable.add((function(e){"keydown"===e.type?t._onKeyDown(e):"keyup"===e.type&&t._onKeyUp(e)}))})),this._alreadyAttached=!0}},{key:"detachControl",value:function(){this._alreadyAttached&&(this._deviceSourceManager.dispose(),this._deviceSourceManager=null,this._alreadyAttachedTo&&!this._scene.doNotHandleCursors&&(this._alreadyAttachedTo.style.cursor=this._scene.defaultCursor),this._alreadyAttached=!1,this._alreadyAttachedTo=null)}},{key:"setPointerOverMesh",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;if(this._meshUnderPointerId[t]!==e){var i,r=this._meshUnderPointerId[t];r&&(i=r._getActionManagerForTrigger(10))&&i.processTrigger(10,m.V.CreateNew(r,void 0,{pointerId:t})),e?(this._meshUnderPointerId[t]=e,this._pointerOverMesh=e,(i=e._getActionManagerForTrigger(9))&&i.processTrigger(9,m.V.CreateNew(e,void 0,{pointerId:t,pickResult:n}))):(delete this._meshUnderPointerId[t],this._pointerOverMesh=null)}}},{key:"getPointerOverMesh",value:function(){return this._pointerOverMesh}},{key:"_invalidateMesh",value:function(e){for(var t in this._pointerOverMesh===e&&(this._pointerOverMesh=null),this._pickedDownMesh===e&&(this._pickedDownMesh=null),this._pickedUpMesh===e&&(this._pickedUpMesh=null),this._meshUnderPointerId)this._meshUnderPointerId[t]===e&&delete this._meshUnderPointerId[t]}}]),e}();U.DragMovementThreshold=10,U.LongPressDelay=500,U.DoubleClickDelay=300,U.ExclusiveDoubleClickMode=!1},1221:function(e,t,n){"use strict";n.d(t,{m:function(){return a}});var i=n(5671),r=n(3144),a=function(){function e(){(0,i.Z)(this,e)}return(0,r.Z)(e,null,[{key:"CompareLightsPriority",value:function(e,t){return e.shadowEnabled!==t.shadowEnabled?(t.shadowEnabled?1:0)-(e.shadowEnabled?1:0):t.renderPriority-e.renderPriority}}]),e}();a.FALLOFF_DEFAULT=0,a.FALLOFF_PHYSICAL=1,a.FALLOFF_GLTF=2,a.FALLOFF_STANDARD=3,a.LIGHTMAP_DEFAULT=0,a.LIGHTMAP_SPECULAR=1,a.LIGHTMAP_SHADOWSONLY=2,a.INTENSITYMODE_AUTOMATIC=0,a.INTENSITYMODE_LUMINOUSPOWER=1,a.INTENSITYMODE_LUMINOUSINTENSITY=2,a.INTENSITYMODE_ILLUMINANCE=3,a.INTENSITYMODE_LUMINANCE=4,a.LIGHTTYPEID_POINTLIGHT=0,a.LIGHTTYPEID_DIRECTIONALLIGHT=1,a.LIGHTTYPEID_SPOTLIGHT=2,a.LIGHTTYPEID_HEMISPHERICLIGHT=3},6639:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var i=n(5671),r=n(3144),a=function(){function e(){(0,i.Z)(this,e)}return(0,r.Z)(e,null,[{key:"ForceFullSceneLoadingForIncremental",get:function(){return e._ForceFullSceneLoadingForIncremental},set:function(t){e._ForceFullSceneLoadingForIncremental=t}},{key:"ShowLoadingScreen",get:function(){return e._ShowLoadingScreen},set:function(t){e._ShowLoadingScreen=t}},{key:"loggingLevel",get:function(){return e._LoggingLevel},set:function(t){e._LoggingLevel=t}},{key:"CleanBoneMatrixWeights",get:function(){return e._CleanBoneMatrixWeights},set:function(t){e._CleanBoneMatrixWeights=t}}]),e}();a._ForceFullSceneLoadingForIncremental=!1,a._ShowLoadingScreen=!0,a._CleanBoneMatrixWeights=!1,a._LoggingLevel=0},1889:function(e,t,n){"use strict";n.d(t,{l:function(){return f},S:function(){return i}});var i,r=n(5671),a=n(3144),o=n(136),s=n(6215),u=n(1120),l=n(4174),c=function(){function e(){(0,r.Z)(this,e),this.samplingMode=-1,this._useMipMaps=!0,this._cachedWrapU=null,this._cachedWrapV=null,this._cachedWrapR=null,this._cachedAnisotropicFilteringLevel=null,this._comparisonFunction=0}return(0,a.Z)(e,[{key:"wrapU",get:function(){return this._cachedWrapU},set:function(e){this._cachedWrapU=e}},{key:"wrapV",get:function(){return this._cachedWrapV},set:function(e){this._cachedWrapV=e}},{key:"wrapR",get:function(){return this._cachedWrapR},set:function(e){this._cachedWrapR=e}},{key:"anisotropicFilteringLevel",get:function(){return this._cachedAnisotropicFilteringLevel},set:function(e){this._cachedAnisotropicFilteringLevel=e}},{key:"comparisonFunction",get:function(){return this._comparisonFunction},set:function(e){this._comparisonFunction=e}},{key:"useMipMaps",get:function(){return this._useMipMaps},set:function(e){this._useMipMaps=e}},{key:"setParameters",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;return this._cachedWrapU=e,this._cachedWrapV=t,this._cachedWrapR=n,this._cachedAnisotropicFilteringLevel=i,this.samplingMode=r,this._comparisonFunction=a,this}},{key:"compareSampler",value:function(e){return this._cachedWrapU===e._cachedWrapU&&this._cachedWrapV===e._cachedWrapV&&this._cachedWrapR===e._cachedWrapR&&this._cachedAnisotropicFilteringLevel===e._cachedAnisotropicFilteringLevel&&this.samplingMode===e.samplingMode&&this._comparisonFunction===e._comparisonFunction&&this._useMipMaps===e._useMipMaps}}]),e}();function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,u.Z)(e);if(t){var r=(0,u.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,s.Z)(this,n)}}!function(e){e[e.Unknown=0]="Unknown",e[e.Url=1]="Url",e[e.Temp=2]="Temp",e[e.Raw=3]="Raw",e[e.Dynamic=4]="Dynamic",e[e.RenderTarget=5]="RenderTarget",e[e.MultiRenderTarget=6]="MultiRenderTarget",e[e.Cube=7]="Cube",e[e.CubeRaw=8]="CubeRaw",e[e.CubePrefiltered=9]="CubePrefiltered",e[e.Raw3D=10]="Raw3D",e[e.Raw2DArray=11]="Raw2DArray",e[e.DepthStencil=12]="DepthStencil",e[e.CubeRawRGBD=13]="CubeRawRGBD",e[e.Depth=14]="Depth"}(i||(i={}));var f=function(e){(0,o.Z)(n,e);var t=h(n);function n(e,a){var o,s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(0,r.Z)(this,n),(o=t.call(this)).isReady=!1,o.isCube=!1,o.is3D=!1,o.is2DArray=!1,o.isMultiview=!1,o.url="",o.generateMipMaps=!1,o.samples=0,o.type=-1,o.format=-1,o.onLoadedObservable=new l.y$,o.onErrorObservable=new l.y$,o.onRebuildCallback=null,o.width=0,o.height=0,o.depth=0,o.baseWidth=0,o.baseHeight=0,o.baseDepth=0,o.invertY=!1,o._invertVScale=!1,o._associatedChannel=-1,o._source=i.Unknown,o._buffer=null,o._bufferView=null,o._bufferViewArray=null,o._bufferViewArrayArray=null,o._size=0,o._extension="",o._files=null,o._workingCanvas=null,o._workingContext=null,o._cachedCoordinatesMode=null,o._isDisabled=!1,o._compression=null,o._sphericalPolynomial=null,o._sphericalPolynomialPromise=null,o._sphericalPolynomialComputed=!1,o._lodGenerationScale=0,o._lodGenerationOffset=0,o._useSRGBBuffer=!1,o._lodTextureHigh=null,o._lodTextureMid=null,o._lodTextureLow=null,o._isRGBD=!1,o._linearSpecularLOD=!1,o._irradianceTexture=null,o._hardwareTexture=null,o._maxLodLevel=null,o._references=1,o._gammaSpace=null,o._engine=e,o._source=a,o._uniqueId=n._Counter++,s||(o._hardwareTexture=e._createHardwareTexture()),o}return(0,a.Z)(n,[{key:"useMipMaps",get:function(){return this.generateMipMaps},set:function(e){this.generateMipMaps=e}},{key:"uniqueId",get:function(){return this._uniqueId}},{key:"getEngine",value:function(){return this._engine}},{key:"source",get:function(){return this._source}},{key:"incrementReferences",value:function(){this._references++}},{key:"updateSize",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;this._engine.updateTextureDimensions(this,e,t,n),this.width=e,this.height=t,this.depth=n,this.baseWidth=e,this.baseHeight=t,this.baseDepth=n,this._size=e*t*n}},{key:"_rebuild",value:function(){var e,t=this;if(this.isReady=!1,this._cachedCoordinatesMode=null,this._cachedWrapU=null,this._cachedWrapV=null,this._cachedWrapR=null,this._cachedAnisotropicFilteringLevel=null,this.onRebuildCallback){var n=this.onRebuildCallback(this),r=function(e){e._swapAndDie(t,!1),t.isReady=n.isReady};n.isAsync?n.proxy.then(r):r(n.proxy)}else{var a;switch(this.source){case i.Temp:break;case i.Url:return void(a=this._engine.createTexture(null!==(e=this._originalUrl)&&void 0!==e?e:this.url,!this.generateMipMaps,this.invertY,null,this.samplingMode,(function(){a._swapAndDie(t,!1),t.isReady=!0}),null,this._buffer,void 0,this.format,this._extension,void 0,void 0,void 0,this._useSRGBBuffer));case i.Raw:(a=this._engine.createRawTexture(this._bufferView,this.baseWidth,this.baseHeight,this.format,this.generateMipMaps,this.invertY,this.samplingMode,this._compression,this.type,void 0,this._useSRGBBuffer))._swapAndDie(this,!1),this.isReady=!0;break;case i.Raw3D:(a=this._engine.createRawTexture3D(this._bufferView,this.baseWidth,this.baseHeight,this.baseDepth,this.format,this.generateMipMaps,this.invertY,this.samplingMode,this._compression,this.type))._swapAndDie(this,!1),this.isReady=!0;break;case i.Raw2DArray:(a=this._engine.createRawTexture2DArray(this._bufferView,this.baseWidth,this.baseHeight,this.baseDepth,this.format,this.generateMipMaps,this.invertY,this.samplingMode,this._compression,this.type))._swapAndDie(this,!1),this.isReady=!0;break;case i.Dynamic:(a=this._engine.createDynamicTexture(this.baseWidth,this.baseHeight,this.generateMipMaps,this.samplingMode))._swapAndDie(this,!1),this._engine.updateDynamicTexture(this,this._engine.getRenderingCanvas(),this.invertY,void 0,void 0,!0);break;case i.Cube:return void(a=this._engine.createCubeTexture(this.url,null,this._files,!this.generateMipMaps,(function(){a._swapAndDie(t,!1),t.isReady=!0}),null,this.format,this._extension,!1,0,0,null,void 0,this._useSRGBBuffer));case i.CubeRaw:(a=this._engine.createRawCubeTexture(this._bufferViewArray,this.width,this.format,this.type,this.generateMipMaps,this.invertY,this.samplingMode,this._compression))._swapAndDie(this,!1),this.isReady=!0;break;case i.CubeRawRGBD:return;case i.CubePrefiltered:return void((a=this._engine.createPrefilteredCubeTexture(this.url,null,this._lodGenerationScale,this._lodGenerationOffset,(function(e){e&&e._swapAndDie(t,!1),t.isReady=!0}),null,this.format,this._extension))._sphericalPolynomial=this._sphericalPolynomial)}}}},{key:"_swapAndDie",value:function(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];null===(t=this._hardwareTexture)||void 0===t||t.setUsage(e._source,this.generateMipMaps,this.isCube,this.width,this.height),e._hardwareTexture=this._hardwareTexture,n&&(e._isRGBD=this._isRGBD),this._lodTextureHigh&&(e._lodTextureHigh&&e._lodTextureHigh.dispose(),e._lodTextureHigh=this._lodTextureHigh),this._lodTextureMid&&(e._lodTextureMid&&e._lodTextureMid.dispose(),e._lodTextureMid=this._lodTextureMid),this._lodTextureLow&&(e._lodTextureLow&&e._lodTextureLow.dispose(),e._lodTextureLow=this._lodTextureLow),this._irradianceTexture&&(e._irradianceTexture&&e._irradianceTexture.dispose(),e._irradianceTexture=this._irradianceTexture);var i=this._engine.getLoadedTexturesCache(),r=i.indexOf(this);-1!==r&&i.splice(r,1),-1===(r=i.indexOf(e))&&i.push(e)}},{key:"dispose",value:function(){this._references--,this.onLoadedObservable.clear(),this.onErrorObservable.clear(),0===this._references&&(this._engine._releaseTexture(this),this._hardwareTexture=null)}}]),n}(c);f._Counter=0},8618:function(e,t,n){"use strict";n.d(t,{q:function(){return a}});var i=n(5671),r=n(3144),a=function(){function e(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];(0,i.Z)(this,e),this.effect=null,this.defines=null,this.drawContext=t.createDrawContext(),n&&(this.materialContext=t.createMaterialContext())}return(0,r.Z)(e,[{key:"setEffect",value:function(e,t){var n,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];(this.effect=e,void 0!==t&&(this.defines=t),i)&&(null===(n=this.drawContext)||void 0===n||n.reset())}},{key:"dispose",value:function(){var e;null===(e=this.drawContext)||void 0===e||e.dispose()}}],[{key:"IsWrapper",value:function(e){return void 0===e.getPipelineContext}},{key:"GetEffect",value:function(e){return void 0===e.getPipelineContext?e.effect:e}}]),e}()},8977:function(e,t,n){"use strict";n.d(t,{Q:function(){return p}});var i=n(885),r=n(5671),a=n(3144),o=n(4174),s=n(5092),u=n(2328),l=n(9776),c=n(8084),h=n(2223);function f(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var p=function(){function e(t,n,i){var a=this,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,f=arguments.length>4?arguments[4]:void 0,d=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,p=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,v=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,m=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,g=arguments.length>9?arguments[9]:void 0,_=arguments.length>10&&void 0!==arguments[10]?arguments[10]:"",y=arguments.length>11&&void 0!==arguments[11]?arguments[11]:h.x.GLSL;(0,r.Z)(this,e),this.name=null,this.defines="",this.onCompiled=null,this.onError=null,this.onBind=null,this.uniqueId=0,this.onCompileObservable=new o.y$,this.onErrorObservable=new o.y$,this._onBindObservable=null,this._wasPreviouslyReady=!1,this._wasPreviouslyUsingInstances=null,this._isDisposed=!1,this._bonesComputationForcedToCPU=!1,this._uniformBuffersNames={},this._multiTarget=!1,this._samplers={},this._isReady=!1,this._compilationError="",this._allFallbacksProcessed=!1,this._uniforms={},this._key="",this._fallbacks=null,this._vertexSourceCodeOverride="",this._fragmentSourceCodeOverride="",this._transformFeedbackVaryings=null,this._pipelineContext=null,this._vertexSourceCode="",this._fragmentSourceCode="",this._rawVertexSourceCode="",this._rawFragmentSourceCode="",this.name=t,this._key=_;var E,A,b=void 0,T=null;if(n.attributes){var M,S,I,x=n;if(this._engine=i,this._attributesNames=x.attributes,this._uniformsNames=x.uniformsNames.concat(x.samplers),this._samplerList=x.samplers.slice(),this.defines=x.defines,this.onError=x.onError,this.onCompiled=x.onCompiled,this._fallbacks=x.fallbacks,this._indexParameters=x.indexParameters,this._transformFeedbackVaryings=x.transformFeedbackVaryings||null,this._multiTarget=!!x.multiTarget,this._shaderLanguage=null!==(M=x.shaderLanguage)&&void 0!==M?M:h.x.GLSL,x.uniformBuffersNames){this._uniformBuffersNamesList=x.uniformBuffersNames.slice();for(var C=0;C<x.uniformBuffersNames.length;C++)this._uniformBuffersNames[x.uniformBuffersNames[C]]=C}T=null!==(S=x.processFinalCode)&&void 0!==S?S:null,b=null!==(I=x.processCodeAfterIncludes)&&void 0!==I?I:void 0}else this._engine=f,this.defines=null==d?"":d,this._uniformsNames=i.concat(u),this._samplerList=u?u.slice():[],this._attributesNames=n,this._uniformBuffersNamesList=[],this._shaderLanguage=y,this.onError=m,this.onCompiled=v,this._indexParameters=g,this._fallbacks=p;this._attributeLocationByName={},this.uniqueId=e._UniqueIdSeed++;var P=(0,s.CG)()?this._engine.getHostDocument():null;t.vertexSource?E="source:"+t.vertexSource:t.vertexElement?(E=P?P.getElementById(t.vertexElement):null)||(E=t.vertexElement):E=t.vertex||t,t.fragmentSource?A="source:"+t.fragmentSource:t.fragmentElement?(A=P?P.getElementById(t.fragmentElement):null)||(A=t.fragmentElement):A=t.fragment||t,this._processingContext=this._engine._getShaderProcessingContext(this._shaderLanguage);var D={defines:this.defines.split("\n"),indexParameters:this._indexParameters,isFragment:!1,shouldUseHighPrecisionShader:this._engine._shouldUseHighPrecisionShader,processor:this._engine._getShaderProcessor(this._shaderLanguage),supportsUniformBuffers:this._engine.supportsUniformBuffers,shadersRepository:c.v.GetShadersRepository(this._shaderLanguage),includesShadersStore:c.v.GetIncludesShadersStore(this._shaderLanguage),version:(100*this._engine.version).toString(),platformName:this._engine.shaderPlatformName,processingContext:this._processingContext,isNDCHalfZRange:this._engine.isNDCHalfZRange,useReverseDepthBuffer:this._engine.useReverseDepthBuffer,processCodeAfterIncludes:b},R=[void 0,void 0],k=function(){if(R[0]&&R[1]){D.isFragment=!0;var e=R[0],n=R[1];l.L.Process(n,D,(function(n){T&&(n=T("fragment",n));var i=l.L.Finalize(e,n,D);a._useFinalCode(i.vertexCode,i.fragmentCode,t)}),a._engine)}};this._loadShader(E,"Vertex","",(function(e){l.L.Initialize(D),l.L.Process(e,D,(function(t){a._rawVertexSourceCode=e,T&&(t=T("vertex",t)),R[0]=t,k()}),a._engine)})),this._loadShader(A,"Fragment","Pixel",(function(e){a._rawFragmentSourceCode=e,R[1]=e,k()}));var O=function(e){return function(){if(this._pipelineContext){var t=this._pipelineContext[e];t.apply(this._pipelineContext,arguments)}return this}};["Int?","IntArray?","Array?","Color?","Vector?","Float?","Matrices","Matrix","Matrix3x3","Matrix2x2","Quaternion","DirectColor4"].forEach((function(e){var t="set".concat(e);t.endsWith("?")?["",2,3,4].forEach((function(e){a[t.slice(0,-1)+e]=a[t.slice(0,-1)+e]||O(t.slice(0,-1)+e).bind(a)})):a[t]=a[t]||O(t).bind(a)}))}return(0,a.Z)(e,[{key:"onBindObservable",get:function(){return this._onBindObservable||(this._onBindObservable=new o.y$),this._onBindObservable}},{key:"_useFinalCode",value:function(e,t,n){if(n){var i=n.vertexElement||n.vertex||n.spectorName||n,r=n.fragmentElement||n.fragment||n.spectorName||n;this._vertexSourceCode=(this._shaderLanguage===h.x.WGSL?"//":"")+"#define SHADER_NAME vertex:"+i+"\n"+e,this._fragmentSourceCode=(this._shaderLanguage===h.x.WGSL?"//":"")+"#define SHADER_NAME fragment:"+r+"\n"+t}else this._vertexSourceCode=e,this._fragmentSourceCode=t;this._prepareEffect()}},{key:"key",get:function(){return this._key}},{key:"isReady",value:function(){try{return this._isReadyInternal()}catch(e){return!1}}},{key:"_isReadyInternal",value:function(){return!!this._isReady||!!this._pipelineContext&&this._pipelineContext.isReady}},{key:"getEngine",value:function(){return this._engine}},{key:"getPipelineContext",value:function(){return this._pipelineContext}},{key:"getAttributesNames",value:function(){return this._attributesNames}},{key:"getAttributeLocation",value:function(e){return this._attributes[e]}},{key:"getAttributeLocationByName",value:function(e){return this._attributeLocationByName[e]}},{key:"getAttributesCount",value:function(){return this._attributes.length}},{key:"getUniformIndex",value:function(e){return this._uniformsNames.indexOf(e)}},{key:"getUniform",value:function(e){return this._uniforms[e]}},{key:"getSamplers",value:function(){return this._samplerList}},{key:"getUniformNames",value:function(){return this._uniformsNames}},{key:"getUniformBuffersNames",value:function(){return this._uniformBuffersNamesList}},{key:"getIndexParameters",value:function(){return this._indexParameters}},{key:"getCompilationError",value:function(){return this._compilationError}},{key:"allFallbacksProcessed",value:function(){return this._allFallbacksProcessed}},{key:"executeWhenCompiled",value:function(e){var t=this;this.isReady()?e(this):(this.onCompileObservable.add((function(t){e(t)})),this._pipelineContext&&!this._pipelineContext.isAsync||setTimeout((function(){t._checkIsReady(null)}),16))}},{key:"_checkIsReady",value:function(e){var t=this;try{if(this._isReadyInternal())return}catch(n){return void this._processCompilationErrors(n,e)}this._isDisposed||setTimeout((function(){t._checkIsReady(e)}),16)}},{key:"_loadShader",value:function(e,t,n,i){if("undefined"!=typeof HTMLElement&&e instanceof HTMLElement)return void i((0,s.v)(e));if("source:"!==e.substr(0,7))if("base64:"!==e.substr(0,7)){var r,a=c.v.GetShadersStore(this._shaderLanguage);if(a[e+t+"Shader"])i(a[e+t+"Shader"]);else if(n&&a[e+n+"Shader"])i(a[e+n+"Shader"]);else r="."===e[0]||"/"===e[0]||e.indexOf("http")>-1?e:c.v.GetShadersRepository(this._shaderLanguage)+e,this._engine._loadFile(r+"."+t.toLowerCase()+".fx",i)}else{i(window.atob(e.substr(7)))}else i(e.substr(7))}},{key:"vertexSourceCode",get:function(){var e,t;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._vertexSourceCodeOverride:null!==(e=null===(t=this._pipelineContext)||void 0===t?void 0:t._getVertexShaderCode())&&void 0!==e?e:this._vertexSourceCode}},{key:"fragmentSourceCode",get:function(){var e,t;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._fragmentSourceCodeOverride:null!==(e=null===(t=this._pipelineContext)||void 0===t?void 0:t._getFragmentShaderCode())&&void 0!==e?e:this._fragmentSourceCode}},{key:"rawVertexSourceCode",get:function(){return this._rawVertexSourceCode}},{key:"rawFragmentSourceCode",get:function(){return this._rawFragmentSourceCode}},{key:"_rebuildProgram",value:function(e,t,n,i){var r=this;this._isReady=!1,this._vertexSourceCodeOverride=e,this._fragmentSourceCodeOverride=t,this.onError=function(e,t){i&&i(t)},this.onCompiled=function(){var e=r.getEngine().scenes;if(e)for(var t=0;t<e.length;t++)e[t].markAllMaterialsAsDirty(63);r._pipelineContext._handlesSpectorRebuildCallback(n)},this._fallbacks=null,this._prepareEffect()}},{key:"_prepareEffect",value:function(){var e=this,t=this._attributesNames,n=this.defines,i=this._pipelineContext;this._isReady=!1;try{var r=this._engine;this._pipelineContext=r.createPipelineContext(this._processingContext),this._pipelineContext._name=this._key;var a=this._rebuildProgram.bind(this);this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?r._preparePipelineContext(this._pipelineContext,this._vertexSourceCodeOverride,this._fragmentSourceCodeOverride,!0,this._rawVertexSourceCode,this._rawFragmentSourceCode,a,null,this._transformFeedbackVaryings,this._key):r._preparePipelineContext(this._pipelineContext,this._vertexSourceCode,this._fragmentSourceCode,!1,this._rawVertexSourceCode,this._rawFragmentSourceCode,a,n,this._transformFeedbackVaryings,this._key),r._executeWhenRenderingStateIsCompiled(this._pipelineContext,(function(){if(e._attributes=[],e._pipelineContext._fillEffectInformation(e,e._uniformBuffersNames,e._uniformsNames,e._uniforms,e._samplerList,e._samplers,t,e._attributes),t)for(var n=0;n<t.length;n++){var a=t[n];e._attributeLocationByName[a]=e._attributes[n]}r.bindSamplers(e),e._compilationError="",e._isReady=!0,e.onCompiled&&e.onCompiled(e),e.onCompileObservable.notifyObservers(e),e.onCompileObservable.clear(),e._fallbacks&&e._fallbacks.unBindMesh(),i&&e.getEngine()._deletePipelineContext(i)})),this._pipelineContext.isAsync&&this._checkIsReady(i)}catch(o){this._processCompilationErrors(o,i)}}},{key:"_getShaderCodeAndErrorLine",value:function(e,t,n){var i=n?/FRAGMENT SHADER ERROR: 0:(\d+?):/:/VERTEX SHADER ERROR: 0:(\d+?):/,r=null;if(t&&e){var a=t.match(i);if(a&&2===a.length){var o=parseInt(a[1]),s=e.split("\n",-1);s.length>=o&&(r="Offending line [".concat(o,"] in ").concat(n?"fragment":"vertex"," code: ").concat(s[o-1]))}}return[e,r]}},{key:"_processCompilationErrors",value:function(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._compilationError=t.message;var a=this._attributesNames,o=this._fallbacks;if(u.Y.Error("Unable to compile effect:"),u.Y.Error("Uniforms: "+this._uniformsNames.map((function(e){return" "+e}))),u.Y.Error("Attributes: "+a.map((function(e){return" "+e}))),u.Y.Error("Defines:\r\n"+this.defines),e.LogShaderCodeOnCompilationError){var s,l,c=null,h=null,f=null;if(null!==(s=this._pipelineContext)&&void 0!==s&&s._getVertexShaderCode()){var d=this._getShaderCodeAndErrorLine(this._pipelineContext._getVertexShaderCode(),this._compilationError,!1),p=(0,i.Z)(d,2);f=p[0],c=p[1],f&&(u.Y.Error("Vertex code:"),u.Y.Error(f))}if(null!==(l=this._pipelineContext)&&void 0!==l&&l._getFragmentShaderCode()){var v,m=this._getShaderCodeAndErrorLine(null===(v=this._pipelineContext)||void 0===v?void 0:v._getFragmentShaderCode(),this._compilationError,!0),g=(0,i.Z)(m,2);f=g[0],h=g[1],f&&(u.Y.Error("Fragment code:"),u.Y.Error(f))}c&&u.Y.Error(c),h&&u.Y.Error(h)}u.Y.Error("Error: "+this._compilationError);var _=function(){n.onError&&n.onError(n,n._compilationError),n.onErrorObservable.notifyObservers(n)};r&&(this._pipelineContext=r,this._isReady=!0,_()),o?(this._pipelineContext=null,o.hasMoreFallbacks?(this._allFallbacksProcessed=!1,u.Y.Error("Trying next fallback."),this.defines=o.reduce(this.defines,this),this._prepareEffect()):(this._allFallbacksProcessed=!0,_(),this.onErrorObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh())):(this._allFallbacksProcessed=!0,r||_())}},{key:"isSupported",get:function(){return""===this._compilationError}},{key:"_bindTexture",value:function(e,t){this._engine._bindTexture(this._samplers[e],t,e)}},{key:"setTexture",value:function(e,t){this._engine.setTexture(this._samplers[e],this._uniforms[e],t,e)}},{key:"setDepthStencilTexture",value:function(e,t){this._engine.setDepthStencilTexture(this._samplers[e],this._uniforms[e],t,e)}},{key:"setTextureArray",value:function(e,t){var n=e+"Ex";if(-1===this._samplerList.indexOf(n+"0")){for(var i=this._samplerList.indexOf(e),r=1;r<t.length;r++){var a=n+(r-1).toString();this._samplerList.splice(i+r,0,a)}var o,s=0,u=f(this._samplerList);try{for(u.s();!(o=u.n()).done;){var l=o.value;this._samplers[l]=s,s+=1}}catch(c){u.e(c)}finally{u.f()}}this._engine.setTextureArray(this._samplers[e],this._uniforms[e],t,e)}},{key:"setTextureFromPostProcess",value:function(e,t){this._engine.setTextureFromPostProcess(this._samplers[e],t,e)}},{key:"setTextureFromPostProcessOutput",value:function(e,t){this._engine.setTextureFromPostProcessOutput(this._samplers[e],t,e)}},{key:"bindUniformBuffer",value:function(t,n){var i=this._uniformBuffersNames[n];void 0===i||e._BaseCache[i]===t&&this._engine._features.useUBOBindingCache||(e._BaseCache[i]=t,this._engine.bindUniformBufferBase(t,i,n))}},{key:"bindUniformBlock",value:function(e,t){this._engine.bindUniformBlock(this._pipelineContext,e,t)}},{key:"setFloatArray",value:function(e,t){return this._pipelineContext.setArray(e,t),this}},{key:"setFloatArray2",value:function(e,t){return this._pipelineContext.setArray2(e,t),this}},{key:"setFloatArray3",value:function(e,t){return this._pipelineContext.setArray3(e,t),this}},{key:"setFloatArray4",value:function(e,t){return this._pipelineContext.setArray4(e,t),this}},{key:"setBool",value:function(e,t){return this._pipelineContext.setInt(e,t?1:0),this}},{key:"dispose",value:function(){var e;null===(e=this._pipelineContext)||void 0===e||e.dispose(),this._engine._releaseEffect(this),this._isDisposed=!0}}],[{key:"ShadersRepository",get:function(){return c.v.ShadersRepository},set:function(e){c.v.ShadersRepository=e}},{key:"RegisterShader",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:h.x.GLSL;t&&(c.v.GetShadersStore(i)["".concat(e,"PixelShader")]=t),n&&(c.v.GetShadersStore(i)["".concat(e,"VertexShader")]=n)}},{key:"ResetCache",value:function(){e._BaseCache={}}}]),e}();p.LogShaderCodeOnCompilationError=!0,p._UniqueIdSeed=0,p._BaseCache={},p.ShadersStore=c.v.ShadersStore,p.IncludesShadersStore=c.v.IncludesShadersStore},7823:function(e,t,n){"use strict";n.d(t,{$:function(){return h}});var i=n(3144),r=n(5671),a=n(9477),o=n(9336),s=n(4174),u=n(8517),l=n(7046),c=(n(4771),function(){function e(){(0,r.Z)(this,e),this._dirty=!0,this._tempColor=new l.HE(0,0,0,0),this._globalCurve=new l.HE(0,0,0,0),this._highlightsCurve=new l.HE(0,0,0,0),this._midtonesCurve=new l.HE(0,0,0,0),this._shadowsCurve=new l.HE(0,0,0,0),this._positiveCurve=new l.HE(0,0,0,0),this._negativeCurve=new l.HE(0,0,0,0),this._globalHue=30,this._globalDensity=0,this._globalSaturation=0,this._globalExposure=0,this._highlightsHue=30,this._highlightsDensity=0,this._highlightsSaturation=0,this._highlightsExposure=0,this._midtonesHue=30,this._midtonesDensity=0,this._midtonesSaturation=0,this._midtonesExposure=0,this._shadowsHue=30,this._shadowsDensity=0,this._shadowsSaturation=0,this._shadowsExposure=0}return(0,i.Z)(e,[{key:"globalHue",get:function(){return this._globalHue},set:function(e){this._globalHue=e,this._dirty=!0}},{key:"globalDensity",get:function(){return this._globalDensity},set:function(e){this._globalDensity=e,this._dirty=!0}},{key:"globalSaturation",get:function(){return this._globalSaturation},set:function(e){this._globalSaturation=e,this._dirty=!0}},{key:"globalExposure",get:function(){return this._globalExposure},set:function(e){this._globalExposure=e,this._dirty=!0}},{key:"highlightsHue",get:function(){return this._highlightsHue},set:function(e){this._highlightsHue=e,this._dirty=!0}},{key:"highlightsDensity",get:function(){return this._highlightsDensity},set:function(e){this._highlightsDensity=e,this._dirty=!0}},{key:"highlightsSaturation",get:function(){return this._highlightsSaturation},set:function(e){this._highlightsSaturation=e,this._dirty=!0}},{key:"highlightsExposure",get:function(){return this._highlightsExposure},set:function(e){this._highlightsExposure=e,this._dirty=!0}},{key:"midtonesHue",get:function(){return this._midtonesHue},set:function(e){this._midtonesHue=e,this._dirty=!0}},{key:"midtonesDensity",get:function(){return this._midtonesDensity},set:function(e){this._midtonesDensity=e,this._dirty=!0}},{key:"midtonesSaturation",get:function(){return this._midtonesSaturation},set:function(e){this._midtonesSaturation=e,this._dirty=!0}},{key:"midtonesExposure",get:function(){return this._midtonesExposure},set:function(e){this._midtonesExposure=e,this._dirty=!0}},{key:"shadowsHue",get:function(){return this._shadowsHue},set:function(e){this._shadowsHue=e,this._dirty=!0}},{key:"shadowsDensity",get:function(){return this._shadowsDensity},set:function(e){this._shadowsDensity=e,this._dirty=!0}},{key:"shadowsSaturation",get:function(){return this._shadowsSaturation},set:function(e){this._shadowsSaturation=e,this._dirty=!0}},{key:"shadowsExposure",get:function(){return this._shadowsExposure},set:function(e){this._shadowsExposure=e,this._dirty=!0}},{key:"getClassName",value:function(){return"ColorCurves"}},{key:"_getColorGradingDataToRef",value:function(t,n,i,r,a){null!=t&&(t=e._Clamp(t,0,360),n=e._Clamp(n,-100,100),i=e._Clamp(i,-100,100),r=e._Clamp(r,-100,100),n=e._ApplyColorGradingSliderNonlinear(n),n*=.5,r=e._ApplyColorGradingSliderNonlinear(r),n<0&&(n*=-1,t=(t+180)%360),e._FromHSBToRef(t,n,50+.25*r,a),a.scaleToRef(2,a),a.a=1+.01*i)}},{key:"clone",value:function(){return o.p4.Clone((function(){return new e}),this)}},{key:"serialize",value:function(){return o.p4.Serialize(this)}}],[{key:"Bind",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"vCameraColorCurvePositive",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"vCameraColorCurveNeutral",r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"vCameraColorCurveNegative";e._dirty&&(e._dirty=!1,e._getColorGradingDataToRef(e._globalHue,e._globalDensity,e._globalSaturation,e._globalExposure,e._globalCurve),e._getColorGradingDataToRef(e._highlightsHue,e._highlightsDensity,e._highlightsSaturation,e._highlightsExposure,e._tempColor),e._tempColor.multiplyToRef(e._globalCurve,e._highlightsCurve),e._getColorGradingDataToRef(e._midtonesHue,e._midtonesDensity,e._midtonesSaturation,e._midtonesExposure,e._tempColor),e._tempColor.multiplyToRef(e._globalCurve,e._midtonesCurve),e._getColorGradingDataToRef(e._shadowsHue,e._shadowsDensity,e._shadowsSaturation,e._shadowsExposure,e._tempColor),e._tempColor.multiplyToRef(e._globalCurve,e._shadowsCurve),e._highlightsCurve.subtractToRef(e._midtonesCurve,e._positiveCurve),e._midtonesCurve.subtractToRef(e._shadowsCurve,e._negativeCurve)),t&&(t.setFloat4(n,e._positiveCurve.r,e._positiveCurve.g,e._positiveCurve.b,e._positiveCurve.a),t.setFloat4(i,e._midtonesCurve.r,e._midtonesCurve.g,e._midtonesCurve.b,e._midtonesCurve.a),t.setFloat4(r,e._negativeCurve.r,e._negativeCurve.g,e._negativeCurve.b,e._negativeCurve.a))}},{key:"PrepareUniforms",value:function(e){e.push("vCameraColorCurveNeutral","vCameraColorCurvePositive","vCameraColorCurveNegative")}},{key:"_ApplyColorGradingSliderNonlinear",value:function(e){e/=100;var t=Math.abs(e);return t=Math.pow(t,2),e<0&&(t*=-1),t*=100}},{key:"_FromHSBToRef",value:function(t,n,i,r){var a=e._Clamp(t,0,360),o=e._Clamp(n/100,0,1),s=e._Clamp(i/100,0,1);if(0===o)r.r=s,r.g=s,r.b=s;else{a/=60;var u=Math.floor(a),l=a-u,c=s*(1-o),h=s*(1-o*l),f=s*(1-o*(1-l));switch(u){case 0:r.r=s,r.g=f,r.b=c;break;case 1:r.r=h,r.g=s,r.b=c;break;case 2:r.r=c,r.g=s,r.b=f;break;case 3:r.r=c,r.g=h,r.b=s;break;case 4:r.r=f,r.g=c,r.b=s;break;default:r.r=s,r.g=c,r.b=h}}r.a=1}},{key:"_Clamp",value:function(e,t,n){return Math.min(Math.max(e,t),n)}},{key:"Parse",value:function(t){return o.p4.Parse((function(){return new e}),t,null,null)}}]),e}());(0,a.gn)([(0,o.qC)()],c.prototype,"_globalHue",void 0),(0,a.gn)([(0,o.qC)()],c.prototype,"_globalDensity",void 0),(0,a.gn)([(0,o.qC)()],c.prototype,"_globalSaturation",void 0),(0,a.gn)([(0,o.qC)()],c.prototype,"_globalExposure",void 0),(0,a.gn)([(0,o.qC)()],c.prototype,"_highlightsHue",void 0),(0,a.gn)([(0,o.qC)()],c.prototype,"_highlightsDensity",void 0),(0,a.gn)([(0,o.qC)()],c.prototype,"_highlightsSaturation",void 0),(0,a.gn)([(0,o.qC)()],c.prototype,"_highlightsExposure",void 0),(0,a.gn)([(0,o.qC)()],c.prototype,"_midtonesHue",void 0),(0,a.gn)([(0,o.qC)()],c.prototype,"_midtonesDensity",void 0),(0,a.gn)([(0,o.qC)()],c.prototype,"_midtonesSaturation",void 0),(0,a.gn)([(0,o.qC)()],c.prototype,"_midtonesExposure",void 0),o.p4._ColorCurvesParser=c.Parse;var h=function(){function e(){(0,r.Z)(this,e),this.colorCurves=new c,this._colorCurvesEnabled=!1,this._colorGradingEnabled=!1,this._colorGradingWithGreenDepth=!0,this._colorGradingBGR=!0,this._exposure=1,this._toneMappingEnabled=!1,this._toneMappingType=e.TONEMAPPING_STANDARD,this._contrast=1,this.vignetteStretch=0,this.vignetteCentreX=0,this.vignetteCentreY=0,this.vignetteWeight=1.5,this.vignetteColor=new l.HE(0,0,0,0),this.vignetteCameraFov=.5,this._vignetteBlendMode=e.VIGNETTEMODE_MULTIPLY,this._vignetteEnabled=!1,this._ditheringEnabled=!1,this._ditheringIntensity=1/255,this._skipFinalColorClamp=!1,this._applyByPostProcess=!1,this._isEnabled=!0,this.onUpdateParameters=new s.y$}return(0,i.Z)(e,[{key:"colorCurvesEnabled",get:function(){return this._colorCurvesEnabled},set:function(e){this._colorCurvesEnabled!==e&&(this._colorCurvesEnabled=e,this._updateParameters())}},{key:"colorGradingTexture",get:function(){return this._colorGradingTexture},set:function(e){this._colorGradingTexture!==e&&(this._colorGradingTexture=e,this._updateParameters())}},{key:"colorGradingEnabled",get:function(){return this._colorGradingEnabled},set:function(e){this._colorGradingEnabled!==e&&(this._colorGradingEnabled=e,this._updateParameters())}},{key:"colorGradingWithGreenDepth",get:function(){return this._colorGradingWithGreenDepth},set:function(e){this._colorGradingWithGreenDepth!==e&&(this._colorGradingWithGreenDepth=e,this._updateParameters())}},{key:"colorGradingBGR",get:function(){return this._colorGradingBGR},set:function(e){this._colorGradingBGR!==e&&(this._colorGradingBGR=e,this._updateParameters())}},{key:"exposure",get:function(){return this._exposure},set:function(e){this._exposure!==e&&(this._exposure=e,this._updateParameters())}},{key:"toneMappingEnabled",get:function(){return this._toneMappingEnabled},set:function(e){this._toneMappingEnabled!==e&&(this._toneMappingEnabled=e,this._updateParameters())}},{key:"toneMappingType",get:function(){return this._toneMappingType},set:function(e){this._toneMappingType!==e&&(this._toneMappingType=e,this._updateParameters())}},{key:"contrast",get:function(){return this._contrast},set:function(e){this._contrast!==e&&(this._contrast=e,this._updateParameters())}},{key:"vignetteBlendMode",get:function(){return this._vignetteBlendMode},set:function(e){this._vignetteBlendMode!==e&&(this._vignetteBlendMode=e,this._updateParameters())}},{key:"vignetteEnabled",get:function(){return this._vignetteEnabled},set:function(e){this._vignetteEnabled!==e&&(this._vignetteEnabled=e,this._updateParameters())}},{key:"ditheringEnabled",get:function(){return this._ditheringEnabled},set:function(e){this._ditheringEnabled!==e&&(this._ditheringEnabled=e,this._updateParameters())}},{key:"ditheringIntensity",get:function(){return this._ditheringIntensity},set:function(e){this._ditheringIntensity!==e&&(this._ditheringIntensity=e,this._updateParameters())}},{key:"skipFinalColorClamp",get:function(){return this._skipFinalColorClamp},set:function(e){this._skipFinalColorClamp!==e&&(this._skipFinalColorClamp=e,this._updateParameters())}},{key:"applyByPostProcess",get:function(){return this._applyByPostProcess},set:function(e){this._applyByPostProcess!==e&&(this._applyByPostProcess=e,this._updateParameters())}},{key:"isEnabled",get:function(){return this._isEnabled},set:function(e){this._isEnabled!==e&&(this._isEnabled=e,this._updateParameters())}},{key:"_updateParameters",value:function(){this.onUpdateParameters.notifyObservers(this)}},{key:"getClassName",value:function(){return"ImageProcessingConfiguration"}},{key:"prepareDefines",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(n!==this.applyByPostProcess||!this._isEnabled)return t.VIGNETTE=!1,t.TONEMAPPING=!1,t.TONEMAPPING_ACES=!1,t.CONTRAST=!1,t.EXPOSURE=!1,t.COLORCURVES=!1,t.COLORGRADING=!1,t.COLORGRADING3D=!1,t.DITHER=!1,t.IMAGEPROCESSING=!1,t.SKIPFINALCOLORCLAMP=this.skipFinalColorClamp,void(t.IMAGEPROCESSINGPOSTPROCESS=this.applyByPostProcess&&this._isEnabled);if(t.VIGNETTE=this.vignetteEnabled,t.VIGNETTEBLENDMODEMULTIPLY=this.vignetteBlendMode===e._VIGNETTEMODE_MULTIPLY,t.VIGNETTEBLENDMODEOPAQUE=!t.VIGNETTEBLENDMODEMULTIPLY,t.TONEMAPPING=this.toneMappingEnabled,this._toneMappingType===e.TONEMAPPING_ACES)t.TONEMAPPING_ACES=!0;else t.TONEMAPPING_ACES=!1;t.CONTRAST=1!==this.contrast,t.EXPOSURE=1!==this.exposure,t.COLORCURVES=this.colorCurvesEnabled&&!!this.colorCurves,t.COLORGRADING=this.colorGradingEnabled&&!!this.colorGradingTexture,t.COLORGRADING?t.COLORGRADING3D=this.colorGradingTexture.is3D:t.COLORGRADING3D=!1,t.SAMPLER3DGREENDEPTH=this.colorGradingWithGreenDepth,t.SAMPLER3DBGRMAP=this.colorGradingBGR,t.DITHER=this._ditheringEnabled,t.IMAGEPROCESSINGPOSTPROCESS=this.applyByPostProcess,t.SKIPFINALCOLORCLAMP=this.skipFinalColorClamp,t.IMAGEPROCESSING=t.VIGNETTE||t.TONEMAPPING||t.CONTRAST||t.EXPOSURE||t.COLORCURVES||t.COLORGRADING||t.DITHER}},{key:"isReady",value:function(){return!this.colorGradingEnabled||!this.colorGradingTexture||this.colorGradingTexture.isReady()}},{key:"bind",value:function(e,t){if(this._colorCurvesEnabled&&this.colorCurves&&c.Bind(this.colorCurves,e),this._vignetteEnabled||this._ditheringEnabled){var n=1/e.getEngine().getRenderWidth(),i=1/e.getEngine().getRenderHeight();if(e.setFloat2("vInverseScreenSize",n,i),this._ditheringEnabled&&e.setFloat("ditherIntensity",.5*this._ditheringIntensity),this._vignetteEnabled){var r=null!=t?t:i/n,a=Math.tan(.5*this.vignetteCameraFov),o=a*r,s=Math.sqrt(o*a);o=u.w1.Mix(o,s,this.vignetteStretch),a=u.w1.Mix(a,s,this.vignetteStretch),e.setFloat4("vignetteSettings1",o,a,-o*this.vignetteCentreX,-a*this.vignetteCentreY);var l=-2*this.vignetteWeight;e.setFloat4("vignetteSettings2",this.vignetteColor.r,this.vignetteColor.g,this.vignetteColor.b,l)}}if(e.setFloat("exposureLinear",this.exposure),e.setFloat("contrast",this.contrast),this.colorGradingTexture){e.setTexture("txColorTransform",this.colorGradingTexture);var h=this.colorGradingTexture.getSize().height;e.setFloat4("colorTransformSettings",(h-1)/h,.5/h,h,this.colorGradingTexture.level)}}},{key:"clone",value:function(){return o.p4.Clone((function(){return new e}),this)}},{key:"serialize",value:function(){return o.p4.Serialize(this)}}],[{key:"PrepareUniforms",value:function(e,t){t.EXPOSURE&&e.push("exposureLinear"),t.CONTRAST&&e.push("contrast"),t.COLORGRADING&&e.push("colorTransformSettings"),(t.VIGNETTE||t.DITHER)&&e.push("vInverseScreenSize"),t.VIGNETTE&&(e.push("vignetteSettings1"),e.push("vignetteSettings2")),t.COLORCURVES&&c.PrepareUniforms(e),t.DITHER&&e.push("ditherIntensity")}},{key:"PrepareSamplers",value:function(e,t){t.COLORGRADING&&e.push("txColorTransform")}},{key:"Parse",value:function(t){return o.p4.Parse((function(){return new e}),t,null,null)}},{key:"VIGNETTEMODE_MULTIPLY",get:function(){return this._VIGNETTEMODE_MULTIPLY}},{key:"VIGNETTEMODE_OPAQUE",get:function(){return this._VIGNETTEMODE_OPAQUE}}]),e}();h.TONEMAPPING_STANDARD=0,h.TONEMAPPING_ACES=1,h._VIGNETTEMODE_MULTIPLY=0,h._VIGNETTEMODE_OPAQUE=1,(0,a.gn)([(0,o.N$)()],h.prototype,"colorCurves",void 0),(0,a.gn)([(0,o.qC)()],h.prototype,"_colorCurvesEnabled",void 0),(0,a.gn)([(0,o.oU)("colorGradingTexture")],h.prototype,"_colorGradingTexture",void 0),(0,a.gn)([(0,o.qC)()],h.prototype,"_colorGradingEnabled",void 0),(0,a.gn)([(0,o.qC)()],h.prototype,"_colorGradingWithGreenDepth",void 0),(0,a.gn)([(0,o.qC)()],h.prototype,"_colorGradingBGR",void 0),(0,a.gn)([(0,o.qC)()],h.prototype,"_exposure",void 0),(0,a.gn)([(0,o.qC)()],h.prototype,"_toneMappingEnabled",void 0),(0,a.gn)([(0,o.qC)()],h.prototype,"_toneMappingType",void 0),(0,a.gn)([(0,o.qC)()],h.prototype,"_contrast",void 0),(0,a.gn)([(0,o.qC)()],h.prototype,"vignetteStretch",void 0),(0,a.gn)([(0,o.qC)()],h.prototype,"vignetteCentreX",void 0),(0,a.gn)([(0,o.qC)()],h.prototype,"vignetteCentreY",void 0),(0,a.gn)([(0,o.qC)()],h.prototype,"vignetteWeight",void 0),(0,a.gn)([(0,o.XX)()],h.prototype,"vignetteColor",void 0),(0,a.gn)([(0,o.qC)()],h.prototype,"vignetteCameraFov",void 0),(0,a.gn)([(0,o.qC)()],h.prototype,"_vignetteBlendMode",void 0),(0,a.gn)([(0,o.qC)()],h.prototype,"_vignetteEnabled",void 0),(0,a.gn)([(0,o.qC)()],h.prototype,"_ditheringEnabled",void 0),(0,a.gn)([(0,o.qC)()],h.prototype,"_ditheringIntensity",void 0),(0,a.gn)([(0,o.qC)()],h.prototype,"_skipFinalColorClamp",void 0),(0,a.gn)([(0,o.qC)()],h.prototype,"_applyByPostProcess",void 0),(0,a.gn)([(0,o.qC)()],h.prototype,"_isEnabled",void 0),o.p4._ImageProcessingConfigurationParser=h.Parse},6556:function(e,t,n){"use strict";n.d(t,{F:function(){return b}});var i=n(4942),r=n(5671),a=n(3144),o=n(9477),s=n(9336),u=n(8517),l=n(4174),c=n(4198),h=n(65),f=n(1952),d=n(2328),p=n(3683),v=n(114),m=n(8618),g=function(){function e(){(0,r.Z)(this,e),this.reset()}return(0,a.Z)(e,[{key:"reset",value:function(){this.enabled=!1,this.mask=255,this.func=519,this.funcRef=1,this.funcMask=255,this.opStencilFail=7680,this.opDepthFail=7680,this.opStencilDepthPass=7681}},{key:"func",get:function(){return this._func},set:function(e){this._func=e}},{key:"funcRef",get:function(){return this._funcRef},set:function(e){this._funcRef=e}},{key:"funcMask",get:function(){return this._funcMask},set:function(e){this._funcMask=e}},{key:"opStencilFail",get:function(){return this._opStencilFail},set:function(e){this._opStencilFail=e}},{key:"opDepthFail",get:function(){return this._opDepthFail},set:function(e){this._opDepthFail=e}},{key:"opStencilDepthPass",get:function(){return this._opStencilDepthPass},set:function(e){this._opStencilDepthPass=e}},{key:"mask",get:function(){return this._mask},set:function(e){this._mask=e}},{key:"enabled",get:function(){return this._enabled},set:function(e){this._enabled=e}},{key:"getClassName",value:function(){return"MaterialStencilState"}},{key:"copyTo",value:function(e){s.p4.Clone((function(){return e}),this)}},{key:"serialize",value:function(){return s.p4.Serialize(this)}},{key:"parse",value:function(e,t,n){var i=this;s.p4.Parse((function(){return i}),e,t,n)}}]),e}();(0,o.gn)([(0,s.qC)()],g.prototype,"func",null),(0,o.gn)([(0,s.qC)()],g.prototype,"funcRef",null),(0,o.gn)([(0,s.qC)()],g.prototype,"funcMask",null),(0,o.gn)([(0,s.qC)()],g.prototype,"opStencilFail",null),(0,o.gn)([(0,s.qC)()],g.prototype,"opDepthFail",null),(0,o.gn)([(0,s.qC)()],g.prototype,"opStencilDepthPass",null),(0,o.gn)([(0,s.qC)()],g.prototype,"mask",null),(0,o.gn)([(0,s.qC)()],g.prototype,"enabled",null);var _=n(4071);function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function E(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return A(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return A(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var b=function(){function e(t,n,i){(0,r.Z)(this,e),this.shadowDepthWrapper=null,this.allowShaderHotSwapping=!0,this.metadata=null,this.reservedDataStore=null,this.checkReadyOnEveryCall=!1,this.checkReadyOnlyOnce=!1,this.state="",this._alpha=1,this._backFaceCulling=!0,this._cullBackFaces=!0,this.onCompiled=null,this.onError=null,this.getRenderTargetTextures=null,this.doNotSerialize=!1,this._storeEffectOnSubMeshes=!1,this.animations=null,this.onDisposeObservable=new l.y$,this._onDisposeObserver=null,this._onUnBindObservable=null,this._onBindObserver=null,this._alphaMode=2,this._needDepthPrePass=!1,this.disableDepthWrite=!1,this.disableColorWrite=!1,this.forceDepthWrite=!1,this.depthFunction=0,this.separateCullingPass=!1,this._fogEnabled=!0,this.pointSize=1,this.zOffset=0,this.zOffsetUnits=0,this.stencil=new g,this._useUBO=!1,this._fillMode=e.TriangleFillMode,this._cachedDepthWriteState=!1,this._cachedColorWriteState=!1,this._cachedDepthFunctionState=0,this._indexInSceneMaterialArray=-1,this.meshMap=null,this._parentContainer=null,this._uniformBufferLayoutBuilt=!1,this._eventInfo={},this._callbackPluginEventGeneric=function(){},this._callbackPluginEventIsReadyForSubMesh=function(){},this._callbackPluginEventPrepareDefines=function(){},this._callbackPluginEventPrepareDefinesBeforeAttributes=function(){},this._callbackPluginEventHardBindForSubMesh=function(){},this._callbackPluginEventBindForSubMesh=function(){},this._callbackPluginEventHasRenderTargetTextures=function(){},this._callbackPluginEventFillRenderTargetTextures=function(){},this._forceAlphaTest=!1,this._transparencyMode=null,this.name=t;var a=n||c.l.LastCreatedScene;a&&(this._scene=a,this._dirtyCallbacks={},this._dirtyCallbacks[1]=this._markAllSubMeshesAsTexturesDirty.bind(this),this._dirtyCallbacks[2]=this._markAllSubMeshesAsLightsDirty.bind(this),this._dirtyCallbacks[4]=this._markAllSubMeshesAsFresnelDirty.bind(this),this._dirtyCallbacks[8]=this._markAllSubMeshesAsAttributesDirty.bind(this),this._dirtyCallbacks[16]=this._markAllSubMeshesAsMiscDirty.bind(this),this._dirtyCallbacks[32]=this._markAllSubMeshesAsPrePassDirty.bind(this),this._dirtyCallbacks[63]=this._markAllSubMeshesAsAllDirty.bind(this),this.id=t||u.w1.RandomId(),this.uniqueId=this._scene.getUniqueId(),this._materialContext=this._scene.getEngine().createMaterialContext(),this._drawWrapper=new m.q(this._scene.getEngine(),!1),this._drawWrapper.materialContext=this._materialContext,this._scene.useRightHandedSystem?this.sideOrientation=e.ClockWiseSideOrientation:this.sideOrientation=e.CounterClockWiseSideOrientation,this._uniformBuffer=new f.M(this._scene.getEngine(),void 0,void 0,t),this._useUBO=this.getScene().getEngine().supportsUniformBuffers,i||this._scene.addMaterial(this),this._scene.useMaterialMeshMap&&(this.meshMap={}),e.OnEventObservable.notifyObservers(this,_.S.Created))}return(0,a.Z)(e,[{key:"canRenderToMRT",get:function(){return!1}},{key:"alpha",get:function(){return this._alpha},set:function(t){if(this._alpha!==t){var n=this._alpha;this._alpha=t,1!==n&&1!==t||this.markAsDirty(e.MiscDirtyFlag)}}},{key:"backFaceCulling",get:function(){return this._backFaceCulling},set:function(t){this._backFaceCulling!==t&&(this._backFaceCulling=t,this.markAsDirty(e.TextureDirtyFlag))}},{key:"cullBackFaces",get:function(){return this._cullBackFaces},set:function(t){this._cullBackFaces!==t&&(this._cullBackFaces=t,this.markAsDirty(e.TextureDirtyFlag))}},{key:"hasRenderTargetTextures",get:function(){return this._eventInfo.hasRenderTargetTextures=!1,this._callbackPluginEventHasRenderTargetTextures(this._eventInfo),this._eventInfo.hasRenderTargetTextures}},{key:"onDispose",set:function(e){this._onDisposeObserver&&this.onDisposeObservable.remove(this._onDisposeObserver),this._onDisposeObserver=this.onDisposeObservable.add(e)}},{key:"onBindObservable",get:function(){return this._onBindObservable||(this._onBindObservable=new l.y$),this._onBindObservable}},{key:"onBind",set:function(e){this._onBindObserver&&this.onBindObservable.remove(this._onBindObserver),this._onBindObserver=this.onBindObservable.add(e)}},{key:"onUnBindObservable",get:function(){return this._onUnBindObservable||(this._onUnBindObservable=new l.y$),this._onUnBindObservable}},{key:"onEffectCreatedObservable",get:function(){return this._onEffectCreatedObservable||(this._onEffectCreatedObservable=new l.y$),this._onEffectCreatedObservable}},{key:"alphaMode",get:function(){return this._alphaMode},set:function(t){this._alphaMode!==t&&(this._alphaMode=t,this.markAsDirty(e.TextureDirtyFlag))}},{key:"needDepthPrePass",get:function(){return this._needDepthPrePass},set:function(e){this._needDepthPrePass!==e&&(this._needDepthPrePass=e,this._needDepthPrePass&&(this.checkReadyOnEveryCall=!0))}},{key:"isPrePassCapable",get:function(){return!1}},{key:"fogEnabled",get:function(){return this._fogEnabled},set:function(t){this._fogEnabled!==t&&(this._fogEnabled=t,this.markAsDirty(e.MiscDirtyFlag))}},{key:"wireframe",get:function(){switch(this._fillMode){case e.WireFrameFillMode:case e.LineListDrawMode:case e.LineLoopDrawMode:case e.LineStripDrawMode:return!0}return this._scene.forceWireframe},set:function(t){this.fillMode=t?e.WireFrameFillMode:e.TriangleFillMode}},{key:"pointsCloud",get:function(){switch(this._fillMode){case e.PointFillMode:case e.PointListDrawMode:return!0}return this._scene.forcePointsCloud},set:function(t){this.fillMode=t?e.PointFillMode:e.TriangleFillMode}},{key:"fillMode",get:function(){return this._fillMode},set:function(t){this._fillMode!==t&&(this._fillMode=t,this.markAsDirty(e.MiscDirtyFlag))}},{key:"_getDrawWrapper",value:function(){return this._drawWrapper}},{key:"_setDrawWrapper",value:function(e){this._drawWrapper=e}},{key:"toString",value:function(e){return"Name: "+this.name}},{key:"getClassName",value:function(){return"Material"}},{key:"isFrozen",get:function(){return this.checkReadyOnlyOnce}},{key:"freeze",value:function(){this.markDirty(),this.checkReadyOnlyOnce=!0}},{key:"unfreeze",value:function(){this.markDirty(),this.checkReadyOnlyOnce=!1}},{key:"isReady",value:function(e,t){return!0}},{key:"isReadyForSubMesh",value:function(e,t,n){var i=t.materialDefines;return!!i&&(this._eventInfo.isReadyForSubMesh=!0,this._eventInfo.defines=i,this._callbackPluginEventIsReadyForSubMesh(this._eventInfo),this._eventInfo.isReadyForSubMesh)}},{key:"getEffect",value:function(){return this._drawWrapper.effect}},{key:"getScene",value:function(){return this._scene}},{key:"transparencyMode",get:function(){return this._transparencyMode},set:function(t){this._transparencyMode!==t&&(this._transparencyMode=t,this._forceAlphaTest=t===e.MATERIAL_ALPHATESTANDBLEND,this._markAllSubMeshesAsTexturesAndMiscDirty())}},{key:"_disableAlphaBlending",get:function(){return this._transparencyMode===e.MATERIAL_OPAQUE||this._transparencyMode===e.MATERIAL_ALPHATEST}},{key:"needAlphaBlending",value:function(){return!this._disableAlphaBlending&&this.alpha<1}},{key:"needAlphaBlendingForMesh",value:function(e){return!(this._disableAlphaBlending&&e.visibility>=1)&&(this.needAlphaBlending()||e.visibility<1||e.hasVertexAlpha)}},{key:"needAlphaTesting",value:function(){return!!this._forceAlphaTest}},{key:"_shouldTurnAlphaTestOn",value:function(e){return!this.needAlphaBlendingForMesh(e)&&this.needAlphaTesting()}},{key:"getAlphaTestTexture",value:function(){return null}},{key:"markDirty",value:function(){var e,t=E(this.getScene().meshes);try{for(t.s();!(e=t.n()).done;){var n=e.value;if(n.subMeshes){var i,r=E(n.subMeshes);try{for(r.s();!(i=r.n()).done;){var a=i.value;a.getMaterial()===this&&(a.effect&&(a.effect._wasPreviouslyReady=!1,a.effect._wasPreviouslyUsingInstances=null))}}catch(o){r.e(o)}finally{r.f()}}}}catch(o){t.e(o)}finally{t.f()}}},{key:"_preBind",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=this._scene.getEngine(),r=null==n?this.sideOrientation:n,a=r===e.ClockWiseSideOrientation;return i.enableEffect(t||this._getDrawWrapper()),i.setState(this.backFaceCulling,this.zOffset,!1,a,this.cullBackFaces,this.stencil,this.zOffsetUnits),a}},{key:"bind",value:function(e,t){}},{key:"buildUniformLayout",value:function(){var e=this._uniformBuffer;this._eventInfo.ubo=e,this._callbackPluginEventGeneric(_.S.PrepareUniformBuffer,this._eventInfo),e.create(),this._uniformBufferLayoutBuilt=!0}},{key:"bindForSubMesh",value:function(e,t,n){n.effect&&(this._eventInfo.subMesh=n,this._callbackPluginEventBindForSubMesh(this._eventInfo))}},{key:"bindOnlyWorldMatrix",value:function(e){}},{key:"bindView",value:function(e){this._useUBO?this._needToBindSceneUbo=!0:e.setMatrix("view",this.getScene().getViewMatrix())}},{key:"bindViewProjection",value:function(e){this._useUBO?this._needToBindSceneUbo=!0:(e.setMatrix("viewProjection",this.getScene().getTransformMatrix()),e.setMatrix("projection",this.getScene().getProjectionMatrix()))}},{key:"bindEyePosition",value:function(e,t){this._useUBO?this._needToBindSceneUbo=!0:this._scene.bindEyePosition(e,t)}},{key:"_afterBind",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this._scene._cachedMaterial=this,this._needToBindSceneUbo&&t&&(this._needToBindSceneUbo=!1,v.G.BindSceneUniformBuffer(t,this.getScene().getSceneUniformBuffer()),this._scene.finalizeSceneUbo()),this._scene._cachedVisibility=e?e.visibility:1,this._onBindObservable&&e&&this._onBindObservable.notifyObservers(e),this.disableDepthWrite){var n=this._scene.getEngine();this._cachedDepthWriteState=n.getDepthWrite(),n.setDepthWrite(!1)}if(this.disableColorWrite){var i=this._scene.getEngine();this._cachedColorWriteState=i.getColorWrite(),i.setColorWrite(!1)}if(0!==this.depthFunction){var r=this._scene.getEngine();this._cachedDepthFunctionState=r.getDepthFunction()||0,r.setDepthFunction(this.depthFunction)}}},{key:"unbind",value:function(){(this._onUnBindObservable&&this._onUnBindObservable.notifyObservers(this),0!==this.depthFunction)&&this._scene.getEngine().setDepthFunction(this._cachedDepthFunctionState);this.disableDepthWrite&&this._scene.getEngine().setDepthWrite(this._cachedDepthWriteState);this.disableColorWrite&&this._scene.getEngine().setColorWrite(this._cachedColorWriteState)}},{key:"getAnimatables",value:function(){return this._eventInfo.animatables=[],this._callbackPluginEventGeneric(_.S.GetAnimatables,this._eventInfo),this._eventInfo.animatables}},{key:"getActiveTextures",value:function(){return this._eventInfo.activeTextures=[],this._callbackPluginEventGeneric(_.S.GetActiveTextures,this._eventInfo),this._eventInfo.activeTextures}},{key:"hasTexture",value:function(e){return this._eventInfo.hasTexture=!1,this._eventInfo.texture=e,this._callbackPluginEventGeneric(_.S.HasTexture,this._eventInfo),this._eventInfo.hasTexture}},{key:"clone",value:function(e){return null}},{key:"getBindedMeshes",value:function(){var e=this;if(this.meshMap){var t=new Array;for(var n in this.meshMap){var i=this.meshMap[n];i&&t.push(i)}return t}return this._scene.meshes.filter((function(t){return t.material===e}))}},{key:"forceCompilation",value:function(e,t,n,r){var a=this,o=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({clipPlane:!1,useInstances:!1},n),s=this.getScene(),u=this.allowShaderHotSwapping;this.allowShaderHotSwapping=!1;!function n(){if(a._scene&&a._scene.getEngine()){var i=s.clipPlane;if(o.clipPlane&&(s.clipPlane=new p.J(0,0,0,1)),a._storeEffectOnSubMeshes){var l=!0,c=null;if(e.subMeshes){var f=new h.P(0,0,0,0,0,e,void 0,!1,!1);f.materialDefines&&(f.materialDefines._renderId=-1),a.isReadyForSubMesh(e,f,o.useInstances)||(f.effect&&f.effect.getCompilationError()&&f.effect.allFallbacksProcessed()?c=f.effect.getCompilationError():(l=!1,setTimeout(n,16)))}l&&(a.allowShaderHotSwapping=u,c&&r&&r(c),t&&t(a))}else a.isReady()?(a.allowShaderHotSwapping=u,t&&t(a)):setTimeout(n,16);o.clipPlane&&(s.clipPlane=i)}}()}},{key:"forceCompilationAsync",value:function(e,t){var n=this;return new Promise((function(i,r){n.forceCompilation(e,(function(){i()}),t,(function(e){r(e)}))}))}},{key:"markAsDirty",value:function(t){this.getScene().blockMaterialDirtyMechanism||(e._DirtyCallbackArray.length=0,t&e.TextureDirtyFlag&&e._DirtyCallbackArray.push(e._TextureDirtyCallBack),t&e.LightDirtyFlag&&e._DirtyCallbackArray.push(e._LightsDirtyCallBack),t&e.FresnelDirtyFlag&&e._DirtyCallbackArray.push(e._FresnelDirtyCallBack),t&e.AttributesDirtyFlag&&e._DirtyCallbackArray.push(e._AttributeDirtyCallBack),t&e.MiscDirtyFlag&&e._DirtyCallbackArray.push(e._MiscDirtyCallBack),t&e.PrePassDirtyFlag&&e._DirtyCallbackArray.push(e._PrePassDirtyCallBack),e._DirtyCallbackArray.length&&this._markAllSubMeshesAsDirty(e._RunDirtyCallBacks),this.getScene().resetCachedMaterial())}},{key:"resetDrawCache",value:function(){var e,t=E(this.getScene().meshes);try{for(t.s();!(e=t.n()).done;){var n=e.value;if(n.subMeshes){var i,r=E(n.subMeshes);try{for(r.s();!(i=r.n()).done;){var a=i.value;a.getMaterial()===this&&a.resetDrawCache()}}catch(o){r.e(o)}finally{r.f()}}}}catch(o){t.e(o)}finally{t.f()}}},{key:"_markAllSubMeshesAsDirty",value:function(e){if(!this.getScene().blockMaterialDirtyMechanism){var t,n=E(this.getScene().meshes);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(i.subMeshes){var r,a=E(i.subMeshes);try{for(a.s();!(r=a.n()).done;){var o=r.value;if(o.getMaterial(!1)===this){var s,u=E(o._drawWrappers);try{for(u.s();!(s=u.n()).done;){var l=s.value;l&&l.defines&&l.defines.markAllAsDirty&&(this._materialContext===l.materialContext&&e(l.defines))}}catch(c){u.e(c)}finally{u.f()}}}}catch(c){a.e(c)}finally{a.f()}}}}catch(c){n.e(c)}finally{n.f()}}}},{key:"_markScenePrePassDirty",value:function(){if(!this.getScene().blockMaterialDirtyMechanism){var e=this.getScene().enablePrePassRenderer();e&&e.markAsDirty()}}},{key:"_markAllSubMeshesAsAllDirty",value:function(){this._markAllSubMeshesAsDirty(e._AllDirtyCallBack)}},{key:"_markAllSubMeshesAsImageProcessingDirty",value:function(){this._markAllSubMeshesAsDirty(e._ImageProcessingDirtyCallBack)}},{key:"_markAllSubMeshesAsTexturesDirty",value:function(){this._markAllSubMeshesAsDirty(e._TextureDirtyCallBack)}},{key:"_markAllSubMeshesAsFresnelDirty",value:function(){this._markAllSubMeshesAsDirty(e._FresnelDirtyCallBack)}},{key:"_markAllSubMeshesAsFresnelAndMiscDirty",value:function(){this._markAllSubMeshesAsDirty(e._FresnelAndMiscDirtyCallBack)}},{key:"_markAllSubMeshesAsLightsDirty",value:function(){this._markAllSubMeshesAsDirty(e._LightsDirtyCallBack)}},{key:"_markAllSubMeshesAsAttributesDirty",value:function(){this._markAllSubMeshesAsDirty(e._AttributeDirtyCallBack)}},{key:"_markAllSubMeshesAsMiscDirty",value:function(){this._markAllSubMeshesAsDirty(e._MiscDirtyCallBack)}},{key:"_markAllSubMeshesAsPrePassDirty",value:function(){this._markAllSubMeshesAsDirty(e._MiscDirtyCallBack)}},{key:"_markAllSubMeshesAsTexturesAndMiscDirty",value:function(){this._markAllSubMeshesAsDirty(e._TextureAndMiscDirtyCallBack)}},{key:"setPrePassRenderer",value:function(e){return!1}},{key:"dispose",value:function(e,t,n){var i=this.getScene();if(i.stopAnimation(this),i.freeProcessedMaterials(),i.removeMaterial(this),this._eventInfo.forceDisposeTextures=t,this._callbackPluginEventGeneric(_.S.Disposed,this._eventInfo),this._parentContainer){var r=this._parentContainer.materials.indexOf(this);r>-1&&this._parentContainer.materials.splice(r,1),this._parentContainer=null}if(!0!==n)if(this.meshMap)for(var a in this.meshMap){var o=this.meshMap[a];o&&(o.material=null,this.releaseVertexArrayObject(o,e))}else{var s,u=E(i.meshes);try{for(u.s();!(s=u.n()).done;){var l=s.value;l.material!==this||l.sourceMesh||(l.material=null,this.releaseVertexArrayObject(l,e))}}catch(c){u.e(c)}finally{u.f()}}this._uniformBuffer.dispose(),e&&this._drawWrapper.effect&&(this._storeEffectOnSubMeshes||this._drawWrapper.effect.dispose(),this._drawWrapper.effect=null),this.metadata=null,this.onDisposeObservable.notifyObservers(this),this.onDisposeObservable.clear(),this._onBindObservable&&this._onBindObservable.clear(),this._onUnBindObservable&&this._onUnBindObservable.clear(),this._onEffectCreatedObservable&&this._onEffectCreatedObservable.clear()}},{key:"releaseVertexArrayObject",value:function(e,t){if(e.geometry){var n=e.geometry;if(this._storeEffectOnSubMeshes){var i,r=E(e.subMeshes);try{for(r.s();!(i=r.n()).done;){var a=i.value;n._releaseVertexArrayObject(a.effect),t&&a.effect&&a.effect.dispose()}}catch(o){r.e(o)}finally{r.f()}}else n._releaseVertexArrayObject(this._drawWrapper.effect)}}},{key:"serialize",value:function(){var e=s.p4.Serialize(this);return e.stencil=this.stencil.serialize(),e.uniqueId=this.uniqueId,e}}],[{key:"Parse",value:function(e,t,n){if(e.customType){if("BABYLON.PBRMaterial"===e.customType&&e.overloadedAlbedo&&(e.customType="BABYLON.LegacyPBRMaterial",!BABYLON.LegacyPBRMaterial))return d.Y.Error("Your scene is trying to load a legacy version of the PBRMaterial, please, include it from the materials library."),null}else e.customType="BABYLON.StandardMaterial";var i=u.w1.Instantiate(e.customType).Parse(e,t,n);return i._loadedUniqueId=e.uniqueId,i}}]),e}();b.TriangleFillMode=0,b.WireFrameFillMode=1,b.PointFillMode=2,b.PointListDrawMode=3,b.LineListDrawMode=4,b.LineLoopDrawMode=5,b.LineStripDrawMode=6,b.TriangleStripDrawMode=7,b.TriangleFanDrawMode=8,b.ClockWiseSideOrientation=0,b.CounterClockWiseSideOrientation=1,b.TextureDirtyFlag=1,b.LightDirtyFlag=2,b.FresnelDirtyFlag=4,b.AttributesDirtyFlag=8,b.MiscDirtyFlag=16,b.PrePassDirtyFlag=32,b.AllDirtyFlag=63,b.MATERIAL_OPAQUE=0,b.MATERIAL_ALPHATEST=1,b.MATERIAL_ALPHABLEND=2,b.MATERIAL_ALPHATESTANDBLEND=3,b.MATERIAL_NORMALBLENDMETHOD_WHITEOUT=0,b.MATERIAL_NORMALBLENDMETHOD_RNM=1,b.OnEventObservable=new l.y$,b._AllDirtyCallBack=function(e){return e.markAllAsDirty()},b._ImageProcessingDirtyCallBack=function(e){return e.markAsImageProcessingDirty()},b._TextureDirtyCallBack=function(e){return e.markAsTexturesDirty()},b._FresnelDirtyCallBack=function(e){return e.markAsFresnelDirty()},b._MiscDirtyCallBack=function(e){return e.markAsMiscDirty()},b._PrePassDirtyCallBack=function(e){return e.markAsPrePassDirty()},b._LightsDirtyCallBack=function(e){return e.markAsLightDirty()},b._AttributeDirtyCallBack=function(e){return e.markAsAttributesDirty()},b._FresnelAndMiscDirtyCallBack=function(e){b._FresnelDirtyCallBack(e),b._MiscDirtyCallBack(e)},b._TextureAndMiscDirtyCallBack=function(e){b._TextureDirtyCallBack(e),b._MiscDirtyCallBack(e)},b._DirtyCallbackArray=[],b._RunDirtyCallBacks=function(e){var t,n=E(b._DirtyCallbackArray);try{for(n.s();!(t=n.n()).done;){(0,t.value)(e)}}catch(i){n.e(i)}finally{n.f()}},(0,o.gn)([(0,s.qC)()],b.prototype,"id",void 0),(0,o.gn)([(0,s.qC)()],b.prototype,"uniqueId",void 0),(0,o.gn)([(0,s.qC)()],b.prototype,"name",void 0),(0,o.gn)([(0,s.qC)()],b.prototype,"metadata",void 0),(0,o.gn)([(0,s.qC)()],b.prototype,"checkReadyOnEveryCall",void 0),(0,o.gn)([(0,s.qC)()],b.prototype,"checkReadyOnlyOnce",void 0),(0,o.gn)([(0,s.qC)()],b.prototype,"state",void 0),(0,o.gn)([(0,s.qC)("alpha")],b.prototype,"_alpha",void 0),(0,o.gn)([(0,s.qC)("backFaceCulling")],b.prototype,"_backFaceCulling",void 0),(0,o.gn)([(0,s.qC)("cullBackFaces")],b.prototype,"_cullBackFaces",void 0),(0,o.gn)([(0,s.qC)()],b.prototype,"sideOrientation",void 0),(0,o.gn)([(0,s.qC)("alphaMode")],b.prototype,"_alphaMode",void 0),(0,o.gn)([(0,s.qC)()],b.prototype,"_needDepthPrePass",void 0),(0,o.gn)([(0,s.qC)()],b.prototype,"disableDepthWrite",void 0),(0,o.gn)([(0,s.qC)()],b.prototype,"disableColorWrite",void 0),(0,o.gn)([(0,s.qC)()],b.prototype,"forceDepthWrite",void 0),(0,o.gn)([(0,s.qC)()],b.prototype,"depthFunction",void 0),(0,o.gn)([(0,s.qC)()],b.prototype,"separateCullingPass",void 0),(0,o.gn)([(0,s.qC)("fogEnabled")],b.prototype,"_fogEnabled",void 0),(0,o.gn)([(0,s.qC)()],b.prototype,"pointSize",void 0),(0,o.gn)([(0,s.qC)()],b.prototype,"zOffset",void 0),(0,o.gn)([(0,s.qC)()],b.prototype,"zOffsetUnits",void 0),(0,o.gn)([(0,s.qC)()],b.prototype,"pointsCloud",null),(0,o.gn)([(0,s.qC)()],b.prototype,"fillMode",null),(0,o.gn)([(0,s.qC)()],b.prototype,"transparencyMode",null)},4771:function(e,t,n){"use strict";n.d(t,{H:function(){return a}});var i=n(5671),r=n(3144),a=function(){function e(t){if((0,i.Z)(this,e),this._keys=[],this._isDirty=!0,this._areLightsDirty=!0,this._areLightsDisposed=!1,this._areAttributesDirty=!0,this._areTexturesDirty=!0,this._areFresnelDirty=!0,this._areMiscDirty=!0,this._arePrePassDirty=!0,this._areImageProcessingDirty=!0,this._normals=!1,this._uvs=!1,this._needNormals=!1,this._needUVs=!1,this._externalProperties=t,t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&this._setDefaultValue(n)}return(0,r.Z)(e,[{key:"isDirty",get:function(){return this._isDirty}},{key:"markAsProcessed",value:function(){this._isDirty=!1,this._areAttributesDirty=!1,this._areTexturesDirty=!1,this._areFresnelDirty=!1,this._areLightsDirty=!1,this._areLightsDisposed=!1,this._areMiscDirty=!1,this._arePrePassDirty=!1,this._areImageProcessingDirty=!1}},{key:"markAsUnprocessed",value:function(){this._isDirty=!0}},{key:"markAllAsDirty",value:function(){this._areTexturesDirty=!0,this._areAttributesDirty=!0,this._areLightsDirty=!0,this._areFresnelDirty=!0,this._areMiscDirty=!0,this._areImageProcessingDirty=!0,this._isDirty=!0}},{key:"markAsImageProcessingDirty",value:function(){this._areImageProcessingDirty=!0,this._isDirty=!0}},{key:"markAsLightDirty",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._areLightsDirty=!0,this._areLightsDisposed=this._areLightsDisposed||e,this._isDirty=!0}},{key:"markAsAttributesDirty",value:function(){this._areAttributesDirty=!0,this._isDirty=!0}},{key:"markAsTexturesDirty",value:function(){this._areTexturesDirty=!0,this._isDirty=!0}},{key:"markAsFresnelDirty",value:function(){this._areFresnelDirty=!0,this._isDirty=!0}},{key:"markAsMiscDirty",value:function(){this._areMiscDirty=!0,this._isDirty=!0}},{key:"markAsPrePassDirty",value:function(){this._arePrePassDirty=!0,this._isDirty=!0}},{key:"rebuild",value:function(){this._keys.length=0;for(var e=0,t=Object.keys(this);e<t.length;e++){var n=t[e];"_"!==n[0]&&this._keys.push(n)}if(this._externalProperties)for(var i in this._externalProperties)-1===this._keys.indexOf(i)&&this._keys.push(i)}},{key:"isEqual",value:function(e){if(this._keys.length!==e._keys.length)return!1;for(var t=0;t<this._keys.length;t++){var n=this._keys[t];if(this[n]!==e[n])return!1}return!0}},{key:"cloneTo",value:function(e){this._keys.length!==e._keys.length&&(e._keys=this._keys.slice(0));for(var t=0;t<this._keys.length;t++){var n=this._keys[t];e[n]=this[n]}}},{key:"reset",value:function(){var e=this;this._keys.forEach((function(t){return e._setDefaultValue(t)}))}},{key:"_setDefaultValue",value:function(e){var t,n,i,r,a,o=null!==(t=null===(n=this._externalProperties)||void 0===n||null===(i=n[e])||void 0===i?void 0:i.type)&&void 0!==t?t:typeof this[e],s=null===(r=this._externalProperties)||void 0===r||null===(a=r[e])||void 0===a?void 0:a.default;switch(o){case"number":this[e]=null!=s?s:0;break;case"string":this[e]=null!=s?s:"";break;default:this[e]=null!=s&&s}}},{key:"toString",value:function(){for(var e="",t=0;t<this._keys.length;t++){var n=this._keys[t],i=this[n];switch(typeof i){case"number":case"string":e+="#define "+n+" "+i+"\n";break;default:i&&(e+="#define "+n+"\n")}}return e}}]),e}()},114:function(e,t,n){"use strict";n.d(t,{G:function(){return v}});var i=n(5671),r=n(3144),a=n(2328),o=n(7337),s=n(8911),u=n(4198),l=n(2845),c=n(1221),h=n(7046),f=function(){function e(){(0,i.Z)(this,e)}return(0,r.Z)(e,null,[{key:"BindClipPlane",value:function(e,t){if(t.clipPlane){var n=t.clipPlane;e.setFloat4("vClipPlane",n.normal.x,n.normal.y,n.normal.z,n.d)}if(t.clipPlane2){var i=t.clipPlane2;e.setFloat4("vClipPlane2",i.normal.x,i.normal.y,i.normal.z,i.d)}if(t.clipPlane3){var r=t.clipPlane3;e.setFloat4("vClipPlane3",r.normal.x,r.normal.y,r.normal.z,r.d)}if(t.clipPlane4){var a=t.clipPlane4;e.setFloat4("vClipPlane4",a.normal.x,a.normal.y,a.normal.z,a.d)}if(t.clipPlane5){var o=t.clipPlane5;e.setFloat4("vClipPlane5",o.normal.x,o.normal.y,o.normal.z,o.d)}if(t.clipPlane6){var s=t.clipPlane6;e.setFloat4("vClipPlane6",s.normal.x,s.normal.y,s.normal.z,s.d)}}}]),e}();function d(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return p(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var v=function(){function e(){(0,i.Z)(this,e)}return(0,r.Z)(e,null,[{key:"BindSceneUniformBuffer",value:function(e,t){t.bindToEffect(e,"Scene")}},{key:"PrepareDefinesForMergedUV",value:function(e,t,n){t._needUVs=!0,t[n]=!0,e.optimizeUVAllocation&&e.getTextureMatrix().isIdentityAs3x2()?(t[n+"DIRECTUV"]=e.coordinatesIndex+1,t["MAINUV"+(e.coordinatesIndex+1)]=!0):t[n+"DIRECTUV"]=0}},{key:"BindTextureMatrix",value:function(e,t,n){var i=e.getTextureMatrix();t.updateMatrix(n+"Matrix",i)}},{key:"GetFogState",value:function(e,t){return t.fogEnabled&&e.applyFog&&t.fogMode!==s.x.FOGMODE_NONE}},{key:"PrepareDefinesForMisc",value:function(e,t,n,i,r,a,o){o._areMiscDirty&&(o.LOGARITHMICDEPTH=n,o.POINTSIZE=i,o.FOG=r&&this.GetFogState(e,t),o.NONUNIFORMSCALING=e.nonUniformScaling,o.ALPHATEST=a)}},{key:"PrepareDefinesForFrameBoundValues",value:function(e,t,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=!1,s=!1,u=!1,l=!1,c=!1,h=!1,f=!1;s=null==r?void 0!==e.clipPlane&&null!==e.clipPlane:r,u=null==r?void 0!==e.clipPlane2&&null!==e.clipPlane2:r,l=null==r?void 0!==e.clipPlane3&&null!==e.clipPlane3:r,c=null==r?void 0!==e.clipPlane4&&null!==e.clipPlane4:r,h=null==r?void 0!==e.clipPlane5&&null!==e.clipPlane5:r,f=null==r?void 0!==e.clipPlane6&&null!==e.clipPlane6:r,n.CLIPPLANE!==s&&(n.CLIPPLANE=s,o=!0),n.CLIPPLANE2!==u&&(n.CLIPPLANE2=u,o=!0),n.CLIPPLANE3!==l&&(n.CLIPPLANE3=l,o=!0),n.CLIPPLANE4!==c&&(n.CLIPPLANE4=c,o=!0),n.CLIPPLANE5!==h&&(n.CLIPPLANE5=h,o=!0),n.CLIPPLANE6!==f&&(n.CLIPPLANE6=f,o=!0),n.DEPTHPREPASS!==!t.getColorWrite()&&(n.DEPTHPREPASS=!n.DEPTHPREPASS,o=!0),n.INSTANCES!==i&&(n.INSTANCES=i,o=!0),n.INSTANCESCOLOR&&!n.INSTANCES&&(n.INSTANCESCOLOR=!1,o=!0),n.THIN_INSTANCES!==a&&(n.THIN_INSTANCES=a,o=!0),o&&n.markAsUnprocessed()}},{key:"PrepareDefinesForBones",value:function(e,t){if(e.useBones&&e.computeBonesUsingShaders&&e.skeleton){t.NUM_BONE_INFLUENCERS=e.numBoneInfluencers;var n=void 0!==t.BONETEXTURE;if(e.skeleton.isUsingTextureForMatrices&&n)t.BONETEXTURE=!0;else{t.BonesPerMesh=e.skeleton.bones.length+1,t.BONETEXTURE=!n&&void 0;var i=e.getScene().prePassRenderer;if(i&&i.enabled){var r=-1===i.excludedSkinnedMesh.indexOf(e);t.BONES_VELOCITY_ENABLED=r}}}else t.NUM_BONE_INFLUENCERS=0,t.BonesPerMesh=0}},{key:"PrepareDefinesForMorphTargets",value:function(e,t){var n=e.morphTargetManager;n?(t.MORPHTARGETS_UV=n.supportsUVs&&t.UV1,t.MORPHTARGETS_TANGENT=n.supportsTangents&&t.TANGENT,t.MORPHTARGETS_NORMAL=n.supportsNormals&&t.NORMAL,t.MORPHTARGETS=n.numInfluencers>0,t.NUM_MORPH_INFLUENCERS=n.numInfluencers,t.MORPHTARGETS_TEXTURE=n.isUsingTextureForTargets):(t.MORPHTARGETS_UV=!1,t.MORPHTARGETS_TANGENT=!1,t.MORPHTARGETS_NORMAL=!1,t.MORPHTARGETS=!1,t.NUM_MORPH_INFLUENCERS=0)}},{key:"PrepareDefinesForBakedVertexAnimation",value:function(e,t){var n=e.bakedVertexAnimationManager;t.BAKED_VERTEX_ANIMATION_TEXTURE=!(!n||!n.isEnabled)}},{key:"PrepareDefinesForAttributes",value:function(e,t,n,i){var r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],o=!(arguments.length>6&&void 0!==arguments[6])||arguments[6];if(!t._areAttributesDirty&&t._needNormals===t._normals&&t._needUVs===t._uvs)return!1;t._normals=t._needNormals,t._uvs=t._needUVs,t.NORMAL=t._needNormals&&e.isVerticesDataPresent(l.o.NormalKind),t._needNormals&&e.isVerticesDataPresent(l.o.TangentKind)&&(t.TANGENT=!0);for(var s=1;s<=6;++s)t["UV"+s]=!!t._needUVs&&e.isVerticesDataPresent("uv".concat(1===s?"":s));if(n){var u=e.useVertexColors&&e.isVerticesDataPresent(l.o.ColorKind);t.VERTEXCOLOR=u,t.VERTEXALPHA=e.hasVertexAlpha&&u&&a}return e.isVerticesDataPresent(l.o.ColorInstanceKind)&&(e.hasInstances||e.hasThinInstances)&&(t.INSTANCESCOLOR=!0),i&&this.PrepareDefinesForBones(e,t),r&&this.PrepareDefinesForMorphTargets(e,t),o&&this.PrepareDefinesForBakedVertexAnimation(e,t),!0}},{key:"PrepareDefinesForMultiview",value:function(e,t){if(e.activeCamera){var n=t.MULTIVIEW;t.MULTIVIEW=null!==e.activeCamera.outputRenderTarget&&e.activeCamera.outputRenderTarget.getViewCount()>1,t.MULTIVIEW!=n&&t.markAsUnprocessed()}}},{key:"PrepareDefinesForOIT",value:function(e,t,n){var i=t.ORDER_INDEPENDENT_TRANSPARENCY,r=t.ORDER_INDEPENDENT_TRANSPARENCY_16BITS;t.ORDER_INDEPENDENT_TRANSPARENCY=e.useOrderIndependentTransparency&&n,t.ORDER_INDEPENDENT_TRANSPARENCY_16BITS=!e.getEngine().getCaps().textureFloatLinearFiltering,i===t.ORDER_INDEPENDENT_TRANSPARENCY&&r===t.ORDER_INDEPENDENT_TRANSPARENCY_16BITS||t.markAsUnprocessed()}},{key:"PrepareDefinesForPrePass",value:function(e,t,n){var i=t.PREPASS;if(t._arePrePassDirty){var r=[{type:1,define:"PREPASS_POSITION",index:"PREPASS_POSITION_INDEX"},{type:2,define:"PREPASS_VELOCITY",index:"PREPASS_VELOCITY_INDEX"},{type:3,define:"PREPASS_REFLECTIVITY",index:"PREPASS_REFLECTIVITY_INDEX"},{type:0,define:"PREPASS_IRRADIANCE",index:"PREPASS_IRRADIANCE_INDEX"},{type:7,define:"PREPASS_ALBEDO_SQRT",index:"PREPASS_ALBEDO_SQRT_INDEX"},{type:5,define:"PREPASS_DEPTH",index:"PREPASS_DEPTH_INDEX"},{type:6,define:"PREPASS_NORMAL",index:"PREPASS_NORMAL_INDEX"}];if(e.prePassRenderer&&e.prePassRenderer.enabled&&n){t.PREPASS=!0,t.SCENE_MRT_COUNT=e.prePassRenderer.mrtCount;for(var a=0;a<r.length;a++){var o=e.prePassRenderer.getIndex(r[a].type);-1!==o?(t[r[a].define]=!0,t[r[a].index]=o):t[r[a].define]=!1}}else{t.PREPASS=!1;for(var s=0;s<r.length;s++)t[r[s].define]=!1}t.PREPASS!=i&&(t.markAsUnprocessed(),t.markAsImageProcessingDirty())}}},{key:"PrepareDefinesForLight",value:function(e,t,n,i,r,a,o){switch(o.needNormals=!0,void 0===r["LIGHT"+i]&&(o.needRebuild=!0),r["LIGHT"+i]=!0,r["SPOTLIGHT"+i]=!1,r["HEMILIGHT"+i]=!1,r["POINTLIGHT"+i]=!1,r["DIRLIGHT"+i]=!1,n.prepareLightSpecificDefines(r,i),r["LIGHT_FALLOFF_PHYSICAL"+i]=!1,r["LIGHT_FALLOFF_GLTF"+i]=!1,r["LIGHT_FALLOFF_STANDARD"+i]=!1,n.falloffType){case c.m.FALLOFF_GLTF:r["LIGHT_FALLOFF_GLTF"+i]=!0;break;case c.m.FALLOFF_PHYSICAL:r["LIGHT_FALLOFF_PHYSICAL"+i]=!0;break;case c.m.FALLOFF_STANDARD:r["LIGHT_FALLOFF_STANDARD"+i]=!0}if(a&&!n.specular.equalsFloats(0,0,0)&&(o.specularEnabled=!0),r["SHADOW"+i]=!1,r["SHADOWCSM"+i]=!1,r["SHADOWCSMDEBUG"+i]=!1,r["SHADOWCSMNUM_CASCADES"+i]=!1,r["SHADOWCSMUSESHADOWMAXZ"+i]=!1,r["SHADOWCSMNOBLEND"+i]=!1,r["SHADOWCSM_RIGHTHANDED"+i]=!1,r["SHADOWPCF"+i]=!1,r["SHADOWPCSS"+i]=!1,r["SHADOWPOISSON"+i]=!1,r["SHADOWESM"+i]=!1,r["SHADOWCLOSEESM"+i]=!1,r["SHADOWCUBE"+i]=!1,r["SHADOWLOWQUALITY"+i]=!1,r["SHADOWMEDIUMQUALITY"+i]=!1,t&&t.receiveShadows&&e.shadowsEnabled&&n.shadowEnabled){var s=n.getShadowGenerator();if(s){var u=s.getShadowMap();u&&u.renderList&&u.renderList.length>0&&(o.shadowEnabled=!0,s.prepareDefines(r,i))}}n.lightmapMode!=c.m.LIGHTMAP_DEFAULT?(o.lightmapMode=!0,r["LIGHTMAPEXCLUDED"+i]=!0,r["LIGHTMAPNOSPECULAR"+i]=n.lightmapMode==c.m.LIGHTMAP_SHADOWSONLY):(r["LIGHTMAPEXCLUDED"+i]=!1,r["LIGHTMAPNOSPECULAR"+i]=!1)}},{key:"PrepareDefinesForLights",value:function(e,t,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:4,a=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(!n._areLightsDirty)return n._needNormals;var o=0,s={needNormals:n._needNormals,needRebuild:!1,lightmapMode:!1,shadowEnabled:!1,specularEnabled:!1};if(e.lightsEnabled&&!a){var u,l=d(t.lightSources);try{for(l.s();!(u=l.n()).done;){var c=u.value;if(this.PrepareDefinesForLight(e,t,c,o,n,i,s),++o===r)break}}catch(p){l.e(p)}finally{l.f()}}n.SPECULARTERM=s.specularEnabled,n.SHADOWS=s.shadowEnabled;for(var h=o;h<r;h++)void 0!==n["LIGHT"+h]&&(n["LIGHT"+h]=!1,n["HEMILIGHT"+h]=!1,n["POINTLIGHT"+h]=!1,n["DIRLIGHT"+h]=!1,n["SPOTLIGHT"+h]=!1,n["SHADOW"+h]=!1,n["SHADOWCSM"+h]=!1,n["SHADOWCSMDEBUG"+h]=!1,n["SHADOWCSMNUM_CASCADES"+h]=!1,n["SHADOWCSMUSESHADOWMAXZ"+h]=!1,n["SHADOWCSMNOBLEND"+h]=!1,n["SHADOWCSM_RIGHTHANDED"+h]=!1,n["SHADOWPCF"+h]=!1,n["SHADOWPCSS"+h]=!1,n["SHADOWPOISSON"+h]=!1,n["SHADOWESM"+h]=!1,n["SHADOWCLOSEESM"+h]=!1,n["SHADOWCUBE"+h]=!1,n["SHADOWLOWQUALITY"+h]=!1,n["SHADOWMEDIUMQUALITY"+h]=!1);var f=e.getEngine().getCaps();return void 0===n.SHADOWFLOAT&&(s.needRebuild=!0),n.SHADOWFLOAT=s.shadowEnabled&&(f.textureFloatRender&&f.textureFloatLinearFiltering||f.textureHalfFloatRender&&f.textureHalfFloatLinearFiltering),n.LIGHTMAPEXCLUDED=s.lightmapMode,s.needRebuild&&n.rebuild(),s.needNormals}},{key:"PrepareUniformsAndSamplersForLight",value:function(e,t,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]&&arguments[5];r&&r.push("Light"+e),a||(t.push("vLightData"+e,"vLightDiffuse"+e,"vLightSpecular"+e,"vLightDirection"+e,"vLightFalloff"+e,"vLightGround"+e,"lightMatrix"+e,"shadowsInfo"+e,"depthValues"+e),n.push("shadowSampler"+e),n.push("depthSampler"+e),t.push("viewFrustumZ"+e,"cascadeBlendFactor"+e,"lightSizeUVCorrection"+e,"depthCorrection"+e,"penumbraDarkness"+e,"frustumLengths"+e),i&&(n.push("projectionLightSampler"+e),t.push("textureProjectionMatrix"+e)))}},{key:"PrepareUniformsAndSamplersList",value:function(e,t,n){var i,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:4,a=null;if(e.uniformsNames){var o=e;i=o.uniformsNames,a=o.uniformBuffersNames,t=o.samplers,n=o.defines,r=o.maxSimultaneousLights||0}else i=e,t||(t=[]);for(var s=0;s<r&&n["LIGHT"+s];s++)this.PrepareUniformsAndSamplersForLight(s,i,t,n["PROJECTEDLIGHTTEXTURE"+s],a);n.NUM_MORPH_INFLUENCERS&&i.push("morphTargetInfluences"),n.BAKED_VERTEX_ANIMATION_TEXTURE&&(i.push("bakedVertexAnimationSettings"),i.push("bakedVertexAnimationTextureSizeInverted"),i.push("bakedVertexAnimationTime"),t.push("bakedVertexAnimationTexture"))}},{key:"HandleFallbacksForShadows",value:function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=0,a=0;a<n&&e["LIGHT"+a];a++)a>0&&(r=i+a,t.addFallback(r,"LIGHT"+a)),e.SHADOWS||(e["SHADOW"+a]&&t.addFallback(i,"SHADOW"+a),e["SHADOWPCF"+a]&&t.addFallback(i,"SHADOWPCF"+a),e["SHADOWPCSS"+a]&&t.addFallback(i,"SHADOWPCSS"+a),e["SHADOWPOISSON"+a]&&t.addFallback(i,"SHADOWPOISSON"+a),e["SHADOWESM"+a]&&t.addFallback(i,"SHADOWESM"+a),e["SHADOWCLOSEESM"+a]&&t.addFallback(i,"SHADOWCLOSEESM"+a));return r++}},{key:"PrepareAttributesForMorphTargetsInfluencers",value:function(e,t,n){this._TmpMorphInfluencers.NUM_MORPH_INFLUENCERS=n,this.PrepareAttributesForMorphTargets(e,t,this._TmpMorphInfluencers)}},{key:"PrepareAttributesForMorphTargets",value:function(e,t,n){var i=n.NUM_MORPH_INFLUENCERS;if(i>0&&u.l.LastCreatedEngine){var r=u.l.LastCreatedEngine.getCaps().maxVertexAttribs,o=t.morphTargetManager;if(null!=o&&o.isUsingTextureForTargets)return;for(var s=o&&o.supportsNormals&&n.NORMAL,c=o&&o.supportsTangents&&n.TANGENT,h=o&&o.supportsUVs&&n.UV1,f=0;f<i;f++)e.push(l.o.PositionKind+f),s&&e.push(l.o.NormalKind+f),c&&e.push(l.o.TangentKind+f),h&&e.push(l.o.UVKind+"_"+f),e.length>r&&a.Y.Error("Cannot add more vertex attributes for mesh "+t.name)}}},{key:"PrepareAttributesForBakedVertexAnimation",value:function(e,t,n){n.BAKED_VERTEX_ANIMATION_TEXTURE&&n.INSTANCES&&e.push("bakedVertexAnimationSettingsInstanced")}},{key:"PrepareAttributesForBones",value:function(e,t,n,i){n.NUM_BONE_INFLUENCERS>0&&(i.addCPUSkinningFallback(0,t),e.push(l.o.MatricesIndicesKind),e.push(l.o.MatricesWeightsKind),n.NUM_BONE_INFLUENCERS>4&&(e.push(l.o.MatricesIndicesExtraKind),e.push(l.o.MatricesWeightsExtraKind)))}},{key:"PrepareAttributesForInstances",value:function(e,t){(t.INSTANCES||t.THIN_INSTANCES)&&this.PushAttributesForInstances(e,!!t.PREPASS_VELOCITY),t.INSTANCESCOLOR&&e.push(l.o.ColorInstanceKind)}},{key:"PushAttributesForInstances",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.push("world0"),e.push("world1"),e.push("world2"),e.push("world3"),t&&(e.push("previousWorld0"),e.push("previousWorld1"),e.push("previousWorld2"),e.push("previousWorld3"))}},{key:"BindLightProperties",value:function(e,t,n){e.transferToEffect(t,n+"")}},{key:"BindLight",value:function(e,t,n,i,r){var a=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];e._bindLight(t,n,i,r,a)}},{key:"BindLights",value:function(e,t,n,i){for(var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:4,a=Math.min(t.lightSources.length,r),o=0;o<a;o++){var s=t.lightSources[o];this.BindLight(s,o,e,n,"boolean"==typeof i?i:i.SPECULARTERM,t.receiveShadows)}}},{key:"BindFogParameters",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];e.fogEnabled&&t.applyFog&&e.fogMode!==s.x.FOGMODE_NONE&&(n.setFloat4("vFogInfos",e.fogMode,e.fogStart,e.fogEnd,e.fogDensity),i?(e.fogColor.toLinearSpaceToRef(this._TempFogColor),n.setColor3("vFogColor",this._TempFogColor)):n.setColor3("vFogColor",e.fogColor))}},{key:"BindBonesParameters",value:function(t,n,i){if(n&&t&&(t.computeBonesUsingShaders&&n._bonesComputationForcedToCPU&&(t.computeBonesUsingShaders=!1),t.useBones&&t.computeBonesUsingShaders&&t.skeleton)){var r=t.skeleton;if(r.isUsingTextureForMatrices&&n.getUniformIndex("boneTextureWidth")>-1){var a=r.getTransformMatrixTexture(t);n.setTexture("boneSampler",a),n.setFloat("boneTextureWidth",4*(r.bones.length+1))}else{var o=r.getTransformMatrices(t);o&&(n.setMatrices("mBones",o),i&&t.getScene().prePassRenderer&&t.getScene().prePassRenderer.getIndex(2)&&(i.previousBones[t.uniqueId]||(i.previousBones[t.uniqueId]=o.slice()),n.setMatrices("mPreviousBones",i.previousBones[t.uniqueId]),e._CopyBonesTransformationMatrices(o,i.previousBones[t.uniqueId])))}}}},{key:"_CopyBonesTransformationMatrices",value:function(e,t){return t.set(e),t}},{key:"BindMorphTargetParameters",value:function(e,t){var n=e.morphTargetManager;e&&n&&t.setFloatArray("morphTargetInfluences",n.influences)}},{key:"BindLogDepth",value:function(e,t,n){if(!e||e.LOGARITHMICDEPTH){var i=n.activeCamera;i.mode===o.V.ORTHOGRAPHIC_CAMERA&&a.Y.Error("Logarithmic depth is not compatible with orthographic cameras!",20),t.setFloat("logarithmicDepthConstant",2/(Math.log(i.maxZ+1)/Math.LN2))}}},{key:"BindClipPlane",value:function(e,t){f.BindClipPlane(e,t)}}]),e}();v._TmpMorphInfluencers={NUM_MORPH_INFLUENCERS:0},v._TempFogColor=h.Wo.Black()},4071:function(e,t,n){"use strict";var i;n.d(t,{S:function(){return i}}),function(e){e[e.Created=1]="Created",e[e.Disposed=2]="Disposed",e[e.GetDefineNames=4]="GetDefineNames",e[e.PrepareUniformBuffer=8]="PrepareUniformBuffer",e[e.IsReadyForSubMesh=16]="IsReadyForSubMesh",e[e.PrepareDefines=32]="PrepareDefines",e[e.BindForSubMesh=64]="BindForSubMesh",e[e.PrepareEffect=128]="PrepareEffect",e[e.GetAnimatables=256]="GetAnimatables",e[e.GetActiveTextures=512]="GetActiveTextures",e[e.HasTexture=1024]="HasTexture",e[e.FillRenderTargetTextures=2048]="FillRenderTargetTextures",e[e.HasRenderTargetTextures=4096]="HasRenderTargetTextures",e[e.HardBindForSubMesh=8192]="HardBindForSubMesh"}(i||(i={}))},2402:function(e,t,n){"use strict";n.d(t,{G:function(){return v}});var i=n(2982),r=n(5671),a=n(3144),o=n(7326),s=n(1752),u=n(136),l=n(6215),c=n(1120),h=n(6556),f=n(7032),d=n(1704);function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,c.Z)(e);if(t){var r=(0,c.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,l.Z)(this,n)}}var v=function(e){(0,u.Z)(n,e);var t=p(n);function n(e,i){var a;return(0,r.Z)(this,n),(a=t.call(this,e,i,!0))._waitingSubMaterialsUniqueIds=[],a.getScene().multiMaterials.push((0,o.Z)(a)),a.subMaterials=new Array,a._storeEffectOnSubMeshes=!0,a}return(0,a.Z)(n,[{key:"subMaterials",get:function(){return this._subMaterials},set:function(e){this._subMaterials=e,this._hookArray(e)}},{key:"getChildren",value:function(){return this.subMaterials}},{key:"_hookArray",value:function(e){var t=this,n=e.push;e.push=function(){for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];var o=n.apply(e,r);return t._markAllSubMeshesAsTexturesDirty(),o};var i=e.splice;e.splice=function(n,r){var a=i.apply(e,[n,r]);return t._markAllSubMeshesAsTexturesDirty(),a}}},{key:"getSubMaterial",value:function(e){return e<0||e>=this.subMaterials.length?this.getScene().defaultMaterial:this.subMaterials[e]}},{key:"getActiveTextures",value:function(){var e;return(e=(0,s.Z)((0,c.Z)(n.prototype),"getActiveTextures",this).call(this)).concat.apply(e,(0,i.Z)(this.subMaterials.map((function(e){return e?e.getActiveTextures():[]}))))}},{key:"hasTexture",value:function(e){if((0,s.Z)((0,c.Z)(n.prototype),"hasTexture",this).call(this,e))return!0;for(var t=0;t<this.subMaterials.length;t++){var i;if(null!==(i=this.subMaterials[t])&&void 0!==i&&i.hasTexture(e))return!0}return!1}},{key:"getClassName",value:function(){return"MultiMaterial"}},{key:"isReadyForSubMesh",value:function(e,t,n){for(var i=0;i<this.subMaterials.length;i++){var r=this.subMaterials[i];if(r){if(r._storeEffectOnSubMeshes){if(!r.isReadyForSubMesh(e,t,n))return!1;continue}if(!r.isReady(e))return!1}}return!0}},{key:"clone",value:function(e,t){for(var i=new n(e,this.getScene()),r=0;r<this.subMaterials.length;r++){var a=null,o=this.subMaterials[r];a=t&&o?o.clone(e+"-"+o.name):this.subMaterials[r],i.subMaterials.push(a)}return i}},{key:"serialize",value:function(){var e={};e.name=this.name,e.id=this.id,e.uniqueId=this.uniqueId,f.$&&(e.tags=f.$.GetTags(this)),e.materialsUniqueIds=[],e.materials=[];for(var t=0;t<this.subMaterials.length;t++){var n=this.subMaterials[t];n?(e.materialsUniqueIds.push(n.uniqueId),e.materials.push(n.id)):(e.materialsUniqueIds.push(null),e.materials.push(null))}return e}},{key:"dispose",value:function(e,t,i){var r=this.getScene();if(r){if(i)for(var a=0;a<this.subMaterials.length;a++){var o=this.subMaterials[a];o&&o.dispose(e,t)}var u=r.multiMaterials.indexOf(this);u>=0&&r.multiMaterials.splice(u,1),(0,s.Z)((0,c.Z)(n.prototype),"dispose",this).call(this,e,t)}}}],[{key:"ParseMultiMaterial",value:function(e,t){var i=new n(e.name,t);return i.id=e.id,i._loadedUniqueId=e.uniqueId,f.$&&f.$.AddTagsTo(i,e.tags),e.materialsUniqueIds?i._waitingSubMaterialsUniqueIds=e.materialsUniqueIds:e.materials.forEach((function(e){return i.subMaterials.push(t.getLastMaterialById(e))})),i}}]),n}(h.F);(0,d.H)("BABYLON.MultiMaterial",v)},2223:function(e,t,n){"use strict";var i;n.d(t,{x:function(){return i}}),function(e){e[e.GLSL=0]="GLSL",e[e.WGSL=1]="WGSL"}(i||(i={}))},1952:function(e,t,n){"use strict";n.d(t,{M:function(){return l}});var i=n(5671),r=n(3144),a=n(2328),o=n(8517),s=n(4796),u=n(2628);s.B.prototype.createUniformBuffer=function(e){var t=this._gl.createBuffer();if(!t)throw new Error("Unable to create uniform buffer");var n=new u.M(t);return this.bindUniformBuffer(n),e instanceof Float32Array?this._gl.bufferData(this._gl.UNIFORM_BUFFER,e,this._gl.STATIC_DRAW):this._gl.bufferData(this._gl.UNIFORM_BUFFER,new Float32Array(e),this._gl.STATIC_DRAW),this.bindUniformBuffer(null),n.references=1,n},s.B.prototype.createDynamicUniformBuffer=function(e){var t=this._gl.createBuffer();if(!t)throw new Error("Unable to create dynamic uniform buffer");var n=new u.M(t);return this.bindUniformBuffer(n),e instanceof Float32Array?this._gl.bufferData(this._gl.UNIFORM_BUFFER,e,this._gl.DYNAMIC_DRAW):this._gl.bufferData(this._gl.UNIFORM_BUFFER,new Float32Array(e),this._gl.DYNAMIC_DRAW),this.bindUniformBuffer(null),n.references=1,n},s.B.prototype.updateUniformBuffer=function(e,t,n,i){this.bindUniformBuffer(e),void 0===n&&(n=0),void 0===i?t instanceof Float32Array?this._gl.bufferSubData(this._gl.UNIFORM_BUFFER,n,t):this._gl.bufferSubData(this._gl.UNIFORM_BUFFER,n,new Float32Array(t)):t instanceof Float32Array?this._gl.bufferSubData(this._gl.UNIFORM_BUFFER,0,t.subarray(n,n+i)):this._gl.bufferSubData(this._gl.UNIFORM_BUFFER,0,new Float32Array(t).subarray(n,n+i)),this.bindUniformBuffer(null)},s.B.prototype.bindUniformBuffer=function(e){this._gl.bindBuffer(this._gl.UNIFORM_BUFFER,e?e.underlyingResource:null)},s.B.prototype.bindUniformBufferBase=function(e,t,n){this._gl.bindBufferBase(this._gl.UNIFORM_BUFFER,t,e?e.underlyingResource:null)},s.B.prototype.bindUniformBlock=function(e,t,n){var i=e.program,r=this._gl.getUniformBlockIndex(i,t);4294967295!==r&&this._gl.uniformBlockBinding(i,r,n)};var l=function(){function e(t,n,r,a){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];(0,i.Z)(this,e),this._valueCache={},this._engine=t,this._noUBO=!t.supportsUniformBuffers||o,this._dynamic=r,this._name=null!=a?a:"no-name",this._data=n||[],this._uniformLocations={},this._uniformSizes={},this._uniformArraySizes={},this._uniformLocationPointer=0,this._needSync=!1,this._engine._features.trackUbosInFrame&&(this._buffers=[],this._bufferIndex=-1,this._createBufferOnWrite=!1,this._currentFrameId=0),this._noUBO?(this.updateMatrix3x3=this._updateMatrix3x3ForEffect,this.updateMatrix2x2=this._updateMatrix2x2ForEffect,this.updateFloat=this._updateFloatForEffect,this.updateFloat2=this._updateFloat2ForEffect,this.updateFloat3=this._updateFloat3ForEffect,this.updateFloat4=this._updateFloat4ForEffect,this.updateFloatArray=this._updateFloatArrayForEffect,this.updateArray=this._updateArrayForEffect,this.updateIntArray=this._updateIntArrayForEffect,this.updateMatrix=this._updateMatrixForEffect,this.updateMatrices=this._updateMatricesForEffect,this.updateVector3=this._updateVector3ForEffect,this.updateVector4=this._updateVector4ForEffect,this.updateColor3=this._updateColor3ForEffect,this.updateColor4=this._updateColor4ForEffect,this.updateDirectColor4=this._updateDirectColor4ForEffect,this.updateInt=this._updateIntForEffect,this.updateInt2=this._updateInt2ForEffect,this.updateInt3=this._updateInt3ForEffect,this.updateInt4=this._updateInt4ForEffect):(this._engine._uniformBuffers.push(this),this.updateMatrix3x3=this._updateMatrix3x3ForUniform,this.updateMatrix2x2=this._updateMatrix2x2ForUniform,this.updateFloat=this._updateFloatForUniform,this.updateFloat2=this._updateFloat2ForUniform,this.updateFloat3=this._updateFloat3ForUniform,this.updateFloat4=this._updateFloat4ForUniform,this.updateFloatArray=this._updateFloatArrayForUniform,this.updateArray=this._updateArrayForUniform,this.updateIntArray=this._updateIntArrayForUniform,this.updateMatrix=this._updateMatrixForUniform,this.updateMatrices=this._updateMatricesForUniform,this.updateVector3=this._updateVector3ForUniform,this.updateVector4=this._updateVector4ForUniform,this.updateColor3=this._updateColor3ForUniform,this.updateColor4=this._updateColor4ForUniform,this.updateDirectColor4=this._updateDirectColor4ForUniform,this.updateInt=this._updateIntForUniform,this.updateInt2=this._updateInt2ForUniform,this.updateInt3=this._updateInt3ForUniform,this.updateInt4=this._updateInt4ForUniform)}return(0,r.Z)(e,[{key:"useUbo",get:function(){return!this._noUBO}},{key:"isSync",get:function(){return!this._needSync}},{key:"isDynamic",value:function(){return void 0!==this._dynamic}},{key:"getData",value:function(){return this._bufferData}},{key:"getBuffer",value:function(){return this._buffer}},{key:"_fillAlignment",value:function(e){var t;if(t=e<=2?e:4,this._uniformLocationPointer%t!=0){var n=this._uniformLocationPointer;this._uniformLocationPointer+=t-this._uniformLocationPointer%t;for(var i=this._uniformLocationPointer-n,r=0;r<i;r++)this._data.push(0)}}},{key:"addUniform",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(!this._noUBO&&void 0===this._uniformLocations[e]){var i;if(n>0){if(t instanceof Array)throw"addUniform should not be use with Array in UBO: "+e;if(this._fillAlignment(4),this._uniformArraySizes[e]={strideSize:t,arraySize:n},16==t)t*=n;else{var r=4-t,a=r*n;t=t*n+a}i=[];for(var o=0;o<t;o++)i.push(0)}else{if(t instanceof Array)t=(i=t).length;else{i=[];for(var s=0;s<t;s++)i.push(0)}this._fillAlignment(t)}this._uniformSizes[e]=t,this._uniformLocations[e]=this._uniformLocationPointer,this._uniformLocationPointer+=t;for(var u=0;u<t;u++)this._data.push(i[u]);this._needSync=!0}}},{key:"addMatrix",value:function(e,t){this.addUniform(e,Array.prototype.slice.call(t.toArray()))}},{key:"addFloat2",value:function(e,t,n){var i=[t,n];this.addUniform(e,i)}},{key:"addFloat3",value:function(e,t,n,i){var r=[t,n,i];this.addUniform(e,r)}},{key:"addColor3",value:function(e,t){var n=[t.r,t.g,t.b];this.addUniform(e,n)}},{key:"addColor4",value:function(e,t,n){var i=[t.r,t.g,t.b,n];this.addUniform(e,i)}},{key:"addVector3",value:function(e,t){var n=[t.x,t.y,t.z];this.addUniform(e,n)}},{key:"addMatrix3x3",value:function(e){this.addUniform(e,12)}},{key:"addMatrix2x2",value:function(e){this.addUniform(e,8)}},{key:"create",value:function(){this._noUBO||this._buffer||(this._fillAlignment(4),this._bufferData=new Float32Array(this._data),this._rebuild(),this._needSync=!0)}},{key:"_rebuild",value:function(){!this._noUBO&&this._bufferData&&(this._dynamic?this._buffer=this._engine.createDynamicUniformBuffer(this._bufferData):this._buffer=this._engine.createUniformBuffer(this._bufferData),this._engine._features.trackUbosInFrame&&(this._buffers.push([this._buffer,this._engine._features.checkUbosContentBeforeUpload?this._bufferData.slice():void 0]),this._bufferIndex=this._buffers.length-1,this._createBufferOnWrite=!1))}},{key:"_numBuffers",get:function(){return this._buffers.length}},{key:"_indexBuffer",get:function(){return this._bufferIndex}},{key:"name",get:function(){return this._name}},{key:"_buffersEqual",value:function(e,t){for(var n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}},{key:"_copyBuffer",value:function(e,t){for(var n=0;n<e.length;++n)t[n]=e[n]}},{key:"update",value:function(){if(!this._noUBO)if(this.bindUniformBuffer(),this._buffer)if(this._dynamic||this._needSync){if(this._buffers&&this._buffers.length>1&&this._buffers[this._bufferIndex][1]){if(this._buffersEqual(this._bufferData,this._buffers[this._bufferIndex][1]))return this._needSync=!1,void(this._createBufferOnWrite=this._engine._features.trackUbosInFrame);this._copyBuffer(this._bufferData,this._buffers[this._bufferIndex][1])}this._engine.updateUniformBuffer(this._buffer,this._bufferData),this._engine._features._collectUbosUpdatedInFrame&&(e._UpdatedUbosInFrame[this._name]||(e._UpdatedUbosInFrame[this._name]=0),e._UpdatedUbosInFrame[this._name]++),this._needSync=!1,this._createBufferOnWrite=this._engine._features.trackUbosInFrame}else this._createBufferOnWrite=this._engine._features.trackUbosInFrame;else this.create()}},{key:"_createNewBuffer",value:function(){this._bufferIndex+1<this._buffers.length?(this._bufferIndex++,this._buffer=this._buffers[this._bufferIndex][0],this._createBufferOnWrite=!1,this._needSync=!0):this._rebuild()}},{key:"_checkNewFrame",value:function(){this._engine._features.trackUbosInFrame&&this._currentFrameId!==this._engine.frameId&&(this._currentFrameId=this._engine.frameId,this._createBufferOnWrite=!1,this._buffers&&this._buffers.length>0?(this._needSync=0!==this._bufferIndex,this._bufferIndex=0,this._buffer=this._buffers[this._bufferIndex][0]):this._bufferIndex=-1)}},{key:"updateUniform",value:function(e,t,n){this._checkNewFrame();var i=this._uniformLocations[e];if(void 0===i){if(this._buffer)return void a.Y.Error("Cannot add an uniform after UBO has been created.");this.addUniform(e,n),i=this._uniformLocations[e]}if(this._buffer||this.create(),this._dynamic)for(var r=0;r<n;r++)this._bufferData[i+r]=t[r];else{for(var s=!1,u=0;u<n;u++)(16===n&&!this._engine._features.uniformBufferHardCheckMatrix||this._bufferData[i+u]!==o.w1.FloatRound(t[u]))&&(s=!0,this._createBufferOnWrite&&this._createNewBuffer(),this._bufferData[i+u]=t[u]);this._needSync=this._needSync||s}}},{key:"updateUniformArray",value:function(e,t,n){this._checkNewFrame();var i=this._uniformLocations[e];if(void 0!==i){this._buffer||this.create();var r=this._uniformArraySizes[e];if(this._dynamic)for(var s=0;s<n;s++)this._bufferData[i+s]=t[s];else{for(var u=!1,l=0,c=0,h=0;h<n;h++)if(this._bufferData[i+4*c+l]!==o.w1.FloatRound(t[h])&&(u=!0,this._createBufferOnWrite&&this._createNewBuffer(),this._bufferData[i+4*c+l]=t[h]),++l===r.strideSize){for(;l<4;l++)this._bufferData[i+4*c+l]=0;l=0,c++}this._needSync=this._needSync||u}}else a.Y.Error("Cannot add an uniform Array dynamically. Please, add it using addUniform.")}},{key:"_cacheMatrix",value:function(e,t){this._checkNewFrame();var n=this._valueCache[e],i=t.updateFlag;return(void 0===n||n!==i)&&(this._valueCache[e]=i,!0)}},{key:"_updateMatrix3x3ForUniform",value:function(t,n){for(var i=0;i<3;i++)e._TempBuffer[4*i]=n[3*i],e._TempBuffer[4*i+1]=n[3*i+1],e._TempBuffer[4*i+2]=n[3*i+2],e._TempBuffer[4*i+3]=0;this.updateUniform(t,e._TempBuffer,12)}},{key:"_updateMatrix3x3ForEffect",value:function(e,t){this._currentEffect.setMatrix3x3(e,t)}},{key:"_updateMatrix2x2ForEffect",value:function(e,t){this._currentEffect.setMatrix2x2(e,t)}},{key:"_updateMatrix2x2ForUniform",value:function(t,n){for(var i=0;i<2;i++)e._TempBuffer[4*i]=n[2*i],e._TempBuffer[4*i+1]=n[2*i+1],e._TempBuffer[4*i+2]=0,e._TempBuffer[4*i+3]=0;this.updateUniform(t,e._TempBuffer,8)}},{key:"_updateFloatForEffect",value:function(e,t){this._currentEffect.setFloat(e,t)}},{key:"_updateFloatForUniform",value:function(t,n){e._TempBuffer[0]=n,this.updateUniform(t,e._TempBuffer,1)}},{key:"_updateFloat2ForEffect",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";this._currentEffect.setFloat2(e+i,t,n)}},{key:"_updateFloat2ForUniform",value:function(t,n,i){e._TempBuffer[0]=n,e._TempBuffer[1]=i,this.updateUniform(t,e._TempBuffer,2)}},{key:"_updateFloat3ForEffect",value:function(e,t,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";this._currentEffect.setFloat3(e+r,t,n,i)}},{key:"_updateFloat3ForUniform",value:function(t,n,i,r){e._TempBuffer[0]=n,e._TempBuffer[1]=i,e._TempBuffer[2]=r,this.updateUniform(t,e._TempBuffer,3)}},{key:"_updateFloat4ForEffect",value:function(e,t,n,i,r){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"";this._currentEffect.setFloat4(e+a,t,n,i,r)}},{key:"_updateFloat4ForUniform",value:function(t,n,i,r,a){e._TempBuffer[0]=n,e._TempBuffer[1]=i,e._TempBuffer[2]=r,e._TempBuffer[3]=a,this.updateUniform(t,e._TempBuffer,4)}},{key:"_updateFloatArrayForEffect",value:function(e,t){this._currentEffect.setFloatArray(e,t)}},{key:"_updateFloatArrayForUniform",value:function(e,t){this.updateUniformArray(e,t,t.length)}},{key:"_updateArrayForEffect",value:function(e,t){this._currentEffect.setArray(e,t)}},{key:"_updateArrayForUniform",value:function(e,t){this.updateUniformArray(e,t,t.length)}},{key:"_updateIntArrayForEffect",value:function(e,t){this._currentEffect.setIntArray(e,t)}},{key:"_updateIntArrayForUniform",value:function(t,n){e._TempBufferInt32View.set(n),this.updateUniformArray(t,e._TempBuffer,n.length)}},{key:"_updateMatrixForEffect",value:function(e,t){this._currentEffect.setMatrix(e,t)}},{key:"_updateMatrixForUniform",value:function(e,t){this._cacheMatrix(e,t)&&this.updateUniform(e,t.toArray(),16)}},{key:"_updateMatricesForEffect",value:function(e,t){this._currentEffect.setMatrices(e,t)}},{key:"_updateMatricesForUniform",value:function(e,t){this.updateUniform(e,t,t.length)}},{key:"_updateVector3ForEffect",value:function(e,t){this._currentEffect.setVector3(e,t)}},{key:"_updateVector3ForUniform",value:function(t,n){e._TempBuffer[0]=n.x,e._TempBuffer[1]=n.y,e._TempBuffer[2]=n.z,this.updateUniform(t,e._TempBuffer,3)}},{key:"_updateVector4ForEffect",value:function(e,t){this._currentEffect.setVector4(e,t)}},{key:"_updateVector4ForUniform",value:function(t,n){e._TempBuffer[0]=n.x,e._TempBuffer[1]=n.y,e._TempBuffer[2]=n.z,e._TempBuffer[3]=n.w,this.updateUniform(t,e._TempBuffer,4)}},{key:"_updateColor3ForEffect",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";this._currentEffect.setColor3(e+n,t)}},{key:"_updateColor3ForUniform",value:function(t,n){e._TempBuffer[0]=n.r,e._TempBuffer[1]=n.g,e._TempBuffer[2]=n.b,this.updateUniform(t,e._TempBuffer,3)}},{key:"_updateColor4ForEffect",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";this._currentEffect.setColor4(e+i,t,n)}},{key:"_updateDirectColor4ForEffect",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";this._currentEffect.setDirectColor4(e+n,t)}},{key:"_updateColor4ForUniform",value:function(t,n,i){e._TempBuffer[0]=n.r,e._TempBuffer[1]=n.g,e._TempBuffer[2]=n.b,e._TempBuffer[3]=i,this.updateUniform(t,e._TempBuffer,4)}},{key:"_updateDirectColor4ForUniform",value:function(t,n){e._TempBuffer[0]=n.r,e._TempBuffer[1]=n.g,e._TempBuffer[2]=n.b,e._TempBuffer[3]=n.a,this.updateUniform(t,e._TempBuffer,4)}},{key:"_updateIntForEffect",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";this._currentEffect.setInt(e+n,t)}},{key:"_updateIntForUniform",value:function(t,n){e._TempBufferInt32View[0]=n,this.updateUniform(t,e._TempBuffer,1)}},{key:"_updateInt2ForEffect",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";this._currentEffect.setInt2(e+i,t,n)}},{key:"_updateInt2ForUniform",value:function(t,n,i){e._TempBufferInt32View[0]=n,e._TempBufferInt32View[1]=i,this.updateUniform(t,e._TempBuffer,2)}},{key:"_updateInt3ForEffect",value:function(e,t,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";this._currentEffect.setInt3(e+r,t,n,i)}},{key:"_updateInt3ForUniform",value:function(t,n,i,r){e._TempBufferInt32View[0]=n,e._TempBufferInt32View[1]=i,e._TempBufferInt32View[2]=r,this.updateUniform(t,e._TempBuffer,3)}},{key:"_updateInt4ForEffect",value:function(e,t,n,i,r){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"";this._currentEffect.setInt4(e+a,t,n,i,r)}},{key:"_updateInt4ForUniform",value:function(t,n,i,r,a){e._TempBufferInt32View[0]=n,e._TempBufferInt32View[1]=i,e._TempBufferInt32View[2]=r,e._TempBufferInt32View[3]=a,this.updateUniform(t,e._TempBuffer,4)}},{key:"setTexture",value:function(e,t){this._currentEffect.setTexture(e,t)}},{key:"updateUniformDirectly",value:function(e,t){this.updateUniform(e,t,t.length),this.update()}},{key:"bindToEffect",value:function(e,t){this._currentEffect=e,this._currentEffectName=t}},{key:"bindUniformBuffer",value:function(){!this._noUBO&&this._buffer&&this._currentEffect&&this._currentEffect.bindUniformBuffer(this._buffer,this._currentEffectName)}},{key:"unbindEffect",value:function(){this._currentEffect=void 0,this._currentEffectName=void 0}},{key:"setDataBuffer",value:function(e){if(!this._buffers)return this._buffer===e;for(var t=0;t<this._buffers.length;++t){if(this._buffers[t][0]===e)return this._bufferIndex=t,this._buffer=e,this._createBufferOnWrite=!1,this._currentEffect=void 0,!0}return!1}},{key:"dispose",value:function(){if(!this._noUBO){var e=this._engine._uniformBuffers,t=e.indexOf(this);if(-1!==t&&(e[t]=e[e.length-1],e.pop()),this._engine._features.trackUbosInFrame&&this._buffers)for(var n=0;n<this._buffers.length;++n){var i=this._buffers[n][0];this._engine._releaseBuffer(i)}else this._buffer&&this._engine._releaseBuffer(this._buffer)&&(this._buffer=null)}}}]),e}();l._UpdatedUbosInFrame={},l._MAX_UNIFORM_SIZE=256,l._TempBuffer=new Float32Array(l._MAX_UNIFORM_SIZE),l._TempBufferInt32View=new Uint32Array(l._TempBuffer.buffer)},7702:function(e,t,n){"use strict";n.d(t,{RD:function(){return u},T:function(){return i}});var i,r=n(3144),a=n(5671),o=n(6900);!function(e){e[e.LOCAL=0]="LOCAL",e[e.WORLD=1]="WORLD",e[e.BONE=2]="BONE"}(i||(i={}));var s,u=(0,r.Z)((function e(){(0,a.Z)(this,e)}));u.X=new o.P(1,0,0),u.Y=new o.P(0,1,0),u.Z=new o.P(0,0,1),function(e){e[e.X=0]="X",e[e.Y=1]="Y",e[e.Z=2]="Z"}(s||(s={}))},7046:function(e,t,n){"use strict";n.d(t,{HE:function(){return c},Wo:function(){return l},zZ:function(){return h}});var i=n(5671),r=n(3144),a=n(5602),o=n(3681),s=n(8134),u=n(1704),l=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;(0,i.Z)(this,e),this.r=t,this.g=n,this.b=r}return(0,r.Z)(e,[{key:"toString",value:function(){return"{R: "+this.r+" G:"+this.g+" B:"+this.b+"}"}},{key:"getClassName",value:function(){return"Color3"}},{key:"getHashCode",value:function(){var e=255*this.r|0;return e=397*(e=397*e^(255*this.g|0))^(255*this.b|0)}},{key:"toArray",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,this}},{key:"fromArray",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.FromArrayToRef(t,n,this),this}},{key:"toColor4",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return new c(this.r,this.g,this.b,e)}},{key:"asArray",value:function(){return[this.r,this.g,this.b]}},{key:"toLuminance",value:function(){return.3*this.r+.59*this.g+.11*this.b}},{key:"multiply",value:function(t){return new e(this.r*t.r,this.g*t.g,this.b*t.b)}},{key:"multiplyToRef",value:function(e,t){return t.r=this.r*e.r,t.g=this.g*e.g,t.b=this.b*e.b,this}},{key:"equals",value:function(e){return e&&this.r===e.r&&this.g===e.g&&this.b===e.b}},{key:"equalsFloats",value:function(e,t,n){return this.r===e&&this.g===t&&this.b===n}},{key:"scale",value:function(t){return new e(this.r*t,this.g*t,this.b*t)}},{key:"scaleInPlace",value:function(e){return this.r*=e,this.g*=e,this.b*=e,this}},{key:"scaleToRef",value:function(e,t){return t.r=this.r*e,t.g=this.g*e,t.b=this.b*e,this}},{key:"scaleAndAddToRef",value:function(e,t){return t.r+=this.r*e,t.g+=this.g*e,t.b+=this.b*e,this}},{key:"clampToRef",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0;return n.r=a.R.Clamp(this.r,e,t),n.g=a.R.Clamp(this.g,e,t),n.b=a.R.Clamp(this.b,e,t),this}},{key:"add",value:function(t){return new e(this.r+t.r,this.g+t.g,this.b+t.b)}},{key:"addToRef",value:function(e,t){return t.r=this.r+e.r,t.g=this.g+e.g,t.b=this.b+e.b,this}},{key:"subtract",value:function(t){return new e(this.r-t.r,this.g-t.g,this.b-t.b)}},{key:"subtractToRef",value:function(e,t){return t.r=this.r-e.r,t.g=this.g-e.g,t.b=this.b-e.b,this}},{key:"clone",value:function(){return new e(this.r,this.g,this.b)}},{key:"copyFrom",value:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}},{key:"copyFromFloats",value:function(e,t,n){return this.r=e,this.g=t,this.b=n,this}},{key:"set",value:function(e,t,n){return this.copyFromFloats(e,t,n)}},{key:"toHexString",value:function(){var e=Math.round(255*this.r),t=Math.round(255*this.g),n=Math.round(255*this.b);return"#"+a.R.ToHex(e)+a.R.ToHex(t)+a.R.ToHex(n)}},{key:"toLinearSpace",value:function(){var t=new e;return this.toLinearSpaceToRef(t),t}},{key:"toHSV",value:function(){var t=new e;return this.toHSVToRef(t),t}},{key:"toHSVToRef",value:function(e){var t=this.r,n=this.g,i=this.b,r=Math.max(t,n,i),a=Math.min(t,n,i),o=0,s=0,u=r,l=r-a;0!==r&&(s=l/r),r!=a&&(r==t?(o=(n-i)/l,n<i&&(o+=6)):r==n?o=(i-t)/l+2:r==i&&(o=(t-n)/l+4),o*=60),e.r=o,e.g=s,e.b=u}},{key:"toLinearSpaceToRef",value:function(e){return e.r=Math.pow(this.r,o.Nn),e.g=Math.pow(this.g,o.Nn),e.b=Math.pow(this.b,o.Nn),this}},{key:"toGammaSpace",value:function(){var t=new e;return this.toGammaSpaceToRef(t),t}},{key:"toGammaSpaceToRef",value:function(e){return e.r=Math.pow(this.r,o.zp),e.g=Math.pow(this.g,o.zp),e.b=Math.pow(this.b,o.zp),this}}],[{key:"HSVtoRGBToRef",value:function(e,t,n,i){var r=n*t,a=e/60,o=r*(1-Math.abs(a%2-1)),s=0,u=0,l=0;a>=0&&a<=1?(s=r,u=o):a>=1&&a<=2?(s=o,u=r):a>=2&&a<=3?(u=r,l=o):a>=3&&a<=4?(u=o,l=r):a>=4&&a<=5?(s=o,l=r):a>=5&&a<=6&&(s=r,l=o);var c=n-r;i.set(s+c,u+c,l+c)}},{key:"FromHSV",value:function(t,n,i){var r=new e(0,0,0);return e.HSVtoRGBToRef(t,n,i,r),r}},{key:"FromHexString",value:function(t){if("#"!==t.substring(0,1)||7!==t.length)return new e(0,0,0);var n=parseInt(t.substring(1,3),16),i=parseInt(t.substring(3,5),16),r=parseInt(t.substring(5,7),16);return e.FromInts(n,i,r)}},{key:"FromArray",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return new e(t[n],t[n+1],t[n+2])}},{key:"FromArrayToRef",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;n.r=e[t],n.g=e[t+1],n.b=e[t+2]}},{key:"FromInts",value:function(t,n,i){return new e(t/255,n/255,i/255)}},{key:"Lerp",value:function(t,n,i){var r=new e(0,0,0);return e.LerpToRef(t,n,i,r),r}},{key:"LerpToRef",value:function(e,t,n,i){i.r=e.r+(t.r-e.r)*n,i.g=e.g+(t.g-e.g)*n,i.b=e.b+(t.b-e.b)*n}},{key:"Hermite",value:function(t,n,i,r,a){var o=a*a,s=a*o,u=2*s-3*o+1,l=-2*s+3*o,c=s-2*o+a,h=s-o;return new e(t.r*u+i.r*l+n.r*c+r.r*h,t.g*u+i.g*l+n.g*c+r.g*h,t.b*u+i.b*l+n.b*c+r.b*h)}},{key:"Hermite1stDerivative",value:function(t,n,i,r,a){var o=e.Black();return this.Hermite1stDerivativeToRef(t,n,i,r,a,o),o}},{key:"Hermite1stDerivativeToRef",value:function(e,t,n,i,r,a){var o=r*r;a.r=6*(o-r)*e.r+(3*o-4*r+1)*t.r+6*(-o+r)*n.r+(3*o-2*r)*i.r,a.g=6*(o-r)*e.g+(3*o-4*r+1)*t.g+6*(-o+r)*n.g+(3*o-2*r)*i.g,a.b=6*(o-r)*e.b+(3*o-4*r+1)*t.b+6*(-o+r)*n.b+(3*o-2*r)*i.b}},{key:"Red",value:function(){return new e(1,0,0)}},{key:"Green",value:function(){return new e(0,1,0)}},{key:"Blue",value:function(){return new e(0,0,1)}},{key:"Black",value:function(){return new e(0,0,0)}},{key:"BlackReadOnly",get:function(){return e._BlackReadOnly}},{key:"White",value:function(){return new e(1,1,1)}},{key:"Purple",value:function(){return new e(.5,0,.5)}},{key:"Magenta",value:function(){return new e(1,0,1)}},{key:"Yellow",value:function(){return new e(1,1,0)}},{key:"Gray",value:function(){return new e(.5,.5,.5)}},{key:"Teal",value:function(){return new e(0,1,1)}},{key:"Random",value:function(){return new e(Math.random(),Math.random(),Math.random())}}]),e}();l._BlackReadOnly=l.Black();var c=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;(0,i.Z)(this,e),this.r=t,this.g=n,this.b=r,this.a=a}return(0,r.Z)(e,[{key:"addInPlace",value:function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this.a+=e.a,this}},{key:"asArray",value:function(){return[this.r,this.g,this.b,this.a]}},{key:"toArray",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e[t+3]=this.a,this}},{key:"fromArray",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.FromArrayToRef(t,n,this),this}},{key:"equals",value:function(e){return e&&this.r===e.r&&this.g===e.g&&this.b===e.b&&this.a===e.a}},{key:"add",value:function(t){return new e(this.r+t.r,this.g+t.g,this.b+t.b,this.a+t.a)}},{key:"subtract",value:function(t){return new e(this.r-t.r,this.g-t.g,this.b-t.b,this.a-t.a)}},{key:"subtractToRef",value:function(e,t){return t.r=this.r-e.r,t.g=this.g-e.g,t.b=this.b-e.b,t.a=this.a-e.a,this}},{key:"scale",value:function(t){return new e(this.r*t,this.g*t,this.b*t,this.a*t)}},{key:"scaleInPlace",value:function(e){return this.r*=e,this.g*=e,this.b*=e,this.a*=e,this}},{key:"scaleToRef",value:function(e,t){return t.r=this.r*e,t.g=this.g*e,t.b=this.b*e,t.a=this.a*e,this}},{key:"scaleAndAddToRef",value:function(e,t){return t.r+=this.r*e,t.g+=this.g*e,t.b+=this.b*e,t.a+=this.a*e,this}},{key:"clampToRef",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0;return n.r=a.R.Clamp(this.r,e,t),n.g=a.R.Clamp(this.g,e,t),n.b=a.R.Clamp(this.b,e,t),n.a=a.R.Clamp(this.a,e,t),this}},{key:"multiply",value:function(t){return new e(this.r*t.r,this.g*t.g,this.b*t.b,this.a*t.a)}},{key:"multiplyToRef",value:function(e,t){return t.r=this.r*e.r,t.g=this.g*e.g,t.b=this.b*e.b,t.a=this.a*e.a,t}},{key:"toString",value:function(){return"{R: "+this.r+" G:"+this.g+" B:"+this.b+" A:"+this.a+"}"}},{key:"getClassName",value:function(){return"Color4"}},{key:"getHashCode",value:function(){var e=255*this.r|0;return e=397*(e=397*(e=397*e^(255*this.g|0))^(255*this.b|0))^(255*this.a|0)}},{key:"clone",value:function(){return new e(this.r,this.g,this.b,this.a)}},{key:"copyFrom",value:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this.a=e.a,this}},{key:"copyFromFloats",value:function(e,t,n,i){return this.r=e,this.g=t,this.b=n,this.a=i,this}},{key:"set",value:function(e,t,n,i){return this.copyFromFloats(e,t,n,i)}},{key:"toHexString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=Math.round(255*this.r),n=Math.round(255*this.g),i=Math.round(255*this.b);if(e)return"#"+a.R.ToHex(t)+a.R.ToHex(n)+a.R.ToHex(i);var r=Math.round(255*this.a);return"#"+a.R.ToHex(t)+a.R.ToHex(n)+a.R.ToHex(i)+a.R.ToHex(r)}},{key:"toLinearSpace",value:function(){var t=new e;return this.toLinearSpaceToRef(t),t}},{key:"toLinearSpaceToRef",value:function(e){return e.r=Math.pow(this.r,o.Nn),e.g=Math.pow(this.g,o.Nn),e.b=Math.pow(this.b,o.Nn),e.a=this.a,this}},{key:"toGammaSpace",value:function(){var t=new e;return this.toGammaSpaceToRef(t),t}},{key:"toGammaSpaceToRef",value:function(e){return e.r=Math.pow(this.r,o.zp),e.g=Math.pow(this.g,o.zp),e.b=Math.pow(this.b,o.zp),e.a=this.a,this}}],[{key:"FromHexString",value:function(t){if("#"!==t.substring(0,1)||9!==t.length&&7!==t.length)return new e(0,0,0,0);var n=parseInt(t.substring(1,3),16),i=parseInt(t.substring(3,5),16),r=parseInt(t.substring(5,7),16),a=9===t.length?parseInt(t.substring(7,9),16):255;return e.FromInts(n,i,r,a)}},{key:"Lerp",value:function(t,n,i){var r=new e(0,0,0,0);return e.LerpToRef(t,n,i,r),r}},{key:"LerpToRef",value:function(e,t,n,i){i.r=e.r+(t.r-e.r)*n,i.g=e.g+(t.g-e.g)*n,i.b=e.b+(t.b-e.b)*n,i.a=e.a+(t.a-e.a)*n}},{key:"Hermite",value:function(t,n,i,r,a){var o=a*a,s=a*o,u=2*s-3*o+1,l=-2*s+3*o,c=s-2*o+a,h=s-o;return new e(t.r*u+i.r*l+n.r*c+r.r*h,t.g*u+i.g*l+n.g*c+r.g*h,t.b*u+i.b*l+n.b*c+r.b*h,t.a*u+i.a*l+n.a*c+r.a*h)}},{key:"Hermite1stDerivative",value:function(t,n,i,r,a){var o=new e;return this.Hermite1stDerivativeToRef(t,n,i,r,a,o),o}},{key:"Hermite1stDerivativeToRef",value:function(e,t,n,i,r,a){var o=r*r;a.r=6*(o-r)*e.r+(3*o-4*r+1)*t.r+6*(-o+r)*n.r+(3*o-2*r)*i.r,a.g=6*(o-r)*e.g+(3*o-4*r+1)*t.g+6*(-o+r)*n.g+(3*o-2*r)*i.g,a.b=6*(o-r)*e.b+(3*o-4*r+1)*t.b+6*(-o+r)*n.b+(3*o-2*r)*i.b,a.a=6*(o-r)*e.a+(3*o-4*r+1)*t.a+6*(-o+r)*n.a+(3*o-2*r)*i.a}},{key:"FromColor3",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return new e(t.r,t.g,t.b,n)}},{key:"FromArray",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return new e(t[n],t[n+1],t[n+2],t[n+3])}},{key:"FromArrayToRef",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;n.r=e[t],n.g=e[t+1],n.b=e[t+2],n.a=e[t+3]}},{key:"FromInts",value:function(t,n,i,r){return new e(t/255,n/255,i/255,r/255)}},{key:"CheckColors4",value:function(e,t){if(e.length===3*t){for(var n=[],i=0;i<e.length;i+=3){var r=i/3*4;n[r]=e[i],n[r+1]=e[i+1],n[r+2]=e[i+2],n[r+3]=1}return n}return e}}]),e}(),h=(0,r.Z)((function e(){(0,i.Z)(this,e)}));h.Color3=s.B.BuildArray(3,l.Black),h.Color4=s.B.BuildArray(3,(function(){return new c(0,0,0,0)})),(0,u.H)("BABYLON.Color3",l),(0,u.H)("BABYLON.Color4",c)},3681:function(e,t,n){"use strict";n.d(t,{Nn:function(){return r},kn:function(){return a},zp:function(){return i}});var i=1/2.2,r=2.2,a=(Math.sqrt(5),.001)},2465:function(e,t,n){"use strict";n.d(t,{i:function(){return o}});var i=n(5671),r=n(3144),a=n(3683),o=function(){function e(){(0,i.Z)(this,e)}return(0,r.Z)(e,null,[{key:"GetPlanes",value:function(t){for(var n=[],i=0;i<6;i++)n.push(new a.J(0,0,0,0));return e.GetPlanesToRef(t,n),n}},{key:"GetNearPlaneToRef",value:function(e,t){var n=e.m;t.normal.x=n[3]+n[2],t.normal.y=n[7]+n[6],t.normal.z=n[11]+n[10],t.d=n[15]+n[14],t.normalize()}},{key:"GetFarPlaneToRef",value:function(e,t){var n=e.m;t.normal.x=n[3]-n[2],t.normal.y=n[7]-n[6],t.normal.z=n[11]-n[10],t.d=n[15]-n[14],t.normalize()}},{key:"GetLeftPlaneToRef",value:function(e,t){var n=e.m;t.normal.x=n[3]+n[0],t.normal.y=n[7]+n[4],t.normal.z=n[11]+n[8],t.d=n[15]+n[12],t.normalize()}},{key:"GetRightPlaneToRef",value:function(e,t){var n=e.m;t.normal.x=n[3]-n[0],t.normal.y=n[7]-n[4],t.normal.z=n[11]-n[8],t.d=n[15]-n[12],t.normalize()}},{key:"GetTopPlaneToRef",value:function(e,t){var n=e.m;t.normal.x=n[3]-n[1],t.normal.y=n[7]-n[5],t.normal.z=n[11]-n[9],t.d=n[15]-n[13],t.normalize()}},{key:"GetBottomPlaneToRef",value:function(e,t){var n=e.m;t.normal.x=n[3]+n[1],t.normal.y=n[7]+n[5],t.normal.z=n[11]+n[9],t.d=n[15]+n[13],t.normalize()}},{key:"GetPlanesToRef",value:function(t,n){e.GetNearPlaneToRef(t,n[0]),e.GetFarPlaneToRef(t,n[1]),e.GetLeftPlaneToRef(t,n[2]),e.GetRightPlaneToRef(t,n[3]),e.GetTopPlaneToRef(t,n[4]),e.GetBottomPlaneToRef(t,n[5])}}]),e}()},7721:function(e,t,n){"use strict";n.d(t,{k:function(){return c},y:function(){return l}});var i=n(5671),r=n(3144),a=n(9477),o=n(6900),s=n(9336),u=function(){function e(){(0,i.Z)(this,e)}return(0,r.Z)(e,null,[{key:"extractMinAndMaxIndexed",value:function(e,t,n,i,r,a){for(var o=n;o<n+i;o++){var s=3*t[o],u=e[s],l=e[s+1],c=e[s+2];r.minimizeInPlaceFromFloats(u,l,c),a.maximizeInPlaceFromFloats(u,l,c)}}},{key:"extractMinAndMax",value:function(e,t,n,i,r,a){for(var o=t,s=t*i;o<t+n;o++,s+=i){var u=e[s],l=e[s+1],c=e[s+2];r.minimizeInPlaceFromFloats(u,l,c),a.maximizeInPlaceFromFloats(u,l,c)}}}]),e}();function l(e,t,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=new o.P(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),s=new o.P(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);return u.extractMinAndMaxIndexed(e,t,n,i,a,s),r&&(a.x-=a.x*r.x+r.y,a.y-=a.y*r.x+r.y,a.z-=a.z*r.x+r.y,s.x+=s.x*r.x+r.y,s.y+=s.y*r.x+r.y,s.z+=s.z*r.x+r.y),{minimum:a,maximum:s}}function c(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4?arguments[4]:void 0,a=new o.P(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),s=new o.P(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);return r||(r=3),u.extractMinAndMax(e,t,n,r,a,s),i&&(a.x-=a.x*i.x+i.y,a.y-=a.y*i.x+i.y,a.z-=a.z*i.x+i.y,s.x+=s.x*i.x+i.y,s.y+=s.y*i.x+i.y,s.z+=s.z*i.x+i.y),{minimum:a,maximum:s}}(0,a.gn)([s.G6.filter((function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=t[0],r=t[1];return!Array.isArray(i)&&!Array.isArray(r)}))],u,"extractMinAndMaxIndexed",null),(0,a.gn)([s.G6.filter((function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=t[0];return!Array.isArray(i)}))],u,"extractMinAndMax",null)},3683:function(e,t,n){"use strict";n.d(t,{J:function(){return o}});var i=n(5671),r=n(3144),a=n(6900),o=function(){function e(t,n,r,o){(0,i.Z)(this,e),this.normal=new a.P(t,n,r),this.d=o}return(0,r.Z)(e,[{key:"asArray",value:function(){return[this.normal.x,this.normal.y,this.normal.z,this.d]}},{key:"clone",value:function(){return new e(this.normal.x,this.normal.y,this.normal.z,this.d)}},{key:"getClassName",value:function(){return"Plane"}},{key:"getHashCode",value:function(){var e=this.normal.getHashCode();return e=397*e^(0|this.d)}},{key:"normalize",value:function(){var e=Math.sqrt(this.normal.x*this.normal.x+this.normal.y*this.normal.y+this.normal.z*this.normal.z),t=0;return 0!==e&&(t=1/e),this.normal.x*=t,this.normal.y*=t,this.normal.z*=t,this.d*=t,this}},{key:"transform",value:function(t){var n=e._TmpMatrix;t.invertToRef(n);var i=n.m,r=this.normal.x,a=this.normal.y,o=this.normal.z,s=this.d;return new e(r*i[0]+a*i[1]+o*i[2]+s*i[3],r*i[4]+a*i[5]+o*i[6]+s*i[7],r*i[8]+a*i[9]+o*i[10]+s*i[11],r*i[12]+a*i[13]+o*i[14]+s*i[15])}},{key:"dotCoordinate",value:function(e){return this.normal.x*e.x+this.normal.y*e.y+this.normal.z*e.z+this.d}},{key:"copyFromPoints",value:function(e,t,n){var i,r=t.x-e.x,a=t.y-e.y,o=t.z-e.z,s=n.x-e.x,u=n.y-e.y,l=n.z-e.z,c=a*l-o*u,h=o*s-r*l,f=r*u-a*s,d=Math.sqrt(c*c+h*h+f*f);return i=0!==d?1/d:0,this.normal.x=c*i,this.normal.y=h*i,this.normal.z=f*i,this.d=-(this.normal.x*e.x+this.normal.y*e.y+this.normal.z*e.z),this}},{key:"isFrontFacingTo",value:function(e,t){return a.P.Dot(this.normal,e)<=t}},{key:"signedDistanceTo",value:function(e){return a.P.Dot(e,this.normal)+this.d}}],[{key:"FromArray",value:function(t){return new e(t[0],t[1],t[2],t[3])}},{key:"FromPoints",value:function(t,n,i){var r=new e(0,0,0,0);return r.copyFromPoints(t,n,i),r}},{key:"FromPositionAndNormal",value:function(t,n){var i=new e(0,0,0,0);return n.normalize(),i.normal=n,i.d=-(n.x*t.x+n.y*t.y+n.z*t.z),i}},{key:"SignedDistanceToPlaneFromPositionAndNormal",value:function(e,t,n){var i=-(t.x*e.x+t.y*e.y+t.z*e.z);return a.P.Dot(n,t)+i}}]),e}();o._TmpMatrix=a.y3.Identity()},5602:function(e,t,n){"use strict";n.d(t,{R:function(){return a}});var i=n(5671),r=n(3144),a=function(){function e(){(0,i.Z)(this,e)}return(0,r.Z)(e,null,[{key:"WithinEpsilon",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1401298e-51;return Math.abs(e-t)<=n}},{key:"ToHex",value:function(e){var t=e.toString(16);return e<=15?("0"+t).toUpperCase():t.toUpperCase()}},{key:"Sign",value:function(e){return 0===(e=+e)||isNaN(e)?e:e>0?1:-1}},{key:"Clamp",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return Math.min(n,Math.max(t,e))}},{key:"Log2",value:function(e){return Math.log(e)*Math.LOG2E}},{key:"ILog2",value:function(e){if(Math.log2)return Math.floor(Math.log2(e));if(e<0)return NaN;if(0===e)return-1/0;var t=0;if(e<1){for(;e<1;)t++,e*=2;t=-t}else if(e>1)for(;e>1;)t++,e=Math.floor(e/2);return t}},{key:"Repeat",value:function(e,t){return e-Math.floor(e/t)*t}},{key:"Normalize",value:function(e,t,n){return(e-t)/(n-t)}},{key:"Denormalize",value:function(e,t,n){return e*(n-t)+t}},{key:"DeltaAngle",value:function(t,n){var i=e.Repeat(n-t,360);return i>180&&(i-=360),i}},{key:"PingPong",value:function(t,n){var i=e.Repeat(t,2*n);return n-Math.abs(i-n)}},{key:"SmoothStep",value:function(t,n,i){var r=e.Clamp(i);return n*(r=-2*r*r*r+3*r*r)+t*(1-r)}},{key:"MoveTowards",value:function(t,n,i){return Math.abs(n-t)<=i?n:t+e.Sign(n-t)*i}},{key:"MoveTowardsAngle",value:function(t,n,i){var r=e.DeltaAngle(t,n),a=0;return-i<r&&r<i?a=n:(n=t+r,a=e.MoveTowards(t,n,i)),a}},{key:"Lerp",value:function(e,t,n){return e+(t-e)*n}},{key:"LerpAngle",value:function(t,n,i){var r=e.Repeat(n-t,360);return r>180&&(r-=360),t+r*e.Clamp(i)}},{key:"InverseLerp",value:function(t,n,i){return t!=n?e.Clamp((i-t)/(n-t)):0}},{key:"Hermite",value:function(e,t,n,i,r){var a=r*r,o=r*a;return e*(2*o-3*a+1)+n*(-2*o+3*a)+t*(o-2*a+r)+i*(o-a)}},{key:"Hermite1stDerivative",value:function(e,t,n,i,r){var a=r*r;return 6*(a-r)*e+(3*a-4*r+1)*t+6*(-a+r)*n+(3*a-2*r)*i}},{key:"RandomRange",value:function(e,t){return e===t?e:Math.random()*(t-e)+e}},{key:"RangeToPercent",value:function(e,t,n){return(e-t)/(n-t)}},{key:"PercentToRange",value:function(e,t,n){return(n-t)*e+t}},{key:"NormalizeRadians",value:function(t){return t-=e.TwoPi*Math.floor((t+Math.PI)/e.TwoPi)}},{key:"HCF",value:function(t,n){var i=t%n;return 0===i?n:e.HCF(n,i)}}]),e}();a.TwoPi=2*Math.PI},628:function(e,t,n){"use strict";n.d(t,{l:function(){return a}});var i=n(5671),r=n(3144),a=function(){function e(t,n,r,a){(0,i.Z)(this,e),this.x=t,this.y=n,this.width=r,this.height=a}return(0,r.Z)(e,[{key:"toGlobal",value:function(t,n){return new e(this.x*t,this.y*n,this.width*t,this.height*n)}},{key:"toGlobalToRef",value:function(e,t,n){return n.x=this.x*e,n.y=this.y*t,n.width=this.width*e,n.height=this.height*t,this}},{key:"clone",value:function(){return new e(this.x,this.y,this.width,this.height)}}]),e}()},2628:function(e,t,n){"use strict";n.d(t,{M:function(){return l}});var i=n(5671),r=n(3144),a=n(136),o=n(6215),s=n(1120);function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,s.Z)(e);if(t){var r=(0,s.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,o.Z)(this,n)}}var l=function(e){(0,a.Z)(n,e);var t=u(n);function n(e){var r;return(0,i.Z)(this,n),(r=t.call(this))._buffer=e,r}return(0,r.Z)(n,[{key:"underlyingResource",get:function(){return this._buffer}}]),n}(n(7818).h)},9370:function(e,t,n){"use strict";n.d(t,{x:function(){return k}});var i=n(7326),r=n(1752),a=n(136),o=n(6215),s=n(1120),u=n(3144),l=n(5671),c=n(4174),h=n(8911),f=n(6900),d=n(2977),p=n(2845),v=n(4527),m=n(2668),g=n(3541),_=n(9115),y=n(1952),E=(0,u.Z)((function e(){(0,l.Z)(this,e),this._checkCollisions=!1,this._collisionMask=-1,this._collisionGroup=-1,this._surroundingMeshes=null,this._collider=null,this._oldPositionForCollisions=new f.P(0,0,0),this._diffPositionForCollisions=new f.P(0,0,0),this._collisionResponse=!0})),A=n(5230),b=n(7721),T=n(7046),M=n(3681),S=n(7702),I=n(1704);function x(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return C(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return C(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function P(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,s.Z)(e);if(t){var r=(0,s.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,o.Z)(this,n)}}var D=(0,u.Z)((function e(){(0,l.Z)(this,e),this.facetNb=0,this.partitioningSubdivisions=10,this.partitioningBBoxRatio=1.01,this.facetDataEnabled=!1,this.facetParameters={},this.bbSize=f.P.Zero(),this.subDiv={max:1,X:1,Y:1,Z:1},this.facetDepthSort=!1,this.facetDepthSortEnabled=!1})),R=(0,u.Z)((function e(){(0,l.Z)(this,e),this._hasVertexAlpha=!1,this._useVertexColors=!0,this._numBoneInfluencers=4,this._applyFog=!0,this._receiveShadows=!1,this._facetData=new D,this._visibility=1,this._skeleton=null,this._layerMask=268435455,this._computeBonesUsingShaders=!0,this._isActive=!1,this._onlyForInstances=!1,this._isActiveIntermediate=!1,this._onlyForInstancesIntermediate=!1,this._actAsRegularMesh=!1,this._currentLOD=null,this._currentLODIsUpToDate=!1,this._collisionRetryCount=3,this._morphTargetManager=null,this._renderingGroupId=0,this._bakedVertexAnimationManager=null,this._material=null,this._positions=null,this._meshCollisionData=new E,this._enableDistantPicking=!1})),k=function(e){(0,a.Z)(n,e);var t=P(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;switch((0,l.Z)(this,n),(r=t.call(this,e,a,!1))._internalAbstractMeshDataInfo=new R,r._waitingMaterialId=null,r.cullingStrategy=n.CULLINGSTRATEGY_BOUNDINGSPHERE_ONLY,r.onCollideObservable=new c.y$,r.onCollisionPositionChangeObservable=new c.y$,r.onMaterialChangedObservable=new c.y$,r.definedFacingForward=!0,r._occlusionQuery=null,r._renderingGroup=null,r.alphaIndex=Number.MAX_VALUE,r.isVisible=!0,r.isPickable=!0,r.isNearPickable=!1,r.isNearGrabbable=!1,r.showSubMeshesBoundingBox=!1,r.isBlocker=!1,r.enablePointerMoveEvents=!1,r.outlineColor=T.Wo.Red(),r.outlineWidth=.02,r.overlayColor=T.Wo.Red(),r.overlayAlpha=.5,r.useOctreeForRenderingSelection=!0,r.useOctreeForPicking=!0,r.useOctreeForCollisions=!0,r.alwaysSelectAsActiveMesh=!1,r.doNotSyncBoundingInfo=!1,r.actionManager=null,r.ellipsoid=new f.P(.5,1,.5),r.ellipsoidOffset=new f.P(0,0,0),r.edgesWidth=1,r.edgesColor=new T.HE(1,0,0,1),r._edgesRenderer=null,r._masterMesh=null,r._boundingInfo=null,r._boundingInfoIsDirty=!0,r._renderId=0,r._intersectionsInProgress=new Array,r._unIndexed=!1,r._lightSources=new Array,r._waitingData={lods:null,actions:null,freezeWorldMatrix:null},r._bonesTransformMatrices=null,r._transformMatrixTexture=null,r.onRebuildObservable=new c.y$,r._onCollisionPositionChange=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;t.subtractToRef(r._internalAbstractMeshDataInfo._meshCollisionData._oldPositionForCollisions,r._internalAbstractMeshDataInfo._meshCollisionData._diffPositionForCollisions),r._internalAbstractMeshDataInfo._meshCollisionData._diffPositionForCollisions.length()>d.D.CollisionsEpsilon&&r.position.addInPlace(r._internalAbstractMeshDataInfo._meshCollisionData._diffPositionForCollisions),n&&r.onCollideObservable.notifyObservers(n),r.onCollisionPositionChangeObservable.notifyObservers(r.position)},(a=r.getScene()).addMesh((0,i.Z)(r)),r._resyncLightSources(),r._uniformBuffer=new y.M(r.getScene().getEngine(),void 0,void 0,e,!r.getScene().getEngine().isWebGPU),r._buildUniformLayout(),a.performancePriority){case h.a.Aggressive:r.doNotSyncBoundingInfo=!0;case h.a.Intermediate:r.alwaysSelectAsActiveMesh=!0,r.isPickable=!1}return r}return(0,u.Z)(n,[{key:"facetNb",get:function(){return this._internalAbstractMeshDataInfo._facetData.facetNb}},{key:"partitioningSubdivisions",get:function(){return this._internalAbstractMeshDataInfo._facetData.partitioningSubdivisions},set:function(e){this._internalAbstractMeshDataInfo._facetData.partitioningSubdivisions=e}},{key:"partitioningBBoxRatio",get:function(){return this._internalAbstractMeshDataInfo._facetData.partitioningBBoxRatio},set:function(e){this._internalAbstractMeshDataInfo._facetData.partitioningBBoxRatio=e}},{key:"mustDepthSortFacets",get:function(){return this._internalAbstractMeshDataInfo._facetData.facetDepthSort},set:function(e){this._internalAbstractMeshDataInfo._facetData.facetDepthSort=e}},{key:"facetDepthSortFrom",get:function(){return this._internalAbstractMeshDataInfo._facetData.facetDepthSortFrom},set:function(e){this._internalAbstractMeshDataInfo._facetData.facetDepthSortFrom=e}},{key:"collisionRetryCount",get:function(){return this._internalAbstractMeshDataInfo._collisionRetryCount},set:function(e){this._internalAbstractMeshDataInfo._collisionRetryCount=e}},{key:"isFacetDataEnabled",get:function(){return this._internalAbstractMeshDataInfo._facetData.facetDataEnabled}},{key:"morphTargetManager",get:function(){return this._internalAbstractMeshDataInfo._morphTargetManager},set:function(e){this._internalAbstractMeshDataInfo._morphTargetManager!==e&&(this._internalAbstractMeshDataInfo._morphTargetManager=e,this._syncGeometryWithMorphTargetManager())}},{key:"bakedVertexAnimationManager",get:function(){return this._internalAbstractMeshDataInfo._bakedVertexAnimationManager},set:function(e){this._internalAbstractMeshDataInfo._bakedVertexAnimationManager!==e&&(this._internalAbstractMeshDataInfo._bakedVertexAnimationManager=e,this._markSubMeshesAsAttributesDirty())}},{key:"_syncGeometryWithMorphTargetManager",value:function(){}},{key:"_updateNonUniformScalingState",value:function(e){return!!(0,r.Z)((0,s.Z)(n.prototype),"_updateNonUniformScalingState",this).call(this,e)&&(this._markSubMeshesAsMiscDirty(),!0)}},{key:"onCollide",set:function(e){this._internalAbstractMeshDataInfo._meshCollisionData._onCollideObserver&&this.onCollideObservable.remove(this._internalAbstractMeshDataInfo._meshCollisionData._onCollideObserver),this._internalAbstractMeshDataInfo._meshCollisionData._onCollideObserver=this.onCollideObservable.add(e)}},{key:"onCollisionPositionChange",set:function(e){this._internalAbstractMeshDataInfo._meshCollisionData._onCollisionPositionChangeObserver&&this.onCollisionPositionChangeObservable.remove(this._internalAbstractMeshDataInfo._meshCollisionData._onCollisionPositionChangeObserver),this._internalAbstractMeshDataInfo._meshCollisionData._onCollisionPositionChangeObserver=this.onCollisionPositionChangeObservable.add(e)}},{key:"visibility",get:function(){return this._internalAbstractMeshDataInfo._visibility},set:function(e){if(this._internalAbstractMeshDataInfo._visibility!==e){var t=this._internalAbstractMeshDataInfo._visibility;this._internalAbstractMeshDataInfo._visibility=e,(1===t&&1!==e||1!==t&&1===e)&&this._markSubMeshesAsMiscDirty()}}},{key:"renderingGroupId",get:function(){return this._internalAbstractMeshDataInfo._renderingGroupId},set:function(e){this._internalAbstractMeshDataInfo._renderingGroupId=e}},{key:"material",get:function(){return this._internalAbstractMeshDataInfo._material},set:function(e){this._internalAbstractMeshDataInfo._material!==e&&(this._internalAbstractMeshDataInfo._material&&this._internalAbstractMeshDataInfo._material.meshMap&&(this._internalAbstractMeshDataInfo._material.meshMap[this.uniqueId]=void 0),this._internalAbstractMeshDataInfo._material=e,e&&e.meshMap&&(e.meshMap[this.uniqueId]=this),this.onMaterialChangedObservable.hasObservers()&&this.onMaterialChangedObservable.notifyObservers(this),this.subMeshes&&(this.resetDrawCache(),this._unBindEffect()))}},{key:"getMaterialForRenderPass",value:function(e){var t;return null===(t=this._internalAbstractMeshDataInfo._materialForRenderPass)||void 0===t?void 0:t[e]}},{key:"setMaterialForRenderPass",value:function(e,t){this.resetDrawCache(e),this._internalAbstractMeshDataInfo._materialForRenderPass||(this._internalAbstractMeshDataInfo._materialForRenderPass=[]),this._internalAbstractMeshDataInfo._materialForRenderPass[e]=t}},{key:"receiveShadows",get:function(){return this._internalAbstractMeshDataInfo._receiveShadows},set:function(e){this._internalAbstractMeshDataInfo._receiveShadows!==e&&(this._internalAbstractMeshDataInfo._receiveShadows=e,this._markSubMeshesAsLightDirty())}},{key:"hasVertexAlpha",get:function(){return this._internalAbstractMeshDataInfo._hasVertexAlpha},set:function(e){this._internalAbstractMeshDataInfo._hasVertexAlpha!==e&&(this._internalAbstractMeshDataInfo._hasVertexAlpha=e,this._markSubMeshesAsAttributesDirty(),this._markSubMeshesAsMiscDirty())}},{key:"useVertexColors",get:function(){return this._internalAbstractMeshDataInfo._useVertexColors},set:function(e){this._internalAbstractMeshDataInfo._useVertexColors!==e&&(this._internalAbstractMeshDataInfo._useVertexColors=e,this._markSubMeshesAsAttributesDirty())}},{key:"computeBonesUsingShaders",get:function(){return this._internalAbstractMeshDataInfo._computeBonesUsingShaders},set:function(e){this._internalAbstractMeshDataInfo._computeBonesUsingShaders!==e&&(this._internalAbstractMeshDataInfo._computeBonesUsingShaders=e,this._markSubMeshesAsAttributesDirty())}},{key:"numBoneInfluencers",get:function(){return this._internalAbstractMeshDataInfo._numBoneInfluencers},set:function(e){this._internalAbstractMeshDataInfo._numBoneInfluencers!==e&&(this._internalAbstractMeshDataInfo._numBoneInfluencers=e,this._markSubMeshesAsAttributesDirty())}},{key:"applyFog",get:function(){return this._internalAbstractMeshDataInfo._applyFog},set:function(e){this._internalAbstractMeshDataInfo._applyFog!==e&&(this._internalAbstractMeshDataInfo._applyFog=e,this._markSubMeshesAsMiscDirty())}},{key:"enableDistantPicking",get:function(){return this._internalAbstractMeshDataInfo._enableDistantPicking},set:function(e){this._internalAbstractMeshDataInfo._enableDistantPicking=e}},{key:"layerMask",get:function(){return this._internalAbstractMeshDataInfo._layerMask},set:function(e){e!==this._internalAbstractMeshDataInfo._layerMask&&(this._internalAbstractMeshDataInfo._layerMask=e,this._resyncLightSources())}},{key:"collisionMask",get:function(){return this._internalAbstractMeshDataInfo._meshCollisionData._collisionMask},set:function(e){this._internalAbstractMeshDataInfo._meshCollisionData._collisionMask=isNaN(e)?-1:e}},{key:"collisionResponse",get:function(){return this._internalAbstractMeshDataInfo._meshCollisionData._collisionResponse},set:function(e){this._internalAbstractMeshDataInfo._meshCollisionData._collisionResponse=e}},{key:"collisionGroup",get:function(){return this._internalAbstractMeshDataInfo._meshCollisionData._collisionGroup},set:function(e){this._internalAbstractMeshDataInfo._meshCollisionData._collisionGroup=isNaN(e)?-1:e}},{key:"surroundingMeshes",get:function(){return this._internalAbstractMeshDataInfo._meshCollisionData._surroundingMeshes},set:function(e){this._internalAbstractMeshDataInfo._meshCollisionData._surroundingMeshes=e}},{key:"lightSources",get:function(){return this._lightSources}},{key:"_positions",get:function(){return null}},{key:"skeleton",get:function(){return this._internalAbstractMeshDataInfo._skeleton},set:function(e){var t=this._internalAbstractMeshDataInfo._skeleton;t&&t.needInitialSkinMatrix&&t._unregisterMeshWithPoseMatrix(this),e&&e.needInitialSkinMatrix&&e._registerMeshWithPoseMatrix(this),this._internalAbstractMeshDataInfo._skeleton=e,this._internalAbstractMeshDataInfo._skeleton||(this._bonesTransformMatrices=null),this._markSubMeshesAsAttributesDirty()}},{key:"_buildUniformLayout",value:function(){this._uniformBuffer.addUniform("world",16),this._uniformBuffer.addUniform("visibility",1),this._uniformBuffer.create()}},{key:"transferToEffect",value:function(e){var t=this._uniformBuffer;t.updateMatrix("world",e),t.updateFloat("visibility",this._internalAbstractMeshDataInfo._visibility),t.update()}},{key:"getMeshUniformBuffer",value:function(){return this._uniformBuffer}},{key:"getClassName",value:function(){return"AbstractMesh"}},{key:"toString",value:function(e){var t="Name: "+this.name+", isInstance: "+("InstancedMesh"!==this.getClassName()?"YES":"NO");t+=", # of submeshes: "+(this.subMeshes?this.subMeshes.length:0);var n=this._internalAbstractMeshDataInfo._skeleton;return n&&(t+=", skeleton: "+n.name),e&&(t+=", billboard mode: "+["NONE","X","Y",null,"Z",null,null,"ALL"][this.billboardMode],t+=", freeze wrld mat: "+(this._isWorldMatrixFrozen||this._waitingData.freezeWorldMatrix?"YES":"NO")),t}},{key:"_getEffectiveParent",value:function(){return this._masterMesh&&this.billboardMode!==m.Y.BILLBOARDMODE_NONE?this._masterMesh:(0,r.Z)((0,s.Z)(n.prototype),"_getEffectiveParent",this).call(this)}},{key:"_getActionManagerForTrigger",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.actionManager&&(t||this.actionManager.isRecursive)){if(!e)return this.actionManager;if(this.actionManager.hasSpecificTrigger(e))return this.actionManager}return this.parent?this.parent._getActionManagerForTrigger(e,!1):null}},{key:"_rebuild",value:function(){if(this.onRebuildObservable.notifyObservers(this),null!==this._occlusionQuery&&(this._occlusionQuery=null),this.subMeshes){var e,t=x(this.subMeshes);try{for(t.s();!(e=t.n()).done;){var n=e.value;n._rebuild()}}catch(i){t.e(i)}finally{t.f()}}}},{key:"_resyncLightSources",value:function(){this._lightSources.length=0;var e,t=x(this.getScene().lights);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.isEnabled()&&(n.canAffectMesh(this)&&this._lightSources.push(n))}}catch(i){t.e(i)}finally{t.f()}this._markSubMeshesAsLightDirty()}},{key:"_resyncLightSource",value:function(e){var t=e.isEnabled()&&e.canAffectMesh(this),n=this._lightSources.indexOf(e),i=!1;if(-1===n){if(!t)return;this._lightSources.push(e)}else{if(t)return;i=!0,this._lightSources.splice(n,1)}this._markSubMeshesAsLightDirty(i)}},{key:"_unBindEffect",value:function(){var e,t=x(this.subMeshes);try{for(t.s();!(e=t.n()).done;){e.value.setEffect(null)}}catch(n){t.e(n)}finally{t.f()}}},{key:"_removeLightSource",value:function(e,t){var n=this._lightSources.indexOf(e);-1!==n&&(this._lightSources.splice(n,1),this._markSubMeshesAsLightDirty(t))}},{key:"_markSubMeshesAsDirty",value:function(e){if(this.subMeshes){var t,n=x(this.subMeshes);try{for(n.s();!(t=n.n()).done;)for(var i=t.value,r=0;r<i._drawWrappers.length;++r){var a=i._drawWrappers[r];a&&a.defines&&a.defines.markAllAsDirty&&e(a.defines)}}catch(o){n.e(o)}finally{n.f()}}}},{key:"_markSubMeshesAsLightDirty",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._markSubMeshesAsDirty((function(t){return t.markAsLightDirty(e)}))}},{key:"_markSubMeshesAsAttributesDirty",value:function(){this._markSubMeshesAsDirty((function(e){return e.markAsAttributesDirty()}))}},{key:"_markSubMeshesAsMiscDirty",value:function(){this._markSubMeshesAsDirty((function(e){return e.markAsMiscDirty()}))}},{key:"markAsDirty",value:function(e){return this._currentRenderId=Number.MAX_VALUE,this._isDirty=!0,this}},{key:"resetDrawCache",value:function(e){if(this.subMeshes){var t,n=x(this.subMeshes);try{for(n.s();!(t=n.n()).done;){t.value.resetDrawCache(e)}}catch(i){n.e(i)}finally{n.f()}}}},{key:"isBlocked",get:function(){return!1}},{key:"getLOD",value:function(e){return this}},{key:"getTotalVertices",value:function(){return 0}},{key:"getTotalIndices",value:function(){return 0}},{key:"getIndices",value:function(){return null}},{key:"getVerticesData",value:function(e){return null}},{key:"setVerticesData",value:function(e,t,n,i){return this}},{key:"updateVerticesData",value:function(e,t,n,i){return this}},{key:"setIndices",value:function(e,t){return this}},{key:"isVerticesDataPresent",value:function(e){return!1}},{key:"getBoundingInfo",value:function(){return this._masterMesh?this._masterMesh.getBoundingInfo():(this._boundingInfoIsDirty&&(this._boundingInfoIsDirty=!1,this._updateBoundingInfo()),this._boundingInfo)}},{key:"setBoundingInfo",value:function(e){return this._boundingInfo=e,this}},{key:"hasBoundingInfo",get:function(){return null!==this._boundingInfo}},{key:"buildBoundingInfo",value:function(e,t,n){return this._boundingInfo=new _.j(e,t,n),this._boundingInfo}},{key:"normalizeToUnitCube",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2?arguments[2]:void 0;return(0,r.Z)((0,s.Z)(n.prototype),"normalizeToUnitCube",this).call(this,e,t,i)}},{key:"useBones",get:function(){return this.skeleton&&this.getScene().skeletonsEnabled&&this.isVerticesDataPresent(p.o.MatricesIndicesKind)&&this.isVerticesDataPresent(p.o.MatricesWeightsKind)}},{key:"_preActivate",value:function(){}},{key:"_preActivateForIntermediateRendering",value:function(e){}},{key:"_activate",value:function(e,t){return this._renderId=e,!0}},{key:"_postActivate",value:function(){}},{key:"_freeze",value:function(){}},{key:"_unFreeze",value:function(){}},{key:"getWorldMatrix",value:function(){return this._masterMesh&&this.billboardMode===m.Y.BILLBOARDMODE_NONE?this._masterMesh.getWorldMatrix():(0,r.Z)((0,s.Z)(n.prototype),"getWorldMatrix",this).call(this)}},{key:"_getWorldMatrixDeterminant",value:function(){return this._masterMesh?this._masterMesh._getWorldMatrixDeterminant():(0,r.Z)((0,s.Z)(n.prototype),"_getWorldMatrixDeterminant",this).call(this)}},{key:"isAnInstance",get:function(){return!1}},{key:"hasInstances",get:function(){return!1}},{key:"hasThinInstances",get:function(){return!1}},{key:"movePOV",value:function(e,t,n){return this.position.addInPlace(this.calcMovePOV(e,t,n)),this}},{key:"calcMovePOV",value:function(e,t,n){var i=new f.y3;(this.rotationQuaternion?this.rotationQuaternion:f._f.RotationYawPitchRoll(this.rotation.y,this.rotation.x,this.rotation.z)).toRotationMatrix(i);var r=f.P.Zero(),a=this.definedFacingForward?-1:1;return f.P.TransformCoordinatesFromFloatsToRef(e*a,t,n*a,i,r),r}},{key:"rotatePOV",value:function(e,t,n){return this.rotation.addInPlace(this.calcRotatePOV(e,t,n)),this}},{key:"calcRotatePOV",value:function(e,t,n){var i=this.definedFacingForward?1:-1;return new f.P(e*i,t,n*i)}},{key:"refreshBoundingInfo",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._boundingInfo&&this._boundingInfo.isLocked||this._refreshBoundingInfo(this._getPositionData(e,t),null),this}},{key:"_refreshBoundingInfo",value:function(e,t){if(e){var n=(0,b.k)(e,0,this.getTotalVertices(),t);this._boundingInfo?this._boundingInfo.reConstruct(n.minimum,n.maximum):this._boundingInfo=new _.j(n.minimum,n.maximum)}if(this.subMeshes)for(var i=0;i<this.subMeshes.length;i++)this.subMeshes[i].refreshBoundingInfo(e);this._updateBoundingInfo()}},{key:"_getData",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2?arguments[2]:void 0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:p.o.PositionKind;if((i=null!==(e=i)&&void 0!==e?e:this.getVerticesData(r).slice())&&n&&this.morphTargetManager)for(var a=0,o=0,s=0;s<i.length;s++){for(var u=0;u<this.morphTargetManager.numTargets;u++){var l=this.morphTargetManager.getTarget(u),c=l.influence;if(c>0){var h=l.getPositions();h&&(i[s]+=(h[s]-i[s])*c)}}if(a++,r===p.o.PositionKind&&this._positions&&3===a){a=0;var d=3*o;this._positions[o++].copyFromFloats(i[d],i[d+1],i[d+2])}}if(i&&t&&this.skeleton){var v=this.getVerticesData(p.o.MatricesIndicesKind),m=this.getVerticesData(p.o.MatricesWeightsKind);if(m&&v)for(var g=this.numBoneInfluencers>4,_=g?this.getVerticesData(p.o.MatricesIndicesExtraKind):null,y=g?this.getVerticesData(p.o.MatricesWeightsExtraKind):null,E=this.skeleton.getTransformMatrices(this),A=f.jp.Vector3[0],b=f.jp.Matrix[0],T=f.jp.Matrix[1],M=0,S=0;S<i.length;S+=3,M+=4){b.reset();var I=void 0,x=void 0;for(I=0;I<4;I++)(x=m[M+I])>0&&(f.y3.FromFloat32ArrayToRefScaled(E,Math.floor(16*v[M+I]),x,T),b.addToSelf(T));if(g)for(I=0;I<4;I++)(x=y[M+I])>0&&(f.y3.FromFloat32ArrayToRefScaled(E,Math.floor(16*_[M+I]),x,T),b.addToSelf(T));r===p.o.NormalKind?f.P.TransformNormalFromFloatsToRef(i[S],i[S+1],i[S+2],b,A):f.P.TransformCoordinatesFromFloatsToRef(i[S],i[S+1],i[S+2],b,A),A.toArray(i,S),r===p.o.PositionKind&&this._positions&&this._positions[S/3].copyFrom(A)}}return i}},{key:"getNormalsData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._getData(e,t,null,p.o.NormalKind)}},{key:"getPositionData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0;return this._getData(e,t,n,p.o.PositionKind)}},{key:"_getPositionData",value:function(e,t){var n=this.getVerticesData(p.o.PositionKind);if(this._internalAbstractMeshDataInfo._positions&&(this._internalAbstractMeshDataInfo._positions=null),n&&(e&&this.skeleton||t&&this.morphTargetManager)){if(n=n.slice(),this._generatePointsArray(),this._positions){var i=this._positions;this._internalAbstractMeshDataInfo._positions=new Array(i.length);for(var r=0;r<i.length;r++){var a;this._internalAbstractMeshDataInfo._positions[r]=(null===(a=i[r])||void 0===a?void 0:a.clone())||new f.P}}return this.getPositionData(e,t,n)}return n}},{key:"_updateBoundingInfo",value:function(){return this._boundingInfo?this._boundingInfo.update(this.worldMatrixFromCache):this._boundingInfo=new _.j(f.P.Zero(),f.P.Zero(),this.worldMatrixFromCache),this._updateSubMeshesBoundingInfo(this.worldMatrixFromCache),this}},{key:"_updateSubMeshesBoundingInfo",value:function(e){if(!this.subMeshes)return this;for(var t=this.subMeshes.length,n=0;n<t;n++){var i=this.subMeshes[n];(t>1||!i.IsGlobal)&&i.updateBoundingInfo(e)}return this}},{key:"_afterComputeWorldMatrix",value:function(){this.doNotSyncBoundingInfo||(this._boundingInfoIsDirty=!0)}},{key:"isInFrustum",value:function(e){return this.getBoundingInfo().isInFrustum(e,this.cullingStrategy)}},{key:"isCompletelyInFrustum",value:function(e){return this.getBoundingInfo().isCompletelyInFrustum(e)}},{key:"intersectsMesh",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,i=this.getBoundingInfo(),r=e.getBoundingInfo();if(i.intersects(r,t))return!0;if(n){var a,o=x(this.getChildMeshes());try{for(o.s();!(a=o.n()).done;){var s=a.value;if(s.intersectsMesh(e,t,!0))return!0}}catch(u){o.e(u)}finally{o.f()}}return!1}},{key:"intersectsPoint",value:function(e){return this.getBoundingInfo().intersectsPoint(e)}},{key:"checkCollisions",get:function(){return this._internalAbstractMeshDataInfo._meshCollisionData._checkCollisions},set:function(e){this._internalAbstractMeshDataInfo._meshCollisionData._checkCollisions=e}},{key:"collider",get:function(){return this._internalAbstractMeshDataInfo._meshCollisionData._collider}},{key:"moveWithCollisions",value:function(e){this.getAbsolutePosition().addToRef(this.ellipsoidOffset,this._internalAbstractMeshDataInfo._meshCollisionData._oldPositionForCollisions);var t=this.getScene().collisionCoordinator;return this._internalAbstractMeshDataInfo._meshCollisionData._collider||(this._internalAbstractMeshDataInfo._meshCollisionData._collider=t.createCollider()),this._internalAbstractMeshDataInfo._meshCollisionData._collider._radius=this.ellipsoid,t.getNewPosition(this._internalAbstractMeshDataInfo._meshCollisionData._oldPositionForCollisions,e,this._internalAbstractMeshDataInfo._meshCollisionData._collider,this.collisionRetryCount,this,this._onCollisionPositionChange,this.uniqueId),this}},{key:"_collideForSubMesh",value:function(e,t,n){var i;if(this._generatePointsArray(),!this._positions)return this;if(!e._lastColliderWorldVertices||!e._lastColliderTransformMatrix.equals(t)){e._lastColliderTransformMatrix=t.clone(),e._lastColliderWorldVertices=[],e._trianglePlanes=[];for(var r=e.verticesStart,a=e.verticesStart+e.verticesCount,o=r;o<a;o++)e._lastColliderWorldVertices.push(f.P.TransformCoordinates(this._positions[o],t))}return n._collide(e._trianglePlanes,e._lastColliderWorldVertices,this.getIndices(),e.indexStart,e.indexStart+e.indexCount,e.verticesStart,!!e.getMaterial(),this,this._shouldConvertRHS(),7===(null===(i=e.getMaterial())||void 0===i?void 0:i.fillMode)),this}},{key:"_processCollisionsForSubMeshes",value:function(e,t){for(var n=this._scene.getCollidingSubMeshCandidates(this,e),i=n.length,r=0;r<i;r++){var a=n.data[r];i>1&&!a._checkCollision(e)||this._collideForSubMesh(a,t,e)}return this}},{key:"_shouldConvertRHS",value:function(){return!1}},{key:"_checkCollision",value:function(e){if(!this.getBoundingInfo()._checkCollision(e))return this;var t=f.jp.Matrix[0],n=f.jp.Matrix[1];return f.y3.ScalingToRef(1/e._radius.x,1/e._radius.y,1/e._radius.z,t),this.worldMatrixFromCache.multiplyToRef(t,n),this._processCollisionsForSubMeshes(e,n),this}},{key:"_generatePointsArray",value:function(){return!1}},{key:"intersects",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4?arguments[4]:void 0,a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=new g.p,s="InstancedLinesMesh"===this.getClassName()||"LinesMesh"===this.getClassName()?this.intersectionThreshold:0,u=this.getBoundingInfo();if(!this.subMeshes)return o;if(!(a||e.intersectsSphere(u.boundingSphere,s)&&e.intersectsBox(u.boundingBox,s)))return o;if(i)return o.hit=!a,o.pickedMesh=a?null:this,o.distance=a?0:f.P.Distance(e.origin,u.boundingSphere.center),o.subMeshId=0,o;if(!this._generatePointsArray())return o;for(var l=null,c=this._scene.getIntersectingSubMeshCandidates(this,e),h=c.length,d=!1,p=0;p<h;p++){var v=c.data[p],m=v.getMaterial();if(m&&(7==m.fillMode||0==m.fillMode||1==m.fillMode||2==m.fillMode||4==m.fillMode)){d=!0;break}}if(!d)return o.hit=!0,o.pickedMesh=this,o.distance=f.P.Distance(e.origin,u.boundingSphere.center),o.subMeshId=-1,o;for(var _=0;_<h;_++){var y=c.data[_];if(!(h>1)||y.canIntersects(e)){var E=y.intersects(e,this._positions,this.getIndices(),t,n);if(E&&(t||!l||E.distance<l.distance)&&((l=E).subMeshId=_,t))break}}if(l){var A=null!=r?r:this.getWorldMatrix(),b=f.jp.Vector3[0],T=f.jp.Vector3[1];f.P.TransformCoordinatesToRef(e.origin,A,b),e.direction.scaleToRef(l.distance,T);var M=f.P.TransformNormal(T,A),S=M.addInPlace(b);return o.hit=!0,o.distance=f.P.Distance(b,S),o.pickedPoint=S,o.pickedMesh=this,o.bu=l.bu||0,o.bv=l.bv||0,o.subMeshFaceId=l.faceId,o.faceId=l.faceId+c.data[l.subMeshId].indexStart/(-1!==this.getClassName().indexOf("LinesMesh")?2:3),o.subMeshId=l.subMeshId,o}return o}},{key:"clone",value:function(e,t,n){return null}},{key:"releaseSubMeshes",value:function(){if(this.subMeshes)for(;this.subMeshes.length;)this.subMeshes[0].dispose();else this.subMeshes=new Array;return this}},{key:"dispose",value:function(e){var t,i=this,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];for(this._scene.useMaterialMeshMap&&this._internalAbstractMeshDataInfo._material&&this._internalAbstractMeshDataInfo._material.meshMap&&(this._internalAbstractMeshDataInfo._material.meshMap[this.uniqueId]=void 0),this.getScene().freeActiveMeshes(),this.getScene().freeRenderingGroups(),void 0!==this.actionManager&&null!==this.actionManager&&(this.actionManager.dispose(),this.actionManager=null),this._internalAbstractMeshDataInfo._skeleton=null,this._transformMatrixTexture&&(this._transformMatrixTexture.dispose(),this._transformMatrixTexture=null),t=0;t<this._intersectionsInProgress.length;t++){var o=this._intersectionsInProgress[t],u=o._intersectionsInProgress.indexOf(this);o._intersectionsInProgress.splice(u,1)}this._intersectionsInProgress.length=0;var l=this.getScene().lights;l.forEach((function(e){var t=e.includedOnlyMeshes.indexOf(i);-1!==t&&e.includedOnlyMeshes.splice(t,1),-1!==(t=e.excludedMeshes.indexOf(i))&&e.excludedMeshes.splice(t,1);var n=e.getShadowGenerator();if(n){var r=n.getShadowMap();r&&r.renderList&&-1!==(t=r.renderList.indexOf(i))&&r.renderList.splice(t,1)}})),"InstancedMesh"===this.getClassName()&&"InstancedLinesMesh"===this.getClassName()||this.releaseSubMeshes();var c=this.getScene().getEngine();if(null!==this._occlusionQuery&&(this.isOcclusionQueryInProgress=!1,c.deleteQuery(this._occlusionQuery),this._occlusionQuery=null),c.wipeCaches(),this.getScene().removeMesh(this),this._parentContainer){var h=this._parentContainer.meshes.indexOf(this);h>-1&&this._parentContainer.meshes.splice(h,1),this._parentContainer=null}if(a&&this.material&&("MultiMaterial"===this.material.getClassName()?this.material.dispose(!1,!0,!0):this.material.dispose(!1,!0)),!e)for(t=0;t<this.getScene().particleSystems.length;t++)this.getScene().particleSystems[t].emitter===this&&(this.getScene().particleSystems[t].dispose(),t--);this._internalAbstractMeshDataInfo._facetData.facetDataEnabled&&this.disableFacetData(),this._uniformBuffer.dispose(),this.onAfterWorldMatrixUpdateObservable.clear(),this.onCollideObservable.clear(),this.onCollisionPositionChangeObservable.clear(),this.onRebuildObservable.clear(),(0,r.Z)((0,s.Z)(n.prototype),"dispose",this).call(this,e,a)}},{key:"addChild",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e.setParent(this,t),this}},{key:"removeChild",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e.setParent(null,t),this}},{key:"_initFacetData",value:function(){var e=this._internalAbstractMeshDataInfo._facetData;e.facetNormals||(e.facetNormals=new Array),e.facetPositions||(e.facetPositions=new Array),e.facetPartitioning||(e.facetPartitioning=new Array),e.facetNb=this.getIndices().length/3|0,e.partitioningSubdivisions=e.partitioningSubdivisions?e.partitioningSubdivisions:10,e.partitioningBBoxRatio=e.partitioningBBoxRatio?e.partitioningBBoxRatio:1.01;for(var t=0;t<e.facetNb;t++)e.facetNormals[t]=f.P.Zero(),e.facetPositions[t]=f.P.Zero();return e.facetDataEnabled=!0,this}},{key:"updateFacetData",value:function(){var e=this._internalAbstractMeshDataInfo._facetData;e.facetDataEnabled||this._initFacetData();var t=this.getVerticesData(p.o.PositionKind),n=this.getIndices(),i=this.getVerticesData(p.o.NormalKind),r=this.getBoundingInfo();if(e.facetDepthSort&&!e.facetDepthSortEnabled){if(e.facetDepthSortEnabled=!0,n instanceof Uint16Array)e.depthSortedIndices=new Uint16Array(n);else if(n instanceof Uint32Array)e.depthSortedIndices=new Uint32Array(n);else{for(var a=!1,o=0;o<n.length;o++)if(n[o]>65535){a=!0;break}e.depthSortedIndices=a?new Uint32Array(n):new Uint16Array(n)}if(e.facetDepthSortFunction=function(e,t){return t.sqDistance-e.sqDistance},!e.facetDepthSortFrom){var s=this.getScene().activeCamera;e.facetDepthSortFrom=s?s.position:f.P.Zero()}e.depthSortedFacets=[];for(var u=0;u<e.facetNb;u++){var l={ind:3*u,sqDistance:0};e.depthSortedFacets.push(l)}e.invertedMatrix=f.y3.Identity(),e.facetDepthSortOrigin=f.P.Zero()}e.bbSize.x=r.maximum.x-r.minimum.x>M.kn?r.maximum.x-r.minimum.x:M.kn,e.bbSize.y=r.maximum.y-r.minimum.y>M.kn?r.maximum.y-r.minimum.y:M.kn,e.bbSize.z=r.maximum.z-r.minimum.z>M.kn?r.maximum.z-r.minimum.z:M.kn;var c=e.bbSize.x>e.bbSize.y?e.bbSize.x:e.bbSize.y;if(c=c>e.bbSize.z?c:e.bbSize.z,e.subDiv.max=e.partitioningSubdivisions,e.subDiv.X=Math.floor(e.subDiv.max*e.bbSize.x/c),e.subDiv.Y=Math.floor(e.subDiv.max*e.bbSize.y/c),e.subDiv.Z=Math.floor(e.subDiv.max*e.bbSize.z/c),e.subDiv.X=e.subDiv.X<1?1:e.subDiv.X,e.subDiv.Y=e.subDiv.Y<1?1:e.subDiv.Y,e.subDiv.Z=e.subDiv.Z<1?1:e.subDiv.Z,e.facetParameters.facetNormals=this.getFacetLocalNormals(),e.facetParameters.facetPositions=this.getFacetLocalPositions(),e.facetParameters.facetPartitioning=this.getFacetLocalPartitioning(),e.facetParameters.bInfo=r,e.facetParameters.bbSize=e.bbSize,e.facetParameters.subDiv=e.subDiv,e.facetParameters.ratio=this.partitioningBBoxRatio,e.facetParameters.depthSort=e.facetDepthSort,e.facetDepthSort&&e.facetDepthSortEnabled&&(this.computeWorldMatrix(!0),this._worldMatrix.invertToRef(e.invertedMatrix),f.P.TransformCoordinatesToRef(e.facetDepthSortFrom,e.invertedMatrix,e.facetDepthSortOrigin),e.facetParameters.distanceTo=e.facetDepthSortOrigin),e.facetParameters.depthSortedFacets=e.depthSortedFacets,i&&v.x.ComputeNormals(t,n,i,e.facetParameters),e.facetDepthSort&&e.facetDepthSortEnabled){e.depthSortedFacets.sort(e.facetDepthSortFunction);for(var h=e.depthSortedIndices.length/3|0,d=0;d<h;d++){var m=e.depthSortedFacets[d].ind;e.depthSortedIndices[3*d]=n[m],e.depthSortedIndices[3*d+1]=n[m+1],e.depthSortedIndices[3*d+2]=n[m+2]}this.updateIndices(e.depthSortedIndices,void 0,!0)}return this}},{key:"getFacetLocalNormals",value:function(){var e=this._internalAbstractMeshDataInfo._facetData;return e.facetNormals||this.updateFacetData(),e.facetNormals}},{key:"getFacetLocalPositions",value:function(){var e=this._internalAbstractMeshDataInfo._facetData;return e.facetPositions||this.updateFacetData(),e.facetPositions}},{key:"getFacetLocalPartitioning",value:function(){var e=this._internalAbstractMeshDataInfo._facetData;return e.facetPartitioning||this.updateFacetData(),e.facetPartitioning}},{key:"getFacetPosition",value:function(e){var t=f.P.Zero();return this.getFacetPositionToRef(e,t),t}},{key:"getFacetPositionToRef",value:function(e,t){var n=this.getFacetLocalPositions()[e],i=this.getWorldMatrix();return f.P.TransformCoordinatesToRef(n,i,t),this}},{key:"getFacetNormal",value:function(e){var t=f.P.Zero();return this.getFacetNormalToRef(e,t),t}},{key:"getFacetNormalToRef",value:function(e,t){var n=this.getFacetLocalNormals()[e];return f.P.TransformNormalToRef(n,this.getWorldMatrix(),t),this}},{key:"getFacetsAtLocalCoordinates",value:function(e,t,n){var i=this.getBoundingInfo(),r=this._internalAbstractMeshDataInfo._facetData,a=Math.floor((e-i.minimum.x*r.partitioningBBoxRatio)*r.subDiv.X*r.partitioningBBoxRatio/r.bbSize.x),o=Math.floor((t-i.minimum.y*r.partitioningBBoxRatio)*r.subDiv.Y*r.partitioningBBoxRatio/r.bbSize.y),s=Math.floor((n-i.minimum.z*r.partitioningBBoxRatio)*r.subDiv.Z*r.partitioningBBoxRatio/r.bbSize.z);return a<0||a>r.subDiv.max||o<0||o>r.subDiv.max||s<0||s>r.subDiv.max?null:r.facetPartitioning[a+r.subDiv.max*o+r.subDiv.max*r.subDiv.max*s]}},{key:"getClosestFacetAtCoordinates",value:function(e,t,n,i){var r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],o=this.getWorldMatrix(),s=f.jp.Matrix[5];o.invertToRef(s);var u=f.jp.Vector3[8];f.P.TransformCoordinatesFromFloatsToRef(e,t,n,s,u);var l=this.getClosestFacetAtLocalCoordinates(u.x,u.y,u.z,i,r,a);return i&&f.P.TransformCoordinatesFromFloatsToRef(i.x,i.y,i.z,o,i),l}},{key:"getClosestFacetAtLocalCoordinates",value:function(e,t,n,i){var r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],o=null,s=0,u=0,l=0,c=0,h=0,f=0,d=0,p=0,v=this.getFacetLocalPositions(),m=this.getFacetLocalNormals(),g=this.getFacetsAtLocalCoordinates(e,t,n);if(!g)return null;for(var _,y,E,A=Number.MAX_VALUE,b=A,T=0;T<g.length;T++)y=m[_=g[T]],c=(e-(E=v[_]).x)*y.x+(t-E.y)*y.y+(n-E.z)*y.z,(!r||r&&a&&c>=0||r&&!a&&c<=0)&&(c=y.x*E.x+y.y*E.y+y.z*E.z,h=-(y.x*e+y.y*t+y.z*n-c)/(y.x*y.x+y.y*y.y+y.z*y.z),(b=(s=(f=e+y.x*h)-e)*s+(u=(d=t+y.y*h)-t)*u+(l=(p=n+y.z*h)-n)*l)<A&&(A=b,o=_,i&&(i.x=f,i.y=d,i.z=p)));return o}},{key:"getFacetDataParameters",value:function(){return this._internalAbstractMeshDataInfo._facetData.facetParameters}},{key:"disableFacetData",value:function(){var e=this._internalAbstractMeshDataInfo._facetData;return e.facetDataEnabled&&(e.facetDataEnabled=!1,e.facetPositions=new Array,e.facetNormals=new Array,e.facetPartitioning=new Array,e.facetParameters=null,e.depthSortedIndices=new Uint32Array(0)),this}},{key:"updateIndices",value:function(e,t){return this}},{key:"createNormals",value:function(e){var t,n=this.getVerticesData(p.o.PositionKind),i=this.getIndices();return t=this.isVerticesDataPresent(p.o.NormalKind)?this.getVerticesData(p.o.NormalKind):[],v.x.ComputeNormals(n,i,t,{useRightHandedSystem:this.getScene().useRightHandedSystem}),this.setVerticesData(p.o.NormalKind,t,e),this}},{key:"alignWithNormal",value:function(e,t){t||(t=S.RD.Y);var n=f.jp.Vector3[0],i=f.jp.Vector3[1];return f.P.CrossToRef(t,e,i),f.P.CrossToRef(e,i,n),this.rotationQuaternion?f._f.RotationQuaternionFromAxisToRef(n,e,i,this.rotationQuaternion):f.P.RotationFromAxisToRef(n,e,i,this.rotation),this}},{key:"_checkOcclusionQuery",value:function(){return!1}},{key:"disableEdgesRendering",value:function(){throw(0,A.S)("EdgesRenderer")}},{key:"enableEdgesRendering",value:function(e,t,n){throw(0,A.S)("EdgesRenderer")}},{key:"getConnectedParticleSystems",value:function(){var e=this;return this._scene.particleSystems.filter((function(t){return t.emitter===e}))}}],[{key:"BILLBOARDMODE_NONE",get:function(){return m.Y.BILLBOARDMODE_NONE}},{key:"BILLBOARDMODE_X",get:function(){return m.Y.BILLBOARDMODE_X}},{key:"BILLBOARDMODE_Y",get:function(){return m.Y.BILLBOARDMODE_Y}},{key:"BILLBOARDMODE_Z",get:function(){return m.Y.BILLBOARDMODE_Z}},{key:"BILLBOARDMODE_ALL",get:function(){return m.Y.BILLBOARDMODE_ALL}},{key:"BILLBOARDMODE_USE_POSITION",get:function(){return m.Y.BILLBOARDMODE_USE_POSITION}}]),n}(m.Y);k.OCCLUSION_TYPE_NONE=0,k.OCCLUSION_TYPE_OPTIMISTIC=1,k.OCCLUSION_TYPE_STRICT=2,k.OCCLUSION_ALGORITHM_TYPE_ACCURATE=0,k.OCCLUSION_ALGORITHM_TYPE_CONSERVATIVE=1,k.CULLINGSTRATEGY_STANDARD=0,k.CULLINGSTRATEGY_BOUNDINGSPHERE_ONLY=1,k.CULLINGSTRATEGY_OPTIMISTIC_INCLUSION=2,k.CULLINGSTRATEGY_OPTIMISTIC_INCLUSION_THEN_BSPHERE_ONLY=3,(0,I.H)("BABYLON.AbstractMesh",k)},7662:function(e,t,n){"use strict";n.d(t,{Z:function(){return y}});var i=n(5671),r=n(3144),a=n(6900),o=n(7046),s=n(4527),u=n(2845),l=n(65),c=n(6639),h=n(9115),f=n(8517),d=n(7032),p=n(7721),v=n(4198),m=n(6176);function g(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return _(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function _(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var y=function(){function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;(0,i.Z)(this,e),this.delayLoadState=0,this._totalVertices=0,this._isDisposed=!1,this._indexBufferIsUpdatable=!1,this._positionsCache=[],this._parentContainer=null,this.useBoundingInfoFromGeometry=!1,this._scene=n||v.l.LastCreatedScene,this._scene&&(this.id=t,this.uniqueId=this._scene.getUniqueId(),this._engine=this._scene.getEngine(),this._meshes=[],this._vertexBuffers={},this._indices=[],this._updatable=a,r?this.setAllVerticesData(r,a):this._totalVertices=0,this._engine.getCaps().vertexArrayObject&&(this._vertexArrayObjects={}),o&&(this.applyToMesh(o),o.computeWorldMatrix(!0)))}return(0,r.Z)(e,[{key:"boundingBias",get:function(){return this._boundingBias},set:function(e){this._boundingBias?this._boundingBias.copyFrom(e):this._boundingBias=e.clone(),this._updateBoundingInfo(!0,null)}},{key:"meshes",get:function(){return this._meshes}},{key:"extend",get:function(){return this._extend}},{key:"getScene",value:function(){return this._scene}},{key:"getEngine",value:function(){return this._engine}},{key:"isReady",value:function(){return 1===this.delayLoadState||0===this.delayLoadState}},{key:"doNotSerialize",get:function(){for(var e=0;e<this._meshes.length;e++)if(!this._meshes[e].doNotSerialize)return!1;return!0}},{key:"_rebuild",value:function(){for(var e in this._vertexArrayObjects&&(this._vertexArrayObjects={}),0!==this._meshes.length&&this._indices&&(this._indexBuffer=this._engine.createIndexBuffer(this._indices,this._updatable)),this._vertexBuffers){this._vertexBuffers[e]._rebuild()}}},{key:"setAllVerticesData",value:function(e,t){e.applyToGeometry(this,t),this._notifyUpdate()}},{key:"setVerticesData",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3?arguments[3]:void 0;n&&Array.isArray(t)&&(t=new Float32Array(t));var r=new u.o(this._engine,t,e,n,0===this._meshes.length,i);this.setVerticesBuffer(r)}},{key:"removeVerticesData",value:function(e){this._vertexBuffers[e]&&(this._vertexBuffers[e].dispose(),delete this._vertexBuffers[e]),this._vertexArrayObjects&&this._disposeVertexArrayObjects()}},{key:"setVerticesBuffer",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=e.getKind();this._vertexBuffers[i]&&n&&this._vertexBuffers[i].dispose(),e._buffer&&e._buffer._increaseReferences(),this._vertexBuffers[i]=e;var r=this._meshes,a=r.length;if(i===u.o.PositionKind){var o=e.getData();null!=t?this._totalVertices=t:null!=o&&(this._totalVertices=o.length/(e.type===u.o.BYTE?e.byteStride:e.byteStride/4)),this._updateExtend(o),this._resetPointsArrayCache();for(var s=0;s<a;s++){var l=r[s];l.buildBoundingInfo(this._extend.minimum,this._extend.maximum),l._createGlobalSubMesh(l.isUnIndexed),l.computeWorldMatrix(!0),l.synchronizeInstances()}}this._notifyUpdate(i)}},{key:"updateVerticesDataDirectly",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=this.getVertexBuffer(e);r&&(r.updateDirectly(t,n,i),this._notifyUpdate(e))}},{key:"updateVerticesData",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=this.getVertexBuffer(e);i&&(i.update(t),e===u.o.PositionKind&&this._updateBoundingInfo(n,t),this._notifyUpdate(e))}},{key:"_updateBoundingInfo",value:function(e,t){if(e&&this._updateExtend(t),this._resetPointsArrayCache(),e){var n,i=g(this._meshes);try{for(i.s();!(n=i.n()).done;){var r=n.value;r.hasBoundingInfo?r.getBoundingInfo().reConstruct(this._extend.minimum,this._extend.maximum):r.buildBoundingInfo(this._extend.minimum,this._extend.maximum);var a,o=g(r.subMeshes);try{for(o.s();!(a=o.n()).done;){a.value.refreshBoundingInfo()}}catch(s){o.e(s)}finally{o.f()}}}catch(s){i.e(s)}finally{i.f()}}}},{key:"_bind",value:function(e,t,n,i){if(e){void 0===t&&(t=this._indexBuffer);var r=this.getVertexBuffers();if(r)if(t==this._indexBuffer&&(this._vertexArrayObjects||i)){var a=i||this._vertexArrayObjects;a[e.key]||(a[e.key]=this._engine.recordVertexArrayObject(r,t,e,n)),this._engine.bindVertexArrayObject(a[e.key],t)}else this._engine.bindBuffers(r,t,e,n)}}},{key:"getTotalVertices",value:function(){return this.isReady()?this._totalVertices:0}},{key:"getVerticesData",value:function(e,t,n){var i=this.getVertexBuffer(e);return i?i.getFloatData(this._totalVertices,n||t&&1!==this._meshes.length):null}},{key:"isVertexBufferUpdatable",value:function(e){var t=this._vertexBuffers[e];return!!t&&t.isUpdatable()}},{key:"getVertexBuffer",value:function(e){return this.isReady()?this._vertexBuffers[e]:null}},{key:"getVertexBuffers",value:function(){return this.isReady()?this._vertexBuffers:null}},{key:"isVerticesDataPresent",value:function(e){return this._vertexBuffers?void 0!==this._vertexBuffers[e]:!!this._delayInfo&&-1!==this._delayInfo.indexOf(e)}},{key:"getVerticesDataKinds",value:function(){var e,t=[];if(!this._vertexBuffers&&this._delayInfo)for(e in this._delayInfo)t.push(e);else for(e in this._vertexBuffers)t.push(e);return t}},{key:"updateIndices",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this._indexBuffer)if(this._indexBufferIsUpdatable){var i=e.length!==this._indices.length;if(n||(this._indices=e.slice()),this._engine.updateDynamicIndexBuffer(this._indexBuffer,e,t),i){var r,a=g(this._meshes);try{for(a.s();!(r=a.n()).done;){var o=r.value;o._createGlobalSubMesh(!0)}}catch(s){a.e(s)}finally{a.f()}}}else this.setIndices(e,null,!0)}},{key:"setIndices",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this._indexBuffer&&this._engine._releaseBuffer(this._indexBuffer),this._indices=e,this._indexBufferIsUpdatable=n,0!==this._meshes.length&&this._indices&&(this._indexBuffer=this._engine.createIndexBuffer(this._indices,n)),null!=t&&(this._totalVertices=t);var i,r=g(this._meshes);try{for(r.s();!(i=r.n()).done;){var a=i.value;a._createGlobalSubMesh(!0),a.synchronizeInstances()}}catch(o){r.e(o)}finally{r.f()}this._notifyUpdate()}},{key:"getTotalIndices",value:function(){return this.isReady()?this._indices.length:0}},{key:"getIndices",value:function(e,t){if(!this.isReady())return null;var n=this._indices;return t||e&&1!==this._meshes.length?n.slice():n}},{key:"getIndexBuffer",value:function(){return this.isReady()?this._indexBuffer:null}},{key:"_releaseVertexArrayObject",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e&&this._vertexArrayObjects&&this._vertexArrayObjects[e.key]&&(this._engine.releaseVertexArrayObject(this._vertexArrayObjects[e.key]),delete this._vertexArrayObjects[e.key])}},{key:"releaseForMesh",value:function(e,t){var n=this._meshes,i=n.indexOf(e);-1!==i&&(n.splice(i,1),this._vertexArrayObjects&&e._invalidateInstanceVertexArrayObject(),e._geometry=null,0===n.length&&t&&this.dispose())}},{key:"applyToMesh",value:function(e){if(e._geometry!==this){var t=e._geometry;t&&t.releaseForMesh(e),this._vertexArrayObjects&&e._invalidateInstanceVertexArrayObject();var n=this._meshes;e._geometry=this,e._internalAbstractMeshDataInfo._positions=null,this._scene.pushGeometry(this),n.push(e),this.isReady()?this._applyToMesh(e):this._boundingInfo&&e.setBoundingInfo(this._boundingInfo)}}},{key:"_updateExtend",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(this.useBoundingInfoFromGeometry&&this._boundingInfo)this._extend={minimum:this._boundingInfo.minimum.clone(),maximum:this._boundingInfo.maximum.clone()};else{if(!e&&!(e=this.getVerticesData(u.o.PositionKind)))return;this._extend=(0,p.k)(e,0,this._totalVertices,this.boundingBias,3)}}},{key:"_applyToMesh",value:function(e){var t=this._meshes.length;for(var n in this._vertexBuffers)1===t&&this._vertexBuffers[n].create(),n===u.o.PositionKind&&(this._extend||this._updateExtend(),e.buildBoundingInfo(this._extend.minimum,this._extend.maximum),e._createGlobalSubMesh(e.isUnIndexed),e._updateBoundingInfo());1===t&&this._indices&&this._indices.length>0&&(this._indexBuffer=this._engine.createIndexBuffer(this._indices,this._updatable)),e._syncGeometryWithMorphTargetManager(),e.synchronizeInstances()}},{key:"_notifyUpdate",value:function(e){this.onGeometryUpdated&&this.onGeometryUpdated(this,e),this._vertexArrayObjects&&this._disposeVertexArrayObjects();var t,n=g(this._meshes);try{for(n.s();!(t=n.n()).done;){t.value._markSubMeshesAsAttributesDirty()}}catch(i){n.e(i)}finally{n.f()}}},{key:"load",value:function(e,t){2!==this.delayLoadState&&(this.isReady()?t&&t():(this.delayLoadState=2,this._queueLoad(e,t)))}},{key:"_queueLoad",value:function(e,t){var n=this;this.delayLoadingFile&&(e.addPendingData(this),e._loadFile(this.delayLoadingFile,(function(i){if(n._delayLoadingFunction){n._delayLoadingFunction(JSON.parse(i),n),n.delayLoadState=1,n._delayInfo=[],e.removePendingData(n);for(var r=n._meshes,a=r.length,o=0;o<a;o++)n._applyToMesh(r[o]);t&&t()}}),void 0,!0))}},{key:"toLeftHanded",value:function(){var e=this.getIndices(!1);if(null!=e&&e.length>0){for(var t=0;t<e.length;t+=3){var n=e[t+0];e[t+0]=e[t+2],e[t+2]=n}this.setIndices(e)}var i=this.getVerticesData(u.o.PositionKind,!1);if(null!=i&&i.length>0){for(var r=0;r<i.length;r+=3)i[r+2]=-i[r+2];this.setVerticesData(u.o.PositionKind,i,!1)}var a=this.getVerticesData(u.o.NormalKind,!1);if(null!=a&&a.length>0){for(var o=0;o<a.length;o+=3)a[o+2]=-a[o+2];this.setVerticesData(u.o.NormalKind,a,!1)}}},{key:"_resetPointsArrayCache",value:function(){this._positions=null}},{key:"_generatePointsArray",value:function(){if(this._positions)return!0;var e=this.getVerticesData(u.o.PositionKind);if(!e||0===e.length)return!1;for(var t=3*this._positionsCache.length,n=this._positionsCache.length;t<e.length;t+=3,++n)this._positionsCache[n]=a.P.FromArray(e,t);for(var i=0,r=0;i<e.length;i+=3,++r)this._positionsCache[r].set(e[0+i],e[1+i],e[2+i]);return this._positionsCache.length=e.length/3,this._positions=this._positionsCache,!0}},{key:"isDisposed",value:function(){return this._isDisposed}},{key:"_disposeVertexArrayObjects",value:function(){if(this._vertexArrayObjects){for(var e in this._vertexArrayObjects)this._engine.releaseVertexArrayObject(this._vertexArrayObjects[e]);this._vertexArrayObjects={};for(var t=this._meshes,n=t.length,i=0;i<n;i++)t[i]._invalidateInstanceVertexArrayObject()}}},{key:"dispose",value:function(){var e,t=this._meshes,n=t.length;for(e=0;e<n;e++)this.releaseForMesh(t[e]);for(var i in this._meshes.length=0,this._disposeVertexArrayObjects(),this._vertexBuffers)this._vertexBuffers[i].dispose();if(this._vertexBuffers={},this._totalVertices=0,this._indexBuffer&&this._engine._releaseBuffer(this._indexBuffer),this._indexBuffer=null,this._indices=[],this.delayLoadState=0,this.delayLoadingFile=null,this._delayLoadingFunction=null,this._delayInfo=[],this._boundingInfo=null,this._scene.removeGeometry(this),this._parentContainer){var r=this._parentContainer.geometries.indexOf(this);r>-1&&this._parentContainer.geometries.splice(r,1),this._parentContainer=null}this._isDisposed=!0}},{key:"copy",value:function(t){var n=new s.x;n.indices=[];var i=this.getIndices();if(i)for(var r=0;r<i.length;r++)n.indices.push(i[r]);var a,o=!1,u=!1;for(a in this._vertexBuffers){var l=this.getVerticesData(a);if(l&&(l instanceof Float32Array?n.set(new Float32Array(l),a):n.set(l.slice(0),a),!u)){var c=this.getVertexBuffer(a);c&&(u=!(o=c.isUpdatable()))}}var f=new e(t,this._scene,n,o);for(a in f.delayLoadState=this.delayLoadState,f.delayLoadingFile=this.delayLoadingFile,f._delayLoadingFunction=this._delayLoadingFunction,this._delayInfo)f._delayInfo=f._delayInfo||[],f._delayInfo.push(a);return f._boundingInfo=new h.j(this._extend.minimum,this._extend.maximum),f}},{key:"serialize",value:function(){var e={};return e.id=this.id,e.uniqueId=this.uniqueId,e.updatable=this._updatable,d.$&&d.$.HasTags(this)&&(e.tags=d.$.GetTags(this)),e}},{key:"_toNumberArray",value:function(e){return Array.isArray(e)?e:Array.prototype.slice.call(e)}},{key:"clearCachedData",value:function(){for(var e in this._indices=[],this._resetPointsArrayCache(),this._vertexBuffers)Object.prototype.hasOwnProperty.call(this._vertexBuffers,e)&&(this._vertexBuffers[e]._buffer._data=null)}},{key:"serializeVerticeData",value:function(){var e=this.serialize();return this.isVerticesDataPresent(u.o.PositionKind)&&(e.positions=this._toNumberArray(this.getVerticesData(u.o.PositionKind)),this.isVertexBufferUpdatable(u.o.PositionKind)&&(e.positions._updatable=!0)),this.isVerticesDataPresent(u.o.NormalKind)&&(e.normals=this._toNumberArray(this.getVerticesData(u.o.NormalKind)),this.isVertexBufferUpdatable(u.o.NormalKind)&&(e.normals._updatable=!0)),this.isVerticesDataPresent(u.o.TangentKind)&&(e.tangents=this._toNumberArray(this.getVerticesData(u.o.TangentKind)),this.isVertexBufferUpdatable(u.o.TangentKind)&&(e.tangents._updatable=!0)),this.isVerticesDataPresent(u.o.UVKind)&&(e.uvs=this._toNumberArray(this.getVerticesData(u.o.UVKind)),this.isVertexBufferUpdatable(u.o.UVKind)&&(e.uvs._updatable=!0)),this.isVerticesDataPresent(u.o.UV2Kind)&&(e.uv2s=this._toNumberArray(this.getVerticesData(u.o.UV2Kind)),this.isVertexBufferUpdatable(u.o.UV2Kind)&&(e.uv2s._updatable=!0)),this.isVerticesDataPresent(u.o.UV3Kind)&&(e.uv3s=this._toNumberArray(this.getVerticesData(u.o.UV3Kind)),this.isVertexBufferUpdatable(u.o.UV3Kind)&&(e.uv3s._updatable=!0)),this.isVerticesDataPresent(u.o.UV4Kind)&&(e.uv4s=this._toNumberArray(this.getVerticesData(u.o.UV4Kind)),this.isVertexBufferUpdatable(u.o.UV4Kind)&&(e.uv4s._updatable=!0)),this.isVerticesDataPresent(u.o.UV5Kind)&&(e.uv5s=this._toNumberArray(this.getVerticesData(u.o.UV5Kind)),this.isVertexBufferUpdatable(u.o.UV5Kind)&&(e.uv5s._updatable=!0)),this.isVerticesDataPresent(u.o.UV6Kind)&&(e.uv6s=this._toNumberArray(this.getVerticesData(u.o.UV6Kind)),this.isVertexBufferUpdatable(u.o.UV6Kind)&&(e.uv6s._updatable=!0)),this.isVerticesDataPresent(u.o.ColorKind)&&(e.colors=this._toNumberArray(this.getVerticesData(u.o.ColorKind)),this.isVertexBufferUpdatable(u.o.ColorKind)&&(e.colors._updatable=!0)),this.isVerticesDataPresent(u.o.MatricesIndicesKind)&&(e.matricesIndices=this._toNumberArray(this.getVerticesData(u.o.MatricesIndicesKind)),e.matricesIndices._isExpanded=!0,this.isVertexBufferUpdatable(u.o.MatricesIndicesKind)&&(e.matricesIndices._updatable=!0)),this.isVerticesDataPresent(u.o.MatricesWeightsKind)&&(e.matricesWeights=this._toNumberArray(this.getVerticesData(u.o.MatricesWeightsKind)),this.isVertexBufferUpdatable(u.o.MatricesWeightsKind)&&(e.matricesWeights._updatable=!0)),e.indices=this._toNumberArray(this.getIndices()),e}}],[{key:"CreateGeometryForMesh",value:function(t){var n=new e(e.RandomId(),t.getScene());return n.applyToMesh(t),n}},{key:"ExtractFromMesh",value:function(e,t){var n=e._geometry;return n?n.copy(t):null}},{key:"RandomId",value:function(){return f.w1.RandomId()}},{key:"_GetGeometryByLoadedUniqueId",value:function(e,t){for(var n=0;n<t.geometries.length;n++)if(t.geometries[n]._loadedUniqueId===e)return t.geometries[n];return null}},{key:"_ImportGeometry",value:function(t,n){var i=n.getScene(),r=t.geometryUniqueId,a=t.geometryId;if(r||a){var s=r?this._GetGeometryByLoadedUniqueId(r,i):i.getGeometryById(a);s&&s.applyToMesh(n)}else if(t instanceof ArrayBuffer){var c=n._binaryInfo;if(c.positionsAttrDesc&&c.positionsAttrDesc.count>0){var h=new Float32Array(t,c.positionsAttrDesc.offset,c.positionsAttrDesc.count);n.setVerticesData(u.o.PositionKind,h,!1)}if(c.normalsAttrDesc&&c.normalsAttrDesc.count>0){var f=new Float32Array(t,c.normalsAttrDesc.offset,c.normalsAttrDesc.count);n.setVerticesData(u.o.NormalKind,f,!1)}if(c.tangetsAttrDesc&&c.tangetsAttrDesc.count>0){var d=new Float32Array(t,c.tangetsAttrDesc.offset,c.tangetsAttrDesc.count);n.setVerticesData(u.o.TangentKind,d,!1)}if(c.uvsAttrDesc&&c.uvsAttrDesc.count>0){var p=new Float32Array(t,c.uvsAttrDesc.offset,c.uvsAttrDesc.count);if(m.e.UseOpenGLOrientationForUV)for(var v=1;v<p.length;v+=2)p[v]=1-p[v];n.setVerticesData(u.o.UVKind,p,!1)}if(c.uvs2AttrDesc&&c.uvs2AttrDesc.count>0){var g=new Float32Array(t,c.uvs2AttrDesc.offset,c.uvs2AttrDesc.count);if(m.e.UseOpenGLOrientationForUV)for(var _=1;_<g.length;_+=2)g[_]=1-g[_];n.setVerticesData(u.o.UV2Kind,g,!1)}if(c.uvs3AttrDesc&&c.uvs3AttrDesc.count>0){var y=new Float32Array(t,c.uvs3AttrDesc.offset,c.uvs3AttrDesc.count);if(m.e.UseOpenGLOrientationForUV)for(var E=1;E<y.length;E+=2)y[E]=1-y[E];n.setVerticesData(u.o.UV3Kind,y,!1)}if(c.uvs4AttrDesc&&c.uvs4AttrDesc.count>0){var A=new Float32Array(t,c.uvs4AttrDesc.offset,c.uvs4AttrDesc.count);if(m.e.UseOpenGLOrientationForUV)for(var b=1;b<A.length;b+=2)A[b]=1-A[b];n.setVerticesData(u.o.UV4Kind,A,!1)}if(c.uvs5AttrDesc&&c.uvs5AttrDesc.count>0){var T=new Float32Array(t,c.uvs5AttrDesc.offset,c.uvs5AttrDesc.count);if(m.e.UseOpenGLOrientationForUV)for(var M=1;M<T.length;M+=2)T[M]=1-T[M];n.setVerticesData(u.o.UV5Kind,T,!1)}if(c.uvs6AttrDesc&&c.uvs6AttrDesc.count>0){var S=new Float32Array(t,c.uvs6AttrDesc.offset,c.uvs6AttrDesc.count);if(m.e.UseOpenGLOrientationForUV)for(var I=1;I<S.length;I+=2)S[I]=1-S[I];n.setVerticesData(u.o.UV6Kind,S,!1)}if(c.colorsAttrDesc&&c.colorsAttrDesc.count>0){var x=new Float32Array(t,c.colorsAttrDesc.offset,c.colorsAttrDesc.count);n.setVerticesData(u.o.ColorKind,x,!1,c.colorsAttrDesc.stride)}if(c.matricesIndicesAttrDesc&&c.matricesIndicesAttrDesc.count>0){for(var C=new Int32Array(t,c.matricesIndicesAttrDesc.offset,c.matricesIndicesAttrDesc.count),P=[],D=0;D<C.length;D++){var R=C[D];P.push(255&R),P.push((65280&R)>>8),P.push((16711680&R)>>16),P.push(R>>24&255)}n.setVerticesData(u.o.MatricesIndicesKind,P,!1)}if(c.matricesIndicesExtraAttrDesc&&c.matricesIndicesExtraAttrDesc.count>0){for(var k=new Int32Array(t,c.matricesIndicesExtraAttrDesc.offset,c.matricesIndicesExtraAttrDesc.count),O=[],N=0;N<k.length;N++){var w=k[N];O.push(255&w),O.push((65280&w)>>8),O.push((16711680&w)>>16),O.push(w>>24&255)}n.setVerticesData(u.o.MatricesIndicesExtraKind,O,!1)}if(c.matricesWeightsAttrDesc&&c.matricesWeightsAttrDesc.count>0){var L=new Float32Array(t,c.matricesWeightsAttrDesc.offset,c.matricesWeightsAttrDesc.count);n.setVerticesData(u.o.MatricesWeightsKind,L,!1)}if(c.indicesAttrDesc&&c.indicesAttrDesc.count>0){var F=new Int32Array(t,c.indicesAttrDesc.offset,c.indicesAttrDesc.count);n.setIndices(F,null)}if(c.subMeshesAttrDesc&&c.subMeshesAttrDesc.count>0){var B=new Int32Array(t,c.subMeshesAttrDesc.offset,5*c.subMeshesAttrDesc.count);n.subMeshes=[];for(var U=0;U<c.subMeshesAttrDesc.count;U++){var V=B[5*U+0],G=B[5*U+1],z=B[5*U+2],W=B[5*U+3],H=B[5*U+4];l.P.AddToMesh(V,G,z,W,H,n)}}}else if(t.positions&&t.normals&&t.indices){if(n.setVerticesData(u.o.PositionKind,t.positions,t.positions._updatable),n.setVerticesData(u.o.NormalKind,t.normals,t.normals._updatable),t.tangents&&n.setVerticesData(u.o.TangentKind,t.tangents,t.tangents._updatable),t.uvs&&n.setVerticesData(u.o.UVKind,t.uvs,t.uvs._updatable),t.uvs2&&n.setVerticesData(u.o.UV2Kind,t.uvs2,t.uvs2._updatable),t.uvs3&&n.setVerticesData(u.o.UV3Kind,t.uvs3,t.uvs3._updatable),t.uvs4&&n.setVerticesData(u.o.UV4Kind,t.uvs4,t.uvs4._updatable),t.uvs5&&n.setVerticesData(u.o.UV5Kind,t.uvs5,t.uvs5._updatable),t.uvs6&&n.setVerticesData(u.o.UV6Kind,t.uvs6,t.uvs6._updatable),t.colors&&n.setVerticesData(u.o.ColorKind,o.HE.CheckColors4(t.colors,t.positions.length/3),t.colors._updatable),t.matricesIndices)if(t.matricesIndices._isExpanded)delete t.matricesIndices._isExpanded,n.setVerticesData(u.o.MatricesIndicesKind,t.matricesIndices,t.matricesIndices._updatable);else{for(var X=[],j=0;j<t.matricesIndices.length;j++){var Y=t.matricesIndices[j];X.push(255&Y),X.push((65280&Y)>>8),X.push((16711680&Y)>>16),X.push(Y>>24&255)}n.setVerticesData(u.o.MatricesIndicesKind,X,t.matricesIndices._updatable)}if(t.matricesIndicesExtra)if(t.matricesIndicesExtra._isExpanded)delete t.matricesIndices._isExpanded,n.setVerticesData(u.o.MatricesIndicesExtraKind,t.matricesIndicesExtra,t.matricesIndicesExtra._updatable);else{for(var Z=[],K=0;K<t.matricesIndicesExtra.length;K++){var q=t.matricesIndicesExtra[K];Z.push(255&q),Z.push((65280&q)>>8),Z.push((16711680&q)>>16),Z.push(q>>24&255)}n.setVerticesData(u.o.MatricesIndicesExtraKind,Z,t.matricesIndicesExtra._updatable)}t.matricesWeights&&(e._CleanMatricesWeights(t,n),n.setVerticesData(u.o.MatricesWeightsKind,t.matricesWeights,t.matricesWeights._updatable)),t.matricesWeightsExtra&&n.setVerticesData(u.o.MatricesWeightsExtraKind,t.matricesWeightsExtra,t.matricesWeights._updatable),n.setIndices(t.indices,null)}if(t.subMeshes){n.subMeshes=[];for(var Q=0;Q<t.subMeshes.length;Q++){var $=t.subMeshes[Q];l.P.AddToMesh($.materialIndex,$.verticesStart,$.verticesCount,$.indexStart,$.indexCount,n)}}n._shouldGenerateFlatShading&&(n.convertToFlatShadedMesh(),n._shouldGenerateFlatShading=!1),n.computeWorldMatrix(!0),i.onMeshImportedObservable.notifyObservers(n)}},{key:"_CleanMatricesWeights",value:function(e,t){var n=.001;if(c.Z.CleanBoneMatrixWeights){var i=0;if(e.skeletonId>-1){var r=t.getScene().getLastSkeletonById(e.skeletonId);if(r){i=r.bones.length;for(var a=t.getVerticesData(u.o.MatricesIndicesKind),o=t.getVerticesData(u.o.MatricesIndicesExtraKind),s=e.matricesWeights,l=e.matricesWeightsExtra,h=e.numBoneInfluencer,f=s.length,d=0;d<f;d+=4){for(var p=0,v=-1,m=0;m<4;m++){var g=s[d+m];p+=g,g<n&&v<0&&(v=m)}if(l)for(var _=0;_<4;_++){var y=l[d+_];p+=y,y<n&&v<0&&(v=_+4)}if((v<0||v>h-1)&&(v=h-1),p>n){for(var E=1/p,A=0;A<4;A++)s[d+A]*=E;if(l)for(var b=0;b<4;b++)l[d+b]*=E}else v>=4?(l[d+v-4]=1-p,o[d+v-4]=i):(s[d+v]=1-p,a[d+v]=i)}t.setVerticesData(u.o.MatricesIndicesKind,a),e.matricesWeightsExtra&&t.setVerticesData(u.o.MatricesIndicesExtraKind,o)}}}}},{key:"Parse",value:function(t,n,i){var r=new e(t.id,n,void 0,t.updatable);return r._loadedUniqueId=t.uniqueId,d.$&&d.$.AddTagsTo(r,t.tags),t.delayLoadingFile?(r.delayLoadState=4,r.delayLoadingFile=i+t.delayLoadingFile,r._boundingInfo=new h.j(a.P.FromArray(t.boundingBoxMinimum),a.P.FromArray(t.boundingBoxMaximum)),r._delayInfo=[],t.hasUVs&&r._delayInfo.push(u.o.UVKind),t.hasUVs2&&r._delayInfo.push(u.o.UV2Kind),t.hasUVs3&&r._delayInfo.push(u.o.UV3Kind),t.hasUVs4&&r._delayInfo.push(u.o.UV4Kind),t.hasUVs5&&r._delayInfo.push(u.o.UV5Kind),t.hasUVs6&&r._delayInfo.push(u.o.UV6Kind),t.hasColors&&r._delayInfo.push(u.o.ColorKind),t.hasMatricesIndices&&r._delayInfo.push(u.o.MatricesIndicesKind),t.hasMatricesWeights&&r._delayInfo.push(u.o.MatricesWeightsKind),r._delayLoadingFunction=s.x.ImportVertexData):s.x.ImportVertexData(t,r),n.pushGeometry(r,!0),r}}]),e}()},4527:function(e,t,n){"use strict";n.d(t,{x:function(){return y}});var i=n(885),r=n(5671),a=n(3144),o=n(4687),s=n.n(o),u=n(9477),l=n(6900),c=n(2845),h=n(5230),f=n(7046),d=n(2328),p=n(9336),v=n(5203),m=n(8298);function g(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return _(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function _(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var y=function(){function e(){(0,r.Z)(this,e),this._applyTo=(0,v.vp)(this._applyToCoroutine.bind(this))}return(0,a.Z)(e,[{key:"set",value:function(e,t){switch(e.length||d.Y.Warn("Setting vertex data kind '".concat(t,"' with an empty array")),t){case c.o.PositionKind:this.positions=e;break;case c.o.NormalKind:this.normals=e;break;case c.o.TangentKind:this.tangents=e;break;case c.o.UVKind:this.uvs=e;break;case c.o.UV2Kind:this.uvs2=e;break;case c.o.UV3Kind:this.uvs3=e;break;case c.o.UV4Kind:this.uvs4=e;break;case c.o.UV5Kind:this.uvs5=e;break;case c.o.UV6Kind:this.uvs6=e;break;case c.o.ColorKind:this.colors=e;break;case c.o.MatricesIndicesKind:this.matricesIndices=e;break;case c.o.MatricesWeightsKind:this.matricesWeights=e;break;case c.o.MatricesIndicesExtraKind:this.matricesIndicesExtra=e;break;case c.o.MatricesWeightsExtraKind:this.matricesWeightsExtra=e}}},{key:"applyToMesh",value:function(e,t){return this._applyTo(e,t,!1),this}},{key:"applyToGeometry",value:function(e,t){return this._applyTo(e,t,!1),this}},{key:"updateMesh",value:function(e){return this._update(e),this}},{key:"updateGeometry",value:function(e){return this._update(e),this}},{key:"_applyToCoroutine",value:s().mark((function e(t){var n,i,r=arguments;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.length>1&&void 0!==r[1]&&r[1],i=r.length>2?r[2]:void 0,!this.positions){e.next=7;break}if(t.setVerticesData(c.o.PositionKind,this.positions,n),!i){e.next=7;break}return void(e.next=7);case 7:if(!this.normals){e.next=12;break}if(t.setVerticesData(c.o.NormalKind,this.normals,n),!i){e.next=12;break}return void(e.next=12);case 12:if(!this.tangents){e.next=17;break}if(t.setVerticesData(c.o.TangentKind,this.tangents,n),!i){e.next=17;break}return void(e.next=17);case 17:if(!this.uvs){e.next=22;break}if(t.setVerticesData(c.o.UVKind,this.uvs,n),!i){e.next=22;break}return void(e.next=22);case 22:if(!this.uvs2){e.next=27;break}if(t.setVerticesData(c.o.UV2Kind,this.uvs2,n),!i){e.next=27;break}return void(e.next=27);case 27:if(!this.uvs3){e.next=32;break}if(t.setVerticesData(c.o.UV3Kind,this.uvs3,n),!i){e.next=32;break}return void(e.next=32);case 32:if(!this.uvs4){e.next=37;break}if(t.setVerticesData(c.o.UV4Kind,this.uvs4,n),!i){e.next=37;break}return void(e.next=37);case 37:if(!this.uvs5){e.next=42;break}if(t.setVerticesData(c.o.UV5Kind,this.uvs5,n),!i){e.next=42;break}return void(e.next=42);case 42:if(!this.uvs6){e.next=47;break}if(t.setVerticesData(c.o.UV6Kind,this.uvs6,n),!i){e.next=47;break}return void(e.next=47);case 47:if(!this.colors){e.next=52;break}if(t.setVerticesData(c.o.ColorKind,this.colors,n),!i){e.next=52;break}return void(e.next=52);case 52:if(!this.matricesIndices){e.next=57;break}if(t.setVerticesData(c.o.MatricesIndicesKind,this.matricesIndices,n),!i){e.next=57;break}return void(e.next=57);case 57:if(!this.matricesWeights){e.next=62;break}if(t.setVerticesData(c.o.MatricesWeightsKind,this.matricesWeights,n),!i){e.next=62;break}return void(e.next=62);case 62:if(!this.matricesIndicesExtra){e.next=67;break}if(t.setVerticesData(c.o.MatricesIndicesExtraKind,this.matricesIndicesExtra,n),!i){e.next=67;break}return void(e.next=67);case 67:if(!this.matricesWeightsExtra){e.next=72;break}if(t.setVerticesData(c.o.MatricesWeightsExtraKind,this.matricesWeightsExtra,n),!i){e.next=72;break}return void(e.next=72);case 72:if(!this.indices){e.next=79;break}if(t.setIndices(this.indices,null,n),!i){e.next=77;break}return void(e.next=77);case 77:e.next=80;break;case 79:t.setIndices([],null);case 80:return e.abrupt("return",this);case 81:case"end":return e.stop()}}),e,this)}))},{key:"_update",value:function(e,t,n){return this.positions&&e.updateVerticesData(c.o.PositionKind,this.positions,t,n),this.normals&&e.updateVerticesData(c.o.NormalKind,this.normals,t,n),this.tangents&&e.updateVerticesData(c.o.TangentKind,this.tangents,t,n),this.uvs&&e.updateVerticesData(c.o.UVKind,this.uvs,t,n),this.uvs2&&e.updateVerticesData(c.o.UV2Kind,this.uvs2,t,n),this.uvs3&&e.updateVerticesData(c.o.UV3Kind,this.uvs3,t,n),this.uvs4&&e.updateVerticesData(c.o.UV4Kind,this.uvs4,t,n),this.uvs5&&e.updateVerticesData(c.o.UV5Kind,this.uvs5,t,n),this.uvs6&&e.updateVerticesData(c.o.UV6Kind,this.uvs6,t,n),this.colors&&e.updateVerticesData(c.o.ColorKind,this.colors,t,n),this.matricesIndices&&e.updateVerticesData(c.o.MatricesIndicesKind,this.matricesIndices,t,n),this.matricesWeights&&e.updateVerticesData(c.o.MatricesWeightsKind,this.matricesWeights,t,n),this.matricesIndicesExtra&&e.updateVerticesData(c.o.MatricesIndicesExtraKind,this.matricesIndicesExtra,t,n),this.matricesWeightsExtra&&e.updateVerticesData(c.o.MatricesWeightsExtraKind,this.matricesWeightsExtra,t,n),this.indices&&e.setIndices(this.indices,null),this}},{key:"transform",value:function(t){var n=t.determinant()<0;return this.positions&&e._TransformVector3Coordinates(this.positions,t),this.normals&&e._TransformVector3Normals(this.normals,t),this.tangents&&e._TransformVector4Normals(this.tangents,t),n&&this.indices&&e._FlipFaces(this.indices),this}},{key:"merge",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=Array.isArray(e)?e.map((function(e){return[e,void 0]})):[[e,void 0]];return(0,v.s3)(this._mergeCoroutine(void 0,i,t,!1,n))}},{key:"_mergeCoroutine",value:s().mark((function t(n,r){var a,o,u,l,h,f,d,p,v,m,_,y,E,A,b,T,M,S,I,x,C,P,D,R,k=this,O=arguments;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:l=O.length>2&&void 0!==O[2]&&O[2],h=O.length>3?O[3]:void 0,f=O.length>4?O[4]:void 0,this._validate(),d=r.map((function(e){return e[0]})),p=g(d),t.prev=6,p.s();case 8:if((v=p.n()).done){t.next=15;break}if((m=v.value)._validate(),!this.normals==!m.normals&&!this.tangents==!m.tangents&&!this.uvs==!m.uvs&&!this.uvs2==!m.uvs2&&!this.uvs3==!m.uvs3&&!this.uvs4==!m.uvs4&&!this.uvs5==!m.uvs5&&!this.uvs6==!m.uvs6&&!this.colors==!m.colors&&!this.matricesIndices==!m.matricesIndices&&!this.matricesWeights==!m.matricesWeights&&!this.matricesIndicesExtra==!m.matricesIndicesExtra&&!this.matricesWeightsExtra==!m.matricesWeightsExtra){t.next=13;break}throw new Error("Cannot merge vertex data that do not have the same set of attributes");case 13:t.next=8;break;case 15:t.next=20;break;case 17:t.prev=17,t.t0=t.catch(6),p.e(t.t0);case 20:return t.prev=20,p.f(),t.finish(20);case 23:if(_=d.reduce((function(e,t){var n,i;return e+(null!==(n=null===(i=t.indices)||void 0===i?void 0:i.length)&&void 0!==n?n:0)}),null!==(a=null===(o=this.indices)||void 0===o?void 0:o.length)&&void 0!==a?a:0),y=f||d.some((function(e){return e.indices===k.indices})),E=y?null===(u=this.indices)||void 0===u?void 0:u.slice():this.indices,!(_>0)){t.next=54;break}T=null!==(A=null===(b=E)||void 0===b?void 0:b.length)&&void 0!==A?A:0,E||(E=new Array(_)),E.length!==_&&(Array.isArray(E)?E.length=_:((M=l||E instanceof Uint32Array?new Uint32Array(_):new Uint16Array(_)).set(E),E=M),n&&n.determinant()<0&&e._FlipFaces(E,0,T)),S=this.positions?this.positions.length/3:0,I=g(r),t.prev=32,I.s();case 34:if((x=I.n()).done){t.next=46;break}if(C=(0,i.Z)(x.value,2),P=C[0],D=C[1],!P.indices){t.next=44;break}for(R=0;R<P.indices.length;R++)E[T+R]=P.indices[R]+S;if(D&&D.determinant()<0&&e._FlipFaces(E,T,P.indices.length),S+=P.positions.length/3,T+=P.indices.length,!h){t.next=44;break}return void(t.next=44);case 44:t.next=34;break;case 46:t.next=51;break;case 48:t.prev=48,t.t1=t.catch(32),I.e(t.t1);case 51:return t.prev=51,I.f(),t.finish(51);case 54:if(this.indices=E,this.positions=e._MergeElement(c.o.PositionKind,this.positions,n,r.map((function(e){return[e[0].positions,e[1]]}))),!h){t.next=59;break}return void(t.next=59);case 59:if(this.normals=e._MergeElement(c.o.NormalKind,this.normals,n,r.map((function(e){return[e[0].normals,e[1]]}))),!h){t.next=63;break}return void(t.next=63);case 63:if(this.tangents=e._MergeElement(c.o.TangentKind,this.tangents,n,r.map((function(e){return[e[0].tangents,e[1]]}))),!h){t.next=67;break}return void(t.next=67);case 67:if(this.uvs=e._MergeElement(c.o.UVKind,this.uvs,n,r.map((function(e){return[e[0].uvs,e[1]]}))),!h){t.next=71;break}return void(t.next=71);case 71:if(this.uvs2=e._MergeElement(c.o.UV2Kind,this.uvs2,n,r.map((function(e){return[e[0].uvs2,e[1]]}))),!h){t.next=75;break}return void(t.next=75);case 75:if(this.uvs3=e._MergeElement(c.o.UV3Kind,this.uvs3,n,r.map((function(e){return[e[0].uvs3,e[1]]}))),!h){t.next=79;break}return void(t.next=79);case 79:if(this.uvs4=e._MergeElement(c.o.UV4Kind,this.uvs4,n,r.map((function(e){return[e[0].uvs4,e[1]]}))),!h){t.next=83;break}return void(t.next=83);case 83:if(this.uvs5=e._MergeElement(c.o.UV5Kind,this.uvs5,n,r.map((function(e){return[e[0].uvs5,e[1]]}))),!h){t.next=87;break}return void(t.next=87);case 87:if(this.uvs6=e._MergeElement(c.o.UV6Kind,this.uvs6,n,r.map((function(e){return[e[0].uvs6,e[1]]}))),!h){t.next=91;break}return void(t.next=91);case 91:if(this.colors=e._MergeElement(c.o.ColorKind,this.colors,n,r.map((function(e){return[e[0].colors,e[1]]}))),!h){t.next=95;break}return void(t.next=95);case 95:if(this.matricesIndices=e._MergeElement(c.o.MatricesIndicesKind,this.matricesIndices,n,r.map((function(e){return[e[0].matricesIndices,e[1]]}))),!h){t.next=99;break}return void(t.next=99);case 99:if(this.matricesWeights=e._MergeElement(c.o.MatricesWeightsKind,this.matricesWeights,n,r.map((function(e){return[e[0].matricesWeights,e[1]]}))),!h){t.next=103;break}return void(t.next=103);case 103:if(this.matricesIndicesExtra=e._MergeElement(c.o.MatricesIndicesExtraKind,this.matricesIndicesExtra,n,r.map((function(e){return[e[0].matricesIndicesExtra,e[1]]}))),!h){t.next=107;break}return void(t.next=107);case 107:return this.matricesWeightsExtra=e._MergeElement(c.o.MatricesWeightsExtraKind,this.matricesWeightsExtra,n,r.map((function(e){return[e[0].matricesWeightsExtra,e[1]]}))),t.abrupt("return",this);case 109:case"end":return t.stop()}}),t,this,[[6,17,20,23],[32,48,51,54]])}))},{key:"_validate",value:function(){if(!this.positions)throw new m.LH("Positions are required",m.SM.MeshInvalidPositionsError);var e=function(e,t){var n=c.o.DeduceStride(e);if(t.length%n!=0)throw new Error("The "+e+"s array count must be a multiple of "+n);return t.length/n},t=e(c.o.PositionKind,this.positions),n=function(n,i){var r=e(n,i);if(r!==t)throw new Error("The "+n+"s element count ("+r+") does not match the positions count ("+t+")")};this.normals&&n(c.o.NormalKind,this.normals),this.tangents&&n(c.o.TangentKind,this.tangents),this.uvs&&n(c.o.UVKind,this.uvs),this.uvs2&&n(c.o.UV2Kind,this.uvs2),this.uvs3&&n(c.o.UV3Kind,this.uvs3),this.uvs4&&n(c.o.UV4Kind,this.uvs4),this.uvs5&&n(c.o.UV5Kind,this.uvs5),this.uvs6&&n(c.o.UV6Kind,this.uvs6),this.colors&&n(c.o.ColorKind,this.colors),this.matricesIndices&&n(c.o.MatricesIndicesKind,this.matricesIndices),this.matricesWeights&&n(c.o.MatricesWeightsKind,this.matricesWeights),this.matricesIndicesExtra&&n(c.o.MatricesIndicesExtraKind,this.matricesIndicesExtra),this.matricesWeightsExtra&&n(c.o.MatricesWeightsExtraKind,this.matricesWeightsExtra)}},{key:"serialize",value:function(){var e={};return this.positions&&(e.positions=this.positions),this.normals&&(e.normals=this.normals),this.tangents&&(e.tangents=this.tangents),this.uvs&&(e.uvs=this.uvs),this.uvs2&&(e.uvs2=this.uvs2),this.uvs3&&(e.uvs3=this.uvs3),this.uvs4&&(e.uvs4=this.uvs4),this.uvs5&&(e.uvs5=this.uvs5),this.uvs6&&(e.uvs6=this.uvs6),this.colors&&(e.colors=this.colors),this.matricesIndices&&(e.matricesIndices=this.matricesIndices,e.matricesIndices._isExpanded=!0),this.matricesWeights&&(e.matricesWeights=this.matricesWeights),this.matricesIndicesExtra&&(e.matricesIndicesExtra=this.matricesIndicesExtra,e.matricesIndicesExtra._isExpanded=!0),this.matricesWeightsExtra&&(e.matricesWeightsExtra=this.matricesWeightsExtra),e.indices=this.indices,e}}],[{key:"_TransformVector3Coordinates",value:function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length,r=l.jp.Vector3[0],a=l.jp.Vector3[1],o=n;o<n+i;o+=3)l.P.FromArrayToRef(e,o,r),l.P.TransformCoordinatesToRef(r,t,a),e[o]=a.x,e[o+1]=a.y,e[o+2]=a.z}},{key:"_TransformVector3Normals",value:function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length,r=l.jp.Vector3[0],a=l.jp.Vector3[1],o=n;o<n+i;o+=3)l.P.FromArrayToRef(e,o,r),l.P.TransformNormalToRef(r,t,a),e[o]=a.x,e[o+1]=a.y,e[o+2]=a.z}},{key:"_TransformVector4Normals",value:function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length,r=l.jp.Vector4[0],a=l.jp.Vector4[1],o=n;o<n+i;o+=4)l.Lt.FromArrayToRef(e,o,r),l.Lt.TransformNormalToRef(r,t,a),e[o]=a.x,e[o+1]=a.y,e[o+2]=a.z,e[o+3]=a.w}},{key:"_FlipFaces",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.length,i=t;i<t+n;i+=3){var r=e[i+1];e[i+1]=e[i+2],e[i+2]=r}}},{key:"_MergeElement",value:function(t,n,r,a){var o=a.filter((function(e){return null!==e[0]&&void 0!==e[0]}));if(!n&&0==o.length)return n;if(!n)return this._MergeElement(t,o[0][0],o[0][1],o.slice(1));var s=o.reduce((function(e,t){return e+t[0].length}),n.length),u=t===c.o.PositionKind?e._TransformVector3Coordinates:t===c.o.NormalKind?e._TransformVector3Normals:t===c.o.TangentKind?e._TransformVector4Normals:function(){};if(n instanceof Float32Array){var l=new Float32Array(s);l.set(n),r&&u(l,r,0,n.length);var h,f=n.length,d=g(o);try{for(d.s();!(h=d.n()).done;){var p=(0,i.Z)(h.value,2),v=p[0],m=p[1];l.set(v,f),m&&u(l,m,f,v.length),f+=v.length}}catch(x){d.e(x)}finally{d.f()}return l}for(var _=new Array(s),y=0;y<n.length;y++)_[y]=n[y];r&&u(_,r,0,n.length);var E,A=n.length,b=g(o);try{for(b.s();!(E=b.n()).done;){for(var T=(0,i.Z)(E.value,2),M=T[0],S=T[1],I=0;I<M.length;I++)_[A+I]=M[I];S&&u(_,S,A,M.length),A+=M.length}}catch(x){b.e(x)}finally{b.f()}return _}},{key:"ExtractFromMesh",value:function(t,n,i){return e._ExtractFrom(t,n,i)}},{key:"ExtractFromGeometry",value:function(t,n,i){return e._ExtractFrom(t,n,i)}},{key:"_ExtractFrom",value:function(t,n,i){var r=new e;return t.isVerticesDataPresent(c.o.PositionKind)&&(r.positions=t.getVerticesData(c.o.PositionKind,n,i)),t.isVerticesDataPresent(c.o.NormalKind)&&(r.normals=t.getVerticesData(c.o.NormalKind,n,i)),t.isVerticesDataPresent(c.o.TangentKind)&&(r.tangents=t.getVerticesData(c.o.TangentKind,n,i)),t.isVerticesDataPresent(c.o.UVKind)&&(r.uvs=t.getVerticesData(c.o.UVKind,n,i)),t.isVerticesDataPresent(c.o.UV2Kind)&&(r.uvs2=t.getVerticesData(c.o.UV2Kind,n,i)),t.isVerticesDataPresent(c.o.UV3Kind)&&(r.uvs3=t.getVerticesData(c.o.UV3Kind,n,i)),t.isVerticesDataPresent(c.o.UV4Kind)&&(r.uvs4=t.getVerticesData(c.o.UV4Kind,n,i)),t.isVerticesDataPresent(c.o.UV5Kind)&&(r.uvs5=t.getVerticesData(c.o.UV5Kind,n,i)),t.isVerticesDataPresent(c.o.UV6Kind)&&(r.uvs6=t.getVerticesData(c.o.UV6Kind,n,i)),t.isVerticesDataPresent(c.o.ColorKind)&&(r.colors=t.getVerticesData(c.o.ColorKind,n,i)),t.isVerticesDataPresent(c.o.MatricesIndicesKind)&&(r.matricesIndices=t.getVerticesData(c.o.MatricesIndicesKind,n,i)),t.isVerticesDataPresent(c.o.MatricesWeightsKind)&&(r.matricesWeights=t.getVerticesData(c.o.MatricesWeightsKind,n,i)),t.isVerticesDataPresent(c.o.MatricesIndicesExtraKind)&&(r.matricesIndicesExtra=t.getVerticesData(c.o.MatricesIndicesExtraKind,n,i)),t.isVerticesDataPresent(c.o.MatricesWeightsExtraKind)&&(r.matricesWeightsExtra=t.getVerticesData(c.o.MatricesWeightsExtraKind,n,i)),r.indices=t.getIndices(n,i),r}},{key:"CreateRibbon",value:function(e){throw(0,h.S)("ribbonBuilder")}},{key:"CreateBox",value:function(e){throw(0,h.S)("boxBuilder")}},{key:"CreateTiledBox",value:function(e){throw(0,h.S)("tiledBoxBuilder")}},{key:"CreateTiledPlane",value:function(e){throw(0,h.S)("tiledPlaneBuilder")}},{key:"CreateSphere",value:function(e){throw(0,h.S)("sphereBuilder")}},{key:"CreateCylinder",value:function(e){throw(0,h.S)("cylinderBuilder")}},{key:"CreateTorus",value:function(e){throw(0,h.S)("torusBuilder")}},{key:"CreateLineSystem",value:function(e){throw(0,h.S)("linesBuilder")}},{key:"CreateDashedLines",value:function(e){throw(0,h.S)("linesBuilder")}},{key:"CreateGround",value:function(e){throw(0,h.S)("groundBuilder")}},{key:"CreateTiledGround",value:function(e){throw(0,h.S)("groundBuilder")}},{key:"CreateGroundFromHeightMap",value:function(e){throw(0,h.S)("groundBuilder")}},{key:"CreatePlane",value:function(e){throw(0,h.S)("planeBuilder")}},{key:"CreateDisc",value:function(e){throw(0,h.S)("discBuilder")}},{key:"CreatePolygon",value:function(e,t,n,i,r,a,o){throw(0,h.S)("polygonBuilder")}},{key:"CreateIcoSphere",value:function(e){throw(0,h.S)("icoSphereBuilder")}},{key:"CreatePolyhedron",value:function(e){throw(0,h.S)("polyhedronBuilder")}},{key:"CreateCapsule",value:function(){arguments.length>0&&void 0!==arguments[0]||l.P.Up();throw(0,h.S)("capsuleBuilder")}},{key:"CreateTorusKnot",value:function(e){throw(0,h.S)("torusKnotBuilder")}},{key:"ComputeNormals",value:function(e,t,n,i){var r=0,a=0,o=0,s=0,u=0,c=0,h=0,f=0,d=0,p=0,v=0,m=0,g=0,_=0,y=0,E=0,A=0,b=0,T=0,M=0,S=!1,I=!1,x=!1,C=!1,P=1,D=0,R=null;i&&(S=!!i.facetNormals,I=!!i.facetPositions,x=!!i.facetPartitioning,P=!0===i.useRightHandedSystem?-1:1,D=i.ratio||0,C=!!i.depthSort,R=i.distanceTo,C&&void 0===R&&(R=l.P.Zero()));var k=0,O=0,N=0,w=0;for(x&&i&&i.bbSize&&(k=i.subDiv.X*D/i.bbSize.x,O=i.subDiv.Y*D/i.bbSize.y,N=i.subDiv.Z*D/i.bbSize.z,w=i.subDiv.max*i.subDiv.max,i.facetPartitioning.length=0),r=0;r<e.length;r++)n[r]=0;var L=t.length/3|0;for(r=0;r<L;r++){if(g=(m=3*t[3*r])+1,_=m+2,E=(y=3*t[3*r+1])+1,A=y+2,T=(b=3*t[3*r+2])+1,M=b+2,a=e[m]-e[y],o=e[g]-e[E],s=e[_]-e[A],u=e[b]-e[y],c=e[T]-e[E],f=P*(o*(h=e[M]-e[A])-s*c),d=P*(s*u-a*h),p=P*(a*c-o*u),f/=v=0===(v=Math.sqrt(f*f+d*d+p*p))?1:v,d/=v,p/=v,S&&i&&(i.facetNormals[r].x=f,i.facetNormals[r].y=d,i.facetNormals[r].z=p),I&&i&&(i.facetPositions[r].x=(e[m]+e[y]+e[b])/3,i.facetPositions[r].y=(e[g]+e[E]+e[T])/3,i.facetPositions[r].z=(e[_]+e[A]+e[M])/3),x&&i){var F=Math.floor((i.facetPositions[r].x-i.bInfo.minimum.x*D)*k),B=Math.floor((i.facetPositions[r].y-i.bInfo.minimum.y*D)*O),U=Math.floor((i.facetPositions[r].z-i.bInfo.minimum.z*D)*N),V=Math.floor((e[m]-i.bInfo.minimum.x*D)*k),G=Math.floor((e[g]-i.bInfo.minimum.y*D)*O),z=Math.floor((e[_]-i.bInfo.minimum.z*D)*N),W=Math.floor((e[y]-i.bInfo.minimum.x*D)*k),H=Math.floor((e[E]-i.bInfo.minimum.y*D)*O),X=Math.floor((e[A]-i.bInfo.minimum.z*D)*N),j=Math.floor((e[b]-i.bInfo.minimum.x*D)*k),Y=Math.floor((e[T]-i.bInfo.minimum.y*D)*O),Z=Math.floor((e[M]-i.bInfo.minimum.z*D)*N),K=V+i.subDiv.max*G+w*z,q=W+i.subDiv.max*H+w*X,Q=j+i.subDiv.max*Y+w*Z,$=F+i.subDiv.max*B+w*U;i.facetPartitioning[$]=i.facetPartitioning[$]?i.facetPartitioning[$]:new Array,i.facetPartitioning[K]=i.facetPartitioning[K]?i.facetPartitioning[K]:new Array,i.facetPartitioning[q]=i.facetPartitioning[q]?i.facetPartitioning[q]:new Array,i.facetPartitioning[Q]=i.facetPartitioning[Q]?i.facetPartitioning[Q]:new Array,i.facetPartitioning[K].push(r),q!=K&&i.facetPartitioning[q].push(r),Q!=q&&Q!=K&&i.facetPartitioning[Q].push(r),$!=K&&$!=q&&$!=Q&&i.facetPartitioning[$].push(r)}if(C&&i&&i.facetPositions){var J=i.depthSortedFacets[r];J.ind=3*r,J.sqDistance=l.P.DistanceSquared(i.facetPositions[r],R)}n[m]+=f,n[g]+=d,n[_]+=p,n[y]+=f,n[E]+=d,n[A]+=p,n[b]+=f,n[T]+=d,n[M]+=p}for(r=0;r<n.length/3;r++)f=n[3*r],d=n[3*r+1],p=n[3*r+2],f/=v=0===(v=Math.sqrt(f*f+d*d+p*p))?1:v,d/=v,p/=v,n[3*r]=f,n[3*r+1]=d,n[3*r+2]=p}},{key:"_ComputeSides",value:function(t,n,i,r,a,o,s){var u,c,h=i.length,f=r.length;switch(t=t||e.DEFAULTSIDE){case e.FRONTSIDE:break;case e.BACKSIDE:for(u=0;u<h;u+=3){var d=i[u];i[u]=i[u+2],i[u+2]=d}for(c=0;c<f;c++)r[c]=-r[c];break;case e.DOUBLESIDE:for(var p=n.length,v=p/3,m=0;m<p;m++)n[p+m]=n[m];for(u=0;u<h;u+=3)i[u+h]=i[u+2]+v,i[u+1+h]=i[u+1]+v,i[u+2+h]=i[u]+v;for(c=0;c<f;c++)r[f+c]=-r[c];var g=a.length,_=0;for(_=0;_<g;_++)a[_+g]=a[_];for(o=o||new l.Lt(0,0,1,1),s=s||new l.Lt(0,0,1,1),_=0,u=0;u<g/2;u++)a[_]=o.x+(o.z-o.x)*a[_],a[_+1]=o.y+(o.w-o.y)*a[_+1],a[_+g]=s.x+(s.z-s.x)*a[_+g],a[_+g+1]=s.y+(s.w-s.y)*a[_+g+1],_+=2}}},{key:"ImportVertexData",value:function(t,n){var i=new e,r=t.positions;r&&i.set(r,c.o.PositionKind);var a=t.normals;a&&i.set(a,c.o.NormalKind);var o=t.tangents;o&&i.set(o,c.o.TangentKind);var s=t.uvs;s&&i.set(s,c.o.UVKind);var u=t.uv2s;u&&i.set(u,c.o.UV2Kind);var l=t.uv3s;l&&i.set(l,c.o.UV3Kind);var h=t.uv4s;h&&i.set(h,c.o.UV4Kind);var d=t.uv5s;d&&i.set(d,c.o.UV5Kind);var p=t.uv6s;p&&i.set(p,c.o.UV6Kind);var v=t.colors;v&&i.set(f.HE.CheckColors4(v,r.length/3),c.o.ColorKind);var m=t.matricesIndices;m&&i.set(m,c.o.MatricesIndicesKind);var g=t.matricesWeights;g&&i.set(g,c.o.MatricesWeightsKind);var _=t.indices;_&&(i.indices=_),n.setAllVerticesData(i,t.updatable)}}]),e}();y.FRONTSIDE=0,y.BACKSIDE=1,y.DOUBLESIDE=2,y.DEFAULTSIDE=0,(0,u.gn)([p.G6.filter((function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=t[0];return!Array.isArray(i)}))],y,"_TransformVector3Coordinates",null),(0,u.gn)([p.G6.filter((function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=t[0];return!Array.isArray(i)}))],y,"_TransformVector3Normals",null),(0,u.gn)([p.G6.filter((function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=t[0];return!Array.isArray(i)}))],y,"_TransformVector4Normals",null),(0,u.gn)([p.G6.filter((function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=t[0];return!Array.isArray(i)}))],y,"_FlipFaces",null)},9609:function(e,t,n){"use strict";n.d(t,{g:function(){return a}});var i=n(3144),r=n(5671),a=(0,i.Z)((function e(t,n){(0,r.Z)(this,e),this.distanceOrScreenCoverage=t,this.mesh=n}))},65:function(e,t,n){"use strict";n.d(t,{P:function(){return f}});var i=n(5671),r=n(3144),a=n(2845),o=(0,r.Z)((function e(t,n,r){(0,i.Z)(this,e),this.bu=t,this.bv=n,this.distance=r,this.faceId=0,this.subMeshId=0})),s=n(9115),u=n(7721),l=n(8618);function c(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return h(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var f=function(){function e(t,n,r,a,o,s,u){var l=!(arguments.length>7&&void 0!==arguments[7])||arguments[7],c=!(arguments.length>8&&void 0!==arguments[8])||arguments[8];(0,i.Z)(this,e),this.materialIndex=t,this.verticesStart=n,this.verticesCount=r,this.indexStart=a,this.indexCount=o,this._mainDrawWrapperOverride=null,this._linesIndexCount=0,this._linesIndexBuffer=null,this._lastColliderWorldVertices=null,this._lastColliderTransformMatrix=null,this._renderId=0,this._alphaIndex=0,this._distanceToCamera=0,this._currentMaterial=null,this._mesh=s,this._renderingMesh=u||s,c&&s.subMeshes.push(this),this._engine=this._mesh.getScene().getEngine(),this.resetDrawCache(),this._trianglePlanes=[],this._id=s.subMeshes.length-1,l&&(this.refreshBoundingInfo(),s.computeWorldMatrix(!0))}return(0,r.Z)(e,[{key:"materialDefines",get:function(){var e;return this._mainDrawWrapperOverride?this._mainDrawWrapperOverride.defines:null===(e=this._getDrawWrapper())||void 0===e?void 0:e.defines},set:function(e){var t;(null!==(t=this._mainDrawWrapperOverride)&&void 0!==t?t:this._getDrawWrapper(void 0,!0)).defines=e}},{key:"_getDrawWrapper",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e=null!==(t=e)&&void 0!==t?t:this._engine.currentRenderPassId;var i=this._drawWrappers[e];return!i&&n&&(this._drawWrappers[e]=i=new l.q(this._mesh.getScene().getEngine())),i}},{key:"_removeDrawWrapper",value:function(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];n&&(null===(t=this._drawWrappers[e])||void 0===t||t.dispose());this._drawWrappers[e]=void 0}},{key:"effect",get:function(){var e,t;return this._mainDrawWrapperOverride?this._mainDrawWrapperOverride.effect:null!==(e=null===(t=this._getDrawWrapper())||void 0===t?void 0:t.effect)&&void 0!==e?e:null}},{key:"_drawWrapper",get:function(){var e;return null!==(e=this._mainDrawWrapperOverride)&&void 0!==e?e:this._getDrawWrapper(void 0,!0)}},{key:"_drawWrapperOverride",get:function(){return this._mainDrawWrapperOverride}},{key:"_setMainDrawWrapperOverride",value:function(e){this._mainDrawWrapperOverride=e}},{key:"setEffect",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2?arguments[2]:void 0,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=this._drawWrapper;r.setEffect(e,t,i),void 0!==n&&(r.materialContext=n),e||(r.defines=null,r.materialContext=void 0)}},{key:"resetDrawCache",value:function(e){if(this._drawWrappers){if(void 0!==e)return void this._removeDrawWrapper(e);var t,n=c(this._drawWrappers);try{for(n.s();!(t=n.n()).done;){var i=t.value;null==i||i.dispose()}}catch(r){n.e(r)}finally{n.f()}}this._drawWrappers=[]}},{key:"IsGlobal",get:function(){return 0===this.verticesStart&&this.verticesCount===this._mesh.getTotalVertices()&&0===this.indexStart&&this.indexCount===this._mesh.getTotalIndices()}},{key:"getBoundingInfo",value:function(){return this.IsGlobal?this._mesh.getBoundingInfo():this._boundingInfo}},{key:"setBoundingInfo",value:function(e){return this._boundingInfo=e,this}},{key:"getMesh",value:function(){return this._mesh}},{key:"getRenderingMesh",value:function(){return this._renderingMesh}},{key:"getReplacementMesh",value:function(){return this._mesh._internalAbstractMeshDataInfo._actAsRegularMesh?this._mesh:null}},{key:"getEffectiveMesh",value:function(){var e=this._mesh._internalAbstractMeshDataInfo._actAsRegularMesh?this._mesh:null;return e||this._renderingMesh}},{key:"getMaterial",value:function(){var e,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=null!==(e=this._renderingMesh.getMaterialForRenderPass(this._engine.currentRenderPassId))&&void 0!==e?e:this._renderingMesh.material;if(!n)return t?this._mesh.getScene().defaultMaterial:null;if(this._isMultiMaterial(n)){var i=n.getSubMaterial(this.materialIndex);return this._currentMaterial!==i&&(this._currentMaterial=i,this.resetDrawCache()),i}return n}},{key:"_isMultiMaterial",value:function(e){return void 0!==e.getSubMaterial}},{key:"refreshBoundingInfo",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(this._lastColliderWorldVertices=null,this.IsGlobal||!this._renderingMesh||!this._renderingMesh.geometry)return this;if(e||(e=this._renderingMesh.getVerticesData(a.o.PositionKind)),!e)return this._boundingInfo=this._mesh.getBoundingInfo(),this;var t,n=this._renderingMesh.getIndices();if(0===this.indexStart&&this.indexCount===n.length){var i=this._renderingMesh.getBoundingInfo();t={minimum:i.minimum.clone(),maximum:i.maximum.clone()}}else t=(0,u.y)(e,n,this.indexStart,this.indexCount,this._renderingMesh.geometry.boundingBias);return this._boundingInfo?this._boundingInfo.reConstruct(t.minimum,t.maximum):this._boundingInfo=new s.j(t.minimum,t.maximum),this}},{key:"_checkCollision",value:function(e){return this.getBoundingInfo()._checkCollision(e)}},{key:"updateBoundingInfo",value:function(e){var t=this.getBoundingInfo();return t||(this.refreshBoundingInfo(),t=this.getBoundingInfo()),t&&t.update(e),this}},{key:"isInFrustum",value:function(e){var t=this.getBoundingInfo();return!!t&&t.isInFrustum(e,this._mesh.cullingStrategy)}},{key:"isCompletelyInFrustum",value:function(e){var t=this.getBoundingInfo();return!!t&&t.isCompletelyInFrustum(e)}},{key:"render",value:function(e){return this._renderingMesh.render(this,e,this._mesh._internalAbstractMeshDataInfo._actAsRegularMesh?this._mesh:void 0),this}},{key:"_getLinesIndexBuffer",value:function(e,t){if(!this._linesIndexBuffer){for(var n=[],i=this.indexStart;i<this.indexStart+this.indexCount;i+=3)n.push(e[i],e[i+1],e[i+1],e[i+2],e[i+2],e[i]);this._linesIndexBuffer=t.createIndexBuffer(n),this._linesIndexCount=n.length}return this._linesIndexBuffer}},{key:"canIntersects",value:function(e){var t=this.getBoundingInfo();return!!t&&e.intersectsBox(t.boundingBox)}},{key:"intersects",value:function(e,t,n,i,r){var a=this.getMaterial();if(!a)return null;var o=3,s=!1;switch(a.fillMode){case 3:case 5:case 6:case 8:return null;case 7:o=1,s=!0}return 4===a.fillMode?n.length?this._intersectLines(e,t,n,this._mesh.intersectionThreshold,i):this._intersectUnIndexedLines(e,t,n,this._mesh.intersectionThreshold,i):!n.length&&this._mesh._unIndexed?this._intersectUnIndexedTriangles(e,t,n,i,r):this._intersectTriangles(e,t,n,o,s,i,r)}},{key:"_intersectLines",value:function(e,t,n,i,r){for(var a=null,s=this.indexStart;s<this.indexStart+this.indexCount;s+=2){var u=t[n[s]],l=t[n[s+1]],c=e.intersectionSegment(u,l,i);if(!(c<0)&&((r||!a||c<a.distance)&&((a=new o(null,null,c)).faceId=s/2,r)))break}return a}},{key:"_intersectUnIndexedLines",value:function(e,t,n,i,r){for(var a=null,s=this.verticesStart;s<this.verticesStart+this.verticesCount;s+=2){var u=t[s],l=t[s+1],c=e.intersectionSegment(u,l,i);if(!(c<0)&&((r||!a||c<a.distance)&&((a=new o(null,null,c)).faceId=s/2,r)))break}return a}},{key:"_intersectTriangles",value:function(e,t,n,i,r,a,o){for(var s=null,u=-1,l=this.indexStart;l<this.indexStart+this.indexCount-(3-i);l+=i){u++;var c=n[l],h=n[l+1],f=n[l+2];if(r&&4294967295===f)l+=2;else{var d=t[c],p=t[h],v=t[f];if(d&&p&&v&&(!o||o(d,p,v,e))){var m=e.intersectsTriangle(d,p,v);if(m){if(m.distance<0)continue;if((a||!s||m.distance<s.distance)&&((s=m).faceId=u,a))break}}}}return s}},{key:"_intersectUnIndexedTriangles",value:function(e,t,n,i,r){for(var a=null,o=this.verticesStart;o<this.verticesStart+this.verticesCount;o+=3){var s=t[o],u=t[o+1],l=t[o+2];if(!r||r(s,u,l,e)){var c=e.intersectsTriangle(s,u,l);if(c){if(c.distance<0)continue;if((i||!a||c.distance<a.distance)&&((a=c).faceId=o/3,i))break}}}return a}},{key:"_rebuild",value:function(){this._linesIndexBuffer&&(this._linesIndexBuffer=null)}},{key:"clone",value:function(t,n){var i=new e(this.materialIndex,this.verticesStart,this.verticesCount,this.indexStart,this.indexCount,t,n,!1);if(!this.IsGlobal){var r=this.getBoundingInfo();if(!r)return i;i._boundingInfo=new s.j(r.minimum,r.maximum)}return i}},{key:"dispose",value:function(){this._linesIndexBuffer&&(this._mesh.getScene().getEngine()._releaseBuffer(this._linesIndexBuffer),this._linesIndexBuffer=null);var e=this._mesh.subMeshes.indexOf(this);this._mesh.subMeshes.splice(e,1),this.resetDrawCache()}},{key:"getClassName",value:function(){return"SubMesh"}}],[{key:"AddToMesh",value:function(t,n,i,r,a,o,s){var u=!(arguments.length>7&&void 0!==arguments[7])||arguments[7];return new e(t,n,i,r,a,o,s,u)}},{key:"CreateFromIndices",value:function(t,n,i,r,a){for(var o=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],s=Number.MAX_VALUE,u=-Number.MAX_VALUE,l=a||r,c=l.getIndices(),h=n;h<n+i;h++){var f=c[h];f<s&&(s=f),f>u&&(u=f)}return new e(t,s,u-s+1,n,i,r,a,o)}}]),e}()},2668:function(e,t,n){"use strict";n.d(t,{Y:function(){return y}});var i=n(5671),r=n(3144),a=n(7326),o=n(1752),s=n(136),u=n(6215),l=n(1120),c=n(9477),h=n(9336),f=n(4174),d=n(6900),p=n(1396),v=n(7702);function m(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return g(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,l.Z)(e);if(t){var r=(0,l.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,u.Z)(this,n)}}var y=function(e){(0,s.Z)(n,e);var t=_(n);function n(e){var r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return(0,i.Z)(this,n),(r=t.call(this,e,o))._forward=new d.P(0,0,1),r._up=new d.P(0,1,0),r._right=new d.P(1,0,0),r._position=d.P.Zero(),r._rotation=d.P.Zero(),r._rotationQuaternion=null,r._scaling=d.P.One(),r._transformToBoneReferal=null,r._isAbsoluteSynced=!1,r._billboardMode=n.BILLBOARDMODE_NONE,r._preserveParentRotationForBillboard=!1,r.scalingDeterminant=1,r._infiniteDistance=!1,r.ignoreNonUniformScaling=!1,r.reIntegrateRotationIntoRotationQuaternion=!1,r._poseMatrix=null,r._localMatrix=d.y3.Zero(),r._usePivotMatrix=!1,r._absolutePosition=d.P.Zero(),r._absoluteScaling=d.P.Zero(),r._absoluteRotationQuaternion=d._f.Identity(),r._pivotMatrix=d.y3.Identity(),r._postMultiplyPivotMatrix=!1,r._isWorldMatrixFrozen=!1,r._indexInSceneTransformNodesArray=-1,r.onAfterWorldMatrixUpdateObservable=new f.y$,r._nonUniformScaling=!1,s&&r.getScene().addTransformNode((0,a.Z)(r)),r}return(0,r.Z)(n,[{key:"billboardMode",get:function(){return this._billboardMode},set:function(e){this._billboardMode!==e&&(this._billboardMode=e)}},{key:"preserveParentRotationForBillboard",get:function(){return this._preserveParentRotationForBillboard},set:function(e){e!==this._preserveParentRotationForBillboard&&(this._preserveParentRotationForBillboard=e)}},{key:"infiniteDistance",get:function(){return this._infiniteDistance},set:function(e){this._infiniteDistance!==e&&(this._infiniteDistance=e)}},{key:"getClassName",value:function(){return"TransformNode"}},{key:"position",get:function(){return this._position},set:function(e){this._position=e,this._isDirty=!0}},{key:"isUsingPivotMatrix",value:function(){return this._usePivotMatrix}},{key:"rotation",get:function(){return this._rotation},set:function(e){this._rotation=e,this._rotationQuaternion=null,this._isDirty=!0}},{key:"scaling",get:function(){return this._scaling},set:function(e){this._scaling=e,this._isDirty=!0}},{key:"rotationQuaternion",get:function(){return this._rotationQuaternion},set:function(e){this._rotationQuaternion=e,e&&this._rotation.setAll(0),this._isDirty=!0}},{key:"forward",get:function(){return d.P.TransformNormalFromFloatsToRef(0,0,this.getScene().useRightHandedSystem?-1:1,this.getWorldMatrix(),this._forward),this._forward.normalize()}},{key:"up",get:function(){return d.P.TransformNormalFromFloatsToRef(0,1,0,this.getWorldMatrix(),this._up),this._up.normalize()}},{key:"right",get:function(){return d.P.TransformNormalFromFloatsToRef(this.getScene().useRightHandedSystem?-1:1,0,0,this.getWorldMatrix(),this._right),this._right.normalize()}},{key:"updatePoseMatrix",value:function(e){return this._poseMatrix?(this._poseMatrix.copyFrom(e),this):(this._poseMatrix=e.clone(),this)}},{key:"getPoseMatrix",value:function(){return this._poseMatrix||(this._poseMatrix=d.y3.Identity()),this._poseMatrix}},{key:"_isSynchronized",value:function(){var e=this._cache;return this._billboardMode===e.billboardMode&&this._billboardMode===n.BILLBOARDMODE_NONE&&(!e.pivotMatrixUpdated&&(!this._infiniteDistance&&(!this._position._isDirty&&(!this._scaling._isDirty&&!(this._rotationQuaternion&&this._rotationQuaternion._isDirty||this._rotation._isDirty)))))}},{key:"_initCache",value:function(){(0,o.Z)((0,l.Z)(n.prototype),"_initCache",this).call(this);var e=this._cache;e.localMatrixUpdated=!1,e.billboardMode=-1,e.infiniteDistance=!1}},{key:"absolutePosition",get:function(){return this.getAbsolutePosition()}},{key:"absoluteScaling",get:function(){return this._syncAbsoluteScalingAndRotation(),this._absoluteScaling}},{key:"absoluteRotationQuaternion",get:function(){return this._syncAbsoluteScalingAndRotation(),this._absoluteRotationQuaternion}},{key:"setPreTransformMatrix",value:function(e){return this.setPivotMatrix(e,!1)}},{key:"setPivotMatrix",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this._pivotMatrix.copyFrom(e),this._usePivotMatrix=!this._pivotMatrix.isIdentity(),this._cache.pivotMatrixUpdated=!0,this._postMultiplyPivotMatrix=t,this._postMultiplyPivotMatrix&&(this._pivotMatrixInverse?this._pivotMatrix.invertToRef(this._pivotMatrixInverse):this._pivotMatrixInverse=d.y3.Invert(this._pivotMatrix)),this}},{key:"getPivotMatrix",value:function(){return this._pivotMatrix}},{key:"instantiateHierarchy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,i=this.clone("Clone of "+(this.name||this.id),e||this.parent,!0);i&&n&&n(this,i);var r,a=m(this.getChildTransformNodes(!0));try{for(a.s();!(r=a.n()).done;){var o=r.value;o.instantiateHierarchy(i,t,n)}}catch(s){a.e(s)}finally{a.f()}return i}},{key:"freezeWorldMatrix",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e?t?(this._rotation.setAll(0),this._rotationQuaternion=this._rotationQuaternion||d._f.Identity(),e.decompose(this._scaling,this._rotationQuaternion,this._position),this.computeWorldMatrix(!0)):(this._worldMatrix=e,this._absolutePosition.copyFromFloats(this._worldMatrix.m[12],this._worldMatrix.m[13],this._worldMatrix.m[14]),this._afterComputeWorldMatrix()):(this._isWorldMatrixFrozen=!1,this.computeWorldMatrix(!0)),this._isDirty=!1,this._isWorldMatrixFrozen=!0,this}},{key:"unfreezeWorldMatrix",value:function(){return this._isWorldMatrixFrozen=!1,this.computeWorldMatrix(!0),this}},{key:"isWorldMatrixFrozen",get:function(){return this._isWorldMatrixFrozen}},{key:"getAbsolutePosition",value:function(){return this.computeWorldMatrix(),this._absolutePosition}},{key:"setAbsolutePosition",value:function(e){if(!e)return this;var t,n,i;if(void 0===e.x){if(arguments.length<3)return this;t=arguments[0],n=arguments[1],i=arguments[2]}else t=e.x,n=e.y,i=e.z;if(this.parent){var r=d.jp.Matrix[0];this.parent.getWorldMatrix().invertToRef(r),d.P.TransformCoordinatesFromFloatsToRef(t,n,i,r,this.position)}else this.position.x=t,this.position.y=n,this.position.z=i;return this._absolutePosition.copyFrom(e),this}},{key:"setPositionWithLocalVector",value:function(e){return this.computeWorldMatrix(),this.position=d.P.TransformNormal(e,this._localMatrix),this}},{key:"getPositionExpressedInLocalSpace",value:function(){this.computeWorldMatrix();var e=d.jp.Matrix[0];return this._localMatrix.invertToRef(e),d.P.TransformNormal(this.position,e)}},{key:"locallyTranslate",value:function(e){return this.computeWorldMatrix(!0),this.position=d.P.TransformCoordinates(e,this._localMatrix),this}},{key:"lookAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:v.T.LOCAL,o=n._LookAtVectorCache,s=a===v.T.LOCAL?this.position:this.getAbsolutePosition();if(e.subtractToRef(s,o),this.setDirection(o,t,i,r),a===v.T.WORLD&&this.parent)if(this.rotationQuaternion){var u=d.jp.Matrix[0];this.rotationQuaternion.toRotationMatrix(u);var l=d.jp.Matrix[1];this.parent.getWorldMatrix().getRotationMatrixToRef(l),l.invert(),u.multiplyToRef(l,u),this.rotationQuaternion.fromRotationMatrix(u)}else{var c=d.jp.Quaternion[0];d._f.FromEulerVectorToRef(this.rotation,c);var h=d.jp.Matrix[0];c.toRotationMatrix(h);var f=d.jp.Matrix[1];this.parent.getWorldMatrix().getRotationMatrixToRef(f),f.invert(),h.multiplyToRef(f,h),c.fromRotationMatrix(h),c.toEulerAnglesToRef(this.rotation)}return this}},{key:"getDirection",value:function(e){var t=d.P.Zero();return this.getDirectionToRef(e,t),t}},{key:"getDirectionToRef",value:function(e,t){return d.P.TransformNormalToRef(e,this.getWorldMatrix(),t),this}},{key:"setDirection",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=-Math.atan2(e.z,e.x)+Math.PI/2,a=Math.sqrt(e.x*e.x+e.z*e.z),o=-Math.atan2(e.y,a);return this.rotationQuaternion?d._f.RotationYawPitchRollToRef(r+t,o+n,i,this.rotationQuaternion):(this.rotation.x=o+n,this.rotation.y=r+t,this.rotation.z=i),this}},{key:"setPivotPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:v.T.LOCAL;0==this.getScene().getRenderId()&&this.computeWorldMatrix(!0);var n=this.getWorldMatrix();if(t==v.T.WORLD){var i=d.jp.Matrix[0];n.invertToRef(i),e=d.P.TransformCoordinates(e,i)}return this.setPivotMatrix(d.y3.Translation(-e.x,-e.y,-e.z),!0)}},{key:"getPivotPoint",value:function(){var e=d.P.Zero();return this.getPivotPointToRef(e),e}},{key:"getPivotPointToRef",value:function(e){return e.x=-this._pivotMatrix.m[12],e.y=-this._pivotMatrix.m[13],e.z=-this._pivotMatrix.m[14],this}},{key:"getAbsolutePivotPoint",value:function(){var e=d.P.Zero();return this.getAbsolutePivotPointToRef(e),e}},{key:"getAbsolutePivotPointToRef",value:function(e){return this.getPivotPointToRef(e),d.P.TransformCoordinatesToRef(e,this.getWorldMatrix(),e),this}},{key:"markAsDirty",value:function(e){if(this._isDirty)return this;if(this._children){var t,i=m(this._children);try{for(i.s();!(t=i.n()).done;){t.value.markAsDirty(e)}}catch(r){i.e(r)}finally{i.f()}}return(0,o.Z)((0,l.Z)(n.prototype),"markAsDirty",this).call(this,e)}},{key:"setParent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e&&!this.parent)return this;var i=d.jp.Quaternion[0],r=d.jp.Vector3[0],a=d.jp.Vector3[1],o=d.jp.Matrix[1];d.y3.IdentityToRef(o);var s=d.jp.Matrix[0];this.computeWorldMatrix(!0);var u=this.rotationQuaternion;return u||(u=n._TmpRotation,d._f.RotationYawPitchRollToRef(this._rotation.y,this._rotation.x,this._rotation.z,u)),d.y3.ComposeToRef(this.scaling,u,this.position,s),this.parent&&s.multiplyToRef(this.parent.computeWorldMatrix(!0),s),e&&(e.computeWorldMatrix(!0).invertToRef(o),s.multiplyToRef(o,s)),s.decompose(a,i,r,t?this:void 0),this.rotationQuaternion?this.rotationQuaternion.copyFrom(i):i.toEulerAnglesToRef(this.rotation),this.scaling.copyFrom(a),this.position.copyFrom(r),this.parent=e,this}},{key:"nonUniformScaling",get:function(){return this._nonUniformScaling}},{key:"_updateNonUniformScalingState",value:function(e){return this._nonUniformScaling!==e&&(this._nonUniformScaling=e,!0)}},{key:"attachToBone",value:function(e,t){return this._currentParentWhenAttachingToBone=this.parent,this._transformToBoneReferal=t,this.parent=e,e.getSkeleton().prepare(),e.getWorldMatrix().determinant()<0&&(this.scalingDeterminant*=-1),this}},{key:"detachFromBone",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.parent?(this.parent.getWorldMatrix().determinant()<0&&(this.scalingDeterminant*=-1),this._transformToBoneReferal=null,this.parent=e?this._currentParentWhenAttachingToBone:null,this):(e&&(this.parent=this._currentParentWhenAttachingToBone),this)}},{key:"rotate",value:function(e,t,i){var r;if(e.normalize(),this.rotationQuaternion||(this.rotationQuaternion=this.rotation.toQuaternion(),this.rotation.setAll(0)),i&&i!==v.T.LOCAL){if(this.parent){var a=d.jp.Matrix[0];this.parent.getWorldMatrix().invertToRef(a),e=d.P.TransformNormal(e,a)}(r=d._f.RotationAxisToRef(e,t,n._RotationAxisCache)).multiplyToRef(this.rotationQuaternion,this.rotationQuaternion)}else r=d._f.RotationAxisToRef(e,t,n._RotationAxisCache),this.rotationQuaternion.multiplyToRef(r,this.rotationQuaternion);return this}},{key:"rotateAround",value:function(e,t,n){t.normalize(),this.rotationQuaternion||(this.rotationQuaternion=d._f.RotationYawPitchRoll(this.rotation.y,this.rotation.x,this.rotation.z),this.rotation.setAll(0));var i=d.jp.Vector3[0],r=d.jp.Vector3[1],a=d.jp.Vector3[2],o=d.jp.Quaternion[0],s=d.jp.Matrix[0],u=d.jp.Matrix[1],l=d.jp.Matrix[2],c=d.jp.Matrix[3];return e.subtractToRef(this.position,i),d.y3.TranslationToRef(i.x,i.y,i.z,s),d.y3.TranslationToRef(-i.x,-i.y,-i.z,u),d.y3.RotationAxisToRef(t,n,l),u.multiplyToRef(l,c),c.multiplyToRef(s,c),c.decompose(r,o,a),this.position.addInPlace(a),o.multiplyToRef(this.rotationQuaternion,this.rotationQuaternion),this}},{key:"translate",value:function(e,t,n){var i=e.scale(t);if(n&&n!==v.T.LOCAL)this.setAbsolutePosition(this.getAbsolutePosition().add(i));else{var r=this.getPositionExpressedInLocalSpace().add(i);this.setPositionWithLocalVector(r)}return this}},{key:"addRotation",value:function(e,t,n){var i;this.rotationQuaternion?i=this.rotationQuaternion:(i=d.jp.Quaternion[1],d._f.RotationYawPitchRollToRef(this.rotation.y,this.rotation.x,this.rotation.z,i));var r=d.jp.Quaternion[0];return d._f.RotationYawPitchRollToRef(t,e,n,r),i.multiplyInPlace(r),this.rotationQuaternion||i.toEulerAnglesToRef(this.rotation),this}},{key:"_getEffectiveParent",value:function(){return this.parent}},{key:"computeWorldMatrix",value:function(e){if(this._isWorldMatrixFrozen&&!this._isDirty)return this._worldMatrix;var t=this.getScene().getRenderId();if(!this._isDirty&&!e&&(this._currentRenderId===t||this.isSynchronized()))return this._currentRenderId=t,this._worldMatrix;var i=this.getScene().activeCamera,r=0!=(this._billboardMode&n.BILLBOARDMODE_USE_POSITION),a=this._billboardMode!==n.BILLBOARDMODE_NONE&&!this.preserveParentRotationForBillboard;this._updateCache();var o=this._cache;o.pivotMatrixUpdated=!1,o.billboardMode=this.billboardMode,o.infiniteDistance=this.infiniteDistance,o.parent=this._parentNode,this._currentRenderId=t,this._childUpdateId+=1,this._isDirty=!1,this._position._isDirty=!1,this._rotation._isDirty=!1,this._scaling._isDirty=!1;var s,u=this._getEffectiveParent(),l=n._TmpScaling,c=this._position;if(this._infiniteDistance&&!this.parent&&i){var h=i.getWorldMatrix(),f=new d.P(h.m[12],h.m[13],h.m[14]);(c=n._TmpTranslation).copyFromFloats(this._position.x+f.x,this._position.y+f.y,this._position.z+f.z)}(l.copyFromFloats(this._scaling.x*this.scalingDeterminant,this._scaling.y*this.scalingDeterminant,this._scaling.z*this.scalingDeterminant),this._rotationQuaternion)?(this._rotationQuaternion._isDirty=!1,s=this._rotationQuaternion,this.reIntegrateRotationIntoRotationQuaternion&&this.rotation.lengthSquared()&&(this._rotationQuaternion.multiplyInPlace(d._f.RotationYawPitchRoll(this._rotation.y,this._rotation.x,this._rotation.z)),this._rotation.copyFromFloats(0,0,0))):(s=n._TmpRotation,d._f.RotationYawPitchRollToRef(this._rotation.y,this._rotation.x,this._rotation.z,s));if(this._usePivotMatrix){var p=d.jp.Matrix[1];d.y3.ScalingToRef(l.x,l.y,l.z,p);var v=d.jp.Matrix[0];s.toRotationMatrix(v),this._pivotMatrix.multiplyToRef(p,d.jp.Matrix[4]),d.jp.Matrix[4].multiplyToRef(v,this._localMatrix),this._postMultiplyPivotMatrix&&this._localMatrix.multiplyToRef(this._pivotMatrixInverse,this._localMatrix),this._localMatrix.addTranslationFromFloats(c.x,c.y,c.z)}else d.y3.ComposeToRef(l,s,c,this._localMatrix);if(u&&u.getWorldMatrix){if(e&&u.computeWorldMatrix(e),a){this._transformToBoneReferal?u.getWorldMatrix().multiplyToRef(this._transformToBoneReferal.getWorldMatrix(),d.jp.Matrix[7]):d.jp.Matrix[7].copyFrom(u.getWorldMatrix());var m=d.jp.Vector3[5],g=d.jp.Vector3[6];d.jp.Matrix[7].decompose(g,void 0,m),d.y3.ScalingToRef(g.x,g.y,g.z,d.jp.Matrix[7]),d.jp.Matrix[7].setTranslation(m),d.P.TransformNormalToRef(this._position,u.getWorldMatrix(),m),this._localMatrix.setTranslation(m),this._localMatrix.multiplyToRef(d.jp.Matrix[7],this._worldMatrix)}else this._transformToBoneReferal?(this._localMatrix.multiplyToRef(u.getWorldMatrix(),d.jp.Matrix[6]),d.jp.Matrix[6].multiplyToRef(this._transformToBoneReferal.getWorldMatrix(),this._worldMatrix)):this._localMatrix.multiplyToRef(u.getWorldMatrix(),this._worldMatrix);this._markSyncedWithParent()}else this._worldMatrix.copyFrom(this._localMatrix);if(a&&i&&this.billboardMode&&!r){var _=d.jp.Vector3[0];if(this._worldMatrix.getTranslationToRef(_),d.jp.Matrix[1].copyFrom(i.getViewMatrix()),d.jp.Matrix[1].setTranslationFromFloats(0,0,0),d.jp.Matrix[1].invertToRef(d.jp.Matrix[0]),(this.billboardMode&n.BILLBOARDMODE_ALL)!==n.BILLBOARDMODE_ALL){d.jp.Matrix[0].decompose(void 0,d.jp.Quaternion[0],void 0);var y=d.jp.Vector3[1];d.jp.Quaternion[0].toEulerAnglesToRef(y),(this.billboardMode&n.BILLBOARDMODE_X)!==n.BILLBOARDMODE_X&&(y.x=0),(this.billboardMode&n.BILLBOARDMODE_Y)!==n.BILLBOARDMODE_Y&&(y.y=0),(this.billboardMode&n.BILLBOARDMODE_Z)!==n.BILLBOARDMODE_Z&&(y.z=0),d.y3.RotationYawPitchRollToRef(y.y,y.x,y.z,d.jp.Matrix[0])}this._worldMatrix.setTranslationFromFloats(0,0,0),this._worldMatrix.multiplyToRef(d.jp.Matrix[0],this._worldMatrix),this._worldMatrix.setTranslation(d.jp.Vector3[0])}else if(a&&i&&this.billboardMode&&r){var E=d.jp.Vector3[0];this._worldMatrix.getTranslationToRef(E);var A=i.globalPosition;this._worldMatrix.invertToRef(d.jp.Matrix[1]);var b=d.jp.Vector3[1];d.P.TransformCoordinatesToRef(A,d.jp.Matrix[1],b),b.normalize();var T=-Math.atan2(b.z,b.x)+Math.PI/2,M=Math.sqrt(b.x*b.x+b.z*b.z),S=-Math.atan2(b.y,M);if(d._f.RotationYawPitchRollToRef(T,S,0,d.jp.Quaternion[0]),(this.billboardMode&n.BILLBOARDMODE_ALL)!==n.BILLBOARDMODE_ALL){var I=d.jp.Vector3[1];d.jp.Quaternion[0].toEulerAnglesToRef(I),(this.billboardMode&n.BILLBOARDMODE_X)!==n.BILLBOARDMODE_X&&(I.x=0),(this.billboardMode&n.BILLBOARDMODE_Y)!==n.BILLBOARDMODE_Y&&(I.y=0),(this.billboardMode&n.BILLBOARDMODE_Z)!==n.BILLBOARDMODE_Z&&(I.z=0),d.y3.RotationYawPitchRollToRef(I.y,I.x,I.z,d.jp.Matrix[0])}else d.y3.FromQuaternionToRef(d.jp.Quaternion[0],d.jp.Matrix[0]);this._worldMatrix.setTranslationFromFloats(0,0,0),this._worldMatrix.multiplyToRef(d.jp.Matrix[0],this._worldMatrix),this._worldMatrix.setTranslation(d.jp.Vector3[0])}return this.ignoreNonUniformScaling?this._updateNonUniformScalingState(!1):this._scaling.isNonUniformWithinEpsilon(1e-6)?this._updateNonUniformScalingState(!0):u&&u._nonUniformScaling?this._updateNonUniformScalingState(u._nonUniformScaling):this._updateNonUniformScalingState(!1),this._afterComputeWorldMatrix(),this._absolutePosition.copyFromFloats(this._worldMatrix.m[12],this._worldMatrix.m[13],this._worldMatrix.m[14]),this._isAbsoluteSynced=!1,this.onAfterWorldMatrixUpdateObservable.notifyObservers(this),this._poseMatrix||(this._poseMatrix=d.y3.Invert(this._worldMatrix)),this._worldMatrixDeterminantIsDirty=!0,this._worldMatrix}},{key:"resetLocalMatrix",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.computeWorldMatrix(),e)for(var t=this.getChildren(),n=0;n<t.length;++n){var i=t[n];if(i){i.computeWorldMatrix();var r=d.jp.Matrix[0];i._localMatrix.multiplyToRef(this._localMatrix,r);var a=d.jp.Quaternion[0];r.decompose(i.scaling,a,i.position),i.rotationQuaternion?i.rotationQuaternion.copyFrom(a):a.toEulerAnglesToRef(i.rotation)}}this.scaling.copyFromFloats(1,1,1),this.position.copyFromFloats(0,0,0),this.rotation.copyFromFloats(0,0,0),this.rotationQuaternion&&(this.rotationQuaternion=d._f.Identity()),this._worldMatrix=d.y3.Identity()}},{key:"_afterComputeWorldMatrix",value:function(){}},{key:"registerAfterWorldMatrixUpdate",value:function(e){return this.onAfterWorldMatrixUpdateObservable.add(e),this}},{key:"unregisterAfterWorldMatrixUpdate",value:function(e){return this.onAfterWorldMatrixUpdateObservable.removeCallback(e),this}},{key:"getPositionInCameraSpace",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e||(e=this.getScene().activeCamera),d.P.TransformCoordinates(this.getAbsolutePosition(),e.getViewMatrix())}},{key:"getDistanceToCamera",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e||(e=this.getScene().activeCamera),this.getAbsolutePosition().subtract(e.globalPosition).length()}},{key:"clone",value:function(e,t,i){var r=this,a=h.p4.Clone((function(){return new n(e,r.getScene())}),this);if(a.name=e,a.id=e,t&&(a.parent=t),!i)for(var o=this.getDescendants(!0),s=0;s<o.length;s++){var u=o[s];u.clone&&u.clone(e+"."+u.name,a)}return a}},{key:"serialize",value:function(e){var t=h.p4.Serialize(this,e);return t.type=this.getClassName(),t.uniqueId=this.uniqueId,this.parent&&this.parent._serializeAsParent(t),t.localMatrix=this.getPivotMatrix().asArray(),t.isEnabled=this.isEnabled(),t}},{key:"getChildTransformNodes",value:function(e,t){var i=[];return this._getDescendants(i,e,(function(e){return(!t||t(e))&&e instanceof n})),i}},{key:"dispose",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.getScene().stopAnimation(this),this.getScene().removeTransformNode(this),this._parentContainer){var i=this._parentContainer.transformNodes.indexOf(this);i>-1&&this._parentContainer.transformNodes.splice(i,1),this._parentContainer=null}if(this.onAfterWorldMatrixUpdateObservable.clear(),e){var r,a=this.getChildTransformNodes(!0),s=m(a);try{for(s.s();!(r=s.n()).done;){var u=r.value;u.parent=null,u.computeWorldMatrix(!0)}}catch(c){s.e(c)}finally{s.f()}}(0,o.Z)((0,l.Z)(n.prototype),"dispose",this).call(this,e,t)}},{key:"normalizeToUnitCube",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,i=null,r=null;t&&(this.rotationQuaternion?(r=this.rotationQuaternion.clone(),this.rotationQuaternion.copyFromFloats(0,0,0,1)):this.rotation&&(i=this.rotation.clone(),this.rotation.copyFromFloats(0,0,0)));var a=this.getHierarchyBoundingVectors(e,n),o=a.max.subtract(a.min),s=Math.max(o.x,o.y,o.z);if(0===s)return this;var u=1/s;return this.scaling.scaleInPlace(u),t&&(this.rotationQuaternion&&r?this.rotationQuaternion.copyFrom(r):this.rotation&&i&&this.rotation.copyFrom(i)),this}},{key:"_syncAbsoluteScalingAndRotation",value:function(){this._isAbsoluteSynced||(this._worldMatrix.decompose(this._absoluteScaling,this._absoluteRotationQuaternion),this._isAbsoluteSynced=!0)}}],[{key:"Parse",value:function(e,t,i){var r=h.p4.Parse((function(){return new n(e.name,t)}),e,t,i);return e.localMatrix?r.setPreTransformMatrix(d.y3.FromArray(e.localMatrix)):e.pivotMatrix&&r.setPivotMatrix(d.y3.FromArray(e.pivotMatrix)),r.setEnabled(e.isEnabled),r._waitingParsedUniqueId=e.uniqueId,void 0!==e.parentId&&(r._waitingParentId=e.parentId),void 0!==e.parentInstanceIndex&&(r._waitingParentInstanceIndex=e.parentInstanceIndex),r}}]),n}(p.N);y.BILLBOARDMODE_NONE=0,y.BILLBOARDMODE_X=1,y.BILLBOARDMODE_Y=2,y.BILLBOARDMODE_Z=4,y.BILLBOARDMODE_ALL=7,y.BILLBOARDMODE_USE_POSITION=128,y._TmpRotation=d._f.Zero(),y._TmpScaling=d.P.Zero(),y._TmpTranslation=d.P.Zero(),y._LookAtVectorCache=new d.P(0,0,0),y._RotationAxisCache=new d._f,(0,c.gn)([(0,h.hd)("position")],y.prototype,"_position",void 0),(0,c.gn)([(0,h.hd)("rotation")],y.prototype,"_rotation",void 0),(0,c.gn)([(0,h.mv)("rotationQuaternion")],y.prototype,"_rotationQuaternion",void 0),(0,c.gn)([(0,h.hd)("scaling")],y.prototype,"_scaling",void 0),(0,c.gn)([(0,h.qC)("billboardMode")],y.prototype,"_billboardMode",void 0),(0,c.gn)([(0,h.qC)()],y.prototype,"scalingDeterminant",void 0),(0,c.gn)([(0,h.qC)("infiniteDistance")],y.prototype,"_infiniteDistance",void 0),(0,c.gn)([(0,h.qC)()],y.prototype,"ignoreNonUniformScaling",void 0),(0,c.gn)([(0,h.qC)()],y.prototype,"reIntegrateRotationIntoRotationQuaternion",void 0)},8134:function(e,t,n){"use strict";n.d(t,{B:function(){return a},M:function(){return s}});var i=n(5671),r=n(3144),a=function(){function e(){(0,i.Z)(this,e)}return(0,r.Z)(e,null,[{key:"BuildArray",value:function(e,t){for(var n=[],i=0;i<e;++i)n.push(t());return n}},{key:"BuildTuple",value:function(t,n){return e.BuildArray(t,n)}}]),e}();var o=["push","splice","pop","shift","unshift"];function s(e,t){var n=o.map((function(n){return function(e,t,n){var i=e[t];if("function"!=typeof i)return null;var r=function i(){var r=e.length,a=i.previous.apply(e,arguments);return n(t,r),a};return i.next=r,r.previous=i,e[t]=r,function(){var n=r.previous;if(n){var i=r.next;i?(n.next=i,i.previous=n):(n.next=void 0,e[t]=n),r.next=void 0,r.previous=void 0}}}(e,n,t)}));return function(){n.forEach((function(e){null==e||e()}))}}},505:function(e,t,n){"use strict";n.d(t,{D:function(){return o}});var i=n(5671),r=n(3144),a=n(5092),o=function(){function e(t,n){(0,i.Z)(this,e),e.IsAvailable&&(this._observer=new window.ComputePressureObserver(t,n))}return(0,r.Z)(e,[{key:"observe",value:function(e){var t,n;(null===(t=this._observer)||void 0===t?void 0:t.observe)&&(null===(n=this._observer)||void 0===n||n.observe(e).catch((function(){})))}},{key:"unobserve",value:function(e){try{var t,n;(null===(t=this._observer)||void 0===t?void 0:t.unobserve)&&(null===(n=this._observer)||void 0===n||n.unobserve(e))}catch(i){}}}],[{key:"IsAvailable",get:function(){var e,t;return(0,a.CG)()&&"ComputePressureObserver"in window&&(null===(e=window.ComputePressureObserver)||void 0===e||null===(t=e.supportedSources)||void 0===t?void 0:t.includes("cpu"))}}]),e}()},5203:function(e,t,n){"use strict";function i(e,t,n){try{var i=e.next();i.done?t(i):i.value?i.value.then((function(){i.value=void 0,t(i)}),n):t(i)}catch(r){n(r)}}function r(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:25;return function(n,r,a){var o=performance.now();void 0===e||o-e>t?(e=o,setTimeout((function(){i(n,r,a)}),0)):i(n,r,a)}}function a(e,t,n,i,r){!function a(){var o,s=function(e){e.done?n(e.value):void 0===o?o=!0:a()};do{o=void 0,r&&r.aborted?i(new Error("Aborted")):t(e,s,i),void 0===o&&(o=!1)}while(o)}()}function o(e,t){var n;return a(e,i,(function(e){return n=e}),(function(e){throw e}),t),n}function s(e,t,n){return new Promise((function(i,r){a(e,t,i,r,n)}))}function u(e,t){return function(){return o(e.apply(void 0,arguments),t)}}n.d(t,{KO:function(){return r},s3:function(){return o},sM:function(){return s},vp:function(){return u}})},9336:function(e,t,n){"use strict";n.d(t,{G6:function(){return x},N$:function(){return T},QC:function(){return E},RR:function(){return b},XX:function(){return M},hd:function(){return A},mv:function(){return S},n9:function(){return _},oU:function(){return g},p4:function(){return I},qC:function(){return m},qQ:function(){return y},wz:function(){return v}});var i=n(5671),r=n(3144),a=n(7032),o=n(6900),s=n(5230),u=n(7046),l={},c={},h=function(e,t,n){var i=e();a.$&&a.$.AddTagsTo(i,t.tags);var r=f(i);for(var o in r){var s=r[o],u=t[o],l=s.type;if(null!=u&&("uniqueId"!==o||I.AllowLoadingUniqueId))switch(l){case 0:case 6:case 11:i[o]=u;break;case 1:i[o]=n||u.isRenderTarget?u:u.clone();break;case 2:case 3:case 4:case 5:case 7:case 10:case 12:i[o]=n?u:u.clone()}}return i};function f(e){var t=e.getClassName();if(c[t])return c[t];c[t]={};for(var n=c[t],i=e,r=t;r;){var a=l[r];for(var o in a)n[o]=a[o];var s=void 0,u=!1;do{if(!(s=Object.getPrototypeOf(i)).getClassName){u=!0;break}if(s.getClassName()!==r)break;i=s}while(s);if(u)break;r=s.getClassName(),i=s}return n}function d(e,t){return function(n,i){var r=function(e){var t=e.getClassName();return l[t]||(l[t]={}),l[t]}(n);r[i]||(r[i]={type:e,sourceName:t})}}function p(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return function(n,i){var r=t||"_"+i;Object.defineProperty(n,i,{get:function(){return this[r]},set:function(t){"function"==typeof this.equals&&this.equals(t)||this[r]!==t&&(this[r]=t,n[e].apply(this))},enumerable:!0,configurable:!0})}}function v(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return p(e,t)}function m(e){return d(0,e)}function g(e){return d(1,e)}function _(e){return d(2,e)}function y(e){return d(3,e)}function E(e){return d(4,e)}function A(e){return d(5,e)}function b(e){return d(6,e)}function T(e){return d(7,e)}function M(e){return d(8,e)}function S(e){return d(10,e)}var I=function(){function e(){(0,i.Z)(this,e)}return(0,r.Z)(e,null,[{key:"AppendSerializedAnimations",value:function(e,t){if(e.animations){t.animations=[];for(var n=0;n<e.animations.length;n++){var i=e.animations[n];t.animations.push(i.serialize())}}}},{key:"Serialize",value:function(t,n){n||(n={}),a.$&&(n.tags=a.$.GetTags(t));var i=f(t);for(var r in i){var o=i[r],s=o.sourceName||r,u=o.type,l=t[r];if(null!=l&&("uniqueId"!==r||e.AllowLoadingUniqueId))switch(u){case 0:n[s]=l;break;case 1:case 3:case 7:case 9:n[s]=l.serialize();break;case 2:case 4:case 5:case 8:case 10:case 12:n[s]=l.asArray();break;case 6:case 11:n[s]=l.id}}return n}},{key:"Parse",value:function(t,n,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=t();r||(r=""),a.$&&a.$.AddTagsTo(s,n.tags);var l=f(s);for(var c in l){var h=l[c],d=n[h.sourceName||c],p=h.type;if(null!=d&&("uniqueId"!==c||e.AllowLoadingUniqueId)){var v=s;switch(p){case 0:v[c]=d;break;case 1:i&&(v[c]=e._TextureParser(d,i,r));break;case 2:v[c]=u.Wo.FromArray(d);break;case 3:v[c]=e._FresnelParametersParser(d);break;case 4:v[c]=o.FM.FromArray(d);break;case 5:v[c]=o.P.FromArray(d);break;case 6:i&&(v[c]=i.getLastMeshById(d));break;case 7:v[c]=e._ColorCurvesParser(d);break;case 8:v[c]=u.HE.FromArray(d);break;case 9:v[c]=e._ImageProcessingConfigurationParser(d);break;case 10:v[c]=o._f.FromArray(d);break;case 11:i&&(v[c]=i.getCameraById(d));break;case 12:v[c]=o.y3.FromArray(d)}}}return s}},{key:"Clone",value:function(e,t){return h(e,t,!1)}},{key:"Instanciate",value:function(e,t){return h(e,t,!0)}}]),e}();function x(e,t,n,i){var r=n.value;n.value=function(){var n=r;if("undefined"!=typeof _native&&_native[t]){var a=_native[t];n=i?function(){return i.apply(void 0,arguments)?a.apply(void 0,arguments):r.apply(void 0,arguments)}:a}return e[t]=n,n.apply(void 0,arguments)}}I.AllowLoadingUniqueId=!1,I._ImageProcessingConfigurationParser=function(e){throw(0,s.S)("ImageProcessingConfiguration")},I._FresnelParametersParser=function(e){throw(0,s.S)("FresnelParameters")},I._ColorCurvesParser=function(e){throw(0,s.S)("ColorCurves")},I._TextureParser=function(e,t,n){throw(0,s.S)("Texture")},x.filter=function(e){return function(t,n,i){return x(t,n,i,e)}}},3192:function(e,t,n){"use strict";n.d(t,{j:function(){return l}});var i=n(5671),r=n(3144),a=n(2328);function o(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){u=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(u)throw a}}}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var u=function(e,t){return e?e.getClassName&&"Mesh"===e.getClassName()?null:e.getClassName&&"SubMesh"===e.getClassName()?e.clone(t):e.clone?e.clone():null:null};var l=function(){function e(){(0,i.Z)(this,e)}return(0,r.Z)(e,null,[{key:"DeepCopy",value:function(e,t,n,i){var r,s=function(e){var t=[];do{Object.getOwnPropertyNames(e).forEach((function(e){-1===t.indexOf(e)&&t.push(e)}))}while(e=Object.getPrototypeOf(e));return t}(e),l=o(s);try{for(l.s();!(r=l.n()).done;){var c=r.value;if(("_"!==c[0]||i&&-1!==i.indexOf(c))&&!(c.endsWith("Observable")||n&&-1!==n.indexOf(c))){var h=e[c],f=typeof h;if("function"!==f)try{if("object"===f)if(h instanceof Array){if(t[c]=[],h.length>0)if("object"==typeof h[0])for(var d=0;d<h.length;d++){var p=u(h[d],t);-1===t[c].indexOf(p)&&t[c].push(p)}else t[c]=h.slice(0)}else t[c]=u(h,t);else t[c]=h}catch(v){a.Y.Warn(v.message)}}}}catch(m){l.e(m)}finally{l.f()}}}]),e}()},5230:function(e,t,n){"use strict";function i(e){return"".concat(e," needs to be imported before as it contains a side-effect required by your code.")}n.d(t,{S:function(){return i}})},5092:function(e,t,n){"use strict";function i(){return"undefined"!=typeof window}function r(){return"undefined"!=typeof navigator}function a(){return"undefined"!=typeof document}function o(e){for(var t="",n=e.firstChild;n;)3===n.nodeType&&(t+=n.textContent),n=n.nextSibling;return t}n.d(t,{CG:function(){return i},MZ:function(){return s},n5:function(){return a},up:function(){return r},v:function(){return o}});var s={IsWindowObjectExist:i,IsNavigatorAvailable:r,IsDocumentAvailable:a,GetDOMTextContent:o}},8298:function(e,t,n){"use strict";n.d(t,{GU:function(){return c},LH:function(){return f},SM:function(){return h}});var i=n(7326),r=n(3144),a=n(5671),o=n(136),s=n(6215),u=n(1120);function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,u.Z)(e);if(t){var r=(0,u.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,s.Z)(this,n)}}var c=function(e){(0,o.Z)(n,e);var t=l(n);function n(){return(0,a.Z)(this,n),t.apply(this,arguments)}return(0,r.Z)(n)}((0,n(2407).Z)(Error));c._setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e};var h={MeshInvalidPositionsError:0,UnsupportedTextureError:1e3,GLTFLoaderUnexpectedMagicError:2e3,SceneLoaderError:3e3,LoadFileError:4e3,RequestFileError:4001,ReadFileError:4002},f=function(e){(0,o.Z)(n,e);var t=l(n);function n(e,r,o){var s;return(0,a.Z)(this,n),(s=t.call(this,e)).errorCode=r,s.innerError=o,s.name="RuntimeError",c._setPrototypeOf((0,i.Z)(s),n.prototype),s}return(0,r.Z)(n)}(c)},562:function(e,t,n){"use strict";n.d(t,{$K:function(){return U},rN:function(){return P},VL:function(){return F},vP:function(){return N},r6:function(){return k},Ip:function(){return O},FV:function(){return w},$M:function(){return R}});var i=n(4942),r=n(3144),a=n(5671),o=n(7326),s=n(136),u=n(6215),l=n(1120),c=n(8628),h=n(5092),f=n(4174),d=(0,r.Z)((function e(){(0,a.Z)(this,e)}));d.FilesToLoad={};var p=function(){function e(){(0,a.Z)(this,e)}return(0,r.Z)(e,null,[{key:"ExponentialBackoff",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500;return function(n,i,r){return 0!==i.status||r>=e||-1!==n.indexOf("file:")?-1:Math.pow(2,r)*t}}}]),e}(),v=n(8298),m=n(2399),g=n(9776),_=n(4796),y=n(4198),E=n(2328),A=n(8370);function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function T(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function M(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,l.Z)(e);if(t){var r=(0,l.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,u.Z)(this,n)}}var S=new RegExp(/^data:([^,]+\/[^,]+)?;base64,/i),I=function(e){(0,s.Z)(n,e);var t=M(n);function n(e,i){var r;return(0,a.Z)(this,n),(r=t.call(this,e,v.SM.LoadFileError)).name="LoadFileError",v.GU._setPrototypeOf((0,o.Z)(r),n.prototype),i instanceof c.g?r.request=i:r.file=i,r}return(0,r.Z)(n)}(v.LH),x=function(e){(0,s.Z)(n,e);var t=M(n);function n(e,i){var r;return(0,a.Z)(this,n),(r=t.call(this,e,v.SM.RequestFileError)).request=i,r.name="RequestFileError",v.GU._setPrototypeOf((0,o.Z)(r),n.prototype),r}return(0,r.Z)(n)}(v.LH),C=function(e){(0,s.Z)(n,e);var t=M(n);function n(e,i){var r;return(0,a.Z)(this,n),(r=t.call(this,e,v.SM.ReadFileError)).file=i,r.name="ReadFileError",v.GU._setPrototypeOf((0,o.Z)(r),n.prototype),r}return(0,r.Z)(n)}(v.LH),P={DefaultRetryStrategy:p.ExponentialBackoff(),BaseUrl:"",CorsBehavior:"anonymous",PreprocessUrl:function(e){return e}},D=function(e){return e=e.replace(/#/gm,"%23")},R=function(e,t){if((!e||0!==e.indexOf("data:"))&&P.CorsBehavior)if("string"==typeof P.CorsBehavior||P.CorsBehavior instanceof String)t.crossOrigin=P.CorsBehavior;else{var n=P.CorsBehavior(e);n&&(t.crossOrigin=n)}},k=function(e,t,n,i){var r,a,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",s=arguments.length>5?arguments[5]:void 0,u=!1;e instanceof ArrayBuffer||ArrayBuffer.isView(e)?"undefined"!=typeof Blob&&"undefined"!=typeof URL?(a=URL.createObjectURL(new Blob([e],{type:o})),u=!0):a="data:".concat(o,";base64,")+(0,m.Gh)(e):e instanceof Blob?(a=URL.createObjectURL(e),u=!0):(a=D(e),a=P.PreprocessUrl(e));var l=y.l.LastCreatedEngine,c=function(t){if(n){var i=a||e.toString();n("Error while trying to load image: ".concat(0===i.indexOf("http")||i.length<=128?i:i.slice(0,128)+"..."),t)}};if("undefined"==typeof Image||null!==(r=null==l?void 0:l._features.forceBitmapOverHTMLImageElement)&&void 0!==r&&r)return N(a,(function(i){l.createImageBitmap(new Blob([i],{type:o}),T({premultiplyAlpha:"none"},s)).then((function(e){t(e),u&&URL.revokeObjectURL(a)})).catch((function(t){n&&n("Error while trying to load image: "+e,t)}))}),void 0,i||void 0,!0,(function(e,t){c(t)})),null;var h=new Image;R(a,h);var f=function e(){h.removeEventListener("load",e),h.removeEventListener("error",p),t(h),u&&h.src&&URL.revokeObjectURL(h.src)},p=function e(t){h.removeEventListener("load",f),h.removeEventListener("error",e),c(t),u&&h.src&&URL.revokeObjectURL(h.src)};h.addEventListener("load",f),h.addEventListener("error",p);var v="blob:"===a.substring(0,5),g="data:"===a.substring(0,5),_=function(){v||g?h.src=a:N(a,(function(e,t,n){var i=new Blob([e],{type:!o&&n?n:o}),r=URL.createObjectURL(i);u=!0,h.src=r}),void 0,i||void 0,!0,(function(e,t){c(t)}))},E=function(){i&&i.loadImage(a,h)};if(!v&&!g&&i&&i.enableTexturesOffline)i.open(E,_);else{if(-1!==a.indexOf("file:")){var A=decodeURIComponent(a.substring(5).toLowerCase());if(d.FilesToLoad[A]&&"undefined"!=typeof URL){try{var b;try{b=URL.createObjectURL(d.FilesToLoad[A])}catch(M){b=URL.createObjectURL(d.FilesToLoad[A])}h.src=b,u=!0}catch(S){h.src=""}return h}}_()}return h},O=function(e,t,n,i,r){var a=new FileReader,o={onCompleteObservable:new f.y$,abort:function(){return a.abort()}};return a.onloadend=function(){return o.onCompleteObservable.notifyObservers(o)},r&&(a.onerror=function(){r(new C("Unable to read ".concat(e.name),e))}),a.onload=function(e){t(e.target.result)},n&&(a.onprogress=n),i?a.readAsArrayBuffer(e):a.readAsText(e),o},N=function(e,t,n,i,r,a,o){if(e.name)return O(e,t,n,r,a?function(e){a(void 0,e)}:void 0);var s=e;if(-1!==s.indexOf("file:")){var u=decodeURIComponent(s.substring(5).toLowerCase());0===u.indexOf("./")&&(u=u.substring(2));var l=d.FilesToLoad[u];if(l)return O(l,t,n,r,a?function(e){return a(void 0,new I(e.message,e.file))}:void 0)}var c=B(s),h=c.match,p=c.type;if(h){var m={onCompleteObservable:new f.y$,abort:function(){return function(){}}};try{var g=r?U(s):G(s);t(g,void 0,p)}catch(v){a?a(void 0,v):E.Y.Error(v.message||"Failed to parse the Data URL")}return A.Q.SetImmediate((function(){m.onCompleteObservable.notifyObservers(m)})),m}return w(s,(function(e,n){t(e,null==n?void 0:n.responseURL,null==n?void 0:n.getResponseHeader("content-type"))}),n,i,r,a?function(e){a(e.request,new I(e.message,e.request))}:void 0,o)},w=function(e,t,n,i,r,a,o){e=D(e),e=P.PreprocessUrl(e);var s=P.BaseUrl+e,u=!1,l={onCompleteObservable:new f.y$,abort:function(){return u=!0}},d=function(){var e,i=new c.g,f=null,d=function(){i&&(n&&i.removeEventListener("progress",n),e&&i.removeEventListener("readystatechange",e),i.removeEventListener("loadend",p))},p=function(){d(),l.onCompleteObservable.notifyObservers(l),l.onCompleteObservable.clear(),n=void 0,e=null,p=null,a=void 0,o=void 0,t=void 0};l.abort=function(){u=!0,p&&p(),i&&i.readyState!==(XMLHttpRequest.DONE||4)&&i.abort(),null!==f&&(clearTimeout(f),f=null),i=null};var v=function(e){var t=e.message||"Unknown error";a&&i?a(new x(t,i)):E.Y.Error(t)};!function l(m){if(i){if(i.open("GET",s),o)try{o(i)}catch(g){return void v(g)}r&&(i.responseType="arraybuffer"),n&&i.addEventListener("progress",n),p&&i.addEventListener("loadend",p),e=function(){if(!u&&i&&i.readyState===(XMLHttpRequest.DONE||4)){if(e&&i.removeEventListener("readystatechange",e),i.status>=200&&i.status<300||0===i.status&&(!(0,h.CG)()||L())){try{t&&t(r?i.response:i.responseText,i)}catch(g){v(g)}return}var n=P.DefaultRetryStrategy;if(n){var o=n(s,i,m);if(-1!==o)return d(),i=new c.g,void(f=setTimeout((function(){return l(m+1)}),o))}var p=new x("Error status: "+i.status+" "+i.statusText+" - Unable to load "+s,i);a&&a(p)}},i.addEventListener("readystatechange",e),i.send()}}(0)};if(i&&i.enableSceneOffline){var p=function(e){e&&e.status>400?a&&a(e):d()};i.open((function(){i&&i.loadFile(P.BaseUrl+e,(function(e){!u&&t&&t(e),l.onCompleteObservable.notifyObservers(l)}),n?function(e){!u&&n&&n(e)}:void 0,p,r)}),p)}else d();return l},L=function(){return"undefined"!=typeof location&&"file:"===location.protocol},F=function(e){return S.test(e)},B=function(e){var t=S.exec(e);return null===t||0===t.length?{match:!1,type:""}:{match:!0,type:t[0].replace("data:","").replace("base64,","")}};function U(e){return(0,m.HQ)(e.split(",")[1])}var V,G=function(e){return(0,m.rP)(e.split(",")[1])};_.B._FileToolsLoadImage=k,_.B._FileToolsLoadFile=N,g.L._FileToolsLoadFile=N;!function(e,t,n,i,r,a,o,s,u,l){V={DecodeBase64UrlToBinary:e,DecodeBase64UrlToString:t,DefaultRetryStrategy:n.DefaultRetryStrategy,BaseUrl:n.BaseUrl,CorsBehavior:n.CorsBehavior,PreprocessUrl:n.PreprocessUrl,IsBase64DataUrl:i,IsFileURL:r,LoadFile:a,LoadImage:o,ReadFile:s,RequestFile:u,SetCorsBehavior:l},Object.defineProperty(V,"DefaultRetryStrategy",{get:function(){return n.DefaultRetryStrategy},set:function(e){n.DefaultRetryStrategy=e}}),Object.defineProperty(V,"BaseUrl",{get:function(){return n.BaseUrl},set:function(e){n.BaseUrl=e}}),Object.defineProperty(V,"PreprocessUrl",{get:function(){return n.PreprocessUrl},set:function(e){n.PreprocessUrl=e}}),Object.defineProperty(V,"CorsBehavior",{get:function(){return n.CorsBehavior},set:function(e){n.CorsBehavior=e}})}(U,G,P,F,L,N,k,O,w,R)},9950:function(e,t,n){"use strict";function i(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}n.d(t,{f:function(){return i}})},8797:function(e,t,n){"use strict";n.d(t,{K:function(){return s}});var i=n(5671),r=n(3144),a=n(2328),o=n(1704),s=function(){function e(){(0,i.Z)(this,e)}return(0,r.Z)(e,null,[{key:"Instantiate",value:function(e){if(this.RegisteredExternalClasses&&this.RegisteredExternalClasses[e])return this.RegisteredExternalClasses[e];var t=(0,o.q)(e);if(t)return t;a.Y.Warn(e+" not found, you may have missed an import.");for(var n=e.split("."),i=window||this,r=0,s=n.length;r<s;r++)i=i[n[r]];return"function"!=typeof i?null:i}}]),e}();s.RegisteredExternalClasses={}},2328:function(e,t,n){"use strict";n.d(t,{Y:function(){return a}});var i=n(5671),r=n(3144),a=function(){function e(){(0,i.Z)(this,e)}return(0,r.Z)(e,null,[{key:"_CheckLimit",value:function(t,n){var i=e._LogLimitOutputs[t];return i?i.current++:(i={limit:n,current:1},e._LogLimitOutputs[t]=i),i.current<=i.limit}},{key:"_GenerateLimitMessage",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=e._LogLimitOutputs[t];if(i&&e.MessageLimitReached){var r,a=this._Levels[n];if(i.current===i.limit)e[a.name](e.MessageLimitReached.replace(/%LIMIT%/g,""+i.limit).replace(/%TYPE%/g,null!==(r=a.name)&&void 0!==r?r:""))}}},{key:"_AddLogEntry",value:function(t){e._LogCache=t+e._LogCache,e.OnNewCacheEntry&&e.OnNewCacheEntry(t)}},{key:"_FormatMessage",value:function(e){var t=function(e){return e<10?"0"+e:""+e},n=new Date;return"["+t(n.getHours())+":"+t(n.getMinutes())+":"+t(n.getSeconds())+"]: "+e}},{key:"_LogDisabled",value:function(e,t){}},{key:"_LogEnabled",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0;if(void 0===i||e._CheckLimit(n,i)){var r=e._FormatMessage(n),a=this._Levels[t];a.logFunc&&a.logFunc("BJS - "+r);var o="<div style='color:".concat(a.color,"'>").concat(r,"</div><br>");e._AddLogEntry(o),e._GenerateLimitMessage(n,t)}}},{key:"LogCache",get:function(){return e._LogCache}},{key:"ClearLogCache",value:function(){e._LogCache="",e._LogLimitOutputs={},e.errorsCount=0}},{key:"LogLevels",set:function(t){var n=this;e.Log=e._LogDisabled,e.Warn=e._LogDisabled,e.Error=e._LogDisabled,[e.MessageLogLevel,e.WarningLogLevel,e.ErrorLogLevel].forEach((function(i){(t&i)===i&&(e[n._Levels[i].name]=e._LogEnabled.bind(e,i))}))}}]),e}();a.NoneLogLevel=0,a.MessageLogLevel=1,a.WarningLogLevel=2,a.ErrorLogLevel=4,a.AllLogLevel=7,a.MessageLimitReached="Too many %TYPE%s (%LIMIT%), no more %TYPE%s will be reported for this message.",a._LogCache="",a._LogLimitOutputs={},a._Levels=[{},{color:"white",logFunc:console.log,name:"Log"},{color:"orange",logFunc:console.warn,name:"Warn"},{},{color:"red",logFunc:console.error,name:"Error"}],a.errorsCount=0,a.Log=a._LogEnabled.bind(a,a.MessageLogLevel),a.Warn=a._LogEnabled.bind(a,a.WarningLogLevel),a.Error=a._LogEnabled.bind(a,a.ErrorLogLevel)},4174:function(e,t,n){"use strict";n.d(t,{y$:function(){return l}});var i=n(5671),r=n(3144);function a(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){u=!0,a=e},f:function(){try{s||null==n.return||n.return()}finally{if(u)throw a}}}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var s=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0;(0,i.Z)(this,e),this.initialize(t,n,r,a)}return(0,r.Z)(e,[{key:"initialize",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;return this.mask=e,this.skipNextObservers=t,this.target=n,this.currentTarget=i,this}}]),e}(),u=(0,r.Z)((function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;(0,i.Z)(this,e),this.callback=t,this.mask=n,this.scope=r,this._willBeUnregistered=!1,this.unregisterOnNextCall=!1})),l=function(){function e(t){(0,i.Z)(this,e),this._observers=new Array,this._eventState=new s(0),t&&(this._onObserverAdded=t)}return(0,r.Z)(e,[{key:"observers",get:function(){return this._observers}},{key:"add",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!e)return null;var a=new u(e,t,i);return a.unregisterOnNextCall=r,n?this._observers.unshift(a):this._observers.push(a),this._onObserverAdded&&this._onObserverAdded(a),a}},{key:"addOnce",value:function(e){return this.add(e,void 0,void 0,void 0,!0)}},{key:"remove",value:function(e){return!!e&&(-1!==this._observers.indexOf(e)&&(this._deferUnregister(e),!0))}},{key:"removeCallback",value:function(e,t){for(var n=0;n<this._observers.length;n++){var i=this._observers[n];if(!i._willBeUnregistered&&(i.callback===e&&(!t||t===i.scope)))return this._deferUnregister(i),!0}return!1}},{key:"_deferUnregister",value:function(e){var t=this;e.unregisterOnNextCall=!1,e._willBeUnregistered=!0,setTimeout((function(){t._remove(e)}),0)}},{key:"_remove",value:function(e){if(!e)return!1;var t=this._observers.indexOf(e);return-1!==t&&(this._observers.splice(t,1),!0)}},{key:"makeObserverTopPriority",value:function(e){this._remove(e),this._observers.unshift(e)}},{key:"makeObserverBottomPriority",value:function(e){this._remove(e),this._observers.push(e)}},{key:"notifyObservers",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0;if(!this._observers.length)return!0;var o=this._eventState;o.mask=t,o.target=n,o.currentTarget=i,o.skipNextObservers=!1,o.lastReturnValue=e,o.userInfo=r;var s,u=a(this._observers);try{for(u.s();!(s=u.n()).done;){var l=s.value;if(!l._willBeUnregistered&&(l.mask&t&&(l.scope?o.lastReturnValue=l.callback.apply(l.scope,[e,o]):o.lastReturnValue=l.callback(e,o),l.unregisterOnNextCall&&this._deferUnregister(l)),o.skipNextObservers))return!1}}catch(c){u.e(c)}finally{u.f()}return!0}},{key:"notifyObserver",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(!e._willBeUnregistered){var i=this._eventState;i.mask=n,i.skipNextObservers=!1,e.callback(t,i),e.unregisterOnNextCall&&this._deferUnregister(e)}}},{key:"hasObservers",value:function(){return this._observers.length>0}},{key:"clear",value:function(){this._observers=new Array,this._onObserverAdded=null}},{key:"clone",value:function(){var t=new e;return t._observers=this._observers.slice(0),t}},{key:"hasSpecificMask",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,n=a(this._observers);try{for(n.s();!(e=n.n()).done;){var i=e.value;if(i.mask&t||i.mask===t)return!0}}catch(r){n.e(r)}finally{n.f()}return!1}}],[{key:"FromPromise",value:function(t,n){var i=new e;return t.then((function(e){i.notifyObservers(e)})).catch((function(e){if(!n)throw e;n.notifyObservers(e)})),i}}]),e}()},2864:function(e,t,n){"use strict";n.d(t,{z:function(){return o}});var i=n(5671),r=n(3144),a=n(2786),o=function(){function e(){(0,i.Z)(this,e),this._startMonitoringTime=0,this._min=0,this._max=0,this._average=0,this._lastSecAverage=0,this._current=0,this._totalValueCount=0,this._totalAccumulated=0,this._lastSecAccumulated=0,this._lastSecTime=0,this._lastSecValueCount=0}return(0,r.Z)(e,[{key:"min",get:function(){return this._min}},{key:"max",get:function(){return this._max}},{key:"average",get:function(){return this._average}},{key:"lastSecAverage",get:function(){return this._lastSecAverage}},{key:"current",get:function(){return this._current}},{key:"total",get:function(){return this._totalAccumulated}},{key:"count",get:function(){return this._totalValueCount}},{key:"fetchNewFrame",value:function(){this._totalValueCount++,this._current=0,this._lastSecValueCount++}},{key:"addCount",value:function(t,n){e.Enabled&&(this._current+=t,n&&this._fetchResult())}},{key:"beginMonitoring",value:function(){e.Enabled&&(this._startMonitoringTime=a.F.Now)}},{key:"endMonitoring",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(e.Enabled){t&&this.fetchNewFrame();var n=a.F.Now;this._current=n-this._startMonitoringTime,t&&this._fetchResult()}}},{key:"_fetchResult",value:function(){this._totalAccumulated+=this._current,this._lastSecAccumulated+=this._current,this._min=Math.min(this._min,this._current),this._max=Math.max(this._max,this._current),this._average=this._totalAccumulated/this._totalValueCount;var e=a.F.Now;e-this._lastSecTime>1e3&&(this._lastSecAverage=this._lastSecAccumulated/this._lastSecValueCount,this._lastSecTime=e,this._lastSecAccumulated=0,this._lastSecValueCount=0)}}]),e}();o.Enabled=!0},2786:function(e,t,n){"use strict";n.d(t,{F:function(){return o}});var i=n(5671),r=n(3144),a=n(5092),o=function(){function e(){(0,i.Z)(this,e)}return(0,r.Z)(e,null,[{key:"Now",get:function(){return a.MZ.IsWindowObjectExist()&&window.performance&&window.performance.now?window.performance.now():Date.now()}}]),e}()},5934:function(e,t,n){"use strict";n.d(t,{f:function(){return h},t:function(){return c}});var i=n(1752),r=n(136),a=n(6215),o=n(1120),s=n(5671),u=n(3144);function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,o.Z)(e);if(t){var r=(0,o.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,a.Z)(this,n)}}var c=function(){function e(t){(0,s.Z)(this,e),this.length=0,this.data=new Array(t),this._id=e._GlobalId++}return(0,u.Z)(e,[{key:"push",value:function(e){this.data[this.length++]=e,this.length>this.data.length&&(this.data.length*=2)}},{key:"forEach",value:function(e){for(var t=0;t<this.length;t++)e(this.data[t])}},{key:"sort",value:function(e){this.data.sort(e)}},{key:"reset",value:function(){this.length=0}},{key:"dispose",value:function(){this.reset(),this.data&&(this.data.length=0)}},{key:"concat",value:function(e){if(0!==e.length){this.length+e.length>this.data.length&&(this.data.length=2*(this.length+e.length));for(var t=0;t<e.length;t++)this.data[this.length++]=(e.data||e)[t]}}},{key:"indexOf",value:function(e){var t=this.data.indexOf(e);return t>=this.length?-1:t}},{key:"contains",value:function(e){return-1!==this.indexOf(e)}}]),e}();c._GlobalId=0;var h=function(e){(0,r.Z)(n,e);var t=l(n);function n(){var e;return(0,s.Z)(this,n),(e=t.apply(this,arguments))._duplicateId=0,e}return(0,u.Z)(n,[{key:"push",value:function(e){(0,i.Z)((0,o.Z)(n.prototype),"push",this).call(this,e),e.__smartArrayFlags||(e.__smartArrayFlags={}),e.__smartArrayFlags[this._id]=this._duplicateId}},{key:"pushNoDuplicate",value:function(e){return(!e.__smartArrayFlags||e.__smartArrayFlags[this._id]!==this._duplicateId)&&(this.push(e),!0)}},{key:"reset",value:function(){(0,i.Z)((0,o.Z)(n.prototype),"reset",this).call(this),this._duplicateId++}},{key:"concatWithNoDuplicate",value:function(e){if(0!==e.length){this.length+e.length>this.data.length&&(this.data.length=2*(this.length+e.length));for(var t=0;t<e.length;t++){var n=(e.data||e)[t];this.pushNoDuplicate(n)}}}}]),n}(c)},128:function(e,t,n){"use strict";n.d(t,{x:function(){return a}});var i=n(5671),r=n(3144),a=function(){function e(){(0,i.Z)(this,e),this._count=0,this._data={}}return(0,r.Z)(e,[{key:"copyFrom",value:function(e){var t=this;this.clear(),e.forEach((function(e,n){return t.add(e,n)}))}},{key:"get",value:function(e){var t=this._data[e];if(void 0!==t)return t}},{key:"getOrAddWithFactory",value:function(e,t){var n=this.get(e);return void 0!==n||(n=t(e))&&this.add(e,n),n}},{key:"getOrAdd",value:function(e,t){var n=this.get(e);return void 0!==n?n:(this.add(e,t),t)}},{key:"contains",value:function(e){return void 0!==this._data[e]}},{key:"add",value:function(e,t){return void 0===this._data[e]&&(this._data[e]=t,++this._count,!0)}},{key:"set",value:function(e,t){return void 0!==this._data[e]&&(this._data[e]=t,!0)}},{key:"getAndRemove",value:function(e){var t=this.get(e);return void 0!==t?(delete this._data[e],--this._count,t):null}},{key:"remove",value:function(e){return!!this.contains(e)&&(delete this._data[e],--this._count,!0)}},{key:"clear",value:function(){this._data={},this._count=0}},{key:"count",get:function(){return this._count}},{key:"forEach",value:function(e){for(var t in this._data){e(t,this._data[t])}}},{key:"first",value:function(e){for(var t in this._data){var n=e(t,this._data[t]);if(n)return n}return null}}]),e}()},2399:function(e,t,n){"use strict";n.d(t,{Gh:function(){return i},HQ:function(){return a},rP:function(){return r}});var i=function(e){for(var t,n,i,r,a,o,s,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",l="",c=0,h=ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e);c<h.length;)r=(t=h[c++])>>2,a=(3&t)<<4|(n=c<h.length?h[c++]:Number.NaN)>>4,o=(15&n)<<2|(i=c<h.length?h[c++]:Number.NaN)>>6,s=63&i,isNaN(n)?o=s=64:isNaN(i)&&(s=64),l+=u.charAt(r)+u.charAt(a)+u.charAt(o)+u.charAt(s);return l},r=function(e){return atob(e)},a=function(e){for(var t=r(e),n=t.length,i=new Uint8Array(new ArrayBuffer(n)),a=0;a<n;a++)i[a]=t.charCodeAt(a);return i.buffer}},7032:function(e,t,n){"use strict";n.d(t,{$:function(){return o}});var i=n(5671),r=n(3144),a=function(){function e(){(0,i.Z)(this,e)}return(0,r.Z)(e,null,[{key:"Eval",value:function(t,n){return"true"===(t=t.match(/\([^()]*\)/g)?t.replace(/\([^()]*\)/g,(function(t){return t=t.slice(1,t.length-1),e._HandleParenthesisContent(t,n)})):e._HandleParenthesisContent(t,n))||"false"!==t&&e.Eval(t,n)}},{key:"_HandleParenthesisContent",value:function(t,n){var i;n=n||function(e){return"true"===e};var r=t.split("||");for(var a in r)if(Object.prototype.hasOwnProperty.call(r,a)){var o=e._SimplifyNegation(r[a].trim()),s=o.split("&&");if(s.length>1)for(var u=0;u<s.length;++u){var l=e._SimplifyNegation(s[u].trim());if(!(i="true"!==l&&"false"!==l?"!"===l[0]?!n(l.substring(1)):n(l):"true"===l)){o="false";break}}if(i||"true"===o){i=!0;break}i="true"!==o&&"false"!==o?"!"===o[0]?!n(o.substring(1)):n(o):"true"===o}return i?"true":"false"}},{key:"_SimplifyNegation",value:function(e){return"!true"===(e=(e=e.replace(/^[\s!]+/,(function(e){return(e=e.replace(/[\s]/g,(function(){return""}))).length%2?"!":""}))).trim())?e="false":"!false"===e&&(e="true"),e}}]),e}(),o=function(){function e(){(0,i.Z)(this,e)}return(0,r.Z)(e,null,[{key:"EnableFor",value:function(t){t._tags=t._tags||{},t.hasTags=function(){return e.HasTags(t)},t.addTags=function(n){return e.AddTagsTo(t,n)},t.removeTags=function(n){return e.RemoveTagsFrom(t,n)},t.matchesTagsQuery=function(n){return e.MatchesQuery(t,n)}}},{key:"DisableFor",value:function(e){delete e._tags,delete e.hasTags,delete e.addTags,delete e.removeTags,delete e.matchesTagsQuery}},{key:"HasTags",value:function(e){if(!e._tags)return!1;var t=e._tags;for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n))return!0;return!1}},{key:"GetTags",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!e._tags)return null;if(t){var n=[];for(var i in e._tags)Object.prototype.hasOwnProperty.call(e._tags,i)&&!0===e._tags[i]&&n.push(i);return n.join(" ")}return e._tags}},{key:"AddTagsTo",value:function(t,n){n&&("string"==typeof n&&n.split(" ").forEach((function(n){e._AddTagTo(t,n)})))}},{key:"_AddTagTo",value:function(t,n){""!==(n=n.trim())&&"true"!==n&&"false"!==n&&(n.match(/[\s]/)||n.match(/^([!]|([|]|[&]){2})/)||(e.EnableFor(t),t._tags[n]=!0))}},{key:"RemoveTagsFrom",value:function(t,n){if(e.HasTags(t)){var i=n.split(" ");for(var r in i)e._RemoveTagFrom(t,i[r])}}},{key:"_RemoveTagFrom",value:function(e,t){delete e._tags[t]}},{key:"MatchesQuery",value:function(t,n){return void 0===n||(""===n?e.HasTags(t):a.Eval(n,(function(n){return e.HasTags(t)&&t._tags[n]})))}}]),e}()},8370:function(e,t,n){"use strict";n.d(t,{Q:function(){return o}});var i=n(5671),r=n(3144),a=n(5092),o=function(){function e(){(0,i.Z)(this,e)}return(0,r.Z)(e,null,[{key:"SetImmediate",value:function(e){(0,a.CG)()&&window.setImmediate?window.setImmediate(e):setTimeout(e,1)}}]),e}()},8517:function(e,t,n){"use strict";n.d(t,{$g:function(){return T},w1:function(){return b}});var i=n(531),r=n(5671),a=n(3144),o=n(4687),s=n.n(o),u=n(4174),l=n(5092),c=n(2328),h=n(3192),f=n(2786),d=n(5230),p=n(8628),v=n(4198),m=n(562),g=n(8370),_=n(8797),y=n(9950);function E(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return A(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return A(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var b=function(){function e(){(0,r.Z)(this,e)}var t;return(0,a.Z)(e,null,[{key:"BaseUrl",get:function(){return m.rN.BaseUrl},set:function(e){m.rN.BaseUrl=e}},{key:"DefaultRetryStrategy",get:function(){return m.rN.DefaultRetryStrategy},set:function(e){m.rN.DefaultRetryStrategy=e}},{key:"CorsBehavior",get:function(){return m.rN.CorsBehavior},set:function(e){m.rN.CorsBehavior=e}},{key:"UseFallbackTexture",get:function(){return v.l.UseFallbackTexture},set:function(e){v.l.UseFallbackTexture=e}},{key:"RegisteredExternalClasses",get:function(){return _.K.RegisteredExternalClasses},set:function(e){_.K.RegisteredExternalClasses=e}},{key:"fallbackTexture",get:function(){return v.l.FallbackTexture},set:function(e){v.l.FallbackTexture=e}},{key:"FetchToRef",value:function(e,t,n,i,r,a){var o=4*((Math.abs(e)*n%n|0)+(Math.abs(t)*i%i|0)*n);a.r=r[o]/255,a.g=r[o+1]/255,a.b=r[o+2]/255,a.a=r[o+3]/255}},{key:"Mix",value:function(e,t,n){return e*(1-n)+t*n}},{key:"Instantiate",value:function(e){return _.K.Instantiate(e)}},{key:"SetImmediate",value:function(e){g.Q.SetImmediate(e)}},{key:"IsExponentOfTwo",value:function(e){var t=1;do{t*=2}while(t<e);return t===e}},{key:"FloatRound",value:function(t){return Math.fround?Math.fround(t):(e._TmpFloatArray[0]=t,e._TmpFloatArray[0])}},{key:"GetFilename",value:function(e){var t=e.lastIndexOf("/");return t<0?e:e.substring(t+1)}},{key:"GetFolderPath",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.lastIndexOf("/");return n<0?t?e:"":e.substring(0,n+1)}},{key:"ToDegrees",value:function(e){return 180*e/Math.PI}},{key:"ToRadians",value:function(e){return e*Math.PI/180}},{key:"MakeArray",value:function(e,t){return!0===t||void 0!==e&&null!=e?Array.isArray(e)?e:[e]:null}},{key:"GetPointerPrefix",value:function(e){var t="pointer";return(0,l.CG)()&&!window.PointerEvent&&(t="mouse"),!e._badDesktopOS||e._badOS||document&&"ontouchend"in document||(t="mouse"),t}},{key:"SetCorsBehavior",value:function(e,t){(0,m.$M)(e,t)}},{key:"SetReferrerPolicyBehavior",value:function(e,t){t.referrerPolicy=e}},{key:"CleanUrl",value:function(e){return e=e.replace(/#/gm,"%23")}},{key:"PreprocessUrl",get:function(){return m.rN.PreprocessUrl},set:function(e){m.rN.PreprocessUrl=e}},{key:"LoadImage",value:function(e,t,n,i,r,a){return(0,m.r6)(e,t,n,i,r,a)}},{key:"LoadFile",value:function(e,t,n,i,r,a){return(0,m.vP)(e,t,n,i,r,a)}},{key:"LoadFileAsync",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return new Promise((function(n,i){(0,m.vP)(e,(function(e){n(e)}),void 0,void 0,t,(function(e,t){i(t)}))}))}},{key:"LoadScript",value:function(e,t,n,i){if("function"!=typeof self.importScripts)if((0,l.CG)()){var r=document.getElementsByTagName("head")[0],a=document.createElement("script");a.setAttribute("type","text/javascript"),a.setAttribute("src",e),i&&(a.id=i),a.onload=function(){t&&t()},a.onerror=function(t){n&&n("Unable to load script '".concat(e,"'"),t)},r.appendChild(a)}else null==n||n("Cannot load script '".concat(e,"' outside of a window or a worker"));else try{self.importScripts(e),t()}catch(o){null==n||n("Unable to load script '".concat(e,"' in worker"),o)}}},{key:"LoadScriptAsync",value:function(e){var t=this;return new Promise((function(n,i){t.LoadScript(e,(function(){n()}),(function(e,t){i(t)}))}))}},{key:"ReadFileAsDataURL",value:function(e,t,n){var i=new FileReader,r={onCompleteObservable:new u.y$,abort:function(){return i.abort()}};return i.onloadend=function(){r.onCompleteObservable.notifyObservers(r)},i.onload=function(e){t(e.target.result)},i.onprogress=n,i.readAsDataURL(e),r}},{key:"ReadFile",value:function(e,t,n,i,r){return(0,m.Ip)(e,t,n,i,r)}},{key:"FileAsURL",value:function(e){var t=new Blob([e]);return(window.URL||window.webkitURL).createObjectURL(t)}},{key:"Format",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return e.toFixed(t)}},{key:"DeepCopy",value:function(e,t,n,i){h.j.DeepCopy(e,t,n,i)}},{key:"IsEmpty",value:function(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}},{key:"RegisterTopRootEvents",value:function(e,t){for(var n=0;n<t.length;n++){var i=t[n];e.addEventListener(i.name,i.handler,!1);try{window.parent&&window.parent.addEventListener(i.name,i.handler,!1)}catch(r){}}}},{key:"UnregisterTopRootEvents",value:function(e,t){for(var n=0;n<t.length;n++){var i=t[n];e.removeEventListener(i.name,i.handler);try{e.parent&&e.parent.removeEventListener(i.name,i.handler)}catch(r){}}}},{key:"DumpFramebuffer",value:(t=(0,i.Z)(s().mark((function t(n,i,r,a){var o,u,l,c,h=arguments;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=h.length>4&&void 0!==h[4]?h[4]:"image/png",u=h.length>5?h[5]:void 0,t.next=4,r.readPixels(0,0,n,i);case 4:l=t.sent,c=new Uint8Array(l.buffer),e.DumpData(n,i,c,a,o,u,!0);case 7:case"end":return t.stop()}}),t)}))),function(e,n,i,r){return t.apply(this,arguments)})},{key:"DumpData",value:function(t,n,i,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"image/png",o=arguments.length>5?arguments[5]:void 0,s=arguments.length>6&&void 0!==arguments[6]&&arguments[6],u=arguments.length>7&&void 0!==arguments[7]&&arguments[7],l=arguments.length>8?arguments[8]:void 0;e._ScreenshotCanvas||(e._ScreenshotCanvas=document.createElement("canvas")),e._ScreenshotCanvas.width=t,e._ScreenshotCanvas.height=n;var c=e._ScreenshotCanvas.getContext("2d");if(c){if(i instanceof Float32Array){for(var h=new Uint8Array(i.length),f=i.length;f--;){var d=i[f];h[f]=d<0?0:d>1?1:Math.round(255*d)}i=h}var p=c.createImageData(t,n),v=p.data;v.set(i),c.putImageData(p,0,0);var m=e._ScreenshotCanvas;if(s){var g=document.createElement("canvas");g.width=t,g.height=n;var _=g.getContext("2d");if(!_)return;_.translate(0,n),_.scale(1,-1),_.drawImage(e._ScreenshotCanvas,0,0),m=g}u?e.ToBlob(m,(function(e){var t=new FileReader;t.onload=function(e){var t=e.target.result;r&&r(t)},t.readAsArrayBuffer(e)}),a,l):e.EncodeScreenshotCanvasData(r,a,o,m,l)}}},{key:"DumpDataAsync",value:function(t,n,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"image/png",a=arguments.length>4?arguments[4]:void 0,o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],s=arguments.length>6&&void 0!==arguments[6]&&arguments[6],u=arguments.length>7?arguments[7]:void 0;return new Promise((function(l){e.DumpData(t,n,i,(function(e){return l(e)}),r,a,o,s,u)}))}},{key:"ToBlob",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"image/png",i=arguments.length>3?arguments[3]:void 0;e.toBlob||(e.toBlob=function(e,t,n){var i=this;setTimeout((function(){for(var r=atob(i.toDataURL(t,n).split(",")[1]),a=r.length,o=new Uint8Array(a),s=0;s<a;s++)o[s]=r.charCodeAt(s);e(new Blob([o]))}))}),e.toBlob((function(e){t(e)}),n,i)}},{key:"DownloadBlob",value:function(t,n){if("download"in document.createElement("a")){if(!n){var i=new Date;n="screenshot_"+((i.getFullYear()+"-"+(i.getMonth()+1)).slice(2)+"-"+i.getDate()+"_"+i.getHours()+"-"+("0"+i.getMinutes()).slice(-2))+".png"}e.Download(t,n)}else if(t&&"undefined"!=typeof URL){var r=URL.createObjectURL(t),a=window.open("");if(!a)return;var o=a.document.createElement("img");o.onload=function(){URL.revokeObjectURL(r)},o.src=r,a.document.body.appendChild(o)}}},{key:"EncodeScreenshotCanvasData",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"image/png",i=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;if(t){var o=(null!=r?r:e._ScreenshotCanvas).toDataURL(n,a);t(o)}else this.ToBlob(null!=r?r:e._ScreenshotCanvas,(function(t){t&&e.DownloadBlob(t,i)}),n,a)}},{key:"Download",value:function(e,t){if(navigator&&navigator.msSaveBlob)navigator.msSaveBlob(e,t);else if("undefined"!=typeof URL){var n=window.URL.createObjectURL(e),i=document.createElement("a");document.body.appendChild(i),i.style.display="none",i.href=n,i.download=t,i.addEventListener("click",(function(){i.parentElement&&i.parentElement.removeChild(i)})),i.click(),window.URL.revokeObjectURL(n)}}},{key:"BackCompatCameraNoPreventDefault",value:function(e){return"boolean"==typeof e[0]?e[0]:"boolean"==typeof e[1]&&e[1]}},{key:"CreateScreenshot",value:function(e,t,n,i){throw(0,d.S)("ScreenshotTools")}},{key:"CreateScreenshotAsync",value:function(e,t,n){throw(0,d.S)("ScreenshotTools")}},{key:"CreateScreenshotUsingRenderTarget",value:function(e,t,n,i){throw(0,d.S)("ScreenshotTools")}},{key:"CreateScreenshotUsingRenderTargetAsync",value:function(e,t,n){throw(0,d.S)("ScreenshotTools")}},{key:"RandomId",value:function(){return(0,y.f)()}},{key:"IsBase64",value:function(e){return(0,m.VL)(e)}},{key:"DecodeBase64",value:function(e){return(0,m.$K)(e)}},{key:"errorsCount",get:function(){return c.Y.errorsCount}},{key:"Log",value:function(e){c.Y.Log(e)}},{key:"Warn",value:function(e){c.Y.Warn(e)}},{key:"Error",value:function(e){c.Y.Error(e)}},{key:"LogCache",get:function(){return c.Y.LogCache}},{key:"ClearLogCache",value:function(){c.Y.ClearLogCache()}},{key:"LogLevels",set:function(e){c.Y.LogLevels=e}},{key:"PerformanceLogLevel",set:function(t){return(t&e.PerformanceUserMarkLogLevel)===e.PerformanceUserMarkLogLevel?(e.StartPerformanceCounter=e._StartUserMark,void(e.EndPerformanceCounter=e._EndUserMark)):(t&e.PerformanceConsoleLogLevel)===e.PerformanceConsoleLogLevel?(e.StartPerformanceCounter=e._StartPerformanceConsole,void(e.EndPerformanceCounter=e._EndPerformanceConsole)):(e.StartPerformanceCounter=e._StartPerformanceCounterDisabled,void(e.EndPerformanceCounter=e._EndPerformanceCounterDisabled))}},{key:"_StartPerformanceCounterDisabled",value:function(e,t){}},{key:"_EndPerformanceCounterDisabled",value:function(e,t){}},{key:"_StartUserMark",value:function(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!e._Performance){if(!(0,l.CG)())return;e._Performance=window.performance}n&&e._Performance.mark&&e._Performance.mark(t+"-Begin")}},{key:"_EndUserMark",value:function(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];n&&e._Performance.mark&&(e._Performance.mark(t+"-End"),e._Performance.measure(t,t+"-Begin",t+"-End"))}},{key:"_StartPerformanceConsole",value:function(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];n&&(e._StartUserMark(t,n),console.time&&console.time(t))}},{key:"_EndPerformanceConsole",value:function(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];n&&(e._EndUserMark(t,n),console.timeEnd(t))}},{key:"Now",get:function(){return f.F.Now}},{key:"GetClassName",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=null;if(!t&&e.getClassName)n=e.getClassName();else{if(e instanceof Object){var i=t?e:Object.getPrototypeOf(e);n=i.constructor.__bjsclassName__}n||(n=typeof e)}return n}},{key:"First",value:function(e,t){var n,i=E(e);try{for(i.s();!(n=i.n()).done;){var r=n.value;if(t(r))return r}}catch(a){i.e(a)}finally{i.f()}return null}},{key:"getFullClassName",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=null,i=null;if(!t&&e.getClassName)n=e.getClassName();else{if(e instanceof Object){var r=t?e:Object.getPrototypeOf(e);n=r.constructor.__bjsclassName__,i=r.constructor.__bjsmoduleName__}n||(n=typeof e)}return n?(null!=i?i+".":"")+n:null}},{key:"DelayAsync",value:function(e){return new Promise((function(t){setTimeout((function(){t()}),e)}))}},{key:"IsSafari",value:function(){return!!(0,l.up)()&&/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}}]),e}();b.UseCustomRequestHeaders=!1,b.CustomRequestHeaders=p.g.CustomRequestHeaders,b._TmpFloatArray=new Float32Array(1),b.GetDOMTextContent=l.v,b.GetAbsoluteUrl="object"==typeof document?function(e){var t=document.createElement("a");return t.href=e,t.href}:"function"==typeof URL&&"object"==typeof location?function(e){return new URL(e,location.origin).href}:function(){throw new Error("Unable to get absolute URL. Override BABYLON.Tools.GetAbsoluteUrl to a custom implementation for the current context.")},b.NoneLogLevel=c.Y.NoneLogLevel,b.MessageLogLevel=c.Y.MessageLogLevel,b.WarningLogLevel=c.Y.WarningLogLevel,b.ErrorLogLevel=c.Y.ErrorLogLevel,b.AllLogLevel=c.Y.AllLogLevel,b.IsWindowObjectExist=l.CG,b.PerformanceNoneLogLevel=0,b.PerformanceUserMarkLogLevel=1,b.PerformanceConsoleLogLevel=2,b.StartPerformanceCounter=b._StartPerformanceCounterDisabled,b.EndPerformanceCounter=b._EndPerformanceCounterDisabled;var T=function(){function e(t,n,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;(0,r.Z)(this,e),this.iterations=t,this.index=a-1,this._done=!1,this._fn=n,this._successCallback=i}return(0,a.Z)(e,[{key:"executeNext",value:function(){this._done||(this.index+1<this.iterations?(++this.index,this._fn(this)):this.breakLoop())}},{key:"breakLoop",value:function(){this._done=!0,this._successCallback()}}],[{key:"Run",value:function(t,n,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=new e(t,n,i,r);return a.executeNext(),a}},{key:"SyncAsyncForLoop",value:function(t,n,i,r,a){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;return e.Run(Math.ceil(t/n),(function(e){a&&a()?e.breakLoop():setTimeout((function(){for(var r=0;r<n;++r){var o=e.index*n+r;if(o>=t)break;if(i(o),a&&a()){e.breakLoop();break}}e.executeNext()}),o)}),r)}}]),e}();v.l.FallbackTexture="data:image/jpg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/4QBmRXhpZgAATU0AKgAAAAgABAEaAAUAAAABAAAAPgEbAAUAAAABAAAARgEoAAMAAAABAAIAAAExAAIAAAAQAAAATgAAAAAAAABgAAAAAQAAAGAAAAABcGFpbnQubmV0IDQuMC41AP/bAEMABAIDAwMCBAMDAwQEBAQFCQYFBQUFCwgIBgkNCw0NDQsMDA4QFBEODxMPDAwSGBITFRYXFxcOERkbGRYaFBYXFv/bAEMBBAQEBQUFCgYGChYPDA8WFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFv/AABEIAQABAAMBIgACEQEDEQH/xAAfAAABBQEBAQEBAQAAAAAAAAAAAQIDBAUGBwgJCgv/xAC1EAACAQMDAgQDBQUEBAAAAX0BAgMABBEFEiExQQYTUWEHInEUMoGRoQgjQrHBFVLR8CQzYnKCCQoWFxgZGiUmJygpKjQ1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4eLj5OXm5+jp6vHy8/T19vf4+fr/xAAfAQADAQEBAQEBAQEBAAAAAAAAAQIDBAUGBwgJCgv/xAC1EQACAQIEBAMEBwUEBAABAncAAQIDEQQFITEGEkFRB2FxEyIygQgUQpGhscEJIzNS8BVictEKFiQ04SXxFxgZGiYnKCkqNTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqCg4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2dri4+Tl5ufo6ery8/T19vf4+fr/2gAMAwEAAhEDEQA/APH6KKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FCiiigD6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++gooooA+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gUKKKKAPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76CiiigD5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BQooooA+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/voKKKKAPl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FCiiigD6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++gooooA+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gUKKKKAPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76CiiigD5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BQooooA+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/voKKKKAPl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FCiiigD6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++gooooA+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gUKKKKAPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76P//Z"},1704:function(e,t,n){"use strict";n.d(t,{H:function(){return r},q:function(){return a}});var i={};function r(e,t){i[e]=t}function a(e){return i[e]}},874:function(e,t,n){"use strict";n.d(t,{K:function(){return a}});var i=n(5671),r=n(3144),a=function(){function e(){(0,i.Z)(this,e)}return(0,r.Z)(e,null,[{key:"UniqueId",get:function(){var e=this._UniqueIdCounter;return this._UniqueIdCounter++,e}}]),e}();a._UniqueIdCounter=1},8628:function(e,t,n){"use strict";n.d(t,{g:function(){return s}});var i=n(5671),r=n(3144);function a(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){u=!0,a=e},f:function(){try{s||null==n.return||n.return()}finally{if(u)throw a}}}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var s=function(){function e(){(0,i.Z)(this,e),this._xhr="undefined"!=typeof _native&&_native.XMLHttpRequest?new _native.XMLHttpRequest:new XMLHttpRequest,this._requestURL=""}return(0,r.Z)(e,[{key:"_injectCustomRequestHeaders",value:function(){if(!this._shouldSkipRequestModifications(this._requestURL))for(var t in e.CustomRequestHeaders){var n=e.CustomRequestHeaders[t];n&&this._xhr.setRequestHeader(t,n)}}},{key:"_shouldSkipRequestModifications",value:function(t){return e.SkipRequestModificationForBabylonCDN&&(t.includes("preview.babylonjs.com")||t.includes("cdn.babylonjs.com"))}},{key:"onprogress",get:function(){return this._xhr.onprogress},set:function(e){this._xhr.onprogress=e}},{key:"readyState",get:function(){return this._xhr.readyState}},{key:"status",get:function(){return this._xhr.status}},{key:"statusText",get:function(){return this._xhr.statusText}},{key:"response",get:function(){return this._xhr.response}},{key:"responseURL",get:function(){return this._xhr.responseURL}},{key:"responseText",get:function(){return this._xhr.responseText}},{key:"responseType",get:function(){return this._xhr.responseType},set:function(e){this._xhr.responseType=e}},{key:"timeout",get:function(){return this._xhr.timeout},set:function(e){this._xhr.timeout=e}},{key:"addEventListener",value:function(e,t,n){this._xhr.addEventListener(e,t,n)}},{key:"removeEventListener",value:function(e,t,n){this._xhr.removeEventListener(e,t,n)}},{key:"abort",value:function(){this._xhr.abort()}},{key:"send",value:function(t){e.CustomRequestHeaders&&this._injectCustomRequestHeaders(),this._xhr.send(t)}},{key:"open",value:function(t,n){var i,r=a(e.CustomRequestModifiers);try{for(r.s();!(i=r.n()).done;){var o=i.value;if(this._shouldSkipRequestModifications(n))return;o(this._xhr,n)}}catch(s){r.e(s)}finally{r.f()}return n=(n=n.replace("file:http:","http:")).replace("file:https:","https:"),this._requestURL=n,this._xhr.open(t,n,!0)}},{key:"setRequestHeader",value:function(e,t){this._xhr.setRequestHeader(e,t)}},{key:"getResponseHeader",value:function(e){return this._xhr.getResponseHeader(e)}}]),e}();s.CustomRequestHeaders={},s.CustomRequestModifiers=new Array,s.SkipRequestModificationForBabylonCDN=!0},7570:function(e,t,n){"use strict";n.d(t,{O:function(){return o}});var i=n(5671),r=n(3144),a=n(2845),o=function(){function e(t){(0,i.Z)(this,e),this._vertexBuffers={},this._scene=t}return(0,r.Z)(e,[{key:"_prepareBuffers",value:function(){if(!this._vertexBuffers[a.o.PositionKind]){var e=[];e.push(1,1),e.push(-1,1),e.push(-1,-1),e.push(1,-1),this._vertexBuffers[a.o.PositionKind]=new a.o(this._scene.getEngine(),e,a.o.PositionKind,!1,!1,2),this._buildIndexBuffer()}}},{key:"_buildIndexBuffer",value:function(){var e=[];e.push(0),e.push(1),e.push(2),e.push(0),e.push(2),e.push(3),this._indexBuffer=this._scene.getEngine().createIndexBuffer(e)}},{key:"_rebuild",value:function(){var e=this._vertexBuffers[a.o.PositionKind];e&&(e._rebuild(),this._buildIndexBuffer())}},{key:"_prepareFrame",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this._scene.activeCamera;return!!n&&(!(!(t=t||n._postProcesses.filter((function(e){return null!=e})))||0===t.length||!this._scene.postProcessesEnabled)&&(t[0].activate(n,e,null!=t),!0))}},{key:"directRender",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=this._scene.getEngine(),s=0;s<e.length;s++){var u;if(s<e.length-1)e[s+1].activate(this._scene.activeCamera,null==t?void 0:t.texture);else t?o.bindFramebuffer(t,i,void 0,void 0,n,r):a||o.restoreDefaultFramebuffer(),null===(u=o._debugInsertMarker)||void 0===u||u.call(o,"post process ".concat(e[s].name," output"));var l=e[s],c=l.apply();c&&(l.onBeforeRenderObservable.notifyObservers(c),this._prepareBuffers(),o.bindBuffers(this._vertexBuffers,this._indexBuffer,c),o.drawElementsType(0,0,6),l.onAfterRenderObservable.notifyObservers(c))}o.setDepthBuffer(!0),o.setDepthWrite(!0)}},{key:"_finalizeFrame",value:function(e,t,n,i){var r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=this._scene.activeCamera;if(a&&(i=i||a._postProcesses.filter((function(e){return null!=e})),0!==i.length&&this._scene.postProcessesEnabled)){for(var o=this._scene.getEngine(),s=0,u=i.length;s<u;s++){var l,c=i[s];if(s<u-1)c._outputTexture=i[s+1].activate(a,null==t?void 0:t.texture);else t?(o.bindFramebuffer(t,n,void 0,void 0,r),c._outputTexture=t):(o.restoreDefaultFramebuffer(),c._outputTexture=null),null===(l=o._debugInsertMarker)||void 0===l||l.call(o,"post process ".concat(i[s].name," output"));if(e)break;var h=c.apply();h&&(c.onBeforeRenderObservable.notifyObservers(h),this._prepareBuffers(),o.bindBuffers(this._vertexBuffers,this._indexBuffer,h),o.drawElementsType(0,0,6),c.onAfterRenderObservable.notifyObservers(h))}o.setDepthBuffer(!0),o.setDepthWrite(!0),o.setAlphaMode(0)}}},{key:"dispose",value:function(){var e=this._vertexBuffers[a.o.PositionKind];e&&(e.dispose(),this._vertexBuffers[a.o.PositionKind]=null),this._indexBuffer&&(this._scene.getEngine()._releaseBuffer(this._indexBuffer),this._indexBuffer=null)}}]),e}()},3639:function(e,t,n){"use strict";n.d(t,{$:function(){return h}});var i=n(3144),r=n(5671),a=n(5934),o=n(6900),s=function(){function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;(0,r.Z)(this,e),this.index=t,this._opaqueSubMeshes=new a.t(256),this._transparentSubMeshes=new a.t(256),this._alphaTestSubMeshes=new a.t(256),this._depthOnlySubMeshes=new a.t(256),this._particleSystems=new a.t(256),this._spriteManagers=new a.t(256),this._empty=!0,this._edgesRenderers=new a.f(16),this._scene=n,this.opaqueSortCompareFn=i,this.alphaTestSortCompareFn=o,this.transparentSortCompareFn=s}return(0,i.Z)(e,[{key:"opaqueSortCompareFn",set:function(t){this._opaqueSortCompareFn=t||e.PainterSortCompare,this._renderOpaque=this._renderOpaqueSorted}},{key:"alphaTestSortCompareFn",set:function(t){this._alphaTestSortCompareFn=t||e.PainterSortCompare,this._renderAlphaTest=this._renderAlphaTestSorted}},{key:"transparentSortCompareFn",set:function(t){this._transparentSortCompareFn=t||e.defaultTransparentSortCompare,this._renderTransparent=this._renderTransparentSorted}},{key:"render",value:function(e,t,n,i){if(e)e(this._opaqueSubMeshes,this._alphaTestSubMeshes,this._transparentSubMeshes,this._depthOnlySubMeshes);else{var r=this._scene.getEngine();0!==this._depthOnlySubMeshes.length&&(r.setColorWrite(!1),this._renderAlphaTest(this._depthOnlySubMeshes),r.setColorWrite(!0)),0!==this._opaqueSubMeshes.length&&this._renderOpaque(this._opaqueSubMeshes),0!==this._alphaTestSubMeshes.length&&this._renderAlphaTest(this._alphaTestSubMeshes);var a=r.getStencilBuffer();if(r.setStencilBuffer(!1),t&&this._renderSprites(),n&&this._renderParticles(i),this.onBeforeTransparentRendering&&this.onBeforeTransparentRendering(),0!==this._transparentSubMeshes.length||this._scene.useOrderIndependentTransparency){if(r.setStencilBuffer(a),this._scene.useOrderIndependentTransparency){var o=this._scene.depthPeelingRenderer.render(this._transparentSubMeshes);o.length&&this._renderTransparent(o)}else this._renderTransparent(this._transparentSubMeshes);r.setAlphaMode(0)}if(r.setStencilBuffer(!1),this._edgesRenderers.length){for(var s=0;s<this._edgesRenderers.length;s++)this._edgesRenderers.data[s].render();r.setAlphaMode(0)}r.setStencilBuffer(a)}}},{key:"_renderOpaqueSorted",value:function(t){return e._RenderSorted(t,this._opaqueSortCompareFn,this._scene.activeCamera,!1)}},{key:"_renderAlphaTestSorted",value:function(t){return e._RenderSorted(t,this._alphaTestSortCompareFn,this._scene.activeCamera,!1)}},{key:"_renderTransparentSorted",value:function(t){return e._RenderSorted(t,this._transparentSortCompareFn,this._scene.activeCamera,!0)}},{key:"prepare",value:function(){this._opaqueSubMeshes.reset(),this._transparentSubMeshes.reset(),this._alphaTestSubMeshes.reset(),this._depthOnlySubMeshes.reset(),this._particleSystems.reset(),this._spriteManagers.reset(),this._edgesRenderers.reset(),this._empty=!0}},{key:"dispose",value:function(){this._opaqueSubMeshes.dispose(),this._transparentSubMeshes.dispose(),this._alphaTestSubMeshes.dispose(),this._depthOnlySubMeshes.dispose(),this._particleSystems.dispose(),this._spriteManagers.dispose(),this._edgesRenderers.dispose()}},{key:"dispatch",value:function(e,t,n){void 0===t&&(t=e.getMesh()),void 0===n&&(n=e.getMaterial()),null!=n&&(n.needAlphaBlendingForMesh(t)?this._transparentSubMeshes.push(e):n.needAlphaTesting()?(n.needDepthPrePass&&this._depthOnlySubMeshes.push(e),this._alphaTestSubMeshes.push(e)):(n.needDepthPrePass&&this._depthOnlySubMeshes.push(e),this._opaqueSubMeshes.push(e)),t._renderingGroup=this,t._edgesRenderer&&t._edgesRenderer.isEnabled&&this._edgesRenderers.pushNoDuplicate(t._edgesRenderer),this._empty=!1)}},{key:"dispatchSprites",value:function(e){this._spriteManagers.push(e),this._empty=!1}},{key:"dispatchParticles",value:function(e){this._particleSystems.push(e),this._empty=!1}},{key:"_renderParticles",value:function(e){if(0!==this._particleSystems.length){var t=this._scene.activeCamera;this._scene.onBeforeParticlesRenderingObservable.notifyObservers(this._scene);for(var n=0;n<this._particleSystems.length;n++){var i=this._particleSystems.data[n];if(0!==(t&&t.layerMask&i.layerMask)){var r=i.emitter;r.position&&e&&-1===e.indexOf(r)||this._scene._activeParticles.addCount(i.render(),!1)}}this._scene.onAfterParticlesRenderingObservable.notifyObservers(this._scene)}}},{key:"_renderSprites",value:function(){if(this._scene.spritesEnabled&&0!==this._spriteManagers.length){var e=this._scene.activeCamera;this._scene.onBeforeSpritesRenderingObservable.notifyObservers(this._scene);for(var t=0;t<this._spriteManagers.length;t++){var n=this._spriteManagers.data[t];0!==(e&&e.layerMask&n.layerMask)&&n.render()}this._scene.onAfterSpritesRenderingObservable.notifyObservers(this._scene)}}}],[{key:"_RenderSorted",value:function(t,n,i,r){var a,s=0,u=i?i.globalPosition:e._ZeroVector;if(r)for(;s<t.length;s++)(a=t.data[s])._alphaIndex=a.getMesh().alphaIndex,a._distanceToCamera=o.P.Distance(a.getBoundingInfo().boundingSphere.centerWorld,u);var l=t.length===t.data.length?t.data:t.data.slice(0,t.length);n&&l.sort(n);var c=l[0].getMesh().getScene();for(s=0;s<l.length;s++)if(a=l[s],!c._activeMeshesFrozenButKeepClipping||a.isInFrustum(c._frustumPlanes)){if(r){var h=a.getMaterial();if(h&&h.needDepthPrePass){var f=h.getScene().getEngine();f.setColorWrite(!1),f.setAlphaMode(0),a.render(!1),f.setColorWrite(!0)}}a.render(r)}}},{key:"defaultTransparentSortCompare",value:function(t,n){return t._alphaIndex>n._alphaIndex?1:t._alphaIndex<n._alphaIndex?-1:e.backToFrontSortCompare(t,n)}},{key:"backToFrontSortCompare",value:function(e,t){return e._distanceToCamera<t._distanceToCamera?1:e._distanceToCamera>t._distanceToCamera?-1:0}},{key:"frontToBackSortCompare",value:function(e,t){return e._distanceToCamera<t._distanceToCamera?-1:e._distanceToCamera>t._distanceToCamera?1:0}},{key:"PainterSortCompare",value:function(e,t){var n=e.getMesh(),i=t.getMesh();return n.material&&i.material?n.material.uniqueId-i.material.uniqueId:n.uniqueId-i.uniqueId}}]),e}();function u(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}s._ZeroVector=o.P.Zero();var c=(0,i.Z)((function e(){(0,r.Z)(this,e)})),h=function(){function e(t){(0,r.Z)(this,e),this._useSceneAutoClearSetup=!1,this._renderingGroups=new Array,this._autoClearDepthStencil={},this._customOpaqueSortCompareFn={},this._customAlphaTestSortCompareFn={},this._customTransparentSortCompareFn={},this._renderingGroupInfo=new c,this._scene=t;for(var n=e.MIN_RENDERINGGROUPS;n<e.MAX_RENDERINGGROUPS;n++)this._autoClearDepthStencil[n]={autoClear:!0,depth:!0,stencil:!0}}return(0,i.Z)(e,[{key:"_clearDepthStencilBuffer",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this._depthStencilBufferAlreadyCleaned||(this._scene.getEngine().clear(null,!1,e,t),this._depthStencilBufferAlreadyCleaned=!0)}},{key:"render",value:function(t,n,i,r){var a=this._renderingGroupInfo;if(a.scene=this._scene,a.camera=this._scene.activeCamera,this._scene.spriteManagers&&r)for(var o=0;o<this._scene.spriteManagers.length;o++){var s=this._scene.spriteManagers[o];this.dispatchSprites(s)}for(var l=e.MIN_RENDERINGGROUPS;l<e.MAX_RENDERINGGROUPS;l++){this._depthStencilBufferAlreadyCleaned=l===e.MIN_RENDERINGGROUPS;var c=this._renderingGroups[l];if(c&&!c._empty){var h=Math.pow(2,l);if(a.renderingGroupId=l,this._scene.onBeforeRenderingGroupObservable.notifyObservers(a,h),e.AUTOCLEAR){var f=this._useSceneAutoClearSetup?this._scene.getAutoClearDepthStencilSetup(l):this._autoClearDepthStencil[l];f&&f.autoClear&&this._clearDepthStencilBuffer(f.depth,f.stencil)}var d,p=u(this._scene._beforeRenderingGroupDrawStage);try{for(p.s();!(d=p.n()).done;){d.value.action(l)}}catch(g){p.e(g)}finally{p.f()}c.render(t,r,i,n);var v,m=u(this._scene._afterRenderingGroupDrawStage);try{for(m.s();!(v=m.n()).done;){v.value.action(l)}}catch(g){m.e(g)}finally{m.f()}this._scene.onAfterRenderingGroupObservable.notifyObservers(a,h)}}}},{key:"reset",value:function(){for(var t=e.MIN_RENDERINGGROUPS;t<e.MAX_RENDERINGGROUPS;t++){var n=this._renderingGroups[t];n&&n.prepare()}}},{key:"dispose",value:function(){this.freeRenderingGroups(),this._renderingGroups.length=0,this._renderingGroupInfo=null}},{key:"freeRenderingGroups",value:function(){for(var t=e.MIN_RENDERINGGROUPS;t<e.MAX_RENDERINGGROUPS;t++){var n=this._renderingGroups[t];n&&n.dispose()}}},{key:"_prepareRenderingGroup",value:function(e){void 0===this._renderingGroups[e]&&(this._renderingGroups[e]=new s(e,this._scene,this._customOpaqueSortCompareFn[e],this._customAlphaTestSortCompareFn[e],this._customTransparentSortCompareFn[e]))}},{key:"dispatchSprites",value:function(e){var t=e.renderingGroupId||0;this._prepareRenderingGroup(t),this._renderingGroups[t].dispatchSprites(e)}},{key:"dispatchParticles",value:function(e){var t=e.renderingGroupId||0;this._prepareRenderingGroup(t),this._renderingGroups[t].dispatchParticles(e)}},{key:"dispatch",value:function(e,t,n){void 0===t&&(t=e.getMesh());var i=t.renderingGroupId||0;this._prepareRenderingGroup(i),this._renderingGroups[i].dispatch(e,t,n)}},{key:"setRenderingOrder",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(this._customOpaqueSortCompareFn[e]=t,this._customAlphaTestSortCompareFn[e]=n,this._customTransparentSortCompareFn[e]=i,this._renderingGroups[e]){var r=this._renderingGroups[e];r.opaqueSortCompareFn=this._customOpaqueSortCompareFn[e],r.alphaTestSortCompareFn=this._customAlphaTestSortCompareFn[e],r.transparentSortCompareFn=this._customTransparentSortCompareFn[e]}}},{key:"setRenderingAutoClearDepthStencil",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];this._autoClearDepthStencil[e]={autoClear:t,depth:n,stencil:i}}},{key:"getAutoClearDepthStencilSetup",value:function(e){return this._autoClearDepthStencil[e]}}]),e}();h.MAX_RENDERINGGROUPS=4,h.MIN_RENDERINGGROUPS=0,h.AUTOCLEAR=!0},768:function(e,t,n){"use strict";n.d(t,{Q:function(){return a}});var i=n(5671),r=n(3144),a=function(){function e(){(0,i.Z)(this,e),this._blendFunctionParameters=new Array(4),this._blendEquationParameters=new Array(2),this._blendConstants=new Array(4),this._isBlendConstantsDirty=!1,this._alphaBlend=!1,this._isAlphaBlendDirty=!1,this._isBlendFunctionParametersDirty=!1,this._isBlendEquationParametersDirty=!1,this.reset()}return(0,r.Z)(e,[{key:"isDirty",get:function(){return this._isAlphaBlendDirty||this._isBlendFunctionParametersDirty||this._isBlendEquationParametersDirty}},{key:"alphaBlend",get:function(){return this._alphaBlend},set:function(e){this._alphaBlend!==e&&(this._alphaBlend=e,this._isAlphaBlendDirty=!0)}},{key:"setAlphaBlendConstants",value:function(e,t,n,i){this._blendConstants[0]===e&&this._blendConstants[1]===t&&this._blendConstants[2]===n&&this._blendConstants[3]===i||(this._blendConstants[0]=e,this._blendConstants[1]=t,this._blendConstants[2]=n,this._blendConstants[3]=i,this._isBlendConstantsDirty=!0)}},{key:"setAlphaBlendFunctionParameters",value:function(e,t,n,i){this._blendFunctionParameters[0]===e&&this._blendFunctionParameters[1]===t&&this._blendFunctionParameters[2]===n&&this._blendFunctionParameters[3]===i||(this._blendFunctionParameters[0]=e,this._blendFunctionParameters[1]=t,this._blendFunctionParameters[2]=n,this._blendFunctionParameters[3]=i,this._isBlendFunctionParametersDirty=!0)}},{key:"setAlphaEquationParameters",value:function(e,t){this._blendEquationParameters[0]===e&&this._blendEquationParameters[1]===t||(this._blendEquationParameters[0]=e,this._blendEquationParameters[1]=t,this._isBlendEquationParametersDirty=!0)}},{key:"reset",value:function(){this._alphaBlend=!1,this._blendFunctionParameters[0]=null,this._blendFunctionParameters[1]=null,this._blendFunctionParameters[2]=null,this._blendFunctionParameters[3]=null,this._blendEquationParameters[0]=null,this._blendEquationParameters[1]=null,this._blendConstants[0]=null,this._blendConstants[1]=null,this._blendConstants[2]=null,this._blendConstants[3]=null,this._isAlphaBlendDirty=!0,this._isBlendFunctionParametersDirty=!1,this._isBlendEquationParametersDirty=!1,this._isBlendConstantsDirty=!1}},{key:"apply",value:function(e){this.isDirty&&(this._isAlphaBlendDirty&&(this._alphaBlend?e.enable(e.BLEND):e.disable(e.BLEND),this._isAlphaBlendDirty=!1),this._isBlendFunctionParametersDirty&&(e.blendFuncSeparate(this._blendFunctionParameters[0],this._blendFunctionParameters[1],this._blendFunctionParameters[2],this._blendFunctionParameters[3]),this._isBlendFunctionParametersDirty=!1),this._isBlendEquationParametersDirty&&(e.blendEquationSeparate(this._blendEquationParameters[0],this._blendEquationParameters[1]),this._isBlendEquationParametersDirty=!1),this._isBlendConstantsDirty&&(e.blendColor(this._blendConstants[0],this._blendConstants[1],this._blendConstants[2],this._blendConstants[3]),this._isBlendConstantsDirty=!1))}}]),e}()},1379:function(e,t,n){"use strict";n.d(t,{k:function(){return a}});var i=n(5671),r=n(3144),a=function(){function e(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];(0,i.Z)(this,e),this._isDepthTestDirty=!1,this._isDepthMaskDirty=!1,this._isDepthFuncDirty=!1,this._isCullFaceDirty=!1,this._isCullDirty=!1,this._isZOffsetDirty=!1,this._isFrontFaceDirty=!1,t&&this.reset()}return(0,r.Z)(e,[{key:"isDirty",get:function(){return this._isDepthFuncDirty||this._isDepthTestDirty||this._isDepthMaskDirty||this._isCullFaceDirty||this._isCullDirty||this._isZOffsetDirty||this._isFrontFaceDirty}},{key:"zOffset",get:function(){return this._zOffset},set:function(e){this._zOffset!==e&&(this._zOffset=e,this._isZOffsetDirty=!0)}},{key:"zOffsetUnits",get:function(){return this._zOffsetUnits},set:function(e){this._zOffsetUnits!==e&&(this._zOffsetUnits=e,this._isZOffsetDirty=!0)}},{key:"cullFace",get:function(){return this._cullFace},set:function(e){this._cullFace!==e&&(this._cullFace=e,this._isCullFaceDirty=!0)}},{key:"cull",get:function(){return this._cull},set:function(e){this._cull!==e&&(this._cull=e,this._isCullDirty=!0)}},{key:"depthFunc",get:function(){return this._depthFunc},set:function(e){this._depthFunc!==e&&(this._depthFunc=e,this._isDepthFuncDirty=!0)}},{key:"depthMask",get:function(){return this._depthMask},set:function(e){this._depthMask!==e&&(this._depthMask=e,this._isDepthMaskDirty=!0)}},{key:"depthTest",get:function(){return this._depthTest},set:function(e){this._depthTest!==e&&(this._depthTest=e,this._isDepthTestDirty=!0)}},{key:"frontFace",get:function(){return this._frontFace},set:function(e){this._frontFace!==e&&(this._frontFace=e,this._isFrontFaceDirty=!0)}},{key:"reset",value:function(){this._depthMask=!0,this._depthTest=!0,this._depthFunc=null,this._cullFace=null,this._cull=null,this._zOffset=0,this._zOffsetUnits=0,this._frontFace=null,this._isDepthTestDirty=!0,this._isDepthMaskDirty=!0,this._isDepthFuncDirty=!1,this._isCullFaceDirty=!1,this._isCullDirty=!1,this._isZOffsetDirty=!0,this._isFrontFaceDirty=!1}},{key:"apply",value:function(e){this.isDirty&&(this._isCullDirty&&(this.cull?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE),this._isCullDirty=!1),this._isCullFaceDirty&&(e.cullFace(this.cullFace),this._isCullFaceDirty=!1),this._isDepthMaskDirty&&(e.depthMask(this.depthMask),this._isDepthMaskDirty=!1),this._isDepthTestDirty&&(this.depthTest?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST),this._isDepthTestDirty=!1),this._isDepthFuncDirty&&(e.depthFunc(this.depthFunc),this._isDepthFuncDirty=!1),this._isZOffsetDirty&&(this.zOffset||this.zOffsetUnits?(e.enable(e.POLYGON_OFFSET_FILL),e.polygonOffset(this.zOffset,this.zOffsetUnits)):e.disable(e.POLYGON_OFFSET_FILL),this._isZOffsetDirty=!1),this._isFrontFaceDirty&&(e.frontFace(this.frontFace),this._isFrontFaceDirty=!1))}}]),e}()},5852:function(e,t,n){"use strict";n.d(t,{s:function(){return a}});var i=n(5671),r=n(3144),a=function(){function e(){(0,i.Z)(this,e),this.reset()}return(0,r.Z)(e,[{key:"reset",value:function(){this.enabled=!1,this.mask=255,this.func=e.ALWAYS,this.funcRef=1,this.funcMask=255,this.opStencilFail=e.KEEP,this.opDepthFail=e.KEEP,this.opStencilDepthPass=e.REPLACE}},{key:"stencilFunc",get:function(){return this.func},set:function(e){this.func=e}},{key:"stencilFuncRef",get:function(){return this.funcRef},set:function(e){this.funcRef=e}},{key:"stencilFuncMask",get:function(){return this.funcMask},set:function(e){this.funcMask=e}},{key:"stencilOpStencilFail",get:function(){return this.opStencilFail},set:function(e){this.opStencilFail=e}},{key:"stencilOpDepthFail",get:function(){return this.opDepthFail},set:function(e){this.opDepthFail=e}},{key:"stencilOpStencilDepthPass",get:function(){return this.opStencilDepthPass},set:function(e){this.opStencilDepthPass=e}},{key:"stencilMask",get:function(){return this.mask},set:function(e){this.mask=e}},{key:"stencilTest",get:function(){return this.enabled},set:function(e){this.enabled=e}}]),e}();a.ALWAYS=519,a.KEEP=7680,a.REPLACE=7681},8789:function(e,t,n){"use strict";n.d(t,{C:function(){return a}});var i=n(5671),r=n(3144),a=function(){function e(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];(0,i.Z)(this,e),this._isStencilTestDirty=!1,this._isStencilMaskDirty=!1,this._isStencilFuncDirty=!1,this._isStencilOpDirty=!1,this.useStencilGlobalOnly=!1,t&&this.reset()}return(0,r.Z)(e,[{key:"isDirty",get:function(){return this._isStencilTestDirty||this._isStencilMaskDirty||this._isStencilFuncDirty||this._isStencilOpDirty}},{key:"func",get:function(){return this._func},set:function(e){this._func!==e&&(this._func=e,this._isStencilFuncDirty=!0)}},{key:"funcRef",get:function(){return this._funcRef},set:function(e){this._funcRef!==e&&(this._funcRef=e,this._isStencilFuncDirty=!0)}},{key:"funcMask",get:function(){return this._funcMask},set:function(e){this._funcMask!==e&&(this._funcMask=e,this._isStencilFuncDirty=!0)}},{key:"opStencilFail",get:function(){return this._opStencilFail},set:function(e){this._opStencilFail!==e&&(this._opStencilFail=e,this._isStencilOpDirty=!0)}},{key:"opDepthFail",get:function(){return this._opDepthFail},set:function(e){this._opDepthFail!==e&&(this._opDepthFail=e,this._isStencilOpDirty=!0)}},{key:"opStencilDepthPass",get:function(){return this._opStencilDepthPass},set:function(e){this._opStencilDepthPass!==e&&(this._opStencilDepthPass=e,this._isStencilOpDirty=!0)}},{key:"mask",get:function(){return this._mask},set:function(e){this._mask!==e&&(this._mask=e,this._isStencilMaskDirty=!0)}},{key:"enabled",get:function(){return this._enabled},set:function(e){this._enabled!==e&&(this._enabled=e,this._isStencilTestDirty=!0)}},{key:"reset",value:function(){var e;this.stencilMaterial=void 0,null===(e=this.stencilGlobal)||void 0===e||e.reset(),this._isStencilTestDirty=!0,this._isStencilMaskDirty=!0,this._isStencilFuncDirty=!0,this._isStencilOpDirty=!0}},{key:"apply",value:function(e){var t;if(e){var n=!this.useStencilGlobalOnly&&!(null===(t=this.stencilMaterial)||void 0===t||!t.enabled);this.enabled=n?this.stencilMaterial.enabled:this.stencilGlobal.enabled,this.func=n?this.stencilMaterial.func:this.stencilGlobal.func,this.funcRef=n?this.stencilMaterial.funcRef:this.stencilGlobal.funcRef,this.funcMask=n?this.stencilMaterial.funcMask:this.stencilGlobal.funcMask,this.opStencilFail=n?this.stencilMaterial.opStencilFail:this.stencilGlobal.opStencilFail,this.opDepthFail=n?this.stencilMaterial.opDepthFail:this.stencilGlobal.opDepthFail,this.opStencilDepthPass=n?this.stencilMaterial.opStencilDepthPass:this.stencilGlobal.opStencilDepthPass,this.mask=n?this.stencilMaterial.mask:this.stencilGlobal.mask,this.isDirty&&(this._isStencilTestDirty&&(this.enabled?e.enable(e.STENCIL_TEST):e.disable(e.STENCIL_TEST),this._isStencilTestDirty=!1),this._isStencilMaskDirty&&(e.stencilMask(this.mask),this._isStencilMaskDirty=!1),this._isStencilFuncDirty&&(e.stencilFunc(this.func,this.funcRef,this.funcMask),this._isStencilFuncDirty=!1),this._isStencilOpDirty&&(e.stencilOp(this.opStencilFail,this.opDepthFail,this.opStencilDepthPass),this._isStencilOpDirty=!1))}}}]),e}()},9403:function(e,t,n){"use strict";n.d(t,{p:function(){return a}});var i=n(5671),r=n(3144),a=function(){function e(){(0,i.Z)(this,e),this.rootNodes=new Array,this.cameras=new Array,this.lights=new Array,this.meshes=new Array,this.skeletons=new Array,this.particleSystems=new Array,this.animations=[],this.animationGroups=new Array,this.multiMaterials=new Array,this.materials=new Array,this.morphTargetManagers=new Array,this.geometries=new Array,this.transformNodes=new Array,this.actionManagers=new Array,this.textures=new Array,this._environmentTexture=null,this.postProcesses=new Array}return(0,r.Z)(e,[{key:"environmentTexture",get:function(){return this._environmentTexture},set:function(e){this._environmentTexture=e}},{key:"getNodes",value:function(){var e=new Array;return e=(e=(e=(e=e.concat(this.meshes)).concat(this.lights)).concat(this.cameras)).concat(this.transformNodes),this.skeletons.forEach((function(t){return e=e.concat(t.bones)})),e}}],[{key:"AddParser",value:function(e,t){this._BabylonFileParsers[e]=t}},{key:"GetParser",value:function(e){return this._BabylonFileParsers[e]?this._BabylonFileParsers[e]:null}},{key:"AddIndividualParser",value:function(e,t){this._IndividualBabylonFileParsers[e]=t}},{key:"GetIndividualParser",value:function(e){return this._IndividualBabylonFileParsers[e]?this._IndividualBabylonFileParsers[e]:null}},{key:"Parse",value:function(e,t,n,i){for(var r in this._BabylonFileParsers)Object.prototype.hasOwnProperty.call(this._BabylonFileParsers,r)&&this._BabylonFileParsers[r](e,t,n,i)}}]),e}();a._BabylonFileParsers={},a._IndividualBabylonFileParsers={}},1396:function(e,t,n){"use strict";n.d(t,{N:function(){return p}});var i=n(3144),r=n(5671),a=n(9477),o=n(6900),s=n(9336),u=n(4174),l=n(4198),c=n(5230);function h(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return f(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var d=(0,i.Z)((function e(){(0,r.Z)(this,e),this._doNotSerialize=!1,this._isDisposed=!1,this._sceneRootNodesIndex=-1,this._isEnabled=!0,this._isParentEnabled=!0,this._isReady=!0,this._onEnabledStateChangedObservable=new u.y$,this._onClonedObservable=new u.y$})),p=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;(0,r.Z)(this,e),this._isDirty=!1,this._nodeDataStorage=new d,this.state="",this.metadata=null,this.reservedDataStore=null,this._parentContainer=null,this.animations=new Array,this._ranges={},this.onReady=null,this._currentRenderId=-1,this._parentUpdateId=-1,this._childUpdateId=-1,this._waitingParentId=null,this._waitingParentInstanceIndex=null,this._waitingParsedUniqueId=null,this._cache={},this._parentNode=null,this._children=null,this._worldMatrix=o.y3.Identity(),this._worldMatrixDeterminant=0,this._worldMatrixDeterminantIsDirty=!0,this._animationPropertiesOverride=null,this._isNode=!0,this.onDisposeObservable=new u.y$,this._onDisposeObserver=null,this._behaviors=new Array,this.name=t,this.id=t,this._scene=n||l.l.LastCreatedScene,this.uniqueId=this._scene.getUniqueId(),this._initCache()}return(0,i.Z)(e,[{key:"doNotSerialize",get:function(){return!!this._nodeDataStorage._doNotSerialize||!!this._parentNode&&this._parentNode.doNotSerialize},set:function(e){this._nodeDataStorage._doNotSerialize=e}},{key:"isDisposed",value:function(){return this._nodeDataStorage._isDisposed}},{key:"parent",get:function(){return this._parentNode},set:function(e){if(this._parentNode!==e){var t=this._parentNode;if(this._parentNode&&void 0!==this._parentNode._children&&null!==this._parentNode._children){var n=this._parentNode._children.indexOf(this);-1!==n&&this._parentNode._children.splice(n,1),e||this._nodeDataStorage._isDisposed||this._addToSceneRootNodes()}this._parentNode=e,this._parentNode&&(void 0!==this._parentNode._children&&null!==this._parentNode._children||(this._parentNode._children=new Array),this._parentNode._children.push(this),t||this._removeFromSceneRootNodes()),this._syncParentEnabledState()}}},{key:"_serializeAsParent",value:function(e){e.parentId=this.uniqueId}},{key:"_addToSceneRootNodes",value:function(){-1===this._nodeDataStorage._sceneRootNodesIndex&&(this._nodeDataStorage._sceneRootNodesIndex=this._scene.rootNodes.length,this._scene.rootNodes.push(this))}},{key:"_removeFromSceneRootNodes",value:function(){if(-1!==this._nodeDataStorage._sceneRootNodesIndex){var e=this._scene.rootNodes,t=e.length-1;e[this._nodeDataStorage._sceneRootNodesIndex]=e[t],e[this._nodeDataStorage._sceneRootNodesIndex]._nodeDataStorage._sceneRootNodesIndex=this._nodeDataStorage._sceneRootNodesIndex,this._scene.rootNodes.pop(),this._nodeDataStorage._sceneRootNodesIndex=-1}}},{key:"animationPropertiesOverride",get:function(){return this._animationPropertiesOverride?this._animationPropertiesOverride:this._scene.animationPropertiesOverride},set:function(e){this._animationPropertiesOverride=e}},{key:"getClassName",value:function(){return"Node"}},{key:"onDispose",set:function(e){this._onDisposeObserver&&this.onDisposeObservable.remove(this._onDisposeObserver),this._onDisposeObserver=this.onDisposeObservable.add(e)}},{key:"onEnabledStateChangedObservable",get:function(){return this._nodeDataStorage._onEnabledStateChangedObservable}},{key:"onClonedObservable",get:function(){return this._nodeDataStorage._onClonedObservable}},{key:"getScene",value:function(){return this._scene}},{key:"getEngine",value:function(){return this._scene.getEngine()}},{key:"addBehavior",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this._behaviors.indexOf(e);return-1!==i||(e.init(),this._scene.isLoading&&!n?this._scene.onDataLoadedObservable.addOnce((function(){e.attach(t)})):e.attach(this),this._behaviors.push(e)),this}},{key:"removeBehavior",value:function(e){var t=this._behaviors.indexOf(e);return-1===t||(this._behaviors[t].detach(),this._behaviors.splice(t,1)),this}},{key:"behaviors",get:function(){return this._behaviors}},{key:"getBehaviorByName",value:function(e){var t,n=h(this._behaviors);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(i.name===e)return i}}catch(r){n.e(r)}finally{n.f()}return null}},{key:"getWorldMatrix",value:function(){return this._currentRenderId!==this._scene.getRenderId()&&this.computeWorldMatrix(),this._worldMatrix}},{key:"_getWorldMatrixDeterminant",value:function(){return this._worldMatrixDeterminantIsDirty&&(this._worldMatrixDeterminantIsDirty=!1,this._worldMatrixDeterminant=this._worldMatrix.determinant()),this._worldMatrixDeterminant}},{key:"worldMatrixFromCache",get:function(){return this._worldMatrix}},{key:"_initCache",value:function(){this._cache={},this._cache.parent=void 0}},{key:"updateCache",value:function(e){!e&&this.isSynchronized()||(this._cache.parent=this.parent,this._updateCache())}},{key:"_getActionManagerForTrigger",value:function(e){return this.parent?this.parent._getActionManagerForTrigger(e,!1):null}},{key:"_updateCache",value:function(e){}},{key:"_isSynchronized",value:function(){return!0}},{key:"_markSyncedWithParent",value:function(){this._parentNode&&(this._parentUpdateId=this._parentNode._childUpdateId)}},{key:"isSynchronizedWithParent",value:function(){return!this._parentNode||!this._parentNode._isDirty&&this._parentUpdateId===this._parentNode._childUpdateId&&this._parentNode.isSynchronized()}},{key:"isSynchronized",value:function(){return this._cache.parent!==this._parentNode?(this._cache.parent=this._parentNode,!1):!(this._parentNode&&!this.isSynchronizedWithParent())&&this._isSynchronized()}},{key:"isReady",value:function(){return this._nodeDataStorage._isReady}},{key:"markAsDirty",value:function(e){return this._currentRenderId=Number.MAX_VALUE,this._isDirty=!0,this}},{key:"isEnabled",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return!1===e?this._nodeDataStorage._isEnabled:!!this._nodeDataStorage._isEnabled&&this._nodeDataStorage._isParentEnabled}},{key:"_syncParentEnabledState",value:function(){this._nodeDataStorage._isParentEnabled=!this._parentNode||this._parentNode.isEnabled(),this._children&&this._children.forEach((function(e){e._syncParentEnabledState()}))}},{key:"setEnabled",value:function(e){this._nodeDataStorage._isEnabled!==e&&(this._nodeDataStorage._isEnabled=e,this._nodeDataStorage._onEnabledStateChangedObservable.notifyObservers(e),this._syncParentEnabledState())}},{key:"isDescendantOf",value:function(e){return!!this.parent&&(this.parent===e||this.parent.isDescendantOf(e))}},{key:"_getDescendants",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0;if(this._children)for(var i=0;i<this._children.length;i++){var r=this._children[i];n&&!n(r)||e.push(r),t||r._getDescendants(e,!1,n)}}},{key:"getDescendants",value:function(e,t){var n=new Array;return this._getDescendants(n,e,t),n}},{key:"getChildMeshes",value:function(e,t){var n=[];return this._getDescendants(n,e,(function(e){return(!t||t(e))&&void 0!==e.cullingStrategy})),n}},{key:"getChildren",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.getDescendants(t,e)}},{key:"_setReady",value:function(e){e!==this._nodeDataStorage._isReady&&(e?(this.onReady&&this.onReady(this),this._nodeDataStorage._isReady=!0):this._nodeDataStorage._isReady=!1)}},{key:"getAnimationByName",value:function(e){for(var t=0;t<this.animations.length;t++){var n=this.animations[t];if(n.name===e)return n}return null}},{key:"createAnimationRange",value:function(t,n,i){if(!this._ranges[t]){this._ranges[t]=e._AnimationRangeFactory(t,n,i);for(var r=0,a=this.animations.length;r<a;r++)this.animations[r]&&this.animations[r].createRange(t,n,i)}}},{key:"deleteAnimationRange",value:function(e){for(var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=0,i=this.animations.length;n<i;n++)this.animations[n]&&this.animations[n].deleteRange(e,t);this._ranges[e]=null}},{key:"getAnimationRange",value:function(e){return this._ranges[e]||null}},{key:"getAnimationRanges",value:function(){var e,t=[];for(e in this._ranges)t.push(this._ranges[e]);return t}},{key:"beginAnimation",value:function(e,t,n,i){var r=this.getAnimationRange(e);return r?this._scene.beginAnimation(this,r.from,r.to,t,n,i):null}},{key:"serializeAnimationRanges",value:function(){var e=[];for(var t in this._ranges){var n=this._ranges[t];if(n){var i={};i.name=t,i.from=n.from,i.to=n.to,e.push(i)}}return e}},{key:"computeWorldMatrix",value:function(e){return this._worldMatrix||(this._worldMatrix=o.y3.Identity()),this._worldMatrix}},{key:"dispose",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this._nodeDataStorage._isDisposed=!0,!e){var n,i=this.getDescendants(!0),r=h(i);try{for(r.s();!(n=r.n()).done;){var a=n.value;a.dispose(e,t)}}catch(l){r.e(l)}finally{r.f()}}this.parent?this.parent=null:this._removeFromSceneRootNodes(),this.onDisposeObservable.notifyObservers(this),this.onDisposeObservable.clear(),this.onEnabledStateChangedObservable.clear(),this.onClonedObservable.clear();var o,s=h(this._behaviors);try{for(s.s();!(o=s.n()).done;){var u=o.value;u.detach()}}catch(l){s.e(l)}finally{s.f()}this._behaviors.length=0,this.metadata=null}},{key:"getHierarchyBoundingVectors",value:function(){var e,t,n=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.getScene().incrementRenderId(),this.computeWorldMatrix(!0);var r=this;if(r.getBoundingInfo&&r.subMeshes){var a=r.getBoundingInfo();e=a.boundingBox.minimumWorld.clone(),t=a.boundingBox.maximumWorld.clone()}else e=new o.P(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),t=new o.P(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);if(n){var s,u=this.getDescendants(!1),l=h(u);try{for(l.s();!(s=l.n()).done;){var c=s.value,f=c;if(f.computeWorldMatrix(!0),(!i||i(f))&&f.getBoundingInfo&&0!==f.getTotalVertices()){var d=f.getBoundingInfo(),p=d.boundingBox,v=p.minimumWorld,m=p.maximumWorld;o.P.CheckExtends(v,e,t),o.P.CheckExtends(m,e,t)}}}catch(g){l.e(g)}finally{l.f()}}return{min:e,max:t}}}],[{key:"AddNodeConstructor",value:function(e,t){this._NodeConstructors[e]=t}},{key:"Construct",value:function(e,t,n,i){var r=this._NodeConstructors[e];return r?r(t,n,i):null}},{key:"ParseAnimationRanges",value:function(e,t,n){if(t.ranges)for(var i=0;i<t.ranges.length;i++){var r=t.ranges[i];e.createAnimationRange(r.name,r.from,r.to)}}}]),e}();p._AnimationRangeFactory=function(e,t,n){throw(0,c.S)("AnimationRange")},p._NodeConstructors={},(0,a.gn)([(0,s.qC)()],p.prototype,"name",void 0),(0,a.gn)([(0,s.qC)()],p.prototype,"id",void 0),(0,a.gn)([(0,s.qC)()],p.prototype,"uniqueId",void 0),(0,a.gn)([(0,s.qC)()],p.prototype,"state",void 0),(0,a.gn)([(0,s.qC)()],p.prototype,"metadata",void 0)},3767:function(e,t,n){"use strict";n.d(t,{H:function(){return f},l:function(){return h}});var i=n(2982),r=n(136),a=n(6215),o=n(1120),s=n(2407),u=n(3144),l=n(5671);function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,o.Z)(e);if(t){var r=(0,o.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,a.Z)(this,n)}}var h=(0,u.Z)((function e(){(0,l.Z)(this,e)}));h.NAME_EFFECTLAYER="EffectLayer",h.NAME_LAYER="Layer",h.NAME_LENSFLARESYSTEM="LensFlareSystem",h.NAME_BOUNDINGBOXRENDERER="BoundingBoxRenderer",h.NAME_PARTICLESYSTEM="ParticleSystem",h.NAME_GAMEPAD="Gamepad",h.NAME_SIMPLIFICATIONQUEUE="SimplificationQueue",h.NAME_GEOMETRYBUFFERRENDERER="GeometryBufferRenderer",h.NAME_PREPASSRENDERER="PrePassRenderer",h.NAME_DEPTHRENDERER="DepthRenderer",h.NAME_DEPTHPEELINGRENDERER="DepthPeelingRenderer",h.NAME_POSTPROCESSRENDERPIPELINEMANAGER="PostProcessRenderPipelineManager",h.NAME_SPRITE="Sprite",h.NAME_SUBSURFACE="SubSurface",h.NAME_OUTLINERENDERER="Outline",h.NAME_PROCEDURALTEXTURE="ProceduralTexture",h.NAME_SHADOWGENERATOR="ShadowGenerator",h.NAME_OCTREE="Octree",h.NAME_PHYSICSENGINE="PhysicsEngine",h.NAME_AUDIO="Audio",h.STEP_ISREADYFORMESH_EFFECTLAYER=0,h.STEP_BEFOREEVALUATEACTIVEMESH_BOUNDINGBOXRENDERER=0,h.STEP_EVALUATESUBMESH_BOUNDINGBOXRENDERER=0,h.STEP_PREACTIVEMESH_BOUNDINGBOXRENDERER=0,h.STEP_CAMERADRAWRENDERTARGET_EFFECTLAYER=1,h.STEP_BEFORECAMERADRAW_PREPASS=0,h.STEP_BEFORECAMERADRAW_EFFECTLAYER=1,h.STEP_BEFORECAMERADRAW_LAYER=2,h.STEP_BEFORERENDERTARGETDRAW_PREPASS=0,h.STEP_BEFORERENDERTARGETDRAW_LAYER=1,h.STEP_BEFORERENDERINGMESH_PREPASS=0,h.STEP_BEFORERENDERINGMESH_OUTLINE=1,h.STEP_AFTERRENDERINGMESH_PREPASS=0,h.STEP_AFTERRENDERINGMESH_OUTLINE=1,h.STEP_AFTERRENDERINGGROUPDRAW_EFFECTLAYER_DRAW=0,h.STEP_AFTERRENDERINGGROUPDRAW_BOUNDINGBOXRENDERER=1,h.STEP_BEFORECAMERAUPDATE_SIMPLIFICATIONQUEUE=0,h.STEP_BEFORECAMERAUPDATE_GAMEPAD=1,h.STEP_BEFORECLEAR_PROCEDURALTEXTURE=0,h.STEP_BEFORECLEAR_PREPASS=1,h.STEP_BEFORERENDERTARGETCLEAR_PREPASS=0,h.STEP_AFTERRENDERTARGETDRAW_PREPASS=0,h.STEP_AFTERRENDERTARGETDRAW_LAYER=1,h.STEP_AFTERCAMERADRAW_PREPASS=0,h.STEP_AFTERCAMERADRAW_EFFECTLAYER=1,h.STEP_AFTERCAMERADRAW_LENSFLARESYSTEM=2,h.STEP_AFTERCAMERADRAW_EFFECTLAYER_DRAW=3,h.STEP_AFTERCAMERADRAW_LAYER=4,h.STEP_AFTERRENDER_AUDIO=0,h.STEP_GATHERRENDERTARGETS_DEPTHRENDERER=0,h.STEP_GATHERRENDERTARGETS_GEOMETRYBUFFERRENDERER=1,h.STEP_GATHERRENDERTARGETS_SHADOWGENERATOR=2,h.STEP_GATHERRENDERTARGETS_POSTPROCESSRENDERPIPELINEMANAGER=3,h.STEP_GATHERACTIVECAMERARENDERTARGETS_DEPTHRENDERER=0,h.STEP_POINTERMOVE_SPRITE=0,h.STEP_POINTERDOWN_SPRITE=0,h.STEP_POINTERUP_SPRITE=0;var f=function(e){(0,r.Z)(n,e);var t=c(n);function n(e){return(0,l.Z)(this,n),t.call.apply(t,[this].concat((0,i.Z)(e)))}return(0,u.Z)(n,[{key:"registerStep",value:function(e,t,n){var i=0;for(Number.MAX_VALUE;i<this.length;i++){if(e<this[i].index)break}this.splice(i,0,{index:e,component:t,action:n.bind(t)})}},{key:"clear",value:function(){this.length=0}}],[{key:"Create",value:function(){return Object.create(n.prototype)}}]),n}((0,s.Z)(Array))},9477:function(e,t,n){"use strict";n.d(t,{gn:function(){return i}});function i(e,t,n,i){var r,a=arguments.length,o=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(o=(a<3?r(o):a>3?r(t,n,o):r(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o}Object.create;Object.create},5477:function(e,t,n){"use strict";n.d(t,{kG:function(){return i}});function i(e,t,n){if(void 0===n&&(n=Error),!e)throw new n(t)}},289:function(e,t,n){"use strict";function i(e,t){var n=t&&t.cache?t.cache:c,i=t&&t.serializer?t.serializer:u;return(t&&t.strategy?t.strategy:s)(e,{cache:n,serializer:i})}function r(e,t,n,i){var r,a=null==(r=i)||"number"==typeof r||"boolean"==typeof r?i:n(i),o=t.get(a);return void 0===o&&(o=e.call(this,i),t.set(a,o)),o}function a(e,t,n){var i=Array.prototype.slice.call(arguments,3),r=n(i),a=t.get(r);return void 0===a&&(a=e.apply(this,i),t.set(r,a)),a}function o(e,t,n,i,r){return n.bind(t,e,i,r)}function s(e,t){return o(e,this,1===e.length?r:a,t.cache.create(),t.serializer)}n.d(t,{A:function(){return h},Z:function(){return i}});var u=function(){return JSON.stringify(arguments)};function l(){this.cache=Object.create(null)}l.prototype.get=function(e){return this.cache[e]},l.prototype.set=function(e,t){this.cache[e]=t};var c={create:function(){return new l}},h={variadic:function(e,t){return o(e,this,a,t.cache.create(),t.serializer)},monadic:function(e,t){return o(e,this,r,t.cache.create(),t.serializer)}}},7959:function(e,t,n){"use strict";n.d(t,{wD:function(){return a},VG:function(){return u},rp:function(){return c},Ii:function(){return g},O4:function(){return s},uf:function(){return l},Wh:function(){return m},Jo:function(){return d},yx:function(){return p},Wi:function(){return f},HI:function(){return v},pe:function(){return h},Qc:function(){return ae}});var i,r=n(9900);!function(e){e[e.EXPECT_ARGUMENT_CLOSING_BRACE=1]="EXPECT_ARGUMENT_CLOSING_BRACE",e[e.EMPTY_ARGUMENT=2]="EMPTY_ARGUMENT",e[e.MALFORMED_ARGUMENT=3]="MALFORMED_ARGUMENT",e[e.EXPECT_ARGUMENT_TYPE=4]="EXPECT_ARGUMENT_TYPE",e[e.INVALID_ARGUMENT_TYPE=5]="INVALID_ARGUMENT_TYPE",e[e.EXPECT_ARGUMENT_STYLE=6]="EXPECT_ARGUMENT_STYLE",e[e.INVALID_NUMBER_SKELETON=7]="INVALID_NUMBER_SKELETON",e[e.INVALID_DATE_TIME_SKELETON=8]="INVALID_DATE_TIME_SKELETON",e[e.EXPECT_NUMBER_SKELETON=9]="EXPECT_NUMBER_SKELETON",e[e.EXPECT_DATE_TIME_SKELETON=10]="EXPECT_DATE_TIME_SKELETON",e[e.UNCLOSED_QUOTE_IN_ARGUMENT_STYLE=11]="UNCLOSED_QUOTE_IN_ARGUMENT_STYLE",e[e.EXPECT_SELECT_ARGUMENT_OPTIONS=12]="EXPECT_SELECT_ARGUMENT_OPTIONS",e[e.EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE=13]="EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE",e[e.INVALID_PLURAL_ARGUMENT_OFFSET_VALUE=14]="INVALID_PLURAL_ARGUMENT_OFFSET_VALUE",e[e.EXPECT_SELECT_ARGUMENT_SELECTOR=15]="EXPECT_SELECT_ARGUMENT_SELECTOR",e[e.EXPECT_PLURAL_ARGUMENT_SELECTOR=16]="EXPECT_PLURAL_ARGUMENT_SELECTOR",e[e.EXPECT_SELECT_ARGUMENT_SELECTOR_FRAGMENT=17]="EXPECT_SELECT_ARGUMENT_SELECTOR_FRAGMENT",e[e.EXPECT_PLURAL_ARGUMENT_SELECTOR_FRAGMENT=18]="EXPECT_PLURAL_ARGUMENT_SELECTOR_FRAGMENT",e[e.INVALID_PLURAL_ARGUMENT_SELECTOR=19]="INVALID_PLURAL_ARGUMENT_SELECTOR",e[e.DUPLICATE_PLURAL_ARGUMENT_SELECTOR=20]="DUPLICATE_PLURAL_ARGUMENT_SELECTOR",e[e.DUPLICATE_SELECT_ARGUMENT_SELECTOR=21]="DUPLICATE_SELECT_ARGUMENT_SELECTOR",e[e.MISSING_OTHER_CLAUSE=22]="MISSING_OTHER_CLAUSE",e[e.INVALID_TAG=23]="INVALID_TAG",e[e.INVALID_TAG_NAME=25]="INVALID_TAG_NAME",e[e.UNMATCHED_CLOSING_TAG=26]="UNMATCHED_CLOSING_TAG",e[e.UNCLOSED_TAG=27]="UNCLOSED_TAG"}(i||(i={}));var a,o;n(8559),n(5674),n(8702);function s(e){return e.type===a.literal}function u(e){return e.type===a.argument}function l(e){return e.type===a.number}function c(e){return e.type===a.date}function h(e){return e.type===a.time}function f(e){return e.type===a.select}function d(e){return e.type===a.plural}function p(e){return e.type===a.pound}function v(e){return e.type===a.tag}function m(e){return!(!e||"object"!=typeof e||e.type!==o.number)}function g(e){return!(!e||"object"!=typeof e||e.type!==o.dateTime)}!function(e){e[e.literal=0]="literal",e[e.argument=1]="argument",e[e.number=2]="number",e[e.date=3]="date",e[e.time=4]="time",e[e.select=5]="select",e[e.plural=6]="plural",e[e.pound=7]="pound",e[e.tag=8]="tag"}(a||(a={})),function(e){e[e.number=0]="number",e[e.dateTime=1]="dateTime"}(o||(o={}));var _=/[ \xA0\u1680\u2000-\u200A\u202F\u205F\u3000]/,y=/(?:[Eec]{1,6}|G{1,5}|[Qq]{1,5}|(?:[yYur]+|U{1,5})|[ML]{1,5}|d{1,2}|D{1,3}|F{1}|[abB]{1,5}|[hkHK]{1,2}|w{1,2}|W{1}|m{1,2}|s{1,2}|[zZOvVxX]{1,4})(?=([^']*'[^']*')*[^']*$)/g;function E(e){var t={};return e.replace(y,(function(e){var n=e.length;switch(e[0]){case"G":t.era=4===n?"long":5===n?"narrow":"short";break;case"y":t.year=2===n?"2-digit":"numeric";break;case"Y":case"u":case"U":case"r":throw new RangeError("`Y/u/U/r` (year) patterns are not supported, use `y` instead");case"q":case"Q":throw new RangeError("`q/Q` (quarter) patterns are not supported");case"M":case"L":t.month=["numeric","2-digit","short","long","narrow"][n-1];break;case"w":case"W":throw new RangeError("`w/W` (week) patterns are not supported");case"d":t.day=["numeric","2-digit"][n-1];break;case"D":case"F":case"g":throw new RangeError("`D/F/g` (day) patterns are not supported, use `d` instead");case"E":t.weekday=4===n?"short":5===n?"narrow":"short";break;case"e":if(n<4)throw new RangeError("`e..eee` (weekday) patterns are not supported");t.weekday=["short","long","narrow","short"][n-4];break;case"c":if(n<4)throw new RangeError("`c..ccc` (weekday) patterns are not supported");t.weekday=["short","long","narrow","short"][n-4];break;case"a":t.hour12=!0;break;case"b":case"B":throw new RangeError("`b/B` (period) patterns are not supported, use `a` instead");case"h":t.hourCycle="h12",t.hour=["numeric","2-digit"][n-1];break;case"H":t.hourCycle="h23",t.hour=["numeric","2-digit"][n-1];break;case"K":t.hourCycle="h11",t.hour=["numeric","2-digit"][n-1];break;case"k":t.hourCycle="h24",t.hour=["numeric","2-digit"][n-1];break;case"j":case"J":case"C":throw new RangeError("`j/J/C` (hour) patterns are not supported, use `h/H/K/k` instead");case"m":t.minute=["numeric","2-digit"][n-1];break;case"s":t.second=["numeric","2-digit"][n-1];break;case"S":case"A":throw new RangeError("`S/A` (second) patterns are not supported, use `s` instead");case"z":t.timeZoneName=n<4?"short":"long";break;case"Z":case"O":case"v":case"V":case"X":case"x":throw new RangeError("`Z/O/v/V/X/x` (timeZone) patterns are not supported, use `z` instead")}return""})),t}var A=/[\t-\r \x85\u200E\u200F\u2028\u2029]/i;var b=/^\.(?:(0+)(\*)?|(#+)|(0+)(#+))$/g,T=/^(@+)?(\+|#+)?[rs]?$/g,M=/(\*)(0+)|(#+)(0+)|(0+)/g,S=/^(0+)$/;function I(e){var t={};return"r"===e[e.length-1]?t.roundingPriority="morePrecision":"s"===e[e.length-1]&&(t.roundingPriority="lessPrecision"),e.replace(T,(function(e,n,i){return"string"!=typeof i?(t.minimumSignificantDigits=n.length,t.maximumSignificantDigits=n.length):"+"===i?t.minimumSignificantDigits=n.length:"#"===n[0]?t.maximumSignificantDigits=n.length:(t.minimumSignificantDigits=n.length,t.maximumSignificantDigits=n.length+("string"==typeof i?i.length:0)),""})),t}function x(e){switch(e){case"sign-auto":return{signDisplay:"auto"};case"sign-accounting":case"()":return{currencySign:"accounting"};case"sign-always":case"+!":return{signDisplay:"always"};case"sign-accounting-always":case"()!":return{signDisplay:"always",currencySign:"accounting"};case"sign-except-zero":case"+?":return{signDisplay:"exceptZero"};case"sign-accounting-except-zero":case"()?":return{signDisplay:"exceptZero",currencySign:"accounting"};case"sign-never":case"+_":return{signDisplay:"never"}}}function C(e){var t;if("E"===e[0]&&"E"===e[1]?(t={notation:"engineering"},e=e.slice(2)):"E"===e[0]&&(t={notation:"scientific"},e=e.slice(1)),t){var n=e.slice(0,2);if("+!"===n?(t.signDisplay="always",e=e.slice(2)):"+?"===n&&(t.signDisplay="exceptZero",e=e.slice(2)),!S.test(e))throw new Error("Malformed concise eng/scientific notation");t.minimumIntegerDigits=e.length}return t}function P(e){var t=x(e);return t||{}}function D(e){for(var t={},n=0,i=e;n<i.length;n++){var a=i[n];switch(a.stem){case"percent":case"%":t.style="percent";continue;case"%x100":t.style="percent",t.scale=100;continue;case"currency":t.style="currency",t.currency=a.options[0];continue;case"group-off":case",_":t.useGrouping=!1;continue;case"precision-integer":case".":t.maximumFractionDigits=0;continue;case"measure-unit":case"unit":t.style="unit",t.unit=a.options[0].replace(/^(.*?)-/,"");continue;case"compact-short":case"K":t.notation="compact",t.compactDisplay="short";continue;case"compact-long":case"KK":t.notation="compact",t.compactDisplay="long";continue;case"scientific":t=(0,r.pi)((0,r.pi)((0,r.pi)({},t),{notation:"scientific"}),a.options.reduce((function(e,t){return(0,r.pi)((0,r.pi)({},e),P(t))}),{}));continue;case"engineering":t=(0,r.pi)((0,r.pi)((0,r.pi)({},t),{notation:"engineering"}),a.options.reduce((function(e,t){return(0,r.pi)((0,r.pi)({},e),P(t))}),{}));continue;case"notation-simple":t.notation="standard";continue;case"unit-width-narrow":t.currencyDisplay="narrowSymbol",t.unitDisplay="narrow";continue;case"unit-width-short":t.currencyDisplay="code",t.unitDisplay="short";continue;case"unit-width-full-name":t.currencyDisplay="name",t.unitDisplay="long";continue;case"unit-width-iso-code":t.currencyDisplay="symbol";continue;case"scale":t.scale=parseFloat(a.options[0]);continue;case"integer-width":if(a.options.length>1)throw new RangeError("integer-width stems only accept a single optional option");a.options[0].replace(M,(function(e,n,i,r,a,o){if(n)t.minimumIntegerDigits=i.length;else{if(r&&a)throw new Error("We currently do not support maximum integer digits");if(o)throw new Error("We currently do not support exact integer digits")}return""}));continue}if(S.test(a.stem))t.minimumIntegerDigits=a.stem.length;else if(b.test(a.stem)){if(a.options.length>1)throw new RangeError("Fraction-precision stems only accept a single optional option");a.stem.replace(b,(function(e,n,i,r,a,o){return"*"===i?t.minimumFractionDigits=n.length:r&&"#"===r[0]?t.maximumFractionDigits=r.length:a&&o?(t.minimumFractionDigits=a.length,t.maximumFractionDigits=a.length+o.length):(t.minimumFractionDigits=n.length,t.maximumFractionDigits=n.length),""}));var o=a.options[0];"w"===o?t=(0,r.pi)((0,r.pi)({},t),{trailingZeroDisplay:"stripIfInteger"}):o&&(t=(0,r.pi)((0,r.pi)({},t),I(o)))}else if(T.test(a.stem))t=(0,r.pi)((0,r.pi)({},t),I(a.stem));else{var s=x(a.stem);s&&(t=(0,r.pi)((0,r.pi)({},t),s));var u=C(a.stem);u&&(t=(0,r.pi)((0,r.pi)({},t),u))}}return t}var R,k={AX:["H"],BQ:["H"],CP:["H"],CZ:["H"],DK:["H"],FI:["H"],ID:["H"],IS:["H"],ML:["H"],NE:["H"],RU:["H"],SE:["H"],SJ:["H"],SK:["H"],AS:["h","H"],BT:["h","H"],DJ:["h","H"],ER:["h","H"],GH:["h","H"],IN:["h","H"],LS:["h","H"],PG:["h","H"],PW:["h","H"],SO:["h","H"],TO:["h","H"],VU:["h","H"],WS:["h","H"],"001":["H","h"],AL:["h","H","hB"],TD:["h","H","hB"],"ca-ES":["H","h","hB"],CF:["H","h","hB"],CM:["H","h","hB"],"fr-CA":["H","h","hB"],"gl-ES":["H","h","hB"],"it-CH":["H","h","hB"],"it-IT":["H","h","hB"],LU:["H","h","hB"],NP:["H","h","hB"],PF:["H","h","hB"],SC:["H","h","hB"],SM:["H","h","hB"],SN:["H","h","hB"],TF:["H","h","hB"],VA:["H","h","hB"],CY:["h","H","hb","hB"],GR:["h","H","hb","hB"],CO:["h","H","hB","hb"],DO:["h","H","hB","hb"],KP:["h","H","hB","hb"],KR:["h","H","hB","hb"],NA:["h","H","hB","hb"],PA:["h","H","hB","hb"],PR:["h","H","hB","hb"],VE:["h","H","hB","hb"],AC:["H","h","hb","hB"],AI:["H","h","hb","hB"],BW:["H","h","hb","hB"],BZ:["H","h","hb","hB"],CC:["H","h","hb","hB"],CK:["H","h","hb","hB"],CX:["H","h","hb","hB"],DG:["H","h","hb","hB"],FK:["H","h","hb","hB"],GB:["H","h","hb","hB"],GG:["H","h","hb","hB"],GI:["H","h","hb","hB"],IE:["H","h","hb","hB"],IM:["H","h","hb","hB"],IO:["H","h","hb","hB"],JE:["H","h","hb","hB"],LT:["H","h","hb","hB"],MK:["H","h","hb","hB"],MN:["H","h","hb","hB"],MS:["H","h","hb","hB"],NF:["H","h","hb","hB"],NG:["H","h","hb","hB"],NR:["H","h","hb","hB"],NU:["H","h","hb","hB"],PN:["H","h","hb","hB"],SH:["H","h","hb","hB"],SX:["H","h","hb","hB"],TA:["H","h","hb","hB"],ZA:["H","h","hb","hB"],"af-ZA":["H","h","hB","hb"],AR:["H","h","hB","hb"],CL:["H","h","hB","hb"],CR:["H","h","hB","hb"],CU:["H","h","hB","hb"],EA:["H","h","hB","hb"],"es-BO":["H","h","hB","hb"],"es-BR":["H","h","hB","hb"],"es-EC":["H","h","hB","hb"],"es-ES":["H","h","hB","hb"],"es-GQ":["H","h","hB","hb"],"es-PE":["H","h","hB","hb"],GT:["H","h","hB","hb"],HN:["H","h","hB","hb"],IC:["H","h","hB","hb"],KG:["H","h","hB","hb"],KM:["H","h","hB","hb"],LK:["H","h","hB","hb"],MA:["H","h","hB","hb"],MX:["H","h","hB","hb"],NI:["H","h","hB","hb"],PY:["H","h","hB","hb"],SV:["H","h","hB","hb"],UY:["H","h","hB","hb"],JP:["H","h","K"],AD:["H","hB"],AM:["H","hB"],AO:["H","hB"],AT:["H","hB"],AW:["H","hB"],BE:["H","hB"],BF:["H","hB"],BJ:["H","hB"],BL:["H","hB"],BR:["H","hB"],CG:["H","hB"],CI:["H","hB"],CV:["H","hB"],DE:["H","hB"],EE:["H","hB"],FR:["H","hB"],GA:["H","hB"],GF:["H","hB"],GN:["H","hB"],GP:["H","hB"],GW:["H","hB"],HR:["H","hB"],IL:["H","hB"],IT:["H","hB"],KZ:["H","hB"],MC:["H","hB"],MD:["H","hB"],MF:["H","hB"],MQ:["H","hB"],MZ:["H","hB"],NC:["H","hB"],NL:["H","hB"],PM:["H","hB"],PT:["H","hB"],RE:["H","hB"],RO:["H","hB"],SI:["H","hB"],SR:["H","hB"],ST:["H","hB"],TG:["H","hB"],TR:["H","hB"],WF:["H","hB"],YT:["H","hB"],BD:["h","hB","H"],PK:["h","hB","H"],AZ:["H","hB","h"],BA:["H","hB","h"],BG:["H","hB","h"],CH:["H","hB","h"],GE:["H","hB","h"],LI:["H","hB","h"],ME:["H","hB","h"],RS:["H","hB","h"],UA:["H","hB","h"],UZ:["H","hB","h"],XK:["H","hB","h"],AG:["h","hb","H","hB"],AU:["h","hb","H","hB"],BB:["h","hb","H","hB"],BM:["h","hb","H","hB"],BS:["h","hb","H","hB"],CA:["h","hb","H","hB"],DM:["h","hb","H","hB"],"en-001":["h","hb","H","hB"],FJ:["h","hb","H","hB"],FM:["h","hb","H","hB"],GD:["h","hb","H","hB"],GM:["h","hb","H","hB"],GU:["h","hb","H","hB"],GY:["h","hb","H","hB"],JM:["h","hb","H","hB"],KI:["h","hb","H","hB"],KN:["h","hb","H","hB"],KY:["h","hb","H","hB"],LC:["h","hb","H","hB"],LR:["h","hb","H","hB"],MH:["h","hb","H","hB"],MP:["h","hb","H","hB"],MW:["h","hb","H","hB"],NZ:["h","hb","H","hB"],SB:["h","hb","H","hB"],SG:["h","hb","H","hB"],SL:["h","hb","H","hB"],SS:["h","hb","H","hB"],SZ:["h","hb","H","hB"],TC:["h","hb","H","hB"],TT:["h","hb","H","hB"],UM:["h","hb","H","hB"],US:["h","hb","H","hB"],VC:["h","hb","H","hB"],VG:["h","hb","H","hB"],VI:["h","hb","H","hB"],ZM:["h","hb","H","hB"],BO:["H","hB","h","hb"],EC:["H","hB","h","hb"],ES:["H","hB","h","hb"],GQ:["H","hB","h","hb"],PE:["H","hB","h","hb"],AE:["h","hB","hb","H"],"ar-001":["h","hB","hb","H"],BH:["h","hB","hb","H"],DZ:["h","hB","hb","H"],EG:["h","hB","hb","H"],EH:["h","hB","hb","H"],HK:["h","hB","hb","H"],IQ:["h","hB","hb","H"],JO:["h","hB","hb","H"],KW:["h","hB","hb","H"],LB:["h","hB","hb","H"],LY:["h","hB","hb","H"],MO:["h","hB","hb","H"],MR:["h","hB","hb","H"],OM:["h","hB","hb","H"],PH:["h","hB","hb","H"],PS:["h","hB","hb","H"],QA:["h","hB","hb","H"],SA:["h","hB","hb","H"],SD:["h","hB","hb","H"],SY:["h","hB","hb","H"],TN:["h","hB","hb","H"],YE:["h","hB","hb","H"],AF:["H","hb","hB","h"],LA:["H","hb","hB","h"],CN:["H","hB","hb","h"],LV:["H","hB","hb","h"],TL:["H","hB","hb","h"],"zu-ZA":["H","hB","hb","h"],CD:["hB","H"],IR:["hB","H"],"hi-IN":["hB","h","H"],"kn-IN":["hB","h","H"],"ml-IN":["hB","h","H"],"te-IN":["hB","h","H"],KH:["hB","h","H","hb"],"ta-IN":["hB","h","hb","H"],BN:["hb","hB","h","H"],MY:["hb","hB","h","H"],ET:["hB","hb","h","H"],"gu-IN":["hB","hb","h","H"],"mr-IN":["hB","hb","h","H"],"pa-IN":["hB","hb","h","H"],TW:["hB","hb","h","H"],KE:["hB","hb","H","h"],MM:["hB","hb","H","h"],TZ:["hB","hb","H","h"],UG:["hB","hb","H","h"]};function O(e){var t=e.hourCycle;if(void 0===t&&e.hourCycles&&e.hourCycles.length&&(t=e.hourCycles[0]),t)switch(t){case"h24":return"k";case"h23":return"H";case"h12":return"h";case"h11":return"K";default:throw new Error("Invalid hourCycle")}var n,i=e.language;return"root"!==i&&(n=e.maximize().region),(k[n||""]||k[i||""]||k["".concat(i,"-001")]||k["001"])[0]}var N=new RegExp("^".concat(_.source,"*")),w=new RegExp("".concat(_.source,"*$"));function L(e,t){return{start:e,end:t}}var F=!!String.prototype.startsWith,B=!!String.fromCodePoint,U=!!Object.fromEntries,V=!!String.prototype.codePointAt,G=!!String.prototype.trimStart,z=!!String.prototype.trimEnd,W=!!Number.isSafeInteger?Number.isSafeInteger:function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e&&Math.abs(e)<=9007199254740991},H=!0;try{H="a"===(null===(R=$("([^\\p{White_Space}\\p{Pattern_Syntax}]*)","yu").exec("a"))||void 0===R?void 0:R[0])}catch(oe){H=!1}var X,j=F?function(e,t,n){return e.startsWith(t,n)}:function(e,t,n){return e.slice(n,n+t.length)===t},Y=B?String.fromCodePoint:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n,i="",r=e.length,a=0;r>a;){if((n=e[a++])>1114111)throw RangeError(n+" is not a valid code point");i+=n<65536?String.fromCharCode(n):String.fromCharCode(55296+((n-=65536)>>10),n%1024+56320)}return i},Z=U?Object.fromEntries:function(e){for(var t={},n=0,i=e;n<i.length;n++){var r=i[n],a=r[0],o=r[1];t[a]=o}return t},K=V?function(e,t){return e.codePointAt(t)}:function(e,t){var n=e.length;if(!(t<0||t>=n)){var i,r=e.charCodeAt(t);return r<55296||r>56319||t+1===n||(i=e.charCodeAt(t+1))<56320||i>57343?r:i-56320+(r-55296<<10)+65536}},q=G?function(e){return e.trimStart()}:function(e){return e.replace(N,"")},Q=z?function(e){return e.trimEnd()}:function(e){return e.replace(w,"")};function $(e,t){return new RegExp(e,t)}if(H){var J=$("([^\\p{White_Space}\\p{Pattern_Syntax}]*)","yu");X=function(e,t){var n;return J.lastIndex=t,null!==(n=J.exec(e)[1])&&void 0!==n?n:""}}else X=function(e,t){for(var n=[];;){var i=K(e,t);if(void 0===i||ne(i)||ie(i))break;n.push(i),t+=i>=65536?2:1}return Y.apply(void 0,n)};var ee=function(){function e(e,t){void 0===t&&(t={}),this.message=e,this.position={offset:0,line:1,column:1},this.ignoreTag=!!t.ignoreTag,this.locale=t.locale,this.requiresOtherClause=!!t.requiresOtherClause,this.shouldParseSkeletons=!!t.shouldParseSkeletons}return e.prototype.parse=function(){if(0!==this.offset())throw Error("parser can only be used once");return this.parseMessage(0,"",!1)},e.prototype.parseMessage=function(e,t,n){for(var r=[];!this.isEOF();){var o=this.char();if(123===o){if((s=this.parseArgument(e,n)).err)return s;r.push(s.val)}else{if(125===o&&e>0)break;if(35!==o||"plural"!==t&&"selectordinal"!==t){if(60===o&&!this.ignoreTag&&47===this.peek()){if(n)break;return this.error(i.UNMATCHED_CLOSING_TAG,L(this.clonePosition(),this.clonePosition()))}if(60===o&&!this.ignoreTag&&te(this.peek()||0)){if((s=this.parseTag(e,t)).err)return s;r.push(s.val)}else{var s;if((s=this.parseLiteral(e,t)).err)return s;r.push(s.val)}}else{var u=this.clonePosition();this.bump(),r.push({type:a.pound,location:L(u,this.clonePosition())})}}}return{val:r,err:null}},e.prototype.parseTag=function(e,t){var n=this.clonePosition();this.bump();var r=this.parseTagName();if(this.bumpSpace(),this.bumpIf("/>"))return{val:{type:a.literal,value:"<".concat(r,"/>"),location:L(n,this.clonePosition())},err:null};if(this.bumpIf(">")){var o=this.parseMessage(e+1,t,!0);if(o.err)return o;var s=o.val,u=this.clonePosition();if(this.bumpIf("</")){if(this.isEOF()||!te(this.char()))return this.error(i.INVALID_TAG,L(u,this.clonePosition()));var l=this.clonePosition();return r!==this.parseTagName()?this.error(i.UNMATCHED_CLOSING_TAG,L(l,this.clonePosition())):(this.bumpSpace(),this.bumpIf(">")?{val:{type:a.tag,value:r,children:s,location:L(n,this.clonePosition())},err:null}:this.error(i.INVALID_TAG,L(u,this.clonePosition())))}return this.error(i.UNCLOSED_TAG,L(n,this.clonePosition()))}return this.error(i.INVALID_TAG,L(n,this.clonePosition()))},e.prototype.parseTagName=function(){var e,t=this.offset();for(this.bump();!this.isEOF()&&(45===(e=this.char())||46===e||e>=48&&e<=57||95===e||e>=97&&e<=122||e>=65&&e<=90||183==e||e>=192&&e<=214||e>=216&&e<=246||e>=248&&e<=893||e>=895&&e<=8191||e>=8204&&e<=8205||e>=8255&&e<=8256||e>=8304&&e<=8591||e>=11264&&e<=12271||e>=12289&&e<=55295||e>=63744&&e<=64975||e>=65008&&e<=65533||e>=65536&&e<=983039);)this.bump();return this.message.slice(t,this.offset())},e.prototype.parseLiteral=function(e,t){for(var n=this.clonePosition(),i="";;){var r=this.tryParseQuote(t);if(r)i+=r;else{var o=this.tryParseUnquoted(e,t);if(o)i+=o;else{var s=this.tryParseLeftAngleBracket();if(!s)break;i+=s}}}var u=L(n,this.clonePosition());return{val:{type:a.literal,value:i,location:u},err:null}},e.prototype.tryParseLeftAngleBracket=function(){return this.isEOF()||60!==this.char()||!this.ignoreTag&&(te(e=this.peek()||0)||47===e)?null:(this.bump(),"<");var e},e.prototype.tryParseQuote=function(e){if(this.isEOF()||39!==this.char())return null;switch(this.peek()){case 39:return this.bump(),this.bump(),"'";case 123:case 60:case 62:case 125:break;case 35:if("plural"===e||"selectordinal"===e)break;return null;default:return null}this.bump();var t=[this.char()];for(this.bump();!this.isEOF();){var n=this.char();if(39===n){if(39!==this.peek()){this.bump();break}t.push(39),this.bump()}else t.push(n);this.bump()}return Y.apply(void 0,t)},e.prototype.tryParseUnquoted=function(e,t){if(this.isEOF())return null;var n=this.char();return 60===n||123===n||35===n&&("plural"===t||"selectordinal"===t)||125===n&&e>0?null:(this.bump(),Y(n))},e.prototype.parseArgument=function(e,t){var n=this.clonePosition();if(this.bump(),this.bumpSpace(),this.isEOF())return this.error(i.EXPECT_ARGUMENT_CLOSING_BRACE,L(n,this.clonePosition()));if(125===this.char())return this.bump(),this.error(i.EMPTY_ARGUMENT,L(n,this.clonePosition()));var r=this.parseIdentifierIfPossible().value;if(!r)return this.error(i.MALFORMED_ARGUMENT,L(n,this.clonePosition()));if(this.bumpSpace(),this.isEOF())return this.error(i.EXPECT_ARGUMENT_CLOSING_BRACE,L(n,this.clonePosition()));switch(this.char()){case 125:return this.bump(),{val:{type:a.argument,value:r,location:L(n,this.clonePosition())},err:null};case 44:return this.bump(),this.bumpSpace(),this.isEOF()?this.error(i.EXPECT_ARGUMENT_CLOSING_BRACE,L(n,this.clonePosition())):this.parseArgumentOptions(e,t,r,n);default:return this.error(i.MALFORMED_ARGUMENT,L(n,this.clonePosition()))}},e.prototype.parseIdentifierIfPossible=function(){var e=this.clonePosition(),t=this.offset(),n=X(this.message,t),i=t+n.length;return this.bumpTo(i),{value:n,location:L(e,this.clonePosition())}},e.prototype.parseArgumentOptions=function(e,t,n,s){var u,l=this.clonePosition(),c=this.parseIdentifierIfPossible().value,h=this.clonePosition();switch(c){case"":return this.error(i.EXPECT_ARGUMENT_TYPE,L(l,h));case"number":case"date":case"time":this.bumpSpace();var f=null;if(this.bumpIf(",")){this.bumpSpace();var d=this.clonePosition();if((b=this.parseSimpleArgStyleIfPossible()).err)return b;if(0===(g=Q(b.val)).length)return this.error(i.EXPECT_ARGUMENT_STYLE,L(this.clonePosition(),this.clonePosition()));f={style:g,styleLocation:L(d,this.clonePosition())}}if((T=this.tryParseArgumentClose(s)).err)return T;var p=L(s,this.clonePosition());if(f&&j(null==f?void 0:f.style,"::",0)){var v=q(f.style.slice(2));if("number"===c)return(b=this.parseNumberSkeletonFromString(v,f.styleLocation)).err?b:{val:{type:a.number,value:n,location:p,style:b.val},err:null};if(0===v.length)return this.error(i.EXPECT_DATE_TIME_SKELETON,p);var m=v;this.locale&&(m=function(e,t){for(var n="",i=0;i<e.length;i++){var r=e.charAt(i);if("j"===r){for(var a=0;i+1<e.length&&e.charAt(i+1)===r;)a++,i++;var o=1+(1&a),s=a<2?1:3+(a>>1),u=O(t);for("H"!=u&&"k"!=u||(s=0);s-- >0;)n+="a";for(;o-- >0;)n=u+n}else n+="J"===r?"H":r}return n}(v,this.locale));var g={type:o.dateTime,pattern:m,location:f.styleLocation,parsedOptions:this.shouldParseSkeletons?E(m):{}};return{val:{type:"date"===c?a.date:a.time,value:n,location:p,style:g},err:null}}return{val:{type:"number"===c?a.number:"date"===c?a.date:a.time,value:n,location:p,style:null!==(u=null==f?void 0:f.style)&&void 0!==u?u:null},err:null};case"plural":case"selectordinal":case"select":var _=this.clonePosition();if(this.bumpSpace(),!this.bumpIf(","))return this.error(i.EXPECT_SELECT_ARGUMENT_OPTIONS,L(_,(0,r.pi)({},_)));this.bumpSpace();var y=this.parseIdentifierIfPossible(),A=0;if("select"!==c&&"offset"===y.value){if(!this.bumpIf(":"))return this.error(i.EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE,L(this.clonePosition(),this.clonePosition()));var b;if(this.bumpSpace(),(b=this.tryParseDecimalInteger(i.EXPECT_PLURAL_ARGUMENT_OFFSET_VALUE,i.INVALID_PLURAL_ARGUMENT_OFFSET_VALUE)).err)return b;this.bumpSpace(),y=this.parseIdentifierIfPossible(),A=b.val}var T,M=this.tryParsePluralOrSelectOptions(e,c,t,y);if(M.err)return M;if((T=this.tryParseArgumentClose(s)).err)return T;var S=L(s,this.clonePosition());return"select"===c?{val:{type:a.select,value:n,options:Z(M.val),location:S},err:null}:{val:{type:a.plural,value:n,options:Z(M.val),offset:A,pluralType:"plural"===c?"cardinal":"ordinal",location:S},err:null};default:return this.error(i.INVALID_ARGUMENT_TYPE,L(l,h))}},e.prototype.tryParseArgumentClose=function(e){return this.isEOF()||125!==this.char()?this.error(i.EXPECT_ARGUMENT_CLOSING_BRACE,L(e,this.clonePosition())):(this.bump(),{val:!0,err:null})},e.prototype.parseSimpleArgStyleIfPossible=function(){for(var e=0,t=this.clonePosition();!this.isEOF();){switch(this.char()){case 39:this.bump();var n=this.clonePosition();if(!this.bumpUntil("'"))return this.error(i.UNCLOSED_QUOTE_IN_ARGUMENT_STYLE,L(n,this.clonePosition()));this.bump();break;case 123:e+=1,this.bump();break;case 125:if(!(e>0))return{val:this.message.slice(t.offset,this.offset()),err:null};e-=1;break;default:this.bump()}}return{val:this.message.slice(t.offset,this.offset()),err:null}},e.prototype.parseNumberSkeletonFromString=function(e,t){var n=[];try{n=function(e){if(0===e.length)throw new Error("Number skeleton cannot be empty");for(var t=[],n=0,i=e.split(A).filter((function(e){return e.length>0}));n<i.length;n++){var r=i[n].split("/");if(0===r.length)throw new Error("Invalid number skeleton");for(var a=r[0],o=r.slice(1),s=0,u=o;s<u.length;s++)if(0===u[s].length)throw new Error("Invalid number skeleton");t.push({stem:a,options:o})}return t}(e)}catch(r){return this.error(i.INVALID_NUMBER_SKELETON,t)}return{val:{type:o.number,tokens:n,location:t,parsedOptions:this.shouldParseSkeletons?D(n):{}},err:null}},e.prototype.tryParsePluralOrSelectOptions=function(e,t,n,r){for(var a,o=!1,s=[],u=new Set,l=r.value,c=r.location;;){if(0===l.length){var h=this.clonePosition();if("select"===t||!this.bumpIf("="))break;var f=this.tryParseDecimalInteger(i.EXPECT_PLURAL_ARGUMENT_SELECTOR,i.INVALID_PLURAL_ARGUMENT_SELECTOR);if(f.err)return f;c=L(h,this.clonePosition()),l=this.message.slice(h.offset,this.offset())}if(u.has(l))return this.error("select"===t?i.DUPLICATE_SELECT_ARGUMENT_SELECTOR:i.DUPLICATE_PLURAL_ARGUMENT_SELECTOR,c);"other"===l&&(o=!0),this.bumpSpace();var d=this.clonePosition();if(!this.bumpIf("{"))return this.error("select"===t?i.EXPECT_SELECT_ARGUMENT_SELECTOR_FRAGMENT:i.EXPECT_PLURAL_ARGUMENT_SELECTOR_FRAGMENT,L(this.clonePosition(),this.clonePosition()));var p=this.parseMessage(e+1,t,n);if(p.err)return p;var v=this.tryParseArgumentClose(d);if(v.err)return v;s.push([l,{value:p.val,location:L(d,this.clonePosition())}]),u.add(l),this.bumpSpace(),l=(a=this.parseIdentifierIfPossible()).value,c=a.location}return 0===s.length?this.error("select"===t?i.EXPECT_SELECT_ARGUMENT_SELECTOR:i.EXPECT_PLURAL_ARGUMENT_SELECTOR,L(this.clonePosition(),this.clonePosition())):this.requiresOtherClause&&!o?this.error(i.MISSING_OTHER_CLAUSE,L(this.clonePosition(),this.clonePosition())):{val:s,err:null}},e.prototype.tryParseDecimalInteger=function(e,t){var n=1,i=this.clonePosition();this.bumpIf("+")||this.bumpIf("-")&&(n=-1);for(var r=!1,a=0;!this.isEOF();){var o=this.char();if(!(o>=48&&o<=57))break;r=!0,a=10*a+(o-48),this.bump()}var s=L(i,this.clonePosition());return r?W(a*=n)?{val:a,err:null}:this.error(t,s):this.error(e,s)},e.prototype.offset=function(){return this.position.offset},e.prototype.isEOF=function(){return this.offset()===this.message.length},e.prototype.clonePosition=function(){return{offset:this.position.offset,line:this.position.line,column:this.position.column}},e.prototype.char=function(){var e=this.position.offset;if(e>=this.message.length)throw Error("out of bound");var t=K(this.message,e);if(void 0===t)throw Error("Offset ".concat(e," is at invalid UTF-16 code unit boundary"));return t},e.prototype.error=function(e,t){return{val:null,err:{kind:e,message:this.message,location:t}}},e.prototype.bump=function(){if(!this.isEOF()){var e=this.char();10===e?(this.position.line+=1,this.position.column=1,this.position.offset+=1):(this.position.column+=1,this.position.offset+=e<65536?1:2)}},e.prototype.bumpIf=function(e){if(j(this.message,e,this.offset())){for(var t=0;t<e.length;t++)this.bump();return!0}return!1},e.prototype.bumpUntil=function(e){var t=this.offset(),n=this.message.indexOf(e,t);return n>=0?(this.bumpTo(n),!0):(this.bumpTo(this.message.length),!1)},e.prototype.bumpTo=function(e){if(this.offset()>e)throw Error("targetOffset ".concat(e," must be greater than or equal to the current offset ").concat(this.offset()));for(e=Math.min(e,this.message.length);;){var t=this.offset();if(t===e)break;if(t>e)throw Error("targetOffset ".concat(e," is at invalid UTF-16 code unit boundary"));if(this.bump(),this.isEOF())break}},e.prototype.bumpSpace=function(){for(;!this.isEOF()&&ne(this.char());)this.bump()},e.prototype.peek=function(){if(this.isEOF())return null;var e=this.char(),t=this.offset(),n=this.message.charCodeAt(t+(e>=65536?2:1));return null!=n?n:null},e}();function te(e){return e>=97&&e<=122||e>=65&&e<=90}function ne(e){return e>=9&&e<=13||32===e||133===e||e>=8206&&e<=8207||8232===e||8233===e}function ie(e){return e>=33&&e<=35||36===e||e>=37&&e<=39||40===e||41===e||42===e||43===e||44===e||45===e||e>=46&&e<=47||e>=58&&e<=59||e>=60&&e<=62||e>=63&&e<=64||91===e||92===e||93===e||94===e||96===e||123===e||124===e||125===e||126===e||161===e||e>=162&&e<=165||166===e||167===e||169===e||171===e||172===e||174===e||176===e||177===e||182===e||187===e||191===e||215===e||247===e||e>=8208&&e<=8213||e>=8214&&e<=8215||8216===e||8217===e||8218===e||e>=8219&&e<=8220||8221===e||8222===e||8223===e||e>=8224&&e<=8231||e>=8240&&e<=8248||8249===e||8250===e||e>=8251&&e<=8254||e>=8257&&e<=8259||8260===e||8261===e||8262===e||e>=8263&&e<=8273||8274===e||8275===e||e>=8277&&e<=8286||e>=8592&&e<=8596||e>=8597&&e<=8601||e>=8602&&e<=8603||e>=8604&&e<=8607||8608===e||e>=8609&&e<=8610||8611===e||e>=8612&&e<=8613||8614===e||e>=8615&&e<=8621||8622===e||e>=8623&&e<=8653||e>=8654&&e<=8655||e>=8656&&e<=8657||8658===e||8659===e||8660===e||e>=8661&&e<=8691||e>=8692&&e<=8959||e>=8960&&e<=8967||8968===e||8969===e||8970===e||8971===e||e>=8972&&e<=8991||e>=8992&&e<=8993||e>=8994&&e<=9e3||9001===e||9002===e||e>=9003&&e<=9083||9084===e||e>=9085&&e<=9114||e>=9115&&e<=9139||e>=9140&&e<=9179||e>=9180&&e<=9185||e>=9186&&e<=9254||e>=9255&&e<=9279||e>=9280&&e<=9290||e>=9291&&e<=9311||e>=9472&&e<=9654||9655===e||e>=9656&&e<=9664||9665===e||e>=9666&&e<=9719||e>=9720&&e<=9727||e>=9728&&e<=9838||9839===e||e>=9840&&e<=10087||10088===e||10089===e||10090===e||10091===e||10092===e||10093===e||10094===e||10095===e||10096===e||10097===e||10098===e||10099===e||10100===e||10101===e||e>=10132&&e<=10175||e>=10176&&e<=10180||10181===e||10182===e||e>=10183&&e<=10213||10214===e||10215===e||10216===e||10217===e||10218===e||10219===e||10220===e||10221===e||10222===e||10223===e||e>=10224&&e<=10239||e>=10240&&e<=10495||e>=10496&&e<=10626||10627===e||10628===e||10629===e||10630===e||10631===e||10632===e||10633===e||10634===e||10635===e||10636===e||10637===e||10638===e||10639===e||10640===e||10641===e||10642===e||10643===e||10644===e||10645===e||10646===e||10647===e||10648===e||e>=10649&&e<=10711||10712===e||10713===e||10714===e||10715===e||e>=10716&&e<=10747||10748===e||10749===e||e>=10750&&e<=11007||e>=11008&&e<=11055||e>=11056&&e<=11076||e>=11077&&e<=11078||e>=11079&&e<=11084||e>=11085&&e<=11123||e>=11124&&e<=11125||e>=11126&&e<=11157||11158===e||e>=11159&&e<=11263||e>=11776&&e<=11777||11778===e||11779===e||11780===e||11781===e||e>=11782&&e<=11784||11785===e||11786===e||11787===e||11788===e||11789===e||e>=11790&&e<=11798||11799===e||e>=11800&&e<=11801||11802===e||11803===e||11804===e||11805===e||e>=11806&&e<=11807||11808===e||11809===e||11810===e||11811===e||11812===e||11813===e||11814===e||11815===e||11816===e||11817===e||e>=11818&&e<=11822||11823===e||e>=11824&&e<=11833||e>=11834&&e<=11835||e>=11836&&e<=11839||11840===e||11841===e||11842===e||e>=11843&&e<=11855||e>=11856&&e<=11857||11858===e||e>=11859&&e<=11903||e>=12289&&e<=12291||12296===e||12297===e||12298===e||12299===e||12300===e||12301===e||12302===e||12303===e||12304===e||12305===e||e>=12306&&e<=12307||12308===e||12309===e||12310===e||12311===e||12312===e||12313===e||12314===e||12315===e||12316===e||12317===e||e>=12318&&e<=12319||12320===e||12336===e||64830===e||64831===e||e>=65093&&e<=65094}function re(e){e.forEach((function(e){if(delete e.location,f(e)||d(e))for(var t in e.options)delete e.options[t].location,re(e.options[t].value);else l(e)&&m(e.style)||(c(e)||h(e))&&g(e.style)?delete e.style.location:v(e)&&re(e.children)}))}function ae(e,t){void 0===t&&(t={}),t=(0,r.pi)({shouldParseSkeletons:!0,requiresOtherClause:!0},t);var n=new ee(e,t).parse();if(n.err){var a=SyntaxError(i[n.err.kind]);throw a.location=n.err.location,a.originalMessage=n.err.message,a}return(null==t?void 0:t.captureLocation)||re(n.val),n.val}},4889:function(e,t,n){"use strict";n.d(t,{$6:function(){return h},OV:function(){return s},Qe:function(){return l},Rw:function(){return a},X9:function(){return c},bc:function(){return i},gb:function(){return u},wI:function(){return o}});var i,r=n(9900);!function(e){e.FORMAT_ERROR="FORMAT_ERROR",e.UNSUPPORTED_FORMATTER="UNSUPPORTED_FORMATTER",e.INVALID_CONFIG="INVALID_CONFIG",e.MISSING_DATA="MISSING_DATA",e.MISSING_TRANSLATION="MISSING_TRANSLATION"}(i||(i={}));var a=function(e){function t(n,i,r){var a=this,o=r?r instanceof Error?r:new Error(String(r)):void 0;return(a=e.call(this,"[@formatjs/intl Error ".concat(n,"] ").concat(i,"\n").concat(o?"\n".concat(o.message,"\n").concat(o.stack):""))||this).code=n,"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(a,t),a}return(0,r.ZT)(t,e),t}(Error),o=function(e){function t(t,n){return e.call(this,i.UNSUPPORTED_FORMATTER,t,n)||this}return(0,r.ZT)(t,e),t}(a),s=function(e){function t(t,n){return e.call(this,i.INVALID_CONFIG,t,n)||this}return(0,r.ZT)(t,e),t}(a),u=function(e){function t(t,n){return e.call(this,i.MISSING_DATA,t,n)||this}return(0,r.ZT)(t,e),t}(a),l=function(e){function t(t,n,r){return e.call(this,i.FORMAT_ERROR,"".concat(t,"\nLocale: ").concat(n,"\n"),r)||this}return(0,r.ZT)(t,e),t}(a),c=function(e){function t(t,n,i,r){var a=e.call(this,"".concat(t,"\nMessageID: ").concat(null==i?void 0:i.id,"\nDefault Message: ").concat(null==i?void 0:i.defaultMessage,"\nDescription: ").concat(null==i?void 0:i.description,"\n"),n,r)||this;return a.descriptor=i,a}return(0,r.ZT)(t,e),t}(l),h=function(e){function t(t,n){var r=e.call(this,i.MISSING_TRANSLATION,'Missing message: "'.concat(t.id,'" for locale "').concat(n,'", using ').concat(t.defaultMessage?"default message (".concat("string"==typeof t.defaultMessage?t.defaultMessage:t.defaultMessage.map((function(e){var t;return null!==(t=e.value)&&void 0!==t?t:JSON.stringify(e)})).join(),")"):"id"," as fallback."))||this;return r.descriptor=t,r}return(0,r.ZT)(t,e),t}(a)},7143:function(e,t,n){"use strict";n.d(t,{L6:function(){return s},Sn:function(){return l},TB:function(){return f},Z0:function(){return u},ax:function(){return h}});var i=n(9900),r=n(1482),a=n(289),o=n(4889);function s(e,t,n){return void 0===n&&(n={}),t.reduce((function(t,i){return i in e?t[i]=e[i]:i in n&&(t[i]=n[i]),t}),{})}var u={formats:{},messages:{},timeZone:void 0,defaultLocale:"en",defaultFormats:{},fallbackOnEmptyString:!0,onError:function(e){0},onWarn:function(e){0}};function l(){return{dateTime:{},number:{},message:{},relativeTime:{},pluralRules:{},list:{},displayNames:{}}}function c(e){return{create:function(){return{get:function(t){return e[t]},set:function(t,n){e[t]=n}}}}}function h(e){void 0===e&&(e={dateTime:{},number:{},message:{},relativeTime:{},pluralRules:{},list:{},displayNames:{}});var t=Intl.RelativeTimeFormat,n=Intl.ListFormat,o=Intl.DisplayNames,s=(0,a.Z)((function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return new((e=Intl.DateTimeFormat).bind.apply(e,(0,i.ev)([void 0],t,!1)))}),{cache:c(e.dateTime),strategy:a.A.variadic}),u=(0,a.Z)((function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return new((e=Intl.NumberFormat).bind.apply(e,(0,i.ev)([void 0],t,!1)))}),{cache:c(e.number),strategy:a.A.variadic}),l=(0,a.Z)((function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return new((e=Intl.PluralRules).bind.apply(e,(0,i.ev)([void 0],t,!1)))}),{cache:c(e.pluralRules),strategy:a.A.variadic});return{getDateTimeFormat:s,getNumberFormat:u,getMessageFormat:(0,a.Z)((function(e,t,n,a){return new r.C(e,t,n,(0,i.pi)({formatters:{getNumberFormat:u,getDateTimeFormat:s,getPluralRules:l}},a||{}))}),{cache:c(e.message),strategy:a.A.variadic}),getRelativeTimeFormat:(0,a.Z)((function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return new(t.bind.apply(t,(0,i.ev)([void 0],e,!1)))}),{cache:c(e.relativeTime),strategy:a.A.variadic}),getPluralRules:l,getListFormat:(0,a.Z)((function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new(n.bind.apply(n,(0,i.ev)([void 0],e,!1)))}),{cache:c(e.list),strategy:a.A.variadic}),getDisplayNames:(0,a.Z)((function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new(o.bind.apply(o,(0,i.ev)([void 0],e,!1)))}),{cache:c(e.displayNames),strategy:a.A.variadic})}}function f(e,t,n,i){var r,a=e&&e[t];if(a&&(r=a[n]),r)return r;i(new o.wI("No ".concat(t," format named: ").concat(n)))}},5900:function(e,t){var n;!function(){"use strict";var i={}.hasOwnProperty;function r(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var a=typeof n;if("string"===a||"number"===a)e.push(n);else if(Array.isArray(n)){if(n.length){var o=r.apply(null,n);o&&e.push(o)}}else if("object"===a){if(n.toString!==Object.prototype.toString&&!n.toString.toString().includes("[native code]")){e.push(n.toString());continue}for(var s in n)i.call(n,s)&&n[s]&&e.push(s)}}}return e.join(" ")}e.exports?(r.default=r,e.exports=r):void 0===(n=function(){return r}.apply(t,[]))||(e.exports=n)}()},5706:function(e,t,n){"use strict";var i=n(8812),r={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},a={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},o={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},s={};function u(e){return i.isMemo(e)?o:s[e.$$typeof]||r}s[i.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},s[i.Memo]=o;var l=Object.defineProperty,c=Object.getOwnPropertyNames,h=Object.getOwnPropertySymbols,f=Object.getOwnPropertyDescriptor,d=Object.getPrototypeOf,p=Object.prototype;e.exports=function e(t,n,i){if("string"!=typeof n){if(p){var r=d(n);r&&r!==p&&e(t,r,i)}var o=c(n);h&&(o=o.concat(h(n)));for(var s=u(t),v=u(n),m=0;m<o.length;++m){var g=o[m];if(!(a[g]||i&&i[g]||v&&v[g]||s&&s[g])){var _=f(n,g);try{l(t,g,_)}catch(y){}}}}return t}},1482:function(e,t,n){"use strict";n.d(t,{C:function(){return l}});var i=n(9900),r=n(7959),a=n(289),o=n(4597);function s(e,t){return t?Object.keys(e).reduce((function(n,r){var a,o;return n[r]=(a=e[r],(o=t[r])?(0,i.pi)((0,i.pi)((0,i.pi)({},a||{}),o||{}),Object.keys(a).reduce((function(e,t){return e[t]=(0,i.pi)((0,i.pi)({},a[t]),o[t]||{}),e}),{})):a),n}),(0,i.pi)({},e)):e}function u(e){return{create:function(){return{get:function(t){return e[t]},set:function(t,n){e[t]=n}}}}}var l=function(){function e(t,n,r,l){void 0===n&&(n=e.defaultLocale);var c,h=this;if(this.formatterCache={number:{},dateTime:{},pluralRules:{}},this.format=function(e){var t=h.formatToParts(e);if(1===t.length)return t[0].value;var n=t.reduce((function(e,t){return e.length&&t.type===o.du.literal&&"string"==typeof e[e.length-1]?e[e.length-1]+=t.value:e.push(t.value),e}),[]);return n.length<=1?n[0]||"":n},this.formatToParts=function(e){return(0,o.FK)(h.ast,h.locales,h.formatters,h.formats,e,void 0,h.message)},this.resolvedOptions=function(){var e;return{locale:(null===(e=h.resolvedLocale)||void 0===e?void 0:e.toString())||Intl.NumberFormat.supportedLocalesOf(h.locales)[0]}},this.getAst=function(){return h.ast},this.locales=n,this.resolvedLocale=e.resolveLocale(n),"string"==typeof t){if(this.message=t,!e.__parse)throw new TypeError("IntlMessageFormat.__parse must be set to process `message` of type `string`");this.ast=e.__parse(t,{ignoreTag:null==l?void 0:l.ignoreTag,locale:this.resolvedLocale})}else this.ast=t;if(!Array.isArray(this.ast))throw new TypeError("A message must be provided as a String or AST.");this.formats=s(e.formats,r),this.formatters=l&&l.formatters||(void 0===(c=this.formatterCache)&&(c={number:{},dateTime:{},pluralRules:{}}),{getNumberFormat:(0,a.Z)((function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return new((e=Intl.NumberFormat).bind.apply(e,(0,i.ev)([void 0],t,!1)))}),{cache:u(c.number),strategy:a.A.variadic}),getDateTimeFormat:(0,a.Z)((function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return new((e=Intl.DateTimeFormat).bind.apply(e,(0,i.ev)([void 0],t,!1)))}),{cache:u(c.dateTime),strategy:a.A.variadic}),getPluralRules:(0,a.Z)((function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return new((e=Intl.PluralRules).bind.apply(e,(0,i.ev)([void 0],t,!1)))}),{cache:u(c.pluralRules),strategy:a.A.variadic})})}return Object.defineProperty(e,"defaultLocale",{get:function(){return e.memoizedDefaultLocale||(e.memoizedDefaultLocale=(new Intl.NumberFormat).resolvedOptions().locale),e.memoizedDefaultLocale},enumerable:!1,configurable:!0}),e.memoizedDefaultLocale=null,e.resolveLocale=function(e){if(void 0!==Intl.Locale){var t=Intl.NumberFormat.supportedLocalesOf(e);return t.length>0?new Intl.Locale(t[0]):new Intl.Locale("string"==typeof e?e:e[0])}},e.__parse=r.Qc,e.formats={number:{integer:{maximumFractionDigits:0},currency:{style:"currency"},percent:{style:"percent"}},date:{short:{month:"numeric",day:"numeric",year:"2-digit"},medium:{month:"short",day:"numeric",year:"numeric"},long:{month:"long",day:"numeric",year:"numeric"},full:{weekday:"long",month:"long",day:"numeric",year:"numeric"}},time:{short:{hour:"numeric",minute:"numeric"},medium:{hour:"numeric",minute:"numeric",second:"numeric"},long:{hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"},full:{hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"}}},e}()},8402:function(e,t,n){"use strict";n.d(t,{C8:function(){return o},HR:function(){return u},YR:function(){return s},jK:function(){return i},u_:function(){return a}});var i,r=n(9900);!function(e){e.MISSING_VALUE="MISSING_VALUE",e.INVALID_VALUE="INVALID_VALUE",e.MISSING_INTL_API="MISSING_INTL_API"}(i||(i={}));var a=function(e){function t(t,n,i){var r=e.call(this,t)||this;return r.code=n,r.originalMessage=i,r}return(0,r.ZT)(t,e),t.prototype.toString=function(){return"[formatjs Error: ".concat(this.code,"] ").concat(this.message)},t}(Error),o=function(e){function t(t,n,r,a){return e.call(this,'Invalid values for "'.concat(t,'": "').concat(n,'". Options are "').concat(Object.keys(r).join('", "'),'"'),i.INVALID_VALUE,a)||this}return(0,r.ZT)(t,e),t}(a),s=function(e){function t(t,n,r){return e.call(this,'Value for "'.concat(t,'" must be of type ').concat(n),i.INVALID_VALUE,r)||this}return(0,r.ZT)(t,e),t}(a),u=function(e){function t(t,n){return e.call(this,'The intl string context variable "'.concat(t,'" was not provided to the string "').concat(n,'"'),i.MISSING_VALUE,n)||this}return(0,r.ZT)(t,e),t}(a)},4597:function(e,t,n){"use strict";n.d(t,{FK:function(){return s},Gt:function(){return o},du:function(){return i}});var i,r=n(7959),a=n(8402);function o(e){return"function"==typeof e}function s(e,t,n,u,l,c,h){if(1===e.length&&(0,r.O4)(e[0]))return[{type:i.literal,value:e[0].value}];for(var f=[],d=0,p=e;d<p.length;d++){var v=p[d];if((0,r.O4)(v))f.push({type:i.literal,value:v.value});else if((0,r.yx)(v))"number"==typeof c&&f.push({type:i.literal,value:n.getNumberFormat(t).format(c)});else{var m=v.value;if(!l||!(m in l))throw new a.HR(m,h);var g=l[m];if((0,r.VG)(v))g&&"string"!=typeof g&&"number"!=typeof g||(g="string"==typeof g||"number"==typeof g?String(g):""),f.push({type:"string"==typeof g?i.literal:i.object,value:g});else if((0,r.rp)(v)){var _="string"==typeof v.style?u.date[v.style]:(0,r.Ii)(v.style)?v.style.parsedOptions:void 0;f.push({type:i.literal,value:n.getDateTimeFormat(t,_).format(g)})}else if((0,r.pe)(v)){_="string"==typeof v.style?u.time[v.style]:(0,r.Ii)(v.style)?v.style.parsedOptions:u.time.medium;f.push({type:i.literal,value:n.getDateTimeFormat(t,_).format(g)})}else if((0,r.uf)(v)){(_="string"==typeof v.style?u.number[v.style]:(0,r.Wh)(v.style)?v.style.parsedOptions:void 0)&&_.scale&&(g*=_.scale||1),f.push({type:i.literal,value:n.getNumberFormat(t,_).format(g)})}else{if((0,r.HI)(v)){var y=v.children,E=v.value,A=l[E];if(!o(A))throw new a.YR(E,"function",h);var b=A(s(y,t,n,u,l,c).map((function(e){return e.value})));Array.isArray(b)||(b=[b]),f.push.apply(f,b.map((function(e){return{type:"string"==typeof e?i.literal:i.object,value:e}})))}if((0,r.Wi)(v)){if(!(T=v.options[g]||v.options.other))throw new a.C8(v.value,g,Object.keys(v.options),h);f.push.apply(f,s(T.value,t,n,u,l))}else if((0,r.Jo)(v)){var T;if(!(T=v.options["=".concat(g)])){if(!Intl.PluralRules)throw new a.u_('Intl.PluralRules is not available in this environment.\nTry polyfilling it using "@formatjs/intl-pluralrules"\n',a.jK.MISSING_INTL_API,h);var M=n.getPluralRules(t,{type:v.pluralType}).select(g-(v.offset||0));T=v.options[M]||v.options.other}if(!T)throw new a.C8(v.value,g,Object.keys(v.options),h);f.push.apply(f,s(T.value,t,n,u,l,g-(v.offset||0)))}else;}}}return function(e){return e.length<2?e:e.reduce((function(e,t){var n=e[e.length-1];return n&&n.type===i.literal&&t.type===i.literal?n.value+=t.value:e.push(t),e}),[])}(f)}!function(e){e[e.literal=0]="literal",e[e.object=1]="object"}(i||(i={}))},3964:function(e,t,n){(e=n.nmd(e)).exports=function(){"use strict";var t,n;function i(){return t.apply(null,arguments)}function r(e){t=e}function a(e){return e instanceof Array||"[object Array]"===Object.prototype.toString.call(e)}function o(e){return null!=e&&"[object Object]"===Object.prototype.toString.call(e)}function s(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function u(e){if(Object.getOwnPropertyNames)return 0===Object.getOwnPropertyNames(e).length;var t;for(t in e)if(s(e,t))return!1;return!0}function l(e){return void 0===e}function c(e){return"number"==typeof e||"[object Number]"===Object.prototype.toString.call(e)}function h(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}function f(e,t){var n,i=[],r=e.length;for(n=0;n<r;++n)i.push(t(e[n],n));return i}function d(e,t){for(var n in t)s(t,n)&&(e[n]=t[n]);return s(t,"toString")&&(e.toString=t.toString),s(t,"valueOf")&&(e.valueOf=t.valueOf),e}function p(e,t,n,i){return Zn(e,t,n,i,!0).utc()}function v(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function m(e){return null==e._pf&&(e._pf=v()),e._pf}function g(e){if(null==e._isValid){var t=m(e),i=n.call(t.parsedDateParts,(function(e){return null!=e})),r=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidEra&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&i);if(e._strict&&(r=r&&0===t.charsLeftOver&&0===t.unusedTokens.length&&void 0===t.bigHour),null!=Object.isFrozen&&Object.isFrozen(e))return r;e._isValid=r}return e._isValid}function _(e){var t=p(NaN);return null!=e?d(m(t),e):m(t).userInvalidated=!0,t}n=Array.prototype.some?Array.prototype.some:function(e){var t,n=Object(this),i=n.length>>>0;for(t=0;t<i;t++)if(t in n&&e.call(this,n[t],t,n))return!0;return!1};var y=i.momentProperties=[],E=!1;function A(e,t){var n,i,r,a=y.length;if(l(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),l(t._i)||(e._i=t._i),l(t._f)||(e._f=t._f),l(t._l)||(e._l=t._l),l(t._strict)||(e._strict=t._strict),l(t._tzm)||(e._tzm=t._tzm),l(t._isUTC)||(e._isUTC=t._isUTC),l(t._offset)||(e._offset=t._offset),l(t._pf)||(e._pf=m(t)),l(t._locale)||(e._locale=t._locale),a>0)for(n=0;n<a;n++)l(r=t[i=y[n]])||(e[i]=r);return e}function b(e){A(this,e),this._d=new Date(null!=e._d?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===E&&(E=!0,i.updateOffset(this),E=!1)}function T(e){return e instanceof b||null!=e&&null!=e._isAMomentObject}function M(e){!1===i.suppressDeprecationWarnings&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+e)}function S(e,t){var n=!0;return d((function(){if(null!=i.deprecationHandler&&i.deprecationHandler(null,e),n){var r,a,o,u=[],l=arguments.length;for(a=0;a<l;a++){if(r="","object"==typeof arguments[a]){for(o in r+="\n["+a+"] ",arguments[0])s(arguments[0],o)&&(r+=o+": "+arguments[0][o]+", ");r=r.slice(0,-2)}else r=arguments[a];u.push(r)}M(e+"\nArguments: "+Array.prototype.slice.call(u).join("")+"\n"+(new Error).stack),n=!1}return t.apply(this,arguments)}),t)}var I,x={};function C(e,t){null!=i.deprecationHandler&&i.deprecationHandler(e,t),x[e]||(M(t),x[e]=!0)}function P(e){return"undefined"!=typeof Function&&e instanceof Function||"[object Function]"===Object.prototype.toString.call(e)}function D(e){var t,n;for(n in e)s(e,n)&&(P(t=e[n])?this[n]=t:this["_"+n]=t);this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function R(e,t){var n,i=d({},e);for(n in t)s(t,n)&&(o(e[n])&&o(t[n])?(i[n]={},d(i[n],e[n]),d(i[n],t[n])):null!=t[n]?i[n]=t[n]:delete i[n]);for(n in e)s(e,n)&&!s(t,n)&&o(e[n])&&(i[n]=d({},i[n]));return i}function k(e){null!=e&&this.set(e)}i.suppressDeprecationWarnings=!1,i.deprecationHandler=null,I=Object.keys?Object.keys:function(e){var t,n=[];for(t in e)s(e,t)&&n.push(t);return n};var O={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function N(e,t,n){var i=this._calendar[e]||this._calendar.sameElse;return P(i)?i.call(t,n):i}function w(e,t,n){var i=""+Math.abs(e),r=t-i.length;return(e>=0?n?"+":"":"-")+Math.pow(10,Math.max(0,r)).toString().substr(1)+i}var L=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,F=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,B={},U={};function V(e,t,n,i){var r=i;"string"==typeof i&&(r=function(){return this[i]()}),e&&(U[e]=r),t&&(U[t[0]]=function(){return w(r.apply(this,arguments),t[1],t[2])}),n&&(U[n]=function(){return this.localeData().ordinal(r.apply(this,arguments),e)})}function G(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function z(e){var t,n,i=e.match(L);for(t=0,n=i.length;t<n;t++)U[i[t]]?i[t]=U[i[t]]:i[t]=G(i[t]);return function(t){var r,a="";for(r=0;r<n;r++)a+=P(i[r])?i[r].call(t,e):i[r];return a}}function W(e,t){return e.isValid()?(t=H(t,e.localeData()),B[t]=B[t]||z(t),B[t](e)):e.localeData().invalidDate()}function H(e,t){var n=5;function i(e){return t.longDateFormat(e)||e}for(F.lastIndex=0;n>=0&&F.test(e);)e=e.replace(F,i),F.lastIndex=0,n-=1;return e}var X={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function j(e){var t=this._longDateFormat[e],n=this._longDateFormat[e.toUpperCase()];return t||!n?t:(this._longDateFormat[e]=n.match(L).map((function(e){return"MMMM"===e||"MM"===e||"DD"===e||"dddd"===e?e.slice(1):e})).join(""),this._longDateFormat[e])}var Y="Invalid date";function Z(){return this._invalidDate}var K="%d",q=/\d{1,2}/;function Q(e){return this._ordinal.replace("%d",e)}var $={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function J(e,t,n,i){var r=this._relativeTime[n];return P(r)?r(e,t,n,i):r.replace(/%d/i,e)}function ee(e,t){var n=this._relativeTime[e>0?"future":"past"];return P(n)?n(t):n.replace(/%s/i,t)}var te={};function ne(e,t){var n=e.toLowerCase();te[n]=te[n+"s"]=te[t]=e}function ie(e){return"string"==typeof e?te[e]||te[e.toLowerCase()]:void 0}function re(e){var t,n,i={};for(n in e)s(e,n)&&(t=ie(n))&&(i[t]=e[n]);return i}var ae={};function oe(e,t){ae[e]=t}function se(e){var t,n=[];for(t in e)s(e,t)&&n.push({unit:t,priority:ae[t]});return n.sort((function(e,t){return e.priority-t.priority})),n}function ue(e){return e%4==0&&e%100!=0||e%400==0}function le(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function ce(e){var t=+e,n=0;return 0!==t&&isFinite(t)&&(n=le(t)),n}function he(e,t){return function(n){return null!=n?(de(this,e,n),i.updateOffset(this,t),this):fe(this,e)}}function fe(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function de(e,t,n){e.isValid()&&!isNaN(n)&&("FullYear"===t&&ue(e.year())&&1===e.month()&&29===e.date()?(n=ce(n),e._d["set"+(e._isUTC?"UTC":"")+t](n,e.month(),Je(n,e.month()))):e._d["set"+(e._isUTC?"UTC":"")+t](n))}function pe(e){return P(this[e=ie(e)])?this[e]():this}function ve(e,t){if("object"==typeof e){var n,i=se(e=re(e)),r=i.length;for(n=0;n<r;n++)this[i[n].unit](e[i[n].unit])}else if(P(this[e=ie(e)]))return this[e](t);return this}var me,ge=/\d/,_e=/\d\d/,ye=/\d{3}/,Ee=/\d{4}/,Ae=/[+-]?\d{6}/,be=/\d\d?/,Te=/\d\d\d\d?/,Me=/\d\d\d\d\d\d?/,Se=/\d{1,3}/,Ie=/\d{1,4}/,xe=/[+-]?\d{1,6}/,Ce=/\d+/,Pe=/[+-]?\d+/,De=/Z|[+-]\d\d:?\d\d/gi,Re=/Z|[+-]\d\d(?::?\d\d)?/gi,ke=/[+-]?\d+(\.\d{1,3})?/,Oe=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i;function Ne(e,t,n){me[e]=P(t)?t:function(e,i){return e&&n?n:t}}function we(e,t){return s(me,e)?me[e](t._strict,t._locale):new RegExp(Le(e))}function Le(e){return Fe(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,(function(e,t,n,i,r){return t||n||i||r})))}function Fe(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}me={};var Be={};function Ue(e,t){var n,i,r=t;for("string"==typeof e&&(e=[e]),c(t)&&(r=function(e,n){n[t]=ce(e)}),i=e.length,n=0;n<i;n++)Be[e[n]]=r}function Ve(e,t){Ue(e,(function(e,n,i,r){i._w=i._w||{},t(e,i._w,i,r)}))}function Ge(e,t,n){null!=t&&s(Be,e)&&Be[e](t,n._a,n,e)}var ze,We=0,He=1,Xe=2,je=3,Ye=4,Ze=5,Ke=6,qe=7,Qe=8;function $e(e,t){return(e%t+t)%t}function Je(e,t){if(isNaN(e)||isNaN(t))return NaN;var n=$e(t,12);return e+=(t-n)/12,1===n?ue(e)?29:28:31-n%7%2}ze=Array.prototype.indexOf?Array.prototype.indexOf:function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1},V("M",["MM",2],"Mo",(function(){return this.month()+1})),V("MMM",0,0,(function(e){return this.localeData().monthsShort(this,e)})),V("MMMM",0,0,(function(e){return this.localeData().months(this,e)})),ne("month","M"),oe("month",8),Ne("M",be),Ne("MM",be,_e),Ne("MMM",(function(e,t){return t.monthsShortRegex(e)})),Ne("MMMM",(function(e,t){return t.monthsRegex(e)})),Ue(["M","MM"],(function(e,t){t[He]=ce(e)-1})),Ue(["MMM","MMMM"],(function(e,t,n,i){var r=n._locale.monthsParse(e,i,n._strict);null!=r?t[He]=r:m(n).invalidMonth=e}));var et="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),tt="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),nt=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,it=Oe,rt=Oe;function at(e,t){return e?a(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||nt).test(t)?"format":"standalone"][e.month()]:a(this._months)?this._months:this._months.standalone}function ot(e,t){return e?a(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[nt.test(t)?"format":"standalone"][e.month()]:a(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function st(e,t,n){var i,r,a,o=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],i=0;i<12;++i)a=p([2e3,i]),this._shortMonthsParse[i]=this.monthsShort(a,"").toLocaleLowerCase(),this._longMonthsParse[i]=this.months(a,"").toLocaleLowerCase();return n?"MMM"===t?-1!==(r=ze.call(this._shortMonthsParse,o))?r:null:-1!==(r=ze.call(this._longMonthsParse,o))?r:null:"MMM"===t?-1!==(r=ze.call(this._shortMonthsParse,o))||-1!==(r=ze.call(this._longMonthsParse,o))?r:null:-1!==(r=ze.call(this._longMonthsParse,o))||-1!==(r=ze.call(this._shortMonthsParse,o))?r:null}function ut(e,t,n){var i,r,a;if(this._monthsParseExact)return st.call(this,e,t,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),i=0;i<12;i++){if(r=p([2e3,i]),n&&!this._longMonthsParse[i]&&(this._longMonthsParse[i]=new RegExp("^"+this.months(r,"").replace(".","")+"$","i"),this._shortMonthsParse[i]=new RegExp("^"+this.monthsShort(r,"").replace(".","")+"$","i")),n||this._monthsParse[i]||(a="^"+this.months(r,"")+"|^"+this.monthsShort(r,""),this._monthsParse[i]=new RegExp(a.replace(".",""),"i")),n&&"MMMM"===t&&this._longMonthsParse[i].test(e))return i;if(n&&"MMM"===t&&this._shortMonthsParse[i].test(e))return i;if(!n&&this._monthsParse[i].test(e))return i}}function lt(e,t){var n;if(!e.isValid())return e;if("string"==typeof t)if(/^\d+$/.test(t))t=ce(t);else if(!c(t=e.localeData().monthsParse(t)))return e;return n=Math.min(e.date(),Je(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,n),e}function ct(e){return null!=e?(lt(this,e),i.updateOffset(this,!0),this):fe(this,"Month")}function ht(){return Je(this.year(),this.month())}function ft(e){return this._monthsParseExact?(s(this,"_monthsRegex")||pt.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(s(this,"_monthsShortRegex")||(this._monthsShortRegex=it),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)}function dt(e){return this._monthsParseExact?(s(this,"_monthsRegex")||pt.call(this),e?this._monthsStrictRegex:this._monthsRegex):(s(this,"_monthsRegex")||(this._monthsRegex=rt),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)}function pt(){function e(e,t){return t.length-e.length}var t,n,i=[],r=[],a=[];for(t=0;t<12;t++)n=p([2e3,t]),i.push(this.monthsShort(n,"")),r.push(this.months(n,"")),a.push(this.months(n,"")),a.push(this.monthsShort(n,""));for(i.sort(e),r.sort(e),a.sort(e),t=0;t<12;t++)i[t]=Fe(i[t]),r[t]=Fe(r[t]);for(t=0;t<24;t++)a[t]=Fe(a[t]);this._monthsRegex=new RegExp("^("+a.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+i.join("|")+")","i")}function vt(e){return ue(e)?366:365}V("Y",0,0,(function(){var e=this.year();return e<=9999?w(e,4):"+"+e})),V(0,["YY",2],0,(function(){return this.year()%100})),V(0,["YYYY",4],0,"year"),V(0,["YYYYY",5],0,"year"),V(0,["YYYYYY",6,!0],0,"year"),ne("year","y"),oe("year",1),Ne("Y",Pe),Ne("YY",be,_e),Ne("YYYY",Ie,Ee),Ne("YYYYY",xe,Ae),Ne("YYYYYY",xe,Ae),Ue(["YYYYY","YYYYYY"],We),Ue("YYYY",(function(e,t){t[We]=2===e.length?i.parseTwoDigitYear(e):ce(e)})),Ue("YY",(function(e,t){t[We]=i.parseTwoDigitYear(e)})),Ue("Y",(function(e,t){t[We]=parseInt(e,10)})),i.parseTwoDigitYear=function(e){return ce(e)+(ce(e)>68?1900:2e3)};var mt=he("FullYear",!0);function gt(){return ue(this.year())}function _t(e,t,n,i,r,a,o){var s;return e<100&&e>=0?(s=new Date(e+400,t,n,i,r,a,o),isFinite(s.getFullYear())&&s.setFullYear(e)):s=new Date(e,t,n,i,r,a,o),s}function yt(e){var t,n;return e<100&&e>=0?((n=Array.prototype.slice.call(arguments))[0]=e+400,t=new Date(Date.UTC.apply(null,n)),isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e)):t=new Date(Date.UTC.apply(null,arguments)),t}function Et(e,t,n){var i=7+t-n;return-(7+yt(e,0,i).getUTCDay()-t)%7+i-1}function At(e,t,n,i,r){var a,o,s=1+7*(t-1)+(7+n-i)%7+Et(e,i,r);return s<=0?o=vt(a=e-1)+s:s>vt(e)?(a=e+1,o=s-vt(e)):(a=e,o=s),{year:a,dayOfYear:o}}function bt(e,t,n){var i,r,a=Et(e.year(),t,n),o=Math.floor((e.dayOfYear()-a-1)/7)+1;return o<1?i=o+Tt(r=e.year()-1,t,n):o>Tt(e.year(),t,n)?(i=o-Tt(e.year(),t,n),r=e.year()+1):(r=e.year(),i=o),{week:i,year:r}}function Tt(e,t,n){var i=Et(e,t,n),r=Et(e+1,t,n);return(vt(e)-i+r)/7}function Mt(e){return bt(e,this._week.dow,this._week.doy).week}V("w",["ww",2],"wo","week"),V("W",["WW",2],"Wo","isoWeek"),ne("week","w"),ne("isoWeek","W"),oe("week",5),oe("isoWeek",5),Ne("w",be),Ne("ww",be,_e),Ne("W",be),Ne("WW",be,_e),Ve(["w","ww","W","WW"],(function(e,t,n,i){t[i.substr(0,1)]=ce(e)}));var St={dow:0,doy:6};function It(){return this._week.dow}function xt(){return this._week.doy}function Ct(e){var t=this.localeData().week(this);return null==e?t:this.add(7*(e-t),"d")}function Pt(e){var t=bt(this,1,4).week;return null==e?t:this.add(7*(e-t),"d")}function Dt(e,t){return"string"!=typeof e?e:isNaN(e)?"number"==typeof(e=t.weekdaysParse(e))?e:null:parseInt(e,10)}function Rt(e,t){return"string"==typeof e?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}function kt(e,t){return e.slice(t,7).concat(e.slice(0,t))}V("d",0,"do","day"),V("dd",0,0,(function(e){return this.localeData().weekdaysMin(this,e)})),V("ddd",0,0,(function(e){return this.localeData().weekdaysShort(this,e)})),V("dddd",0,0,(function(e){return this.localeData().weekdays(this,e)})),V("e",0,0,"weekday"),V("E",0,0,"isoWeekday"),ne("day","d"),ne("weekday","e"),ne("isoWeekday","E"),oe("day",11),oe("weekday",11),oe("isoWeekday",11),Ne("d",be),Ne("e",be),Ne("E",be),Ne("dd",(function(e,t){return t.weekdaysMinRegex(e)})),Ne("ddd",(function(e,t){return t.weekdaysShortRegex(e)})),Ne("dddd",(function(e,t){return t.weekdaysRegex(e)})),Ve(["dd","ddd","dddd"],(function(e,t,n,i){var r=n._locale.weekdaysParse(e,i,n._strict);null!=r?t.d=r:m(n).invalidWeekday=e})),Ve(["d","e","E"],(function(e,t,n,i){t[i]=ce(e)}));var Ot="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),Nt="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),wt="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),Lt=Oe,Ft=Oe,Bt=Oe;function Ut(e,t){var n=a(this._weekdays)?this._weekdays:this._weekdays[e&&!0!==e&&this._weekdays.isFormat.test(t)?"format":"standalone"];return!0===e?kt(n,this._week.dow):e?n[e.day()]:n}function Vt(e){return!0===e?kt(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort}function Gt(e){return!0===e?kt(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin}function zt(e,t,n){var i,r,a,o=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],i=0;i<7;++i)a=p([2e3,1]).day(i),this._minWeekdaysParse[i]=this.weekdaysMin(a,"").toLocaleLowerCase(),this._shortWeekdaysParse[i]=this.weekdaysShort(a,"").toLocaleLowerCase(),this._weekdaysParse[i]=this.weekdays(a,"").toLocaleLowerCase();return n?"dddd"===t?-1!==(r=ze.call(this._weekdaysParse,o))?r:null:"ddd"===t?-1!==(r=ze.call(this._shortWeekdaysParse,o))?r:null:-1!==(r=ze.call(this._minWeekdaysParse,o))?r:null:"dddd"===t?-1!==(r=ze.call(this._weekdaysParse,o))||-1!==(r=ze.call(this._shortWeekdaysParse,o))||-1!==(r=ze.call(this._minWeekdaysParse,o))?r:null:"ddd"===t?-1!==(r=ze.call(this._shortWeekdaysParse,o))||-1!==(r=ze.call(this._weekdaysParse,o))||-1!==(r=ze.call(this._minWeekdaysParse,o))?r:null:-1!==(r=ze.call(this._minWeekdaysParse,o))||-1!==(r=ze.call(this._weekdaysParse,o))||-1!==(r=ze.call(this._shortWeekdaysParse,o))?r:null}function Wt(e,t,n){var i,r,a;if(this._weekdaysParseExact)return zt.call(this,e,t,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),i=0;i<7;i++){if(r=p([2e3,1]).day(i),n&&!this._fullWeekdaysParse[i]&&(this._fullWeekdaysParse[i]=new RegExp("^"+this.weekdays(r,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[i]=new RegExp("^"+this.weekdaysShort(r,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[i]=new RegExp("^"+this.weekdaysMin(r,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[i]||(a="^"+this.weekdays(r,"")+"|^"+this.weekdaysShort(r,"")+"|^"+this.weekdaysMin(r,""),this._weekdaysParse[i]=new RegExp(a.replace(".",""),"i")),n&&"dddd"===t&&this._fullWeekdaysParse[i].test(e))return i;if(n&&"ddd"===t&&this._shortWeekdaysParse[i].test(e))return i;if(n&&"dd"===t&&this._minWeekdaysParse[i].test(e))return i;if(!n&&this._weekdaysParse[i].test(e))return i}}function Ht(e){if(!this.isValid())return null!=e?this:NaN;var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(e=Dt(e,this.localeData()),this.add(e-t,"d")):t}function Xt(e){if(!this.isValid())return null!=e?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return null==e?t:this.add(e-t,"d")}function jt(e){if(!this.isValid())return null!=e?this:NaN;if(null!=e){var t=Rt(e,this.localeData());return this.day(this.day()%7?t:t-7)}return this.day()||7}function Yt(e){return this._weekdaysParseExact?(s(this,"_weekdaysRegex")||qt.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(s(this,"_weekdaysRegex")||(this._weekdaysRegex=Lt),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)}function Zt(e){return this._weekdaysParseExact?(s(this,"_weekdaysRegex")||qt.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(s(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Ft),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function Kt(e){return this._weekdaysParseExact?(s(this,"_weekdaysRegex")||qt.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(s(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Bt),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function qt(){function e(e,t){return t.length-e.length}var t,n,i,r,a,o=[],s=[],u=[],l=[];for(t=0;t<7;t++)n=p([2e3,1]).day(t),i=Fe(this.weekdaysMin(n,"")),r=Fe(this.weekdaysShort(n,"")),a=Fe(this.weekdays(n,"")),o.push(i),s.push(r),u.push(a),l.push(i),l.push(r),l.push(a);o.sort(e),s.sort(e),u.sort(e),l.sort(e),this._weekdaysRegex=new RegExp("^("+l.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+u.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+s.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+o.join("|")+")","i")}function Qt(){return this.hours()%12||12}function $t(){return this.hours()||24}function Jt(e,t){V(e,0,0,(function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)}))}function en(e,t){return t._meridiemParse}function tn(e){return"p"===(e+"").toLowerCase().charAt(0)}V("H",["HH",2],0,"hour"),V("h",["hh",2],0,Qt),V("k",["kk",2],0,$t),V("hmm",0,0,(function(){return""+Qt.apply(this)+w(this.minutes(),2)})),V("hmmss",0,0,(function(){return""+Qt.apply(this)+w(this.minutes(),2)+w(this.seconds(),2)})),V("Hmm",0,0,(function(){return""+this.hours()+w(this.minutes(),2)})),V("Hmmss",0,0,(function(){return""+this.hours()+w(this.minutes(),2)+w(this.seconds(),2)})),Jt("a",!0),Jt("A",!1),ne("hour","h"),oe("hour",13),Ne("a",en),Ne("A",en),Ne("H",be),Ne("h",be),Ne("k",be),Ne("HH",be,_e),Ne("hh",be,_e),Ne("kk",be,_e),Ne("hmm",Te),Ne("hmmss",Me),Ne("Hmm",Te),Ne("Hmmss",Me),Ue(["H","HH"],je),Ue(["k","kk"],(function(e,t,n){var i=ce(e);t[je]=24===i?0:i})),Ue(["a","A"],(function(e,t,n){n._isPm=n._locale.isPM(e),n._meridiem=e})),Ue(["h","hh"],(function(e,t,n){t[je]=ce(e),m(n).bigHour=!0})),Ue("hmm",(function(e,t,n){var i=e.length-2;t[je]=ce(e.substr(0,i)),t[Ye]=ce(e.substr(i)),m(n).bigHour=!0})),Ue("hmmss",(function(e,t,n){var i=e.length-4,r=e.length-2;t[je]=ce(e.substr(0,i)),t[Ye]=ce(e.substr(i,2)),t[Ze]=ce(e.substr(r)),m(n).bigHour=!0})),Ue("Hmm",(function(e,t,n){var i=e.length-2;t[je]=ce(e.substr(0,i)),t[Ye]=ce(e.substr(i))})),Ue("Hmmss",(function(e,t,n){var i=e.length-4,r=e.length-2;t[je]=ce(e.substr(0,i)),t[Ye]=ce(e.substr(i,2)),t[Ze]=ce(e.substr(r))}));var nn=/[ap]\.?m?\.?/i,rn=he("Hours",!0);function an(e,t,n){return e>11?n?"pm":"PM":n?"am":"AM"}var on,sn={calendar:O,longDateFormat:X,invalidDate:Y,ordinal:K,dayOfMonthOrdinalParse:q,relativeTime:$,months:et,monthsShort:tt,week:St,weekdays:Ot,weekdaysMin:wt,weekdaysShort:Nt,meridiemParse:nn},un={},ln={};function cn(e,t){var n,i=Math.min(e.length,t.length);for(n=0;n<i;n+=1)if(e[n]!==t[n])return n;return i}function hn(e){return e?e.toLowerCase().replace("_","-"):e}function fn(e){for(var t,n,i,r,a=0;a<e.length;){for(t=(r=hn(e[a]).split("-")).length,n=(n=hn(e[a+1]))?n.split("-"):null;t>0;){if(i=pn(r.slice(0,t).join("-")))return i;if(n&&n.length>=t&&cn(r,n)>=t-1)break;t--}a++}return on}function dn(e){return null!=e.match("^[^/\\\\]*$")}function pn(t){var n=null;if(void 0===un[t]&&e&&e.exports&&dn(t))try{n=on._abbr,Object(function(){var e=new Error("Cannot find module 'undefined'");throw e.code="MODULE_NOT_FOUND",e}()),vn(n)}catch(i){un[t]=null}return un[t]}function vn(e,t){var n;return e&&((n=l(t)?_n(e):mn(e,t))?on=n:"undefined"!=typeof console&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),on._abbr}function mn(e,t){if(null!==t){var n,i=sn;if(t.abbr=e,null!=un[e])C("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),i=un[e]._config;else if(null!=t.parentLocale)if(null!=un[t.parentLocale])i=un[t.parentLocale]._config;else{if(null==(n=pn(t.parentLocale)))return ln[t.parentLocale]||(ln[t.parentLocale]=[]),ln[t.parentLocale].push({name:e,config:t}),null;i=n._config}return un[e]=new k(R(i,t)),ln[e]&&ln[e].forEach((function(e){mn(e.name,e.config)})),vn(e),un[e]}return delete un[e],null}function gn(e,t){if(null!=t){var n,i,r=sn;null!=un[e]&&null!=un[e].parentLocale?un[e].set(R(un[e]._config,t)):(null!=(i=pn(e))&&(r=i._config),t=R(r,t),null==i&&(t.abbr=e),(n=new k(t)).parentLocale=un[e],un[e]=n),vn(e)}else null!=un[e]&&(null!=un[e].parentLocale?(un[e]=un[e].parentLocale,e===vn()&&vn(e)):null!=un[e]&&delete un[e]);return un[e]}function _n(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return on;if(!a(e)){if(t=pn(e))return t;e=[e]}return fn(e)}function yn(){return I(un)}function En(e){var t,n=e._a;return n&&-2===m(e).overflow&&(t=n[He]<0||n[He]>11?He:n[Xe]<1||n[Xe]>Je(n[We],n[He])?Xe:n[je]<0||n[je]>24||24===n[je]&&(0!==n[Ye]||0!==n[Ze]||0!==n[Ke])?je:n[Ye]<0||n[Ye]>59?Ye:n[Ze]<0||n[Ze]>59?Ze:n[Ke]<0||n[Ke]>999?Ke:-1,m(e)._overflowDayOfYear&&(t<We||t>Xe)&&(t=Xe),m(e)._overflowWeeks&&-1===t&&(t=qe),m(e)._overflowWeekday&&-1===t&&(t=Qe),m(e).overflow=t),e}var An=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,bn=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Tn=/Z|[+-]\d\d(?::?\d\d)?/,Mn=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],Sn=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],In=/^\/?Date\((-?\d+)/i,xn=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,Cn={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function Pn(e){var t,n,i,r,a,o,s=e._i,u=An.exec(s)||bn.exec(s),l=Mn.length,c=Sn.length;if(u){for(m(e).iso=!0,t=0,n=l;t<n;t++)if(Mn[t][1].exec(u[1])){r=Mn[t][0],i=!1!==Mn[t][2];break}if(null==r)return void(e._isValid=!1);if(u[3]){for(t=0,n=c;t<n;t++)if(Sn[t][1].exec(u[3])){a=(u[2]||" ")+Sn[t][0];break}if(null==a)return void(e._isValid=!1)}if(!i&&null!=a)return void(e._isValid=!1);if(u[4]){if(!Tn.exec(u[4]))return void(e._isValid=!1);o="Z"}e._f=r+(a||"")+(o||""),Gn(e)}else e._isValid=!1}function Dn(e,t,n,i,r,a){var o=[Rn(e),tt.indexOf(t),parseInt(n,10),parseInt(i,10),parseInt(r,10)];return a&&o.push(parseInt(a,10)),o}function Rn(e){var t=parseInt(e,10);return t<=49?2e3+t:t<=999?1900+t:t}function kn(e){return e.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function On(e,t,n){return!e||Nt.indexOf(e)===new Date(t[0],t[1],t[2]).getDay()||(m(n).weekdayMismatch=!0,n._isValid=!1,!1)}function Nn(e,t,n){if(e)return Cn[e];if(t)return 0;var i=parseInt(n,10),r=i%100;return(i-r)/100*60+r}function wn(e){var t,n=xn.exec(kn(e._i));if(n){if(t=Dn(n[4],n[3],n[2],n[5],n[6],n[7]),!On(n[1],t,e))return;e._a=t,e._tzm=Nn(n[8],n[9],n[10]),e._d=yt.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),m(e).rfc2822=!0}else e._isValid=!1}function Ln(e){var t=In.exec(e._i);null===t?(Pn(e),!1===e._isValid&&(delete e._isValid,wn(e),!1===e._isValid&&(delete e._isValid,e._strict?e._isValid=!1:i.createFromInputFallback(e)))):e._d=new Date(+t[1])}function Fn(e,t,n){return null!=e?e:null!=t?t:n}function Bn(e){var t=new Date(i.now());return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function Un(e){var t,n,i,r,a,o=[];if(!e._d){for(i=Bn(e),e._w&&null==e._a[Xe]&&null==e._a[He]&&Vn(e),null!=e._dayOfYear&&(a=Fn(e._a[We],i[We]),(e._dayOfYear>vt(a)||0===e._dayOfYear)&&(m(e)._overflowDayOfYear=!0),n=yt(a,0,e._dayOfYear),e._a[He]=n.getUTCMonth(),e._a[Xe]=n.getUTCDate()),t=0;t<3&&null==e._a[t];++t)e._a[t]=o[t]=i[t];for(;t<7;t++)e._a[t]=o[t]=null==e._a[t]?2===t?1:0:e._a[t];24===e._a[je]&&0===e._a[Ye]&&0===e._a[Ze]&&0===e._a[Ke]&&(e._nextDay=!0,e._a[je]=0),e._d=(e._useUTC?yt:_t).apply(null,o),r=e._useUTC?e._d.getUTCDay():e._d.getDay(),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[je]=24),e._w&&void 0!==e._w.d&&e._w.d!==r&&(m(e).weekdayMismatch=!0)}}function Vn(e){var t,n,i,r,a,o,s,u,l;null!=(t=e._w).GG||null!=t.W||null!=t.E?(a=1,o=4,n=Fn(t.GG,e._a[We],bt(Kn(),1,4).year),i=Fn(t.W,1),((r=Fn(t.E,1))<1||r>7)&&(u=!0)):(a=e._locale._week.dow,o=e._locale._week.doy,l=bt(Kn(),a,o),n=Fn(t.gg,e._a[We],l.year),i=Fn(t.w,l.week),null!=t.d?((r=t.d)<0||r>6)&&(u=!0):null!=t.e?(r=t.e+a,(t.e<0||t.e>6)&&(u=!0)):r=a),i<1||i>Tt(n,a,o)?m(e)._overflowWeeks=!0:null!=u?m(e)._overflowWeekday=!0:(s=At(n,i,r,a,o),e._a[We]=s.year,e._dayOfYear=s.dayOfYear)}function Gn(e){if(e._f!==i.ISO_8601)if(e._f!==i.RFC_2822){e._a=[],m(e).empty=!0;var t,n,r,a,o,s,u,l=""+e._i,c=l.length,h=0;for(u=(r=H(e._f,e._locale).match(L)||[]).length,t=0;t<u;t++)a=r[t],(n=(l.match(we(a,e))||[])[0])&&((o=l.substr(0,l.indexOf(n))).length>0&&m(e).unusedInput.push(o),l=l.slice(l.indexOf(n)+n.length),h+=n.length),U[a]?(n?m(e).empty=!1:m(e).unusedTokens.push(a),Ge(a,n,e)):e._strict&&!n&&m(e).unusedTokens.push(a);m(e).charsLeftOver=c-h,l.length>0&&m(e).unusedInput.push(l),e._a[je]<=12&&!0===m(e).bigHour&&e._a[je]>0&&(m(e).bigHour=void 0),m(e).parsedDateParts=e._a.slice(0),m(e).meridiem=e._meridiem,e._a[je]=zn(e._locale,e._a[je],e._meridiem),null!==(s=m(e).era)&&(e._a[We]=e._locale.erasConvertYear(s,e._a[We])),Un(e),En(e)}else wn(e);else Pn(e)}function zn(e,t,n){var i;return null==n?t:null!=e.meridiemHour?e.meridiemHour(t,n):null!=e.isPM?((i=e.isPM(n))&&t<12&&(t+=12),i||12!==t||(t=0),t):t}function Wn(e){var t,n,i,r,a,o,s=!1,u=e._f.length;if(0===u)return m(e).invalidFormat=!0,void(e._d=new Date(NaN));for(r=0;r<u;r++)a=0,o=!1,t=A({},e),null!=e._useUTC&&(t._useUTC=e._useUTC),t._f=e._f[r],Gn(t),g(t)&&(o=!0),a+=m(t).charsLeftOver,a+=10*m(t).unusedTokens.length,m(t).score=a,s?a<i&&(i=a,n=t):(null==i||a<i||o)&&(i=a,n=t,o&&(s=!0));d(e,n||t)}function Hn(e){if(!e._d){var t=re(e._i),n=void 0===t.day?t.date:t.day;e._a=f([t.year,t.month,n,t.hour,t.minute,t.second,t.millisecond],(function(e){return e&&parseInt(e,10)})),Un(e)}}function Xn(e){var t=new b(En(jn(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t}function jn(e){var t=e._i,n=e._f;return e._locale=e._locale||_n(e._l),null===t||void 0===n&&""===t?_({nullInput:!0}):("string"==typeof t&&(e._i=t=e._locale.preparse(t)),T(t)?new b(En(t)):(h(t)?e._d=t:a(n)?Wn(e):n?Gn(e):Yn(e),g(e)||(e._d=null),e))}function Yn(e){var t=e._i;l(t)?e._d=new Date(i.now()):h(t)?e._d=new Date(t.valueOf()):"string"==typeof t?Ln(e):a(t)?(e._a=f(t.slice(0),(function(e){return parseInt(e,10)})),Un(e)):o(t)?Hn(e):c(t)?e._d=new Date(t):i.createFromInputFallback(e)}function Zn(e,t,n,i,r){var s={};return!0!==t&&!1!==t||(i=t,t=void 0),!0!==n&&!1!==n||(i=n,n=void 0),(o(e)&&u(e)||a(e)&&0===e.length)&&(e=void 0),s._isAMomentObject=!0,s._useUTC=s._isUTC=r,s._l=n,s._i=e,s._f=t,s._strict=i,Xn(s)}function Kn(e,t,n,i){return Zn(e,t,n,i,!1)}i.createFromInputFallback=S("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",(function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))})),i.ISO_8601=function(){},i.RFC_2822=function(){};var qn=S("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",(function(){var e=Kn.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:_()})),Qn=S("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",(function(){var e=Kn.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:_()}));function $n(e,t){var n,i;if(1===t.length&&a(t[0])&&(t=t[0]),!t.length)return Kn();for(n=t[0],i=1;i<t.length;++i)t[i].isValid()&&!t[i][e](n)||(n=t[i]);return n}function Jn(){return $n("isBefore",[].slice.call(arguments,0))}function ei(){return $n("isAfter",[].slice.call(arguments,0))}var ti=function(){return Date.now?Date.now():+new Date},ni=["year","quarter","month","week","day","hour","minute","second","millisecond"];function ii(e){var t,n,i=!1,r=ni.length;for(t in e)if(s(e,t)&&(-1===ze.call(ni,t)||null!=e[t]&&isNaN(e[t])))return!1;for(n=0;n<r;++n)if(e[ni[n]]){if(i)return!1;parseFloat(e[ni[n]])!==ce(e[ni[n]])&&(i=!0)}return!0}function ri(){return this._isValid}function ai(){return Ci(NaN)}function oi(e){var t=re(e),n=t.year||0,i=t.quarter||0,r=t.month||0,a=t.week||t.isoWeek||0,o=t.day||0,s=t.hour||0,u=t.minute||0,l=t.second||0,c=t.millisecond||0;this._isValid=ii(t),this._milliseconds=+c+1e3*l+6e4*u+1e3*s*60*60,this._days=+o+7*a,this._months=+r+3*i+12*n,this._data={},this._locale=_n(),this._bubble()}function si(e){return e instanceof oi}function ui(e){return e<0?-1*Math.round(-1*e):Math.round(e)}function li(e,t,n){var i,r=Math.min(e.length,t.length),a=Math.abs(e.length-t.length),o=0;for(i=0;i<r;i++)(n&&e[i]!==t[i]||!n&&ce(e[i])!==ce(t[i]))&&o++;return o+a}function ci(e,t){V(e,0,0,(function(){var e=this.utcOffset(),n="+";return e<0&&(e=-e,n="-"),n+w(~~(e/60),2)+t+w(~~e%60,2)}))}ci("Z",":"),ci("ZZ",""),Ne("Z",Re),Ne("ZZ",Re),Ue(["Z","ZZ"],(function(e,t,n){n._useUTC=!0,n._tzm=fi(Re,e)}));var hi=/([\+\-]|\d\d)/gi;function fi(e,t){var n,i,r=(t||"").match(e);return null===r?null:0===(i=60*(n=((r[r.length-1]||[])+"").match(hi)||["-",0,0])[1]+ce(n[2]))?0:"+"===n[0]?i:-i}function di(e,t){var n,r;return t._isUTC?(n=t.clone(),r=(T(e)||h(e)?e.valueOf():Kn(e).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+r),i.updateOffset(n,!1),n):Kn(e).local()}function pi(e){return-Math.round(e._d.getTimezoneOffset())}function vi(e,t,n){var r,a=this._offset||0;if(!this.isValid())return null!=e?this:NaN;if(null!=e){if("string"==typeof e){if(null===(e=fi(Re,e)))return this}else Math.abs(e)<16&&!n&&(e*=60);return!this._isUTC&&t&&(r=pi(this)),this._offset=e,this._isUTC=!0,null!=r&&this.add(r,"m"),a!==e&&(!t||this._changeInProgress?Oi(this,Ci(e-a,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,i.updateOffset(this,!0),this._changeInProgress=null)),this}return this._isUTC?a:pi(this)}function mi(e,t){return null!=e?("string"!=typeof e&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}function gi(e){return this.utcOffset(0,e)}function _i(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(pi(this),"m")),this}function yi(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"==typeof this._i){var e=fi(De,this._i);null!=e?this.utcOffset(e):this.utcOffset(0,!0)}return this}function Ei(e){return!!this.isValid()&&(e=e?Kn(e).utcOffset():0,(this.utcOffset()-e)%60==0)}function Ai(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function bi(){if(!l(this._isDSTShifted))return this._isDSTShifted;var e,t={};return A(t,this),(t=jn(t))._a?(e=t._isUTC?p(t._a):Kn(t._a),this._isDSTShifted=this.isValid()&&li(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function Ti(){return!!this.isValid()&&!this._isUTC}function Mi(){return!!this.isValid()&&this._isUTC}function Si(){return!!this.isValid()&&this._isUTC&&0===this._offset}i.updateOffset=function(){};var Ii=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,xi=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Ci(e,t){var n,i,r,a=e,o=null;return si(e)?a={ms:e._milliseconds,d:e._days,M:e._months}:c(e)||!isNaN(+e)?(a={},t?a[t]=+e:a.milliseconds=+e):(o=Ii.exec(e))?(n="-"===o[1]?-1:1,a={y:0,d:ce(o[Xe])*n,h:ce(o[je])*n,m:ce(o[Ye])*n,s:ce(o[Ze])*n,ms:ce(ui(1e3*o[Ke]))*n}):(o=xi.exec(e))?(n="-"===o[1]?-1:1,a={y:Pi(o[2],n),M:Pi(o[3],n),w:Pi(o[4],n),d:Pi(o[5],n),h:Pi(o[6],n),m:Pi(o[7],n),s:Pi(o[8],n)}):null==a?a={}:"object"==typeof a&&("from"in a||"to"in a)&&(r=Ri(Kn(a.from),Kn(a.to)),(a={}).ms=r.milliseconds,a.M=r.months),i=new oi(a),si(e)&&s(e,"_locale")&&(i._locale=e._locale),si(e)&&s(e,"_isValid")&&(i._isValid=e._isValid),i}function Pi(e,t){var n=e&&parseFloat(e.replace(",","."));return(isNaN(n)?0:n)*t}function Di(e,t){var n={};return n.months=t.month()-e.month()+12*(t.year()-e.year()),e.clone().add(n.months,"M").isAfter(t)&&--n.months,n.milliseconds=+t-+e.clone().add(n.months,"M"),n}function Ri(e,t){var n;return e.isValid()&&t.isValid()?(t=di(t,e),e.isBefore(t)?n=Di(e,t):((n=Di(t,e)).milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function ki(e,t){return function(n,i){var r;return null===i||isNaN(+i)||(C(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),r=n,n=i,i=r),Oi(this,Ci(n,i),e),this}}function Oi(e,t,n,r){var a=t._milliseconds,o=ui(t._days),s=ui(t._months);e.isValid()&&(r=null==r||r,s&&lt(e,fe(e,"Month")+s*n),o&&de(e,"Date",fe(e,"Date")+o*n),a&&e._d.setTime(e._d.valueOf()+a*n),r&&i.updateOffset(e,o||s))}Ci.fn=oi.prototype,Ci.invalid=ai;var Ni=ki(1,"add"),wi=ki(-1,"subtract");function Li(e){return"string"==typeof e||e instanceof String}function Fi(e){return T(e)||h(e)||Li(e)||c(e)||Ui(e)||Bi(e)||null==e}function Bi(e){var t,n,i=o(e)&&!u(e),r=!1,a=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],l=a.length;for(t=0;t<l;t+=1)n=a[t],r=r||s(e,n);return i&&r}function Ui(e){var t=a(e),n=!1;return t&&(n=0===e.filter((function(t){return!c(t)&&Li(e)})).length),t&&n}function Vi(e){var t,n,i=o(e)&&!u(e),r=!1,a=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"];for(t=0;t<a.length;t+=1)n=a[t],r=r||s(e,n);return i&&r}function Gi(e,t){var n=e.diff(t,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function zi(e,t){1===arguments.length&&(arguments[0]?Fi(arguments[0])?(e=arguments[0],t=void 0):Vi(arguments[0])&&(t=arguments[0],e=void 0):(e=void 0,t=void 0));var n=e||Kn(),r=di(n,this).startOf("day"),a=i.calendarFormat(this,r)||"sameElse",o=t&&(P(t[a])?t[a].call(this,n):t[a]);return this.format(o||this.localeData().calendar(a,this,Kn(n)))}function Wi(){return new b(this)}function Hi(e,t){var n=T(e)?e:Kn(e);return!(!this.isValid()||!n.isValid())&&("millisecond"===(t=ie(t)||"millisecond")?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(t).valueOf())}function Xi(e,t){var n=T(e)?e:Kn(e);return!(!this.isValid()||!n.isValid())&&("millisecond"===(t=ie(t)||"millisecond")?this.valueOf()<n.valueOf():this.clone().endOf(t).valueOf()<n.valueOf())}function ji(e,t,n,i){var r=T(e)?e:Kn(e),a=T(t)?t:Kn(t);return!!(this.isValid()&&r.isValid()&&a.isValid())&&("("===(i=i||"()")[0]?this.isAfter(r,n):!this.isBefore(r,n))&&(")"===i[1]?this.isBefore(a,n):!this.isAfter(a,n))}function Yi(e,t){var n,i=T(e)?e:Kn(e);return!(!this.isValid()||!i.isValid())&&("millisecond"===(t=ie(t)||"millisecond")?this.valueOf()===i.valueOf():(n=i.valueOf(),this.clone().startOf(t).valueOf()<=n&&n<=this.clone().endOf(t).valueOf()))}function Zi(e,t){return this.isSame(e,t)||this.isAfter(e,t)}function Ki(e,t){return this.isSame(e,t)||this.isBefore(e,t)}function qi(e,t,n){var i,r,a;if(!this.isValid())return NaN;if(!(i=di(e,this)).isValid())return NaN;switch(r=6e4*(i.utcOffset()-this.utcOffset()),t=ie(t)){case"year":a=Qi(this,i)/12;break;case"month":a=Qi(this,i);break;case"quarter":a=Qi(this,i)/3;break;case"second":a=(this-i)/1e3;break;case"minute":a=(this-i)/6e4;break;case"hour":a=(this-i)/36e5;break;case"day":a=(this-i-r)/864e5;break;case"week":a=(this-i-r)/6048e5;break;default:a=this-i}return n?a:le(a)}function Qi(e,t){if(e.date()<t.date())return-Qi(t,e);var n=12*(t.year()-e.year())+(t.month()-e.month()),i=e.clone().add(n,"months");return-(n+(t-i<0?(t-i)/(i-e.clone().add(n-1,"months")):(t-i)/(e.clone().add(n+1,"months")-i)))||0}function $i(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function Ji(e){if(!this.isValid())return null;var t=!0!==e,n=t?this.clone().utc():this;return n.year()<0||n.year()>9999?W(n,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):P(Date.prototype.toISOString)?t?this.toDate().toISOString():new Date(this.valueOf()+60*this.utcOffset()*1e3).toISOString().replace("Z",W(n,"Z")):W(n,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function er(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e,t,n,i,r="moment",a="";return this.isLocal()||(r=0===this.utcOffset()?"moment.utc":"moment.parseZone",a="Z"),e="["+r+'("]',t=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",n="-MM-DD[T]HH:mm:ss.SSS",i=a+'[")]',this.format(e+t+n+i)}function tr(e){e||(e=this.isUtc()?i.defaultFormatUtc:i.defaultFormat);var t=W(this,e);return this.localeData().postformat(t)}function nr(e,t){return this.isValid()&&(T(e)&&e.isValid()||Kn(e).isValid())?Ci({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function ir(e){return this.from(Kn(),e)}function rr(e,t){return this.isValid()&&(T(e)&&e.isValid()||Kn(e).isValid())?Ci({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function ar(e){return this.to(Kn(),e)}function or(e){var t;return void 0===e?this._locale._abbr:(null!=(t=_n(e))&&(this._locale=t),this)}i.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",i.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var sr=S("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",(function(e){return void 0===e?this.localeData():this.locale(e)}));function ur(){return this._locale}var lr=1e3,cr=60*lr,hr=60*cr,fr=3506328*hr;function dr(e,t){return(e%t+t)%t}function pr(e,t,n){return e<100&&e>=0?new Date(e+400,t,n)-fr:new Date(e,t,n).valueOf()}function vr(e,t,n){return e<100&&e>=0?Date.UTC(e+400,t,n)-fr:Date.UTC(e,t,n)}function mr(e){var t,n;if(void 0===(e=ie(e))||"millisecond"===e||!this.isValid())return this;switch(n=this._isUTC?vr:pr,e){case"year":t=n(this.year(),0,1);break;case"quarter":t=n(this.year(),this.month()-this.month()%3,1);break;case"month":t=n(this.year(),this.month(),1);break;case"week":t=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":t=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":t=n(this.year(),this.month(),this.date());break;case"hour":t=this._d.valueOf(),t-=dr(t+(this._isUTC?0:this.utcOffset()*cr),hr);break;case"minute":t=this._d.valueOf(),t-=dr(t,cr);break;case"second":t=this._d.valueOf(),t-=dr(t,lr)}return this._d.setTime(t),i.updateOffset(this,!0),this}function gr(e){var t,n;if(void 0===(e=ie(e))||"millisecond"===e||!this.isValid())return this;switch(n=this._isUTC?vr:pr,e){case"year":t=n(this.year()+1,0,1)-1;break;case"quarter":t=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":t=n(this.year(),this.month()+1,1)-1;break;case"week":t=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":t=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":t=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":t=this._d.valueOf(),t+=hr-dr(t+(this._isUTC?0:this.utcOffset()*cr),hr)-1;break;case"minute":t=this._d.valueOf(),t+=cr-dr(t,cr)-1;break;case"second":t=this._d.valueOf(),t+=lr-dr(t,lr)-1}return this._d.setTime(t),i.updateOffset(this,!0),this}function _r(){return this._d.valueOf()-6e4*(this._offset||0)}function yr(){return Math.floor(this.valueOf()/1e3)}function Er(){return new Date(this.valueOf())}function Ar(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function br(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function Tr(){return this.isValid()?this.toISOString():null}function Mr(){return g(this)}function Sr(){return d({},m(this))}function Ir(){return m(this).overflow}function xr(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}function Cr(e,t){var n,r,a,o=this._eras||_n("en")._eras;for(n=0,r=o.length;n<r;++n)switch("string"==typeof o[n].since&&(a=i(o[n].since).startOf("day"),o[n].since=a.valueOf()),typeof o[n].until){case"undefined":o[n].until=1/0;break;case"string":a=i(o[n].until).startOf("day").valueOf(),o[n].until=a.valueOf()}return o}function Pr(e,t,n){var i,r,a,o,s,u=this.eras();for(e=e.toUpperCase(),i=0,r=u.length;i<r;++i)if(a=u[i].name.toUpperCase(),o=u[i].abbr.toUpperCase(),s=u[i].narrow.toUpperCase(),n)switch(t){case"N":case"NN":case"NNN":if(o===e)return u[i];break;case"NNNN":if(a===e)return u[i];break;case"NNNNN":if(s===e)return u[i]}else if([a,o,s].indexOf(e)>=0)return u[i]}function Dr(e,t){var n=e.since<=e.until?1:-1;return void 0===t?i(e.since).year():i(e.since).year()+(t-e.offset)*n}function Rr(){var e,t,n,i=this.localeData().eras();for(e=0,t=i.length;e<t;++e){if(n=this.clone().startOf("day").valueOf(),i[e].since<=n&&n<=i[e].until)return i[e].name;if(i[e].until<=n&&n<=i[e].since)return i[e].name}return""}function kr(){var e,t,n,i=this.localeData().eras();for(e=0,t=i.length;e<t;++e){if(n=this.clone().startOf("day").valueOf(),i[e].since<=n&&n<=i[e].until)return i[e].narrow;if(i[e].until<=n&&n<=i[e].since)return i[e].narrow}return""}function Or(){var e,t,n,i=this.localeData().eras();for(e=0,t=i.length;e<t;++e){if(n=this.clone().startOf("day").valueOf(),i[e].since<=n&&n<=i[e].until)return i[e].abbr;if(i[e].until<=n&&n<=i[e].since)return i[e].abbr}return""}function Nr(){var e,t,n,r,a=this.localeData().eras();for(e=0,t=a.length;e<t;++e)if(n=a[e].since<=a[e].until?1:-1,r=this.clone().startOf("day").valueOf(),a[e].since<=r&&r<=a[e].until||a[e].until<=r&&r<=a[e].since)return(this.year()-i(a[e].since).year())*n+a[e].offset;return this.year()}function wr(e){return s(this,"_erasNameRegex")||zr.call(this),e?this._erasNameRegex:this._erasRegex}function Lr(e){return s(this,"_erasAbbrRegex")||zr.call(this),e?this._erasAbbrRegex:this._erasRegex}function Fr(e){return s(this,"_erasNarrowRegex")||zr.call(this),e?this._erasNarrowRegex:this._erasRegex}function Br(e,t){return t.erasAbbrRegex(e)}function Ur(e,t){return t.erasNameRegex(e)}function Vr(e,t){return t.erasNarrowRegex(e)}function Gr(e,t){return t._eraYearOrdinalRegex||Ce}function zr(){var e,t,n=[],i=[],r=[],a=[],o=this.eras();for(e=0,t=o.length;e<t;++e)i.push(Fe(o[e].name)),n.push(Fe(o[e].abbr)),r.push(Fe(o[e].narrow)),a.push(Fe(o[e].name)),a.push(Fe(o[e].abbr)),a.push(Fe(o[e].narrow));this._erasRegex=new RegExp("^("+a.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+i.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+r.join("|")+")","i")}function Wr(e,t){V(0,[e,e.length],0,t)}function Hr(e){return qr.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function Xr(e){return qr.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function jr(){return Tt(this.year(),1,4)}function Yr(){return Tt(this.isoWeekYear(),1,4)}function Zr(){var e=this.localeData()._week;return Tt(this.year(),e.dow,e.doy)}function Kr(){var e=this.localeData()._week;return Tt(this.weekYear(),e.dow,e.doy)}function qr(e,t,n,i,r){var a;return null==e?bt(this,i,r).year:(t>(a=Tt(e,i,r))&&(t=a),Qr.call(this,e,t,n,i,r))}function Qr(e,t,n,i,r){var a=At(e,t,n,i,r),o=yt(a.year,0,a.dayOfYear);return this.year(o.getUTCFullYear()),this.month(o.getUTCMonth()),this.date(o.getUTCDate()),this}function $r(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)}V("N",0,0,"eraAbbr"),V("NN",0,0,"eraAbbr"),V("NNN",0,0,"eraAbbr"),V("NNNN",0,0,"eraName"),V("NNNNN",0,0,"eraNarrow"),V("y",["y",1],"yo","eraYear"),V("y",["yy",2],0,"eraYear"),V("y",["yyy",3],0,"eraYear"),V("y",["yyyy",4],0,"eraYear"),Ne("N",Br),Ne("NN",Br),Ne("NNN",Br),Ne("NNNN",Ur),Ne("NNNNN",Vr),Ue(["N","NN","NNN","NNNN","NNNNN"],(function(e,t,n,i){var r=n._locale.erasParse(e,i,n._strict);r?m(n).era=r:m(n).invalidEra=e})),Ne("y",Ce),Ne("yy",Ce),Ne("yyy",Ce),Ne("yyyy",Ce),Ne("yo",Gr),Ue(["y","yy","yyy","yyyy"],We),Ue(["yo"],(function(e,t,n,i){var r;n._locale._eraYearOrdinalRegex&&(r=e.match(n._locale._eraYearOrdinalRegex)),n._locale.eraYearOrdinalParse?t[We]=n._locale.eraYearOrdinalParse(e,r):t[We]=parseInt(e,10)})),V(0,["gg",2],0,(function(){return this.weekYear()%100})),V(0,["GG",2],0,(function(){return this.isoWeekYear()%100})),Wr("gggg","weekYear"),Wr("ggggg","weekYear"),Wr("GGGG","isoWeekYear"),Wr("GGGGG","isoWeekYear"),ne("weekYear","gg"),ne("isoWeekYear","GG"),oe("weekYear",1),oe("isoWeekYear",1),Ne("G",Pe),Ne("g",Pe),Ne("GG",be,_e),Ne("gg",be,_e),Ne("GGGG",Ie,Ee),Ne("gggg",Ie,Ee),Ne("GGGGG",xe,Ae),Ne("ggggg",xe,Ae),Ve(["gggg","ggggg","GGGG","GGGGG"],(function(e,t,n,i){t[i.substr(0,2)]=ce(e)})),Ve(["gg","GG"],(function(e,t,n,r){t[r]=i.parseTwoDigitYear(e)})),V("Q",0,"Qo","quarter"),ne("quarter","Q"),oe("quarter",7),Ne("Q",ge),Ue("Q",(function(e,t){t[He]=3*(ce(e)-1)})),V("D",["DD",2],"Do","date"),ne("date","D"),oe("date",9),Ne("D",be),Ne("DD",be,_e),Ne("Do",(function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient})),Ue(["D","DD"],Xe),Ue("Do",(function(e,t){t[Xe]=ce(e.match(be)[0])}));var Jr=he("Date",!0);function ea(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==e?t:this.add(e-t,"d")}V("DDD",["DDDD",3],"DDDo","dayOfYear"),ne("dayOfYear","DDD"),oe("dayOfYear",4),Ne("DDD",Se),Ne("DDDD",ye),Ue(["DDD","DDDD"],(function(e,t,n){n._dayOfYear=ce(e)})),V("m",["mm",2],0,"minute"),ne("minute","m"),oe("minute",14),Ne("m",be),Ne("mm",be,_e),Ue(["m","mm"],Ye);var ta=he("Minutes",!1);V("s",["ss",2],0,"second"),ne("second","s"),oe("second",15),Ne("s",be),Ne("ss",be,_e),Ue(["s","ss"],Ze);var na,ia,ra=he("Seconds",!1);for(V("S",0,0,(function(){return~~(this.millisecond()/100)})),V(0,["SS",2],0,(function(){return~~(this.millisecond()/10)})),V(0,["SSS",3],0,"millisecond"),V(0,["SSSS",4],0,(function(){return 10*this.millisecond()})),V(0,["SSSSS",5],0,(function(){return 100*this.millisecond()})),V(0,["SSSSSS",6],0,(function(){return 1e3*this.millisecond()})),V(0,["SSSSSSS",7],0,(function(){return 1e4*this.millisecond()})),V(0,["SSSSSSSS",8],0,(function(){return 1e5*this.millisecond()})),V(0,["SSSSSSSSS",9],0,(function(){return 1e6*this.millisecond()})),ne("millisecond","ms"),oe("millisecond",16),Ne("S",Se,ge),Ne("SS",Se,_e),Ne("SSS",Se,ye),na="SSSS";na.length<=9;na+="S")Ne(na,Ce);function aa(e,t){t[Ke]=ce(1e3*("0."+e))}for(na="S";na.length<=9;na+="S")Ue(na,aa);function oa(){return this._isUTC?"UTC":""}function sa(){return this._isUTC?"Coordinated Universal Time":""}ia=he("Milliseconds",!1),V("z",0,0,"zoneAbbr"),V("zz",0,0,"zoneName");var ua=b.prototype;function la(e){return Kn(1e3*e)}function ca(){return Kn.apply(null,arguments).parseZone()}function ha(e){return e}ua.add=Ni,ua.calendar=zi,ua.clone=Wi,ua.diff=qi,ua.endOf=gr,ua.format=tr,ua.from=nr,ua.fromNow=ir,ua.to=rr,ua.toNow=ar,ua.get=pe,ua.invalidAt=Ir,ua.isAfter=Hi,ua.isBefore=Xi,ua.isBetween=ji,ua.isSame=Yi,ua.isSameOrAfter=Zi,ua.isSameOrBefore=Ki,ua.isValid=Mr,ua.lang=sr,ua.locale=or,ua.localeData=ur,ua.max=Qn,ua.min=qn,ua.parsingFlags=Sr,ua.set=ve,ua.startOf=mr,ua.subtract=wi,ua.toArray=Ar,ua.toObject=br,ua.toDate=Er,ua.toISOString=Ji,ua.inspect=er,"undefined"!=typeof Symbol&&null!=Symbol.for&&(ua[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"}),ua.toJSON=Tr,ua.toString=$i,ua.unix=yr,ua.valueOf=_r,ua.creationData=xr,ua.eraName=Rr,ua.eraNarrow=kr,ua.eraAbbr=Or,ua.eraYear=Nr,ua.year=mt,ua.isLeapYear=gt,ua.weekYear=Hr,ua.isoWeekYear=Xr,ua.quarter=ua.quarters=$r,ua.month=ct,ua.daysInMonth=ht,ua.week=ua.weeks=Ct,ua.isoWeek=ua.isoWeeks=Pt,ua.weeksInYear=Zr,ua.weeksInWeekYear=Kr,ua.isoWeeksInYear=jr,ua.isoWeeksInISOWeekYear=Yr,ua.date=Jr,ua.day=ua.days=Ht,ua.weekday=Xt,ua.isoWeekday=jt,ua.dayOfYear=ea,ua.hour=ua.hours=rn,ua.minute=ua.minutes=ta,ua.second=ua.seconds=ra,ua.millisecond=ua.milliseconds=ia,ua.utcOffset=vi,ua.utc=gi,ua.local=_i,ua.parseZone=yi,ua.hasAlignedHourOffset=Ei,ua.isDST=Ai,ua.isLocal=Ti,ua.isUtcOffset=Mi,ua.isUtc=Si,ua.isUTC=Si,ua.zoneAbbr=oa,ua.zoneName=sa,ua.dates=S("dates accessor is deprecated. Use date instead.",Jr),ua.months=S("months accessor is deprecated. Use month instead",ct),ua.years=S("years accessor is deprecated. Use year instead",mt),ua.zone=S("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",mi),ua.isDSTShifted=S("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",bi);var fa=k.prototype;function da(e,t,n,i){var r=_n(),a=p().set(i,t);return r[n](a,e)}function pa(e,t,n){if(c(e)&&(t=e,e=void 0),e=e||"",null!=t)return da(e,t,n,"month");var i,r=[];for(i=0;i<12;i++)r[i]=da(e,i,n,"month");return r}function va(e,t,n,i){"boolean"==typeof e?(c(t)&&(n=t,t=void 0),t=t||""):(n=t=e,e=!1,c(t)&&(n=t,t=void 0),t=t||"");var r,a=_n(),o=e?a._week.dow:0,s=[];if(null!=n)return da(t,(n+o)%7,i,"day");for(r=0;r<7;r++)s[r]=da(t,(r+o)%7,i,"day");return s}function ma(e,t){return pa(e,t,"months")}function ga(e,t){return pa(e,t,"monthsShort")}function _a(e,t,n){return va(e,t,n,"weekdays")}function ya(e,t,n){return va(e,t,n,"weekdaysShort")}function Ea(e,t,n){return va(e,t,n,"weekdaysMin")}fa.calendar=N,fa.longDateFormat=j,fa.invalidDate=Z,fa.ordinal=Q,fa.preparse=ha,fa.postformat=ha,fa.relativeTime=J,fa.pastFuture=ee,fa.set=D,fa.eras=Cr,fa.erasParse=Pr,fa.erasConvertYear=Dr,fa.erasAbbrRegex=Lr,fa.erasNameRegex=wr,fa.erasNarrowRegex=Fr,fa.months=at,fa.monthsShort=ot,fa.monthsParse=ut,fa.monthsRegex=dt,fa.monthsShortRegex=ft,fa.week=Mt,fa.firstDayOfYear=xt,fa.firstDayOfWeek=It,fa.weekdays=Ut,fa.weekdaysMin=Gt,fa.weekdaysShort=Vt,fa.weekdaysParse=Wt,fa.weekdaysRegex=Yt,fa.weekdaysShortRegex=Zt,fa.weekdaysMinRegex=Kt,fa.isPM=tn,fa.meridiem=an,vn("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10;return e+(1===ce(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")}}),i.lang=S("moment.lang is deprecated. Use moment.locale instead.",vn),i.langData=S("moment.langData is deprecated. Use moment.localeData instead.",_n);var Aa=Math.abs;function ba(){var e=this._data;return this._milliseconds=Aa(this._milliseconds),this._days=Aa(this._days),this._months=Aa(this._months),e.milliseconds=Aa(e.milliseconds),e.seconds=Aa(e.seconds),e.minutes=Aa(e.minutes),e.hours=Aa(e.hours),e.months=Aa(e.months),e.years=Aa(e.years),this}function Ta(e,t,n,i){var r=Ci(t,n);return e._milliseconds+=i*r._milliseconds,e._days+=i*r._days,e._months+=i*r._months,e._bubble()}function Ma(e,t){return Ta(this,e,t,1)}function Sa(e,t){return Ta(this,e,t,-1)}function Ia(e){return e<0?Math.floor(e):Math.ceil(e)}function xa(){var e,t,n,i,r,a=this._milliseconds,o=this._days,s=this._months,u=this._data;return a>=0&&o>=0&&s>=0||a<=0&&o<=0&&s<=0||(a+=864e5*Ia(Pa(s)+o),o=0,s=0),u.milliseconds=a%1e3,e=le(a/1e3),u.seconds=e%60,t=le(e/60),u.minutes=t%60,n=le(t/60),u.hours=n%24,o+=le(n/24),s+=r=le(Ca(o)),o-=Ia(Pa(r)),i=le(s/12),s%=12,u.days=o,u.months=s,u.years=i,this}function Ca(e){return 4800*e/146097}function Pa(e){return 146097*e/4800}function Da(e){if(!this.isValid())return NaN;var t,n,i=this._milliseconds;if("month"===(e=ie(e))||"quarter"===e||"year"===e)switch(t=this._days+i/864e5,n=this._months+Ca(t),e){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(t=this._days+Math.round(Pa(this._months)),e){case"week":return t/7+i/6048e5;case"day":return t+i/864e5;case"hour":return 24*t+i/36e5;case"minute":return 1440*t+i/6e4;case"second":return 86400*t+i/1e3;case"millisecond":return Math.floor(864e5*t)+i;default:throw new Error("Unknown unit "+e)}}function Ra(){return this.isValid()?this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*ce(this._months/12):NaN}function ka(e){return function(){return this.as(e)}}var Oa=ka("ms"),Na=ka("s"),wa=ka("m"),La=ka("h"),Fa=ka("d"),Ba=ka("w"),Ua=ka("M"),Va=ka("Q"),Ga=ka("y");function za(){return Ci(this)}function Wa(e){return e=ie(e),this.isValid()?this[e+"s"]():NaN}function Ha(e){return function(){return this.isValid()?this._data[e]:NaN}}var Xa=Ha("milliseconds"),ja=Ha("seconds"),Ya=Ha("minutes"),Za=Ha("hours"),Ka=Ha("days"),qa=Ha("months"),Qa=Ha("years");function $a(){return le(this.days()/7)}var Ja=Math.round,eo={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function to(e,t,n,i,r){return r.relativeTime(t||1,!!n,e,i)}function no(e,t,n,i){var r=Ci(e).abs(),a=Ja(r.as("s")),o=Ja(r.as("m")),s=Ja(r.as("h")),u=Ja(r.as("d")),l=Ja(r.as("M")),c=Ja(r.as("w")),h=Ja(r.as("y")),f=a<=n.ss&&["s",a]||a<n.s&&["ss",a]||o<=1&&["m"]||o<n.m&&["mm",o]||s<=1&&["h"]||s<n.h&&["hh",s]||u<=1&&["d"]||u<n.d&&["dd",u];return null!=n.w&&(f=f||c<=1&&["w"]||c<n.w&&["ww",c]),(f=f||l<=1&&["M"]||l<n.M&&["MM",l]||h<=1&&["y"]||["yy",h])[2]=t,f[3]=+e>0,f[4]=i,to.apply(null,f)}function io(e){return void 0===e?Ja:"function"==typeof e&&(Ja=e,!0)}function ro(e,t){return void 0!==eo[e]&&(void 0===t?eo[e]:(eo[e]=t,"s"===e&&(eo.ss=t-1),!0))}function ao(e,t){if(!this.isValid())return this.localeData().invalidDate();var n,i,r=!1,a=eo;return"object"==typeof e&&(t=e,e=!1),"boolean"==typeof e&&(r=e),"object"==typeof t&&(a=Object.assign({},eo,t),null!=t.s&&null==t.ss&&(a.ss=t.s-1)),i=no(this,!r,a,n=this.localeData()),r&&(i=n.pastFuture(+this,i)),n.postformat(i)}var oo=Math.abs;function so(e){return(e>0)-(e<0)||+e}function uo(){if(!this.isValid())return this.localeData().invalidDate();var e,t,n,i,r,a,o,s,u=oo(this._milliseconds)/1e3,l=oo(this._days),c=oo(this._months),h=this.asSeconds();return h?(e=le(u/60),t=le(e/60),u%=60,e%=60,n=le(c/12),c%=12,i=u?u.toFixed(3).replace(/\.?0+$/,""):"",r=h<0?"-":"",a=so(this._months)!==so(h)?"-":"",o=so(this._days)!==so(h)?"-":"",s=so(this._milliseconds)!==so(h)?"-":"",r+"P"+(n?a+n+"Y":"")+(c?a+c+"M":"")+(l?o+l+"D":"")+(t||e||u?"T":"")+(t?s+t+"H":"")+(e?s+e+"M":"")+(u?s+i+"S":"")):"P0D"}var lo=oi.prototype;return lo.isValid=ri,lo.abs=ba,lo.add=Ma,lo.subtract=Sa,lo.as=Da,lo.asMilliseconds=Oa,lo.asSeconds=Na,lo.asMinutes=wa,lo.asHours=La,lo.asDays=Fa,lo.asWeeks=Ba,lo.asMonths=Ua,lo.asQuarters=Va,lo.asYears=Ga,lo.valueOf=Ra,lo._bubble=xa,lo.clone=za,lo.get=Wa,lo.milliseconds=Xa,lo.seconds=ja,lo.minutes=Ya,lo.hours=Za,lo.days=Ka,lo.weeks=$a,lo.months=qa,lo.years=Qa,lo.humanize=ao,lo.toISOString=uo,lo.toString=uo,lo.toJSON=uo,lo.locale=or,lo.localeData=ur,lo.toIsoString=S("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",uo),lo.lang=sr,V("X",0,0,"unix"),V("x",0,0,"valueOf"),Ne("x",Pe),Ne("X",ke),Ue("X",(function(e,t,n){n._d=new Date(1e3*parseFloat(e))})),Ue("x",(function(e,t,n){n._d=new Date(ce(e))})),i.version="2.29.4",r(Kn),i.fn=ua,i.min=Jn,i.max=ei,i.now=ti,i.utc=p,i.unix=la,i.months=ma,i.isDate=h,i.locale=vn,i.invalid=_,i.duration=Ci,i.isMoment=T,i.weekdays=_a,i.parseZone=ca,i.localeData=_n,i.isDuration=si,i.monthsShort=ga,i.weekdaysMin=Ea,i.defineLocale=mn,i.updateLocale=gn,i.locales=yn,i.weekdaysShort=ya,i.normalizeUnits=ie,i.relativeTimeRounding=io,i.relativeTimeThreshold=ro,i.calendarFormat=Gi,i.prototype=ua,i.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"},i}()},5333:function(e,t,n){"use strict";n.d(t,{_y:function(){return o},zt:function(){return a}});var i=n(7294);n(5706);var r=i.createContext(null),a=(r.Consumer,r.Provider),o=r},78:function(e,t,n){"use strict";n.d(t,{Z:function(){return X}});var i=n(9900),r=n(7294),a=n(5333),o=n(5861),s=n(5477),u=n(1482),l=n(4889),c=n(7959);function h(e,t){return Object.keys(e).reduce((function(n,r){return n[r]=(0,i.pi)({timeZone:t},e[r]),n}),{})}function f(e,t){return Object.keys((0,i.pi)((0,i.pi)({},e),t)).reduce((function(n,r){return n[r]=(0,i.pi)((0,i.pi)({},e[r]||{}),t[r]||{}),n}),{})}function d(e,t){if(!t)return e;var n=u.C.formats;return(0,i.pi)((0,i.pi)((0,i.pi)({},n),e),{date:f(h(n.date,t),h(e.date||{},t)),time:f(h(n.time,t),h(e.time||{},t))})}var p=function(e,t,n,r,a){var o=e.locale,u=e.formats,h=e.messages,f=e.defaultLocale,p=e.defaultFormats,v=e.fallbackOnEmptyString,m=e.onError,g=e.timeZone,_=e.defaultRichTextElements;void 0===n&&(n={id:""});var y=n.id,E=n.defaultMessage;(0,s.kG)(!!y,"[@formatjs/intl] An `id` must be provided to format a message. You can either:\n1. Configure your build toolchain with [babel-plugin-formatjs](https://formatjs.io/docs/tooling/babel-plugin)\nor [@formatjs/ts-transformer](https://formatjs.io/docs/tooling/ts-transformer) OR\n2. Configure your `eslint` config to include [eslint-plugin-formatjs](https://formatjs.io/docs/tooling/linter#enforce-id)\nto autofix this issue");var A=String(y),b=h&&Object.prototype.hasOwnProperty.call(h,A)&&h[A];if(Array.isArray(b)&&1===b.length&&b[0].type===c.wD.literal)return b[0].value;if(!r&&b&&"string"==typeof b&&!_)return b.replace(/'\{(.*?)\}'/gi,"{$1}");if(r=(0,i.pi)((0,i.pi)({},_),r||{}),u=d(u,g),p=d(p,g),!b){if(!1===v&&""===b)return b;if((!E||o&&o.toLowerCase()!==f.toLowerCase())&&m(new l.$6(n,o)),E)try{return t.getMessageFormat(E,f,p,a).format(r)}catch(T){return m(new l.X9('Error formatting default message for: "'.concat(A,'", rendering default message verbatim'),o,n,T)),"string"==typeof E?E:A}return A}try{return t.getMessageFormat(b,o,u,(0,i.pi)({formatters:t},a||{})).format(r)}catch(T){m(new l.X9('Error formatting message: "'.concat(A,'", using ').concat(E?"default message":"id"," as fallback."),o,n,T))}if(E)try{return t.getMessageFormat(E,f,p,a).format(r)}catch(T){m(new l.X9('Error formatting the default message for: "'.concat(A,'", rendering message verbatim'),o,n,T))}return"string"==typeof b?b:"string"==typeof E?E:A},v=n(7143),m=["style","currency","currencyDisplay","unit","unitDisplay","useGrouping","minimumIntegerDigits","minimumFractionDigits","maximumFractionDigits","minimumSignificantDigits","maximumSignificantDigits","compactDisplay","currencyDisplay","currencySign","notation","signDisplay","unit","unitDisplay","numberingSystem"];function g(e,t,n){var i=e.locale,r=e.formats,a=e.onError;void 0===n&&(n={});var o=n.format,s=o&&(0,v.TB)(r,"number",o,a)||{};return t(i,(0,v.L6)(n,m,s))}function _(e,t,n,i){void 0===i&&(i={});try{return g(e,t,i).format(n)}catch(r){e.onError(new l.Rw(l.bc.FORMAT_ERROR,"Error formatting number.",r))}return String(n)}function y(e,t,n,i){void 0===i&&(i={});try{return g(e,t,i).formatToParts(n)}catch(r){e.onError(new l.Rw(l.bc.FORMAT_ERROR,"Error formatting number.",r))}return[]}var E=n(8402),A=["numeric","style"];function b(e,t,n,i,r){void 0===r&&(r={}),i||(i="second"),Intl.RelativeTimeFormat||e.onError(new E.u_('Intl.RelativeTimeFormat is not available in this environment.\nTry polyfilling it using "@formatjs/intl-relativetimeformat"\n',E.jK.MISSING_INTL_API));try{return function(e,t,n){var i=e.locale,r=e.formats,a=e.onError;void 0===n&&(n={});var o=n.format,s=!!o&&(0,v.TB)(r,"relative",o,a)||{};return t(i,(0,v.L6)(n,A,s))}(e,t,r).format(n,i)}catch(a){e.onError(new l.Qe("Error formatting relative time.",e.locale,a))}return String(n)}var T=["formatMatcher","timeZone","hour12","weekday","era","year","month","day","hour","minute","second","timeZoneName","hourCycle","dateStyle","timeStyle","calendar","numberingSystem","fractionalSecondDigits"];function M(e,t,n,r){var a=e.locale,o=e.formats,s=e.onError,u=e.timeZone;void 0===r&&(r={});var l=r.format,c=(0,i.pi)((0,i.pi)({},u&&{timeZone:u}),l&&(0,v.TB)(o,t,l,s)),h=(0,v.L6)(r,T,c);return"time"!==t||h.hour||h.minute||h.second||h.timeStyle||h.dateStyle||(h=(0,i.pi)((0,i.pi)({},h),{hour:"numeric",minute:"numeric"})),n(a,h)}function S(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var r=n[0],a=n[1],o=void 0===a?{}:a,s="string"==typeof r?new Date(r||0):r;try{return M(e,"date",t,o).format(s)}catch(u){e.onError(new l.Rw(l.bc.FORMAT_ERROR,"Error formatting date.",u))}return String(s)}function I(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var r=n[0],a=n[1],o=void 0===a?{}:a,s="string"==typeof r?new Date(r||0):r;try{return M(e,"time",t,o).format(s)}catch(u){e.onError(new l.Rw(l.bc.FORMAT_ERROR,"Error formatting time.",u))}return String(s)}function x(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var r=n[0],a=n[1],o=n[2],s=void 0===o?{}:o,u=e.timeZone,c=e.locale,h=e.onError,f=(0,v.L6)(s,T,u?{timeZone:u}:{});try{return t(c,f).formatRange(r,a)}catch(d){h(new l.Rw(l.bc.FORMAT_ERROR,"Error formatting date time range.",d))}return String(r)}function C(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var r=n[0],a=n[1],o=void 0===a?{}:a,s="string"==typeof r?new Date(r||0):r;try{return M(e,"date",t,o).formatToParts(s)}catch(u){e.onError(new l.Rw(l.bc.FORMAT_ERROR,"Error formatting date.",u))}return[]}function P(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var r=n[0],a=n[1],o=void 0===a?{}:a,s="string"==typeof r?new Date(r||0):r;try{return M(e,"time",t,o).formatToParts(s)}catch(u){e.onError(new l.Rw(l.bc.FORMAT_ERROR,"Error formatting time.",u))}return[]}var D=["type"];function R(e,t,n,i){var r=e.locale,a=e.onError;void 0===i&&(i={}),Intl.PluralRules||a(new E.u_('Intl.PluralRules is not available in this environment.\nTry polyfilling it using "@formatjs/intl-pluralrules"\n',E.jK.MISSING_INTL_API));var o=(0,v.L6)(i,D);try{return t(r,o).select(n)}catch(s){a(new l.Qe("Error formatting plural.",r,s))}return"other"}var k=["type","style"],O=Date.now();function N(e,t,n,i){void 0===i&&(i={});var r=w(e,t,n,i).reduce((function(e,t){var n=t.value;return"string"!=typeof n?e.push(n):"string"==typeof e[e.length-1]?e[e.length-1]+=n:e.push(n),e}),[]);return 1===r.length?r[0]:0===r.length?"":r}function w(e,t,n,r){var a=e.locale,o=e.onError;void 0===r&&(r={}),Intl.ListFormat||o(new E.u_('Intl.ListFormat is not available in this environment.\nTry polyfilling it using "@formatjs/intl-listformat"\n',E.jK.MISSING_INTL_API));var s=(0,v.L6)(r,k);try{var u={},c=n.map((function(e,t){if("object"==typeof e){var n=function(e){return"".concat(O,"_").concat(e,"_").concat(O)}(t);return u[n]=e,n}return String(e)}));return t(a,s).formatToParts(c).map((function(e){return"literal"===e.type?e:(0,i.pi)((0,i.pi)({},e),{value:u[e.value]||e.value})}))}catch(h){o(new l.Rw(l.bc.FORMAT_ERROR,"Error formatting list.",h))}return n}var L=["style","type","fallback"];function F(e,t,n,i){var r=e.locale,a=e.onError;Intl.DisplayNames||a(new E.u_('Intl.DisplayNames is not available in this environment.\nTry polyfilling it using "@formatjs/intl-displaynames"\n',E.jK.MISSING_INTL_API));var o=(0,v.L6)(i,L);try{return t(r,o).of(n)}catch(s){a(new l.Rw(l.bc.FORMAT_ERROR,"Error formatting display name.",s))}}function B(e){var t;e.onWarn&&e.defaultRichTextElements&&"string"==typeof((t=e.messages||{})?t[Object.keys(t)[0]]:void 0)&&e.onWarn('[@formatjs/intl] "defaultRichTextElements" was specified but "message" was not pre-compiled. \nPlease consider using "@formatjs/cli" to pre-compile your messages for performance.\nFor more details see https://formatjs.io/docs/getting-started/message-distribution')}var U=n(4597);function V(e){return{locale:e.locale,timeZone:e.timeZone,fallbackOnEmptyString:e.fallbackOnEmptyString,formats:e.formats,textComponent:e.textComponent,messages:e.messages,defaultLocale:e.defaultLocale,defaultFormats:e.defaultFormats,onError:e.onError,onWarn:e.onWarn,wrapRichTextChunksInFragment:e.wrapRichTextChunksInFragment,defaultRichTextElements:e.defaultRichTextElements}}function G(e){return e?Object.keys(e).reduce((function(t,n){var i=e[n];return t[n]=(0,U.Gt)(i)?(0,o.dt)(i):i,t}),{}):e}var z=function(e,t,n,a){for(var o=[],s=4;s<arguments.length;s++)o[s-4]=arguments[s];var u=G(a),l=p.apply(void 0,(0,i.ev)([e,t,n,u],o,!1));return Array.isArray(l)?r.Children.toArray(l):l},W=function(e,t){var n=e.defaultRichTextElements,r=(0,i._T)(e,["defaultRichTextElements"]),a=G(n),s=function(e,t){var n=(0,v.ax)(t),r=(0,i.pi)((0,i.pi)({},v.Z0),e),a=r.locale,o=r.defaultLocale,s=r.onError;return a?!Intl.NumberFormat.supportedLocalesOf(a).length&&s?s(new l.gb('Missing locale data for locale: "'.concat(a,'" in Intl.NumberFormat. Using default locale: "').concat(o,'" as fallback. See https://formatjs.io/docs/react-intl#runtime-requirements for more details'))):!Intl.DateTimeFormat.supportedLocalesOf(a).length&&s&&s(new l.gb('Missing locale data for locale: "'.concat(a,'" in Intl.DateTimeFormat. Using default locale: "').concat(o,'" as fallback. See https://formatjs.io/docs/react-intl#runtime-requirements for more details'))):(s&&s(new l.OV('"locale" was not configured, using "'.concat(o,'" as fallback. See https://formatjs.io/docs/react-intl/api#intlshape for more details'))),r.locale=r.defaultLocale||"en"),B(r),(0,i.pi)((0,i.pi)({},r),{formatters:n,formatNumber:_.bind(null,r,n.getNumberFormat),formatNumberToParts:y.bind(null,r,n.getNumberFormat),formatRelativeTime:b.bind(null,r,n.getRelativeTimeFormat),formatDate:S.bind(null,r,n.getDateTimeFormat),formatDateToParts:C.bind(null,r,n.getDateTimeFormat),formatTime:I.bind(null,r,n.getDateTimeFormat),formatDateTimeRange:x.bind(null,r,n.getDateTimeFormat),formatTimeToParts:P.bind(null,r,n.getDateTimeFormat),formatPlural:R.bind(null,r,n.getPluralRules),formatMessage:p.bind(null,r,n),$t:p.bind(null,r,n),formatList:N.bind(null,r,n.getListFormat),formatListToParts:w.bind(null,r,n.getListFormat),formatDisplayName:F.bind(null,r,n.getDisplayNames)})}((0,i.pi)((0,i.pi)((0,i.pi)({},o.Z0),r),{defaultRichTextElements:a}),t),u={locale:s.locale,timeZone:s.timeZone,fallbackOnEmptyString:s.fallbackOnEmptyString,formats:s.formats,defaultLocale:s.defaultLocale,defaultFormats:s.defaultFormats,messages:s.messages,onError:s.onError,defaultRichTextElements:a};return(0,i.pi)((0,i.pi)({},s),{formatMessage:z.bind(null,u,s.formatters),$t:z.bind(null,u,s.formatters)})},H=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.cache=(0,v.Sn)(),t.state={cache:t.cache,intl:W(V(t.props),t.cache),prevConfig:V(t.props)},t}return(0,i.ZT)(t,e),t.getDerivedStateFromProps=function(e,t){var n=t.prevConfig,i=t.cache,r=V(e);return(0,o.wU)(n,r)?null:{intl:W(r,i),prevConfig:r}},t.prototype.render=function(){return(0,o.lq)(this.state.intl),r.createElement(a.zt,{value:this.state.intl},this.props.children)},t.displayName="IntlProvider",t.defaultProps=o.Z0,t}(r.PureComponent),X=H},9785:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var i=n(7294),r=n(5333),a=n(5861);function o(){var e=i.useContext(r._y);return(0,a.lq)(e),e}},5861:function(e,t,n){"use strict";n.d(t,{Z0:function(){return u},dt:function(){return l},lq:function(){return s},wU:function(){return c}});var i=n(9900),r=n(7294),a=n(5477),o=n(7143);function s(e){(0,a.kG)(e,"[React Intl] Could not find required `intl` object. <IntlProvider> needs to exist in the component ancestry.")}var u=(0,i.pi)((0,i.pi)({},o.Z0),{textComponent:r.Fragment});function l(e){return function(t){return e(r.Children.toArray(t))}}function c(e,t){if(e===t)return!0;if(!e||!t)return!1;var n=Object.keys(e),i=Object.keys(t),r=n.length;if(i.length!==r)return!1;for(var a=0;a<r;a++){var o=n[a];if(e[o]!==t[o]||!Object.prototype.hasOwnProperty.call(t,o))return!1}return!0}},165:function(e,t){"use strict";var n="function"==typeof Symbol&&Symbol.for,i=n?Symbol.for("react.element"):60103,r=n?Symbol.for("react.portal"):60106,a=n?Symbol.for("react.fragment"):60107,o=n?Symbol.for("react.strict_mode"):60108,s=n?Symbol.for("react.profiler"):60114,u=n?Symbol.for("react.provider"):60109,l=n?Symbol.for("react.context"):60110,c=n?Symbol.for("react.async_mode"):60111,h=n?Symbol.for("react.concurrent_mode"):60111,f=n?Symbol.for("react.forward_ref"):60112,d=n?Symbol.for("react.suspense"):60113,p=n?Symbol.for("react.suspense_list"):60120,v=n?Symbol.for("react.memo"):60115,m=n?Symbol.for("react.lazy"):60116,g=n?Symbol.for("react.block"):60121,_=n?Symbol.for("react.fundamental"):60117,y=n?Symbol.for("react.responder"):60118,E=n?Symbol.for("react.scope"):60119;function A(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case i:switch(e=e.type){case c:case h:case a:case s:case o:case d:return e;default:switch(e=e&&e.$$typeof){case l:case f:case m:case v:case u:return e;default:return t}}case r:return t}}}function b(e){return A(e)===h}t.AsyncMode=c,t.ConcurrentMode=h,t.ContextConsumer=l,t.ContextProvider=u,t.Element=i,t.ForwardRef=f,t.Fragment=a,t.Lazy=m,t.Memo=v,t.Portal=r,t.Profiler=s,t.StrictMode=o,t.Suspense=d,t.isAsyncMode=function(e){return b(e)||A(e)===c},t.isConcurrentMode=b,t.isContextConsumer=function(e){return A(e)===l},t.isContextProvider=function(e){return A(e)===u},t.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===i},t.isForwardRef=function(e){return A(e)===f},t.isFragment=function(e){return A(e)===a},t.isLazy=function(e){return A(e)===m},t.isMemo=function(e){return A(e)===v},t.isPortal=function(e){return A(e)===r},t.isProfiler=function(e){return A(e)===s},t.isStrictMode=function(e){return A(e)===o},t.isSuspense=function(e){return A(e)===d},t.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===a||e===h||e===s||e===o||e===d||e===p||"object"==typeof e&&null!==e&&(e.$$typeof===m||e.$$typeof===v||e.$$typeof===u||e.$$typeof===l||e.$$typeof===f||e.$$typeof===_||e.$$typeof===y||e.$$typeof===E||e.$$typeof===g)},t.typeOf=A},8812:function(e,t,n){"use strict";e.exports=n(165)},9900:function(e,t,n){"use strict";n.d(t,{ZT:function(){return r},_T:function(){return o},ev:function(){return s},pi:function(){return a}});var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},i(e,t)};function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var a=function(){return a=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},a.apply(this,arguments)};function o(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}Object.create;function s(e,t,n){if(n||2===arguments.length)for(var i,r=0,a=t.length;r<a;r++)!i&&r in t||(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))}Object.create},6135:function(e,t,n){"use strict";var i=n(4948),r=n(3070),a=n(9114);e.exports=function(e,t,n){var o=i(t);o in e?r.f(e,o,a(0,n)):e[o]=n}},1246:function(e,t,n){var i=n(648),r=n(8173),a=n(8554),o=n(7497),s=n(5112)("iterator");e.exports=function(e){if(!a(e))return r(e,s)||r(e,"@@iterator")||o[i(e)]}},4121:function(e,t,n){var i=n(6916),r=n(9662),a=n(9670),o=n(6330),s=n(1246),u=TypeError;e.exports=function(e,t){var n=arguments.length<2?s(e):t;if(r(n))return a(i(n,e));throw u(o(e)+" is not iterable")}},7659:function(e,t,n){var i=n(5112),r=n(7497),a=i("iterator"),o=Array.prototype;e.exports=function(e){return void 0!==e&&(r.Array===e||o[a]===e)}},408:function(e,t,n){var i=n(9974),r=n(6916),a=n(9670),o=n(6330),s=n(7659),u=n(6244),l=n(7976),c=n(4121),h=n(1246),f=n(9212),d=TypeError,p=function(e,t){this.stopped=e,this.result=t},v=p.prototype;e.exports=function(e,t,n){var m,g,_,y,E,A,b,T=n&&n.that,M=!(!n||!n.AS_ENTRIES),S=!(!n||!n.IS_RECORD),I=!(!n||!n.IS_ITERATOR),x=!(!n||!n.INTERRUPTED),C=i(t,T),P=function(e){return m&&f(m,"normal",e),new p(!0,e)},D=function(e){return M?(a(e),x?C(e[0],e[1],P):C(e[0],e[1])):x?C(e,P):C(e)};if(S)m=e.iterator;else if(I)m=e;else{if(!(g=h(e)))throw d(o(e)+" is not iterable");if(s(g)){for(_=0,y=u(e);y>_;_++)if((E=D(e[_]))&&l(v,E))return E;return new p(!1)}m=c(e,g)}for(A=S?e.next:m.next;!(b=r(A,m)).done;){try{E=D(b.value)}catch(R){f(m,"throw",R)}if("object"==typeof E&&E&&l(v,E))return E}return new p(!1)}},9212:function(e,t,n){var i=n(6916),r=n(9670),a=n(8173);e.exports=function(e,t,n){var o,s;r(e);try{if(!(o=a(e,"return"))){if("throw"===t)throw n;return n}o=i(o,e)}catch(u){s=!0,o=u}if("throw"===t)throw n;if(s)throw o;return r(o),n}},7497:function(e){e.exports={}},365:function(e,t,n){"use strict";var i=n(3111).end,r=n(6091);e.exports=r("trimEnd")?function(){return i(this)}:"".trimEnd},6091:function(e,t,n){var i=n(6530).PROPER,r=n(7293),a=n(1361);e.exports=function(e){return r((function(){return!!a[e]()||"​᠎"!=="​᠎"[e]()||i&&a[e].name!==e}))}},3217:function(e,t,n){"use strict";var i=n(3111).start,r=n(6091);e.exports=r("trimStart")?function(){return i(this)}:"".trimStart},3111:function(e,t,n){var i=n(1702),r=n(4488),a=n(1340),o=n(1361),s=i("".replace),u="["+o+"]",l=RegExp("^"+u+u+"*"),c=RegExp(u+u+"*$"),h=function(e){return function(t){var n=a(r(t));return 1&e&&(n=s(n,l,"")),2&e&&(n=s(n,c,"")),n}};e.exports={start:h(1),end:h(2),trim:h(3)}},1340:function(e,t,n){var i=n(648),r=String;e.exports=function(e){if("Symbol"===i(e))throw TypeError("Cannot convert a Symbol value to a string");return r(e)}},1361:function(e){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},4944:function(e,t,n){"use strict";var i=n(2109),r=n(6790),a=n(7908),o=n(6244),s=n(9303),u=n(5417);i({target:"Array",proto:!0},{flat:function(){var e=arguments.length?arguments[0]:void 0,t=a(this),n=o(t),i=u(t,0);return i.length=r(i,t,t,n,0,void 0===e?1:s(e)),i}})},3792:function(e,t,n){n(1223)("flat")},8559:function(e,t,n){var i=n(2109),r=n(408),a=n(6135);i({target:"Object",stat:!0},{fromEntries:function(e){var t={};return r(e,(function(e,n){a(t,e,n)}),{AS_ENTRIES:!0}),t}})},8702:function(e,t,n){n(3462);var i=n(2109),r=n(365);i({target:"String",proto:!0,name:"trimEnd",forced:"".trimEnd!==r},{trimEnd:r})},9967:function(e,t,n){var i=n(2109),r=n(3217);i({target:"String",proto:!0,name:"trimStart",forced:"".trimLeft!==r},{trimLeft:r})},3462:function(e,t,n){var i=n(2109),r=n(365);i({target:"String",proto:!0,name:"trimEnd",forced:"".trimRight!==r},{trimRight:r})},5674:function(e,t,n){n(9967);var i=n(2109),r=n(3217);i({target:"String",proto:!0,name:"trimStart",forced:"".trimStart!==r},{trimStart:r})},9325:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var i={en:JSON.parse('{"hero:title":"Start building your product today","hero:subtitle":"We define, build and scale digital products that people want and businesses need.","clients:title":"Our engineers have worked with","cta:title":"They’ll love your product, you’ll love our process.","cta:text":"We offer you the peace of mind of knowing that you are in good hands. ","cta2:title":"Our team thinks sharp, builds fast and deploys frequently.","cta2:action":"I want a team like that!","cta3:title":"Have an awesome idea and not sure how to get started? ","cta3:action":"Help me make it real!","approach:name":"Our approach","team:name":"The team","startups:name":"For startups","team:title":"Meet the team","team:pretitle":"Team","team:position:ignacio":"Project Manager","team:description:ignacio":"Obsessed with the process of continuous improvement. If something poses a challenge, he will find it inviting. Uncontrollable competitive gene.","team:position:antonio":"Tech Consultant","team:description:antonio":"Software engineer specialized in 3D and data visualization technologies. Passionate about teaching, ancient editors and esoteric programming languages.","team:position:sara":"UI Developer","team:description:sara":"Specialist in crafting high-quality digital product experiences. Likes reading, painting and illustrating and has created over 1000 artworks.","team:position:juanlu":"Full Stack","team:description:juanlu":"Inveterate techie and expert drone pilot. Has created dozens of videogames and web experiences. No stack is out of reach.","team:section2:title":"The best product delivery partner","team:claim1":"Product-centric","team:claim2":"Agile and lean","team:claim3":"Lightning fast","team:claim4":"Tailored to you","services:title":"What we can do for you","services:name":"Our services","services:pretitle":"Our main service is to meet your needs","services:intro-text":"Front-end multiplatform applications, scalable cloud infrastructures, complex 3D visualizations... No project is out of your reach. ","services:service1:title":"Product design","services:service1:text":"Design a killer product with the best user experience for your clients.","services:service2:title":"Product development","services:service2:text":"Turn your business idea into reality with the industry’s best technologies.","services:service3:title":"Dedicated team","services:service3:text":"Give a boost to your project with the help of a top tier tech team.","services:service4:title":"Software consultancy","services:service4:text":"Improve your existing software or train your engineers to get to the next level.","services:section2:title":"What you will get from us","services:service5:title":"Faster time to market","services:service6:title":"Things done right","services:service7:title":"Top 1% tech talent","services:service8:title":"True agile development","aucta:title":"We’re the team that built Aucta’s 3D web editor!","aucta:show-case-study":"Show me the case study!","aucta:go":"Go to Aucta!","approach:title":"How we make it work","approach:intro-text":"We’ve narrowed down the process to three simple steps to turn your idea into a digital product.","approach:step1:title":"Discover & define","approach:step1:text":"We sit down with you and learn all there is to know about your product idea and business needs, research your industry, competition and users, to define the best unique value proposition for your product.","approach:step2:title":"Design & build","approach:step2:text":"All that information is then used to design a beatiful and user friendly experience that will be implemented using the industry’s latest technologies to ensure it is optimized to the fullest.","approach:step3:title":"Launch & scale","approach:step3:text":"Finishing the development of the product is not the end of the road. Launching it into market and gathering data from users is key to define the next steps in the product roadmap.","approach:section2:title":"What we can build for you","approach:claim1":"Progressive web apps","approach:claim2":"SaaS applications","approach:claim3":"Enterprise applications","approach:claim4":"Custom CRM systems","approach:claim5":"Cloud-based applications","approach:claim6":"Single page apps","approach:claim7":"Ecommerce","approach:claim8":"API development","startups:title":"Build your business idea with us","startups:why":"Why?","startups:why:text":"Because you will...","startups:how":"How?","startups:how:text":"There’s a lot of work to do...","startups:service1:title":"Have a team with startup experience","startups:service1:text":"We know the problems startups face during the early stages. We’ll help you get the most value.","startups:service2:title":"Save money on development costs","startups:service2:text":"Building a team from the ground up is not an easy nor fast process. A battle tested team will get results faster.","startups:service3:title":"Beat your competition to market","startups:service3:text":"We don’t like to boast, but we work fast. At this early stage in your business, getting to market as soon as possible is a must.","startups:service4:title":"Have a CTO on demand to guide you","startups:service4:text":"Top tech talent is not easy to find. With us you will have access to knowledge that will boost your product.","startups:service5:title":"Idea validation","startups:service6:title":"Technical feasibility check","startups:service7:title":"Brand & UX/UI design","startups:service8:title":"User stories & user journey","startups:service9:title":"MVP feature list","startups:service10:title":"Estimation and timeline","startups:service11:title":"High fidelity design screens","startups:service12:title":"Development & launch","map:title":"You can find us at","map:address1":" Sector Literatos 38.","map:address2":"28760, Tres Cantos. Madrid (Spain)","contact:title":"Got a project in mind? Tell us all about it!","contact:name":"Name","contact:whats-your-name":"What’s your name?","contact:company":"Company","contact:what-company-work":"What company do you work for?","contact:email":"Email","contact:give-us-email":"Give us an email to contact you!","contact:purpose":"I want to:","contact:purpose1":"Hire a development team","contact:purpose2":"Build a digital product from scratch","contact:purpose3":"Redesign an app or improve UX","contact:purpose4":"Something else","contact:budget":"Budget","contact:tell-us-budget":"Tell us your budget! (if you want to)","contact:how-can-we-help-you":"How can we help you?","contact:tell-us-more":"Tell us more about your project!","contact:lets-work-together":"Let’s work together!","contact:error-email":"Incorrect email","contact:error-required":"This field is required","contact:error-select":"Please select one","contact:extra-text":"If you don\'t like forms, you can reach us at <a> hello@bonsaitech.io </a>","quote:text":"I’m saving tons of project management time with Bonsai, because they listen very carefully, ask the right questions upfront and have an eye to engineer excellent web applications you will only get from senior people. They’re specialized and absolutely premium when it comes to UI/UX heavy React based web apps.","quote:daniel-position":"Founder at Aucta","quote:action":"Check Daniel’s Website!","action:hire":"Hire your team now!","action:lets-start":"Let’s start now!","action:lets-talk":"Let’s talk!","action:start-working":"Let\'s get to work now","action:lets-make-it-happen":"Let’s make it happen!","action:program-meeting":"Schedule a meeting","action:ask-budget":"Ask for a quote","action:tell-us-your-project":"Tell us about your project","info:based-madrid":"We are based in Madrid (Spain)","info:all-rights-reserved":"All rights reserved","info:privacy":"Privacy policy","info:legal":"Legal notice","info:cookies":"Cookies","privacy:section1:title1":"Data of the Data Controller","privacy:section1:item1":"Company Name: Ignacio Ramos Howell Company, hereinafter \'The Company\'.","privacy:section1:item2":"Commercial Name: Bonsai.","privacy:section1:item3":"Registered Address: Sector Literatos 38, 28760 Tres Cantos, Madrid.","privacy:section1:item4":"NIF: 53657188M","privacy:section1:item5":"Telephone: 646 036 206","privacy:section1:item6":"Email: hola@bonsaitech.io","privacy:section1:title2":"1.1. Applicable regulations","privacy:section1:text1":"Our Privacy Policy has been designed in accordance with the EU General Data Protection Regulation 2016/679 of the European Parliament and of the Council of 27 April 2016 on the protection of natural persons with regard to the processing of personal data and on the free movement of such data and repealing Directive 95/46/EC (General Data Protection Regulation), and Organic Law 3/2018 of 5 December, on the Protection of Personal Data and Guarantee of Digital Rights. By providing us with your data, you declare that you have read and are aware of this Privacy Policy, giving your unequivocal and express consent to the processing of your personal data in accordance with the purposes and terms expressed herein. The Company may modify this Privacy Policy to adapt it to new legislation, jurisprudence or interpretation of the Spanish Data Protection Agency. These privacy conditions may be supplemented by the Legal Notice, Cookies Policy and General Conditions, if any, are collected for certain products or services, if such access involves any specialty in the field of personal data protection.","privacy:section1:title3":"1.2. Data Protection Officer","privacy:section1:text2":"The person responsible for the file is Ignacio Ramos Howell. If you wish to exercise your rights of access, rectification, cancellation or opposition, you may do so before the data controller by any means that allows proof of sending and receipt, or by sending an email to the following email address: hola@bonsaitech.io. ","privacy:section2:title1":"2. Purpose of the Processing of Personal Data","privacy:section2:text1":"The processing we carry out of your personal data responds to the following purposes:","privacy:section2:text2":"Management of communication with people interested in contracting our services.","privacy:section2:title2":"2.1. Retention period of your data.","privacy:section2:text3":"We will keep your personal data from the time you give us your consent until you revoke it or request the limitation of processing. In such cases, we will keep your data blocked for the legally required periods.","privacy:section3:title1":"3. Legitimation and Data Collected","privacy:section3:text1":"The legitimacy for the processing of your data is the express consent given by a positive and affirmative act (fill out the appropriate form and check the box of acceptance of this policy) at the time of providing us with your personal data.","privacy:section3:title2":"3.1. Consent to process your data","privacy:section3:text2":"By filling in the forms, checking the box \'I accept the Privacy Policy\' and clicking to send the data, or by sending e-mails to the Company through the accounts provided for this purpose, the User declares to have read and expressly accepted this privacy policy, and gives his unequivocal and express consent to the processing of his personal data in accordance with the purposes indicated.","privacy:section3:title3":"3.2. Categories of data","privacy:section3:text3":"The data to be collected will be personal.","privacy:section4:title1":"4. Security Measures","privacy:section4:text1":"As part of our commitment to ensure the security and confidentiality of your personal data, we inform you that we have adopted the necessary technical and organizational measures to ensure the security of personal data and prevent its alteration, loss, unauthorized processing or access, given the state of technology, the nature of the data stored and the risks to which they are exposed, according to Art. 32 of the RGPD EU 679/2016.","privacy:section5:title1":"5. Transfer of Data","privacy:section5:text1":"No data transfers or international transfers of your data are foreseen, except for those authorized by tax, commercial and telecommunications legislation as well as in cases where we are required to do so by a judicial authority.","privacy:section6:title1":"6. User Rights","privacy:section6:text1":"Any interested party has the right to obtain confirmation as to whether or not we are processing personal data concerning him/her. Interested parties have the right to access their personal data, as well as to request the rectification of inaccurate data or, where appropriate, to request its deletion when, among other reasons, the data is no longer necessary for the purposes for which it was collected. In certain circumstances, the interested parties may request the limitation of the processing of their data, in which case we will only keep them for the exercise or defense of claims. For reasons related to their particular situation, data subjects may object to the processing of their data. The Data Controller will stop processing the data, except for compelling legitimate reasons, or the exercise or defense of possible claims. In accordance with current legislation, you have the following rights: the right to request access to your personal data, the right to request its rectification or deletion, the right to request the limitation of its processing, the right to oppose its processing, the right to data portability and, likewise, to revoke the consent given. You also have the right to file a complaint with the Spanish Data Protection Agency.","privacy:section6:title2":"6.1. How to exercise my rights?  ","privacy:section6:text2":"To exercise your rights, you must contact the person responsible, requesting the corresponding form for the exercise of the chosen right. Optionally, you can go to the competent Control Authority to obtain additional information about your rights. The contact details for the exercise of your rights are telephone → 647 036 206 and email: → hola@bonsaitech.io. Remember to accompany a copy of a document that allows us to identify you. ","privacy:section7:title1":"7. Consent to send Electronic Communications","privacy:section7:text1":"Likewise, and in accordance with the provisions of Law 34/2002, of July 11, 2002, on Information Society Services and Electronic Commerce, by completing the data collection form and checking the corresponding box \'I accept the sending of electronic communications\', you are giving your express consent to send information about the Company to your email address, telephone, fax or other electronic means.","legal:section1:text1":"In order to comply with Article 10 of Law 34/2002 of Services of the Information Society and Electronic Commerce, we inform the user of our data:","legal:section1:item1":"Company Name: Ignacio Ramos Howell, hereinafter \'The Provider\'.","legal:section1:item2":"Commercial Name: Bonsai","legal:section1:item3":"Registered Address: Sector Literatos 38, 28760 Tres Cantos, Madrid.","legal:section1:item4":"NIF: 53657188M","legal:section1:item5":"Telephone: 646 036 206.","legal:section1:item6":"Email: hola@bonsaitech.io","legal:section2:title1":"Object","legal:section2:text1":"The provider, responsible for the website, makes available to users this document with which it intends to comply with the obligations under Law 34/2002, of Services of the Information Society and Electronic Commerce (LSSI-CE), as well as inform all users of the website regarding what are the conditions of use of the website.","legal:section2:text2":"Any person accessing this website assumes the role of user, committing to the observance and strict compliance with the provisions herein, as well as any other legal provision that may be applicable.","legal:section2:text3":"The provider reserves the right to modify any type of information that may appear on the website, without any obligation to give prior notice or inform users of such obligations, being understood as sufficient with the publication on the website of the provider.","legal:section3:title1":"Responsibility","legal:section3:text1":"The provider disclaims any liability for the information published on its website, provided that this information has been manipulated or introduced by a third party external to it.","legal:section3:text2":"The provider\'s website may use cookies (small information files that the server sends to the computer of the person accessing the page) to carry out certain functions that are considered essential for the proper functioning and visualization of the site. The cookies used on the website are, in any case, of a temporary nature for the sole purpose of making more efficient onward transmission and disappear at the end of the user\'s session. Under no circumstances will cookies be used to collect personal information. <a>Cookies Policy</a>.","legal:section3:text3":"From the client\'s website you may be redirected to content on third party websites. Since the provider can not always control the content posted by third parties on their websites, it does not assume any responsibility for such content. In any case, the provider states that it will proceed to the immediate removal of any content that could violate national or international law, morality or public order, proceeding to the immediate withdrawal of the redirection to that website, informing the competent authorities of the content in question.","legal:section3:text4":"The provider is not responsible for the information and content stored, including but not limited to, forums, chats, blogs generators, comments, social networks or any other means that allows third parties to publish content independently on the website of the provider. However, and in compliance with the provisions of art. 11 and 16 of the LSSI-CE, the provider is available to all users, authorities and security forces, and actively collaborating in the removal or blocking of all content that could affect or contravene national or international law, the rights of third parties or morality and public order. In the event that the user considers that there is any content on the website that could be susceptible to this classification, please notify the website administrator immediately.","legal:section3:text5":"This website has been checked and tested for proper operation. In principle, it can be guaranteed to function correctly 365 days a year, 24 hours a day. However, the provider does not rule out the possibility of the existence of certain programming errors, or the occurrence of force majeure, natural disasters, strikes, or similar circumstances that make it impossible to access the website.","legal:section4:title1":"Intellectual and Industrial Property","legal:section4:text1":"The website, including but not limited to programming, editing, compilation and other elements necessary for its operation, designs, logos, text and / or graphics are the property of the provider or if you have a license or express authorization from the authors. All the contents of the website are duly protected by intellectual and industrial property regulations, as well as registered in the corresponding public registries.","legal:section4:text2":"Regardless of the purpose for which they were intended, the total or partial reproduction, use, exploitation, distribution and marketing, in any case requires prior written authorization from the provider. Any use not previously authorized by the provider will be considered a serious breach of the intellectual or industrial property rights of the author.","legal:section4:text3":"The designs, logos, text and / or graphics outside the provider and that may appear on the website belong to their respective owners, themselves responsible for any dispute that may arise in respect thereof. In any case, the provider has the express and prior authorization from them.","legal:section4:text4":"The provider DOES NOT expressly AUTHORIZE third parties to redirect directly to the specific contents of the website, and in any case must redirect to the main website of the provider.","legal:section4:text5":"The provider recognizes in favor of their owners the corresponding industrial and intellectual property rights, not implying its mere mention or appearance on the website the existence of any rights or liability of the provider on them, nor endorsement, sponsorship or recommendation by the same.","legal:section4:text6":"To make any comments regarding possible breaches of the rights of intellectual or industrial property, as well as any of the contents of the website, you can do so through the email address listed in the identification data at the beginning of this document.","legal:section5:title1":"Accuracy of the Information","legal:section5:text1":"All the information provided by the User must be truthful. To these effects, the User guarantees the authenticity of the data communicated through the forms for the subscription of the Services. It will be the User\'s responsibility to keep all the information provided to the Company permanently updated so that it corresponds, at all times, to his or her real situation. In any case, the User will be solely responsible for any false or inaccurate statements made and the damages caused to the provider or third parties.","legal:section6:title1":"Minors","legal:section6:text1":"For the use of the services, minors must always obtain prior consent from parents, guardians or legal representatives, ultimately responsible for all acts performed by minors in their care. The responsibility for determining the specific content accessed by minors lies with them, which is why if they access inappropriate content on the Internet, mechanisms must be established on their computers, in particular computer programs, filters and blocks, which allow them to limit the content available and, although not infallible, are particularly useful for controlling and restricting the material to which minors may have access.","legal:section7:title1":"Obligation to make correct use of the Website","legal:section7:text1":"The User agrees to use the Web in accordance with the Law and this Legal Notice, as well as morality and good customs. To this end, the User will refrain from using the page for illegal or prohibited purposes, harmful to the rights and interests of third parties, or in any way damage, disable, overburden, impair or impede the normal use of computer equipment or documents, files and all kinds of content stored on any computer equipment of the provider.","legal:section7:text2":"In particular, and by way of example but not exhaustive, the User undertakes not to transmit, disseminate or make available to third parties information, data, content, messages, graphics, drawings, sound or image files, photographs, recordings, software and, in general, any kind of material that:","legal:section7:text3":"(a) is contrary to, disregards or infringes upon fundamental rights and public liberties recognized in the Constitution, international treaties and other applicable laws;","legal:section7:text4":"(b) induces, incites or promotes criminal, denigrating, defamatory, violent or, in general, contrary to the law, morality and public order;","legal:section7:text5":"(c) induces, incites or promotes discriminatory actions, attitudes or thoughts based on sex, race, religion, beliefs, age or condition;","legal:section7:text6":"(d) is contrary to the right to honor, to personal or family privacy or to one\'s own image;  ","legal:section7:text7":"(e) in any way damages the credibility of the provider or third parties; and","legal:section7:text8":"(f) constitutes unlawful, misleading or unfair advertising.","legal:section8:title1":"Applicable Law and Jurisdiction","legal:section8:text1":"For the resolution of all disputes or questions related to this website or the activities developed in it, will apply Spanish law, to which the parties expressly submit themselves, being competent for the resolution of all disputes arising from or related to its use the Courts and Tribunals of the Community of Madrid.","cookies:section1:title1":"General Information","cookies:section1:text1":"Due to the entry into force of the amendment of the \'Law of Services of the Information Society\' (LSSICE) established by Royal Decree 13/2012, it is mandatory to obtain the express consent of the user of all websites that use cookies expendable, before the user navigates through them.","cookies:section1:title2":"What are cookies?","cookies:section1:text2":"Cookies and other similar technologies such as local shared objects, flash cookies or pixels, are tools used by Web servers to store and retrieve information about their visitors, as well as to provide a proper functioning of the site.","cookies:section1:text3":"The use of these devices allows the Web server to remember some data concerning the user, such as your preferences for viewing the pages of that server, name and password, products that most interest you, etc..","cookies:section1:title3":"Cookies affected by the regulation and exempted cookies","cookies:section1:text4":"According to the EU directive, the cookies that require the user\'s informed consent are analytical cookies and advertising and affiliation cookies, with the exception of technical cookies and those necessary for the operation of the website or the provision of services expressly requested by the user.","cookies:section1:title4":"What types of cookies exist?","cookies:section1:text5":"According to their ownership","cookies:section1:item1":"Own Cookies: These are those that are sent to the user\'s terminal equipment from a computer or domain managed by the editor itself and from which the service requested by the user is provided.","cookies:section1:item2":"Third-party cookies: These are those that are sent to the user\'s terminal equipment from a computer or domain that is not managed by the editor, but by another entity that processes the data obtained through the cookies.","cookies:section1:text6":"According to their duration","cookies:section1:item3":"Session Cookies: These are a type of cookies designed to collect and store data while the user accesses a web page.","cookies:section1:item4":"Persistent cookies: They are a type of cookies in which the data remain stored in the terminal and can be accessed and treated for a period defined by the person responsible for the cookie, and that can range from a few minutes to several years.","cookies:section1:text7":"According to their functionality  ","cookies:section1:item5":"Necessary cookies: these are essential for the correct functioning of the website. They do not collect any type of user data and collect information such as language preference, whether the cookie policy has been accepted, etc.","cookies:section1:item6":"Analysis Cookies: These are those that are well treated by us or by third parties, allow us to quantify the number of users and thus perform the measurement and statistical analysis of the use made by users of the service offered. To do this, your browsing on our website is analyzed in order to improve the range of products or services we offer.","cookies:section1:item7":"Advertising or marketing cookies: These are those that allow the management, in the most effective way possible, of advertising spaces that, where appropriate, the editor has included on a website, application or platform from which provides the requested service based on criteria such as the edited content or the frequency at which the ads are displayed.","cookies:section1:item8":"Cookies behavioral advertising or personalized marketing: These are those that allow the management, as effectively as possible, of advertising spaces that, where appropriate, the publisher has included on a web page, application or platform from which it provides the requested service. These cookies store information on user behavior obtained through the continuous observation of their browsing habits, which allows the development of a specific profile to display advertising based on the same. It is also possible that when you visit a web page or open an email where an advertisement or promotion about our products or services is published, a cookie may be installed in your browser that helps us to later show you advertising related to the search you have made, develop a control of our ads in relation to, for example, the number of times they are viewed, where they appear, what time they are seen, etc..","cookies:section2:title1":"Cookie Statement","cookies:section2:text1":"Please complete the following table with information on all cookies used on your website.","cookies:section2:table-header1":"Cookie","cookies:section2:table-header2":"Owner","cookies:section2:table-header3":"Duration","cookies:section2:table-header4":"Purpose","cookies:section2:table-header5":"Type","cookies:section2:table-cell21":"_gsas ","cookies:section2:table-cell22":".bonsaitech.io","cookies:section2:table-cell23":"1 year 24 days","cookies:section2:table-cell24":"---","cookies:section2:table-cell25":"Others","cookies:section2:table-cell1":"CONSENT","cookies:section2:table-cell2":".google.com","cookies:section2:table-cell3":"2 years","cookies:section2:table-cell4":"YouTube sets this cookie via embedded youtube-videos and registers anonymous statistical data","cookies:section2:table-cell5":"Analytics","cookies:section2:title2":"Revocation of consent to install Cookies","cookies:section2:text2":"Explains in this section how users can withdraw or modify their consent to the use of cookies.  ","cookies:section2:text3":"How to remove Cookies from the browser.","cookies:section2:item1":"Chrome: <a> https://support.google.com/chrome/answer/95647 </a>","cookies:section2:item2":"Internet Explorer: <a> https://support.microsoft.com/es-es/help/17442/windows-internet-explorer-delete-manage-cookies </a>","cookies:section2:item3":"Firefox: <a> https://support.mozilla.org/es/kb/habilitar-y-deshabilitar-cookies-sitios-web-rastrear-preferencias </a>","cookies:section2:item4":"Safari: <a> https://support.apple.com/es-es/guide/safari/sfri11471/mac </a>","cookies:section2:item5":"Opera: <a> https://www.opera.com/help/tutorials/security/privacy/ </a>","cookies:section2:text4":"If it is not listed, consult the documentation of the browser you have installed to block, delete or allow the downloading of Cookies."}'),es:JSON.parse('{"hero:title":"Empieza a crear tu producto hoy","hero:subtitle":"Definimos, creamos y escalamos productos digitales que la gente quiere y los negocios necesitan.","clients:title":"Nuestros desarrolladores han trabajado con","cta:title":"Les encantará tu producto, amarás nuestro proceso.","cta:text":"Te ofrecemos la tranquilidad de saber que estás en buenas manos.","cta2:title":"Nuestro equipo piensa de forma ingeniosa, construye rápidamente y despliega con frecuencia.","cta2:action":"¡Quiero un equipo como ese!","cta3:title":"¿Tienes una gran idea y no sabes cómo empezar?","cta3:action":"¡Ayúdame a hacerlo realidad!","approach:name":"Nuestro enfoque","startups:name":"Para startups","team:title":"Conoce al equipo","team:pretitle":"Equipo","team:position:ignacio":"Gestor de proyecto","team:description:ignacio":"Obsesionado con el proceso de mejora continua. Todo lo que supone un reto le resulta atractivo. Incontrolable gen competitivo.","team:position:antonio":"Consultor tecnológico","team:description:antonio":"Ingeniero del software especializado en visualizaciones de datos y 3D. Apasionado de emacs, enseñar a programar y los lenguajes de programación esotéricos.","team:position:sara":"Desarrolladora UI","team:description:sara":"Especialista en la creación experiencias de productos digitales de alta calidad. Le gusta leer, dibujar y ha producido alrededor de 1.000 illustraciones de arte digital.","team:position:juanlu":"Desarrollador Full Stack","team:description:juanlu":"Entusiasta de la tecnología y el pilotaje de drones. Ha creado docenas de videojuegos y experiencias web. Ningún stack está fuera de alcance.","team:section2:title":"El mejor socio de entrega de productos.","team:claim1":"Centrado en producto","team:claim2":"Ágil y sin grasa","team:claim3":"Velocidad relámpago","team:claim4":"Adaptado a ti","services:title":"Lo que podemos hacer por ti","services:name":"Nuestros servicios","services:pretitle":"Nuestro servicio principal es cubrir tus necesidades","services:intro-text":"Aplicaciones front-end multiplataforma, infraestructuras cloud escalables, visualizaciones 3D complejas... Ningún proyecto fuera de tu alcance.","services:service1:title":"Diseño de producto","services:service1:text":"Diseña un producto con la mejor experiencia de usuario para tus clientes.","services:service2:title":"Desarrollo de producto","services:service2:text":"Convierte tu idea de negocio en realidad con las mejores tecnologías de la industria.","services:service3:title":"Equipo dedicado","services:service3:text":"Dale un impulso a tu proyecto con la ayuda de un equipo technológico de primera categoría.","services:service4:title":"Consultoría de software","services:service4:text":"Mejora tu software o entrena a tus ingenieros para que alcancen el siguiente nivel.","services:section2:title":"Lo que conseguirás con nosotros","services:service5:title":"Rapidez de llegada al mercado","services:service6:title":"Cosas bien hechas","services:service7:title":"Mejor 1% del talento tecnológico","services:service8:title":"Desarrollo ágil de verdad","aucta:title":"¡Somos el equipo que ha construido el editor 3D de Aucta!","aucta:show-case-study":"¡Muestrame el caso de estudio!","aucta:go":"¡Ir a Aucta!","approach:title":"Cómo hacemos que funcione","approach:intro-text":"Hemos acotado el proceso a tres pasos sencillos para convertir tu idea en un producto digital.","approach:step1:title":"Descubre & define","approach:step1:text":"Nos sentamos contigo y conocemos todo lo necesario sobre tu idea de producto y las necesidades de tu negocio, investigamos sobre tu industria, competencia y usuarios, para definir la mejor propuesta de valor para tu producto.","approach:step2:title":"Diseña & construye","approach:step2:text":"Toda esa información es luego utilizada para diseñar una experiencia de usuario amigable y bonita que será implementada utilizando las últimas tecnologías de la industria para garantizar que esté optimizada al máximo.","approach:step3:title":"Lanzamiento & escala","approach:step3:text":"Terminar el desarrollo del producto no es el final del camino. Lanzarlo al mercado y recopilar datos de los usuarios es clave para definir los próximos pasos en el mapa de ruta del producto.","approach:section2:title":"Lo que podemos construir para ti","approach:claim1":"Aplicaciones web progresivas","approach:claim2":"Aplicaciones SaaS","approach:claim3":"Aplicaciones empresariales","approach:claim4":"Sistemas CRM a medida","approach:claim5":"Aplicaciones basadas en la nube","approach:claim6":"Aplicaciones de una sola página","approach:claim7":"Ecommerce","approach:claim8":"Desarrollo de API","startups:title":"Construye tu ida de negocio con nosotros","startups:why":"Por qué?","startups:why:text":"Porque...","startups:how":"Cómo?","startups:how:text":"Hay mucho trabajo que hacer...","startups:service1:title":"Dispón de un equipo con experiencia en startups","startups:service1:text":"Conocemos los problemas que enfrentan las startups durante las etapas iniciales. Te ayudaremos a obtener el máximo valor.","startups:service2:title":"Ahorra dinero en costes de desarrollo","startups:service2:text":"Formar un equipo desde cero no es un proceso fácil ni rápido. Un equipo experimentado obtendrá resultados más rápidamente.","startups:service3:title":"Supera a tu competencia en el mercado","startups:service3:text":"No nos gusta presumir, pero trabajamos rápido. En esta etapa temprana de su negocio, llegar al mercado lo más pronto posible es imprescindible. ","startups:service4:title":"Ten un CTO disponible bajo demanda para guiarte","startups:service4:text":"El mejor talento tecnológico no es fácil de encontrar. Con nosotros, tendrás acceso al conocimiento que impulsará tu producto.","startups:service5:title":"Validación de tu idea","startups:service6:title":"Verificación de factibilidad técnica","startups:service7:title":"Marca & diseño UX/UI","startups:service8:title":"Historias de usuario y recorrido de usuario","startups:service9:title":"Lista de requisitos de MVP","startups:service10:title":"Estimación & cronograma","startups:service11:title":"Diseño de pantallas de alta fidelidad","startups:service12:title":"Desarrollo & lanzammiento","team:name":"El equipo","map:title":"Puedes encontrarnos en","map:address1":" Sector Literatos 38.","map:address2":"28760, Tres Cantos. Madrid (España)","contact:title":"¿Tienes un proyecto en mente? Cuéntanos sobre el","contact:name":"Nombre","contact:whats-your-name":"¿Cuál es tu nombre?","contact:company":"Empresa","contact:what-company-work":"¿En qué empresa trabajas?","contact:email":"Email","contact:give-us-email":"Danos tu email para poder contactarte","contact:purpose":"Quiero:","contact:purpose1":"Contratar un equipo de desarrollo","contact:purpose2":"Crear un producto digital desde cero","contact:purpose3":"Rediseñar una aplicación o mejorar la experiencia de usuario","contact:purpose4":"Otra cosa","contact:budget":"Presupuesto","contact:tell-us-budget":"Dinos tu presupuesto (si quieres)","contact:how-can-we-help-you":"¿Cómo podemos ayudarte?","contact:tell-us-more":"¡Cuéntanos más sobre tu proyecto!","contact:lets-work-together":"¡Trabajemos juntos!","contact:error-email":"Email incorrecto","contact:error-required":"Este campo es obligatorio","contact:error-select":"Por favor selecciona uno","contact:extra-text":"Si no te gustan los formularios, puedes contactarnos directamente en <a> hola@bonsaitech.io </a>","quote:text":"Bonsai me ha ahorrado muchísimo tiempo de gestión de proyecto porque escuchan atentamente, plantean las preguntas adecuadas y tienen un criterio para crear aplicaciones web de calidad que sólo encuentras en la gente más senior. Dominan totalmente React y ofrecen un servicio UX/UI absolutamente premium.","quote:action":"¡Echa un vistazo a la web de Daniel!","quote:daniel-position":"Fundador de Aucta","action:hire":"¡Contrata a tu equipo ya!","action:lets-start":"¡Empecemos ya!","action:lets-talk":"¡Hablemos!","action:start-working":"Empecemos a trabajar ya","action:lets-make-it-happen":"¡Hagamos que ocurra!","action:program-meeting":"Programa una reunión","action:ask-budget":"Pídenos presupuesto","action:tell-us-your-project":"Cuéntanos tu proyecto","info:based-madrid":"Estamos en Madrid (España)","info:all-rights-reserved":"Todos los derechos reservados","info:privacy":"Política de privacidad","info:legal":"Aviso legal","info:cookies":"Cookies","privacy:section1:title1":"1. Datos del Responsable del Tratamiento","privacy:section1:item1":"Denominación Social: Ignacio Ramos Howell, en adelante, «La empresa». ","privacy:section1:item2":"Nombre Comercial: Bonsai.","privacy:section1:item3":"Domicilio Social: Sector Literatos 38, 28760 Tres Cantos, Madrid","privacy:section1:item4":"NIF: 53657188M.","privacy:section1:item5":"Teléfono: 646 036 206.","privacy:section1:item6":"Email: hola@bonsaitech.io email operativo de tu empresa.","privacy:section1:title2":"1.1. Normativa aplicable","privacy:section1:text1":"Nuestra Política de Privacidad se ha diseñado de acuerdo con el Reglamento General de Protección de Datos de la UE 2016/679 del Parlamento Europeo y del Consejo, de 27 de abril de 2016, relativo a la protección de las personas físicas en lo que respecta al tratamiento de datos personales y a la libre circulación de estos datos y por el que se deroga la Directiva 95/46/CE (Reglamento general de protección de datos), y la Ley Orgánica 3/2018 del 5 de diciembre, de Protección de Datos de Carácter Personal y Garantía de los Derechos Digitales. Al facilitarnos sus datos, Usted declara haber leído y conocer la presente Política de Privacidad, prestando su consentimiento inequívoco y expreso al tratamiento de sus datos personales de acuerdo a las finalidades y términos aquí expresados. La Empresa podrá modificar la presente Política de Privacidad para adaptarla a las novedades legislativas, jurisprudenciales o de interpretación de la Agencia Española de Protección de Datos. Estas condiciones de privacidad podrán ser complementadas por el Aviso Legal, Política de Cookies y las Condiciones Generales que, en su caso, se recojan para determinados productos o servicios, si dicho acceso supone alguna especialidad en materia de protección de datos de carácter personal.","privacy:section1:title3":"1.2. Delegado de Protección de Datos","privacy:section1:text2":"El responsable del fichero es Ignacio Ramos Howell. Si quieres ejercer tus derechos de acceso, rectificación, cancelación u oposición, puedes hacerlo ante el responsable del fichero por cualquier medio que permita acreditar el envío y la recepción, o enviando un mail a la siguiente dirección de correo electrónico: hola@bonsaitech.io.","privacy:section2:title1":"2. Finalidad del Tratamiento de los Datos Personales","privacy:section2:text1":"El tratamiento que realizamos de sus datos personales responde a las siguientes finalidades: ","privacy:section2:text2":"Gestión de la comunicación con personas interesadas en contratar nuestros servicios.","privacy:section2:title2":"2.1. Plazo de Conservación de sus datos","privacy:section2:text3":"Conservaremos sus datos personales desde que nos dé su consentimiento hasta que lo revoque o bien solicite la limitación del tratamiento. En tales casos, mantendremos sus datos de manera bloqueada durante los plazos legalmente exigidos.","privacy:section3:title1":"3. Legitimación y Datos Recabados","privacy:section3:text1":"La legitimación para el tratamiento de sus datos es el consentimiento expreso otorgado mediante un acto positivo y afirmativo (rellenar el formulario correspondiente y marcar la casilla de aceptación de esta política) en el momento de facilitarnos sus datos personales.","privacy:section3:title2":"3.1. Consentimiento para tratar sus datos","privacy:section3:text2":"Al rellenar los formularios, marcar la casilla “Acepto la Política de Privacidad” y hacer clic para enviar los datos, o al remitir correos electrónicos a la Empresa a través de las cuentas habilitadas al efecto, el Usuario manifiesta haber leído y aceptado expresamente la presente política de privacidad, y otorga su consentimiento inequívoco y expreso al tratamiento de sus datos personales conforme a las finalidades indicadas.","privacy:section3:title3":"3.2. Categorías de datos.","privacy:section3:text3":"Los datos que se recopilarán serán personales.","privacy:section4:title1":"4. Medidas de Seguridad","privacy:section4:text1":"Dentro de nuestro compromiso por garantizar la seguridad y confidencialidad de sus datos de carácter personal, le informamos que se han adoptado las medidas de índole técnica y organizativas necesarias para garantizar la seguridad de los datos de carácter personal y evitar su alteración, pérdida, tratamiento o acceso no autorizado, habida cuenta del estado de la tecnología, la naturaleza de los datos almacenados y los riesgos a que estén expuestos, según el Art. 32 del RGPD EU 679/2016.","privacy:section5:title1":"5. Cesión de Datos","privacy:section5:text1":"No se prevén cesiones de datos ni transferencias internacionales de sus datos, a excepción de las autorizadas por la legislación fiscal, mercantil y de telecomunicaciones así como en aquellos casos en los que una autoridad judicial nos lo requiera.","privacy:section6:title1":"6. Derechos del Usuario","privacy:section6:text1":"Cualquier interesado tiene derecho a obtener confirmación sobre si estamos tratando datos personales que le conciernan, o no. Las personas interesadas tienen derecho a acceder a sus datos personales, así como a solicitar la rectificación de los datos inexactos o, en su caso, solicitar su supresión cuando, entre otros motivos, los datos ya no sean necesarios para los fines que fueron recogidos. En determinadas circunstancias, los interesados podrán solicitar la limitación del tratamiento de sus datos, en cuyo caso únicamente los conservaremos para el ejercicio o la defensa de reclamaciones. Por motivos relacionados con su situación particular, los interesados podrán oponerse al tratamiento de sus datos. El Responsable del fichero dejará de tratar los datos, salvo por motivos legítimos imperiosos, o el ejercicio o la defensa de posibles reclamaciones. De acuerdo con la legislación vigente tiene los siguientes derechos: derecho a solicitar el acceso a sus datos personales, derecho a solicitar su rectificación o supresión, derecho a solicitar la limitación de su tratamiento, derecho a oponerse al tratamiento, derecho a la portabilidad de los datos y así mismo, a revocar el consentimiento otorgado. Asimismo, tiene derecho a presentar una reclamación ante la Agencia Española de Protección de Datos.","privacy:section6:title2":"6.1. ¿Cómo ejercitar mis derechos?","privacy:section6:text2":"Para ejercer sus derechos, debe dirigirse al responsable, solicitando el correspondiente formulario para el ejercicio del derecho elegido. Opcionalmente, puede acudir a la Autoridad de Control competente para obtener información adicional acerca de sus derechos. Los datos de contacto para el ejercicio de sus derechos son el teléfono 647 036 206 y el correo electrónico: hola@bonsaitech.io. Recuerde acompañar una copia de un documento que nos permita identificarle.","privacy:section7:title1":"7. Consentimiento para envío de Comunicaciones Electrónicas","privacy:section7:text1":"Así mismo, y de acuerdo con lo establecido en la Ley 34/2002, de 11 de julio, de Servicios de la Sociedad de la Información y del Comercio Electrónico, completando el formulario de recogida de datos y marcando la correspondiente casilla “Acepto el envío de comunicaciones electrónicas”, está otorgando el consentimiento expreso para enviarle a su dirección de correo electrónico, teléfono, fax u otro medio electrónico en envío de información acerca de la Empresa.","legal:section1:text1":"Con la finalidad de dar cumplimiento al artículo 10 de la Ley 34/2002 de Servicios de la Sociedad de la Información y Comercio Electrónico, informamos al usuario de nuestros datos:  ","legal:section1:item1":"Denominación Social: Ignacio Ramos Howell, en adelante, «El prestador».","legal:section1:item2":"Nombre Comercial: Bonsai.","legal:section1:item3":"Domicilio Social:Sector Literatos 38, 28760 Tres Cantos, Madrid. ","legal:section1:item4":"NIF: 53657188M","legal:section1:item5":"Teléfono: 646 036 206.","legal:section1:item6":"Email: hola@bonsaitech.io","legal:section2:title1":"Objeto","legal:section2:text1":"El prestador, responsable del sitio web, pone a disposición de los usuarios el presente documento con el que pretende dar cumplimiento a las obligaciones dispuestas en la Ley 34/2002, de Servicios de la Sociedad de la Información y del Comercio Electrónico (LSSI-CE), así como informar a todos los usuarios del sitio web respecto a cuáles son las condiciones de uso del sitio web.","legal:section2:text2":"Toda persona que acceda a este sitio web asume el papel de usuario, comprometiéndose a la observancia y cumplimiento riguroso de las disposiciones aquí dispuestas, así como a cualquier otra disposición legal que fuera de aplicación.","legal:section2:text3":"El prestador se reserva el derecho a modificar cualquier tipo de información que pudiera aparecer en el sitio web, sin que exista obligación de preavisar o poner en conocimiento de los usuarios dichas obligaciones, entendiéndose como suficiente con la publicación en el sitio web del prestador.","legal:section3:title1":"Responsabilidad","legal:section3:text1":"El prestador se exime de cualquier tipo de responsabilidad derivada de la información publicada en su sitio web, siempre que esta información haya sido manipulada o introducida por un tercero ajeno al mismo. ","legal:section3:text2":"El sitio web del prestador puede utilizar cookies (pequeños archivos de información que el servidor envía al ordenador de quien accede a la página) para llevar a cabo determinadas funciones que son consideradas imprescindibles para el correcto funcionamiento y visualización del sitio. Las cookies utilizadas en el sitio web tienen, en todo caso, carácter temporal con la única finalidad de hacer más eficaz su transmisión ulterior y desaparecen al terminar la sesión del usuario. En ningún caso se utilizarán las cookies para recoger información de carácter personal. <a>Política de Cookies</a> ","legal:section3:text3":"Desde el sitio web del cliente es posible que se redirija a contenidos de terceros sitios web. Dado que el prestador no puede controlar siempre los contenidos introducidos por los terceros en sus sitios web, éste no asume ningún tipo de responsabilidad respecto a dichos contenidos. En todo caso, el prestador manifiesta que procederá a la retirada inmediata de cualquier contenido que pudiera contravenir la legislación nacional o internacional, la moral o el orden público, procediendo a la retirada inmediata de la redirección a dicho sitio web, poniendo en conocimiento de las autoridades competentes el contenido en cuestión.  ","legal:section3:text4":"El prestador no se hace responsable de la información y contenidos almacenados, a título enunciativo pero no limitativo, en foros, chats, generadores de blogs, comentarios, redes sociales o cualquier otro medio que permita a terceros publicar contenidos de forma independiente en la página web del prestador. No obstante y en cumplimiento de lo dispuesto en el art. 11 y 16 de la LSSI-CE, el prestador se pone a disposición de todos los usuarios, autoridades y fuerzas de seguridad, y colaborando de forma activa en la retirada o en su caso bloqueo de todos aquellos contenidos que pudieran afectar o contravenir la legislación nacional, o internacional, derechos de terceros o la moral y el orden público. En caso de que el usuario considere que existe en el sitio web algún contenido que pudiera ser susceptible de esta clasificación, se ruega lo notifique de forma inmediata al administrador del sitio web. ","legal:section3:text5":"Este sitio web ha sido revisado y probado para que funcione correctamente. En principio, puede garantizarse el correcto funcionamiento los 365 días del año, 24 horas al día. No obstante, el prestador no descarta la posibilidad de que existan ciertos errores de programación, o que acontezcan causas de fuerza mayor, catástrofes naturales, huelgas, o circunstancias semejantes que hagan imposible el acceso a la página web. ","legal:section4:title1":"Propiedad Intelectual e Industrial","legal:section4:text1":"El sitio web, incluyendo a título enunciativo pero no limitativo su programación, edición, compilación y demás elementos necesarios para su funcionamiento, los diseños, logotipos, texto y/o gráficos son propiedad del prestador o en su caso dispone de licencia o autorización expresa por parte de los autores. Todos los contenidos del sitio web se encuentran debidamente protegidos por la normativa de propiedad intelectual e industrial, así como inscritos en los registros públicos correspondientes.","legal:section4:text2":"Independientemente de la finalidad para la que fueran destinados, la reproducción total o parcial, uso, explotación, distribución y comercialización, requiere en todo caso de la autorización escrita previa por parte del prestador. Cualquier uso no autorizado previamente por parte del prestador será considerado un incumplimiento grave de los derechos de propiedad intelectual o industrial del autor.","legal:section4:text3":"Los diseños, logotipos, texto y/o gráficos ajenos al prestador y que pudieran aparecer en el sitio web, pertenecen a sus respectivos propietarios, siendo ellos mismos responsables de cualquier posible controversia que pudiera suscitarse respecto a los mismos. En todo caso, el prestador cuenta con la autorización expresa y previa por parte de los mismos. ","legal:section4:text4":"El prestador NO AUTORIZA expresamente a que terceros puedan redirigir directamente a los contenidos concretos del sitio web, debiendo en todo caso redirigir al sitio web principal del prestador.","legal:section4:text5":"El prestador reconoce a favor de sus titulares los correspondientes derechos de propiedad industrial e intelectual, no implicando su sola mención o aparición en el sitio web la existencia de derechos o responsabilidad alguna del prestador sobre los mismos, como tampoco respaldo, patrocinio o recomendación por parte del mismo.","legal:section4:text6":"Para realizar cualquier tipo de observación respecto a posibles incumplimientos de los derechos de propiedad intelectual o industrial, así como sobre cualquiera de los contenidos del sitio web, puede hacerlo a través del correo electrónico que figura en los datos identificativos al principio de este documento.","legal:section5:title1":"Veracidad de la Información ","legal:section5:text1":"Toda la información que facilita el Usuario tiene que ser veraz. A estos efectos, el Usuario garantiza la autenticidad de los datos comunicados a través de los formularios para la suscripción de los Servicios. Será responsabilidad del Usuario mantener toda la información facilitada a la Empresa permanentemente actualizada de forma que responda, en cada momento, a su situación real. En todo caso, el Usuario será el único responsable de las manifestaciones falsas o inexactas que realice y de los perjuicios que cause al prestador o a terceros.","legal:section6:title1":"Menores de Edad","legal:section6:text1":"Para el uso de los servicios, los menores de edad tienen que obtener siempre previamente el consentimiento de los padres, tutores o representantes legales, responsables últimos de todos los actos realizados por los menores a su cargo. La responsabilidad en la determinación de contenidos concretos a los cuales acceden los menores corresponde a aquellos, es por eso que si acceden a contenidos no apropiados por Internet, se tendrán que establecer en sus ordenadores mecanismos, en particular programas informáticos, filtros y bloqueos, que permitan limitar los contenidos disponibles y, a pesar de que no sean infalibles, son de especial utilidad para controlar y restringir los materiales a los que pueden acceder los menores.","legal:section7:title1":"Obligación de hacer un uso correcto de la Web","legal:section7:text1":"El Usuario se compromete a utilizar la Web de conformidad a la Ley y al presente Aviso Legal, así como a la moral y a buenas costumbres. A tal efecto, el Usuario se abstendrá de utilizar la página con finalidades ilícitas o prohibidas, lesivas de derechos e intereses de terceros, o que de cualquier forma puedan dañar, inutilizar, sobrecargar, deteriorar o impedir la normal utilización de equipos informáticos o documentos, archivos y toda clase de contenidos almacenados en cualquier equipo informático del prestador. ","legal:section7:text2":"En particular, y a título indicativo pero no exhaustivo, el Usuario se compromete a no transmitir, difundir o poner a disposición de terceros informaciones, datos, contenidos, mensajes, gráficos, dibujos, archivos de sonido o imagen, fotografías, grabaciones, software y, en general, cualquier clase de material que:","legal:section7:text3":"(a) sea contraria, desprecie o atente contra los derechos fundamentales y las libertades públicas reconocidas constitucionalmente, en tratados internacionales y otras normas vigentes; ","legal:section7:text4":"(b) induzca, incite o promueva actuaciones delictivas, denigrantes, difamatorias, violentas o, en general, contrarias a la ley, a la moral y al orden público; ","legal:section7:text5":"(c) induzca, incite o promueva actuaciones, actitudes o pensamientos discriminatorios por razón de sexo, raza, religión, creencias, edad o condición;","legal:section7:text6":"(d) sea contrario al derecho al honor, a la intimidad personal o familiar o a la propia imagen de las personas;","legal:section7:text7":"(e) de cualquier manera perjudique la credibilidad del prestador o de terceros; y ","legal:section7:text8":"(f) constituya publicidad ilícita, engañosa o desleal.","legal:section8:title1":"Ley Aplicable y Jurisdicción  ","legal:section8:text1":"Para la resolución de todas las controversias o cuestiones relacionadas con el presente sitio web o de las actividades en él desarrolladas, será de aplicación la legislación española, a la que se someten expresamente las partes, siendo competentes para la resolución de todos los conflictos derivados o relacionados con su uso los Juzgados y Tribunales de la Comunidad de Madrid.  ","cookies:section1:title1":"Información general","cookies:section1:text1":"Debido a la entrada en vigor de la referente modificación de la “Ley de Servicios de la Sociedad de la Información” (LSSICE) establecida por el Real Decreto 13/2012, es de obligación obtener el consentimiento expreso del usuario de todas las páginas web que usan cookies prescindibles, antes de que éste navegue por ellas.","cookies:section1:title2":"¿Qué son las cookies?","cookies:section1:text2":"Las cookies y otras tecnologías similares tales como local shared objects, flash cookies o píxeles, son herramientas empleadas por los servidores Web para almacenar y recuperar información acerca de sus visitantes, así como para ofrecer un correcto funcionamiento del sitio.","cookies:section1:text3":"Mediante el uso de estos dispositivos se permite al servidor Web recordar algunos datos concernientes al usuario, como sus preferencias para la visualización de las páginas de ese servidor, nombre y contraseña, productos que más le interesan, etc. ","cookies:section1:title3":"Cookies afectadas por la normativa y cookies exceptuadas","cookies:section1:text4":"Según la directiva de la UE, las cookies que requieren el consentimiento informado por parte del usuario son las cookies de analítica y las de publicidad y afiliación, quedando exceptuadas las de carácter técnico y las necesarias para el funcionamiento del sitio web o la prestación de servicios expresamente solicitados por el usuario.","cookies:section1:title4":"¿Qué tipos de cookies existen?","cookies:section1:text5":"Según su titularidad","cookies:section1:item1":"Cookies propias: Son aquéllas que se envían al equipo terminal del usuario desde un equipo o dominio gestionado por el propio editor y desde el que se presta el servicio Solicitado por el usuario.","cookies:section1:item2":"Cookies de terceros: Son aquéllas que se envían al equipo terminal del usuario desde un equipo o dominio que no es gestionado por el editor, sino por otra entidad que trata los datos obtenidos través de las cookies.","cookies:section1:text6":"Según su duración","cookies:section1:item3":"Cookies de sesión: Son un tipo de cookies diseñadas para recabar y almacenar datos mientras el usuario accede a una página web.","cookies:section1:item4":"Cookies persistentes: Son un tipo de cookies en el que los datos siguen almacenados en el terminal y pueden ser accedidos y tratados durante un periodo definido por el responsable de la cookie, y que puede ir de unos minutos a varios años.","cookies:section1:text7":"Según su funcionalidad","cookies:section1:item5":"Cookies necesarias: son aquellas imprescindibles para el correcto funcionamiento del sitio web. No recopilan ningún tipo de datos de usuario y recogen información como la preferencia de idioma, si se ha aceptado la política de cookies, etc.","cookies:section1:item6":"Cookies de análisis: Son aquéllas que bien tratadas por nosotros o por terceros, nos permiten cuantificar el número de usuarios y así realizar la medición y análisis estadístico de la utilización que hacen los usuarios del servicio ofertado. Para ello se analiza su navegación en nuestra página web con el fin de mejorar la oferta de productos o servicios que le ofrecemos.","cookies:section1:item7":"Cookies publicitarias o de marketing: Son aquéllas que permiten la gestión, de la forma más eficaz posible, de los espacios publicitarios que, en su caso, el editor haya incluido en una página web, aplicación o plataforma desde la que presta el servicio solicitado en base a criterios como el contenido editado o la frecuencia en la que se muestran los anuncios.","cookies:section1:item8":"Cookies de publicidad comportamental o de marketing personalizado: Son aquéllas que permiten la gestión, de la forma más eficaz posible, de los espacios publicitarios que, en su caso, el editor haya incluido en una página web, aplicación o plataforma desde la que presta el servicio solicitado. Estas cookies almacenan información del comportamiento de los usuarios obtenida a través de la observación continuada de sus hábitos de navegación, lo que permite desarrollar un perfil específico para mostrar publicidad en función del mismo. Asimismo es posible que al visitar alguna página web o al abrir algún email donde se publique algún anuncio o alguna promoción sobre nuestros productos o servicios se instale en tu navegador alguna cookie que nos sirve para mostrarte posteriormente publicidad relacionada con la búsqueda que hayas realizado, desarrollar un control de nuestros anuncios en relación, por ejemplo, con el número de veces que son vistos, donde aparecen, a qué hora se ven, etc.","cookies:section2:title1":"Declaración de Cookies","cookies:section2:text1":"Completa la siguiente tabla con información de todas las cookies que se utilizan en tu sitio web.","cookies:section2:table-header1":"Cookie","cookies:section2:table-header2":"Propietario","cookies:section2:table-header3":"Duración","cookies:section2:table-header4":"Finalidad","cookies:section2:table-header5":"Tipo","cookies:section2:table-cell21":"_gsas ","cookies:section2:table-cell22":".bonsaitech.io","cookies:section2:table-cell23":"1 año 24 días","cookies:section2:table-cell24":"---","cookies:section2:table-cell25":"Otros","cookies:section2:table-cell1":"CONSENT","cookies:section2:table-cell2":".google.com","cookies:section2:table-cell3":"2 años","cookies:section2:table-cell4":"Youtube establece esta cookie a través de vídeos embebidos y registra datos estadísticos anónimos","cookies:section2:table-cell5":"Analytics","cookies:section2:title2":"Revocación del consentimiento para instalar Cookies  ","cookies:section2:text2":"Explica en este apartado cómo  pueden los usuarios retirar o modificar su consentimiento para el uso de cookies.","cookies:section2:text3":"Cómo eliminar las Cookies del navegador.","cookies:section2:item1":"Chrome: <a> https://support.google.com/chrome/answer/95647 </a>","cookies:section2:item2":"Internet Explorer: <a> https://support.microsoft.com/es-es/help/17442/windows-internet-explorer-delete-manage-cookies </a>","cookies:section2:item3":"Firefox: <a> https://support.mozilla.org/es/kb/habilitar-y-deshabilitar-cookies-sitios-web-rastrear-preferencias </a>","cookies:section2:item4":"Safari: <a> https://support.apple.com/es-es/guide/safari/sfri11471/mac </a>","cookies:section2:item5":"Opera: <a> https://www.opera.com/help/tutorials/security/privacy/ </a>","cookies:section2:text4":"Si no aparece listado, consulte la documentación del navegador que tenga instalado para bloquear, eliminar o permitir la descarga de Cookies"}')}},6733:function(e,t,n){"use strict";n.d(t,{W:function(){return a}});var i=n(9785),r=n(8157),a=function(e){var t=(0,i.Z)().locale,n=e||t;return function(e){var t=(0,r.TG)(e);return n!==r.ZW?"/"+n+t:t}};t.Z=a},3698:function(e,t,n){"use strict";var i=n(7294),r=n(9785);n(9325);t.Z=function(){var e=(0,r.Z)();return(0,i.useCallback)((function(t,n){return void 0===n&&(n={}),e.formatMessage({id:t,defaultMessage:t},n)}),[e])}},8157:function(e,t,n){"use strict";n.d(t,{ZW:function(){return a},TG:function(){return u},Q3:function(){return o},mS:function(){return s},E5:function(){return l}});var i=[{locale:"en",match:/en/},{locale:"es",match:/es/}],r=n(9325),a={}.REACT_APP_DEFAULT_LOCALE||i[0].locale,o=function(){var e=i.find((function(e){return e.match.test("undefined"!=typeof navigator&&navigator?navigator.language:a)}));return e?e.locale:a},s=function(e){var t="undefined"==typeof window,n=e.pathname||(t?"/":window.location.pathname);return i.reduce((function(e,t){var i=t.locale;return n.startsWith("/"+i+"/")?i:e}),a)},u=function(e){void 0===e&&(e="");var t=i.reduce((function(e,t){return e.replace(new RegExp("^/"+t.locale+"/"),"/").replace(new RegExp("^/"+t.locale+"$"),"/")}),e);return t.length>1?t.replace(/\/$/,""):t},l=function(e){void 0===e&&(e=void 0);var t=function(e){void 0===e&&(e=void 0);var t=i.find((function(t){return t.match.test(e||("undefined"!=typeof navigator&&navigator?navigator.language:a))}));return t?t.locale:a}(e),n=r.Z[t]||r.Z[a];return r.Z[t]||console.warn("Missing translations for locale "+t),{messages:n,locale:t}}},7056:function(e,t,n){"use strict";n.d(t,{Z:function(){return Bn}});var i=n(7294),r=n(2977),a=n(8911),o=n(9522),s=n(4527),u=n(6176);function l(e){var t=[],n=[],i=[],r=[],a=e.width||e.size||1,o=e.height||e.size||1,l=0===e.sideOrientation?0:e.sideOrientation||s.x.DEFAULTSIDE,c=a/2,h=o/2;n.push(-c,-h,0),i.push(0,0,-1),r.push(0,u.e.UseOpenGLOrientationForUV?1:0),n.push(c,-h,0),i.push(0,0,-1),r.push(1,u.e.UseOpenGLOrientationForUV?1:0),n.push(c,h,0),i.push(0,0,-1),r.push(1,u.e.UseOpenGLOrientationForUV?0:1),n.push(-c,h,0),i.push(0,0,-1),r.push(0,u.e.UseOpenGLOrientationForUV?0:1),t.push(0),t.push(1),t.push(2),t.push(0),t.push(2),t.push(3),s.x._ComputeSides(l,n,t,i,r,e.frontUVs,e.backUVs);var f=new s.x;return f.indices=t,f.positions=n,f.normals=i,f.uvs=r,f}function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=new o.Kj(e,n);t.sideOrientation=o.Kj._GetDefaultSideOrientation(t.sideOrientation),i._originalBuilderSideOrientation=t.sideOrientation;var r=l(t);return r.applyToMesh(i,t.updatable),t.sourcePlane&&(i.translate(t.sourcePlane.normal,-t.sourcePlane.d),i.setDirection(t.sourcePlane.normal.scale(-1))),i}s.x.CreatePlane=l,o.Kj.CreatePlane=function(e,t,n,i,r){return c(e,{size:t,width:t,height:t,sideOrientation:r,updatable:i},n)};n(4944),n(3792);var h=n(6900),f=n(7046);function d(e){var t,n=[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23],i=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0],r=[],a=e.width||e.size||1,o=e.height||e.size||1,l=e.depth||e.size||1,c=e.wrap||!1,d=void 0===e.topBaseAt?1:e.topBaseAt,p=void 0===e.bottomBaseAt?0:e.bottomBaseAt,v=[2,0,3,1][d=(d+4)%4],m=[2,0,1,3][p=(p+4)%4],g=[1,-1,1,-1,-1,1,-1,1,1,1,1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1,1,1,-1,1,-1,-1,1,-1,1,1,1,1,-1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1,1,1,-1,1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,1];if(c){n=[2,3,0,2,0,1,4,5,6,4,6,7,9,10,11,9,11,8,12,14,15,12,13,14],g=[-1,1,1,1,1,1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1,1,1,1,1,1,-1,1,-1,-1,1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,-1,-1,-1];for(var _=[[1,1,1],[-1,1,1],[-1,1,-1],[1,1,-1]],y=[[-1,-1,1],[1,-1,1],[1,-1,-1],[-1,-1,-1]],E=[17,18,19,16],A=[22,23,20,21];v>0;)_.unshift(_.pop()),E.unshift(E.pop()),v--;for(;m>0;)y.unshift(y.pop()),A.unshift(A.pop()),m--;_=_.flat(),y=y.flat(),g=g.concat(_).concat(y),n.push(E[0],E[2],E[3],E[0],E[1],E[2]),n.push(A[0],A[2],A[3],A[0],A[1],A[2])}var b=[a/2,o/2,l/2];t=g.reduce((function(e,t,n){return e.concat(t*b[n%3])}),[]);for(var T=0===e.sideOrientation?0:e.sideOrientation||s.x.DEFAULTSIDE,M=e.faceUV||new Array(6),S=e.faceColors,I=[],x=0;x<6;x++)void 0===M[x]&&(M[x]=new h.Lt(0,0,1,1)),S&&void 0===S[x]&&(S[x]=new f.HE(1,1,1,1));for(var C=0;C<6;C++)if(r.push(M[C].z,u.e.UseOpenGLOrientationForUV?1-M[C].w:M[C].w),r.push(M[C].x,u.e.UseOpenGLOrientationForUV?1-M[C].w:M[C].w),r.push(M[C].x,u.e.UseOpenGLOrientationForUV?1-M[C].y:M[C].y),r.push(M[C].z,u.e.UseOpenGLOrientationForUV?1-M[C].y:M[C].y),S)for(var P=0;P<4;P++)I.push(S[C].r,S[C].g,S[C].b,S[C].a);s.x._ComputeSides(T,t,n,i,r,e.frontUVs,e.backUVs);var D=new s.x;if(D.indices=n,D.positions=t,D.normals=i,D.uvs=r,S){var R=T===s.x.DOUBLESIDE?I.concat(I):I;D.colors=R}return D}function p(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=new o.Kj(e,n);t.sideOrientation=o.Kj._GetDefaultSideOrientation(t.sideOrientation),i._originalBuilderSideOrientation=t.sideOrientation;var r=d(t);return r.applyToMesh(i,t.updatable),i}s.x.CreateBox=d,o.Kj.CreateBox=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0,a={size:t,sideOrientation:r,updatable:i};return p(e,a,n)};var v,m=n(7702),g=n(3681),_=(n(2465),n(5602));!function(e){e[e.CW=0]="CW",e[e.CCW=1]="CCW"}(v||(v={}));var y=n(3683),E=n(5671),A=n(3144),b=function(){function e(t,n){(0,E.Z)(this,e),this.width=t,this.height=n}return(0,A.Z)(e,[{key:"toString",value:function(){return"{W: ".concat(this.width,", H: ").concat(this.height,"}")}},{key:"getClassName",value:function(){return"Size"}},{key:"getHashCode",value:function(){var e=0|this.width;return e=397*e^(0|this.height)}},{key:"copyFrom",value:function(e){this.width=e.width,this.height=e.height}},{key:"copyFromFloats",value:function(e,t){return this.width=e,this.height=t,this}},{key:"set",value:function(e,t){return this.copyFromFloats(e,t)}},{key:"multiplyByFloats",value:function(t,n){return new e(this.width*t,this.height*n)}},{key:"clone",value:function(){return new e(this.width,this.height)}},{key:"equals",value:function(e){return!!e&&(this.width===e.width&&this.height===e.height)}},{key:"surface",get:function(){return this.width*this.height}},{key:"add",value:function(t){return new e(this.width+t.width,this.height+t.height)}},{key:"subtract",value:function(t){return new e(this.width-t.width,this.height-t.height)}}],[{key:"Zero",value:function(){return new e(0,0)}},{key:"Lerp",value:function(t,n,i){return new e(t.width+(n.width-t.width)*i,t.height+(n.height-t.height)*i)}}]),e}(),T=(n(628),n(7326)),M=n(1752),S=n(136),I=n(6215),x=n(1120),C=n(9477),P=n(9336),D=n(4174),R=n(1396),k=n(3365),O=n(2786),N=function(){function e(){(0,E.Z)(this,e),this._zoomStopsAnimation=!1,this._idleRotationSpeed=.05,this._idleRotationWaitTime=2e3,this._idleRotationSpinupTime=2e3,this.targetAlpha=null,this._isPointerDown=!1,this._lastFrameTime=null,this._lastInteractionTime=-1/0,this._cameraRotationSpeed=0,this._lastFrameRadius=0}return(0,A.Z)(e,[{key:"name",get:function(){return"AutoRotation"}},{key:"zoomStopsAnimation",get:function(){return this._zoomStopsAnimation},set:function(e){this._zoomStopsAnimation=e}},{key:"idleRotationSpeed",get:function(){return this._idleRotationSpeed},set:function(e){this._idleRotationSpeed=e}},{key:"idleRotationWaitTime",get:function(){return this._idleRotationWaitTime},set:function(e){this._idleRotationWaitTime=e}},{key:"idleRotationSpinupTime",get:function(){return this._idleRotationSpinupTime},set:function(e){this._idleRotationSpinupTime=e}},{key:"rotationInProgress",get:function(){return Math.abs(this._cameraRotationSpeed)>0}},{key:"init",value:function(){}},{key:"attach",value:function(e){var t=this;this._attachedCamera=e;var n=this._attachedCamera.getScene();this._onPrePointerObservableObserver=n.onPrePointerObservable.add((function(e){e.type!==k.kD.POINTERDOWN?e.type===k.kD.POINTERUP&&(t._isPointerDown=!1):t._isPointerDown=!0})),this._onAfterCheckInputsObserver=e.onAfterCheckInputsObservable.add((function(){if(!t._reachTargetAlpha()){var e=O.F.Now,n=0;null!=t._lastFrameTime&&(n=e-t._lastFrameTime),t._lastFrameTime=e,t._applyUserInteraction();var i=e-t._lastInteractionTime-t._idleRotationWaitTime,r=Math.max(Math.min(i/t._idleRotationSpinupTime,1),0);t._cameraRotationSpeed=t._idleRotationSpeed*r,t._attachedCamera&&(t._attachedCamera.alpha-=t._cameraRotationSpeed*(n/1e3))}}))}},{key:"detach",value:function(){if(this._attachedCamera){var e=this._attachedCamera.getScene();this._onPrePointerObservableObserver&&e.onPrePointerObservable.remove(this._onPrePointerObservableObserver),this._attachedCamera.onAfterCheckInputsObservable.remove(this._onAfterCheckInputsObserver),this._attachedCamera=null}}},{key:"resetLastInteractionTime",value:function(e){this._lastInteractionTime=null!=e?e:O.F.Now}},{key:"_reachTargetAlpha",value:function(){return!(!this._attachedCamera||!this.targetAlpha)&&Math.abs(this._attachedCamera.alpha-this.targetAlpha)<g.kn}},{key:"_userIsZooming",value:function(){return!!this._attachedCamera&&0!==this._attachedCamera.inertialRadiusOffset}},{key:"_shouldAnimationStopForInteraction",value:function(){if(!this._attachedCamera)return!1;var e=!1;return this._lastFrameRadius===this._attachedCamera.radius&&0!==this._attachedCamera.inertialRadiusOffset&&(e=!0),this._lastFrameRadius=this._attachedCamera.radius,this._zoomStopsAnimation?e:this._userIsZooming()}},{key:"_applyUserInteraction",value:function(){this._userIsMoving()&&!this._shouldAnimationStopForInteraction()&&(this._lastInteractionTime=O.F.Now)}},{key:"_userIsMoving",value:function(){return!!this._attachedCamera&&(0!==this._attachedCamera.inertialAlphaOffset||0!==this._attachedCamera.inertialBetaOffset||0!==this._attachedCamera.inertialRadiusOffset||0!==this._attachedCamera.inertialPanningX||0!==this._attachedCamera.inertialPanningY||this._isPointerDown)}}]),e}();function w(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,x.Z)(e);if(t){var r=(0,x.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,I.Z)(this,n)}}var L=function(){function e(){(0,E.Z)(this,e),this._easingMode=e.EASINGMODE_EASEIN}return(0,A.Z)(e,[{key:"setEasingMode",value:function(e){var t=Math.min(Math.max(e,0),2);this._easingMode=t}},{key:"getEasingMode",value:function(){return this._easingMode}},{key:"easeInCore",value:function(e){throw new Error("You must implement this method")}},{key:"ease",value:function(t){switch(this._easingMode){case e.EASINGMODE_EASEIN:return this.easeInCore(t);case e.EASINGMODE_EASEOUT:return 1-this.easeInCore(1-t)}return t>=.5?.5*(1-this.easeInCore(2*(1-t)))+.5:.5*this.easeInCore(2*t)}}]),e}();L.EASINGMODE_EASEIN=0,L.EASINGMODE_EASEOUT=1,L.EASINGMODE_EASEINOUT=2;var F,B=function(e){(0,S.Z)(n,e);var t=w(n);function n(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return(0,E.Z)(this,n),(e=t.call(this)).amplitude=i,e}return(0,A.Z)(n,[{key:"easeInCore",value:function(e){var t=Math.max(0,this.amplitude);return Math.pow(e,3)-e*t*Math.sin(3.141592653589793*e)}}]),n}(L),U=function(e){(0,S.Z)(n,e);var t=w(n);function n(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;return(0,E.Z)(this,n),(e=t.call(this)).exponent=i,e}return(0,A.Z)(n,[{key:"easeInCore",value:function(e){return this.exponent<=0?e:(Math.exp(this.exponent*e)-1)/(Math.exp(this.exponent)-1)}}]),n}(L),V=n(1704);!function(e){e[e.NONE=0]="NONE",e[e.STEP=1]="STEP"}(F||(F={}));var G=function(){function e(t,n,i){(0,E.Z)(this,e),this.name=t,this.from=n,this.to=i}return(0,A.Z)(e,[{key:"clone",value:function(){return new e(this.name,this.from,this.to)}}]),e}(),z=n(8628);function W(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return H(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return H(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function H(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var X=function(){function e(t,n,i,r,a,o){(0,E.Z)(this,e),this.name=t,this.targetProperty=n,this.framePerSecond=i,this.dataType=r,this.loopMode=a,this.enableBlending=o,this._easingFunction=null,this._runtimeAnimations=new Array,this._events=new Array,this.blendingSpeed=.01,this._ranges={},this.targetPropertyPath=n.split("."),this.dataType=r,this.loopMode=void 0===a?e.ANIMATIONLOOPMODE_CYCLE:a,this.uniqueId=e._UniqueIdGenerator++}return(0,A.Z)(e,[{key:"runtimeAnimations",get:function(){return this._runtimeAnimations}},{key:"hasRunningRuntimeAnimations",get:function(){var e,t=W(this._runtimeAnimations);try{for(t.s();!(e=t.n()).done;){if(!e.value.isStopped())return!0}}catch(n){t.e(n)}finally{t.f()}return!1}},{key:"toString",value:function(e){var t="Name: "+this.name+", property: "+this.targetProperty;if(t+=", datatype: "+["Float","Vector3","Quaternion","Matrix","Color3","Vector2"][this.dataType],t+=", nKeys: "+(this._keys?this._keys.length:"none"),t+=", nRanges: "+(this._ranges?Object.keys(this._ranges).length:"none"),e){t+=", Ranges: {";var n=!0;for(var i in this._ranges)n&&(t+=", ",n=!1),t+=i;t+="}"}return t}},{key:"addEvent",value:function(e){this._events.push(e),this._events.sort((function(e,t){return e.frame-t.frame}))}},{key:"removeEvents",value:function(e){for(var t=0;t<this._events.length;t++)this._events[t].frame===e&&(this._events.splice(t,1),t--)}},{key:"getEvents",value:function(){return this._events}},{key:"createRange",value:function(e,t,n){this._ranges[e]||(this._ranges[e]=new G(e,t,n))}},{key:"deleteRange",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this._ranges[e];if(n){if(t)for(var i=n.from,r=n.to,a=this._keys.length-1;a>=0;a--)this._keys[a].frame>=i&&this._keys[a].frame<=r&&this._keys.splice(a,1);this._ranges[e]=null}}},{key:"getRange",value:function(e){return this._ranges[e]}},{key:"getKeys",value:function(){return this._keys}},{key:"getHighestFrame",value:function(){for(var e=0,t=0,n=this._keys.length;t<n;t++)e<this._keys[t].frame&&(e=this._keys[t].frame);return e}},{key:"getEasingFunction",value:function(){return this._easingFunction}},{key:"setEasingFunction",value:function(e){this._easingFunction=e}},{key:"floatInterpolateFunction",value:function(e,t,n){return _.R.Lerp(e,t,n)}},{key:"floatInterpolateFunctionWithTangents",value:function(e,t,n,i,r){return _.R.Hermite(e,t,n,i,r)}},{key:"quaternionInterpolateFunction",value:function(e,t,n){return h._f.Slerp(e,t,n)}},{key:"quaternionInterpolateFunctionWithTangents",value:function(e,t,n,i,r){return h._f.Hermite(e,t,n,i,r).normalize()}},{key:"vector3InterpolateFunction",value:function(e,t,n){return h.P.Lerp(e,t,n)}},{key:"vector3InterpolateFunctionWithTangents",value:function(e,t,n,i,r){return h.P.Hermite(e,t,n,i,r)}},{key:"vector2InterpolateFunction",value:function(e,t,n){return h.FM.Lerp(e,t,n)}},{key:"vector2InterpolateFunctionWithTangents",value:function(e,t,n,i,r){return h.FM.Hermite(e,t,n,i,r)}},{key:"sizeInterpolateFunction",value:function(e,t,n){return b.Lerp(e,t,n)}},{key:"color3InterpolateFunction",value:function(e,t,n){return f.Wo.Lerp(e,t,n)}},{key:"color3InterpolateFunctionWithTangents",value:function(e,t,n,i,r){return f.Wo.Hermite(e,t,n,i,r)}},{key:"color4InterpolateFunction",value:function(e,t,n){return f.HE.Lerp(e,t,n)}},{key:"color4InterpolateFunctionWithTangents",value:function(e,t,n,i,r){return f.HE.Hermite(e,t,n,i,r)}},{key:"_getKeyValue",value:function(e){return"function"==typeof e?e():e}},{key:"evaluate",value:function(t){return this._interpolate(t,{key:0,repeatCount:0,loopMode:e.ANIMATIONLOOPMODE_CONSTANT})}},{key:"_interpolate",value:function(t,n){if(n.loopMode===e.ANIMATIONLOOPMODE_CONSTANT&&n.repeatCount>0)return n.highLimitValue.clone?n.highLimitValue.clone():n.highLimitValue;for(var i=this._keys,r=i.length,a=n.key;a>=0&&t<i[a].frame;)--a;for(;a+1<=r-1&&t>=i[a+1].frame;)++a;if(n.key=a,a<0)return this._getKeyValue(i[0].value);if(a+1>r-1)return this._getKeyValue(i[r-1].value);var o=i[a],s=i[a+1],u=this._getKeyValue(o.value),l=this._getKeyValue(s.value);if(o.interpolation===F.STEP)return s.frame>t?u:l;var c=void 0!==o.outTangent&&void 0!==s.inTangent,h=s.frame-o.frame,f=(t-o.frame)/h,d=this.getEasingFunction();switch(null!==d&&(f=d.ease(f)),this.dataType){case e.ANIMATIONTYPE_FLOAT:var p=c?this.floatInterpolateFunctionWithTangents(u,o.outTangent*h,l,s.inTangent*h,f):this.floatInterpolateFunction(u,l,f);switch(n.loopMode){case e.ANIMATIONLOOPMODE_CYCLE:case e.ANIMATIONLOOPMODE_CONSTANT:return p;case e.ANIMATIONLOOPMODE_RELATIVE:return n.offsetValue*n.repeatCount+p}break;case e.ANIMATIONTYPE_QUATERNION:var v=c?this.quaternionInterpolateFunctionWithTangents(u,o.outTangent.scale(h),l,s.inTangent.scale(h),f):this.quaternionInterpolateFunction(u,l,f);switch(n.loopMode){case e.ANIMATIONLOOPMODE_CYCLE:case e.ANIMATIONLOOPMODE_CONSTANT:return v;case e.ANIMATIONLOOPMODE_RELATIVE:return v.addInPlace(n.offsetValue.scale(n.repeatCount))}return v;case e.ANIMATIONTYPE_VECTOR3:var m=c?this.vector3InterpolateFunctionWithTangents(u,o.outTangent.scale(h),l,s.inTangent.scale(h),f):this.vector3InterpolateFunction(u,l,f);switch(n.loopMode){case e.ANIMATIONLOOPMODE_CYCLE:case e.ANIMATIONLOOPMODE_CONSTANT:return m;case e.ANIMATIONLOOPMODE_RELATIVE:return m.add(n.offsetValue.scale(n.repeatCount))}break;case e.ANIMATIONTYPE_VECTOR2:var g=c?this.vector2InterpolateFunctionWithTangents(u,o.outTangent.scale(h),l,s.inTangent.scale(h),f):this.vector2InterpolateFunction(u,l,f);switch(n.loopMode){case e.ANIMATIONLOOPMODE_CYCLE:case e.ANIMATIONLOOPMODE_CONSTANT:return g;case e.ANIMATIONLOOPMODE_RELATIVE:return g.add(n.offsetValue.scale(n.repeatCount))}break;case e.ANIMATIONTYPE_SIZE:switch(n.loopMode){case e.ANIMATIONLOOPMODE_CYCLE:case e.ANIMATIONLOOPMODE_CONSTANT:return this.sizeInterpolateFunction(u,l,f);case e.ANIMATIONLOOPMODE_RELATIVE:return this.sizeInterpolateFunction(u,l,f).add(n.offsetValue.scale(n.repeatCount))}break;case e.ANIMATIONTYPE_COLOR3:var _=c?this.color3InterpolateFunctionWithTangents(u,o.outTangent.scale(h),l,s.inTangent.scale(h),f):this.color3InterpolateFunction(u,l,f);switch(n.loopMode){case e.ANIMATIONLOOPMODE_CYCLE:case e.ANIMATIONLOOPMODE_CONSTANT:return _;case e.ANIMATIONLOOPMODE_RELATIVE:return _.add(n.offsetValue.scale(n.repeatCount))}break;case e.ANIMATIONTYPE_COLOR4:var y=c?this.color4InterpolateFunctionWithTangents(u,o.outTangent.scale(h),l,s.inTangent.scale(h),f):this.color4InterpolateFunction(u,l,f);switch(n.loopMode){case e.ANIMATIONLOOPMODE_CYCLE:case e.ANIMATIONLOOPMODE_CONSTANT:return y;case e.ANIMATIONLOOPMODE_RELATIVE:return y.add(n.offsetValue.scale(n.repeatCount))}break;case e.ANIMATIONTYPE_MATRIX:switch(n.loopMode){case e.ANIMATIONLOOPMODE_CYCLE:case e.ANIMATIONLOOPMODE_CONSTANT:return e.AllowMatricesInterpolation?this.matrixInterpolateFunction(u,l,f,n.workValue):u;case e.ANIMATIONLOOPMODE_RELATIVE:return u}}return 0}},{key:"matrixInterpolateFunction",value:function(t,n,i,r){return e.AllowMatrixDecomposeForInterpolation?r?(h.y3.DecomposeLerpToRef(t,n,i,r),r):h.y3.DecomposeLerp(t,n,i):r?(h.y3.LerpToRef(t,n,i,r),r):h.y3.Lerp(t,n,i)}},{key:"clone",value:function(){var t=new e(this.name,this.targetPropertyPath.join("."),this.framePerSecond,this.dataType,this.loopMode);if(t.enableBlending=this.enableBlending,t.blendingSpeed=this.blendingSpeed,this._keys&&t.setKeys(this._keys),this._ranges)for(var n in t._ranges={},this._ranges){var i=this._ranges[n];i&&(t._ranges[n]=i.clone())}return t}},{key:"setKeys",value:function(e){this._keys=e.slice(0)}},{key:"serialize",value:function(){var t={};t.name=this.name,t.property=this.targetProperty,t.framePerSecond=this.framePerSecond,t.dataType=this.dataType,t.loopBehavior=this.loopMode,t.enableBlending=this.enableBlending,t.blendingSpeed=this.blendingSpeed;var n=this.dataType;t.keys=[];for(var i=this.getKeys(),r=0;r<i.length;r++){var a=i[r],o={};switch(o.frame=a.frame,n){case e.ANIMATIONTYPE_FLOAT:o.values=[a.value],void 0!==a.inTangent&&o.values.push(a.inTangent),void 0!==a.outTangent&&(void 0===a.inTangent&&o.values.push(void 0),o.values.push(a.outTangent)),void 0!==a.interpolation&&(void 0===a.inTangent&&o.values.push(void 0),void 0===a.outTangent&&o.values.push(void 0),o.values.push(a.interpolation));break;case e.ANIMATIONTYPE_QUATERNION:case e.ANIMATIONTYPE_MATRIX:case e.ANIMATIONTYPE_VECTOR3:case e.ANIMATIONTYPE_COLOR3:case e.ANIMATIONTYPE_COLOR4:o.values=a.value.asArray(),null!=a.inTangent&&o.values.push(a.inTangent.asArray()),null!=a.outTangent&&(void 0===a.inTangent&&o.values.push(void 0),o.values.push(a.outTangent.asArray())),void 0!==a.interpolation&&(void 0===a.inTangent&&o.values.push(void 0),void 0===a.outTangent&&o.values.push(void 0),o.values.push(a.interpolation))}t.keys.push(o)}for(var s in t.ranges=[],this._ranges){var u=this._ranges[s];if(u){var l={};l.name=s,l.from=u.from,l.to=u.to,t.ranges.push(l)}}return t}}],[{key:"_PrepareAnimation",value:function(t,n,i,r,a,o,s,u){var l=void 0;if(!isNaN(parseFloat(a))&&isFinite(a)?l=e.ANIMATIONTYPE_FLOAT:a instanceof h._f?l=e.ANIMATIONTYPE_QUATERNION:a instanceof h.P?l=e.ANIMATIONTYPE_VECTOR3:a instanceof h.FM?l=e.ANIMATIONTYPE_VECTOR2:a instanceof f.Wo?l=e.ANIMATIONTYPE_COLOR3:a instanceof f.HE?l=e.ANIMATIONTYPE_COLOR4:a instanceof b&&(l=e.ANIMATIONTYPE_SIZE),null==l)return null;var c=new e(t,n,i,l,s),d=[{frame:0,value:a},{frame:r,value:o}];return c.setKeys(d),void 0!==u&&c.setEasingFunction(u),c}},{key:"CreateAnimation",value:function(t,n,i,r){var a=new e(t+"Animation",t,i,n,e.ANIMATIONLOOPMODE_CONSTANT);return a.setEasingFunction(r),a}},{key:"CreateAndStartAnimation",value:function(t,n,i,r,a,o,s,u,l,c,h){var f=e._PrepareAnimation(t,i,r,a,o,s,u,l);return f?(n.getScene&&(h=n.getScene()),h?h.beginDirectAnimation(n,[f],0,a,1===f.loopMode,1,c):null):null}},{key:"CreateAndStartHierarchyAnimation",value:function(t,n,i,r,a,o,s,u,l,c,h){var f=e._PrepareAnimation(t,r,a,o,s,u,l,c);return f?n.getScene().beginDirectHierarchyAnimation(n,i,[f],0,o,1===f.loopMode,1,h):null}},{key:"CreateMergeAndStartAnimation",value:function(t,n,i,r,a,o,s,u,l,c){var h=e._PrepareAnimation(t,i,r,a,o,s,u,l);return h?(n.animations.push(h),n.getScene().beginAnimation(n,0,a,1===h.loopMode,1,c)):null}},{key:"MakeAnimationAdditive",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4?arguments[4]:void 0,o=t;if(r&&((o=t.clone()).name=a||o.name),!o._keys.length)return o;n=n>=0?n:0;var s=0,u=o._keys[0],l=o._keys.length-1,c=o._keys[l],f={referenceValue:u.value,referencePosition:h.jp.Vector3[0],referenceQuaternion:h.jp.Quaternion[0],referenceScaling:h.jp.Vector3[1],keyPosition:h.jp.Vector3[2],keyQuaternion:h.jp.Quaternion[1],keyScaling:h.jp.Vector3[3]},d=!1,p=u.frame,v=c.frame;if(i){var m=o.getRange(i);m&&(p=m.from,v=m.to)}var g=u.frame===p,_=c.frame===v;if(1===o._keys.length){var y=o._getKeyValue(o._keys[0]);f.referenceValue=y.clone?y.clone():y,d=!0}else if(n<=u.frame){var E=o._getKeyValue(u.value);f.referenceValue=E.clone?E.clone():E,d=!0}else if(n>=c.frame){var A=o._getKeyValue(c.value);f.referenceValue=A.clone?A.clone():A,d=!0}for(var b=0;!d||!g||!_&&b<o._keys.length-1;){var T=o._keys[b],M=o._keys[b+1];if(!d&&n>=T.frame&&n<=M.frame){var S=void 0;if(n===T.frame)S=o._getKeyValue(T.value);else if(n===M.frame)S=o._getKeyValue(M.value);else{var I={key:b,repeatCount:0,loopMode:this.ANIMATIONLOOPMODE_CONSTANT};S=o._interpolate(n,I)}f.referenceValue=S.clone?S.clone():S,d=!0}if(!g&&p>=T.frame&&p<=M.frame){if(p===T.frame)s=b;else if(p===M.frame)s=b+1;else{var x={key:b,repeatCount:0,loopMode:this.ANIMATIONLOOPMODE_CONSTANT},C=o._interpolate(p,x),P={frame:p,value:C.clone?C.clone():C};o._keys.splice(b+1,0,P),s=b+1}g=!0}if(!_&&v>=T.frame&&v<=M.frame){if(v===T.frame)l=b;else if(v===M.frame)l=b+1;else{var D={key:b,repeatCount:0,loopMode:this.ANIMATIONLOOPMODE_CONSTANT},R=o._interpolate(v,D),k={frame:v,value:R.clone?R.clone():R};o._keys.splice(b+1,0,k),l=b+1}_=!0}b++}for(o.dataType===e.ANIMATIONTYPE_QUATERNION?f.referenceValue.normalize().conjugateInPlace():o.dataType===e.ANIMATIONTYPE_MATRIX&&(f.referenceValue.decompose(f.referenceScaling,f.referenceQuaternion,f.referencePosition),f.referenceQuaternion.normalize().conjugateInPlace()),b=s;b<=l;b++){var O=o._keys[b];if(!b||o.dataType===e.ANIMATIONTYPE_FLOAT||O.value!==u.value)switch(o.dataType){case e.ANIMATIONTYPE_MATRIX:O.value.decompose(f.keyScaling,f.keyQuaternion,f.keyPosition),f.keyPosition.subtractInPlace(f.referencePosition),f.keyScaling.divideInPlace(f.referenceScaling),f.referenceQuaternion.multiplyToRef(f.keyQuaternion,f.keyQuaternion),h.y3.ComposeToRef(f.keyScaling,f.keyQuaternion,f.keyPosition,O.value);break;case e.ANIMATIONTYPE_QUATERNION:f.referenceValue.multiplyToRef(O.value,O.value);break;case e.ANIMATIONTYPE_VECTOR2:case e.ANIMATIONTYPE_VECTOR3:case e.ANIMATIONTYPE_COLOR3:case e.ANIMATIONTYPE_COLOR4:O.value.subtractToRef(f.referenceValue,O.value);break;case e.ANIMATIONTYPE_SIZE:O.value.width-=f.referenceValue.width,O.value.height-=f.referenceValue.height;break;default:O.value-=f.referenceValue}}return o}},{key:"TransitionTo",value:function(e,t,n,i,r,a,o){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;if(o<=0)return n[e]=t,s&&s(),null;var u=r*(o/1e3);a.setKeys([{frame:0,value:n[e].clone?n[e].clone():n[e]},{frame:u,value:t}]),n.animations||(n.animations=[]),n.animations.push(a);var l=i.beginAnimation(n,0,u,!1);return l.onAnimationEnd=s,l}},{key:"_UniversalLerp",value:function(e,t,n){var i=e.constructor;return i.Lerp?i.Lerp(e,t,n):i.Slerp?i.Slerp(e,t,n):e.toFixed?e*(1-n)+n*t:t}},{key:"Parse",value:function(t){var n,i,r=new e(t.name,t.property,t.framePerSecond,t.dataType,t.loopBehavior),a=t.dataType,o=[];for(t.enableBlending&&(r.enableBlending=t.enableBlending),t.blendingSpeed&&(r.blendingSpeed=t.blendingSpeed),i=0;i<t.keys.length;i++){var s=t.keys[i],u=void 0,l=void 0,c=void 0;switch(a){case e.ANIMATIONTYPE_FLOAT:n=s.values[0],s.values.length>=2&&(u=s.values[1]),s.values.length>=3&&(l=s.values[2]),s.values.length>=4&&(c=s.values[3]);break;case e.ANIMATIONTYPE_QUATERNION:if(n=h._f.FromArray(s.values),s.values.length>=8){var d=h._f.FromArray(s.values.slice(4,8));d.equals(h._f.Zero())||(u=d)}if(s.values.length>=12){var p=h._f.FromArray(s.values.slice(8,12));p.equals(h._f.Zero())||(l=p)}s.values.length>=13&&(c=s.values[12]);break;case e.ANIMATIONTYPE_MATRIX:n=h.y3.FromArray(s.values),s.values.length>=17&&(c=s.values[16]);break;case e.ANIMATIONTYPE_COLOR3:n=f.Wo.FromArray(s.values),s.values[3]&&(u=f.Wo.FromArray(s.values[3])),s.values[4]&&(l=f.Wo.FromArray(s.values[4])),s.values[5]&&(c=s.values[5]);break;case e.ANIMATIONTYPE_COLOR4:n=f.HE.FromArray(s.values),s.values[4]&&(u=f.HE.FromArray(s.values[4])),s.values[5]&&(l=f.HE.FromArray(s.values[5])),s.values[6]&&(c=f.HE.FromArray(s.values[6]));break;case e.ANIMATIONTYPE_VECTOR3:default:n=h.P.FromArray(s.values),s.values[3]&&(u=h.P.FromArray(s.values[3])),s.values[4]&&(l=h.P.FromArray(s.values[4])),s.values[5]&&(c=s.values[5])}var v={};v.frame=s.frame,v.value=n,null!=u&&(v.inTangent=u),null!=l&&(v.outTangent=l),null!=c&&(v.interpolation=c),o.push(v)}if(r.setKeys(o),t.ranges)for(i=0;i<t.ranges.length;i++)n=t.ranges[i],r.createRange(n.name,n.from,n.to);return r}},{key:"AppendSerializedAnimations",value:function(e,t){P.p4.AppendSerializedAnimations(e,t)}},{key:"ParseFromFileAsync",value:function(e,t){var n=this;return new Promise((function(i,r){var a=new z.g;a.addEventListener("readystatechange",(function(){if(4==a.readyState)if(200==a.status){var t=JSON.parse(a.responseText);if(t.animations&&(t=t.animations),t.length){var o,s=new Array,u=W(t);try{for(u.s();!(o=u.n()).done;){var l=o.value;s.push(n.Parse(l))}}catch(h){u.e(h)}finally{u.f()}i(s)}else{var c=n.Parse(t);e&&(c.name=e),i(c)}}else r("Unable to load the animation")})),a.open("GET",t),a.send()}))}},{key:"ParseFromSnippetAsync",value:function(e){var t=this;return new Promise((function(n,i){var r=new z.g;r.addEventListener("readystatechange",(function(){if(4==r.readyState)if(200==r.status){var a=JSON.parse(JSON.parse(r.responseText).jsonPayload);if(a.animations){var o,s=JSON.parse(a.animations),u=new Array,l=W(s.animations);try{for(l.s();!(o=l.n()).done;){var c=o.value,h=t.Parse(c);h.snippetId=e,u.push(h)}}catch(p){l.e(p)}finally{l.f()}n(u)}else{var f=JSON.parse(a.animation),d=t.Parse(f);d.snippetId=e,n(d)}}else i("Unable to load the snippet "+e)})),r.open("GET",t.SnippetUrl+"/"+e.replace(/#/g,"/")),r.send()}))}}]),e}();X._UniqueIdGenerator=0,X.AllowMatricesInterpolation=!1,X.AllowMatrixDecomposeForInterpolation=!0,X.SnippetUrl="https://snippet.babylonjs.com",X.ANIMATIONTYPE_FLOAT=0,X.ANIMATIONTYPE_VECTOR3=1,X.ANIMATIONTYPE_QUATERNION=2,X.ANIMATIONTYPE_MATRIX=3,X.ANIMATIONTYPE_COLOR3=4,X.ANIMATIONTYPE_COLOR4=7,X.ANIMATIONTYPE_VECTOR2=5,X.ANIMATIONTYPE_SIZE=6,X.ANIMATIONLOOPMODE_RELATIVE=0,X.ANIMATIONLOOPMODE_CYCLE=1,X.ANIMATIONLOOPMODE_CONSTANT=2,X.CreateFromSnippetAsync=X.ParseFromSnippetAsync,(0,V.H)("BABYLON.Animation",X),R.N._AnimationRangeFactory=function(e,t,n){return new G(e,t,n)};var j=function(){function e(){(0,E.Z)(this,e),this.transitionDuration=450,this.lowerRadiusTransitionRange=2,this.upperRadiusTransitionRange=-2,this._autoTransitionRange=!1,this._radiusIsAnimating=!1,this._radiusBounceTransition=null,this._animatables=new Array}return(0,A.Z)(e,[{key:"name",get:function(){return"Bouncing"}},{key:"autoTransitionRange",get:function(){return this._autoTransitionRange},set:function(e){var t=this;if(this._autoTransitionRange!==e){this._autoTransitionRange=e;var n=this._attachedCamera;n&&(e?this._onMeshTargetChangedObserver=n.onMeshTargetChangedObservable.add((function(e){if(e){e.computeWorldMatrix(!0);var n=e.getBoundingInfo().diagonalLength;t.lowerRadiusTransitionRange=.05*n,t.upperRadiusTransitionRange=.05*n}})):this._onMeshTargetChangedObserver&&n.onMeshTargetChangedObservable.remove(this._onMeshTargetChangedObserver))}}},{key:"init",value:function(){}},{key:"attach",value:function(e){var t=this;this._attachedCamera=e,this._onAfterCheckInputsObserver=e.onAfterCheckInputsObservable.add((function(){t._attachedCamera&&(t._isRadiusAtLimit(t._attachedCamera.lowerRadiusLimit)&&t._applyBoundRadiusAnimation(t.lowerRadiusTransitionRange),t._isRadiusAtLimit(t._attachedCamera.upperRadiusLimit)&&t._applyBoundRadiusAnimation(t.upperRadiusTransitionRange))}))}},{key:"detach",value:function(){this._attachedCamera&&(this._onAfterCheckInputsObserver&&this._attachedCamera.onAfterCheckInputsObservable.remove(this._onAfterCheckInputsObserver),this._onMeshTargetChangedObserver&&this._attachedCamera.onMeshTargetChangedObservable.remove(this._onMeshTargetChangedObserver),this._attachedCamera=null)}},{key:"_isRadiusAtLimit",value:function(e){return!!this._attachedCamera&&(this._attachedCamera.radius===e&&!this._radiusIsAnimating)}},{key:"_applyBoundRadiusAnimation",value:function(t){var n=this;if(this._attachedCamera){this._radiusBounceTransition||(e.EasingFunction.setEasingMode(e.EasingMode),this._radiusBounceTransition=X.CreateAnimation("radius",X.ANIMATIONTYPE_FLOAT,60,e.EasingFunction)),this._cachedWheelPrecision=this._attachedCamera.wheelPrecision,this._attachedCamera.wheelPrecision=1/0,this._attachedCamera.inertialRadiusOffset=0,this.stopAllAnimations(),this._radiusIsAnimating=!0;var i=X.TransitionTo("radius",this._attachedCamera.radius+t,this._attachedCamera,this._attachedCamera.getScene(),60,this._radiusBounceTransition,this.transitionDuration,(function(){return n._clearAnimationLocks()}));i&&this._animatables.push(i)}}},{key:"_clearAnimationLocks",value:function(){this._radiusIsAnimating=!1,this._attachedCamera&&(this._attachedCamera.wheelPrecision=this._cachedWheelPrecision)}},{key:"stopAllAnimations",value:function(){for(this._attachedCamera&&(this._attachedCamera.animations=[]);this._animatables.length;)this._animatables[0].onAnimationEnd=null,this._animatables[0].stop(),this._animatables.shift()}}]),e}();j.EasingFunction=new B(.3),j.EasingMode=L.EASINGMODE_EASEOUT;var Y=function(){function e(){(0,E.Z)(this,e),this.onTargetFramingAnimationEndObservable=new D.y$,this._mode=e.FitFrustumSidesMode,this._radiusScale=1,this._positionScale=.5,this._defaultElevation=.3,this._elevationReturnTime=1500,this._elevationReturnWaitTime=1e3,this._zoomStopsAnimation=!1,this._framingTime=1500,this.autoCorrectCameraLimitsAndSensibility=!0,this._isPointerDown=!1,this._lastInteractionTime=-1/0,this._animatables=new Array,this._betaIsAnimating=!1}return(0,A.Z)(e,[{key:"name",get:function(){return"Framing"}},{key:"mode",get:function(){return this._mode},set:function(e){this._mode=e}},{key:"radiusScale",get:function(){return this._radiusScale},set:function(e){this._radiusScale=e}},{key:"positionScale",get:function(){return this._positionScale},set:function(e){this._positionScale=e}},{key:"defaultElevation",get:function(){return this._defaultElevation},set:function(e){this._defaultElevation=e}},{key:"elevationReturnTime",get:function(){return this._elevationReturnTime},set:function(e){this._elevationReturnTime=e}},{key:"elevationReturnWaitTime",get:function(){return this._elevationReturnWaitTime},set:function(e){this._elevationReturnWaitTime=e}},{key:"zoomStopsAnimation",get:function(){return this._zoomStopsAnimation},set:function(e){this._zoomStopsAnimation=e}},{key:"framingTime",get:function(){return this._framingTime},set:function(e){this._framingTime=e}},{key:"init",value:function(){}},{key:"attach",value:function(t){var n=this;this._attachedCamera=t;var i=this._attachedCamera.getScene();e.EasingFunction.setEasingMode(e.EasingMode),this._onPrePointerObservableObserver=i.onPrePointerObservable.add((function(e){e.type!==k.kD.POINTERDOWN?e.type===k.kD.POINTERUP&&(n._isPointerDown=!1):n._isPointerDown=!0})),this._onMeshTargetChangedObserver=t.onMeshTargetChangedObservable.add((function(e){e&&n.zoomOnMesh(e,void 0,(function(){n.onTargetFramingAnimationEndObservable.notifyObservers()}))})),this._onAfterCheckInputsObserver=t.onAfterCheckInputsObservable.add((function(){n._applyUserInteraction(),n._maintainCameraAboveGround()}))}},{key:"detach",value:function(){if(this._attachedCamera){var e=this._attachedCamera.getScene();this._onPrePointerObservableObserver&&e.onPrePointerObservable.remove(this._onPrePointerObservableObserver),this._onAfterCheckInputsObserver&&this._attachedCamera.onAfterCheckInputsObservable.remove(this._onAfterCheckInputsObserver),this._onMeshTargetChangedObserver&&this._attachedCamera.onMeshTargetChangedObservable.remove(this._onMeshTargetChangedObserver),this._attachedCamera=null}}},{key:"zoomOnMesh",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.computeWorldMatrix(!0);var i=e.getBoundingInfo().boundingBox;this.zoomOnBoundingInfo(i.minimumWorld,i.maximumWorld,t,n)}},{key:"zoomOnMeshHierarchy",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.computeWorldMatrix(!0);var i=e.getHierarchyBoundingVectors(!0);this.zoomOnBoundingInfo(i.min,i.max,t,n)}},{key:"zoomOnMeshesHierarchy",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=new h.P(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),r=new h.P(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),a=0;a<e.length;a++){var o=e[a].getHierarchyBoundingVectors(!0);h.P.CheckExtends(o.min,i,r),h.P.CheckExtends(o.max,i,r)}this.zoomOnBoundingInfo(i,r,t,n)}},{key:"zoomOnBoundingInfo",value:function(t,n){var i,r=this,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(this._attachedCamera){var s=t.y,u=n.y,l=s+(u-s)*this._positionScale,c=n.subtract(t).scale(.5);if(a)i=new h.P(0,l,0);else{var f=t.add(c);i=new h.P(f.x,l,f.z)}this._vectorTransition||(this._vectorTransition=X.CreateAnimation("target",X.ANIMATIONTYPE_VECTOR3,60,e.EasingFunction)),this._betaIsAnimating=!0;var d=X.TransitionTo("target",i,this._attachedCamera,this._attachedCamera.getScene(),60,this._vectorTransition,this._framingTime);d&&this._animatables.push(d);var p=0;if(this._mode===e.FitFrustumSidesMode){var v=this._calculateLowerRadiusFromModelBoundingSphere(t,n);this.autoCorrectCameraLimitsAndSensibility&&(this._attachedCamera.lowerRadiusLimit=c.length()+this._attachedCamera.minZ),p=v}else this._mode===e.IgnoreBoundsSizeMode&&(p=this._calculateLowerRadiusFromModelBoundingSphere(t,n),this.autoCorrectCameraLimitsAndSensibility&&null===this._attachedCamera.lowerRadiusLimit&&(this._attachedCamera.lowerRadiusLimit=this._attachedCamera.minZ));if(this.autoCorrectCameraLimitsAndSensibility){var m=n.subtract(t).length();this._attachedCamera.panningSensibility=5e3/m,this._attachedCamera.wheelPrecision=100/p}this._radiusTransition||(this._radiusTransition=X.CreateAnimation("radius",X.ANIMATIONTYPE_FLOAT,60,e.EasingFunction)),(d=X.TransitionTo("radius",p,this._attachedCamera,this._attachedCamera.getScene(),60,this._radiusTransition,this._framingTime,(function(){r.stopAllAnimations(),o&&o(),r._attachedCamera&&r._attachedCamera.useInputToRestoreState&&r._attachedCamera.storeState()})))&&this._animatables.push(d)}}},{key:"_calculateLowerRadiusFromModelBoundingSphere",value:function(t,n){var i=n.subtract(t).length(),r=this._getFrustumSlope(),a=.5*i*this._radiusScale,o=a*Math.sqrt(1+1/(r.x*r.x)),s=a*Math.sqrt(1+1/(r.y*r.y)),u=Math.max(o,s),l=this._attachedCamera;return l?(l.lowerRadiusLimit&&this._mode===e.IgnoreBoundsSizeMode&&(u=u<l.lowerRadiusLimit?l.lowerRadiusLimit:u),l.upperRadiusLimit&&(u=u>l.upperRadiusLimit?l.upperRadiusLimit:u),u):0}},{key:"_maintainCameraAboveGround",value:function(){var t=this;if(!(this._elevationReturnTime<0)){var n=O.F.Now-this._lastInteractionTime,i=.5*Math.PI-this._defaultElevation,r=.5*Math.PI;if(this._attachedCamera&&!this._betaIsAnimating&&this._attachedCamera.beta>r&&n>=this._elevationReturnWaitTime){this._betaIsAnimating=!0,this.stopAllAnimations(),this._betaTransition||(this._betaTransition=X.CreateAnimation("beta",X.ANIMATIONTYPE_FLOAT,60,e.EasingFunction));var a=X.TransitionTo("beta",i,this._attachedCamera,this._attachedCamera.getScene(),60,this._betaTransition,this._elevationReturnTime,(function(){t._clearAnimationLocks(),t.stopAllAnimations()}));a&&this._animatables.push(a)}}}},{key:"_getFrustumSlope",value:function(){var e=this._attachedCamera;if(!e)return h.FM.Zero();var t=e.getScene().getEngine().getAspectRatio(e),n=Math.tan(e.fov/2),i=n*t;return new h.FM(i,n)}},{key:"_clearAnimationLocks",value:function(){this._betaIsAnimating=!1}},{key:"_applyUserInteraction",value:function(){this.isUserIsMoving&&(this._lastInteractionTime=O.F.Now,this.stopAllAnimations(),this._clearAnimationLocks())}},{key:"stopAllAnimations",value:function(){for(this._attachedCamera&&(this._attachedCamera.animations=[]);this._animatables.length;)this._animatables[0]&&(this._animatables[0].onAnimationEnd=null,this._animatables[0].stop()),this._animatables.shift()}},{key:"isUserIsMoving",get:function(){return!!this._attachedCamera&&(0!==this._attachedCamera.inertialAlphaOffset||0!==this._attachedCamera.inertialBetaOffset||0!==this._attachedCamera.inertialRadiusOffset||0!==this._attachedCamera.inertialPanningX||0!==this._attachedCamera.inertialPanningY||this._isPointerDown)}}]),e}();Y.EasingFunction=new U,Y.EasingMode=L.EASINGMODE_EASEINOUT,Y.IgnoreBoundsSizeMode=0,Y.FitFrustumSidesMode=1;var Z=n(7337);function K(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,x.Z)(e);if(t){var r=(0,x.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,I.Z)(this,n)}}var q=function(e){(0,S.Z)(n,e);var t=K(n);function n(e,i,r){var a,o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return(0,E.Z)(this,n),(a=t.call(this,e,i,r,o))._tmpUpVector=h.P.Zero(),a._tmpTargetVector=h.P.Zero(),a.cameraDirection=new h.P(0,0,0),a.cameraRotation=new h.FM(0,0),a.ignoreParentScaling=!1,a.updateUpVectorFromRotation=!1,a._tmpQuaternion=new h._f,a.rotation=new h.P(0,0,0),a.speed=2,a.noRotationConstraint=!1,a.invertRotation=!1,a.inverseRotationSpeed=.2,a.lockedTarget=null,a._currentTarget=h.P.Zero(),a._initialFocalDistance=1,a._viewMatrix=h.y3.Zero(),a._camMatrix=h.y3.Zero(),a._cameraTransformMatrix=h.y3.Zero(),a._cameraRotationMatrix=h.y3.Zero(),a._referencePoint=new h.P(0,0,1),a._transformedReferencePoint=h.P.Zero(),a._defaultUp=h.P.Up(),a._cachedRotationZ=0,a._cachedQuaternionRotationZ=0,a}return(0,A.Z)(n,[{key:"getFrontPosition",value:function(e){this.getWorldMatrix();var t=this.getTarget().subtract(this.position);return t.normalize(),t.scaleInPlace(e),this.globalPosition.add(t)}},{key:"_getLockedTargetPosition",value:function(){return this.lockedTarget?(this.lockedTarget.absolutePosition&&this.lockedTarget.computeWorldMatrix(),this.lockedTarget.absolutePosition||this.lockedTarget):null}},{key:"storeState",value:function(){return this._storedPosition=this.position.clone(),this._storedRotation=this.rotation.clone(),this.rotationQuaternion&&(this._storedRotationQuaternion=this.rotationQuaternion.clone()),(0,M.Z)((0,x.Z)(n.prototype),"storeState",this).call(this)}},{key:"_restoreStateValues",value:function(){return!!(0,M.Z)((0,x.Z)(n.prototype),"_restoreStateValues",this).call(this)&&(this.position=this._storedPosition.clone(),this.rotation=this._storedRotation.clone(),this.rotationQuaternion&&(this.rotationQuaternion=this._storedRotationQuaternion.clone()),this.cameraDirection.copyFromFloats(0,0,0),this.cameraRotation.copyFromFloats(0,0),!0)}},{key:"_initCache",value:function(){(0,M.Z)((0,x.Z)(n.prototype),"_initCache",this).call(this),this._cache.lockedTarget=new h.P(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),this._cache.rotation=new h.P(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),this._cache.rotationQuaternion=new h._f(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE)}},{key:"_updateCache",value:function(e){e||(0,M.Z)((0,x.Z)(n.prototype),"_updateCache",this).call(this);var t=this._getLockedTargetPosition();t?this._cache.lockedTarget?this._cache.lockedTarget.copyFrom(t):this._cache.lockedTarget=t.clone():this._cache.lockedTarget=null,this._cache.rotation.copyFrom(this.rotation),this.rotationQuaternion&&this._cache.rotationQuaternion.copyFrom(this.rotationQuaternion)}},{key:"_isSynchronizedViewMatrix",value:function(){if(!(0,M.Z)((0,x.Z)(n.prototype),"_isSynchronizedViewMatrix",this).call(this))return!1;var e=this._getLockedTargetPosition();return(this._cache.lockedTarget?this._cache.lockedTarget.equals(e):!e)&&(this.rotationQuaternion?this.rotationQuaternion.equals(this._cache.rotationQuaternion):this._cache.rotation.equals(this.rotation))}},{key:"_computeLocalCameraSpeed",value:function(){var e=this.getEngine();return this.speed*Math.sqrt(e.getDeltaTime()/(100*e.getFps()))}},{key:"setTarget",value:function(e){this.upVector.normalize(),this._initialFocalDistance=e.subtract(this.position).length(),this.position.z===e.z&&(this.position.z+=g.kn),this._referencePoint.normalize().scaleInPlace(this._initialFocalDistance),h.y3.LookAtLHToRef(this.position,e,this._defaultUp,this._camMatrix),this._camMatrix.invert(),this.rotation.x=Math.atan(this._camMatrix.m[6]/this._camMatrix.m[10]);var t=e.subtract(this.position);t.x>=0?this.rotation.y=-Math.atan(t.z/t.x)+Math.PI/2:this.rotation.y=-Math.atan(t.z/t.x)-Math.PI/2,this.rotation.z=0,isNaN(this.rotation.x)&&(this.rotation.x=0),isNaN(this.rotation.y)&&(this.rotation.y=0),isNaN(this.rotation.z)&&(this.rotation.z=0),this.rotationQuaternion&&h._f.RotationYawPitchRollToRef(this.rotation.y,this.rotation.x,this.rotation.z,this.rotationQuaternion)}},{key:"target",get:function(){return this.getTarget()},set:function(e){this.setTarget(e)}},{key:"getTarget",value:function(){return this._currentTarget}},{key:"_decideIfNeedsToMove",value:function(){return Math.abs(this.cameraDirection.x)>0||Math.abs(this.cameraDirection.y)>0||Math.abs(this.cameraDirection.z)>0}},{key:"_updatePosition",value:function(){if(this.parent)return this.parent.getWorldMatrix().invertToRef(h.jp.Matrix[0]),h.P.TransformNormalToRef(this.cameraDirection,h.jp.Matrix[0],h.jp.Vector3[0]),void this.position.addInPlace(h.jp.Vector3[0]);this.position.addInPlace(this.cameraDirection)}},{key:"_checkInputs",value:function(){var e=this.invertRotation?-this.inverseRotationSpeed:1,t=this._decideIfNeedsToMove(),i=Math.abs(this.cameraRotation.x)>0||Math.abs(this.cameraRotation.y)>0;if(t&&this._updatePosition(),i){if(this.rotationQuaternion&&this.rotationQuaternion.toEulerAnglesToRef(this.rotation),this.rotation.x+=this.cameraRotation.x*e,this.rotation.y+=this.cameraRotation.y*e,!this.noRotationConstraint){var r=1.570796;this.rotation.x>r&&(this.rotation.x=r),this.rotation.x<-r&&(this.rotation.x=-r)}if(this.rotationQuaternion)this.rotation.lengthSquared()&&h._f.RotationYawPitchRollToRef(this.rotation.y,this.rotation.x,this.rotation.z,this.rotationQuaternion)}t&&(Math.abs(this.cameraDirection.x)<this.speed*g.kn&&(this.cameraDirection.x=0),Math.abs(this.cameraDirection.y)<this.speed*g.kn&&(this.cameraDirection.y=0),Math.abs(this.cameraDirection.z)<this.speed*g.kn&&(this.cameraDirection.z=0),this.cameraDirection.scaleInPlace(this.inertia)),i&&(Math.abs(this.cameraRotation.x)<this.speed*g.kn&&(this.cameraRotation.x=0),Math.abs(this.cameraRotation.y)<this.speed*g.kn&&(this.cameraRotation.y=0),this.cameraRotation.scaleInPlace(this.inertia)),(0,M.Z)((0,x.Z)(n.prototype),"_checkInputs",this).call(this)}},{key:"_updateCameraRotationMatrix",value:function(){this.rotationQuaternion?this.rotationQuaternion.toRotationMatrix(this._cameraRotationMatrix):h.y3.RotationYawPitchRollToRef(this.rotation.y,this.rotation.x,this.rotation.z,this._cameraRotationMatrix)}},{key:"_rotateUpVectorWithCameraRotationMatrix",value:function(){return h.P.TransformNormalToRef(this._defaultUp,this._cameraRotationMatrix,this.upVector),this}},{key:"_getViewMatrix",value:function(){return this.lockedTarget&&this.setTarget(this._getLockedTargetPosition()),this._updateCameraRotationMatrix(),this.rotationQuaternion&&this._cachedQuaternionRotationZ!=this.rotationQuaternion.z?(this._rotateUpVectorWithCameraRotationMatrix(),this._cachedQuaternionRotationZ=this.rotationQuaternion.z):this._cachedRotationZ!==this.rotation.z&&(this._rotateUpVectorWithCameraRotationMatrix(),this._cachedRotationZ=this.rotation.z),h.P.TransformCoordinatesToRef(this._referencePoint,this._cameraRotationMatrix,this._transformedReferencePoint),this.position.addToRef(this._transformedReferencePoint,this._currentTarget),this.updateUpVectorFromRotation&&(this.rotationQuaternion?m.RD.Y.rotateByQuaternionToRef(this.rotationQuaternion,this.upVector):(h._f.FromEulerVectorToRef(this.rotation,this._tmpQuaternion),m.RD.Y.rotateByQuaternionToRef(this._tmpQuaternion,this.upVector))),this._computeViewMatrix(this.position,this._currentTarget,this.upVector),this._viewMatrix}},{key:"_computeViewMatrix",value:function(e,t,n){if(this.ignoreParentScaling){if(this.parent){var i=this.parent.getWorldMatrix();h.P.TransformCoordinatesToRef(e,i,this._globalPosition),h.P.TransformCoordinatesToRef(t,i,this._tmpTargetVector),h.P.TransformNormalToRef(n,i,this._tmpUpVector),this._markSyncedWithParent()}else this._globalPosition.copyFrom(e),this._tmpTargetVector.copyFrom(t),this._tmpUpVector.copyFrom(n);this.getScene().useRightHandedSystem?h.y3.LookAtRHToRef(this._globalPosition,this._tmpTargetVector,this._tmpUpVector,this._viewMatrix):h.y3.LookAtLHToRef(this._globalPosition,this._tmpTargetVector,this._tmpUpVector,this._viewMatrix)}else if(this.getScene().useRightHandedSystem?h.y3.LookAtRHToRef(e,t,n,this._viewMatrix):h.y3.LookAtLHToRef(e,t,n,this._viewMatrix),this.parent){var r=this.parent.getWorldMatrix();this._viewMatrix.invert(),this._viewMatrix.multiplyToRef(r,this._viewMatrix),this._viewMatrix.getTranslationToRef(this._globalPosition),this._viewMatrix.invert(),this._markSyncedWithParent()}else this._globalPosition.copyFrom(e)}},{key:"createRigCamera",value:function(e,t){if(this.cameraRigMode!==Z.V.RIG_MODE_NONE){var i=new n(e,this.position.clone(),this.getScene());return i.isRigCamera=!0,i.rigParent=this,this.cameraRigMode!==Z.V.RIG_MODE_VR&&this.cameraRigMode!==Z.V.RIG_MODE_WEBVR||(this.rotationQuaternion||(this.rotationQuaternion=new h._f),i._cameraRigParams={},i.rotationQuaternion=new h._f),i.mode=this.mode,i.orthoLeft=this.orthoLeft,i.orthoRight=this.orthoRight,i.orthoTop=this.orthoTop,i.orthoBottom=this.orthoBottom,i}return null}},{key:"_updateRigCameras",value:function(){var e=this._rigCameras[0],t=this._rigCameras[1];switch(this.computeWorldMatrix(),this.cameraRigMode){case Z.V.RIG_MODE_STEREOSCOPIC_ANAGLYPH:case Z.V.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL:case Z.V.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED:case Z.V.RIG_MODE_STEREOSCOPIC_OVERUNDER:case Z.V.RIG_MODE_STEREOSCOPIC_INTERLACED:var i=this.cameraRigMode===Z.V.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED?1:-1,r=this.cameraRigMode===Z.V.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED?-1:1;this._getRigCamPositionAndTarget(this._cameraRigParams.stereoHalfAngle*i,e),this._getRigCamPositionAndTarget(this._cameraRigParams.stereoHalfAngle*r,t);break;case Z.V.RIG_MODE_VR:e.rotationQuaternion?(e.rotationQuaternion.copyFrom(this.rotationQuaternion),t.rotationQuaternion.copyFrom(this.rotationQuaternion)):(e.rotation.copyFrom(this.rotation),t.rotation.copyFrom(this.rotation)),e.position.copyFrom(this.position),t.position.copyFrom(this.position)}(0,M.Z)((0,x.Z)(n.prototype),"_updateRigCameras",this).call(this)}},{key:"_getRigCamPositionAndTarget",value:function(e,t){this.getTarget().subtractToRef(this.position,n._TargetFocalPoint),n._TargetFocalPoint.normalize().scaleInPlace(this._initialFocalDistance);var i=n._TargetFocalPoint.addInPlace(this.position);h.y3.TranslationToRef(-i.x,-i.y,-i.z,n._TargetTransformMatrix),n._TargetTransformMatrix.multiplyToRef(h.y3.RotationAxis(t.upVector,e),n._RigCamTransformMatrix),h.y3.TranslationToRef(i.x,i.y,i.z,n._TargetTransformMatrix),n._RigCamTransformMatrix.multiplyToRef(n._TargetTransformMatrix,n._RigCamTransformMatrix),h.P.TransformCoordinatesToRef(this.position,n._RigCamTransformMatrix,t.position),t.setTarget(i)}},{key:"getClassName",value:function(){return"TargetCamera"}}]),n}(Z.V);q._RigCamTransformMatrix=new h.y3,q._TargetTransformMatrix=new h.y3,q._TargetFocalPoint=new h.P,(0,C.gn)([(0,P.hd)()],q.prototype,"rotation",void 0),(0,C.gn)([(0,P.qC)()],q.prototype,"speed",void 0),(0,C.gn)([(0,P.RR)("lockedTargetId")],q.prototype,"lockedTarget",void 0);var Q=n(2328),$={},J=function(){function e(t){(0,E.Z)(this,e),this.attachedToElement=!1,this.attached={},this.camera=t,this.checkInputs=function(){}}return(0,A.Z)(e,[{key:"add",value:function(e){var t=e.getSimpleName();this.attached[t]?Q.Y.Warn("camera input of type "+t+" already exists on camera"):(this.attached[t]=e,e.camera=this.camera,e.checkInputs&&(this.checkInputs=this._addCheckInputs(e.checkInputs.bind(e))),this.attachedToElement&&e.attachControl(this.noPreventDefault))}},{key:"remove",value:function(e){for(var t in this.attached){var n=this.attached[t];n===e&&(n.detachControl(),n.camera=null,delete this.attached[t],this.rebuildInputCheck())}}},{key:"removeByType",value:function(e){for(var t in this.attached){var n=this.attached[t];n.getClassName()===e&&(n.detachControl(),n.camera=null,delete this.attached[t],this.rebuildInputCheck())}}},{key:"_addCheckInputs",value:function(e){var t=this.checkInputs;return function(){t(),e()}}},{key:"attachInput",value:function(e){this.attachedToElement&&e.attachControl(this.noPreventDefault)}},{key:"attachElement",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.attachedToElement)for(var t in e=!Z.V.ForceAttachControlToAlwaysPreventDefault&&e,this.attachedToElement=!0,this.noPreventDefault=e,this.attached)this.attached[t].attachControl(e)}},{key:"detachElement",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];for(var t in this.attached)this.attached[t].detachControl(),e&&(this.attached[t].camera=null);this.attachedToElement=!1}},{key:"rebuildInputCheck",value:function(){for(var e in this.checkInputs=function(){},this.attached){var t=this.attached[e];t.checkInputs&&(this.checkInputs=this._addCheckInputs(t.checkInputs.bind(t)))}}},{key:"clear",value:function(){this.attachedToElement&&this.detachElement(!0),this.attached={},this.attachedToElement=!1,this.checkInputs=function(){}}},{key:"serialize",value:function(e){var t={};for(var n in this.attached){var i=this.attached[n],r=P.p4.Serialize(i);t[i.getClassName()]=r}e.inputsmgr=t}},{key:"parse",value:function(e){var t=this,n=e.inputsmgr;if(n){this.clear();var i=function(e){var i=$[e];if(i){var r=n[e],a=P.p4.Parse((function(){return new i}),r,null);t.add(a)}};for(var r in n)i(r)}else{var a=function(n){var i=$[t.attached[n].getClassName()];if(i){var r=P.p4.Parse((function(){return new i}),e,null);t.remove(t.attached[n]),t.add(r)}};for(var o in this.attached)a(o)}}}]),e}(),ee=n(8517),te=function(){function e(){(0,E.Z)(this,e),this._currentActiveButton=-1,this.buttons=[0,1,2]}return(0,A.Z)(e,[{key:"attachControl",value:function(e){var t=this;e=ee.w1.BackCompatCameraNoPreventDefault(arguments);var n=this.camera.getEngine(),i=n.getInputElement(),r=0,a=null;this._pointA=null,this._pointB=null,this._altKey=!1,this._ctrlKey=!1,this._metaKey=!1,this._shiftKey=!1,this._buttonsPressed=0,this._pointerInput=function(o){var s=o.event,u="touch"===s.pointerType;if(!n.isInVRExclusivePointerMode&&(o.type===k.kD.POINTERMOVE||-1!==t.buttons.indexOf(s.button))){var l=s.target;if(t._altKey=s.altKey,t._ctrlKey=s.ctrlKey,t._metaKey=s.metaKey,t._shiftKey=s.shiftKey,t._buttonsPressed=s.buttons,n.isPointerLock){var c=s.movementX,h=s.movementY;t.onTouch(null,c,h),t._pointA=null,t._pointB=null}else if(o.type!==k.kD.POINTERDOWN||-1!==t._currentActiveButton&&!u)if(o.type===k.kD.POINTERDOUBLETAP)t.onDoubleTap(s.pointerType);else if(o.type!==k.kD.POINTERUP||t._currentActiveButton!==s.button&&!u){if(o.type===k.kD.POINTERMOVE)if(e||s.preventDefault(),t._pointA&&null===t._pointB){var f=s.clientX-t._pointA.x,d=s.clientY-t._pointA.y;t.onTouch(t._pointA,f,d),t._pointA.x=s.clientX,t._pointA.y=s.clientY}else if(t._pointA&&t._pointB){var p=t._pointA.pointerId===s.pointerId?t._pointA:t._pointB;p.x=s.clientX,p.y=s.clientY;var v=t._pointA.x-t._pointB.x,m=t._pointA.y-t._pointB.y,g=v*v+m*m,_={x:(t._pointA.x+t._pointB.x)/2,y:(t._pointA.y+t._pointB.y)/2,pointerId:s.pointerId,type:o.type};t.onMultiTouch(t._pointA,t._pointB,r,g,a,_),a=_,r=g}}else{try{null==l||l.releasePointerCapture(s.pointerId)}catch(y){}u||(t._pointB=null),n._badOS?t._pointA=t._pointB=null:t._pointB&&t._pointA&&t._pointA.pointerId==s.pointerId?(t._pointA=t._pointB,t._pointB=null):t._pointA&&t._pointB&&t._pointB.pointerId==s.pointerId?t._pointB=null:t._pointA=t._pointB=null,(0!==r||a)&&(t.onMultiTouch(t._pointA,t._pointB,r,0,a,null),r=0,a=null),t._currentActiveButton=-1,t.onButtonUp(s),e||s.preventDefault()}else{try{null==l||l.setPointerCapture(s.pointerId)}catch(y){}null===t._pointA?t._pointA={x:s.clientX,y:s.clientY,pointerId:s.pointerId,type:s.pointerType}:null===t._pointB&&(t._pointB={x:s.clientX,y:s.clientY,pointerId:s.pointerId,type:s.pointerType}),-1!==t._currentActiveButton||u||(t._currentActiveButton=s.button),t.onButtonDown(s),e||(s.preventDefault(),i&&i.focus())}}},this._observer=this.camera.getScene().onPointerObservable.add(this._pointerInput,k.kD.POINTERDOWN|k.kD.POINTERUP|k.kD.POINTERMOVE|k.kD.POINTERDOUBLETAP),this._onLostFocus=function(){t._pointA=t._pointB=null,r=0,a=null,t.onLostFocus()},this._contextMenuBind=this.onContextMenu.bind(this),i&&i.addEventListener("contextmenu",this._contextMenuBind,!1);var o=this.camera.getScene().getEngine().getHostWindow();o&&ee.w1.RegisterTopRootEvents(o,[{name:"blur",handler:this._onLostFocus}])}},{key:"detachControl",value:function(){if(this._onLostFocus){var e=this.camera.getScene().getEngine().getHostWindow();e&&ee.w1.UnregisterTopRootEvents(e,[{name:"blur",handler:this._onLostFocus}])}if(this._observer){if(this.camera.getScene().onPointerObservable.remove(this._observer),this._observer=null,this._contextMenuBind){var t=this.camera.getScene().getEngine().getInputElement();t&&t.removeEventListener("contextmenu",this._contextMenuBind)}this._onLostFocus=null}this._altKey=!1,this._ctrlKey=!1,this._metaKey=!1,this._shiftKey=!1,this._buttonsPressed=0,this._currentActiveButton=-1}},{key:"getClassName",value:function(){return"BaseCameraPointersInput"}},{key:"getSimpleName",value:function(){return"pointers"}},{key:"onDoubleTap",value:function(e){}},{key:"onTouch",value:function(e,t,n){}},{key:"onMultiTouch",value:function(e,t,n,i,r,a){}},{key:"onContextMenu",value:function(e){e.preventDefault()}},{key:"onButtonDown",value:function(e){}},{key:"onButtonUp",value:function(e){}},{key:"onLostFocus",value:function(){}}]),e}();function ne(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,x.Z)(e);if(t){var r=(0,x.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,I.Z)(this,n)}}(0,C.gn)([(0,P.qC)()],te.prototype,"buttons",void 0);var ie=function(e){(0,S.Z)(n,e);var t=ne(n);function n(){var e;return(0,E.Z)(this,n),(e=t.apply(this,arguments)).buttons=[0,1,2],e.angularSensibilityX=1e3,e.angularSensibilityY=1e3,e.pinchPrecision=12,e.pinchDeltaPercentage=0,e.useNaturalPinchZoom=!1,e.pinchZoom=!0,e.panningSensibility=1e3,e.multiTouchPanning=!0,e.multiTouchPanAndZoom=!0,e.pinchInwards=!0,e._isPanClick=!1,e._twoFingerActivityCount=0,e._isPinching=!1,e}return(0,A.Z)(n,[{key:"getClassName",value:function(){return"ArcRotateCameraPointersInput"}},{key:"_computeMultiTouchPanning",value:function(e,t){if(0!==this.panningSensibility&&e&&t){var n=t.x-e.x,i=t.y-e.y;this.camera.inertialPanningX+=-n/this.panningSensibility,this.camera.inertialPanningY+=i/this.panningSensibility}}},{key:"_computePinchZoom",value:function(e,t){var i=this.camera.radius||n.MinimumRadiusForPinch;this.useNaturalPinchZoom?this.camera.radius=i*Math.sqrt(e)/Math.sqrt(t):this.pinchDeltaPercentage?this.camera.inertialRadiusOffset+=.001*(t-e)*i*this.pinchDeltaPercentage:this.camera.inertialRadiusOffset+=(t-e)/(this.pinchPrecision*(this.pinchInwards?1:-1)*(this.angularSensibilityX+this.angularSensibilityY)/2)}},{key:"onTouch",value:function(e,t,n){0!==this.panningSensibility&&(this._ctrlKey&&this.camera._useCtrlForPanning||this._isPanClick)?(this.camera.inertialPanningX+=-t/this.panningSensibility,this.camera.inertialPanningY+=n/this.panningSensibility):(this.camera.inertialAlphaOffset-=t/this.angularSensibilityX,this.camera.inertialBetaOffset-=n/this.angularSensibilityY)}},{key:"onDoubleTap",value:function(){this.camera.useInputToRestoreState&&this.camera.restoreState()}},{key:"onMultiTouch",value:function(e,t,n,i,r,a){0===n&&null===r||0===i&&null===a||(this.multiTouchPanAndZoom?(this._computePinchZoom(n,i),this._computeMultiTouchPanning(r,a)):this.multiTouchPanning&&this.pinchZoom?(this._twoFingerActivityCount++,this._isPinching||this._twoFingerActivityCount<20&&Math.abs(Math.sqrt(i)-Math.sqrt(n))>this.camera.pinchToPanMaxDistance?(this._computePinchZoom(n,i),this._isPinching=!0):this._computeMultiTouchPanning(r,a)):this.multiTouchPanning?this._computeMultiTouchPanning(r,a):this.pinchZoom&&this._computePinchZoom(n,i))}},{key:"onButtonDown",value:function(e){this._isPanClick=e.button===this.camera._panningMouseButton}},{key:"onButtonUp",value:function(){this._twoFingerActivityCount=0,this._isPinching=!1}},{key:"onLostFocus",value:function(){this._isPanClick=!1,this._twoFingerActivityCount=0,this._isPinching=!1}}]),n}(te);ie.MinimumRadiusForPinch=.001,(0,C.gn)([(0,P.qC)()],ie.prototype,"buttons",void 0),(0,C.gn)([(0,P.qC)()],ie.prototype,"angularSensibilityX",void 0),(0,C.gn)([(0,P.qC)()],ie.prototype,"angularSensibilityY",void 0),(0,C.gn)([(0,P.qC)()],ie.prototype,"pinchPrecision",void 0),(0,C.gn)([(0,P.qC)()],ie.prototype,"pinchDeltaPercentage",void 0),(0,C.gn)([(0,P.qC)()],ie.prototype,"useNaturalPinchZoom",void 0),(0,C.gn)([(0,P.qC)()],ie.prototype,"pinchZoom",void 0),(0,C.gn)([(0,P.qC)()],ie.prototype,"panningSensibility",void 0),(0,C.gn)([(0,P.qC)()],ie.prototype,"multiTouchPanning",void 0),(0,C.gn)([(0,P.qC)()],ie.prototype,"multiTouchPanAndZoom",void 0),$.ArcRotateCameraPointersInput=ie;var re=n(3531),ae=function(){function e(){(0,E.Z)(this,e),this.keysUp=[38],this.keysDown=[40],this.keysLeft=[37],this.keysRight=[39],this.keysReset=[220],this.panningSensibility=50,this.zoomingSensibility=25,this.useAltToZoom=!0,this.angularSpeed=.01,this._keys=new Array}return(0,A.Z)(e,[{key:"attachControl",value:function(e){var t=this;e=ee.w1.BackCompatCameraNoPreventDefault(arguments),this._onCanvasBlurObserver||(this._scene=this.camera.getScene(),this._engine=this._scene.getEngine(),this._onCanvasBlurObserver=this._engine.onCanvasBlurObservable.add((function(){t._keys.length=0})),this._onKeyboardObserver=this._scene.onKeyboardObservable.add((function(n){var i=n.event;if(!i.metaKey)if(n.type===re.OG.KEYDOWN)t._ctrlPressed=i.ctrlKey,t._altPressed=i.altKey,(-1!==t.keysUp.indexOf(i.keyCode)||-1!==t.keysDown.indexOf(i.keyCode)||-1!==t.keysLeft.indexOf(i.keyCode)||-1!==t.keysRight.indexOf(i.keyCode)||-1!==t.keysReset.indexOf(i.keyCode))&&(-1===t._keys.indexOf(i.keyCode)&&t._keys.push(i.keyCode),i.preventDefault&&(e||i.preventDefault()));else if(-1!==t.keysUp.indexOf(i.keyCode)||-1!==t.keysDown.indexOf(i.keyCode)||-1!==t.keysLeft.indexOf(i.keyCode)||-1!==t.keysRight.indexOf(i.keyCode)||-1!==t.keysReset.indexOf(i.keyCode)){var r=t._keys.indexOf(i.keyCode);r>=0&&t._keys.splice(r,1),i.preventDefault&&(e||i.preventDefault())}})))}},{key:"detachControl",value:function(){this._scene&&(this._onKeyboardObserver&&this._scene.onKeyboardObservable.remove(this._onKeyboardObserver),this._onCanvasBlurObserver&&this._engine.onCanvasBlurObservable.remove(this._onCanvasBlurObserver),this._onKeyboardObserver=null,this._onCanvasBlurObserver=null),this._keys.length=0}},{key:"checkInputs",value:function(){if(this._onKeyboardObserver)for(var e=this.camera,t=0;t<this._keys.length;t++){var n=this._keys[t];-1!==this.keysLeft.indexOf(n)?this._ctrlPressed&&this.camera._useCtrlForPanning?e.inertialPanningX-=1/this.panningSensibility:e.inertialAlphaOffset-=this.angularSpeed:-1!==this.keysUp.indexOf(n)?this._ctrlPressed&&this.camera._useCtrlForPanning?e.inertialPanningY+=1/this.panningSensibility:this._altPressed&&this.useAltToZoom?e.inertialRadiusOffset+=1/this.zoomingSensibility:e.inertialBetaOffset-=this.angularSpeed:-1!==this.keysRight.indexOf(n)?this._ctrlPressed&&this.camera._useCtrlForPanning?e.inertialPanningX+=1/this.panningSensibility:e.inertialAlphaOffset+=this.angularSpeed:-1!==this.keysDown.indexOf(n)?this._ctrlPressed&&this.camera._useCtrlForPanning?e.inertialPanningY-=1/this.panningSensibility:this._altPressed&&this.useAltToZoom?e.inertialRadiusOffset-=1/this.zoomingSensibility:e.inertialBetaOffset+=this.angularSpeed:-1!==this.keysReset.indexOf(n)&&e.useInputToRestoreState&&e.restoreState()}}},{key:"getClassName",value:function(){return"ArcRotateCameraKeyboardMoveInput"}},{key:"getSimpleName",value:function(){return"keyboard"}}]),e}();(0,C.gn)([(0,P.qC)()],ae.prototype,"keysUp",void 0),(0,C.gn)([(0,P.qC)()],ae.prototype,"keysDown",void 0),(0,C.gn)([(0,P.qC)()],ae.prototype,"keysLeft",void 0),(0,C.gn)([(0,P.qC)()],ae.prototype,"keysRight",void 0),(0,C.gn)([(0,P.qC)()],ae.prototype,"keysReset",void 0),(0,C.gn)([(0,P.qC)()],ae.prototype,"panningSensibility",void 0),(0,C.gn)([(0,P.qC)()],ae.prototype,"zoomingSensibility",void 0),(0,C.gn)([(0,P.qC)()],ae.prototype,"useAltToZoom",void 0),(0,C.gn)([(0,P.qC)()],ae.prototype,"angularSpeed",void 0),$.ArcRotateCameraKeyboardMoveInput=ae;var oe=n(1187),se=function(){function e(){(0,E.Z)(this,e),this.wheelPrecision=3,this.zoomToMouseLocation=!1,this.wheelDeltaPercentage=0,this.customComputeDeltaFromMouseWheel=null,this._inertialPanning=h.P.Zero()}return(0,A.Z)(e,[{key:"_computeDeltaFromMouseWheelLegacyEvent",value:function(e,t){var n=.01*e*this.wheelDeltaPercentage*t;return e>0?n/(1+this.wheelDeltaPercentage):n*(1+this.wheelDeltaPercentage)}},{key:"attachControl",value:function(e){var t=this;e=ee.w1.BackCompatCameraNoPreventDefault(arguments),this._wheel=function(n){if(n.type===k.kD.POINTERWHEEL){var i=n.event,r=0,a=i.deltaMode===oe.G.DOM_DELTA_LINE?40:1,o=-i.deltaY*a;if(t.customComputeDeltaFromMouseWheel)r=t.customComputeDeltaFromMouseWheel(o,t,i);else if(t.wheelDeltaPercentage){if((r=t._computeDeltaFromMouseWheelLegacyEvent(o,t.camera.radius))>0){for(var s=t.camera.radius,u=t.camera.inertialRadiusOffset+r,l=0;l<20&&Math.abs(u)>.001;l++)s-=u,u*=t.camera.inertia;s=_.R.Clamp(s,0,Number.MAX_VALUE),r=t._computeDeltaFromMouseWheelLegacyEvent(o,s)}}else r=o/(40*t.wheelPrecision);r&&(t.zoomToMouseLocation&&t._hitPlane?t._zoomToMouse(r):t.camera.inertialRadiusOffset+=r),i.preventDefault&&(e||i.preventDefault())}},this._observer=this.camera.getScene().onPointerObservable.add(this._wheel,k.kD.POINTERWHEEL),this.zoomToMouseLocation&&this._inertialPanning.setAll(0)}},{key:"detachControl",value:function(){this._observer&&(this.camera.getScene().onPointerObservable.remove(this._observer),this._observer=null,this._wheel=null)}},{key:"checkInputs",value:function(){if(this.zoomToMouseLocation){var e=this.camera;0+e.inertialAlphaOffset+e.inertialBetaOffset+e.inertialRadiusOffset&&(this._updateHitPlane(),e.target.addInPlace(this._inertialPanning),this._inertialPanning.scaleInPlace(e.inertia),this._zeroIfClose(this._inertialPanning))}}},{key:"getClassName",value:function(){return"ArcRotateCameraMouseWheelInput"}},{key:"getSimpleName",value:function(){return"mousewheel"}},{key:"_updateHitPlane",value:function(){var e=this.camera,t=e.target.subtract(e.position);this._hitPlane=y.J.FromPositionAndNormal(e.target,t)}},{key:"_getPosition",value:function(){var e,t=this.camera,n=t.getScene(),i=n.createPickingRay(n.pointerX,n.pointerY,h.y3.Identity(),t,!1),r=0;this._hitPlane&&(r=null!==(e=i.intersectsPlane(this._hitPlane))&&void 0!==e?e:0);return i.origin.addInPlace(i.direction.scaleInPlace(r))}},{key:"_zoomToMouse",value:function(e){var t=this.camera,n=1-t.inertia;if(t.lowerRadiusLimit){var i,r=null!==(i=t.lowerRadiusLimit)&&void 0!==i?i:0;t.radius-(t.inertialRadiusOffset+e)/n<r&&(e=(t.radius-r)*n-t.inertialRadiusOffset)}if(t.upperRadiusLimit){var a,o=null!==(a=t.upperRadiusLimit)&&void 0!==a?a:0;t.radius-(t.inertialRadiusOffset+e)/n>o&&(e=(t.radius-o)*n-t.inertialRadiusOffset)}var s=e/n/t.radius,u=this._getPosition(),l=h.jp.Vector3[6];u.subtractToRef(t.target,l),l.scaleInPlace(s),l.scaleInPlace(n),this._inertialPanning.addInPlace(l),t.inertialRadiusOffset+=e}},{key:"_zeroIfClose",value:function(e){Math.abs(e.x)<g.kn&&(e.x=0),Math.abs(e.y)<g.kn&&(e.y=0),Math.abs(e.z)<g.kn&&(e.z=0)}}]),e}();function ue(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,x.Z)(e);if(t){var r=(0,x.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,I.Z)(this,n)}}(0,C.gn)([(0,P.qC)()],se.prototype,"wheelPrecision",void 0),(0,C.gn)([(0,P.qC)()],se.prototype,"zoomToMouseLocation",void 0),(0,C.gn)([(0,P.qC)()],se.prototype,"wheelDeltaPercentage",void 0),$.ArcRotateCameraMouseWheelInput=se;var le=function(e){(0,S.Z)(n,e);var t=ue(n);function n(e){return(0,E.Z)(this,n),t.call(this,e)}return(0,A.Z)(n,[{key:"addMouseWheel",value:function(){return this.add(new se),this}},{key:"addPointers",value:function(){return this.add(new ie),this}},{key:"addKeyboard",value:function(){return this.add(new ae),this}}]),n}(J);function ce(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,x.Z)(e);if(t){var r=(0,x.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,I.Z)(this,n)}}R.N.AddNodeConstructor("ArcRotateCamera",(function(e,t){return function(){return new he(e,0,0,1,h.P.Zero(),t)}}));var he=function(e){(0,S.Z)(n,e);var t=ce(n);function n(e,i,r,a,o,s){var u,l=!(arguments.length>6&&void 0!==arguments[6])||arguments[6];return(0,E.Z)(this,n),(u=t.call(this,e,h.P.Zero(),s,l)).inertialAlphaOffset=0,u.inertialBetaOffset=0,u.inertialRadiusOffset=0,u.lowerAlphaLimit=null,u.upperAlphaLimit=null,u.lowerBetaLimit=.01,u.upperBetaLimit=Math.PI-.01,u.lowerRadiusLimit=null,u.upperRadiusLimit=null,u.inertialPanningX=0,u.inertialPanningY=0,u.pinchToPanMaxDistance=20,u.panningDistanceLimit=null,u.panningOriginTarget=h.P.Zero(),u.panningInertia=.9,u.zoomOnFactor=1,u.targetScreenOffset=h.FM.Zero(),u.allowUpsideDown=!0,u.useInputToRestoreState=!0,u._viewMatrix=new h.y3,u.panningAxis=new h.P(1,1,0),u._transformedDirection=new h.P,u.mapPanning=!1,u.onMeshTargetChangedObservable=new D.y$,u.checkCollisions=!1,u.collisionRadius=new h.P(.5,.5,.5),u._previousPosition=h.P.Zero(),u._collisionVelocity=h.P.Zero(),u._newPosition=h.P.Zero(),u._computationVector=h.P.Zero(),u._onCollisionPositionChange=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;n?(u.setPosition(t),u.onCollide&&u.onCollide(n)):u._previousPosition.copyFrom(u._position);var i=Math.cos(u.alpha),r=Math.sin(u.alpha),a=Math.cos(u.beta),o=Math.sin(u.beta);0===o&&(o=1e-4);var s=u._getTargetPosition();u._computationVector.copyFromFloats(u.radius*i*o,u.radius*a,u.radius*r*o),s.addToRef(u._computationVector,u._newPosition),u._position.copyFrom(u._newPosition);var l=u.upVector;u.allowUpsideDown&&u.beta<0&&(l=(l=l.clone()).negate()),u._computeViewMatrix(u._position,s,l),u._viewMatrix.addAtIndex(12,u.targetScreenOffset.x),u._viewMatrix.addAtIndex(13,u.targetScreenOffset.y),u._collisionTriggered=!1},u._target=h.P.Zero(),o&&u.setTarget(o),u.alpha=i,u.beta=r,u.radius=a,u.getViewMatrix(),u.inputs=new le((0,T.Z)(u)),u.inputs.addKeyboard().addMouseWheel().addPointers(),u}return(0,A.Z)(n,[{key:"target",get:function(){return this._target},set:function(e){this.setTarget(e)}},{key:"targetHost",get:function(){return this._targetHost},set:function(e){e&&this.setTarget(e)}},{key:"getTarget",value:function(){return this.target}},{key:"position",get:function(){return this._position},set:function(e){this.setPosition(e)}},{key:"upVector",get:function(){return this._upVector},set:function(e){this._upToYMatrix||(this._yToUpMatrix=new h.y3,this._upToYMatrix=new h.y3,this._upVector=h.P.Zero()),e.normalize(),this._upVector.copyFrom(e),this.setMatUp()}},{key:"setMatUp",value:function(){h.y3.RotationAlignToRef(h.P.UpReadOnly,this._upVector,this._yToUpMatrix),h.y3.RotationAlignToRef(this._upVector,h.P.UpReadOnly,this._upToYMatrix)}},{key:"angularSensibilityX",get:function(){var e=this.inputs.attached.pointers;return e?e.angularSensibilityX:0},set:function(e){var t=this.inputs.attached.pointers;t&&(t.angularSensibilityX=e)}},{key:"angularSensibilityY",get:function(){var e=this.inputs.attached.pointers;return e?e.angularSensibilityY:0},set:function(e){var t=this.inputs.attached.pointers;t&&(t.angularSensibilityY=e)}},{key:"pinchPrecision",get:function(){var e=this.inputs.attached.pointers;return e?e.pinchPrecision:0},set:function(e){var t=this.inputs.attached.pointers;t&&(t.pinchPrecision=e)}},{key:"pinchDeltaPercentage",get:function(){var e=this.inputs.attached.pointers;return e?e.pinchDeltaPercentage:0},set:function(e){var t=this.inputs.attached.pointers;t&&(t.pinchDeltaPercentage=e)}},{key:"useNaturalPinchZoom",get:function(){var e=this.inputs.attached.pointers;return!!e&&e.useNaturalPinchZoom},set:function(e){var t=this.inputs.attached.pointers;t&&(t.useNaturalPinchZoom=e)}},{key:"panningSensibility",get:function(){var e=this.inputs.attached.pointers;return e?e.panningSensibility:0},set:function(e){var t=this.inputs.attached.pointers;t&&(t.panningSensibility=e)}},{key:"keysUp",get:function(){var e=this.inputs.attached.keyboard;return e?e.keysUp:[]},set:function(e){var t=this.inputs.attached.keyboard;t&&(t.keysUp=e)}},{key:"keysDown",get:function(){var e=this.inputs.attached.keyboard;return e?e.keysDown:[]},set:function(e){var t=this.inputs.attached.keyboard;t&&(t.keysDown=e)}},{key:"keysLeft",get:function(){var e=this.inputs.attached.keyboard;return e?e.keysLeft:[]},set:function(e){var t=this.inputs.attached.keyboard;t&&(t.keysLeft=e)}},{key:"keysRight",get:function(){var e=this.inputs.attached.keyboard;return e?e.keysRight:[]},set:function(e){var t=this.inputs.attached.keyboard;t&&(t.keysRight=e)}},{key:"wheelPrecision",get:function(){var e=this.inputs.attached.mousewheel;return e?e.wheelPrecision:0},set:function(e){var t=this.inputs.attached.mousewheel;t&&(t.wheelPrecision=e)}},{key:"zoomToMouseLocation",get:function(){var e=this.inputs.attached.mousewheel;return!!e&&e.zoomToMouseLocation},set:function(e){var t=this.inputs.attached.mousewheel;t&&(t.zoomToMouseLocation=e)}},{key:"wheelDeltaPercentage",get:function(){var e=this.inputs.attached.mousewheel;return e?e.wheelDeltaPercentage:0},set:function(e){var t=this.inputs.attached.mousewheel;t&&(t.wheelDeltaPercentage=e)}},{key:"bouncingBehavior",get:function(){return this._bouncingBehavior}},{key:"useBouncingBehavior",get:function(){return null!=this._bouncingBehavior},set:function(e){e!==this.useBouncingBehavior&&(e?(this._bouncingBehavior=new j,this.addBehavior(this._bouncingBehavior)):this._bouncingBehavior&&(this.removeBehavior(this._bouncingBehavior),this._bouncingBehavior=null))}},{key:"framingBehavior",get:function(){return this._framingBehavior}},{key:"useFramingBehavior",get:function(){return null!=this._framingBehavior},set:function(e){e!==this.useFramingBehavior&&(e?(this._framingBehavior=new Y,this.addBehavior(this._framingBehavior)):this._framingBehavior&&(this.removeBehavior(this._framingBehavior),this._framingBehavior=null))}},{key:"autoRotationBehavior",get:function(){return this._autoRotationBehavior}},{key:"useAutoRotationBehavior",get:function(){return null!=this._autoRotationBehavior},set:function(e){e!==this.useAutoRotationBehavior&&(e?(this._autoRotationBehavior=new N,this.addBehavior(this._autoRotationBehavior)):this._autoRotationBehavior&&(this.removeBehavior(this._autoRotationBehavior),this._autoRotationBehavior=null))}},{key:"_initCache",value:function(){(0,M.Z)((0,x.Z)(n.prototype),"_initCache",this).call(this),this._cache._target=new h.P(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),this._cache.alpha=void 0,this._cache.beta=void 0,this._cache.radius=void 0,this._cache.targetScreenOffset=h.FM.Zero()}},{key:"_updateCache",value:function(e){e||(0,M.Z)((0,x.Z)(n.prototype),"_updateCache",this).call(this),this._cache._target.copyFrom(this._getTargetPosition()),this._cache.alpha=this.alpha,this._cache.beta=this.beta,this._cache.radius=this.radius,this._cache.targetScreenOffset.copyFrom(this.targetScreenOffset)}},{key:"_getTargetPosition",value:function(){if(this._targetHost&&this._targetHost.getAbsolutePosition){var e=this._targetHost.getAbsolutePosition();this._targetBoundingCenter?e.addToRef(this._targetBoundingCenter,this._target):this._target.copyFrom(e)}var t=this._getLockedTargetPosition();return t||this._target}},{key:"storeState",value:function(){return this._storedAlpha=this.alpha,this._storedBeta=this.beta,this._storedRadius=this.radius,this._storedTarget=this._getTargetPosition().clone(),this._storedTargetScreenOffset=this.targetScreenOffset.clone(),(0,M.Z)((0,x.Z)(n.prototype),"storeState",this).call(this)}},{key:"_restoreStateValues",value:function(){return!!(0,M.Z)((0,x.Z)(n.prototype),"_restoreStateValues",this).call(this)&&(this.setTarget(this._storedTarget.clone()),this.alpha=this._storedAlpha,this.beta=this._storedBeta,this.radius=this._storedRadius,this.targetScreenOffset=this._storedTargetScreenOffset.clone(),this.inertialAlphaOffset=0,this.inertialBetaOffset=0,this.inertialRadiusOffset=0,this.inertialPanningX=0,this.inertialPanningY=0,!0)}},{key:"_isSynchronizedViewMatrix",value:function(){return!!(0,M.Z)((0,x.Z)(n.prototype),"_isSynchronizedViewMatrix",this).call(this)&&(this._cache._target.equals(this._getTargetPosition())&&this._cache.alpha===this.alpha&&this._cache.beta===this.beta&&this._cache.radius===this.radius&&this._cache.targetScreenOffset.equals(this.targetScreenOffset))}},{key:"attachControl",value:function(e,t){var n=this,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,a=arguments;t=ee.w1.BackCompatCameraNoPreventDefault(a),this._useCtrlForPanning=i,this._panningMouseButton=r,"boolean"==typeof a[0]&&(a.length>1&&(this._useCtrlForPanning=a[1]),a.length>2&&(this._panningMouseButton=a[2])),this.inputs.attachElement(t),this._reset=function(){n.inertialAlphaOffset=0,n.inertialBetaOffset=0,n.inertialRadiusOffset=0,n.inertialPanningX=0,n.inertialPanningY=0}}},{key:"detachControl",value:function(){this.inputs.detachElement(),this._reset&&this._reset()}},{key:"_checkInputs",value:function(){if(!this._collisionTriggered){if(this.inputs.checkInputs(),0!==this.inertialAlphaOffset||0!==this.inertialBetaOffset||0!==this.inertialRadiusOffset){var e=this.invertRotation?-1:1,t=this.inertialAlphaOffset;this.beta<=0&&(t*=-1),this.getScene().useRightHandedSystem&&(t*=-1),this.parent&&this.parent._getWorldMatrixDeterminant()<0&&(t*=-1),this.alpha+=t*e,this.beta+=this.inertialBetaOffset*e,this.radius-=this.inertialRadiusOffset,this.inertialAlphaOffset*=this.inertia,this.inertialBetaOffset*=this.inertia,this.inertialRadiusOffset*=this.inertia,Math.abs(this.inertialAlphaOffset)<g.kn&&(this.inertialAlphaOffset=0),Math.abs(this.inertialBetaOffset)<g.kn&&(this.inertialBetaOffset=0),Math.abs(this.inertialRadiusOffset)<this.speed*g.kn&&(this.inertialRadiusOffset=0)}if(0!==this.inertialPanningX||0!==this.inertialPanningY){var i=new h.P(this.inertialPanningX,this.inertialPanningY,this.inertialPanningY);if(this._viewMatrix.invertToRef(this._cameraTransformMatrix),i.multiplyInPlace(this.panningAxis),h.P.TransformNormalToRef(i,this._cameraTransformMatrix,this._transformedDirection),!this.mapPanning&&this.panningAxis.y||(this._transformedDirection.y=0),!this._targetHost)if(this.panningDistanceLimit)this._transformedDirection.addInPlace(this._target),h.P.DistanceSquared(this._transformedDirection,this.panningOriginTarget)<=this.panningDistanceLimit*this.panningDistanceLimit&&this._target.copyFrom(this._transformedDirection);else this._target.addInPlace(this._transformedDirection);this.inertialPanningX*=this.panningInertia,this.inertialPanningY*=this.panningInertia,Math.abs(this.inertialPanningX)<this.speed*g.kn&&(this.inertialPanningX=0),Math.abs(this.inertialPanningY)<this.speed*g.kn&&(this.inertialPanningY=0)}this._checkLimits(),(0,M.Z)((0,x.Z)(n.prototype),"_checkInputs",this).call(this)}}},{key:"_checkLimits",value:function(){null===this.lowerBetaLimit||void 0===this.lowerBetaLimit?this.allowUpsideDown&&this.beta>Math.PI&&(this.beta=this.beta-2*Math.PI):this.beta<this.lowerBetaLimit&&(this.beta=this.lowerBetaLimit),null===this.upperBetaLimit||void 0===this.upperBetaLimit?this.allowUpsideDown&&this.beta<-Math.PI&&(this.beta=this.beta+2*Math.PI):this.beta>this.upperBetaLimit&&(this.beta=this.upperBetaLimit),null!==this.lowerAlphaLimit&&this.alpha<this.lowerAlphaLimit&&(this.alpha=this.lowerAlphaLimit),null!==this.upperAlphaLimit&&this.alpha>this.upperAlphaLimit&&(this.alpha=this.upperAlphaLimit),null!==this.lowerRadiusLimit&&this.radius<this.lowerRadiusLimit&&(this.radius=this.lowerRadiusLimit,this.inertialRadiusOffset=0),null!==this.upperRadiusLimit&&this.radius>this.upperRadiusLimit&&(this.radius=this.upperRadiusLimit,this.inertialRadiusOffset=0)}},{key:"rebuildAnglesAndRadius",value:function(){this._position.subtractToRef(this._getTargetPosition(),this._computationVector),0===this._upVector.x&&1===this._upVector.y&&0===this._upVector.z||h.P.TransformCoordinatesToRef(this._computationVector,this._upToYMatrix,this._computationVector),this.radius=this._computationVector.length(),0===this.radius&&(this.radius=1e-4);var e=this.alpha;0===this._computationVector.x&&0===this._computationVector.z?this.alpha=Math.PI/2:this.alpha=Math.acos(this._computationVector.x/Math.sqrt(Math.pow(this._computationVector.x,2)+Math.pow(this._computationVector.z,2))),this._computationVector.z<0&&(this.alpha=2*Math.PI-this.alpha);var t=Math.round((e-this.alpha)/(2*Math.PI));this.alpha+=2*t*Math.PI,this.beta=Math.acos(this._computationVector.y/this.radius),this._checkLimits()}},{key:"setPosition",value:function(e){this._position.equals(e)||(this._position.copyFrom(e),this.rebuildAnglesAndRadius())}},{key:"setTarget",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(r=null!==(t=this.overrideCloneAlphaBetaRadius)&&void 0!==t?t:r,e.getBoundingInfo)this._targetBoundingCenter=n?e.getBoundingInfo().boundingBox.centerWorld.clone():null,e.computeWorldMatrix(),this._targetHost=e,this._target=this._getTargetPosition(),this.onMeshTargetChangedObservable.notifyObservers(this._targetHost);else{var a=e,o=this._getTargetPosition();if(o&&!i&&o.equals(a))return;this._targetHost=null,this._target=a,this._targetBoundingCenter=null,this.onMeshTargetChangedObservable.notifyObservers(null)}r||this.rebuildAnglesAndRadius()}},{key:"_getViewMatrix",value:function(){var e=Math.cos(this.alpha),t=Math.sin(this.alpha),n=Math.cos(this.beta),i=Math.sin(this.beta);0===i&&(i=1e-4),0===this.radius&&(this.radius=1e-4);var r=this._getTargetPosition();if(this._computationVector.copyFromFloats(this.radius*e*i,this.radius*n,this.radius*t*i),0===this._upVector.x&&1===this._upVector.y&&0===this._upVector.z||h.P.TransformCoordinatesToRef(this._computationVector,this._yToUpMatrix,this._computationVector),r.addToRef(this._computationVector,this._newPosition),this.getScene().collisionsEnabled&&this.checkCollisions){var a=this.getScene().collisionCoordinator;this._collider||(this._collider=a.createCollider()),this._collider._radius=this.collisionRadius,this._newPosition.subtractToRef(this._position,this._collisionVelocity),this._collisionTriggered=!0,a.getNewPosition(this._position,this._collisionVelocity,this._collider,3,null,this._onCollisionPositionChange,this.uniqueId)}else{this._position.copyFrom(this._newPosition);var o=this.upVector;this.allowUpsideDown&&i<0&&(o=o.negate()),this._computeViewMatrix(this._position,r,o),this._viewMatrix.addAtIndex(12,this.targetScreenOffset.x),this._viewMatrix.addAtIndex(13,this.targetScreenOffset.y)}return this._currentTarget=r,this._viewMatrix}},{key:"zoomOn",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e=e||this.getScene().meshes;var n=o.Kj.MinMax(e),i=h.P.Distance(n.min,n.max);this.radius=i*this.zoomOnFactor,this.focusOn({min:n.min,max:n.max,distance:i},t)}},{key:"focusOn",value:function(e){var t,n,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(void 0===e.min){var r=e||this.getScene().meshes;t=o.Kj.MinMax(r),n=h.P.Distance(t.min,t.max)}else{var a=e;t=a,n=a.distance}this._target=o.Kj.Center(t),i||(this.maxZ=2*n)}},{key:"createRigCamera",value:function(e,t){var i=0;switch(this.cameraRigMode){case Z.V.RIG_MODE_STEREOSCOPIC_ANAGLYPH:case Z.V.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL:case Z.V.RIG_MODE_STEREOSCOPIC_OVERUNDER:case Z.V.RIG_MODE_STEREOSCOPIC_INTERLACED:case Z.V.RIG_MODE_VR:i=this._cameraRigParams.stereoHalfAngle*(0===t?1:-1);break;case Z.V.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED:i=this._cameraRigParams.stereoHalfAngle*(0===t?-1:1)}var r=new n(e,this.alpha+i,this.beta,this.radius,this._target,this.getScene());return r._cameraRigParams={},r.isRigCamera=!0,r.rigParent=this,r.upVector=this.upVector,r.mode=this.mode,r.orthoLeft=this.orthoLeft,r.orthoRight=this.orthoRight,r.orthoBottom=this.orthoBottom,r.orthoTop=this.orthoTop,r}},{key:"_updateRigCameras",value:function(){var e=this._rigCameras[0],t=this._rigCameras[1];switch(e.beta=t.beta=this.beta,this.cameraRigMode){case Z.V.RIG_MODE_STEREOSCOPIC_ANAGLYPH:case Z.V.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_PARALLEL:case Z.V.RIG_MODE_STEREOSCOPIC_OVERUNDER:case Z.V.RIG_MODE_STEREOSCOPIC_INTERLACED:case Z.V.RIG_MODE_VR:e.alpha=this.alpha-this._cameraRigParams.stereoHalfAngle,t.alpha=this.alpha+this._cameraRigParams.stereoHalfAngle;break;case Z.V.RIG_MODE_STEREOSCOPIC_SIDEBYSIDE_CROSSEYED:e.alpha=this.alpha+this._cameraRigParams.stereoHalfAngle,t.alpha=this.alpha-this._cameraRigParams.stereoHalfAngle}(0,M.Z)((0,x.Z)(n.prototype),"_updateRigCameras",this).call(this)}},{key:"dispose",value:function(){this.inputs.clear(),(0,M.Z)((0,x.Z)(n.prototype),"dispose",this).call(this)}},{key:"getClassName",value:function(){return"ArcRotateCamera"}}]),n}(q);(0,C.gn)([(0,P.qC)()],he.prototype,"alpha",void 0),(0,C.gn)([(0,P.qC)()],he.prototype,"beta",void 0),(0,C.gn)([(0,P.qC)()],he.prototype,"radius",void 0),(0,C.gn)([(0,P.qC)()],he.prototype,"overrideCloneAlphaBetaRadius",void 0),(0,C.gn)([(0,P.hd)("target")],he.prototype,"_target",void 0),(0,C.gn)([(0,P.RR)("targetHost")],he.prototype,"_targetHost",void 0),(0,C.gn)([(0,P.qC)()],he.prototype,"inertialAlphaOffset",void 0),(0,C.gn)([(0,P.qC)()],he.prototype,"inertialBetaOffset",void 0),(0,C.gn)([(0,P.qC)()],he.prototype,"inertialRadiusOffset",void 0),(0,C.gn)([(0,P.qC)()],he.prototype,"lowerAlphaLimit",void 0),(0,C.gn)([(0,P.qC)()],he.prototype,"upperAlphaLimit",void 0),(0,C.gn)([(0,P.qC)()],he.prototype,"lowerBetaLimit",void 0),(0,C.gn)([(0,P.qC)()],he.prototype,"upperBetaLimit",void 0),(0,C.gn)([(0,P.qC)()],he.prototype,"lowerRadiusLimit",void 0),(0,C.gn)([(0,P.qC)()],he.prototype,"upperRadiusLimit",void 0),(0,C.gn)([(0,P.qC)()],he.prototype,"inertialPanningX",void 0),(0,C.gn)([(0,P.qC)()],he.prototype,"inertialPanningY",void 0),(0,C.gn)([(0,P.qC)()],he.prototype,"pinchToPanMaxDistance",void 0),(0,C.gn)([(0,P.qC)()],he.prototype,"panningDistanceLimit",void 0),(0,C.gn)([(0,P.hd)()],he.prototype,"panningOriginTarget",void 0),(0,C.gn)([(0,P.qC)()],he.prototype,"panningInertia",void 0),(0,C.gn)([(0,P.qC)()],he.prototype,"zoomToMouseLocation",null),(0,C.gn)([(0,P.qC)()],he.prototype,"zoomOnFactor",void 0),(0,C.gn)([(0,P.QC)()],he.prototype,"targetScreenOffset",void 0),(0,C.gn)([(0,P.qC)()],he.prototype,"allowUpsideDown",void 0),(0,C.gn)([(0,P.qC)()],he.prototype,"useInputToRestoreState",void 0);var fe=n(5934),de=n(2845),pe=function(){function e(){(0,E.Z)(this,e),this.previousWorldMatrices={},this.previousBones={}}return(0,A.Z)(e,[{key:"bindForSubMesh",value:function(e,t,n,i,r){if(t.prePassRenderer&&t.prePassRenderer.enabled&&t.prePassRenderer.currentRTisSceneRT&&-1!==t.prePassRenderer.getIndex(2)){this.previousWorldMatrices[n.uniqueId]||(this.previousWorldMatrices[n.uniqueId]=i.clone()),this.previousViewProjection||(this.previousViewProjection=t.getTransformMatrix().clone(),this.currentViewProjection=t.getTransformMatrix().clone());var a=t.getEngine();this.currentViewProjection.updateFlag!==t.getTransformMatrix().updateFlag?(this._lastUpdateFrameId=a.frameId,this.previousViewProjection.copyFrom(this.currentViewProjection),this.currentViewProjection.copyFrom(t.getTransformMatrix())):this._lastUpdateFrameId!==a.frameId&&(this._lastUpdateFrameId=a.frameId,this.previousViewProjection.copyFrom(this.currentViewProjection)),e.setMatrix("previousWorld",this.previousWorldMatrices[n.uniqueId]),e.setMatrix("previousViewProjection",this.previousViewProjection),this.previousWorldMatrices[n.uniqueId]=i.clone()}}}],[{key:"AddUniforms",value:function(e){e.push("previousWorld","previousViewProjection","mPreviousBones")}},{key:"AddSamplers",value:function(e){}}]),e}(),ve=n(7823),me=n(6556),ge=n(4071),_e=n(4771);function ye(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,x.Z)(e);if(t){var r=(0,x.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,I.Z)(this,n)}}var Ee=function(e){(0,S.Z)(n,e);var t=ye(n);function n(e,i){var r,a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return(0,E.Z)(this,n),(r=t.call(this,e,i))._normalMatrix=new h.y3,r._storeEffectOnSubMeshes=a,r}return(0,A.Z)(n,[{key:"getEffect",value:function(){return this._storeEffectOnSubMeshes?this._activeEffect:(0,M.Z)((0,x.Z)(n.prototype),"getEffect",this).call(this)}},{key:"isReady",value:function(e,t){return!!e&&(!this._storeEffectOnSubMeshes||(!e.subMeshes||0===e.subMeshes.length||this.isReadyForSubMesh(e,e.subMeshes[0],t)))}},{key:"_isReadyForSubMesh",value:function(e){var t=e.materialDefines;return!(this.checkReadyOnEveryCall||!e.effect||!t||t._renderId!==this.getScene().getRenderId())}},{key:"bindOnlyWorldMatrix",value:function(e){this._activeEffect.setMatrix("world",e)}},{key:"bindOnlyNormalMatrix",value:function(e){this._activeEffect.setMatrix("normalMatrix",e)}},{key:"bind",value:function(e,t){t&&this.bindForSubMesh(e,t,t.subMeshes[0])}},{key:"_afterBind",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;(0,M.Z)((0,x.Z)(n.prototype),"_afterBind",this).call(this,e,t),this.getScene()._cachedEffect=t}},{key:"_mustRebind",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return e.isCachedMaterialInvalid(this,t,n)}}]),n}(me.F),Ae=n(114),be=n(4198),Te=n(9950);n(562);function Me(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,x.Z)(e);if(t){var r=(0,x.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,I.Z)(this,n)}}var Se=function(e){(0,S.Z)(n,e);var t=Me(n);function n(e){var i,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return(0,E.Z)(this,n),(i=t.call(this,null)).metadata=null,i.reservedDataStore=null,i._hasAlpha=!1,i._getAlphaFromRGB=!1,i.level=1,i._coordinatesIndex=0,i.optimizeUVAllocation=!0,i._coordinatesMode=0,i.wrapR=1,i.anisotropicFilteringLevel=n.DEFAULT_ANISOTROPIC_FILTERING_LEVEL,i._isCube=!1,i._gammaSpace=!0,i.invertZ=!1,i.lodLevelInAlpha=!1,i.isRenderTarget=!1,i._prefiltered=!1,i._forceSerialize=!1,i.animations=new Array,i.onDisposeObservable=new D.y$,i._onDisposeObserver=null,i._scene=null,i._uid=null,i._parentContainer=null,i._loadingError=!1,e?n._IsScene(e)?i._scene=e:i._engine=e:i._scene=be.l.LastCreatedScene,i._scene&&(i.uniqueId=i._scene.getUniqueId(),i._scene.addTexture((0,T.Z)(i)),i._engine=i._scene.getEngine()),i._texture=r,i._uid=null,i}return(0,A.Z)(n,[{key:"hasAlpha",get:function(){return this._hasAlpha},set:function(e){var t=this;this._hasAlpha!==e&&(this._hasAlpha=e,this._scene&&this._scene.markAllMaterialsAsDirty(1,(function(e){return e.hasTexture(t)})))}},{key:"getAlphaFromRGB",get:function(){return this._getAlphaFromRGB},set:function(e){var t=this;this._getAlphaFromRGB!==e&&(this._getAlphaFromRGB=e,this._scene&&this._scene.markAllMaterialsAsDirty(1,(function(e){return e.hasTexture(t)})))}},{key:"coordinatesIndex",get:function(){return this._coordinatesIndex},set:function(e){var t=this;this._coordinatesIndex!==e&&(this._coordinatesIndex=e,this._scene&&this._scene.markAllMaterialsAsDirty(1,(function(e){return e.hasTexture(t)})))}},{key:"coordinatesMode",get:function(){return this._coordinatesMode},set:function(e){var t=this;this._coordinatesMode!==e&&(this._coordinatesMode=e,this._scene&&this._scene.markAllMaterialsAsDirty(1,(function(e){return e.hasTexture(t)})))}},{key:"wrapU",get:function(){return this._wrapU},set:function(e){this._wrapU=e}},{key:"wrapV",get:function(){return this._wrapV},set:function(e){this._wrapV=e}},{key:"isCube",get:function(){return this._texture?this._texture.isCube:this._isCube},set:function(e){this._texture?this._texture.isCube=e:this._isCube=e}},{key:"is3D",get:function(){return!!this._texture&&this._texture.is3D},set:function(e){this._texture&&(this._texture.is3D=e)}},{key:"is2DArray",get:function(){return!!this._texture&&this._texture.is2DArray},set:function(e){this._texture&&(this._texture.is2DArray=e)}},{key:"gammaSpace",get:function(){return this._texture?(null===this._texture._gammaSpace&&(this._texture._gammaSpace=this._gammaSpace),this._texture._gammaSpace&&!this._texture._useSRGBBuffer):this._gammaSpace},set:function(e){if(this._texture){if(this._texture._gammaSpace===e)return;this._texture._gammaSpace=e}else{if(this._gammaSpace===e)return;this._gammaSpace=e}this._markAllSubMeshesAsTexturesDirty()}},{key:"isRGBD",get:function(){return null!=this._texture&&this._texture._isRGBD},set:function(e){this._texture&&(this._texture._isRGBD=e)}},{key:"noMipmap",get:function(){return!1}},{key:"lodGenerationOffset",get:function(){return this._texture?this._texture._lodGenerationOffset:0},set:function(e){this._texture&&(this._texture._lodGenerationOffset=e)}},{key:"lodGenerationScale",get:function(){return this._texture?this._texture._lodGenerationScale:0},set:function(e){this._texture&&(this._texture._lodGenerationScale=e)}},{key:"linearSpecularLOD",get:function(){return!!this._texture&&this._texture._linearSpecularLOD},set:function(e){this._texture&&(this._texture._linearSpecularLOD=e)}},{key:"irradianceTexture",get:function(){return this._texture?this._texture._irradianceTexture:null},set:function(e){this._texture&&(this._texture._irradianceTexture=e)}},{key:"uid",get:function(){return this._uid||(this._uid=(0,Te.f)()),this._uid}},{key:"toString",value:function(){return this.name}},{key:"getClassName",value:function(){return"BaseTexture"}},{key:"onDispose",set:function(e){this._onDisposeObserver&&this.onDisposeObservable.remove(this._onDisposeObserver),this._onDisposeObserver=this.onDisposeObservable.add(e)}},{key:"isBlocking",get:function(){return!0}},{key:"loadingError",get:function(){return this._loadingError}},{key:"errorObject",get:function(){return this._errorObject}},{key:"getScene",value:function(){return this._scene}},{key:"_getEngine",value:function(){return this._engine}},{key:"checkTransformsAreIdentical",value:function(e){return null!==e}},{key:"getTextureMatrix",value:function(){return h.y3.IdentityReadOnly}},{key:"getReflectionTextureMatrix",value:function(){return h.y3.IdentityReadOnly}},{key:"isReadyOrNotBlocking",value:function(){return!this.isBlocking||this.isReady()||this.loadingError}},{key:"scale",value:function(e){}},{key:"canRescale",get:function(){return!1}},{key:"_getFromCache",value:function(e,t,n,i,r,a){var o=this._getEngine();if(!o)return null;for(var s=o._getUseSRGBBuffer(!!r,t),u=o.getLoadedTexturesCache(),l=0;l<u.length;l++){var c=u[l];if(!(void 0!==r&&s!==c._useSRGBBuffer||void 0!==i&&i!==c.invertY||c.url!==e||c.generateMipMaps!==!t||n&&n!==c.samplingMode||void 0!==a&&a!==c.isCube))return c.incrementReferences(),c}return null}},{key:"_rebuild",value:function(){}},{key:"clone",value:function(){return null}},{key:"textureType",get:function(){return this._texture&&void 0!==this._texture.type?this._texture.type:0}},{key:"textureFormat",get:function(){return this._texture&&void 0!==this._texture.format?this._texture.format:5}},{key:"_markAllSubMeshesAsTexturesDirty",value:function(){var e=this.getScene();e&&e.markAllMaterialsAsDirty(1)}},{key:"readPixels",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:Number.MAX_VALUE,u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:Number.MAX_VALUE;if(!this._texture)return null;var l=this._getEngine();if(!l)return null;var c=this.getSize(),h=c.width,f=c.height;0!==t&&(h/=Math.pow(2,t),f/=Math.pow(2,t),h=Math.round(h),f=Math.round(f)),s=Math.min(h,s),u=Math.min(f,u);try{return this._texture.isCube?l._readTexturePixels(this._texture,s,u,e,t,n,i,r,a,o):l._readTexturePixels(this._texture,s,u,-1,t,n,i,r,a,o)}catch(d){return null}}},{key:"_readPixelsSync",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!this._texture)return null;var a=this.getSize(),o=a.width,s=a.height,u=this._getEngine();if(!u)return null;0!=t&&(o/=Math.pow(2,t),s/=Math.pow(2,t),o=Math.round(o),s=Math.round(s));try{return this._texture.isCube?u._readTexturePixelsSync(this._texture,o,s,e,t,n,i,r):u._readTexturePixelsSync(this._texture,o,s,-1,t,n,i,r)}catch(l){return null}}},{key:"_lodTextureHigh",get:function(){return this._texture?this._texture._lodTextureHigh:null}},{key:"_lodTextureMid",get:function(){return this._texture?this._texture._lodTextureMid:null}},{key:"_lodTextureLow",get:function(){return this._texture?this._texture._lodTextureLow:null}},{key:"dispose",value:function(){if(this._scene){this._scene.stopAnimation&&this._scene.stopAnimation(this),this._scene.removePendingData(this);var e=this._scene.textures.indexOf(this);if(e>=0&&this._scene.textures.splice(e,1),this._scene.onTextureRemovedObservable.notifyObservers(this),this._scene=null,this._parentContainer){var t=this._parentContainer.textures.indexOf(this);t>-1&&this._parentContainer.textures.splice(t,1),this._parentContainer=null}}this.onDisposeObservable.notifyObservers(this),this.onDisposeObservable.clear(),this.metadata=null,(0,M.Z)((0,x.Z)(n.prototype),"dispose",this).call(this)}},{key:"serialize",value:function(){if(!this.name)return null;var e=P.p4.Serialize(this);return P.p4.AppendSerializedAnimations(this,e),e}}],[{key:"WhenAllReady",value:function(e,t){var n=e.length;if(0!==n)for(var i=0;i<e.length;i++){var r=e[i];if(r.isReady())0==--n&&t();else{var a=r.onLoadObservable;a?a.addOnce((function(){0==--n&&t()})):0==--n&&t()}}else t()}},{key:"_IsScene",value:function(e){return"Scene"===e.getClassName()}}]),n}(function(){function e(t){(0,E.Z)(this,e),this._wrapU=1,this._wrapV=1,this.wrapR=1,this.anisotropicFilteringLevel=4,this.delayLoadState=0,this._texture=null,this._engine=null,this._cachedSize=b.Zero(),this._cachedBaseSize=b.Zero(),this._initialSamplingMode=2,this._texture=t,this._texture&&(this._engine=this._texture.getEngine())}return(0,A.Z)(e,[{key:"wrapU",get:function(){return this._wrapU},set:function(e){this._wrapU=e}},{key:"wrapV",get:function(){return this._wrapV},set:function(e){this._wrapV=e}},{key:"coordinatesMode",get:function(){return 0}},{key:"isCube",get:function(){return!!this._texture&&this._texture.isCube},set:function(e){this._texture&&(this._texture.isCube=e)}},{key:"is3D",get:function(){return!!this._texture&&this._texture.is3D},set:function(e){this._texture&&(this._texture.is3D=e)}},{key:"is2DArray",get:function(){return!!this._texture&&this._texture.is2DArray},set:function(e){this._texture&&(this._texture.is2DArray=e)}},{key:"getClassName",value:function(){return"ThinTexture"}},{key:"isReady",value:function(){return 4===this.delayLoadState?(this.delayLoad(),!1):!!this._texture&&this._texture.isReady}},{key:"delayLoad",value:function(){}},{key:"getInternalTexture",value:function(){return this._texture}},{key:"getSize",value:function(){if(this._texture){if(this._texture.width)return this._cachedSize.width=this._texture.width,this._cachedSize.height=this._texture.height,this._cachedSize;if(this._texture._size)return this._cachedSize.width=this._texture._size,this._cachedSize.height=this._texture._size,this._cachedSize}return this._cachedSize}},{key:"getBaseSize",value:function(){return this.isReady()&&this._texture?this._texture._size?(this._cachedBaseSize.width=this._texture._size,this._cachedBaseSize.height=this._texture._size,this._cachedBaseSize):(this._cachedBaseSize.width=this._texture.baseWidth,this._cachedBaseSize.height=this._texture.baseHeight,this._cachedBaseSize):(this._cachedBaseSize.width=0,this._cachedBaseSize.height=0,this._cachedBaseSize)}},{key:"samplingMode",get:function(){return this._texture?this._texture.samplingMode:this._initialSamplingMode}},{key:"updateSamplingMode",value:function(e){this._texture&&this._engine&&this._engine.updateTextureSamplingMode(e,this._texture)}},{key:"releaseInternalTexture",value:function(){this._texture&&(this._texture.dispose(),this._texture=null)}},{key:"dispose",value:function(){this._texture&&(this.releaseInternalTexture(),this._engine=null)}}]),e}());Se.DEFAULT_ANISOTROPIC_FILTERING_LEVEL=4,(0,C.gn)([(0,P.qC)()],Se.prototype,"uniqueId",void 0),(0,C.gn)([(0,P.qC)()],Se.prototype,"name",void 0),(0,C.gn)([(0,P.qC)()],Se.prototype,"metadata",void 0),(0,C.gn)([(0,P.qC)("hasAlpha")],Se.prototype,"_hasAlpha",void 0),(0,C.gn)([(0,P.qC)("getAlphaFromRGB")],Se.prototype,"_getAlphaFromRGB",void 0),(0,C.gn)([(0,P.qC)()],Se.prototype,"level",void 0),(0,C.gn)([(0,P.qC)("coordinatesIndex")],Se.prototype,"_coordinatesIndex",void 0),(0,C.gn)([(0,P.qC)()],Se.prototype,"optimizeUVAllocation",void 0),(0,C.gn)([(0,P.qC)("coordinatesMode")],Se.prototype,"_coordinatesMode",void 0),(0,C.gn)([(0,P.qC)()],Se.prototype,"wrapU",null),(0,C.gn)([(0,P.qC)()],Se.prototype,"wrapV",null),(0,C.gn)([(0,P.qC)()],Se.prototype,"wrapR",void 0),(0,C.gn)([(0,P.qC)()],Se.prototype,"anisotropicFilteringLevel",void 0),(0,C.gn)([(0,P.qC)()],Se.prototype,"isCube",null),(0,C.gn)([(0,P.qC)()],Se.prototype,"is3D",null),(0,C.gn)([(0,P.qC)()],Se.prototype,"is2DArray",null),(0,C.gn)([(0,P.qC)()],Se.prototype,"gammaSpace",null),(0,C.gn)([(0,P.qC)()],Se.prototype,"invertZ",void 0),(0,C.gn)([(0,P.qC)()],Se.prototype,"lodLevelInAlpha",void 0),(0,C.gn)([(0,P.qC)()],Se.prototype,"lodGenerationOffset",null),(0,C.gn)([(0,P.qC)()],Se.prototype,"lodGenerationScale",null),(0,C.gn)([(0,P.qC)()],Se.prototype,"linearSpecularLOD",null),(0,C.gn)([(0,P.oU)()],Se.prototype,"irradianceTexture",null),(0,C.gn)([(0,P.qC)()],Se.prototype,"isRenderTarget",void 0);var Ie=n(5230),xe=n(8370),Ce=n(8797),Pe=n(2399),De=n(531),Re=n(4687),ke=n.n(Re);function Oe(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=t.width,r=t.height;if(e instanceof Float32Array){for(var a=e.byteLength/e.BYTES_PER_ELEMENT,o=new Uint8Array(a);--a>=0;){var s=e[a];s<0?s=0:s>1&&(s=1),o[a]=255*s}e=o}var u=document.createElement("canvas");u.width=i,u.height=r;var l=u.getContext("2d");if(!l)return null;var c=l.createImageData(i,r),h=c.data;if(h.set(e),l.putImageData(c,0,0),n){var f=document.createElement("canvas");f.width=i,f.height=r;var d=f.getContext("2d");return d?(d.translate(0,r),d.scale(1,-1),d.drawImage(u,0,0),f.toDataURL("image/png")):null}return u.toDataURL("image/png")}function Ne(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=e.getInternalTexture();if(!i)return null;var r=e._readPixelsSync(t,n);return r?Oe(r,e.getSize(),i.invertY):null}function we(e){return Le.apply(this,arguments)}function Le(){return Le=(0,De.Z)(ke().mark((function e(t){var n,i,r,a,o=arguments;return ke().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=o.length>1&&void 0!==o[1]?o[1]:0,i=o.length>2&&void 0!==o[2]?o[2]:0,r=t.getInternalTexture()){e.next=5;break}return e.abrupt("return",null);case 5:return e.next=7,t.readPixels(n,i);case 7:if(a=e.sent){e.next=10;break}return e.abrupt("return",null);case 10:return e.abrupt("return",Oe(a,t.getSize(),r.invertY));case 11:case"end":return e.stop()}}),e)}))),Le.apply(this,arguments)}function Fe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,x.Z)(e);if(t){var r=(0,x.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,I.Z)(this,n)}}var Be=function(e){(0,S.Z)(n,e);var t=Fe(n);function n(e,i,r,a){var o,s,l,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:n.TRILINEAR_SAMPLINGMODE,h=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,f=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,d=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,p=arguments.length>8&&void 0!==arguments[8]&&arguments[8],v=arguments.length>9?arguments[9]:void 0,m=arguments.length>10?arguments[10]:void 0,g=arguments.length>11?arguments[11]:void 0,_=arguments.length>12?arguments[12]:void 0,y=arguments.length>13?arguments[13]:void 0;(0,E.Z)(this,n),(s=t.call(this,i)).url=null,s.uOffset=0,s.vOffset=0,s.uScale=1,s.vScale=1,s.uAng=0,s.vAng=0,s.wAng=0,s.uRotationCenter=.5,s.vRotationCenter=.5,s.wRotationCenter=.5,s.homogeneousRotationInUVTransform=!1,s.inspectableCustomProperties=null,s._noMipmap=!1,s._invertY=!1,s._rowGenerationMatrix=null,s._cachedTextureMatrix=null,s._projectionModeMatrix=null,s._t0=null,s._t1=null,s._t2=null,s._cachedUOffset=-1,s._cachedVOffset=-1,s._cachedUScale=0,s._cachedVScale=0,s._cachedUAng=-1,s._cachedVAng=-1,s._cachedWAng=-1,s._cachedProjectionMatrixId=-1,s._cachedURotationCenter=-1,s._cachedVRotationCenter=-1,s._cachedWRotationCenter=-1,s._cachedHomogeneousRotationInUVTransform=!1,s._cachedCoordinatesMode=-1,s._buffer=null,s._deleteBuffer=!1,s._format=null,s._delayedOnLoad=null,s._delayedOnError=null,s.onLoadObservable=new D.y$,s._isBlocking=!0,s.name=e||"",s.url=e;var A,b,M,S,x,C,P,R,k,O=!1,N=null;"object"==typeof r&&null!==r?(l=null!==(A=r.noMipmap)&&void 0!==A&&A,a=null!==(b=r.invertY)&&void 0!==b?b:!u.e.UseOpenGLOrientationForUV,c=null!==(M=r.samplingMode)&&void 0!==M?M:n.TRILINEAR_SAMPLINGMODE,h=null!==(S=r.onLoad)&&void 0!==S?S:null,f=null!==(x=r.onError)&&void 0!==x?x:null,d=null!==(C=r.buffer)&&void 0!==C?C:null,p=null!==(P=r.deleteBuffer)&&void 0!==P&&P,v=r.format,m=r.mimeType,g=r.loaderOptions,_=r.creationFlags,O=null!==(R=r.useSRGBBuffer)&&void 0!==R&&R,N=null!==(k=r.internalTexture)&&void 0!==k?k:null):l=!!r;s._noMipmap=l,s._invertY=void 0===a?!u.e.UseOpenGLOrientationForUV:a,s._initialSamplingMode=c,s._buffer=d,s._deleteBuffer=p,s._mimeType=m,s._loaderOptions=g,s._creationFlags=_,s._useSRGBBuffer=O,s._forcedExtension=y,v&&(s._format=v);var w=s.getScene(),L=s._getEngine();if(!L)return(0,I.Z)(s);L.onBeforeTextureInitObservable.notifyObservers((0,T.Z)(s));var F=function(){s._texture&&(s._texture._invertVScale&&(s.vScale*=-1,s.vOffset+=1),null!==s._texture._cachedWrapU&&(s.wrapU=s._texture._cachedWrapU,s._texture._cachedWrapU=null),null!==s._texture._cachedWrapV&&(s.wrapV=s._texture._cachedWrapV,s._texture._cachedWrapV=null),null!==s._texture._cachedWrapR&&(s.wrapR=s._texture._cachedWrapR,s._texture._cachedWrapR=null)),s.onLoadObservable.hasObservers()&&s.onLoadObservable.notifyObservers((0,T.Z)(s)),h&&h(),!s.isBlocking&&w&&w.resetCachedMaterial()},B=function(e,t){s._loadingError=!0,s._errorObject={message:e,exception:t},f&&f(e,t),n.OnTextureLoadErrorObservable.notifyObservers((0,T.Z)(s))};if(!s.url)return s._delayedOnLoad=F,s._delayedOnError=B,(0,I.Z)(s);if(s._texture=null!==(o=N)&&void 0!==o?o:s._getFromCache(s.url,l,c,s._invertY,O),s._texture)if(s._texture.isReady)xe.Q.SetImmediate((function(){return F()}));else{var U=s._texture.onLoadedObservable.add(F);s._texture.onErrorObservable.add((function(e){var t;B(e.message,e.exception),null===(t=s._texture)||void 0===t||t.onLoadedObservable.remove(U)}))}else if(w&&w.useDelayedTextureLoading)s.delayLoadState=4,s._delayedOnLoad=F,s._delayedOnError=B;else{try{s._texture=L.createTexture(s.url,l,s._invertY,w,c,F,B,s._buffer,void 0,s._format,s._forcedExtension,m,g,_,O)}catch(V){throw B("error loading",V),V}p&&(s._buffer=null)}return s}return(0,A.Z)(n,[{key:"noMipmap",get:function(){return this._noMipmap}},{key:"mimeType",get:function(){return this._mimeType}},{key:"isBlocking",get:function(){return this._isBlocking},set:function(e){this._isBlocking=e}},{key:"invertY",get:function(){return this._invertY}},{key:"updateURL",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;this.url&&(this.releaseInternalTexture(),this.getScene().markAllMaterialsAsDirty(1)),this.name&&!this.name.startsWith("data:")||(this.name=e),this.url=e,this._buffer=t,this._forcedExtension=i,this.delayLoadState=4,n&&(this._delayedOnLoad=n),this.delayLoad()}},{key:"delayLoad",value:function(){if(4===this.delayLoadState){var e=this.getScene();e&&(this.delayLoadState=1,this._texture=this._getFromCache(this.url,this._noMipmap,this.samplingMode,this._invertY,this._useSRGBBuffer),this._texture?this._delayedOnLoad&&(this._texture.isReady?xe.Q.SetImmediate(this._delayedOnLoad):this._texture.onLoadedObservable.add(this._delayedOnLoad)):(this._texture=e.getEngine().createTexture(this.url,this._noMipmap,this._invertY,e,this.samplingMode,this._delayedOnLoad,this._delayedOnError,this._buffer,null,this._format,this._forcedExtension,this._mimeType,this._loaderOptions,this._creationFlags,this._useSRGBBuffer),this._deleteBuffer&&(this._buffer=null)),this._delayedOnLoad=null,this._delayedOnError=null)}}},{key:"_prepareRowForTextureGeneration",value:function(e,t,n,i){e*=this._cachedUScale,t*=this._cachedVScale,e-=this.uRotationCenter*this._cachedUScale,t-=this.vRotationCenter*this._cachedVScale,n-=this.wRotationCenter,h.P.TransformCoordinatesFromFloatsToRef(e,t,n,this._rowGenerationMatrix,i),i.x+=this.uRotationCenter*this._cachedUScale+this._cachedUOffset,i.y+=this.vRotationCenter*this._cachedVScale+this._cachedVOffset,i.z+=this.wRotationCenter}},{key:"checkTransformsAreIdentical",value:function(e){return null!==e&&this.uOffset===e.uOffset&&this.vOffset===e.vOffset&&this.uScale===e.uScale&&this.vScale===e.vScale&&this.uAng===e.uAng&&this.vAng===e.vAng&&this.wAng===e.wAng}},{key:"getTextureMatrix",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;if(this.uOffset===this._cachedUOffset&&this.vOffset===this._cachedVOffset&&this.uScale*t===this._cachedUScale&&this.vScale===this._cachedVScale&&this.uAng===this._cachedUAng&&this.vAng===this._cachedVAng&&this.wAng===this._cachedWAng&&this.uRotationCenter===this._cachedURotationCenter&&this.vRotationCenter===this._cachedVRotationCenter&&this.wRotationCenter===this._cachedWRotationCenter&&this.homogeneousRotationInUVTransform===this._cachedHomogeneousRotationInUVTransform)return this._cachedTextureMatrix;this._cachedUOffset=this.uOffset,this._cachedVOffset=this.vOffset,this._cachedUScale=this.uScale*t,this._cachedVScale=this.vScale,this._cachedUAng=this.uAng,this._cachedVAng=this.vAng,this._cachedWAng=this.wAng,this._cachedURotationCenter=this.uRotationCenter,this._cachedVRotationCenter=this.vRotationCenter,this._cachedWRotationCenter=this.wRotationCenter,this._cachedHomogeneousRotationInUVTransform=this.homogeneousRotationInUVTransform,this._cachedTextureMatrix&&this._rowGenerationMatrix||(this._cachedTextureMatrix=h.y3.Zero(),this._rowGenerationMatrix=new h.y3,this._t0=h.P.Zero(),this._t1=h.P.Zero(),this._t2=h.P.Zero()),h.y3.RotationYawPitchRollToRef(this.vAng,this.uAng,this.wAng,this._rowGenerationMatrix),this.homogeneousRotationInUVTransform?(h.y3.TranslationToRef(-this._cachedURotationCenter,-this._cachedVRotationCenter,-this._cachedWRotationCenter,h.jp.Matrix[0]),h.y3.TranslationToRef(this._cachedURotationCenter,this._cachedVRotationCenter,this._cachedWRotationCenter,h.jp.Matrix[1]),h.y3.ScalingToRef(this._cachedUScale,this._cachedVScale,0,h.jp.Matrix[2]),h.y3.TranslationToRef(this._cachedUOffset,this._cachedVOffset,0,h.jp.Matrix[3]),h.jp.Matrix[0].multiplyToRef(this._rowGenerationMatrix,this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(h.jp.Matrix[1],this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(h.jp.Matrix[2],this._cachedTextureMatrix),this._cachedTextureMatrix.multiplyToRef(h.jp.Matrix[3],this._cachedTextureMatrix),this._cachedTextureMatrix.setRowFromFloats(2,this._cachedTextureMatrix.m[12],this._cachedTextureMatrix.m[13],this._cachedTextureMatrix.m[14],1)):(this._prepareRowForTextureGeneration(0,0,0,this._t0),this._prepareRowForTextureGeneration(1,0,0,this._t1),this._prepareRowForTextureGeneration(0,1,0,this._t2),this._t1.subtractInPlace(this._t0),this._t2.subtractInPlace(this._t0),h.y3.FromValuesToRef(this._t1.x,this._t1.y,this._t1.z,0,this._t2.x,this._t2.y,this._t2.z,0,this._t0.x,this._t0.y,this._t0.z,0,0,0,0,1,this._cachedTextureMatrix));var n=this.getScene();return n?(this.optimizeUVAllocation&&n.markAllMaterialsAsDirty(1,(function(t){return t.hasTexture(e)})),this._cachedTextureMatrix):this._cachedTextureMatrix}},{key:"getReflectionTextureMatrix",value:function(){var e=this,t=this.getScene();if(!t)return this._cachedTextureMatrix;if(this.uOffset===this._cachedUOffset&&this.vOffset===this._cachedVOffset&&this.uScale===this._cachedUScale&&this.vScale===this._cachedVScale&&this.coordinatesMode===this._cachedCoordinatesMode){if(this.coordinatesMode!==n.PROJECTION_MODE)return this._cachedTextureMatrix;if(this._cachedProjectionMatrixId===t.getProjectionMatrix().updateFlag)return this._cachedTextureMatrix}this._cachedTextureMatrix||(this._cachedTextureMatrix=h.y3.Zero()),this._projectionModeMatrix||(this._projectionModeMatrix=h.y3.Zero());var i=this._cachedCoordinatesMode!==this.coordinatesMode;switch(this._cachedUOffset=this.uOffset,this._cachedVOffset=this.vOffset,this._cachedUScale=this.uScale,this._cachedVScale=this.vScale,this._cachedCoordinatesMode=this.coordinatesMode,this.coordinatesMode){case n.PLANAR_MODE:h.y3.IdentityToRef(this._cachedTextureMatrix),this._cachedTextureMatrix[0]=this.uScale,this._cachedTextureMatrix[5]=this.vScale,this._cachedTextureMatrix[12]=this.uOffset,this._cachedTextureMatrix[13]=this.vOffset;break;case n.PROJECTION_MODE:h.y3.FromValuesToRef(.5,0,0,0,0,-.5,0,0,0,0,0,0,.5,.5,1,1,this._projectionModeMatrix);var r=t.getProjectionMatrix();this._cachedProjectionMatrixId=r.updateFlag,r.multiplyToRef(this._projectionModeMatrix,this._cachedTextureMatrix);break;default:h.y3.IdentityToRef(this._cachedTextureMatrix)}return i&&t.markAllMaterialsAsDirty(1,(function(t){return-1!==t.getActiveTextures().indexOf(e)})),this._cachedTextureMatrix}},{key:"clone",value:function(){var e=this,t={noMipmap:this._noMipmap,invertY:this._invertY,samplingMode:this.samplingMode,onLoad:void 0,onError:void 0,buffer:this._texture?this._texture._buffer:void 0,deleteBuffer:this._deleteBuffer,format:this.textureFormat,mimeType:this.mimeType,loaderOptions:this._loaderOptions,creationFlags:this._creationFlags,useSRGBBuffer:this._useSRGBBuffer};return P.p4.Clone((function(){return new n(e._texture?e._texture.url:null,e.getScene(),t)}),this)}},{key:"serialize",value:function(){var e=this.name;n.SerializeBuffers||this.name.startsWith("data:")&&(this.name=""),this.name.startsWith("data:")&&this.url===this.name&&(this.url="");var t=(0,M.Z)((0,x.Z)(n.prototype),"serialize",this).call(this);return t?((n.SerializeBuffers||n.ForceSerializeBuffers)&&("string"==typeof this._buffer&&"data:"===this._buffer.substr(0,5)?(t.base64String=this._buffer,t.name=t.name.replace("data:","")):this.url&&this.url.startsWith("data:")&&this._buffer instanceof Uint8Array?t.base64String="data:image/png;base64,"+(0,Pe.Gh)(this._buffer):(n.ForceSerializeBuffers||this.url&&this.url.startsWith("blob:")||this._forceSerialize)&&(t.base64String=!this._engine||this._engine._features.supportSyncTextureRead?Ne(this):we(this))),t.invertY=this._invertY,t.samplingMode=this.samplingMode,t._creationFlags=this._creationFlags,t._useSRGBBuffer=this._useSRGBBuffer,this.name=e,t):null}},{key:"getClassName",value:function(){return"Texture"}},{key:"dispose",value:function(){(0,M.Z)((0,x.Z)(n.prototype),"dispose",this).call(this),this.onLoadObservable.clear(),this._delayedOnLoad=null,this._delayedOnError=null}}],[{key:"Parse",value:function(e,t,i){if(e.customType){var r=Ce.K.Instantiate(e.customType).Parse(e,t,i);return e.samplingMode&&r.updateSamplingMode&&r._samplingMode&&r._samplingMode!==e.samplingMode&&r.updateSamplingMode(e.samplingMode),r}if(e.isCube&&!e.isRenderTarget)return n._CubeTextureParser(e,t,i);if(!e.name&&!e.isRenderTarget)return null;var a=function(t){if(t&&t._texture&&(t._texture._cachedWrapU=null,t._texture._cachedWrapV=null,t._texture._cachedWrapR=null),e.samplingMode){var n=e.samplingMode;t&&t.samplingMode!==n&&t.updateSamplingMode(n)}if(t&&e.animations)for(var i=0;i<e.animations.length;i++){var r=e.animations[i],a=(0,V.q)("BABYLON.Animation");a&&t.animations.push(a.Parse(r))}};return P.p4.Parse((function(){var r,o,s,u,l=!0;if(e.noMipmap&&(l=!1),e.mirrorPlane){var c=n._CreateMirror(e.name,e.renderTargetSize,t,l);return c._waitingRenderList=e.renderList,c.mirrorPlane=y.J.FromArray(e.mirrorPlane),a(c),c}if(e.isRenderTarget){var h,f=null;if(e.isCube){if(t.reflectionProbes)for(var d=0;d<t.reflectionProbes.length;d++){var p=t.reflectionProbes[d];if(p.name===e.name)return p.cubeTexture}}else(f=n._CreateRenderTargetTexture(e.name,e.renderTargetSize,t,l,null!==(h=e._creationFlags)&&void 0!==h?h:0))._waitingRenderList=e.renderList;return a(f),f}return e.base64String?(r=n.CreateFromBase64String(e.base64String,e.base64String,t,!l,e.invertY,e.samplingMode,(function(){a(r)}),null!==(o=e._creationFlags)&&void 0!==o?o:0,null!==(s=e._useSRGBBuffer)&&void 0!==s&&s)).name=e.name:(u=e.name&&e.name.indexOf("://")>0?e.name:i+e.name,e.url&&(e.url.startsWith("data:")||n.UseSerializedUrlIfAny)&&(u=e.url),r=new n(u,t,!l,e.invertY,e.samplingMode,(function(){a(r)}))),r}),e,t)}},{key:"CreateFromBase64String",value:function(e,t,i,r,a){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:n.TRILINEAR_SAMPLINGMODE,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:5,c=arguments.length>9?arguments[9]:void 0;return new n("data:"+t,i,r,a,o,s,u,e,!1,l,void 0,void 0,c)}},{key:"LoadFromDataString",value:function(e,t,i){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4?arguments[4]:void 0,o=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:n.TRILINEAR_SAMPLINGMODE,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:5,h=arguments.length>10?arguments[10]:void 0;return"data:"!==e.substr(0,5)&&(e="data:"+e),new n(e,i,a,o,s,u,l,t,r,c,void 0,void 0,h)}}]),n}(Se);Be.SerializeBuffers=!0,Be.ForceSerializeBuffers=!1,Be.OnTextureLoadErrorObservable=new D.y$,Be._CubeTextureParser=function(e,t,n){throw(0,Ie.S)("CubeTexture")},Be._CreateMirror=function(e,t,n,i){throw(0,Ie.S)("MirrorTexture")},Be._CreateRenderTargetTexture=function(e,t,n,i,r){throw(0,Ie.S)("RenderTargetTexture")},Be.NEAREST_SAMPLINGMODE=1,Be.NEAREST_NEAREST_MIPLINEAR=8,Be.BILINEAR_SAMPLINGMODE=2,Be.LINEAR_LINEAR_MIPNEAREST=11,Be.TRILINEAR_SAMPLINGMODE=3,Be.LINEAR_LINEAR_MIPLINEAR=3,Be.NEAREST_NEAREST_MIPNEAREST=4,Be.NEAREST_LINEAR_MIPNEAREST=5,Be.NEAREST_LINEAR_MIPLINEAR=6,Be.NEAREST_LINEAR=7,Be.NEAREST_NEAREST=1,Be.LINEAR_NEAREST_MIPNEAREST=9,Be.LINEAR_NEAREST_MIPLINEAR=10,Be.LINEAR_LINEAR=2,Be.LINEAR_NEAREST=12,Be.EXPLICIT_MODE=0,Be.SPHERICAL_MODE=1,Be.PLANAR_MODE=2,Be.CUBIC_MODE=3,Be.PROJECTION_MODE=4,Be.SKYBOX_MODE=5,Be.INVCUBIC_MODE=6,Be.EQUIRECTANGULAR_MODE=7,Be.FIXED_EQUIRECTANGULAR_MODE=8,Be.FIXED_EQUIRECTANGULAR_MIRRORED_MODE=9,Be.CLAMP_ADDRESSMODE=0,Be.WRAP_ADDRESSMODE=1,Be.MIRROR_ADDRESSMODE=2,Be.UseSerializedUrlIfAny=!1,(0,C.gn)([(0,P.qC)()],Be.prototype,"url",void 0),(0,C.gn)([(0,P.qC)()],Be.prototype,"uOffset",void 0),(0,C.gn)([(0,P.qC)()],Be.prototype,"vOffset",void 0),(0,C.gn)([(0,P.qC)()],Be.prototype,"uScale",void 0),(0,C.gn)([(0,P.qC)()],Be.prototype,"vScale",void 0),(0,C.gn)([(0,P.qC)()],Be.prototype,"uAng",void 0),(0,C.gn)([(0,P.qC)()],Be.prototype,"vAng",void 0),(0,C.gn)([(0,P.qC)()],Be.prototype,"wAng",void 0),(0,C.gn)([(0,P.qC)()],Be.prototype,"uRotationCenter",void 0),(0,C.gn)([(0,P.qC)()],Be.prototype,"vRotationCenter",void 0),(0,C.gn)([(0,P.qC)()],Be.prototype,"wRotationCenter",void 0),(0,C.gn)([(0,P.qC)()],Be.prototype,"homogeneousRotationInUVTransform",void 0),(0,C.gn)([(0,P.qC)()],Be.prototype,"isBlocking",null),(0,V.H)("BABYLON.Texture",Be),P.p4._TextureParser=Be.Parse;var Ue=function(){function e(){(0,E.Z)(this,e)}return(0,A.Z)(e,null,[{key:"DiffuseTextureEnabled",get:function(){return this._DiffuseTextureEnabled},set:function(e){this._DiffuseTextureEnabled!==e&&(this._DiffuseTextureEnabled=e,r.D.MarkAllMaterialsAsDirty(1))}},{key:"DetailTextureEnabled",get:function(){return this._DetailTextureEnabled},set:function(e){this._DetailTextureEnabled!==e&&(this._DetailTextureEnabled=e,r.D.MarkAllMaterialsAsDirty(1))}},{key:"AmbientTextureEnabled",get:function(){return this._AmbientTextureEnabled},set:function(e){this._AmbientTextureEnabled!==e&&(this._AmbientTextureEnabled=e,r.D.MarkAllMaterialsAsDirty(1))}},{key:"OpacityTextureEnabled",get:function(){return this._OpacityTextureEnabled},set:function(e){this._OpacityTextureEnabled!==e&&(this._OpacityTextureEnabled=e,r.D.MarkAllMaterialsAsDirty(1))}},{key:"ReflectionTextureEnabled",get:function(){return this._ReflectionTextureEnabled},set:function(e){this._ReflectionTextureEnabled!==e&&(this._ReflectionTextureEnabled=e,r.D.MarkAllMaterialsAsDirty(1))}},{key:"EmissiveTextureEnabled",get:function(){return this._EmissiveTextureEnabled},set:function(e){this._EmissiveTextureEnabled!==e&&(this._EmissiveTextureEnabled=e,r.D.MarkAllMaterialsAsDirty(1))}},{key:"SpecularTextureEnabled",get:function(){return this._SpecularTextureEnabled},set:function(e){this._SpecularTextureEnabled!==e&&(this._SpecularTextureEnabled=e,r.D.MarkAllMaterialsAsDirty(1))}},{key:"BumpTextureEnabled",get:function(){return this._BumpTextureEnabled},set:function(e){this._BumpTextureEnabled!==e&&(this._BumpTextureEnabled=e,r.D.MarkAllMaterialsAsDirty(1))}},{key:"LightmapTextureEnabled",get:function(){return this._LightmapTextureEnabled},set:function(e){this._LightmapTextureEnabled!==e&&(this._LightmapTextureEnabled=e,r.D.MarkAllMaterialsAsDirty(1))}},{key:"RefractionTextureEnabled",get:function(){return this._RefractionTextureEnabled},set:function(e){this._RefractionTextureEnabled!==e&&(this._RefractionTextureEnabled=e,r.D.MarkAllMaterialsAsDirty(1))}},{key:"ColorGradingTextureEnabled",get:function(){return this._ColorGradingTextureEnabled},set:function(e){this._ColorGradingTextureEnabled!==e&&(this._ColorGradingTextureEnabled=e,r.D.MarkAllMaterialsAsDirty(1))}},{key:"FresnelEnabled",get:function(){return this._FresnelEnabled},set:function(e){this._FresnelEnabled!==e&&(this._FresnelEnabled=e,r.D.MarkAllMaterialsAsDirty(4))}},{key:"ClearCoatTextureEnabled",get:function(){return this._ClearCoatTextureEnabled},set:function(e){this._ClearCoatTextureEnabled!==e&&(this._ClearCoatTextureEnabled=e,r.D.MarkAllMaterialsAsDirty(1))}},{key:"ClearCoatBumpTextureEnabled",get:function(){return this._ClearCoatBumpTextureEnabled},set:function(e){this._ClearCoatBumpTextureEnabled!==e&&(this._ClearCoatBumpTextureEnabled=e,r.D.MarkAllMaterialsAsDirty(1))}},{key:"ClearCoatTintTextureEnabled",get:function(){return this._ClearCoatTintTextureEnabled},set:function(e){this._ClearCoatTintTextureEnabled!==e&&(this._ClearCoatTintTextureEnabled=e,r.D.MarkAllMaterialsAsDirty(1))}},{key:"SheenTextureEnabled",get:function(){return this._SheenTextureEnabled},set:function(e){this._SheenTextureEnabled!==e&&(this._SheenTextureEnabled=e,r.D.MarkAllMaterialsAsDirty(1))}},{key:"AnisotropicTextureEnabled",get:function(){return this._AnisotropicTextureEnabled},set:function(e){this._AnisotropicTextureEnabled!==e&&(this._AnisotropicTextureEnabled=e,r.D.MarkAllMaterialsAsDirty(1))}},{key:"ThicknessTextureEnabled",get:function(){return this._ThicknessTextureEnabled},set:function(e){this._ThicknessTextureEnabled!==e&&(this._ThicknessTextureEnabled=e,r.D.MarkAllMaterialsAsDirty(1))}},{key:"RefractionIntensityTextureEnabled",get:function(){return this._ThicknessTextureEnabled},set:function(e){this._RefractionIntensityTextureEnabled!==e&&(this._RefractionIntensityTextureEnabled=e,r.D.MarkAllMaterialsAsDirty(1))}},{key:"TranslucencyIntensityTextureEnabled",get:function(){return this._ThicknessTextureEnabled},set:function(e){this._TranslucencyIntensityTextureEnabled!==e&&(this._TranslucencyIntensityTextureEnabled=e,r.D.MarkAllMaterialsAsDirty(1))}},{key:"IridescenceTextureEnabled",get:function(){return this._IridescenceTextureEnabled},set:function(e){this._IridescenceTextureEnabled!==e&&(this._IridescenceTextureEnabled=e,r.D.MarkAllMaterialsAsDirty(1))}}]),e}();Ue._DiffuseTextureEnabled=!0,Ue._DetailTextureEnabled=!0,Ue._AmbientTextureEnabled=!0,Ue._OpacityTextureEnabled=!0,Ue._ReflectionTextureEnabled=!0,Ue._EmissiveTextureEnabled=!0,Ue._SpecularTextureEnabled=!0,Ue._BumpTextureEnabled=!0,Ue._LightmapTextureEnabled=!0,Ue._RefractionTextureEnabled=!0,Ue._ColorGradingTextureEnabled=!0,Ue._FresnelEnabled=!0,Ue._ClearCoatTextureEnabled=!0,Ue._ClearCoatBumpTextureEnabled=!0,Ue._ClearCoatTintTextureEnabled=!0,Ue._SheenTextureEnabled=!0,Ue._AnisotropicTextureEnabled=!0,Ue._ThicknessTextureEnabled=!0,Ue._RefractionIntensityTextureEnabled=!0,Ue._TranslucencyIntensityTextureEnabled=!0,Ue._IridescenceTextureEnabled=!0;var Ve=n(8084),Ge="uniform vec4 vEyePosition;\nuniform vec4 vDiffuseColor;\n#ifdef SPECULARTERM\nuniform vec4 vSpecularColor;\n#endif\nuniform vec3 vEmissiveColor;\nuniform vec3 vAmbientColor;\nuniform float visibility;\n#ifdef DIFFUSE\nuniform vec2 vDiffuseInfos;\n#endif\n#ifdef AMBIENT\nuniform vec2 vAmbientInfos;\n#endif\n#ifdef OPACITY \nuniform vec2 vOpacityInfos;\n#endif\n#ifdef EMISSIVE\nuniform vec2 vEmissiveInfos;\n#endif\n#ifdef LIGHTMAP\nuniform vec2 vLightmapInfos;\n#endif\n#ifdef BUMP\nuniform vec3 vBumpInfos;\nuniform vec2 vTangentSpaceParams;\n#endif\n#ifdef ALPHATEST\nuniform float alphaCutOff;\n#endif\n#if defined(REFLECTIONMAP_SPHERICAL) || defined(REFLECTIONMAP_PROJECTION) || defined(REFRACTION) || defined(PREPASS)\nuniform mat4 view;\n#endif\n#ifdef REFRACTION\nuniform vec4 vRefractionInfos;\n#ifndef REFRACTIONMAP_3D\nuniform mat4 refractionMatrix;\n#endif\n#ifdef REFRACTIONFRESNEL\nuniform vec4 refractionLeftColor;\nuniform vec4 refractionRightColor;\n#endif\n#if defined(USE_LOCAL_REFRACTIONMAP_CUBIC) && defined(REFRACTIONMAP_3D)\nuniform vec3 vRefractionPosition;\nuniform vec3 vRefractionSize; \n#endif\n#endif\n#if defined(SPECULAR) && defined(SPECULARTERM)\nuniform vec2 vSpecularInfos;\n#endif\n#ifdef DIFFUSEFRESNEL\nuniform vec4 diffuseLeftColor;\nuniform vec4 diffuseRightColor;\n#endif\n#ifdef OPACITYFRESNEL\nuniform vec4 opacityParts;\n#endif\n#ifdef EMISSIVEFRESNEL\nuniform vec4 emissiveLeftColor;\nuniform vec4 emissiveRightColor;\n#endif\n#ifdef REFLECTION\nuniform vec2 vReflectionInfos;\n#if defined(REFLECTIONMAP_PLANAR) || defined(REFLECTIONMAP_CUBIC) || defined(REFLECTIONMAP_PROJECTION) || defined(REFLECTIONMAP_EQUIRECTANGULAR) || defined(REFLECTIONMAP_SPHERICAL) || defined(REFLECTIONMAP_SKYBOX)\nuniform mat4 reflectionMatrix;\n#endif\n#ifndef REFLECTIONMAP_SKYBOX\n#if defined(USE_LOCAL_REFLECTIONMAP_CUBIC) && defined(REFLECTIONMAP_CUBIC)\nuniform vec3 vReflectionPosition;\nuniform vec3 vReflectionSize; \n#endif\n#endif\n#ifdef REFLECTIONFRESNEL\nuniform vec4 reflectionLeftColor;\nuniform vec4 reflectionRightColor;\n#endif\n#endif\n#ifdef DETAIL\nuniform vec4 vDetailInfos;\n#endif\n#define ADDITIONAL_FRAGMENT_DECLARATION\n";Ve.v.IncludesShadersStore.defaultFragmentDeclaration=Ge;var ze="layout(std140,column_major) uniform;\nuniform Scene {\nmat4 viewProjection;\n#ifdef MULTIVIEW\nmat4 viewProjectionR;\n#endif \nmat4 view;\nmat4 projection;\nvec4 vEyePosition;\n};\n";Ve.v.IncludesShadersStore.sceneUboDeclaration=ze;var We="#ifdef WEBGL2\nuniform mat4 world;\nuniform float visibility;\n#else\nlayout(std140,column_major) uniform;\nuniform Mesh\n{\nmat4 world;\nfloat visibility;\n};\n#endif\n#define WORLD_UBO\n";Ve.v.IncludesShadersStore.meshUboDeclaration=We;var He="layout(std140,column_major) uniform;\nuniform Material\n{\nvec4 diffuseLeftColor;\nvec4 diffuseRightColor;\nvec4 opacityParts;\nvec4 reflectionLeftColor;\nvec4 reflectionRightColor;\nvec4 refractionLeftColor;\nvec4 refractionRightColor;\nvec4 emissiveLeftColor;\nvec4 emissiveRightColor;\nvec2 vDiffuseInfos;\nvec2 vAmbientInfos;\nvec2 vOpacityInfos;\nvec2 vReflectionInfos;\nvec3 vReflectionPosition;\nvec3 vReflectionSize;\nvec2 vEmissiveInfos;\nvec2 vLightmapInfos;\nvec2 vSpecularInfos;\nvec3 vBumpInfos;\nmat4 diffuseMatrix;\nmat4 ambientMatrix;\nmat4 opacityMatrix;\nmat4 reflectionMatrix;\nmat4 emissiveMatrix;\nmat4 lightmapMatrix;\nmat4 specularMatrix;\nmat4 bumpMatrix;\nvec2 vTangentSpaceParams;\nfloat pointSize;\nfloat alphaCutOff;\nmat4 refractionMatrix;\nvec4 vRefractionInfos;\nvec3 vRefractionPosition;\nvec3 vRefractionSize;\nvec4 vSpecularColor;\nvec3 vEmissiveColor;\nvec4 vDiffuseColor;\nvec3 vAmbientColor;\n#define ADDITIONAL_UBO_DECLARATION\n};\n#include<sceneUboDeclaration>\n#include<meshUboDeclaration>\n";Ve.v.IncludesShadersStore.defaultUboDeclaration=He;var Xe="#ifdef PREPASS\n#extension GL_EXT_draw_buffers : require\nlayout(location=0) out highp vec4 glFragData[{X}];highp vec4 gl_FragColor;\n#ifdef PREPASS_DEPTH\nvarying highp vec3 vViewPos;\n#endif\n#ifdef PREPASS_VELOCITY\nvarying highp vec4 vCurrentPosition;varying highp vec4 vPreviousPosition;\n#endif\n#endif\n";Ve.v.IncludesShadersStore.prePassDeclaration=Xe;var je="#ifdef ORDER_INDEPENDENT_TRANSPARENCY\n#extension GL_EXT_draw_buffers : require\nlayout(location=0) out vec2 depth; \nlayout(location=1) out vec4 frontColor;\nlayout(location=2) out vec4 backColor;\n#define MAX_DEPTH 99999.0\nhighp vec4 gl_FragColor;\nuniform sampler2D oitDepthSampler;\nuniform sampler2D oitFrontColorSampler;\n#endif\n";Ve.v.IncludesShadersStore.oitDeclaration=je;var Ye="#ifdef MAINUV{X}\nvarying vec2 vMainUV{X};\n#endif\n";Ve.v.IncludesShadersStore.mainUVVaryingDeclaration=Ye;var Ze="const float PI=3.1415926535897932384626433832795;\nconst float HALF_MIN=5.96046448e-08; \nconst float LinearEncodePowerApprox=2.2;\nconst float GammaEncodePowerApprox=1.0/LinearEncodePowerApprox;\nconst vec3 LuminanceEncodeApprox=vec3(0.2126,0.7152,0.0722);\nconst float Epsilon=0.0000001;\n#define saturate(x) clamp(x,0.0,1.0)\n#define absEps(x) abs(x)+Epsilon\n#define maxEps(x) max(x,Epsilon)\n#define saturateEps(x) clamp(x,Epsilon,1.0)\nmat3 transposeMat3(mat3 inMatrix) {\nvec3 i0=inMatrix[0];\nvec3 i1=inMatrix[1];\nvec3 i2=inMatrix[2];\nmat3 outMatrix=mat3(\nvec3(i0.x,i1.x,i2.x),\nvec3(i0.y,i1.y,i2.y),\nvec3(i0.z,i1.z,i2.z)\n);\nreturn outMatrix;\n}\nmat3 inverseMat3(mat3 inMatrix) {\nfloat a00=inMatrix[0][0],a01=inMatrix[0][1],a02=inMatrix[0][2];\nfloat a10=inMatrix[1][0],a11=inMatrix[1][1],a12=inMatrix[1][2];\nfloat a20=inMatrix[2][0],a21=inMatrix[2][1],a22=inMatrix[2][2];\nfloat b01=a22*a11-a12*a21;\nfloat b11=-a22*a10+a12*a20;\nfloat b21=a21*a10-a11*a20;\nfloat det=a00*b01+a01*b11+a02*b21;\nreturn mat3(b01,(-a22*a01+a02*a21),(a12*a01-a02*a11),\nb11,(a22*a00-a02*a20),(-a12*a00+a02*a10),\nb21,(-a21*a00+a01*a20),(a11*a00-a01*a10))/det;\n}\n#if USE_EXACT_SRGB_CONVERSIONS\nvec3 toLinearSpaceExact(vec3 color)\n{\nvec3 nearZeroSection=0.0773993808*color;\nvec3 remainingSection=pow(0.947867299*(color+vec3(0.055)),vec3(2.4));\n#if defined(WEBGL2) || defined(WEBGPU)\nreturn mix(remainingSection,nearZeroSection,lessThanEqual(color,vec3(0.04045)));\n#else\nreturn\nvec3(\ncolor.r<=0.04045 ? nearZeroSection.r : remainingSection.r,\ncolor.g<=0.04045 ? nearZeroSection.g : remainingSection.g,\ncolor.b<=0.04045 ? nearZeroSection.b : remainingSection.b);\n#endif\n}\nvec3 toGammaSpaceExact(vec3 color)\n{\nvec3 nearZeroSection=12.92*color;\nvec3 remainingSection=1.055*pow(color,vec3(0.41666))-vec3(0.055);\n#if defined(WEBGL2) || defined(WEBGPU)\nreturn mix(remainingSection,nearZeroSection,lessThanEqual(color,vec3(0.0031308)));\n#else\nreturn\nvec3(\ncolor.r<=0.0031308 ? nearZeroSection.r : remainingSection.r,\ncolor.g<=0.0031308 ? nearZeroSection.g : remainingSection.g,\ncolor.b<=0.0031308 ? nearZeroSection.b : remainingSection.b);\n#endif\n}\n#endif\nfloat toLinearSpace(float color)\n{\n#if USE_EXACT_SRGB_CONVERSIONS\nfloat nearZeroSection=0.0773993808*color;\nfloat remainingSection=pow(0.947867299*(color+0.055),2.4);\nreturn color<=0.04045 ? nearZeroSection : remainingSection;\n#else\nreturn pow(color,LinearEncodePowerApprox);\n#endif\n}\nvec3 toLinearSpace(vec3 color)\n{\n#if USE_EXACT_SRGB_CONVERSIONS\nreturn toLinearSpaceExact(color);\n#else\nreturn pow(color,vec3(LinearEncodePowerApprox));\n#endif\n}\nvec4 toLinearSpace(vec4 color)\n{\n#if USE_EXACT_SRGB_CONVERSIONS\nreturn vec4(toLinearSpaceExact(color.rgb),color.a);\n#else\nreturn vec4(pow(color.rgb,vec3(LinearEncodePowerApprox)),color.a);\n#endif\n}\nfloat toGammaSpace(float color)\n{\n#if USE_EXACT_SRGB_CONVERSIONS\nfloat nearZeroSection=12.92*color;\nfloat remainingSection=1.055*pow(color,0.41666)-0.055;\nreturn color<=0.0031308 ? nearZeroSection : remainingSection;\n#else\nreturn pow(color,GammaEncodePowerApprox);\n#endif\n}\nvec3 toGammaSpace(vec3 color)\n{\n#if USE_EXACT_SRGB_CONVERSIONS\nreturn toGammaSpaceExact(color);\n#else\nreturn pow(color,vec3(GammaEncodePowerApprox));\n#endif\n}\nvec4 toGammaSpace(vec4 color)\n{\n#if USE_EXACT_SRGB_CONVERSIONS\nreturn vec4(toGammaSpaceExact(color.rgb),color.a);\n#else\nreturn vec4(pow(color.rgb,vec3(GammaEncodePowerApprox)),color.a);\n#endif\n}\nfloat square(float value)\n{\nreturn value*value;\n}\nvec3 square(vec3 value)\n{\nreturn value*value;\n}\nfloat pow5(float value) {\nfloat sq=value*value;\nreturn sq*sq*value;\n}\nfloat getLuminance(vec3 color)\n{\nreturn clamp(dot(color,LuminanceEncodeApprox),0.,1.);\n}\nfloat getRand(vec2 seed) {\nreturn fract(sin(dot(seed.xy ,vec2(12.9898,78.233)))*43758.5453);\n}\nfloat dither(vec2 seed,float varianceAmount) {\nfloat rand=getRand(seed);\nfloat normVariance=varianceAmount/255.0;\nfloat dither=mix(-normVariance,normVariance,rand);\nreturn dither;\n}\nconst float rgbdMaxRange=255.0;\nvec4 toRGBD(vec3 color) {\nfloat maxRGB=maxEps(max(color.r,max(color.g,color.b)));\nfloat D =max(rgbdMaxRange/maxRGB,1.);\nD =clamp(floor(D)/255.0,0.,1.);\nvec3 rgb=color.rgb*D;\nrgb=toGammaSpace(rgb);\nreturn vec4(clamp(rgb,0.,1.),D); \n}\nvec3 fromRGBD(vec4 rgbd) {\nrgbd.rgb=toLinearSpace(rgbd.rgb);\nreturn rgbd.rgb/rgbd.a;\n}\nvec3 parallaxCorrectNormal( vec3 vertexPos,vec3 origVec,vec3 cubeSize,vec3 cubePos ) {\nvec3 invOrigVec=vec3(1.0,1.0,1.0)/origVec;\nvec3 halfSize=cubeSize*0.5;\nvec3 intersecAtMaxPlane=(cubePos+halfSize-vertexPos)*invOrigVec;\nvec3 intersecAtMinPlane=(cubePos-halfSize-vertexPos)*invOrigVec;\nvec3 largestIntersec=max(intersecAtMaxPlane,intersecAtMinPlane);\nfloat distance=min(min(largestIntersec.x,largestIntersec.y),largestIntersec.z);\nvec3 intersectPositionWS=vertexPos+origVec*distance;\nreturn intersectPositionWS-cubePos;\n}\n";Ve.v.IncludesShadersStore.helperFunctions=Ze;var Ke="#ifdef LIGHT{X}\nuniform vec4 vLightData{X};\nuniform vec4 vLightDiffuse{X};\n#ifdef SPECULARTERM\nuniform vec4 vLightSpecular{X};\n#else\nvec4 vLightSpecular{X}=vec4(0.);\n#endif\n#ifdef SHADOW{X}\n#ifdef SHADOWCSM{X}\nuniform mat4 lightMatrix{X}[SHADOWCSMNUM_CASCADES{X}];\nuniform float viewFrustumZ{X}[SHADOWCSMNUM_CASCADES{X}];\nuniform float frustumLengths{X}[SHADOWCSMNUM_CASCADES{X}];\nuniform float cascadeBlendFactor{X};\nvarying vec4 vPositionFromLight{X}[SHADOWCSMNUM_CASCADES{X}];\nvarying float vDepthMetric{X}[SHADOWCSMNUM_CASCADES{X}];\nvarying vec4 vPositionFromCamera{X};\n#if defined(SHADOWPCSS{X})\nuniform highp sampler2DArrayShadow shadowSampler{X};\nuniform highp sampler2DArray depthSampler{X};\nuniform vec2 lightSizeUVCorrection{X}[SHADOWCSMNUM_CASCADES{X}];\nuniform float depthCorrection{X}[SHADOWCSMNUM_CASCADES{X}];\nuniform float penumbraDarkness{X};\n#elif defined(SHADOWPCF{X})\nuniform highp sampler2DArrayShadow shadowSampler{X};\n#else\nuniform highp sampler2DArray shadowSampler{X};\n#endif\n#ifdef SHADOWCSMDEBUG{X}\nconst vec3 vCascadeColorsMultiplier{X}[8]=vec3[8]\n(\nvec3 ( 1.5,0.0,0.0 ),\nvec3 ( 0.0,1.5,0.0 ),\nvec3 ( 0.0,0.0,5.5 ),\nvec3 ( 1.5,0.0,5.5 ),\nvec3 ( 1.5,1.5,0.0 ),\nvec3 ( 1.0,1.0,1.0 ),\nvec3 ( 0.0,1.0,5.5 ),\nvec3 ( 0.5,3.5,0.75 )\n);\nvec3 shadowDebug{X};\n#endif\n#ifdef SHADOWCSMUSESHADOWMAXZ{X}\nint index{X}=-1;\n#else\nint index{X}=SHADOWCSMNUM_CASCADES{X}-1;\n#endif\nfloat diff{X}=0.;\n#elif defined(SHADOWCUBE{X})\nuniform samplerCube shadowSampler{X};\n#else\nvarying vec4 vPositionFromLight{X};\nvarying float vDepthMetric{X};\n#if defined(SHADOWPCSS{X})\nuniform highp sampler2DShadow shadowSampler{X};\nuniform highp sampler2D depthSampler{X};\n#elif defined(SHADOWPCF{X})\nuniform highp sampler2DShadow shadowSampler{X};\n#else\nuniform sampler2D shadowSampler{X};\n#endif\nuniform mat4 lightMatrix{X};\n#endif\nuniform vec4 shadowsInfo{X};\nuniform vec2 depthValues{X};\n#endif\n#ifdef SPOTLIGHT{X}\nuniform vec4 vLightDirection{X};\nuniform vec4 vLightFalloff{X};\n#elif defined(POINTLIGHT{X})\nuniform vec4 vLightFalloff{X};\n#elif defined(HEMILIGHT{X})\nuniform vec3 vLightGround{X};\n#endif\n#ifdef PROJECTEDLIGHTTEXTURE{X}\nuniform mat4 textureProjectionMatrix{X};\nuniform sampler2D projectionLightSampler{X};\n#endif\n#endif\n";Ve.v.IncludesShadersStore.lightFragmentDeclaration=Ke;var qe="#ifdef LIGHT{X}\nuniform Light{X}\n{\nvec4 vLightData;\nvec4 vLightDiffuse;\nvec4 vLightSpecular;\n#ifdef SPOTLIGHT{X}\nvec4 vLightDirection;\nvec4 vLightFalloff;\n#elif defined(POINTLIGHT{X})\nvec4 vLightFalloff;\n#elif defined(HEMILIGHT{X})\nvec3 vLightGround;\n#endif\nvec4 shadowsInfo;\nvec2 depthValues;\n} light{X};\n#ifdef PROJECTEDLIGHTTEXTURE{X}\nuniform mat4 textureProjectionMatrix{X};\nuniform sampler2D projectionLightSampler{X};\n#endif\n#ifdef SHADOW{X}\n#ifdef SHADOWCSM{X}\nuniform mat4 lightMatrix{X}[SHADOWCSMNUM_CASCADES{X}];\nuniform float viewFrustumZ{X}[SHADOWCSMNUM_CASCADES{X}];\nuniform float frustumLengths{X}[SHADOWCSMNUM_CASCADES{X}];\nuniform float cascadeBlendFactor{X};\nvarying vec4 vPositionFromLight{X}[SHADOWCSMNUM_CASCADES{X}];\nvarying float vDepthMetric{X}[SHADOWCSMNUM_CASCADES{X}];\nvarying vec4 vPositionFromCamera{X};\n#if defined(SHADOWPCSS{X})\nuniform highp sampler2DArrayShadow shadowSampler{X};\nuniform highp sampler2DArray depthSampler{X};\nuniform vec2 lightSizeUVCorrection{X}[SHADOWCSMNUM_CASCADES{X}];\nuniform float depthCorrection{X}[SHADOWCSMNUM_CASCADES{X}];\nuniform float penumbraDarkness{X};\n#elif defined(SHADOWPCF{X})\nuniform highp sampler2DArrayShadow shadowSampler{X};\n#else\nuniform highp sampler2DArray shadowSampler{X};\n#endif\n#ifdef SHADOWCSMDEBUG{X}\nconst vec3 vCascadeColorsMultiplier{X}[8]=vec3[8]\n(\nvec3 ( 1.5,0.0,0.0 ),\nvec3 ( 0.0,1.5,0.0 ),\nvec3 ( 0.0,0.0,5.5 ),\nvec3 ( 1.5,0.0,5.5 ),\nvec3 ( 1.5,1.5,0.0 ),\nvec3 ( 1.0,1.0,1.0 ),\nvec3 ( 0.0,1.0,5.5 ),\nvec3 ( 0.5,3.5,0.75 )\n);\nvec3 shadowDebug{X};\n#endif\n#ifdef SHADOWCSMUSESHADOWMAXZ{X}\nint index{X}=-1;\n#else\nint index{X}=SHADOWCSMNUM_CASCADES{X}-1;\n#endif\nfloat diff{X}=0.;\n#elif defined(SHADOWCUBE{X})\nuniform samplerCube shadowSampler{X}; \n#else\nvarying vec4 vPositionFromLight{X};\nvarying float vDepthMetric{X};\n#if defined(SHADOWPCSS{X})\nuniform highp sampler2DShadow shadowSampler{X};\nuniform highp sampler2D depthSampler{X};\n#elif defined(SHADOWPCF{X})\nuniform highp sampler2DShadow shadowSampler{X};\n#else\nuniform sampler2D shadowSampler{X};\n#endif\nuniform mat4 lightMatrix{X};\n#endif\n#endif\n#endif\n";Ve.v.IncludesShadersStore.lightUboDeclaration=qe;var Qe="struct lightingInfo\n{\nvec3 diffuse;\n#ifdef SPECULARTERM\nvec3 specular;\n#endif\n#ifdef NDOTL\nfloat ndl;\n#endif\n};\nlightingInfo computeLighting(vec3 viewDirectionW,vec3 vNormal,vec4 lightData,vec3 diffuseColor,vec3 specularColor,float range,float glossiness) {\nlightingInfo result;\nvec3 lightVectorW;\nfloat attenuation=1.0;\nif (lightData.w==0.)\n{\nvec3 direction=lightData.xyz-vPositionW;\nattenuation=max(0.,1.0-length(direction)/range);\nlightVectorW=normalize(direction);\n}\nelse\n{\nlightVectorW=normalize(-lightData.xyz);\n}\nfloat ndl=max(0.,dot(vNormal,lightVectorW));\n#ifdef NDOTL\nresult.ndl=ndl;\n#endif\nresult.diffuse=ndl*diffuseColor*attenuation;\n#ifdef SPECULARTERM\nvec3 angleW=normalize(viewDirectionW+lightVectorW);\nfloat specComp=max(0.,dot(vNormal,angleW));\nspecComp=pow(specComp,max(1.,glossiness));\nresult.specular=specComp*specularColor*attenuation;\n#endif\nreturn result;\n}\nlightingInfo computeSpotLighting(vec3 viewDirectionW,vec3 vNormal,vec4 lightData,vec4 lightDirection,vec3 diffuseColor,vec3 specularColor,float range,float glossiness) {\nlightingInfo result;\nvec3 direction=lightData.xyz-vPositionW;\nvec3 lightVectorW=normalize(direction);\nfloat attenuation=max(0.,1.0-length(direction)/range);\nfloat cosAngle=max(0.,dot(lightDirection.xyz,-lightVectorW));\nif (cosAngle>=lightDirection.w)\n{\ncosAngle=max(0.,pow(cosAngle,lightData.w));\nattenuation*=cosAngle;\nfloat ndl=max(0.,dot(vNormal,lightVectorW));\n#ifdef NDOTL\nresult.ndl=ndl;\n#endif\nresult.diffuse=ndl*diffuseColor*attenuation;\n#ifdef SPECULARTERM\nvec3 angleW=normalize(viewDirectionW+lightVectorW);\nfloat specComp=max(0.,dot(vNormal,angleW));\nspecComp=pow(specComp,max(1.,glossiness));\nresult.specular=specComp*specularColor*attenuation;\n#endif\nreturn result;\n}\nresult.diffuse=vec3(0.);\n#ifdef SPECULARTERM\nresult.specular=vec3(0.);\n#endif\n#ifdef NDOTL\nresult.ndl=0.;\n#endif\nreturn result;\n}\nlightingInfo computeHemisphericLighting(vec3 viewDirectionW,vec3 vNormal,vec4 lightData,vec3 diffuseColor,vec3 specularColor,vec3 groundColor,float glossiness) {\nlightingInfo result;\nfloat ndl=dot(vNormal,lightData.xyz)*0.5+0.5;\n#ifdef NDOTL\nresult.ndl=ndl;\n#endif\nresult.diffuse=mix(groundColor,diffuseColor,ndl);\n#ifdef SPECULARTERM\nvec3 angleW=normalize(viewDirectionW+lightData.xyz);\nfloat specComp=max(0.,dot(vNormal,angleW));\nspecComp=pow(specComp,max(1.,glossiness));\nresult.specular=specComp*specularColor;\n#endif\nreturn result;\n}\n#define inline\nvec3 computeProjectionTextureDiffuseLighting(sampler2D projectionLightSampler,mat4 textureProjectionMatrix){\nvec4 strq=textureProjectionMatrix*vec4(vPositionW,1.0);\nstrq/=strq.w;\nvec3 textureColor=texture2D(projectionLightSampler,strq.xy).rgb;\nreturn textureColor;\n}";Ve.v.IncludesShadersStore.lightsFragmentFunctions=Qe;var $e="#ifdef SHADOWS\n#ifndef SHADOWFLOAT\nfloat unpack(vec4 color)\n{\nconst vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);\nreturn dot(color,bit_shift);\n}\n#endif\nfloat computeFallOff(float value,vec2 clipSpace,float frustumEdgeFalloff)\n{\nfloat mask=smoothstep(1.0-frustumEdgeFalloff,1.00000012,clamp(dot(clipSpace,clipSpace),0.,1.));\nreturn mix(value,1.0,mask);\n}\n#define inline\nfloat computeShadowCube(vec3 lightPosition,samplerCube shadowSampler,float darkness,vec2 depthValues)\n{\nvec3 directionToLight=vPositionW-lightPosition;\nfloat depth=length(directionToLight);\ndepth=(depth+depthValues.x)/(depthValues.y);\ndepth=clamp(depth,0.,1.0);\ndirectionToLight=normalize(directionToLight);\ndirectionToLight.y=-directionToLight.y;\n#ifndef SHADOWFLOAT\nfloat shadow=unpack(textureCube(shadowSampler,directionToLight));\n#else\nfloat shadow=textureCube(shadowSampler,directionToLight).x;\n#endif\nreturn depth>shadow ? darkness : 1.0;\n}\n#define inline\nfloat computeShadowWithPoissonSamplingCube(vec3 lightPosition,samplerCube shadowSampler,float mapSize,float darkness,vec2 depthValues)\n{\nvec3 directionToLight=vPositionW-lightPosition;\nfloat depth=length(directionToLight);\ndepth=(depth+depthValues.x)/(depthValues.y);\ndepth=clamp(depth,0.,1.0);\ndirectionToLight=normalize(directionToLight);\ndirectionToLight.y=-directionToLight.y;\nfloat visibility=1.;\nvec3 poissonDisk[4];\npoissonDisk[0]=vec3(-1.0,1.0,-1.0);\npoissonDisk[1]=vec3(1.0,-1.0,-1.0);\npoissonDisk[2]=vec3(-1.0,-1.0,-1.0);\npoissonDisk[3]=vec3(1.0,-1.0,1.0);\n#ifndef SHADOWFLOAT\nif (unpack(textureCube(shadowSampler,directionToLight+poissonDisk[0]*mapSize))<depth) visibility-=0.25;\nif (unpack(textureCube(shadowSampler,directionToLight+poissonDisk[1]*mapSize))<depth) visibility-=0.25;\nif (unpack(textureCube(shadowSampler,directionToLight+poissonDisk[2]*mapSize))<depth) visibility-=0.25;\nif (unpack(textureCube(shadowSampler,directionToLight+poissonDisk[3]*mapSize))<depth) visibility-=0.25;\n#else\nif (textureCube(shadowSampler,directionToLight+poissonDisk[0]*mapSize).x<depth) visibility-=0.25;\nif (textureCube(shadowSampler,directionToLight+poissonDisk[1]*mapSize).x<depth) visibility-=0.25;\nif (textureCube(shadowSampler,directionToLight+poissonDisk[2]*mapSize).x<depth) visibility-=0.25;\nif (textureCube(shadowSampler,directionToLight+poissonDisk[3]*mapSize).x<depth) visibility-=0.25;\n#endif\nreturn min(1.0,visibility+darkness);\n}\n#define inline\nfloat computeShadowWithESMCube(vec3 lightPosition,samplerCube shadowSampler,float darkness,float depthScale,vec2 depthValues)\n{\nvec3 directionToLight=vPositionW-lightPosition;\nfloat depth=length(directionToLight);\ndepth=(depth+depthValues.x)/(depthValues.y);\nfloat shadowPixelDepth=clamp(depth,0.,1.0);\ndirectionToLight=normalize(directionToLight);\ndirectionToLight.y=-directionToLight.y;\n#ifndef SHADOWFLOAT\nfloat shadowMapSample=unpack(textureCube(shadowSampler,directionToLight));\n#else\nfloat shadowMapSample=textureCube(shadowSampler,directionToLight).x;\n#endif\nfloat esm=1.0-clamp(exp(min(87.,depthScale*shadowPixelDepth))*shadowMapSample,0.,1.-darkness); \nreturn esm;\n}\n#define inline\nfloat computeShadowWithCloseESMCube(vec3 lightPosition,samplerCube shadowSampler,float darkness,float depthScale,vec2 depthValues)\n{\nvec3 directionToLight=vPositionW-lightPosition;\nfloat depth=length(directionToLight);\ndepth=(depth+depthValues.x)/(depthValues.y);\nfloat shadowPixelDepth=clamp(depth,0.,1.0);\ndirectionToLight=normalize(directionToLight);\ndirectionToLight.y=-directionToLight.y;\n#ifndef SHADOWFLOAT\nfloat shadowMapSample=unpack(textureCube(shadowSampler,directionToLight));\n#else\nfloat shadowMapSample=textureCube(shadowSampler,directionToLight).x;\n#endif\nfloat esm=clamp(exp(min(87.,-depthScale*(shadowPixelDepth-shadowMapSample))),darkness,1.);\nreturn esm;\n}\n#if defined(WEBGL2) || defined(WEBGPU)\n#define inline\nfloat computeShadowCSM(float layer,vec4 vPositionFromLight,float depthMetric,highp sampler2DArray shadowSampler,float darkness,float frustumEdgeFalloff)\n{\nvec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;\nvec2 uv=0.5*clipSpace.xy+vec2(0.5);\nvec3 uvLayer=vec3(uv.x,uv.y,layer);\nfloat shadowPixelDepth=clamp(depthMetric,0.,1.0);\n#ifndef SHADOWFLOAT\nfloat shadow=unpack(texture2D(shadowSampler,uvLayer));\n#else\nfloat shadow=texture2D(shadowSampler,uvLayer).x;\n#endif\nreturn shadowPixelDepth>shadow ? computeFallOff(darkness,clipSpace.xy,frustumEdgeFalloff) : 1.;\n}\n#endif\n#define inline\nfloat computeShadow(vec4 vPositionFromLight,float depthMetric,sampler2D shadowSampler,float darkness,float frustumEdgeFalloff)\n{\nvec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;\nvec2 uv=0.5*clipSpace.xy+vec2(0.5);\nif (uv.x<0. || uv.x>1.0 || uv.y<0. || uv.y>1.0)\n{\nreturn 1.0;\n}\nelse\n{\nfloat shadowPixelDepth=clamp(depthMetric,0.,1.0);\n#ifndef SHADOWFLOAT\nfloat shadow=unpack(texture2D(shadowSampler,uv));\n#else\nfloat shadow=texture2D(shadowSampler,uv).x;\n#endif\nreturn shadowPixelDepth>shadow ? computeFallOff(darkness,clipSpace.xy,frustumEdgeFalloff) : 1.;\n}\n}\n#define inline\nfloat computeShadowWithPoissonSampling(vec4 vPositionFromLight,float depthMetric,sampler2D shadowSampler,float mapSize,float darkness,float frustumEdgeFalloff)\n{\nvec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;\nvec2 uv=0.5*clipSpace.xy+vec2(0.5);\nif (uv.x<0. || uv.x>1.0 || uv.y<0. || uv.y>1.0)\n{\nreturn 1.0;\n}\nelse\n{\nfloat shadowPixelDepth=clamp(depthMetric,0.,1.0);\nfloat visibility=1.;\nvec2 poissonDisk[4];\npoissonDisk[0]=vec2(-0.94201624,-0.39906216);\npoissonDisk[1]=vec2(0.94558609,-0.76890725);\npoissonDisk[2]=vec2(-0.094184101,-0.92938870);\npoissonDisk[3]=vec2(0.34495938,0.29387760);\n#ifndef SHADOWFLOAT\nif (unpack(texture2D(shadowSampler,uv+poissonDisk[0]*mapSize))<shadowPixelDepth) visibility-=0.25;\nif (unpack(texture2D(shadowSampler,uv+poissonDisk[1]*mapSize))<shadowPixelDepth) visibility-=0.25;\nif (unpack(texture2D(shadowSampler,uv+poissonDisk[2]*mapSize))<shadowPixelDepth) visibility-=0.25;\nif (unpack(texture2D(shadowSampler,uv+poissonDisk[3]*mapSize))<shadowPixelDepth) visibility-=0.25;\n#else\nif (texture2D(shadowSampler,uv+poissonDisk[0]*mapSize).x<shadowPixelDepth) visibility-=0.25;\nif (texture2D(shadowSampler,uv+poissonDisk[1]*mapSize).x<shadowPixelDepth) visibility-=0.25;\nif (texture2D(shadowSampler,uv+poissonDisk[2]*mapSize).x<shadowPixelDepth) visibility-=0.25;\nif (texture2D(shadowSampler,uv+poissonDisk[3]*mapSize).x<shadowPixelDepth) visibility-=0.25;\n#endif\nreturn computeFallOff(min(1.0,visibility+darkness),clipSpace.xy,frustumEdgeFalloff);\n}\n}\n#define inline\nfloat computeShadowWithESM(vec4 vPositionFromLight,float depthMetric,sampler2D shadowSampler,float darkness,float depthScale,float frustumEdgeFalloff)\n{\nvec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;\nvec2 uv=0.5*clipSpace.xy+vec2(0.5);\nif (uv.x<0. || uv.x>1.0 || uv.y<0. || uv.y>1.0)\n{\nreturn 1.0;\n}\nelse\n{\nfloat shadowPixelDepth=clamp(depthMetric,0.,1.0);\n#ifndef SHADOWFLOAT\nfloat shadowMapSample=unpack(texture2D(shadowSampler,uv));\n#else\nfloat shadowMapSample=texture2D(shadowSampler,uv).x;\n#endif\nfloat esm=1.0-clamp(exp(min(87.,depthScale*shadowPixelDepth))*shadowMapSample,0.,1.-darkness);\nreturn computeFallOff(esm,clipSpace.xy,frustumEdgeFalloff);\n}\n}\n#define inline\nfloat computeShadowWithCloseESM(vec4 vPositionFromLight,float depthMetric,sampler2D shadowSampler,float darkness,float depthScale,float frustumEdgeFalloff)\n{\nvec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;\nvec2 uv=0.5*clipSpace.xy+vec2(0.5);\nif (uv.x<0. || uv.x>1.0 || uv.y<0. || uv.y>1.0)\n{\nreturn 1.0;\n}\nelse\n{\nfloat shadowPixelDepth=clamp(depthMetric,0.,1.0); \n#ifndef SHADOWFLOAT\nfloat shadowMapSample=unpack(texture2D(shadowSampler,uv));\n#else\nfloat shadowMapSample=texture2D(shadowSampler,uv).x;\n#endif\nfloat esm=clamp(exp(min(87.,-depthScale*(shadowPixelDepth-shadowMapSample))),darkness,1.);\nreturn computeFallOff(esm,clipSpace.xy,frustumEdgeFalloff);\n}\n}\n#ifdef IS_NDC_HALF_ZRANGE\n#define ZINCLIP clipSpace.z\n#else\n#define ZINCLIP uvDepth.z\n#endif\n#if defined(WEBGL2) || defined(WEBGPU)\n#define GREATEST_LESS_THAN_ONE 0.99999994\n#define inline\nfloat computeShadowWithCSMPCF1(float layer,vec4 vPositionFromLight,float depthMetric,highp sampler2DArrayShadow shadowSampler,float darkness,float frustumEdgeFalloff)\n{\nvec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;\nvec3 uvDepth=vec3(0.5*clipSpace.xyz+vec3(0.5));\nuvDepth.z=clamp(ZINCLIP,0.,GREATEST_LESS_THAN_ONE);\nvec4 uvDepthLayer=vec4(uvDepth.x,uvDepth.y,layer,uvDepth.z);\nfloat shadow=texture2D(shadowSampler,uvDepthLayer);\nshadow=mix(darkness,1.,shadow);\nreturn computeFallOff(shadow,clipSpace.xy,frustumEdgeFalloff);\n}\n#define inline\nfloat computeShadowWithCSMPCF3(float layer,vec4 vPositionFromLight,float depthMetric,highp sampler2DArrayShadow shadowSampler,vec2 shadowMapSizeAndInverse,float darkness,float frustumEdgeFalloff)\n{\nvec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;\nvec3 uvDepth=vec3(0.5*clipSpace.xyz+vec3(0.5));\nuvDepth.z=clamp(ZINCLIP,0.,GREATEST_LESS_THAN_ONE);\nvec2 uv=uvDepth.xy*shadowMapSizeAndInverse.x; \nuv+=0.5; \nvec2 st=fract(uv); \nvec2 base_uv=floor(uv)-0.5; \nbase_uv*=shadowMapSizeAndInverse.y; \nvec2 uvw0=3.-2.*st;\nvec2 uvw1=1.+2.*st;\nvec2 u=vec2((2.-st.x)/uvw0.x-1.,st.x/uvw1.x+1.)*shadowMapSizeAndInverse.y;\nvec2 v=vec2((2.-st.y)/uvw0.y-1.,st.y/uvw1.y+1.)*shadowMapSizeAndInverse.y;\nfloat shadow=0.;\nshadow+=uvw0.x*uvw0.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[0],v[0]),layer,uvDepth.z));\nshadow+=uvw1.x*uvw0.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[1],v[0]),layer,uvDepth.z));\nshadow+=uvw0.x*uvw1.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[0],v[1]),layer,uvDepth.z));\nshadow+=uvw1.x*uvw1.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[1],v[1]),layer,uvDepth.z));\nshadow=shadow/16.;\nshadow=mix(darkness,1.,shadow);\nreturn computeFallOff(shadow,clipSpace.xy,frustumEdgeFalloff);\n}\n#define inline\nfloat computeShadowWithCSMPCF5(float layer,vec4 vPositionFromLight,float depthMetric,highp sampler2DArrayShadow shadowSampler,vec2 shadowMapSizeAndInverse,float darkness,float frustumEdgeFalloff)\n{\nvec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;\nvec3 uvDepth=vec3(0.5*clipSpace.xyz+vec3(0.5));\nuvDepth.z=clamp(ZINCLIP,0.,GREATEST_LESS_THAN_ONE);\nvec2 uv=uvDepth.xy*shadowMapSizeAndInverse.x; \nuv+=0.5; \nvec2 st=fract(uv); \nvec2 base_uv=floor(uv)-0.5; \nbase_uv*=shadowMapSizeAndInverse.y; \nvec2 uvw0=4.-3.*st;\nvec2 uvw1=vec2(7.);\nvec2 uvw2=1.+3.*st;\nvec3 u=vec3((3.-2.*st.x)/uvw0.x-2.,(3.+st.x)/uvw1.x,st.x/uvw2.x+2.)*shadowMapSizeAndInverse.y;\nvec3 v=vec3((3.-2.*st.y)/uvw0.y-2.,(3.+st.y)/uvw1.y,st.y/uvw2.y+2.)*shadowMapSizeAndInverse.y;\nfloat shadow=0.;\nshadow+=uvw0.x*uvw0.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[0],v[0]),layer,uvDepth.z));\nshadow+=uvw1.x*uvw0.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[1],v[0]),layer,uvDepth.z));\nshadow+=uvw2.x*uvw0.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[2],v[0]),layer,uvDepth.z));\nshadow+=uvw0.x*uvw1.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[0],v[1]),layer,uvDepth.z));\nshadow+=uvw1.x*uvw1.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[1],v[1]),layer,uvDepth.z));\nshadow+=uvw2.x*uvw1.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[2],v[1]),layer,uvDepth.z));\nshadow+=uvw0.x*uvw2.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[0],v[2]),layer,uvDepth.z));\nshadow+=uvw1.x*uvw2.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[1],v[2]),layer,uvDepth.z));\nshadow+=uvw2.x*uvw2.y*texture2D(shadowSampler,vec4(base_uv.xy+vec2(u[2],v[2]),layer,uvDepth.z));\nshadow=shadow/144.;\nshadow=mix(darkness,1.,shadow);\nreturn computeFallOff(shadow,clipSpace.xy,frustumEdgeFalloff);\n}\n#define inline\nfloat computeShadowWithPCF1(vec4 vPositionFromLight,float depthMetric,highp sampler2DShadow shadowSampler,float darkness,float frustumEdgeFalloff)\n{\nif (depthMetric>1.0 || depthMetric<0.0) {\nreturn 1.0;\n}\nelse\n{\nvec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;\nvec3 uvDepth=vec3(0.5*clipSpace.xyz+vec3(0.5));\nuvDepth.z=ZINCLIP;\nfloat shadow=texture2D(shadowSampler,uvDepth);\nshadow=mix(darkness,1.,shadow);\nreturn computeFallOff(shadow,clipSpace.xy,frustumEdgeFalloff);\n}\n}\n#define inline\nfloat computeShadowWithPCF3(vec4 vPositionFromLight,float depthMetric,highp sampler2DShadow shadowSampler,vec2 shadowMapSizeAndInverse,float darkness,float frustumEdgeFalloff)\n{\nif (depthMetric>1.0 || depthMetric<0.0) {\nreturn 1.0;\n}\nelse\n{\nvec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;\nvec3 uvDepth=vec3(0.5*clipSpace.xyz+vec3(0.5));\nuvDepth.z=ZINCLIP;\nvec2 uv=uvDepth.xy*shadowMapSizeAndInverse.x; \nuv+=0.5; \nvec2 st=fract(uv); \nvec2 base_uv=floor(uv)-0.5; \nbase_uv*=shadowMapSizeAndInverse.y; \nvec2 uvw0=3.-2.*st;\nvec2 uvw1=1.+2.*st;\nvec2 u=vec2((2.-st.x)/uvw0.x-1.,st.x/uvw1.x+1.)*shadowMapSizeAndInverse.y;\nvec2 v=vec2((2.-st.y)/uvw0.y-1.,st.y/uvw1.y+1.)*shadowMapSizeAndInverse.y;\nfloat shadow=0.;\nshadow+=uvw0.x*uvw0.y*texture2D(shadowSampler,vec3(base_uv.xy+vec2(u[0],v[0]),uvDepth.z));\nshadow+=uvw1.x*uvw0.y*texture2D(shadowSampler,vec3(base_uv.xy+vec2(u[1],v[0]),uvDepth.z));\nshadow+=uvw0.x*uvw1.y*texture2D(shadowSampler,vec3(base_uv.xy+vec2(u[0],v[1]),uvDepth.z));\nshadow+=uvw1.x*uvw1.y*texture2D(shadowSampler,vec3(base_uv.xy+vec2(u[1],v[1]),uvDepth.z));\nshadow=shadow/16.;\nshadow=mix(darkness,1.,shadow);\nreturn computeFallOff(shadow,clipSpace.xy,frustumEdgeFalloff);\n}\n}\n#define inline\nfloat computeShadowWithPCF5(vec4 vPositionFromLight,float depthMetric,highp sampler2DShadow shadowSampler,vec2 shadowMapSizeAndInverse,float darkness,float frustumEdgeFalloff)\n{\nif (depthMetric>1.0 || depthMetric<0.0) {\nreturn 1.0;\n}\nelse\n{\nvec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;\nvec3 uvDepth=vec3(0.5*clipSpace.xyz+vec3(0.5));\nuvDepth.z=ZINCLIP;\nvec2 uv=uvDepth.xy*shadowMapSizeAndInverse.x; \nuv+=0.5; \nvec2 st=fract(uv); \nvec2 base_uv=floor(uv)-0.5; \nbase_uv*=shadowMapSizeAndInverse.y; \nvec2 uvw0=4.-3.*st;\nvec2 uvw1=vec2(7.);\nvec2 uvw2=1.+3.*st;\nvec3 u=vec3((3.-2.*st.x)/uvw0.x-2.,(3.+st.x)/uvw1.x,st.x/uvw2.x+2.)*shadowMapSizeAndInverse.y;\nvec3 v=vec3((3.-2.*st.y)/uvw0.y-2.,(3.+st.y)/uvw1.y,st.y/uvw2.y+2.)*shadowMapSizeAndInverse.y;\nfloat shadow=0.;\nshadow+=uvw0.x*uvw0.y*texture2D(shadowSampler,vec3(base_uv.xy+vec2(u[0],v[0]),uvDepth.z));\nshadow+=uvw1.x*uvw0.y*texture2D(shadowSampler,vec3(base_uv.xy+vec2(u[1],v[0]),uvDepth.z));\nshadow+=uvw2.x*uvw0.y*texture2D(shadowSampler,vec3(base_uv.xy+vec2(u[2],v[0]),uvDepth.z));\nshadow+=uvw0.x*uvw1.y*texture2D(shadowSampler,vec3(base_uv.xy+vec2(u[0],v[1]),uvDepth.z));\nshadow+=uvw1.x*uvw1.y*texture2D(shadowSampler,vec3(base_uv.xy+vec2(u[1],v[1]),uvDepth.z));\nshadow+=uvw2.x*uvw1.y*texture2D(shadowSampler,vec3(base_uv.xy+vec2(u[2],v[1]),uvDepth.z));\nshadow+=uvw0.x*uvw2.y*texture2D(shadowSampler,vec3(base_uv.xy+vec2(u[0],v[2]),uvDepth.z));\nshadow+=uvw1.x*uvw2.y*texture2D(shadowSampler,vec3(base_uv.xy+vec2(u[1],v[2]),uvDepth.z));\nshadow+=uvw2.x*uvw2.y*texture2D(shadowSampler,vec3(base_uv.xy+vec2(u[2],v[2]),uvDepth.z));\nshadow=shadow/144.;\nshadow=mix(darkness,1.,shadow);\nreturn computeFallOff(shadow,clipSpace.xy,frustumEdgeFalloff);\n}\n}\nconst vec3 PoissonSamplers32[64]=vec3[64](\nvec3(0.06407013,0.05409927,0.),\nvec3(0.7366577,0.5789394,0.),\nvec3(-0.6270542,-0.5320278,0.),\nvec3(-0.4096107,0.8411095,0.),\nvec3(0.6849564,-0.4990818,0.),\nvec3(-0.874181,-0.04579735,0.),\nvec3(0.9989998,0.0009880066,0.),\nvec3(-0.004920578,-0.9151649,0.),\nvec3(0.1805763,0.9747483,0.),\nvec3(-0.2138451,0.2635818,0.),\nvec3(0.109845,0.3884785,0.),\nvec3(0.06876755,-0.3581074,0.),\nvec3(0.374073,-0.7661266,0.),\nvec3(0.3079132,-0.1216763,0.),\nvec3(-0.3794335,-0.8271583,0.),\nvec3(-0.203878,-0.07715034,0.),\nvec3(0.5912697,0.1469799,0.),\nvec3(-0.88069,0.3031784,0.),\nvec3(0.5040108,0.8283722,0.),\nvec3(-0.5844124,0.5494877,0.),\nvec3(0.6017799,-0.1726654,0.),\nvec3(-0.5554981,0.1559997,0.),\nvec3(-0.3016369,-0.3900928,0.),\nvec3(-0.5550632,-0.1723762,0.),\nvec3(0.925029,0.2995041,0.),\nvec3(-0.2473137,0.5538505,0.),\nvec3(0.9183037,-0.2862392,0.),\nvec3(0.2469421,0.6718712,0.),\nvec3(0.3916397,-0.4328209,0.),\nvec3(-0.03576927,-0.6220032,0.),\nvec3(-0.04661255,0.7995201,0.),\nvec3(0.4402924,0.3640312,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.),\nvec3(0.,0.,0.)\n);\nconst vec3 PoissonSamplers64[64]=vec3[64](\nvec3(-0.613392,0.617481,0.),\nvec3(0.170019,-0.040254,0.),\nvec3(-0.299417,0.791925,0.),\nvec3(0.645680,0.493210,0.),\nvec3(-0.651784,0.717887,0.),\nvec3(0.421003,0.027070,0.),\nvec3(-0.817194,-0.271096,0.),\nvec3(-0.705374,-0.668203,0.),\nvec3(0.977050,-0.108615,0.),\nvec3(0.063326,0.142369,0.),\nvec3(0.203528,0.214331,0.),\nvec3(-0.667531,0.326090,0.),\nvec3(-0.098422,-0.295755,0.),\nvec3(-0.885922,0.215369,0.),\nvec3(0.566637,0.605213,0.),\nvec3(0.039766,-0.396100,0.),\nvec3(0.751946,0.453352,0.),\nvec3(0.078707,-0.715323,0.),\nvec3(-0.075838,-0.529344,0.),\nvec3(0.724479,-0.580798,0.),\nvec3(0.222999,-0.215125,0.),\nvec3(-0.467574,-0.405438,0.),\nvec3(-0.248268,-0.814753,0.),\nvec3(0.354411,-0.887570,0.),\nvec3(0.175817,0.382366,0.),\nvec3(0.487472,-0.063082,0.),\nvec3(-0.084078,0.898312,0.),\nvec3(0.488876,-0.783441,0.),\nvec3(0.470016,0.217933,0.),\nvec3(-0.696890,-0.549791,0.),\nvec3(-0.149693,0.605762,0.),\nvec3(0.034211,0.979980,0.),\nvec3(0.503098,-0.308878,0.),\nvec3(-0.016205,-0.872921,0.),\nvec3(0.385784,-0.393902,0.),\nvec3(-0.146886,-0.859249,0.),\nvec3(0.643361,0.164098,0.),\nvec3(0.634388,-0.049471,0.),\nvec3(-0.688894,0.007843,0.),\nvec3(0.464034,-0.188818,0.),\nvec3(-0.440840,0.137486,0.),\nvec3(0.364483,0.511704,0.),\nvec3(0.034028,0.325968,0.),\nvec3(0.099094,-0.308023,0.),\nvec3(0.693960,-0.366253,0.),\nvec3(0.678884,-0.204688,0.),\nvec3(0.001801,0.780328,0.),\nvec3(0.145177,-0.898984,0.),\nvec3(0.062655,-0.611866,0.),\nvec3(0.315226,-0.604297,0.),\nvec3(-0.780145,0.486251,0.),\nvec3(-0.371868,0.882138,0.),\nvec3(0.200476,0.494430,0.),\nvec3(-0.494552,-0.711051,0.),\nvec3(0.612476,0.705252,0.),\nvec3(-0.578845,-0.768792,0.),\nvec3(-0.772454,-0.090976,0.),\nvec3(0.504440,0.372295,0.),\nvec3(0.155736,0.065157,0.),\nvec3(0.391522,0.849605,0.),\nvec3(-0.620106,-0.328104,0.),\nvec3(0.789239,-0.419965,0.),\nvec3(-0.545396,0.538133,0.),\nvec3(-0.178564,-0.596057,0.)\n);\n#define inline\nfloat computeShadowWithCSMPCSS(float layer,vec4 vPositionFromLight,float depthMetric,highp sampler2DArray depthSampler,highp sampler2DArrayShadow shadowSampler,float shadowMapSizeInverse,float lightSizeUV,float darkness,float frustumEdgeFalloff,int searchTapCount,int pcfTapCount,vec3[64] poissonSamplers,vec2 lightSizeUVCorrection,float depthCorrection,float penumbraDarkness)\n{\nvec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;\nvec3 uvDepth=vec3(0.5*clipSpace.xyz+vec3(0.5));\nuvDepth.z=clamp(ZINCLIP,0.,GREATEST_LESS_THAN_ONE);\nvec4 uvDepthLayer=vec4(uvDepth.x,uvDepth.y,layer,uvDepth.z);\nfloat blockerDepth=0.0;\nfloat sumBlockerDepth=0.0;\nfloat numBlocker=0.0;\nfor (int i=0; i<searchTapCount; i ++) {\nblockerDepth=texture2D(depthSampler,vec3(uvDepth.xy+(lightSizeUV*lightSizeUVCorrection*shadowMapSizeInverse*PoissonSamplers32[i].xy),layer)).r;\nif (blockerDepth<depthMetric) {\nsumBlockerDepth+=blockerDepth;\nnumBlocker++;\n}\n}\nif (numBlocker<1.0) {\nreturn 1.0;\n}\nelse\n{\nfloat avgBlockerDepth=sumBlockerDepth/numBlocker;\nfloat AAOffset=shadowMapSizeInverse*10.;\nfloat penumbraRatio=((depthMetric-avgBlockerDepth)*depthCorrection+AAOffset);\nvec4 filterRadius=vec4(penumbraRatio*lightSizeUV*lightSizeUVCorrection*shadowMapSizeInverse,0.,0.);\nfloat random=getRand(vPositionFromLight.xy);\nfloat rotationAngle=random*3.1415926;\nvec2 rotationVector=vec2(cos(rotationAngle),sin(rotationAngle));\nfloat shadow=0.;\nfor (int i=0; i<pcfTapCount; i++) {\nvec4 offset=vec4(poissonSamplers[i],0.);\noffset=vec4(offset.x*rotationVector.x-offset.y*rotationVector.y,offset.y*rotationVector.x+offset.x*rotationVector.y,0.,0.);\nshadow+=texture2D(shadowSampler,uvDepthLayer+offset*filterRadius);\n}\nshadow/=float(pcfTapCount);\nshadow=mix(shadow,1.,min((depthMetric-avgBlockerDepth)*depthCorrection*penumbraDarkness,1.));\nshadow=mix(darkness,1.,shadow);\nreturn computeFallOff(shadow,clipSpace.xy,frustumEdgeFalloff);\n}\n}\n#define inline\nfloat computeShadowWithPCSS(vec4 vPositionFromLight,float depthMetric,sampler2D depthSampler,highp sampler2DShadow shadowSampler,float shadowMapSizeInverse,float lightSizeUV,float darkness,float frustumEdgeFalloff,int searchTapCount,int pcfTapCount,vec3[64] poissonSamplers)\n{\nif (depthMetric>1.0 || depthMetric<0.0) {\nreturn 1.0;\n}\nelse\n{\nvec3 clipSpace=vPositionFromLight.xyz/vPositionFromLight.w;\nvec3 uvDepth=vec3(0.5*clipSpace.xyz+vec3(0.5));\nuvDepth.z=ZINCLIP;\nfloat blockerDepth=0.0;\nfloat sumBlockerDepth=0.0;\nfloat numBlocker=0.0;\nfor (int i=0; i<searchTapCount; i ++) {\nblockerDepth=texture2D(depthSampler,uvDepth.xy+(lightSizeUV*shadowMapSizeInverse*PoissonSamplers32[i].xy)).r;\nif (blockerDepth<depthMetric) {\nsumBlockerDepth+=blockerDepth;\nnumBlocker++;\n}\n}\nif (numBlocker<1.0) {\nreturn 1.0;\n}\nelse\n{\nfloat avgBlockerDepth=sumBlockerDepth/numBlocker;\nfloat AAOffset=shadowMapSizeInverse*10.;\nfloat penumbraRatio=((depthMetric-avgBlockerDepth)+AAOffset);\nfloat filterRadius=penumbraRatio*lightSizeUV*shadowMapSizeInverse;\nfloat random=getRand(vPositionFromLight.xy);\nfloat rotationAngle=random*3.1415926;\nvec2 rotationVector=vec2(cos(rotationAngle),sin(rotationAngle));\nfloat shadow=0.;\nfor (int i=0; i<pcfTapCount; i++) {\nvec3 offset=poissonSamplers[i];\noffset=vec3(offset.x*rotationVector.x-offset.y*rotationVector.y,offset.y*rotationVector.x+offset.x*rotationVector.y,0.);\nshadow+=texture2D(shadowSampler,uvDepth+offset*filterRadius);\n}\nshadow/=float(pcfTapCount);\nshadow=mix(shadow,1.,depthMetric-avgBlockerDepth);\nshadow=mix(darkness,1.,shadow);\nreturn computeFallOff(shadow,clipSpace.xy,frustumEdgeFalloff);\n}\n}\n}\n#define inline\nfloat computeShadowWithPCSS16(vec4 vPositionFromLight,float depthMetric,sampler2D depthSampler,highp sampler2DShadow shadowSampler,float shadowMapSizeInverse,float lightSizeUV,float darkness,float frustumEdgeFalloff)\n{\nreturn computeShadowWithPCSS(vPositionFromLight,depthMetric,depthSampler,shadowSampler,shadowMapSizeInverse,lightSizeUV,darkness,frustumEdgeFalloff,16,16,PoissonSamplers32);\n}\n#define inline\nfloat computeShadowWithPCSS32(vec4 vPositionFromLight,float depthMetric,sampler2D depthSampler,highp sampler2DShadow shadowSampler,float shadowMapSizeInverse,float lightSizeUV,float darkness,float frustumEdgeFalloff)\n{\nreturn computeShadowWithPCSS(vPositionFromLight,depthMetric,depthSampler,shadowSampler,shadowMapSizeInverse,lightSizeUV,darkness,frustumEdgeFalloff,16,32,PoissonSamplers32);\n}\n#define inline\nfloat computeShadowWithPCSS64(vec4 vPositionFromLight,float depthMetric,sampler2D depthSampler,highp sampler2DShadow shadowSampler,float shadowMapSizeInverse,float lightSizeUV,float darkness,float frustumEdgeFalloff)\n{\nreturn computeShadowWithPCSS(vPositionFromLight,depthMetric,depthSampler,shadowSampler,shadowMapSizeInverse,lightSizeUV,darkness,frustumEdgeFalloff,32,64,PoissonSamplers64);\n}\n#define inline\nfloat computeShadowWithCSMPCSS16(float layer,vec4 vPositionFromLight,float depthMetric,highp sampler2DArray depthSampler,highp sampler2DArrayShadow shadowSampler,float shadowMapSizeInverse,float lightSizeUV,float darkness,float frustumEdgeFalloff,vec2 lightSizeUVCorrection,float depthCorrection,float penumbraDarkness)\n{\nreturn computeShadowWithCSMPCSS(layer,vPositionFromLight,depthMetric,depthSampler,shadowSampler,shadowMapSizeInverse,lightSizeUV,darkness,frustumEdgeFalloff,16,16,PoissonSamplers32,lightSizeUVCorrection,depthCorrection,penumbraDarkness);\n}\n#define inline\nfloat computeShadowWithCSMPCSS32(float layer,vec4 vPositionFromLight,float depthMetric,highp sampler2DArray depthSampler,highp sampler2DArrayShadow shadowSampler,float shadowMapSizeInverse,float lightSizeUV,float darkness,float frustumEdgeFalloff,vec2 lightSizeUVCorrection,float depthCorrection,float penumbraDarkness)\n{\nreturn computeShadowWithCSMPCSS(layer,vPositionFromLight,depthMetric,depthSampler,shadowSampler,shadowMapSizeInverse,lightSizeUV,darkness,frustumEdgeFalloff,16,32,PoissonSamplers32,lightSizeUVCorrection,depthCorrection,penumbraDarkness);\n}\n#define inline\nfloat computeShadowWithCSMPCSS64(float layer,vec4 vPositionFromLight,float depthMetric,highp sampler2DArray depthSampler,highp sampler2DArrayShadow shadowSampler,float shadowMapSizeInverse,float lightSizeUV,float darkness,float frustumEdgeFalloff,vec2 lightSizeUVCorrection,float depthCorrection,float penumbraDarkness)\n{\nreturn computeShadowWithCSMPCSS(layer,vPositionFromLight,depthMetric,depthSampler,shadowSampler,shadowMapSizeInverse,lightSizeUV,darkness,frustumEdgeFalloff,32,64,PoissonSamplers64,lightSizeUVCorrection,depthCorrection,penumbraDarkness);\n}\n#endif\n#endif\n";Ve.v.IncludesShadersStore.shadowsFragmentFunctions=$e;var Je="#ifdef _DEFINENAME_\n#if _DEFINENAME_DIRECTUV==1\n#define v_VARYINGNAME_UV vMainUV1\n#elif _DEFINENAME_DIRECTUV==2\n#define v_VARYINGNAME_UV vMainUV2\n#elif _DEFINENAME_DIRECTUV==3\n#define v_VARYINGNAME_UV vMainUV3\n#elif _DEFINENAME_DIRECTUV==4\n#define v_VARYINGNAME_UV vMainUV4\n#elif _DEFINENAME_DIRECTUV==5\n#define v_VARYINGNAME_UV vMainUV5\n#elif _DEFINENAME_DIRECTUV==6\n#define v_VARYINGNAME_UV vMainUV6\n#else\nvarying vec2 v_VARYINGNAME_UV;\n#endif\nuniform sampler2D _SAMPLERNAME_Sampler;\n#endif\n";Ve.v.IncludesShadersStore.samplerFragmentDeclaration=Je;var et="#ifdef FRESNEL\nfloat computeFresnelTerm(vec3 viewDirection,vec3 worldNormal,float bias,float power)\n{\nfloat fresnelTerm=pow(bias+abs(dot(viewDirection,worldNormal)),power);\nreturn clamp(fresnelTerm,0.,1.);\n}\n#endif\n";Ve.v.IncludesShadersStore.fresnelFunction=et;var tt="vec3 computeFixedEquirectangularCoords(vec4 worldPos,vec3 worldNormal,vec3 direction)\n{\nfloat lon=atan(direction.z,direction.x);\nfloat lat=acos(direction.y);\nvec2 sphereCoords=vec2(lon,lat)*RECIPROCAL_PI2*2.0;\nfloat s=sphereCoords.x*0.5+0.5;\nfloat t=sphereCoords.y;\nreturn vec3(s,t,0); \n}\nvec3 computeMirroredFixedEquirectangularCoords(vec4 worldPos,vec3 worldNormal,vec3 direction)\n{\nfloat lon=atan(direction.z,direction.x);\nfloat lat=acos(direction.y);\nvec2 sphereCoords=vec2(lon,lat)*RECIPROCAL_PI2*2.0;\nfloat s=sphereCoords.x*0.5+0.5;\nfloat t=sphereCoords.y;\nreturn vec3(1.0-s,t,0); \n}\nvec3 computeEquirectangularCoords(vec4 worldPos,vec3 worldNormal,vec3 eyePosition,mat4 reflectionMatrix)\n{\nvec3 cameraToVertex=normalize(worldPos.xyz-eyePosition);\nvec3 r=normalize(reflect(cameraToVertex,worldNormal));\nr=vec3(reflectionMatrix*vec4(r,0));\nfloat lon=atan(r.z,r.x);\nfloat lat=acos(r.y);\nvec2 sphereCoords=vec2(lon,lat)*RECIPROCAL_PI2*2.0;\nfloat s=sphereCoords.x*0.5+0.5;\nfloat t=sphereCoords.y;\nreturn vec3(s,t,0);\n}\nvec3 computeSphericalCoords(vec4 worldPos,vec3 worldNormal,mat4 view,mat4 reflectionMatrix)\n{\nvec3 viewDir=normalize(vec3(view*worldPos));\nvec3 viewNormal=normalize(vec3(view*vec4(worldNormal,0.0)));\nvec3 r=reflect(viewDir,viewNormal);\nr=vec3(reflectionMatrix*vec4(r,0));\nr.z=r.z-1.0;\nfloat m=2.0*length(r);\nreturn vec3(r.x/m+0.5,1.0-r.y/m-0.5,0);\n}\nvec3 computePlanarCoords(vec4 worldPos,vec3 worldNormal,vec3 eyePosition,mat4 reflectionMatrix)\n{\nvec3 viewDir=worldPos.xyz-eyePosition;\nvec3 coords=normalize(reflect(viewDir,worldNormal));\nreturn vec3(reflectionMatrix*vec4(coords,1));\n}\nvec3 computeCubicCoords(vec4 worldPos,vec3 worldNormal,vec3 eyePosition,mat4 reflectionMatrix)\n{\nvec3 viewDir=normalize(worldPos.xyz-eyePosition);\nvec3 coords=reflect(viewDir,worldNormal);\ncoords=vec3(reflectionMatrix*vec4(coords,0));\n#ifdef INVERTCUBICMAP\ncoords.y*=-1.0;\n#endif\nreturn coords;\n}\nvec3 computeCubicLocalCoords(vec4 worldPos,vec3 worldNormal,vec3 eyePosition,mat4 reflectionMatrix,vec3 reflectionSize,vec3 reflectionPosition)\n{\nvec3 viewDir=normalize(worldPos.xyz-eyePosition);\nvec3 coords=reflect(viewDir,worldNormal);\ncoords=parallaxCorrectNormal(worldPos.xyz,coords,reflectionSize,reflectionPosition);\ncoords=vec3(reflectionMatrix*vec4(coords,0));\n#ifdef INVERTCUBICMAP\ncoords.y*=-1.0;\n#endif\nreturn coords;\n}\nvec3 computeProjectionCoords(vec4 worldPos,mat4 view,mat4 reflectionMatrix)\n{\nreturn vec3(reflectionMatrix*(view*worldPos));\n}\nvec3 computeSkyBoxCoords(vec3 positionW,mat4 reflectionMatrix)\n{\nreturn vec3(reflectionMatrix*vec4(positionW,1.));\n}\n#ifdef REFLECTION\nvec3 computeReflectionCoords(vec4 worldPos,vec3 worldNormal)\n{\n#ifdef REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED\nvec3 direction=normalize(vDirectionW);\nreturn computeMirroredFixedEquirectangularCoords(worldPos,worldNormal,direction);\n#endif\n#ifdef REFLECTIONMAP_EQUIRECTANGULAR_FIXED\nvec3 direction=normalize(vDirectionW);\nreturn computeFixedEquirectangularCoords(worldPos,worldNormal,direction);\n#endif\n#ifdef REFLECTIONMAP_EQUIRECTANGULAR\nreturn computeEquirectangularCoords(worldPos,worldNormal,vEyePosition.xyz,reflectionMatrix);\n#endif\n#ifdef REFLECTIONMAP_SPHERICAL\nreturn computeSphericalCoords(worldPos,worldNormal,view,reflectionMatrix);\n#endif\n#ifdef REFLECTIONMAP_PLANAR\nreturn computePlanarCoords(worldPos,worldNormal,vEyePosition.xyz,reflectionMatrix);\n#endif\n#ifdef REFLECTIONMAP_CUBIC\n#ifdef USE_LOCAL_REFLECTIONMAP_CUBIC\nreturn computeCubicLocalCoords(worldPos,worldNormal,vEyePosition.xyz,reflectionMatrix,vReflectionSize,vReflectionPosition);\n#else\nreturn computeCubicCoords(worldPos,worldNormal,vEyePosition.xyz,reflectionMatrix);\n#endif\n#endif\n#ifdef REFLECTIONMAP_PROJECTION\nreturn computeProjectionCoords(worldPos,view,reflectionMatrix);\n#endif\n#ifdef REFLECTIONMAP_SKYBOX\nreturn computeSkyBoxCoords(vPositionUVW,reflectionMatrix);\n#endif\n#ifdef REFLECTIONMAP_EXPLICIT\nreturn vec3(0,0,0);\n#endif\n}\n#endif\n";Ve.v.IncludesShadersStore.reflectionFunction=tt;var nt="#ifdef EXPOSURE\nuniform float exposureLinear;\n#endif\n#ifdef CONTRAST\nuniform float contrast;\n#endif\n#if defined(VIGNETTE) || defined(DITHER)\nuniform vec2 vInverseScreenSize;\n#endif\n#ifdef VIGNETTE\nuniform vec4 vignetteSettings1;\nuniform vec4 vignetteSettings2;\n#endif\n#ifdef COLORCURVES\nuniform vec4 vCameraColorCurveNegative;\nuniform vec4 vCameraColorCurveNeutral;\nuniform vec4 vCameraColorCurvePositive;\n#endif\n#ifdef COLORGRADING\n#ifdef COLORGRADING3D\nuniform highp sampler3D txColorTransform;\n#else\nuniform sampler2D txColorTransform;\n#endif\nuniform vec4 colorTransformSettings;\n#endif\n#ifdef DITHER\nuniform float ditherIntensity;\n#endif\n";Ve.v.IncludesShadersStore.imageProcessingDeclaration=nt;var it="#if defined(COLORGRADING) && !defined(COLORGRADING3D)\n/** \n* Polyfill for SAMPLE_TEXTURE_3D,which is unsupported in WebGL.\n* sampler3dSetting.x=textureOffset (0.5/textureSize).\n* sampler3dSetting.y=textureSize.\n*/\n#define inline\nvec3 sampleTexture3D(sampler2D colorTransform,vec3 color,vec2 sampler3dSetting)\n{\nfloat sliceSize=2.0*sampler3dSetting.x; \n#ifdef SAMPLER3DGREENDEPTH\nfloat sliceContinuous=(color.g-sampler3dSetting.x)*sampler3dSetting.y;\n#else\nfloat sliceContinuous=(color.b-sampler3dSetting.x)*sampler3dSetting.y;\n#endif\nfloat sliceInteger=floor(sliceContinuous);\nfloat sliceFraction=sliceContinuous-sliceInteger;\n#ifdef SAMPLER3DGREENDEPTH\nvec2 sliceUV=color.rb;\n#else\nvec2 sliceUV=color.rg;\n#endif\nsliceUV.x*=sliceSize;\nsliceUV.x+=sliceInteger*sliceSize;\nsliceUV=saturate(sliceUV);\nvec4 slice0Color=texture2D(colorTransform,sliceUV);\nsliceUV.x+=sliceSize;\nsliceUV=saturate(sliceUV);\nvec4 slice1Color=texture2D(colorTransform,sliceUV);\nvec3 result=mix(slice0Color.rgb,slice1Color.rgb,sliceFraction);\n#ifdef SAMPLER3DBGRMAP\ncolor.rgb=result.rgb;\n#else\ncolor.rgb=result.bgr;\n#endif\nreturn color;\n}\n#endif\n#ifdef TONEMAPPING_ACES\nconst mat3 ACESInputMat=mat3(\nvec3(0.59719,0.07600,0.02840),\nvec3(0.35458,0.90834,0.13383),\nvec3(0.04823,0.01566,0.83777)\n);\nconst mat3 ACESOutputMat=mat3(\nvec3( 1.60475,-0.10208,-0.00327),\nvec3(-0.53108, 1.10813,-0.07276),\nvec3(-0.07367,-0.00605, 1.07602)\n);\nvec3 RRTAndODTFit(vec3 v)\n{\nvec3 a=v*(v+0.0245786)-0.000090537;\nvec3 b=v*(0.983729*v+0.4329510)+0.238081;\nreturn a/b;\n}\nvec3 ACESFitted(vec3 color)\n{\ncolor=ACESInputMat*color;\ncolor=RRTAndODTFit(color);\ncolor=ACESOutputMat*color;\ncolor=saturate(color);\nreturn color;\n}\n#endif\nvec4 applyImageProcessing(vec4 result) {\n#ifdef EXPOSURE\nresult.rgb*=exposureLinear;\n#endif\n#ifdef VIGNETTE\nvec2 viewportXY=gl_FragCoord.xy*vInverseScreenSize;\nviewportXY=viewportXY*2.0-1.0;\nvec3 vignetteXY1=vec3(viewportXY*vignetteSettings1.xy+vignetteSettings1.zw,1.0);\nfloat vignetteTerm=dot(vignetteXY1,vignetteXY1);\nfloat vignette=pow(vignetteTerm,vignetteSettings2.w);\nvec3 vignetteColor=vignetteSettings2.rgb;\n#ifdef VIGNETTEBLENDMODEMULTIPLY\nvec3 vignetteColorMultiplier=mix(vignetteColor,vec3(1,1,1),vignette);\nresult.rgb*=vignetteColorMultiplier;\n#endif\n#ifdef VIGNETTEBLENDMODEOPAQUE\nresult.rgb=mix(vignetteColor,result.rgb,vignette);\n#endif\n#endif\n#ifdef TONEMAPPING\n#ifdef TONEMAPPING_ACES\nresult.rgb=ACESFitted(result.rgb);\n#else\nconst float tonemappingCalibration=1.590579;\nresult.rgb=1.0-exp2(-tonemappingCalibration*result.rgb);\n#endif\n#endif\nresult.rgb=toGammaSpace(result.rgb);\nresult.rgb=saturate(result.rgb);\n#ifdef CONTRAST\nvec3 resultHighContrast=result.rgb*result.rgb*(3.0-2.0*result.rgb);\nif (contrast<1.0) {\nresult.rgb=mix(vec3(0.5,0.5,0.5),result.rgb,contrast);\n} else {\nresult.rgb=mix(result.rgb,resultHighContrast,contrast-1.0);\n}\n#endif\n#ifdef COLORGRADING\nvec3 colorTransformInput=result.rgb*colorTransformSettings.xxx+colorTransformSettings.yyy;\n#ifdef COLORGRADING3D\nvec3 colorTransformOutput=texture(txColorTransform,colorTransformInput).rgb;\n#else\nvec3 colorTransformOutput=sampleTexture3D(txColorTransform,colorTransformInput,colorTransformSettings.yz).rgb;\n#endif\nresult.rgb=mix(result.rgb,colorTransformOutput,colorTransformSettings.www);\n#endif\n#ifdef COLORCURVES\nfloat luma=getLuminance(result.rgb);\nvec2 curveMix=clamp(vec2(luma*3.0-1.5,luma*-3.0+1.5),vec2(0.0),vec2(1.0));\nvec4 colorCurve=vCameraColorCurveNeutral+curveMix.x*vCameraColorCurvePositive-curveMix.y*vCameraColorCurveNegative;\nresult.rgb*=colorCurve.rgb;\nresult.rgb=mix(vec3(luma),result.rgb,colorCurve.a);\n#endif\n#ifdef DITHER\nfloat rand=getRand(gl_FragCoord.xy*vInverseScreenSize);\nfloat dither=mix(-ditherIntensity,ditherIntensity,rand);\nresult.rgb=saturate(result.rgb+vec3(dither));\n#endif\nreturn result;\n}";Ve.v.IncludesShadersStore.imageProcessingFunctions=it;var rt="#if defined(BUMP) || defined(CLEARCOAT_BUMP) || defined(ANISOTROPIC) || defined(DETAIL)\n#if defined(TANGENT) && defined(NORMAL) \nvarying mat3 vTBN;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\nuniform mat4 normalMatrix;\n#endif\nvec3 perturbNormalBase(mat3 cotangentFrame,vec3 normal,float scale)\n{\n#ifdef NORMALXYSCALE\nnormal=normalize(normal*vec3(scale,scale,1.0));\n#endif\nreturn normalize(cotangentFrame*normal);\n}\nvec3 perturbNormal(mat3 cotangentFrame,vec3 textureSample,float scale)\n{\nreturn perturbNormalBase(cotangentFrame,textureSample*2.0-1.0,scale);\n}\nmat3 cotangent_frame(vec3 normal,vec3 p,vec2 uv,vec2 tangentSpaceParams)\n{\nvec3 dp1=dFdx(p);\nvec3 dp2=dFdy(p);\nvec2 duv1=dFdx(uv);\nvec2 duv2=dFdy(uv);\nvec3 dp2perp=cross(dp2,normal);\nvec3 dp1perp=cross(normal,dp1);\nvec3 tangent=dp2perp*duv1.x+dp1perp*duv2.x;\nvec3 bitangent=dp2perp*duv1.y+dp1perp*duv2.y;\ntangent*=tangentSpaceParams.x;\nbitangent*=tangentSpaceParams.y;\nfloat invmax=inversesqrt(max(dot(tangent,tangent),dot(bitangent,bitangent)));\nreturn mat3(tangent*invmax,bitangent*invmax,normal);\n}\n#endif\n";Ve.v.IncludesShadersStore.bumpFragmentMainFunctions=rt;var at="#if defined(BUMP)\n#include<samplerFragmentDeclaration>(_DEFINENAME_,BUMP,_VARYINGNAME_,Bump,_SAMPLERNAME_,bump)\n#endif\n#if defined(DETAIL)\n#include<samplerFragmentDeclaration>(_DEFINENAME_,DETAIL,_VARYINGNAME_,Detail,_SAMPLERNAME_,detail)\n#endif\n#if defined(BUMP) && defined(PARALLAX)\nconst float minSamples=4.;\nconst float maxSamples=15.;\nconst int iMaxSamples=15;\nvec2 parallaxOcclusion(vec3 vViewDirCoT,vec3 vNormalCoT,vec2 texCoord,float parallaxScale) {\nfloat parallaxLimit=length(vViewDirCoT.xy)/vViewDirCoT.z;\nparallaxLimit*=parallaxScale;\nvec2 vOffsetDir=normalize(vViewDirCoT.xy);\nvec2 vMaxOffset=vOffsetDir*parallaxLimit;\nfloat numSamples=maxSamples+(dot(vViewDirCoT,vNormalCoT)*(minSamples-maxSamples));\nfloat stepSize=1.0/numSamples;\nfloat currRayHeight=1.0;\nvec2 vCurrOffset=vec2(0,0);\nvec2 vLastOffset=vec2(0,0);\nfloat lastSampledHeight=1.0;\nfloat currSampledHeight=1.0;\nfor (int i=0; i<iMaxSamples; i++)\n{\ncurrSampledHeight=texture2D(bumpSampler,texCoord+vCurrOffset).w;\nif (currSampledHeight>currRayHeight)\n{\nfloat delta1=currSampledHeight-currRayHeight;\nfloat delta2=(currRayHeight+stepSize)-lastSampledHeight;\nfloat ratio=delta1/(delta1+delta2);\nvCurrOffset=(ratio)* vLastOffset+(1.0-ratio)*vCurrOffset;\nbreak;\n}\nelse\n{\ncurrRayHeight-=stepSize;\nvLastOffset=vCurrOffset;\nvCurrOffset+=stepSize*vMaxOffset;\nlastSampledHeight=currSampledHeight;\n}\n}\nreturn vCurrOffset;\n}\nvec2 parallaxOffset(vec3 viewDir,float heightScale)\n{\nfloat height=texture2D(bumpSampler,vBumpUV).w;\nvec2 texCoordOffset=heightScale*viewDir.xy*height;\nreturn -texCoordOffset;\n}\n#endif\n";Ve.v.IncludesShadersStore.bumpFragmentFunctions=at;var ot="#ifdef CLIPPLANE\nvarying float fClipDistance;\n#endif\n#ifdef CLIPPLANE2\nvarying float fClipDistance2;\n#endif\n#ifdef CLIPPLANE3\nvarying float fClipDistance3;\n#endif\n#ifdef CLIPPLANE4\nvarying float fClipDistance4;\n#endif\n#ifdef CLIPPLANE5\nvarying float fClipDistance5;\n#endif\n#ifdef CLIPPLANE6\nvarying float fClipDistance6;\n#endif\n";Ve.v.IncludesShadersStore.clipPlaneFragmentDeclaration=ot;var st="#ifdef LOGARITHMICDEPTH\nuniform float logarithmicDepthConstant;\nvarying float vFragmentDepth;\n#endif\n";Ve.v.IncludesShadersStore.logDepthDeclaration=st;var ut="#ifdef FOG\n#define FOGMODE_NONE 0.\n#define FOGMODE_EXP 1.\n#define FOGMODE_EXP2 2.\n#define FOGMODE_LINEAR 3.\n#define E 2.71828\nuniform vec4 vFogInfos;\nuniform vec3 vFogColor;\nvarying vec3 vFogDistance;\nfloat CalcFogFactor()\n{\nfloat fogCoeff=1.0;\nfloat fogStart=vFogInfos.y;\nfloat fogEnd=vFogInfos.z;\nfloat fogDensity=vFogInfos.w;\nfloat fogDistance=length(vFogDistance);\nif (FOGMODE_LINEAR==vFogInfos.x)\n{\nfogCoeff=(fogEnd-fogDistance)/(fogEnd-fogStart);\n}\nelse if (FOGMODE_EXP==vFogInfos.x)\n{\nfogCoeff=1.0/pow(E,fogDistance*fogDensity);\n}\nelse if (FOGMODE_EXP2==vFogInfos.x)\n{\nfogCoeff=1.0/pow(E,fogDistance*fogDistance*fogDensity*fogDensity);\n}\nreturn clamp(fogCoeff,0.0,1.0);\n}\n#endif\n";Ve.v.IncludesShadersStore.fogFragmentDeclaration=ut;var lt="#if defined(CLIPPLANE) || defined(CLIPPLANE2) || defined(CLIPPLANE3) || defined(CLIPPLANE4) || defined(CLIPPLANE5) || defined(CLIPPLANE6)\nif (false) {}\n#endif\n#ifdef CLIPPLANE\nelse if (fClipDistance>0.0)\n{\ndiscard;\n}\n#endif\n#ifdef CLIPPLANE2\nelse if (fClipDistance2>0.0)\n{\ndiscard;\n}\n#endif\n#ifdef CLIPPLANE3\nelse if (fClipDistance3>0.0)\n{\ndiscard;\n}\n#endif\n#ifdef CLIPPLANE4\nelse if (fClipDistance4>0.0)\n{\ndiscard;\n}\n#endif\n#ifdef CLIPPLANE5\nelse if (fClipDistance5>0.0)\n{\ndiscard;\n}\n#endif\n#ifdef CLIPPLANE6\nelse if (fClipDistance6>0.0)\n{\ndiscard;\n}\n#endif\n";Ve.v.IncludesShadersStore.clipPlaneFragment=lt;var ct="vec2 uvOffset=vec2(0.0,0.0);\n#if defined(BUMP) || defined(PARALLAX) || defined(DETAIL)\n#ifdef NORMALXYSCALE\nfloat normalScale=1.0;\n#elif defined(BUMP)\nfloat normalScale=vBumpInfos.y;\n#else\nfloat normalScale=1.0;\n#endif\n#if defined(TANGENT) && defined(NORMAL)\nmat3 TBN=vTBN;\n#elif defined(BUMP)\nvec2 TBNUV=gl_FrontFacing ? vBumpUV : -vBumpUV;\nmat3 TBN=cotangent_frame(normalW*normalScale,vPositionW,TBNUV,vTangentSpaceParams);\n#else\nvec2 TBNUV=gl_FrontFacing ? vDetailUV : -vDetailUV;\nmat3 TBN=cotangent_frame(normalW*normalScale,vPositionW,TBNUV,vec2(1.,1.));\n#endif\n#elif defined(ANISOTROPIC)\n#if defined(TANGENT) && defined(NORMAL)\nmat3 TBN=vTBN;\n#else\nvec2 TBNUV=gl_FrontFacing ? vMainUV1 : -vMainUV1;\nmat3 TBN=cotangent_frame(normalW,vPositionW,TBNUV,vec2(1.,1.));\n#endif\n#endif\n#ifdef PARALLAX\nmat3 invTBN=transposeMat3(TBN);\n#ifdef PARALLAXOCCLUSION\nuvOffset=parallaxOcclusion(invTBN*-viewDirectionW,invTBN*normalW,vBumpUV,vBumpInfos.z);\n#else\nuvOffset=parallaxOffset(invTBN*viewDirectionW,vBumpInfos.z);\n#endif\n#endif\n#ifdef DETAIL\nvec4 detailColor=texture2D(detailSampler,vDetailUV+uvOffset);\nvec2 detailNormalRG=detailColor.wy*2.0-1.0;\nfloat detailNormalB=sqrt(1.-saturate(dot(detailNormalRG,detailNormalRG)));\nvec3 detailNormal=vec3(detailNormalRG,detailNormalB);\n#endif\n#ifdef BUMP\n#ifdef OBJECTSPACE_NORMALMAP\nnormalW=normalize(texture2D(bumpSampler,vBumpUV).xyz *2.0-1.0);\nnormalW=normalize(mat3(normalMatrix)*normalW);\n#elif !defined(DETAIL)\nnormalW=perturbNormal(TBN,texture2D(bumpSampler,vBumpUV+uvOffset).xyz,vBumpInfos.y);\n#else\nvec3 bumpNormal=texture2D(bumpSampler,vBumpUV+uvOffset).xyz*2.0-1.0;\n#if DETAIL_NORMALBLENDMETHOD==0 \ndetailNormal.xy*=vDetailInfos.z;\nvec3 blendedNormal=normalize(vec3(bumpNormal.xy+detailNormal.xy,bumpNormal.z*detailNormal.z));\n#elif DETAIL_NORMALBLENDMETHOD==1 \ndetailNormal.xy*=vDetailInfos.z;\nbumpNormal+=vec3(0.0,0.0,1.0);\ndetailNormal*=vec3(-1.0,-1.0,1.0);\nvec3 blendedNormal=bumpNormal*dot(bumpNormal,detailNormal)/bumpNormal.z-detailNormal;\n#endif\nnormalW=perturbNormalBase(TBN,blendedNormal,vBumpInfos.y);\n#endif\n#elif defined(DETAIL)\ndetailNormal.xy*=vDetailInfos.z;\nnormalW=perturbNormalBase(TBN,detailNormal,vDetailInfos.z);\n#endif\n";Ve.v.IncludesShadersStore.bumpFragment=ct;var ht="#ifdef DEPTHPREPASS\ngl_FragColor=vec4(0.,0.,0.,1.0);\nreturn;\n#endif\n";Ve.v.IncludesShadersStore.depthPrePass=ht;var ft="#ifdef LIGHT{X}\n#if defined(SHADOWONLY) || defined(LIGHTMAP) && defined(LIGHTMAPEXCLUDED{X}) && defined(LIGHTMAPNOSPECULAR{X})\n#else\n#ifdef PBR\n#ifdef SPOTLIGHT{X}\npreInfo=computePointAndSpotPreLightingInfo(light{X}.vLightData,viewDirectionW,normalW);\n#elif defined(POINTLIGHT{X})\npreInfo=computePointAndSpotPreLightingInfo(light{X}.vLightData,viewDirectionW,normalW);\n#elif defined(HEMILIGHT{X})\npreInfo=computeHemisphericPreLightingInfo(light{X}.vLightData,viewDirectionW,normalW);\n#elif defined(DIRLIGHT{X})\npreInfo=computeDirectionalPreLightingInfo(light{X}.vLightData,viewDirectionW,normalW);\n#endif\npreInfo.NdotV=NdotV;\n#ifdef SPOTLIGHT{X}\n#ifdef LIGHT_FALLOFF_GLTF{X}\npreInfo.attenuation=computeDistanceLightFalloff_GLTF(preInfo.lightDistanceSquared,light{X}.vLightFalloff.y);\npreInfo.attenuation*=computeDirectionalLightFalloff_GLTF(light{X}.vLightDirection.xyz,preInfo.L,light{X}.vLightFalloff.z,light{X}.vLightFalloff.w);\n#elif defined(LIGHT_FALLOFF_PHYSICAL{X})\npreInfo.attenuation=computeDistanceLightFalloff_Physical(preInfo.lightDistanceSquared);\npreInfo.attenuation*=computeDirectionalLightFalloff_Physical(light{X}.vLightDirection.xyz,preInfo.L,light{X}.vLightDirection.w);\n#elif defined(LIGHT_FALLOFF_STANDARD{X})\npreInfo.attenuation=computeDistanceLightFalloff_Standard(preInfo.lightOffset,light{X}.vLightFalloff.x);\npreInfo.attenuation*=computeDirectionalLightFalloff_Standard(light{X}.vLightDirection.xyz,preInfo.L,light{X}.vLightDirection.w,light{X}.vLightData.w);\n#else\npreInfo.attenuation=computeDistanceLightFalloff(preInfo.lightOffset,preInfo.lightDistanceSquared,light{X}.vLightFalloff.x,light{X}.vLightFalloff.y);\npreInfo.attenuation*=computeDirectionalLightFalloff(light{X}.vLightDirection.xyz,preInfo.L,light{X}.vLightDirection.w,light{X}.vLightData.w,light{X}.vLightFalloff.z,light{X}.vLightFalloff.w);\n#endif\n#elif defined(POINTLIGHT{X})\n#ifdef LIGHT_FALLOFF_GLTF{X}\npreInfo.attenuation=computeDistanceLightFalloff_GLTF(preInfo.lightDistanceSquared,light{X}.vLightFalloff.y);\n#elif defined(LIGHT_FALLOFF_PHYSICAL{X})\npreInfo.attenuation=computeDistanceLightFalloff_Physical(preInfo.lightDistanceSquared);\n#elif defined(LIGHT_FALLOFF_STANDARD{X})\npreInfo.attenuation=computeDistanceLightFalloff_Standard(preInfo.lightOffset,light{X}.vLightFalloff.x);\n#else\npreInfo.attenuation=computeDistanceLightFalloff(preInfo.lightOffset,preInfo.lightDistanceSquared,light{X}.vLightFalloff.x,light{X}.vLightFalloff.y);\n#endif\n#else\npreInfo.attenuation=1.0;\n#endif\n#ifdef HEMILIGHT{X}\npreInfo.roughness=roughness;\n#else\npreInfo.roughness=adjustRoughnessFromLightProperties(roughness,light{X}.vLightSpecular.a,preInfo.lightDistance);\n#endif\n#ifdef IRIDESCENCE\npreInfo.iridescenceIntensity=iridescenceIntensity;\n#endif\n#ifdef HEMILIGHT{X}\ninfo.diffuse=computeHemisphericDiffuseLighting(preInfo,light{X}.vLightDiffuse.rgb,light{X}.vLightGround);\n#elif defined(SS_TRANSLUCENCY)\ninfo.diffuse=computeDiffuseAndTransmittedLighting(preInfo,light{X}.vLightDiffuse.rgb,subSurfaceOut.transmittance);\n#else\ninfo.diffuse=computeDiffuseLighting(preInfo,light{X}.vLightDiffuse.rgb);\n#endif\n#ifdef SPECULARTERM\n#ifdef ANISOTROPIC\ninfo.specular=computeAnisotropicSpecularLighting(preInfo,viewDirectionW,normalW,anisotropicOut.anisotropicTangent,anisotropicOut.anisotropicBitangent,anisotropicOut.anisotropy,clearcoatOut.specularEnvironmentR0,specularEnvironmentR90,AARoughnessFactors.x,light{X}.vLightDiffuse.rgb);\n#else\ninfo.specular=computeSpecularLighting(preInfo,normalW,clearcoatOut.specularEnvironmentR0,specularEnvironmentR90,AARoughnessFactors.x,light{X}.vLightDiffuse.rgb);\n#endif\n#endif\n#ifdef SHEEN\n#ifdef SHEEN_LINKWITHALBEDO\npreInfo.roughness=sheenOut.sheenIntensity;\n#else\n#ifdef HEMILIGHT{X}\npreInfo.roughness=sheenOut.sheenRoughness;\n#else\npreInfo.roughness=adjustRoughnessFromLightProperties(sheenOut.sheenRoughness,light{X}.vLightSpecular.a,preInfo.lightDistance);\n#endif\n#endif\ninfo.sheen=computeSheenLighting(preInfo,normalW,sheenOut.sheenColor,specularEnvironmentR90,AARoughnessFactors.x,light{X}.vLightDiffuse.rgb);\n#endif\n#ifdef CLEARCOAT\n#ifdef HEMILIGHT{X}\npreInfo.roughness=clearcoatOut.clearCoatRoughness;\n#else\npreInfo.roughness=adjustRoughnessFromLightProperties(clearcoatOut.clearCoatRoughness,light{X}.vLightSpecular.a,preInfo.lightDistance);\n#endif\ninfo.clearCoat=computeClearCoatLighting(preInfo,clearcoatOut.clearCoatNormalW,clearcoatOut.clearCoatAARoughnessFactors.x,clearcoatOut.clearCoatIntensity,light{X}.vLightDiffuse.rgb);\n#ifdef CLEARCOAT_TINT\nabsorption=computeClearCoatLightingAbsorption(clearcoatOut.clearCoatNdotVRefract,preInfo.L,clearcoatOut.clearCoatNormalW,clearcoatOut.clearCoatColor,clearcoatOut.clearCoatThickness,clearcoatOut.clearCoatIntensity);\ninfo.diffuse*=absorption;\n#ifdef SPECULARTERM\ninfo.specular*=absorption;\n#endif\n#endif\ninfo.diffuse*=info.clearCoat.w;\n#ifdef SPECULARTERM\ninfo.specular*=info.clearCoat.w;\n#endif\n#ifdef SHEEN\ninfo.sheen*=info.clearCoat.w;\n#endif\n#endif\n#else\n#ifdef SPOTLIGHT{X}\ninfo=computeSpotLighting(viewDirectionW,normalW,light{X}.vLightData,light{X}.vLightDirection,light{X}.vLightDiffuse.rgb,light{X}.vLightSpecular.rgb,light{X}.vLightDiffuse.a,glossiness);\n#elif defined(HEMILIGHT{X})\ninfo=computeHemisphericLighting(viewDirectionW,normalW,light{X}.vLightData,light{X}.vLightDiffuse.rgb,light{X}.vLightSpecular.rgb,light{X}.vLightGround,glossiness);\n#elif defined(POINTLIGHT{X}) || defined(DIRLIGHT{X})\ninfo=computeLighting(viewDirectionW,normalW,light{X}.vLightData,light{X}.vLightDiffuse.rgb,light{X}.vLightSpecular.rgb,light{X}.vLightDiffuse.a,glossiness);\n#endif\n#endif\n#ifdef PROJECTEDLIGHTTEXTURE{X}\ninfo.diffuse*=computeProjectionTextureDiffuseLighting(projectionLightSampler{X},textureProjectionMatrix{X});\n#endif\n#endif\n#ifdef SHADOW{X}\n#ifdef SHADOWCSM{X}\nfor (int i=0; i<SHADOWCSMNUM_CASCADES{X}; i++) \n{\n#ifdef SHADOWCSM_RIGHTHANDED{X}\ndiff{X}=viewFrustumZ{X}[i]+vPositionFromCamera{X}.z;\n#else\ndiff{X}=viewFrustumZ{X}[i]-vPositionFromCamera{X}.z;\n#endif\nif (diff{X}>=0.) {\nindex{X}=i;\nbreak;\n}\n}\n#ifdef SHADOWCSMUSESHADOWMAXZ{X}\nif (index{X}>=0)\n#endif\n{\n#if defined(SHADOWPCF{X})\n#if defined(SHADOWLOWQUALITY{X})\nshadow=computeShadowWithCSMPCF1(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],shadowSampler{X},light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);\n#elif defined(SHADOWMEDIUMQUALITY{X})\nshadow=computeShadowWithCSMPCF3(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],shadowSampler{X},light{X}.shadowsInfo.yz,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);\n#else\nshadow=computeShadowWithCSMPCF5(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],shadowSampler{X},light{X}.shadowsInfo.yz,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);\n#endif\n#elif defined(SHADOWPCSS{X})\n#if defined(SHADOWLOWQUALITY{X})\nshadow=computeShadowWithCSMPCSS16(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],depthSampler{X},shadowSampler{X},light{X}.shadowsInfo.y,light{X}.shadowsInfo.z,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w,lightSizeUVCorrection{X}[index{X}],depthCorrection{X}[index{X}],penumbraDarkness{X});\n#elif defined(SHADOWMEDIUMQUALITY{X})\nshadow=computeShadowWithCSMPCSS32(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],depthSampler{X},shadowSampler{X},light{X}.shadowsInfo.y,light{X}.shadowsInfo.z,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w,lightSizeUVCorrection{X}[index{X}],depthCorrection{X}[index{X}],penumbraDarkness{X});\n#else\nshadow=computeShadowWithCSMPCSS64(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],depthSampler{X},shadowSampler{X},light{X}.shadowsInfo.y,light{X}.shadowsInfo.z,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w,lightSizeUVCorrection{X}[index{X}],depthCorrection{X}[index{X}],penumbraDarkness{X});\n#endif\n#else\nshadow=computeShadowCSM(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],shadowSampler{X},light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);\n#endif\n#ifdef SHADOWCSMDEBUG{X}\nshadowDebug{X}=vec3(shadow)*vCascadeColorsMultiplier{X}[index{X}];\n#endif\n#ifndef SHADOWCSMNOBLEND{X}\nfloat frustumLength=frustumLengths{X}[index{X}];\nfloat diffRatio=clamp(diff{X}/frustumLength,0.,1.)*cascadeBlendFactor{X};\nif (index{X}<(SHADOWCSMNUM_CASCADES{X}-1) && diffRatio<1.)\n{\nindex{X}+=1;\nfloat nextShadow=0.;\n#if defined(SHADOWPCF{X})\n#if defined(SHADOWLOWQUALITY{X})\nnextShadow=computeShadowWithCSMPCF1(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],shadowSampler{X},light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);\n#elif defined(SHADOWMEDIUMQUALITY{X})\nnextShadow=computeShadowWithCSMPCF3(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],shadowSampler{X},light{X}.shadowsInfo.yz,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);\n#else\nnextShadow=computeShadowWithCSMPCF5(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],shadowSampler{X},light{X}.shadowsInfo.yz,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);\n#endif\n#elif defined(SHADOWPCSS{X})\n#if defined(SHADOWLOWQUALITY{X})\nnextShadow=computeShadowWithCSMPCSS16(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],depthSampler{X},shadowSampler{X},light{X}.shadowsInfo.y,light{X}.shadowsInfo.z,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w,lightSizeUVCorrection{X}[index{X}],depthCorrection{X}[index{X}],penumbraDarkness{X});\n#elif defined(SHADOWMEDIUMQUALITY{X})\nnextShadow=computeShadowWithCSMPCSS32(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],depthSampler{X},shadowSampler{X},light{X}.shadowsInfo.y,light{X}.shadowsInfo.z,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w,lightSizeUVCorrection{X}[index{X}],depthCorrection{X}[index{X}],penumbraDarkness{X});\n#else\nnextShadow=computeShadowWithCSMPCSS64(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],depthSampler{X},shadowSampler{X},light{X}.shadowsInfo.y,light{X}.shadowsInfo.z,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w,lightSizeUVCorrection{X}[index{X}],depthCorrection{X}[index{X}],penumbraDarkness{X});\n#endif\n#else\nnextShadow=computeShadowCSM(float(index{X}),vPositionFromLight{X}[index{X}],vDepthMetric{X}[index{X}],shadowSampler{X},light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);\n#endif\nshadow=mix(nextShadow,shadow,diffRatio);\n#ifdef SHADOWCSMDEBUG{X}\nshadowDebug{X}=mix(vec3(nextShadow)*vCascadeColorsMultiplier{X}[index{X}],shadowDebug{X},diffRatio);\n#endif\n}\n#endif\n}\n#elif defined(SHADOWCLOSEESM{X})\n#if defined(SHADOWCUBE{X})\nshadow=computeShadowWithCloseESMCube(light{X}.vLightData.xyz,shadowSampler{X},light{X}.shadowsInfo.x,light{X}.shadowsInfo.z,light{X}.depthValues);\n#else\nshadow=computeShadowWithCloseESM(vPositionFromLight{X},vDepthMetric{X},shadowSampler{X},light{X}.shadowsInfo.x,light{X}.shadowsInfo.z,light{X}.shadowsInfo.w);\n#endif\n#elif defined(SHADOWESM{X})\n#if defined(SHADOWCUBE{X})\nshadow=computeShadowWithESMCube(light{X}.vLightData.xyz,shadowSampler{X},light{X}.shadowsInfo.x,light{X}.shadowsInfo.z,light{X}.depthValues);\n#else\nshadow=computeShadowWithESM(vPositionFromLight{X},vDepthMetric{X},shadowSampler{X},light{X}.shadowsInfo.x,light{X}.shadowsInfo.z,light{X}.shadowsInfo.w);\n#endif\n#elif defined(SHADOWPOISSON{X})\n#if defined(SHADOWCUBE{X})\nshadow=computeShadowWithPoissonSamplingCube(light{X}.vLightData.xyz,shadowSampler{X},light{X}.shadowsInfo.y,light{X}.shadowsInfo.x,light{X}.depthValues);\n#else\nshadow=computeShadowWithPoissonSampling(vPositionFromLight{X},vDepthMetric{X},shadowSampler{X},light{X}.shadowsInfo.y,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);\n#endif\n#elif defined(SHADOWPCF{X})\n#if defined(SHADOWLOWQUALITY{X})\nshadow=computeShadowWithPCF1(vPositionFromLight{X},vDepthMetric{X},shadowSampler{X},light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);\n#elif defined(SHADOWMEDIUMQUALITY{X})\nshadow=computeShadowWithPCF3(vPositionFromLight{X},vDepthMetric{X},shadowSampler{X},light{X}.shadowsInfo.yz,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);\n#else\nshadow=computeShadowWithPCF5(vPositionFromLight{X},vDepthMetric{X},shadowSampler{X},light{X}.shadowsInfo.yz,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);\n#endif\n#elif defined(SHADOWPCSS{X})\n#if defined(SHADOWLOWQUALITY{X})\nshadow=computeShadowWithPCSS16(vPositionFromLight{X},vDepthMetric{X},depthSampler{X},shadowSampler{X},light{X}.shadowsInfo.y,light{X}.shadowsInfo.z,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);\n#elif defined(SHADOWMEDIUMQUALITY{X})\nshadow=computeShadowWithPCSS32(vPositionFromLight{X},vDepthMetric{X},depthSampler{X},shadowSampler{X},light{X}.shadowsInfo.y,light{X}.shadowsInfo.z,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);\n#else\nshadow=computeShadowWithPCSS64(vPositionFromLight{X},vDepthMetric{X},depthSampler{X},shadowSampler{X},light{X}.shadowsInfo.y,light{X}.shadowsInfo.z,light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);\n#endif\n#else\n#if defined(SHADOWCUBE{X})\nshadow=computeShadowCube(light{X}.vLightData.xyz,shadowSampler{X},light{X}.shadowsInfo.x,light{X}.depthValues);\n#else\nshadow=computeShadow(vPositionFromLight{X},vDepthMetric{X},shadowSampler{X},light{X}.shadowsInfo.x,light{X}.shadowsInfo.w);\n#endif\n#endif\n#ifdef SHADOWONLY\n#ifndef SHADOWINUSE\n#define SHADOWINUSE\n#endif\nglobalShadow+=shadow;\nshadowLightCount+=1.0;\n#endif\n#else\nshadow=1.;\n#endif\n#ifndef SHADOWONLY\n#ifdef CUSTOMUSERLIGHTING\ndiffuseBase+=computeCustomDiffuseLighting(info,diffuseBase,shadow);\n#ifdef SPECULARTERM\nspecularBase+=computeCustomSpecularLighting(info,specularBase,shadow);\n#endif\n#elif defined(LIGHTMAP) && defined(LIGHTMAPEXCLUDED{X})\ndiffuseBase+=lightmapColor.rgb*shadow;\n#ifdef SPECULARTERM\n#ifndef LIGHTMAPNOSPECULAR{X}\nspecularBase+=info.specular*shadow*lightmapColor.rgb;\n#endif\n#endif\n#ifdef CLEARCOAT\n#ifndef LIGHTMAPNOSPECULAR{X}\nclearCoatBase+=info.clearCoat.rgb*shadow*lightmapColor.rgb;\n#endif\n#endif\n#ifdef SHEEN\n#ifndef LIGHTMAPNOSPECULAR{X}\nsheenBase+=info.sheen.rgb*shadow;\n#endif\n#endif\n#else\n#ifdef SHADOWCSMDEBUG{X}\ndiffuseBase+=info.diffuse*shadowDebug{X};\n#else \ndiffuseBase+=info.diffuse*shadow;\n#endif\n#ifdef SPECULARTERM\nspecularBase+=info.specular*shadow;\n#endif\n#ifdef CLEARCOAT\nclearCoatBase+=info.clearCoat.rgb*shadow;\n#endif\n#ifdef SHEEN\nsheenBase+=info.sheen.rgb*shadow;\n#endif\n#endif\n#endif\n#endif\n";Ve.v.IncludesShadersStore.lightFragment=ft;var dt="#ifdef LOGARITHMICDEPTH\ngl_FragDepthEXT=log2(vFragmentDepth)*logarithmicDepthConstant*0.5;\n#endif\n";Ve.v.IncludesShadersStore.logDepthFragment=dt;var pt="#ifdef FOG\nfloat fog=CalcFogFactor();\n#ifdef PBR\nfog=toLinearSpace(fog);\n#endif\ncolor.rgb=mix(vFogColor,color.rgb,fog);\n#endif\n";Ve.v.IncludesShadersStore.fogFragment=pt;var vt="#ifdef ORDER_INDEPENDENT_TRANSPARENCY\nfloat fragDepth=gl_FragCoord.z; \n#ifdef ORDER_INDEPENDENT_TRANSPARENCY_16BITS\nuint halfFloat=packHalf2x16(vec2(fragDepth));\nvec2 full=unpackHalf2x16(halfFloat);\nfragDepth=full.x;\n#endif\nivec2 fragCoord=ivec2(gl_FragCoord.xy);\nvec2 lastDepth=texelFetch(oitDepthSampler,fragCoord,0).rg;\nvec4 lastFrontColor=texelFetch(oitFrontColorSampler,fragCoord,0);\ndepth.rg=vec2(-MAX_DEPTH);\nfrontColor=lastFrontColor;\nbackColor=vec4(0.0);\n#ifdef USE_REVERSE_DEPTHBUFFER\nfloat furthestDepth=-lastDepth.x;\nfloat nearestDepth=lastDepth.y;\n#else\nfloat nearestDepth=-lastDepth.x;\nfloat furthestDepth=lastDepth.y;\n#endif\nfloat alphaMultiplier=1.0-lastFrontColor.a;\n#ifdef USE_REVERSE_DEPTHBUFFER\nif (fragDepth>nearestDepth || fragDepth<furthestDepth) {\n#else\nif (fragDepth<nearestDepth || fragDepth>furthestDepth) {\n#endif\nreturn;\n}\n#ifdef USE_REVERSE_DEPTHBUFFER\nif (fragDepth<nearestDepth && fragDepth>furthestDepth) {\n#else\nif (fragDepth>nearestDepth && fragDepth<furthestDepth) {\n#endif\ndepth.rg=vec2(-fragDepth,fragDepth);\nreturn;\n}\n#endif\n";Ve.v.IncludesShadersStore.oitFragment=vt;var mt="#include<__decl__defaultFragment>\n#if defined(BUMP) || !defined(NORMAL)\n#extension GL_OES_standard_derivatives : enable\n#endif\n#include<prePassDeclaration>[SCENE_MRT_COUNT]\n#include<oitDeclaration>\n#define CUSTOM_FRAGMENT_BEGIN\n#ifdef LOGARITHMICDEPTH\n#extension GL_EXT_frag_depth : enable\n#endif\n#define RECIPROCAL_PI2 0.15915494\nvarying vec3 vPositionW;\n#ifdef NORMAL\nvarying vec3 vNormalW;\n#endif\n#if defined(VERTEXCOLOR) || defined(INSTANCESCOLOR)\nvarying vec4 vColor;\n#endif\n#include<mainUVVaryingDeclaration>[1..7]\n#include<helperFunctions>\n#include<__decl__lightFragment>[0..maxSimultaneousLights]\n#include<lightsFragmentFunctions>\n#include<shadowsFragmentFunctions>\n#include<samplerFragmentDeclaration>(_DEFINENAME_,DIFFUSE,_VARYINGNAME_,Diffuse,_SAMPLERNAME_,diffuse)\n#include<samplerFragmentDeclaration>(_DEFINENAME_,AMBIENT,_VARYINGNAME_,Ambient,_SAMPLERNAME_,ambient)\n#include<samplerFragmentDeclaration>(_DEFINENAME_,OPACITY,_VARYINGNAME_,Opacity,_SAMPLERNAME_,opacity)\n#include<samplerFragmentDeclaration>(_DEFINENAME_,EMISSIVE,_VARYINGNAME_,Emissive,_SAMPLERNAME_,emissive)\n#include<samplerFragmentDeclaration>(_DEFINENAME_,LIGHTMAP,_VARYINGNAME_,Lightmap,_SAMPLERNAME_,lightmap)\n#ifdef REFRACTION\n#ifdef REFRACTIONMAP_3D\nuniform samplerCube refractionCubeSampler;\n#else\nuniform sampler2D refraction2DSampler;\n#endif\n#endif\n#if defined(SPECULARTERM)\n#include<samplerFragmentDeclaration>(_DEFINENAME_,SPECULAR,_VARYINGNAME_,Specular,_SAMPLERNAME_,specular)\n#endif\n#include<fresnelFunction>\n#ifdef REFLECTION\n#ifdef REFLECTIONMAP_3D\nuniform samplerCube reflectionCubeSampler;\n#else\nuniform sampler2D reflection2DSampler;\n#endif\n#ifdef REFLECTIONMAP_SKYBOX\nvarying vec3 vPositionUVW;\n#else\n#if defined(REFLECTIONMAP_EQUIRECTANGULAR_FIXED) || defined(REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED)\nvarying vec3 vDirectionW;\n#endif\n#endif\n#include<reflectionFunction>\n#endif\n#include<imageProcessingDeclaration>\n#include<imageProcessingFunctions>\n#include<bumpFragmentMainFunctions>\n#include<bumpFragmentFunctions>\n#include<clipPlaneFragmentDeclaration>\n#include<logDepthDeclaration>\n#include<fogFragmentDeclaration>\n#define CUSTOM_FRAGMENT_DEFINITIONS\nvoid main(void) {\n#define CUSTOM_FRAGMENT_MAIN_BEGIN\n#include<clipPlaneFragment>\nvec3 viewDirectionW=normalize(vEyePosition.xyz-vPositionW);\nvec4 baseColor=vec4(1.,1.,1.,1.);\nvec3 diffuseColor=vDiffuseColor.rgb;\nfloat alpha=vDiffuseColor.a;\n#ifdef NORMAL\nvec3 normalW=normalize(vNormalW);\n#else\nvec3 normalW=normalize(-cross(dFdx(vPositionW),dFdy(vPositionW)));\n#endif\n#include<bumpFragment>\n#ifdef TWOSIDEDLIGHTING\nnormalW=gl_FrontFacing ? normalW : -normalW;\n#endif\n#ifdef DIFFUSE\nbaseColor=texture2D(diffuseSampler,vDiffuseUV+uvOffset);\n#if defined(ALPHATEST) && !defined(ALPHATEST_AFTERALLALPHACOMPUTATIONS)\nif (baseColor.a<alphaCutOff)\ndiscard;\n#endif\n#ifdef ALPHAFROMDIFFUSE\nalpha*=baseColor.a;\n#endif\n#define CUSTOM_FRAGMENT_UPDATE_ALPHA\nbaseColor.rgb*=vDiffuseInfos.y;\n#endif\n#include<depthPrePass>\n#if defined(VERTEXCOLOR) || defined(INSTANCESCOLOR)\nbaseColor.rgb*=vColor.rgb;\n#endif\n#ifdef DETAIL\nbaseColor.rgb=baseColor.rgb*2.0*mix(0.5,detailColor.r,vDetailInfos.y);\n#endif\n#define CUSTOM_FRAGMENT_UPDATE_DIFFUSE\nvec3 baseAmbientColor=vec3(1.,1.,1.);\n#ifdef AMBIENT\nbaseAmbientColor=texture2D(ambientSampler,vAmbientUV+uvOffset).rgb*vAmbientInfos.y;\n#endif\n#define CUSTOM_FRAGMENT_BEFORE_LIGHTS\n#ifdef SPECULARTERM\nfloat glossiness=vSpecularColor.a;\nvec3 specularColor=vSpecularColor.rgb;\n#ifdef SPECULAR\nvec4 specularMapColor=texture2D(specularSampler,vSpecularUV+uvOffset);\nspecularColor=specularMapColor.rgb;\n#ifdef GLOSSINESS\nglossiness=glossiness*specularMapColor.a;\n#endif\n#endif\n#else\nfloat glossiness=0.;\n#endif\nvec3 diffuseBase=vec3(0.,0.,0.);\nlightingInfo info;\n#ifdef SPECULARTERM\nvec3 specularBase=vec3(0.,0.,0.);\n#endif\nfloat shadow=1.;\n#ifdef LIGHTMAP\nvec4 lightmapColor=texture2D(lightmapSampler,vLightmapUV+uvOffset);\n#ifdef RGBDLIGHTMAP\nlightmapColor.rgb=fromRGBD(lightmapColor);\n#endif\nlightmapColor.rgb*=vLightmapInfos.y;\n#endif\n#include<lightFragment>[0..maxSimultaneousLights]\nvec4 refractionColor=vec4(0.,0.,0.,1.);\n#ifdef REFRACTION\nvec3 refractionVector=normalize(refract(-viewDirectionW,normalW,vRefractionInfos.y));\n#ifdef REFRACTIONMAP_3D\n#ifdef USE_LOCAL_REFRACTIONMAP_CUBIC\nrefractionVector=parallaxCorrectNormal(vPositionW,refractionVector,vRefractionSize,vRefractionPosition);\n#endif\nrefractionVector.y=refractionVector.y*vRefractionInfos.w;\nif (dot(refractionVector,viewDirectionW)<1.0) {\nrefractionColor=textureCube(refractionCubeSampler,refractionVector);\n}\n#else\nvec3 vRefractionUVW=vec3(refractionMatrix*(view*vec4(vPositionW+refractionVector*vRefractionInfos.z,1.0)));\nvec2 refractionCoords=vRefractionUVW.xy/vRefractionUVW.z;\nrefractionCoords.y=1.0-refractionCoords.y;\nrefractionColor=texture2D(refraction2DSampler,refractionCoords);\n#endif\n#ifdef RGBDREFRACTION\nrefractionColor.rgb=fromRGBD(refractionColor);\n#endif\n#ifdef IS_REFRACTION_LINEAR\nrefractionColor.rgb=toGammaSpace(refractionColor.rgb);\n#endif\nrefractionColor.rgb*=vRefractionInfos.x;\n#endif\nvec4 reflectionColor=vec4(0.,0.,0.,1.);\n#ifdef REFLECTION\nvec3 vReflectionUVW=computeReflectionCoords(vec4(vPositionW,1.0),normalW);\n#ifdef REFLECTIONMAP_OPPOSITEZ\nvReflectionUVW.z*=-1.0;\n#endif\n#ifdef REFLECTIONMAP_3D\n#ifdef ROUGHNESS\nfloat bias=vReflectionInfos.y;\n#ifdef SPECULARTERM\n#ifdef SPECULAR\n#ifdef GLOSSINESS\nbias*=(1.0-specularMapColor.a);\n#endif\n#endif\n#endif\nreflectionColor=textureCube(reflectionCubeSampler,vReflectionUVW,bias);\n#else\nreflectionColor=textureCube(reflectionCubeSampler,vReflectionUVW);\n#endif\n#else\nvec2 coords=vReflectionUVW.xy;\n#ifdef REFLECTIONMAP_PROJECTION\ncoords/=vReflectionUVW.z;\n#endif\ncoords.y=1.0-coords.y;\nreflectionColor=texture2D(reflection2DSampler,coords);\n#endif\n#ifdef RGBDREFLECTION\nreflectionColor.rgb=fromRGBD(reflectionColor);\n#endif\n#ifdef IS_REFLECTION_LINEAR\nreflectionColor.rgb=toGammaSpace(reflectionColor.rgb);\n#endif\nreflectionColor.rgb*=vReflectionInfos.x;\n#ifdef REFLECTIONFRESNEL\nfloat reflectionFresnelTerm=computeFresnelTerm(viewDirectionW,normalW,reflectionRightColor.a,reflectionLeftColor.a);\n#ifdef REFLECTIONFRESNELFROMSPECULAR\n#ifdef SPECULARTERM\nreflectionColor.rgb*=specularColor.rgb*(1.0-reflectionFresnelTerm)+reflectionFresnelTerm*reflectionRightColor.rgb;\n#else\nreflectionColor.rgb*=reflectionLeftColor.rgb*(1.0-reflectionFresnelTerm)+reflectionFresnelTerm*reflectionRightColor.rgb;\n#endif\n#else\nreflectionColor.rgb*=reflectionLeftColor.rgb*(1.0-reflectionFresnelTerm)+reflectionFresnelTerm*reflectionRightColor.rgb;\n#endif\n#endif\n#endif\n#ifdef REFRACTIONFRESNEL\nfloat refractionFresnelTerm=computeFresnelTerm(viewDirectionW,normalW,refractionRightColor.a,refractionLeftColor.a);\nrefractionColor.rgb*=refractionLeftColor.rgb*(1.0-refractionFresnelTerm)+refractionFresnelTerm*refractionRightColor.rgb;\n#endif\n#ifdef OPACITY\nvec4 opacityMap=texture2D(opacitySampler,vOpacityUV+uvOffset);\n#ifdef OPACITYRGB\nopacityMap.rgb=opacityMap.rgb*vec3(0.3,0.59,0.11);\nalpha*=(opacityMap.x+opacityMap.y+opacityMap.z)* vOpacityInfos.y;\n#else\nalpha*=opacityMap.a*vOpacityInfos.y;\n#endif\n#endif\n#if defined(VERTEXALPHA) || defined(INSTANCESCOLOR)\nalpha*=vColor.a;\n#endif\n#ifdef OPACITYFRESNEL\nfloat opacityFresnelTerm=computeFresnelTerm(viewDirectionW,normalW,opacityParts.z,opacityParts.w);\nalpha+=opacityParts.x*(1.0-opacityFresnelTerm)+opacityFresnelTerm*opacityParts.y;\n#endif\n#ifdef ALPHATEST\n#ifdef ALPHATEST_AFTERALLALPHACOMPUTATIONS\nif (alpha<alphaCutOff)\ndiscard;\n#endif\n#ifndef ALPHABLEND\nalpha=1.0;\n#endif\n#endif\nvec3 emissiveColor=vEmissiveColor;\n#ifdef EMISSIVE\nemissiveColor+=texture2D(emissiveSampler,vEmissiveUV+uvOffset).rgb*vEmissiveInfos.y;\n#endif\n#ifdef EMISSIVEFRESNEL\nfloat emissiveFresnelTerm=computeFresnelTerm(viewDirectionW,normalW,emissiveRightColor.a,emissiveLeftColor.a);\nemissiveColor*=emissiveLeftColor.rgb*(1.0-emissiveFresnelTerm)+emissiveFresnelTerm*emissiveRightColor.rgb;\n#endif\n#ifdef DIFFUSEFRESNEL\nfloat diffuseFresnelTerm=computeFresnelTerm(viewDirectionW,normalW,diffuseRightColor.a,diffuseLeftColor.a);\ndiffuseBase*=diffuseLeftColor.rgb*(1.0-diffuseFresnelTerm)+diffuseFresnelTerm*diffuseRightColor.rgb;\n#endif\n#ifdef EMISSIVEASILLUMINATION\nvec3 finalDiffuse=clamp(diffuseBase*diffuseColor+vAmbientColor,0.0,1.0)*baseColor.rgb;\n#else\n#ifdef LINKEMISSIVEWITHDIFFUSE\nvec3 finalDiffuse=clamp((diffuseBase+emissiveColor)*diffuseColor+vAmbientColor,0.0,1.0)*baseColor.rgb;\n#else\nvec3 finalDiffuse=clamp(diffuseBase*diffuseColor+emissiveColor+vAmbientColor,0.0,1.0)*baseColor.rgb;\n#endif\n#endif\n#ifdef SPECULARTERM\nvec3 finalSpecular=specularBase*specularColor;\n#ifdef SPECULAROVERALPHA\nalpha=clamp(alpha+dot(finalSpecular,vec3(0.3,0.59,0.11)),0.,1.);\n#endif\n#else\nvec3 finalSpecular=vec3(0.0);\n#endif\n#ifdef REFLECTIONOVERALPHA\nalpha=clamp(alpha+dot(reflectionColor.rgb,vec3(0.3,0.59,0.11)),0.,1.);\n#endif\n#ifdef EMISSIVEASILLUMINATION\nvec4 color=vec4(clamp(finalDiffuse*baseAmbientColor+finalSpecular+reflectionColor.rgb+emissiveColor+refractionColor.rgb,0.0,1.0),alpha);\n#else\nvec4 color=vec4(finalDiffuse*baseAmbientColor+finalSpecular+reflectionColor.rgb+refractionColor.rgb,alpha);\n#endif\n#ifdef LIGHTMAP\n#ifndef LIGHTMAPEXCLUDED\n#ifdef USELIGHTMAPASSHADOWMAP\ncolor.rgb*=lightmapColor.rgb;\n#else\ncolor.rgb+=lightmapColor.rgb;\n#endif\n#endif\n#endif\n#define CUSTOM_FRAGMENT_BEFORE_FOG\ncolor.rgb=max(color.rgb,0.);\n#include<logDepthFragment>\n#include<fogFragment>\n#ifdef IMAGEPROCESSINGPOSTPROCESS\ncolor.rgb=toLinearSpace(color.rgb);\n#else\n#ifdef IMAGEPROCESSING\ncolor.rgb=toLinearSpace(color.rgb);\ncolor=applyImageProcessing(color);\n#endif\n#endif\ncolor.a*=visibility;\n#ifdef PREMULTIPLYALPHA\ncolor.rgb*=color.a;\n#endif\n#define CUSTOM_FRAGMENT_BEFORE_FRAGCOLOR\n#ifdef PREPASS\nfloat writeGeometryInfo=color.a>0.4 ? 1.0 : 0.0;\ngl_FragData[0]=color; \n#ifdef PREPASS_POSITION\ngl_FragData[PREPASS_POSITION_INDEX]=vec4(vPositionW,writeGeometryInfo);\n#endif\n#ifdef PREPASS_VELOCITY\nvec2 a=(vCurrentPosition.xy/vCurrentPosition.w)*0.5+0.5;\nvec2 b=(vPreviousPosition.xy/vPreviousPosition.w)*0.5+0.5;\nvec2 velocity=abs(a-b);\nvelocity=vec2(pow(velocity.x,1.0/3.0),pow(velocity.y,1.0/3.0))*sign(a-b)*0.5+0.5;\ngl_FragData[PREPASS_VELOCITY_INDEX]=vec4(velocity,0.0,writeGeometryInfo);\n#endif\n#ifdef PREPASS_IRRADIANCE\ngl_FragData[PREPASS_IRRADIANCE_INDEX]=vec4(0.0,0.0,0.0,writeGeometryInfo); \n#endif\n#ifdef PREPASS_DEPTH\ngl_FragData[PREPASS_DEPTH_INDEX]=vec4(vViewPos.z,0.0,0.0,writeGeometryInfo); \n#endif\n#ifdef PREPASS_NORMAL\ngl_FragData[PREPASS_NORMAL_INDEX]=vec4((view*vec4(normalW,0.0)).rgb,writeGeometryInfo); \n#endif\n#ifdef PREPASS_ALBEDO_SQRT\ngl_FragData[PREPASS_ALBEDO_SQRT_INDEX]=vec4(0.0,0.0,0.0,writeGeometryInfo); \n#endif\n#ifdef PREPASS_REFLECTIVITY\n#if defined(SPECULARTERM)\n#if defined(SPECULAR)\ngl_FragData[PREPASS_REFLECTIVITY_INDEX]=vec4(specularMapColor)*writeGeometryInfo; \n#else\ngl_FragData[PREPASS_REFLECTIVITY_INDEX]=vec4(specularColor,1.0)*writeGeometryInfo;\n#endif\n#else\ngl_FragData[PREPASS_REFLECTIVITY_INDEX]=vec4(0.0,0.0,0.0,1.0)*writeGeometryInfo;\n#endif\n#endif\n#endif\n#if !defined(PREPASS) || defined(WEBGL2)\ngl_FragColor=color;\n#endif\n#include<oitFragment>\n#if ORDER_INDEPENDENT_TRANSPARENCY\nif (fragDepth==nearestDepth) {\nfrontColor.rgb+=color.rgb*color.a*alphaMultiplier;\nfrontColor.a=1.0-alphaMultiplier*(1.0-color.a);\n} else {\nbackColor+=color;\n}\n#endif\n#define CUSTOM_FRAGMENT_MAIN_END\n}\n";Ve.v.ShadersStore.defaultPixelShader=mt;var gt="uniform mat4 viewProjection;\nuniform mat4 view;\n#ifdef DIFFUSE\nuniform mat4 diffuseMatrix;\nuniform vec2 vDiffuseInfos;\n#endif\n#ifdef AMBIENT\nuniform mat4 ambientMatrix;\nuniform vec2 vAmbientInfos;\n#endif\n#ifdef OPACITY\nuniform mat4 opacityMatrix;\nuniform vec2 vOpacityInfos;\n#endif\n#ifdef EMISSIVE\nuniform vec2 vEmissiveInfos;\nuniform mat4 emissiveMatrix;\n#endif\n#ifdef LIGHTMAP\nuniform vec2 vLightmapInfos;\nuniform mat4 lightmapMatrix;\n#endif\n#if defined(SPECULAR) && defined(SPECULARTERM)\nuniform vec2 vSpecularInfos;\nuniform mat4 specularMatrix;\n#endif\n#ifdef BUMP\nuniform vec3 vBumpInfos;\nuniform mat4 bumpMatrix;\n#endif\n#ifdef REFLECTION\nuniform mat4 reflectionMatrix;\n#endif\n#ifdef POINTSIZE\nuniform float pointSize;\n#endif\n#ifdef DETAIL\nuniform vec4 vDetailInfos;\nuniform mat4 detailMatrix;\n#endif\n#define ADDITIONAL_VERTEX_DECLARATION\n";Ve.v.IncludesShadersStore.defaultVertexDeclaration=gt;var _t="#ifdef UV{X}\nattribute vec2 uv{X};\n#endif\n";Ve.v.IncludesShadersStore.uvAttributeDeclaration=_t;var yt="#if NUM_BONE_INFLUENCERS>0\nattribute vec4 matricesIndices;\nattribute vec4 matricesWeights;\n#if NUM_BONE_INFLUENCERS>4\nattribute vec4 matricesIndicesExtra;\nattribute vec4 matricesWeightsExtra;\n#endif\n#ifndef BAKED_VERTEX_ANIMATION_TEXTURE\n#ifdef BONETEXTURE\nuniform sampler2D boneSampler;\nuniform float boneTextureWidth;\n#else\nuniform mat4 mBones[BonesPerMesh];\n#ifdef BONES_VELOCITY_ENABLED\nuniform mat4 mPreviousBones[BonesPerMesh];\n#endif\n#endif\n#ifdef BONETEXTURE\n#define inline\nmat4 readMatrixFromRawSampler(sampler2D smp,float index)\n{\nfloat offset=index *4.0;\nfloat dx=1.0/boneTextureWidth;\nvec4 m0=texture2D(smp,vec2(dx*(offset+0.5),0.));\nvec4 m1=texture2D(smp,vec2(dx*(offset+1.5),0.));\nvec4 m2=texture2D(smp,vec2(dx*(offset+2.5),0.));\nvec4 m3=texture2D(smp,vec2(dx*(offset+3.5),0.));\nreturn mat4(m0,m1,m2,m3);\n}\n#endif\n#endif\n#endif\n";Ve.v.IncludesShadersStore.bonesDeclaration=yt;var Et="#ifdef BAKED_VERTEX_ANIMATION_TEXTURE\nuniform float bakedVertexAnimationTime;\nuniform vec2 bakedVertexAnimationTextureSizeInverted;\nuniform vec4 bakedVertexAnimationSettings;\nuniform sampler2D bakedVertexAnimationTexture;\n#ifdef INSTANCES\nattribute vec4 bakedVertexAnimationSettingsInstanced;\n#endif\n#define inline\nmat4 readMatrixFromRawSamplerVAT(sampler2D smp,float index,float frame)\n{\nfloat offset=index*4.0;\nfloat frameUV=(frame+0.5)*bakedVertexAnimationTextureSizeInverted.y;\nfloat dx=bakedVertexAnimationTextureSizeInverted.x;\nvec4 m0=texture2D(smp,vec2(dx*(offset+0.5),frameUV));\nvec4 m1=texture2D(smp,vec2(dx*(offset+1.5),frameUV));\nvec4 m2=texture2D(smp,vec2(dx*(offset+2.5),frameUV));\nvec4 m3=texture2D(smp,vec2(dx*(offset+3.5),frameUV));\nreturn mat4(m0,m1,m2,m3);\n}\n#endif\n";Ve.v.IncludesShadersStore.bakedVertexAnimationDeclaration=Et;var At="#ifdef INSTANCES\nattribute vec4 world0;\nattribute vec4 world1;\nattribute vec4 world2;\nattribute vec4 world3;\n#ifdef INSTANCESCOLOR\nattribute vec4 instanceColor;\n#endif\n#if defined(THIN_INSTANCES) && !defined(WORLD_UBO)\nuniform mat4 world;\n#endif\n#if defined(VELOCITY) || defined(PREPASS_VELOCITY)\nattribute vec4 previousWorld0;\nattribute vec4 previousWorld1;\nattribute vec4 previousWorld2;\nattribute vec4 previousWorld3;\n#ifdef THIN_INSTANCES\nuniform mat4 previousWorld;\n#endif\n#endif\n#else\n#if !defined(WORLD_UBO)\nuniform mat4 world;\n#endif\n#if defined(VELOCITY) || defined(PREPASS_VELOCITY)\nuniform mat4 previousWorld;\n#endif\n#endif\n";Ve.v.IncludesShadersStore.instancesDeclaration=At;var bt="#ifdef PREPASS\n#ifdef PREPASS_DEPTH\nvarying vec3 vViewPos;\n#endif\n#ifdef PREPASS_VELOCITY\nuniform mat4 previousViewProjection;\nvarying vec4 vCurrentPosition;\nvarying vec4 vPreviousPosition;\n#endif\n#endif\n";Ve.v.IncludesShadersStore.prePassVertexDeclaration=bt;var Tt="#if defined(_DEFINENAME_) && _DEFINENAME_DIRECTUV==0\nvarying vec2 v_VARYINGNAME_UV;\n#endif\n";Ve.v.IncludesShadersStore.samplerVertexDeclaration=Tt;var Mt="#if defined(BUMP) || defined(PARALLAX) || defined(CLEARCOAT_BUMP) || defined(ANISOTROPIC)\n#if defined(TANGENT) && defined(NORMAL) \nvarying mat3 vTBN;\n#endif\n#endif\n";Ve.v.IncludesShadersStore.bumpVertexDeclaration=Mt;var St="#ifdef CLIPPLANE\nuniform vec4 vClipPlane;\nvarying float fClipDistance;\n#endif\n#ifdef CLIPPLANE2\nuniform vec4 vClipPlane2;\nvarying float fClipDistance2;\n#endif\n#ifdef CLIPPLANE3\nuniform vec4 vClipPlane3;\nvarying float fClipDistance3;\n#endif\n#ifdef CLIPPLANE4\nuniform vec4 vClipPlane4;\nvarying float fClipDistance4;\n#endif\n#ifdef CLIPPLANE5\nuniform vec4 vClipPlane5;\nvarying float fClipDistance5;\n#endif\n#ifdef CLIPPLANE6\nuniform vec4 vClipPlane6;\nvarying float fClipDistance6;\n#endif\n";Ve.v.IncludesShadersStore.clipPlaneVertexDeclaration=St;var It="#ifdef FOG\nvarying vec3 vFogDistance;\n#endif\n";Ve.v.IncludesShadersStore.fogVertexDeclaration=It;var xt="#ifdef LIGHT{X}\nuniform vec4 vLightData{X};\nuniform vec4 vLightDiffuse{X};\n#ifdef SPECULARTERM\nuniform vec4 vLightSpecular{X};\n#else\nvec4 vLightSpecular{X}=vec4(0.);\n#endif\n#ifdef SHADOW{X}\n#ifdef SHADOWCSM{X}\nuniform mat4 lightMatrix{X}[SHADOWCSMNUM_CASCADES{X}];\nvarying vec4 vPositionFromLight{X}[SHADOWCSMNUM_CASCADES{X}];\nvarying float vDepthMetric{X}[SHADOWCSMNUM_CASCADES{X}];\nvarying vec4 vPositionFromCamera{X};\n#elif defined(SHADOWCUBE{X})\n#else\nvarying vec4 vPositionFromLight{X};\nvarying float vDepthMetric{X};\nuniform mat4 lightMatrix{X};\n#endif\nuniform vec4 shadowsInfo{X};\nuniform vec2 depthValues{X};\n#endif\n#ifdef SPOTLIGHT{X}\nuniform vec4 vLightDirection{X};\nuniform vec4 vLightFalloff{X};\n#elif defined(POINTLIGHT{X})\nuniform vec4 vLightFalloff{X};\n#elif defined(HEMILIGHT{X})\nuniform vec3 vLightGround{X};\n#endif\n#endif\n";Ve.v.IncludesShadersStore.lightVxFragmentDeclaration=xt;var Ct="#ifdef LIGHT{X}\nuniform Light{X}\n{\nvec4 vLightData;\nvec4 vLightDiffuse;\nvec4 vLightSpecular;\n#ifdef SPOTLIGHT{X}\nvec4 vLightDirection;\nvec4 vLightFalloff;\n#elif defined(POINTLIGHT{X})\nvec4 vLightFalloff;\n#elif defined(HEMILIGHT{X})\nvec3 vLightGround;\n#endif\nvec4 shadowsInfo;\nvec2 depthValues;\n} light{X};\n#ifdef SHADOW{X}\n#ifdef SHADOWCSM{X}\nuniform mat4 lightMatrix{X}[SHADOWCSMNUM_CASCADES{X}];\nvarying vec4 vPositionFromLight{X}[SHADOWCSMNUM_CASCADES{X}];\nvarying float vDepthMetric{X}[SHADOWCSMNUM_CASCADES{X}];\nvarying vec4 vPositionFromCamera{X};\n#elif defined(SHADOWCUBE{X})\n#else\nvarying vec4 vPositionFromLight{X};\nvarying float vDepthMetric{X};\nuniform mat4 lightMatrix{X};\n#endif\n#endif\n#endif\n";Ve.v.IncludesShadersStore.lightVxUboDeclaration=Ct;var Pt="#ifdef MORPHTARGETS\nuniform float morphTargetInfluences[NUM_MORPH_INFLUENCERS];\n#ifdef MORPHTARGETS_TEXTURE \nprecision mediump sampler2DArray; \nuniform float morphTargetTextureIndices[NUM_MORPH_INFLUENCERS];\nuniform vec3 morphTargetTextureInfo;\nuniform sampler2DArray morphTargets;\nvec3 readVector3FromRawSampler(int targetIndex,float vertexIndex)\n{ \nfloat y=floor(vertexIndex/morphTargetTextureInfo.y);\nfloat x=vertexIndex-y*morphTargetTextureInfo.y;\nvec3 textureUV=vec3((x+0.5)/morphTargetTextureInfo.y,(y+0.5)/morphTargetTextureInfo.z,morphTargetTextureIndices[targetIndex]);\nreturn texture(morphTargets,textureUV).xyz;\n}\n#endif\n#endif\n";Ve.v.IncludesShadersStore.morphTargetsVertexGlobalDeclaration=Pt;var Dt="#ifdef MORPHTARGETS\n#ifndef MORPHTARGETS_TEXTURE\nattribute vec3 position{X};\n#ifdef MORPHTARGETS_NORMAL\nattribute vec3 normal{X};\n#endif\n#ifdef MORPHTARGETS_TANGENT\nattribute vec3 tangent{X};\n#endif\n#ifdef MORPHTARGETS_UV\nattribute vec2 uv_{X};\n#endif\n#endif\n#endif\n";Ve.v.IncludesShadersStore.morphTargetsVertexDeclaration=Dt;var Rt="#ifdef MORPHTARGETS\n#ifdef MORPHTARGETS_TEXTURE\nfloat vertexID;\n#endif\n#endif\n";Ve.v.IncludesShadersStore.morphTargetsVertexGlobal=Rt;var kt="#ifdef MORPHTARGETS\n#ifdef MORPHTARGETS_TEXTURE \nvertexID=float(gl_VertexID)*morphTargetTextureInfo.x;\npositionUpdated+=(readVector3FromRawSampler({X},vertexID)-position)*morphTargetInfluences[{X}];\nvertexID+=1.0;\n#ifdef MORPHTARGETS_NORMAL\nnormalUpdated+=(readVector3FromRawSampler({X},vertexID) -normal)*morphTargetInfluences[{X}];\nvertexID+=1.0;\n#endif\n#ifdef MORPHTARGETS_UV\nuvUpdated+=(readVector3FromRawSampler({X},vertexID).xy-uv)*morphTargetInfluences[{X}];\nvertexID+=1.0;\n#endif\n#ifdef MORPHTARGETS_TANGENT\ntangentUpdated.xyz+=(readVector3FromRawSampler({X},vertexID) -tangent.xyz)*morphTargetInfluences[{X}];\n#endif\n#else\npositionUpdated+=(position{X}-position)*morphTargetInfluences[{X}];\n#ifdef MORPHTARGETS_NORMAL\nnormalUpdated+=(normal{X}-normal)*morphTargetInfluences[{X}];\n#endif\n#ifdef MORPHTARGETS_TANGENT\ntangentUpdated.xyz+=(tangent{X}-tangent.xyz)*morphTargetInfluences[{X}];\n#endif\n#ifdef MORPHTARGETS_UV\nuvUpdated+=(uv_{X}-uv)*morphTargetInfluences[{X}];\n#endif\n#endif\n#endif\n";Ve.v.IncludesShadersStore.morphTargetsVertex=kt;var Ot="#ifdef INSTANCES\nmat4 finalWorld=mat4(world0,world1,world2,world3);\n#if defined(PREPASS_VELOCITY) || defined(VELOCITY)\nmat4 finalPreviousWorld=mat4(previousWorld0,previousWorld1,previousWorld2,previousWorld3);\n#endif\n#ifdef THIN_INSTANCES\nfinalWorld=world*finalWorld;\n#if defined(PREPASS_VELOCITY) || defined(VELOCITY)\nfinalPreviousWorld=previousWorld*finalPreviousWorld;\n#endif\n#endif\n#else\nmat4 finalWorld=world;\n#if defined(PREPASS_VELOCITY) || defined(VELOCITY)\nmat4 finalPreviousWorld=previousWorld;\n#endif\n#endif\n";Ve.v.IncludesShadersStore.instancesVertex=Ot;var Nt="#ifndef BAKED_VERTEX_ANIMATION_TEXTURE\n#if NUM_BONE_INFLUENCERS>0\nmat4 influence;\n#ifdef BONETEXTURE\ninfluence=readMatrixFromRawSampler(boneSampler,matricesIndices[0])*matricesWeights[0];\n#if NUM_BONE_INFLUENCERS>1\ninfluence+=readMatrixFromRawSampler(boneSampler,matricesIndices[1])*matricesWeights[1];\n#endif\n#if NUM_BONE_INFLUENCERS>2\ninfluence+=readMatrixFromRawSampler(boneSampler,matricesIndices[2])*matricesWeights[2];\n#endif\n#if NUM_BONE_INFLUENCERS>3\ninfluence+=readMatrixFromRawSampler(boneSampler,matricesIndices[3])*matricesWeights[3];\n#endif\n#if NUM_BONE_INFLUENCERS>4\ninfluence+=readMatrixFromRawSampler(boneSampler,matricesIndicesExtra[0])*matricesWeightsExtra[0];\n#endif\n#if NUM_BONE_INFLUENCERS>5\ninfluence+=readMatrixFromRawSampler(boneSampler,matricesIndicesExtra[1])*matricesWeightsExtra[1];\n#endif\n#if NUM_BONE_INFLUENCERS>6\ninfluence+=readMatrixFromRawSampler(boneSampler,matricesIndicesExtra[2])*matricesWeightsExtra[2];\n#endif\n#if NUM_BONE_INFLUENCERS>7\ninfluence+=readMatrixFromRawSampler(boneSampler,matricesIndicesExtra[3])*matricesWeightsExtra[3];\n#endif\n#else\ninfluence=mBones[int(matricesIndices[0])]*matricesWeights[0];\n#if NUM_BONE_INFLUENCERS>1\ninfluence+=mBones[int(matricesIndices[1])]*matricesWeights[1];\n#endif\n#if NUM_BONE_INFLUENCERS>2\ninfluence+=mBones[int(matricesIndices[2])]*matricesWeights[2];\n#endif\n#if NUM_BONE_INFLUENCERS>3\ninfluence+=mBones[int(matricesIndices[3])]*matricesWeights[3];\n#endif\n#if NUM_BONE_INFLUENCERS>4\ninfluence+=mBones[int(matricesIndicesExtra[0])]*matricesWeightsExtra[0];\n#endif\n#if NUM_BONE_INFLUENCERS>5\ninfluence+=mBones[int(matricesIndicesExtra[1])]*matricesWeightsExtra[1];\n#endif\n#if NUM_BONE_INFLUENCERS>6\ninfluence+=mBones[int(matricesIndicesExtra[2])]*matricesWeightsExtra[2];\n#endif\n#if NUM_BONE_INFLUENCERS>7\ninfluence+=mBones[int(matricesIndicesExtra[3])]*matricesWeightsExtra[3];\n#endif\n#endif\nfinalWorld=finalWorld*influence;\n#endif\n#endif\n";Ve.v.IncludesShadersStore.bonesVertex=Nt;var wt="#ifdef BAKED_VERTEX_ANIMATION_TEXTURE\n{\n#ifdef INSTANCES\n#define BVASNAME bakedVertexAnimationSettingsInstanced\n#else\n#define BVASNAME bakedVertexAnimationSettings\n#endif\nfloat VATStartFrame=BVASNAME.x;\nfloat VATEndFrame=BVASNAME.y;\nfloat VATOffsetFrame=BVASNAME.z;\nfloat VATSpeed=BVASNAME.w;\nfloat totalFrames=VATEndFrame-VATStartFrame+1.0;\nfloat time=bakedVertexAnimationTime*VATSpeed/totalFrames;\nfloat frameCorrection=time<1.0 ? 0.0 : 1.0;\nfloat numOfFrames=totalFrames-frameCorrection;\nfloat VATFrameNum=fract(time)*numOfFrames;\nVATFrameNum=mod(VATFrameNum+VATOffsetFrame,numOfFrames);\nVATFrameNum=floor(VATFrameNum);\nVATFrameNum+=VATStartFrame+frameCorrection;\nmat4 VATInfluence;\nVATInfluence=readMatrixFromRawSamplerVAT(bakedVertexAnimationTexture,matricesIndices[0],VATFrameNum)*matricesWeights[0];\n#if NUM_BONE_INFLUENCERS>1\nVATInfluence+=readMatrixFromRawSamplerVAT(bakedVertexAnimationTexture,matricesIndices[1],VATFrameNum)*matricesWeights[1];\n#endif\n#if NUM_BONE_INFLUENCERS>2\nVATInfluence+=readMatrixFromRawSamplerVAT(bakedVertexAnimationTexture,matricesIndices[2],VATFrameNum)*matricesWeights[2];\n#endif\n#if NUM_BONE_INFLUENCERS>3\nVATInfluence+=readMatrixFromRawSamplerVAT(bakedVertexAnimationTexture,matricesIndices[3],VATFrameNum)*matricesWeights[3];\n#endif\n#if NUM_BONE_INFLUENCERS>4\nVATInfluence+=readMatrixFromRawSamplerVAT(bakedVertexAnimationTexture,matricesIndicesExtra[0],VATFrameNum)*matricesWeightsExtra[0];\n#endif\n#if NUM_BONE_INFLUENCERS>5\nVATInfluence+=readMatrixFromRawSamplerVAT(bakedVertexAnimationTexture,matricesIndicesExtra[1],VATFrameNum)*matricesWeightsExtra[1];\n#endif\n#if NUM_BONE_INFLUENCERS>6\nVATInfluence+=readMatrixFromRawSamplerVAT(bakedVertexAnimationTexture,matricesIndicesExtra[2],VATFrameNum)*matricesWeightsExtra[2];\n#endif\n#if NUM_BONE_INFLUENCERS>7\nVATInfluence+=readMatrixFromRawSamplerVAT(bakedVertexAnimationTexture,matricesIndicesExtra[3],VATFrameNum)*matricesWeightsExtra[3];\n#endif\nfinalWorld=finalWorld*VATInfluence;\n}\n#endif\n";Ve.v.IncludesShadersStore.bakedVertexAnimation=wt;var Lt="#ifdef PREPASS_DEPTH\nvViewPos=(view*worldPos).rgb;\n#endif\n#if defined(PREPASS_VELOCITY) && defined(BONES_VELOCITY_ENABLED)\nvCurrentPosition=viewProjection*worldPos;\n#if NUM_BONE_INFLUENCERS>0\nmat4 previousInfluence;\npreviousInfluence=mPreviousBones[int(matricesIndices[0])]*matricesWeights[0];\n#if NUM_BONE_INFLUENCERS>1\npreviousInfluence+=mPreviousBones[int(matricesIndices[1])]*matricesWeights[1];\n#endif \n#if NUM_BONE_INFLUENCERS>2\npreviousInfluence+=mPreviousBones[int(matricesIndices[2])]*matricesWeights[2];\n#endif \n#if NUM_BONE_INFLUENCERS>3\npreviousInfluence+=mPreviousBones[int(matricesIndices[3])]*matricesWeights[3];\n#endif\n#if NUM_BONE_INFLUENCERS>4\npreviousInfluence+=mPreviousBones[int(matricesIndicesExtra[0])]*matricesWeightsExtra[0];\n#endif \n#if NUM_BONE_INFLUENCERS>5\npreviousInfluence+=mPreviousBones[int(matricesIndicesExtra[1])]*matricesWeightsExtra[1];\n#endif \n#if NUM_BONE_INFLUENCERS>6\npreviousInfluence+=mPreviousBones[int(matricesIndicesExtra[2])]*matricesWeightsExtra[2];\n#endif \n#if NUM_BONE_INFLUENCERS>7\npreviousInfluence+=mPreviousBones[int(matricesIndicesExtra[3])]*matricesWeightsExtra[3];\n#endif\nvPreviousPosition=previousViewProjection*finalPreviousWorld*previousInfluence*vec4(positionUpdated,1.0);\n#else\nvPreviousPosition=previousViewProjection*finalPreviousWorld*vec4(positionUpdated,1.0);\n#endif\n#endif\n";Ve.v.IncludesShadersStore.prePassVertex=Lt;var Ft="#if !defined(UV{X}) && defined(MAINUV{X})\nvec2 uv{X}=vec2(0.,0.);\n#endif\n#ifdef MAINUV{X}\nvMainUV{X}=uv{X};\n#endif\n";Ve.v.IncludesShadersStore.uvVariableDeclaration=Ft;var Bt="#if defined(_DEFINENAME_) && _DEFINENAME_DIRECTUV==0\nif (v_INFONAME_==0.)\n{\nv_VARYINGNAME_UV=vec2(_MATRIXNAME_Matrix*vec4(uvUpdated,1.0,0.0));\n}\n#ifdef UV2\nelse if (v_INFONAME_==1.)\n{\nv_VARYINGNAME_UV=vec2(_MATRIXNAME_Matrix*vec4(uv2,1.0,0.0));\n}\n#endif\n#ifdef UV3\nelse if (v_INFONAME_==2.)\n{\nv_VARYINGNAME_UV=vec2(_MATRIXNAME_Matrix*vec4(uv3,1.0,0.0));\n}\n#endif\n#ifdef UV4\nelse if (v_INFONAME_==3.)\n{\nv_VARYINGNAME_UV=vec2(_MATRIXNAME_Matrix*vec4(uv4,1.0,0.0));\n}\n#endif\n#ifdef UV5\nelse if (v_INFONAME_==4.)\n{\nv_VARYINGNAME_UV=vec2(_MATRIXNAME_Matrix*vec4(uv5,1.0,0.0));\n}\n#endif\n#ifdef UV6\nelse if (v_INFONAME_==5.)\n{\nv_VARYINGNAME_UV=vec2(_MATRIXNAME_Matrix*vec4(uv6,1.0,0.0));\n}\n#endif\n#endif\n";Ve.v.IncludesShadersStore.samplerVertexImplementation=Bt;var Ut="#if defined(BUMP) || defined(PARALLAX) || defined(CLEARCOAT_BUMP) || defined(ANISOTROPIC)\n#if defined(TANGENT) && defined(NORMAL)\nvec3 tbnNormal=normalize(normalUpdated);\nvec3 tbnTangent=normalize(tangentUpdated.xyz);\nvec3 tbnBitangent=cross(tbnNormal,tbnTangent)*tangentUpdated.w;\nvTBN=mat3(finalWorld)*mat3(tbnTangent,tbnBitangent,tbnNormal);\n#endif\n#endif\n";Ve.v.IncludesShadersStore.bumpVertex=Ut;var Vt="#ifdef CLIPPLANE\nfClipDistance=dot(worldPos,vClipPlane);\n#endif\n#ifdef CLIPPLANE2\nfClipDistance2=dot(worldPos,vClipPlane2);\n#endif\n#ifdef CLIPPLANE3\nfClipDistance3=dot(worldPos,vClipPlane3);\n#endif\n#ifdef CLIPPLANE4\nfClipDistance4=dot(worldPos,vClipPlane4);\n#endif\n#ifdef CLIPPLANE5\nfClipDistance5=dot(worldPos,vClipPlane5);\n#endif\n#ifdef CLIPPLANE6\nfClipDistance6=dot(worldPos,vClipPlane6);\n#endif\n";Ve.v.IncludesShadersStore.clipPlaneVertex=Vt;var Gt="#ifdef FOG\nvFogDistance=(view*worldPos).xyz;\n#endif\n";Ve.v.IncludesShadersStore.fogVertex=Gt;var zt="#ifdef SHADOWS\n#if defined(SHADOWCSM{X})\nvPositionFromCamera{X}=view*worldPos;\nfor (int i=0; i<SHADOWCSMNUM_CASCADES{X}; i++) {\nvPositionFromLight{X}[i]=lightMatrix{X}[i]*worldPos;\n#ifdef USE_REVERSE_DEPTHBUFFER\nvDepthMetric{X}[i]=(-vPositionFromLight{X}[i].z+light{X}.depthValues.x)/light{X}.depthValues.y;\n#else\nvDepthMetric{X}[i]=(vPositionFromLight{X}[i].z+light{X}.depthValues.x)/light{X}.depthValues.y;\n#endif\n}\n#elif defined(SHADOW{X}) && !defined(SHADOWCUBE{X})\nvPositionFromLight{X}=lightMatrix{X}*worldPos;\n#ifdef USE_REVERSE_DEPTHBUFFER\nvDepthMetric{X}=(-vPositionFromLight{X}.z+light{X}.depthValues.x)/light{X}.depthValues.y;\n#else\nvDepthMetric{X}=(vPositionFromLight{X}.z+light{X}.depthValues.x)/light{X}.depthValues.y;\n#endif\n#endif\n#endif\n";Ve.v.IncludesShadersStore.shadowsVertex=zt;var Wt="#if defined(VERTEXCOLOR) || defined(INSTANCESCOLOR)\nvColor=vec4(1.0);\n#ifdef VERTEXCOLOR\n#ifdef VERTEXALPHA\nvColor*=color;\n#else\nvColor.rgb*=color.rgb;\n#endif\n#endif\n#ifdef INSTANCESCOLOR\nvColor*=instanceColor;\n#endif\n#endif\n";Ve.v.IncludesShadersStore.vertexColorMixing=Wt;var Ht="#if defined(POINTSIZE) && !defined(WEBGPU)\ngl_PointSize=pointSize;\n#endif\n";Ve.v.IncludesShadersStore.pointCloudVertex=Ht;var Xt="#ifdef LOGARITHMICDEPTH\nvFragmentDepth=1.0+gl_Position.w;\ngl_Position.z=log2(max(0.000001,vFragmentDepth))*logarithmicDepthConstant;\n#endif\n";Ve.v.IncludesShadersStore.logDepthVertex=Xt;var jt="#include<__decl__defaultVertex>\n#define CUSTOM_VERTEX_BEGIN\nattribute vec3 position;\n#ifdef NORMAL\nattribute vec3 normal;\n#endif\n#ifdef TANGENT\nattribute vec4 tangent;\n#endif\n#ifdef UV1\nattribute vec2 uv;\n#endif\n#include<uvAttributeDeclaration>[2..7]\n#ifdef VERTEXCOLOR\nattribute vec4 color;\n#endif\n#include<helperFunctions>\n#include<bonesDeclaration>\n#include<bakedVertexAnimationDeclaration>\n#include<instancesDeclaration>\n#include<prePassVertexDeclaration>\n#include<mainUVVaryingDeclaration>[1..7]\n#include<samplerVertexDeclaration>(_DEFINENAME_,DIFFUSE,_VARYINGNAME_,Diffuse)\n#include<samplerVertexDeclaration>(_DEFINENAME_,DETAIL,_VARYINGNAME_,Detail)\n#include<samplerVertexDeclaration>(_DEFINENAME_,AMBIENT,_VARYINGNAME_,Ambient)\n#include<samplerVertexDeclaration>(_DEFINENAME_,OPACITY,_VARYINGNAME_,Opacity)\n#include<samplerVertexDeclaration>(_DEFINENAME_,EMISSIVE,_VARYINGNAME_,Emissive)\n#include<samplerVertexDeclaration>(_DEFINENAME_,LIGHTMAP,_VARYINGNAME_,Lightmap)\n#if defined(SPECULARTERM)\n#include<samplerVertexDeclaration>(_DEFINENAME_,SPECULAR,_VARYINGNAME_,Specular)\n#endif\n#include<samplerVertexDeclaration>(_DEFINENAME_,BUMP,_VARYINGNAME_,Bump)\nvarying vec3 vPositionW;\n#ifdef NORMAL\nvarying vec3 vNormalW;\n#endif\n#if defined(VERTEXCOLOR) || defined(INSTANCESCOLOR)\nvarying vec4 vColor;\n#endif\n#include<bumpVertexDeclaration>\n#include<clipPlaneVertexDeclaration>\n#include<fogVertexDeclaration>\n#include<__decl__lightVxFragment>[0..maxSimultaneousLights]\n#include<morphTargetsVertexGlobalDeclaration>\n#include<morphTargetsVertexDeclaration>[0..maxSimultaneousMorphTargets]\n#ifdef REFLECTIONMAP_SKYBOX\nvarying vec3 vPositionUVW;\n#endif\n#if defined(REFLECTIONMAP_EQUIRECTANGULAR_FIXED) || defined(REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED)\nvarying vec3 vDirectionW;\n#endif\n#include<logDepthDeclaration>\n#define CUSTOM_VERTEX_DEFINITIONS\nvoid main(void) {\n#define CUSTOM_VERTEX_MAIN_BEGIN\nvec3 positionUpdated=position;\n#ifdef NORMAL\nvec3 normalUpdated=normal;\n#endif\n#ifdef TANGENT\nvec4 tangentUpdated=tangent;\n#endif\n#ifdef UV1\nvec2 uvUpdated=uv;\n#endif\n#include<morphTargetsVertexGlobal>\n#include<morphTargetsVertex>[0..maxSimultaneousMorphTargets]\n#ifdef REFLECTIONMAP_SKYBOX\nvPositionUVW=positionUpdated;\n#endif\n#define CUSTOM_VERTEX_UPDATE_POSITION\n#define CUSTOM_VERTEX_UPDATE_NORMAL\n#include<instancesVertex>\n#if defined(PREPASS) && defined(PREPASS_VELOCITY) && !defined(BONES_VELOCITY_ENABLED)\nvCurrentPosition=viewProjection*finalWorld*vec4(positionUpdated,1.0);\nvPreviousPosition=previousViewProjection*finalPreviousWorld*vec4(positionUpdated,1.0);\n#endif\n#include<bonesVertex>\n#include<bakedVertexAnimation>\nvec4 worldPos=finalWorld*vec4(positionUpdated,1.0);\n#ifdef NORMAL\nmat3 normalWorld=mat3(finalWorld);\n#if defined(INSTANCES) && defined(THIN_INSTANCES)\nvNormalW=normalUpdated/vec3(dot(normalWorld[0],normalWorld[0]),dot(normalWorld[1],normalWorld[1]),dot(normalWorld[2],normalWorld[2]));\nvNormalW=normalize(normalWorld*vNormalW);\n#else\n#ifdef NONUNIFORMSCALING\nnormalWorld=transposeMat3(inverseMat3(normalWorld));\n#endif\nvNormalW=normalize(normalWorld*normalUpdated);\n#endif\n#endif\n#define CUSTOM_VERTEX_UPDATE_WORLDPOS\n#ifdef MULTIVIEW\nif (gl_ViewID_OVR==0u) {\ngl_Position=viewProjection*worldPos;\n} else {\ngl_Position=viewProjectionR*worldPos;\n}\n#else\ngl_Position=viewProjection*worldPos;\n#endif\nvPositionW=vec3(worldPos);\n#include<prePassVertex>\n#if defined(REFLECTIONMAP_EQUIRECTANGULAR_FIXED) || defined(REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED)\nvDirectionW=normalize(vec3(finalWorld*vec4(positionUpdated,0.0)));\n#endif\n#ifndef UV1\nvec2 uvUpdated=vec2(0.,0.);\n#endif\n#ifdef MAINUV1\nvMainUV1=uvUpdated;\n#endif\n#include<uvVariableDeclaration>[2..7]\n#include<samplerVertexImplementation>(_DEFINENAME_,DIFFUSE,_VARYINGNAME_,Diffuse,_MATRIXNAME_,diffuse,_INFONAME_,DiffuseInfos.x)\n#include<samplerVertexImplementation>(_DEFINENAME_,DETAIL,_VARYINGNAME_,Detail,_MATRIXNAME_,detail,_INFONAME_,DetailInfos.x)\n#include<samplerVertexImplementation>(_DEFINENAME_,AMBIENT,_VARYINGNAME_,Ambient,_MATRIXNAME_,ambient,_INFONAME_,AmbientInfos.x)\n#include<samplerVertexImplementation>(_DEFINENAME_,OPACITY,_VARYINGNAME_,Opacity,_MATRIXNAME_,opacity,_INFONAME_,OpacityInfos.x)\n#include<samplerVertexImplementation>(_DEFINENAME_,EMISSIVE,_VARYINGNAME_,Emissive,_MATRIXNAME_,emissive,_INFONAME_,EmissiveInfos.x)\n#include<samplerVertexImplementation>(_DEFINENAME_,LIGHTMAP,_VARYINGNAME_,Lightmap,_MATRIXNAME_,lightmap,_INFONAME_,LightmapInfos.x)\n#if defined(SPECULARTERM)\n#include<samplerVertexImplementation>(_DEFINENAME_,SPECULAR,_VARYINGNAME_,Specular,_MATRIXNAME_,specular,_INFONAME_,SpecularInfos.x)\n#endif\n#include<samplerVertexImplementation>(_DEFINENAME_,BUMP,_VARYINGNAME_,Bump,_MATRIXNAME_,bump,_INFONAME_,BumpInfos.x)\n#include<bumpVertex>\n#include<clipPlaneVertex>\n#include<fogVertex>\n#include<shadowsVertex>[0..maxSimultaneousLights]\n#include<vertexColorMixing>\n#include<pointCloudVertex>\n#include<logDepthVertex>\n#define CUSTOM_VERTEX_MAIN_END\n}\n";Ve.v.ShadersStore.defaultVertexShader=jt;function Yt(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Zt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Zt(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function Zt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var Kt=function(){function e(){(0,E.Z)(this,e),this._defines={},this._currentRank=32,this._maxRank=-1,this._mesh=null}return(0,A.Z)(e,[{key:"unBindMesh",value:function(){this._mesh=null}},{key:"addFallback",value:function(e,t){this._defines[e]||(e<this._currentRank&&(this._currentRank=e),e>this._maxRank&&(this._maxRank=e),this._defines[e]=new Array),this._defines[e].push(t)}},{key:"addCPUSkinningFallback",value:function(e,t){this._mesh=t,e<this._currentRank&&(this._currentRank=e),e>this._maxRank&&(this._maxRank=e)}},{key:"hasMoreFallbacks",get:function(){return this._currentRank<=this._maxRank}},{key:"reduce",value:function(e,t){if(this._mesh&&this._mesh.computeBonesUsingShaders&&this._mesh.numBoneInfluencers>0){this._mesh.computeBonesUsingShaders=!1,e=e.replace("#define NUM_BONE_INFLUENCERS "+this._mesh.numBoneInfluencers,"#define NUM_BONE_INFLUENCERS 0"),t._bonesComputationForcedToCPU=!0;for(var n=this._mesh.getScene(),i=0;i<n.meshes.length;i++){var r=n.meshes[i];if(r.material){if(r.computeBonesUsingShaders&&0!==r.numBoneInfluencers)if(r.material.getEffect()===t)r.computeBonesUsingShaders=!1;else if(r.subMeshes){var a,o=Yt(r.subMeshes);try{for(o.s();!(a=o.n()).done;){if(a.value.effect===t){r.computeBonesUsingShaders=!1;break}}}catch(l){o.e(l)}finally{o.f()}}}else!this._mesh.material&&r.computeBonesUsingShaders&&r.numBoneInfluencers>0&&(r.computeBonesUsingShaders=!1)}}else{var s=this._defines[this._currentRank];if(s)for(var u=0;u<s.length;u++)e=e.replace("#define "+s[u],"");this._currentRank++}return e}}]),e}(),qt=n(2982);function Qt(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return $t(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return $t(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function $t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var Jt=function(){function e(t){(0,E.Z)(this,e),this._plugins=[],this._activePlugins=[],this._activePluginsForExtraEvents=[],this._material=t,this._scene=t.getScene(),this._engine=this._scene.getEngine()}return(0,A.Z)(e,[{key:"_addPlugin",value:function(t){for(var n=0;n<this._plugins.length;++n)if(this._plugins[n].name===t.name)throw'Plugin "'.concat(t.name,'" already added to the material "').concat(this._material.name,'"!');if(this._material._uniformBufferLayoutBuilt)throw'The plugin "'.concat(t.name,'" can\'t be added to the material "').concat(this._material.name,'" because this material has already been used for rendering! Please add plugins to materials before any rendering with this material occurs.');var i=t.getClassName();e._MaterialPluginClassToMainDefine[i]||(e._MaterialPluginClassToMainDefine[i]="MATERIALPLUGIN_"+ ++e._MaterialPluginCounter),this._material._callbackPluginEventGeneric=this._handlePluginEvent.bind(this),this._plugins.push(t),this._plugins.sort((function(e,t){return e.priority-t.priority})),this._codeInjectionPoints={};var r={};r[e._MaterialPluginClassToMainDefine[i]]={type:"boolean",default:!0};var a,o=Qt(this._plugins);try{for(o.s();!(a=o.n()).done;){var s=a.value;s.collectDefines(r),this._collectPointNames("vertex",s.getCustomCode("vertex")),this._collectPointNames("fragment",s.getCustomCode("fragment"))}}catch(u){o.e(u)}finally{o.f()}this._defineNamesFromPlugins=r}},{key:"_activatePlugin",value:function(e){-1===this._activePlugins.indexOf(e)&&(this._activePlugins.push(e),this._activePlugins.sort((function(e,t){return e.priority-t.priority})),this._material._callbackPluginEventIsReadyForSubMesh=this._handlePluginEventIsReadyForSubMesh.bind(this),this._material._callbackPluginEventPrepareDefinesBeforeAttributes=this._handlePluginEventPrepareDefinesBeforeAttributes.bind(this),this._material._callbackPluginEventPrepareDefines=this._handlePluginEventPrepareDefines.bind(this),this._material._callbackPluginEventBindForSubMesh=this._handlePluginEventBindForSubMesh.bind(this),e.registerForExtraEvents&&(this._activePluginsForExtraEvents.push(e),this._activePluginsForExtraEvents.sort((function(e,t){return e.priority-t.priority})),this._material._callbackPluginEventHasRenderTargetTextures=this._handlePluginEventHasRenderTargetTextures.bind(this),this._material._callbackPluginEventFillRenderTargetTextures=this._handlePluginEventFillRenderTargetTextures.bind(this),this._material._callbackPluginEventHardBindForSubMesh=this._handlePluginEventHardBindForSubMesh.bind(this)))}},{key:"getPlugin",value:function(e){for(var t=0;t<this._plugins.length;++t)if(this._plugins[t].name===e)return this._plugins[t];return null}},{key:"_handlePluginEventIsReadyForSubMesh",value:function(e){var t,n=!0,i=Qt(this._activePlugins);try{for(i.s();!(t=i.n()).done;){var r=t.value;n=n&&r.isReadyForSubMesh(e.defines,this._scene,this._engine,e.subMesh)}}catch(a){i.e(a)}finally{i.f()}e.isReadyForSubMesh=n}},{key:"_handlePluginEventPrepareDefinesBeforeAttributes",value:function(e){var t,n=Qt(this._activePlugins);try{for(n.s();!(t=n.n()).done;){t.value.prepareDefinesBeforeAttributes(e.defines,this._scene,e.mesh)}}catch(i){n.e(i)}finally{n.f()}}},{key:"_handlePluginEventPrepareDefines",value:function(e){var t,n=Qt(this._activePlugins);try{for(n.s();!(t=n.n()).done;){t.value.prepareDefines(e.defines,this._scene,e.mesh)}}catch(i){n.e(i)}finally{n.f()}}},{key:"_handlePluginEventHardBindForSubMesh",value:function(e){var t,n=Qt(this._activePluginsForExtraEvents);try{for(n.s();!(t=n.n()).done;){t.value.hardBindForSubMesh(this._material._uniformBuffer,this._scene,this._engine,e.subMesh)}}catch(i){n.e(i)}finally{n.f()}}},{key:"_handlePluginEventBindForSubMesh",value:function(e){var t,n=Qt(this._activePlugins);try{for(n.s();!(t=n.n()).done;){t.value.bindForSubMesh(this._material._uniformBuffer,this._scene,this._engine,e.subMesh)}}catch(i){n.e(i)}finally{n.f()}}},{key:"_handlePluginEventHasRenderTargetTextures",value:function(e){var t,n=!1,i=Qt(this._activePluginsForExtraEvents);try{for(i.s();!(t=i.n()).done;){if(n=t.value.hasRenderTargetTextures())break}}catch(r){i.e(r)}finally{i.f()}e.hasRenderTargetTextures=n}},{key:"_handlePluginEventFillRenderTargetTextures",value:function(e){var t,n=Qt(this._activePluginsForExtraEvents);try{for(n.s();!(t=n.n()).done;){t.value.fillRenderTargetTextures(e.renderTargets)}}catch(i){n.e(i)}finally{n.f()}}},{key:"_handlePluginEvent",value:function(e,t){switch(e){case ge.S.GetActiveTextures:var n,i=t,r=Qt(this._activePlugins);try{for(r.s();!(n=r.n()).done;){n.value.getActiveTextures(i.activeTextures)}}catch(D){r.e(D)}finally{r.f()}break;case ge.S.GetAnimatables:var a,o=t,s=Qt(this._activePlugins);try{for(s.s();!(a=s.n()).done;){a.value.getAnimatables(o.animatables)}}catch(D){s.e(D)}finally{s.f()}break;case ge.S.HasTexture:var u,l=t,c=!1,h=Qt(this._activePlugins);try{for(h.s();!(u=h.n()).done;){if(c=u.value.hasTexture(l.texture))break}}catch(D){h.e(D)}finally{h.f()}l.hasTexture=c;break;case ge.S.Disposed:var f,d=t,p=Qt(this._plugins);try{for(p.s();!(f=p.n()).done;){f.value.dispose(d.forceDisposeTextures)}}catch(D){p.e(D)}finally{p.f()}break;case ge.S.GetDefineNames:t.defineNames=this._defineNamesFromPlugins;break;case ge.S.PrepareEffect:var v,m,g,_,y=t,E=Qt(this._activePlugins);try{for(E.s();!(v=E.n()).done;){var A=v.value;y.fallbackRank=A.addFallbacks(y.defines,y.fallbacks,y.fallbackRank),A.getAttributes(y.attributes,this._scene,y.mesh)}}catch(D){E.e(D)}finally{E.f()}if(this._uniformList.length>0)(m=y.uniforms).push.apply(m,(0,qt.Z)(this._uniformList));if(this._samplerList.length>0)(g=y.samplers).push.apply(g,(0,qt.Z)(this._samplerList));if(this._uboList.length>0)(_=y.uniformBuffersNames).push.apply(_,(0,qt.Z)(this._uboList));y.customCode=this._injectCustomCode(y.customCode);break;case ge.S.PrepareUniformBuffer:var b=t;this._uboDeclaration="",this._vertexDeclaration="",this._fragmentDeclaration="",this._uniformList=[],this._samplerList=[],this._uboList=[];var T,M=Qt(this._plugins);try{for(M.s();!(T=M.n()).done;){var S=T.value,I=S.getUniforms();if(I){if(I.ubo){var x,C=Qt(I.ubo);try{for(C.s();!(x=C.n()).done;){var P=x.value;b.ubo.addUniform(P.name,P.size),this._uboDeclaration+="".concat(P.type," ").concat(P.name,";\r\n"),this._uniformList.push(P.name)}}catch(D){C.e(D)}finally{C.f()}}I.vertex&&(this._vertexDeclaration+=I.vertex+"\r\n"),I.fragment&&(this._fragmentDeclaration+=I.fragment+"\r\n")}S.getSamplers(this._samplerList),S.getUniformBuffersNames(this._uboList)}}catch(D){M.e(D)}finally{M.f()}}}},{key:"_collectPointNames",value:function(e,t){if(t)for(var n in t)this._codeInjectionPoints[e]||(this._codeInjectionPoints[e]={}),this._codeInjectionPoints[e][n]=!0}},{key:"_injectCustomCode",value:function(e){var t=this;return function(n,i){var r;e&&(i=e(n,i)),t._uboDeclaration&&(i=i.replace("#define ADDITIONAL_UBO_DECLARATION",t._uboDeclaration)),t._vertexDeclaration&&(i=i.replace("#define ADDITIONAL_VERTEX_DECLARATION",t._vertexDeclaration)),t._fragmentDeclaration&&(i=i.replace("#define ADDITIONAL_FRAGMENT_DECLARATION",t._fragmentDeclaration));var a=null===(r=t._codeInjectionPoints)||void 0===r?void 0:r[n];if(!a)return i;for(var o in a){var s,u="",l=Qt(t._activePlugins);try{for(l.s();!(s=l.n()).done;){var c=s.value.getCustomCode(n);null!=c&&c[o]&&(u+=c[o]+"\r\n")}}catch(m){l.e(m)}finally{l.f()}if(u.length>0)if("!"===o.charAt(0))for(var h=new RegExp(o.substring(1),"g"),f=h.exec(i);null!==f;){for(var d=u,p=0;p<f.length;++p)d=d.replace("$"+p,f[p]);i=i.replace(f[0],d),f=h.exec(i)}else{var v="#define "+o;i=i.replace(v,"\r\n"+u+"\r\n"+v)}}return i}}}]),e}();Jt._MaterialPluginClassToMainDefine={},Jt._MaterialPluginCounter=0;var en=function(){function e(t,n,i,r){var a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],o=arguments.length>5&&void 0!==arguments[5]&&arguments[5];(0,E.Z)(this,e),this.priority=500,this.registerForExtraEvents=!1,this._material=t,this.name=n,this.priority=i,t.pluginManager||(t.pluginManager=new Jt(t)),this._pluginDefineNames=r,this._pluginManager=t.pluginManager,a&&this._pluginManager._addPlugin(this),o&&this._enable(!0),this.markAllDefinesAsDirty=t._dirtyCallbacks[63]}return(0,A.Z)(e,[{key:"_enable",value:function(e){e&&this._pluginManager._activatePlugin(this)}},{key:"getClassName",value:function(){return"MaterialPluginBase"}},{key:"isReadyForSubMesh",value:function(e,t,n,i){return!0}},{key:"hardBindForSubMesh",value:function(e,t,n,i){}},{key:"bindForSubMesh",value:function(e,t,n,i){}},{key:"dispose",value:function(e){}},{key:"getCustomCode",value:function(e){return null}},{key:"collectDefines",value:function(e){if(this._pluginDefineNames)for(var t=0,n=Object.keys(this._pluginDefineNames);t<n.length;t++){var i=n[t];if("_"!==i[0]){var r=typeof this._pluginDefineNames[i];e[i]={type:"number"===r?"number":"string"===r?"string":"boolean"===r?"boolean":"object",default:this._pluginDefineNames[i]}}}}},{key:"prepareDefinesBeforeAttributes",value:function(e,t,n){}},{key:"prepareDefines",value:function(e,t,n){}},{key:"hasTexture",value:function(e){return!1}},{key:"hasRenderTargetTextures",value:function(){return!1}},{key:"fillRenderTargetTextures",value:function(e){}},{key:"getActiveTextures",value:function(e){}},{key:"getAnimatables",value:function(e){}},{key:"addFallbacks",value:function(e,t,n){return n}},{key:"getSamplers",value:function(e){}},{key:"getAttributes",value:function(e,t,n){}},{key:"getUniformBuffersNames",value:function(e){}},{key:"getUniforms",value:function(){return{}}},{key:"copyTo",value:function(e){P.p4.Clone((function(){return e}),this)}},{key:"serialize",value:function(){return P.p4.Serialize(this)}},{key:"parse",value:function(e,t,n){var i=this;P.p4.Parse((function(){return i}),e,t,n)}}]),e}();function tn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,x.Z)(e);if(t){var r=(0,x.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,I.Z)(this,n)}}(0,C.gn)([(0,P.qC)()],en.prototype,"name",void 0),(0,C.gn)([(0,P.qC)()],en.prototype,"priority",void 0),(0,C.gn)([(0,P.qC)()],en.prototype,"registerForExtraEvents",void 0);var nn=function(e){(0,S.Z)(n,e);var t=tn(n);function n(){var e;return(0,E.Z)(this,n),(e=t.apply(this,arguments)).DETAIL=!1,e.DETAILDIRECTUV=0,e.DETAIL_NORMALBLENDMETHOD=0,e}return(0,A.Z)(n)}(_e.H),rn=function(e){(0,S.Z)(n,e);var t=tn(n);function n(e){var i,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return(0,E.Z)(this,n),(i=t.call(this,e,"DetailMap",140,new nn,r))._texture=null,i.diffuseBlendLevel=1,i.roughnessBlendLevel=1,i.bumpLevel=1,i._normalBlendMethod=me.F.MATERIAL_NORMALBLENDMETHOD_WHITEOUT,i._isEnabled=!1,i.isEnabled=!1,i._internalMarkAllSubMeshesAsTexturesDirty=e._dirtyCallbacks[1],i}return(0,A.Z)(n,[{key:"_markAllSubMeshesAsTexturesDirty",value:function(){this._enable(this._isEnabled),this._internalMarkAllSubMeshesAsTexturesDirty()}},{key:"isReadyForSubMesh",value:function(e,t,n){return!this._isEnabled||!(e._areTexturesDirty&&t.texturesEnabled&&n.getCaps().standardDerivatives&&this._texture&&Ue.DetailTextureEnabled&&!this._texture.isReady())}},{key:"prepareDefines",value:function(e,t){if(this._isEnabled){e.DETAIL_NORMALBLENDMETHOD=this._normalBlendMethod;var n=t.getEngine();e._areTexturesDirty&&(n.getCaps().standardDerivatives&&this._texture&&Ue.DetailTextureEnabled&&this._isEnabled?(Ae.G.PrepareDefinesForMergedUV(this._texture,e,"DETAIL"),e.DETAIL_NORMALBLENDMETHOD=this._normalBlendMethod):e.DETAIL=!1)}else e.DETAIL=!1}},{key:"bindForSubMesh",value:function(e,t){if(this._isEnabled){var n=this._material.isFrozen;e.useUbo&&n&&e.isSync||this._texture&&Ue.DetailTextureEnabled&&(e.updateFloat4("vDetailInfos",this._texture.coordinatesIndex,this.diffuseBlendLevel,this.bumpLevel,this.roughnessBlendLevel),Ae.G.BindTextureMatrix(this._texture,e,"detail")),t.texturesEnabled&&this._texture&&Ue.DetailTextureEnabled&&e.setTexture("detailSampler",this._texture)}}},{key:"hasTexture",value:function(e){return this._texture===e}},{key:"getActiveTextures",value:function(e){this._texture&&e.push(this._texture)}},{key:"getAnimatables",value:function(e){this._texture&&this._texture.animations&&this._texture.animations.length>0&&e.push(this._texture)}},{key:"dispose",value:function(e){var t;e&&(null===(t=this._texture)||void 0===t||t.dispose())}},{key:"getClassName",value:function(){return"DetailMapConfiguration"}},{key:"getSamplers",value:function(e){e.push("detailSampler")}},{key:"getUniforms",value:function(){return{ubo:[{name:"vDetailInfos",size:4,type:"vec4"},{name:"detailMatrix",size:16,type:"mat4"}]}}}]),n}(en);function an(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,x.Z)(e);if(t){var r=(0,x.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,I.Z)(this,n)}}(0,C.gn)([(0,P.oU)("detailTexture"),(0,P.wz)("_markAllSubMeshesAsTexturesDirty")],rn.prototype,"texture",void 0),(0,C.gn)([(0,P.qC)()],rn.prototype,"diffuseBlendLevel",void 0),(0,C.gn)([(0,P.qC)()],rn.prototype,"roughnessBlendLevel",void 0),(0,C.gn)([(0,P.qC)()],rn.prototype,"bumpLevel",void 0),(0,C.gn)([(0,P.qC)(),(0,P.wz)("_markAllSubMeshesAsTexturesDirty")],rn.prototype,"normalBlendMethod",void 0),(0,C.gn)([(0,P.qC)(),(0,P.wz)("_markAllSubMeshesAsTexturesDirty")],rn.prototype,"isEnabled",void 0);var on={effect:null,subMesh:null},sn=function(e){(0,S.Z)(n,e);var t=an(n);function n(e){var i;return(0,E.Z)(this,n),(i=t.call(this,e)).MAINUV1=!1,i.MAINUV2=!1,i.MAINUV3=!1,i.MAINUV4=!1,i.MAINUV5=!1,i.MAINUV6=!1,i.DIFFUSE=!1,i.DIFFUSEDIRECTUV=0,i.BAKED_VERTEX_ANIMATION_TEXTURE=!1,i.AMBIENT=!1,i.AMBIENTDIRECTUV=0,i.OPACITY=!1,i.OPACITYDIRECTUV=0,i.OPACITYRGB=!1,i.REFLECTION=!1,i.EMISSIVE=!1,i.EMISSIVEDIRECTUV=0,i.SPECULAR=!1,i.SPECULARDIRECTUV=0,i.BUMP=!1,i.BUMPDIRECTUV=0,i.PARALLAX=!1,i.PARALLAXOCCLUSION=!1,i.SPECULAROVERALPHA=!1,i.CLIPPLANE=!1,i.CLIPPLANE2=!1,i.CLIPPLANE3=!1,i.CLIPPLANE4=!1,i.CLIPPLANE5=!1,i.CLIPPLANE6=!1,i.ALPHATEST=!1,i.DEPTHPREPASS=!1,i.ALPHAFROMDIFFUSE=!1,i.POINTSIZE=!1,i.FOG=!1,i.SPECULARTERM=!1,i.DIFFUSEFRESNEL=!1,i.OPACITYFRESNEL=!1,i.REFLECTIONFRESNEL=!1,i.REFRACTIONFRESNEL=!1,i.EMISSIVEFRESNEL=!1,i.FRESNEL=!1,i.NORMAL=!1,i.TANGENT=!1,i.UV1=!1,i.UV2=!1,i.UV3=!1,i.UV4=!1,i.UV5=!1,i.UV6=!1,i.VERTEXCOLOR=!1,i.VERTEXALPHA=!1,i.NUM_BONE_INFLUENCERS=0,i.BonesPerMesh=0,i.BONETEXTURE=!1,i.BONES_VELOCITY_ENABLED=!1,i.INSTANCES=!1,i.THIN_INSTANCES=!1,i.INSTANCESCOLOR=!1,i.GLOSSINESS=!1,i.ROUGHNESS=!1,i.EMISSIVEASILLUMINATION=!1,i.LINKEMISSIVEWITHDIFFUSE=!1,i.REFLECTIONFRESNELFROMSPECULAR=!1,i.LIGHTMAP=!1,i.LIGHTMAPDIRECTUV=0,i.OBJECTSPACE_NORMALMAP=!1,i.USELIGHTMAPASSHADOWMAP=!1,i.REFLECTIONMAP_3D=!1,i.REFLECTIONMAP_SPHERICAL=!1,i.REFLECTIONMAP_PLANAR=!1,i.REFLECTIONMAP_CUBIC=!1,i.USE_LOCAL_REFLECTIONMAP_CUBIC=!1,i.USE_LOCAL_REFRACTIONMAP_CUBIC=!1,i.REFLECTIONMAP_PROJECTION=!1,i.REFLECTIONMAP_SKYBOX=!1,i.REFLECTIONMAP_EXPLICIT=!1,i.REFLECTIONMAP_EQUIRECTANGULAR=!1,i.REFLECTIONMAP_EQUIRECTANGULAR_FIXED=!1,i.REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED=!1,i.REFLECTIONMAP_OPPOSITEZ=!1,i.INVERTCUBICMAP=!1,i.LOGARITHMICDEPTH=!1,i.REFRACTION=!1,i.REFRACTIONMAP_3D=!1,i.REFLECTIONOVERALPHA=!1,i.TWOSIDEDLIGHTING=!1,i.SHADOWFLOAT=!1,i.MORPHTARGETS=!1,i.MORPHTARGETS_NORMAL=!1,i.MORPHTARGETS_TANGENT=!1,i.MORPHTARGETS_UV=!1,i.NUM_MORPH_INFLUENCERS=0,i.MORPHTARGETS_TEXTURE=!1,i.NONUNIFORMSCALING=!1,i.PREMULTIPLYALPHA=!1,i.ALPHATEST_AFTERALLALPHACOMPUTATIONS=!1,i.ALPHABLEND=!0,i.PREPASS=!1,i.PREPASS_IRRADIANCE=!1,i.PREPASS_IRRADIANCE_INDEX=-1,i.PREPASS_ALBEDO_SQRT=!1,i.PREPASS_ALBEDO_SQRT_INDEX=-1,i.PREPASS_DEPTH=!1,i.PREPASS_DEPTH_INDEX=-1,i.PREPASS_NORMAL=!1,i.PREPASS_NORMAL_INDEX=-1,i.PREPASS_POSITION=!1,i.PREPASS_POSITION_INDEX=-1,i.PREPASS_VELOCITY=!1,i.PREPASS_VELOCITY_INDEX=-1,i.PREPASS_REFLECTIVITY=!1,i.PREPASS_REFLECTIVITY_INDEX=-1,i.SCENE_MRT_COUNT=0,i.RGBDLIGHTMAP=!1,i.RGBDREFLECTION=!1,i.RGBDREFRACTION=!1,i.IMAGEPROCESSING=!1,i.VIGNETTE=!1,i.VIGNETTEBLENDMODEMULTIPLY=!1,i.VIGNETTEBLENDMODEOPAQUE=!1,i.TONEMAPPING=!1,i.TONEMAPPING_ACES=!1,i.CONTRAST=!1,i.COLORCURVES=!1,i.COLORGRADING=!1,i.COLORGRADING3D=!1,i.SAMPLER3DGREENDEPTH=!1,i.SAMPLER3DBGRMAP=!1,i.DITHER=!1,i.IMAGEPROCESSINGPOSTPROCESS=!1,i.SKIPFINALCOLORCLAMP=!1,i.MULTIVIEW=!1,i.ORDER_INDEPENDENT_TRANSPARENCY=!1,i.ORDER_INDEPENDENT_TRANSPARENCY_16BITS=!1,i.IS_REFLECTION_LINEAR=!1,i.IS_REFRACTION_LINEAR=!1,i.EXPOSURE=!1,i.rebuild(),i}return(0,A.Z)(n,[{key:"setReflectionMode",value:function(e){for(var t=0,n=["REFLECTIONMAP_CUBIC","REFLECTIONMAP_EXPLICIT","REFLECTIONMAP_PLANAR","REFLECTIONMAP_PROJECTION","REFLECTIONMAP_PROJECTION","REFLECTIONMAP_SKYBOX","REFLECTIONMAP_SPHERICAL","REFLECTIONMAP_EQUIRECTANGULAR","REFLECTIONMAP_EQUIRECTANGULAR_FIXED","REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED"];t<n.length;t++){var i=n[t];this[i]=i===e}}}]),n}(_e.H),un=function(e){(0,S.Z)(n,e);var t=an(n);function n(e,i){var r;return(0,E.Z)(this,n),(r=t.call(this,e,i))._diffuseTexture=null,r._ambientTexture=null,r._opacityTexture=null,r._reflectionTexture=null,r._emissiveTexture=null,r._specularTexture=null,r._bumpTexture=null,r._lightmapTexture=null,r._refractionTexture=null,r.ambientColor=new f.Wo(0,0,0),r.diffuseColor=new f.Wo(1,1,1),r.specularColor=new f.Wo(1,1,1),r.emissiveColor=new f.Wo(0,0,0),r.specularPower=64,r._useAlphaFromDiffuseTexture=!1,r._useEmissiveAsIllumination=!1,r._linkEmissiveWithDiffuse=!1,r._useSpecularOverAlpha=!1,r._useReflectionOverAlpha=!1,r._disableLighting=!1,r._useObjectSpaceNormalMap=!1,r._useParallax=!1,r._useParallaxOcclusion=!1,r.parallaxScaleBias=.05,r._roughness=0,r.indexOfRefraction=.98,r.invertRefractionY=!0,r.alphaCutOff=.4,r._useLightmapAsShadowmap=!1,r._useReflectionFresnelFromSpecular=!1,r._useGlossinessFromSpecularMapAlpha=!1,r._maxSimultaneousLights=4,r._invertNormalMapX=!1,r._invertNormalMapY=!1,r._twoSidedLighting=!1,r._renderTargets=new fe.t(16),r._worldViewProjectionMatrix=h.y3.Zero(),r._globalAmbientColor=new f.Wo(0,0,0),r._cacheHasRenderTargetTextures=!1,r.detailMap=new rn((0,T.Z)(r)),r._attachImageProcessingConfiguration(null),r.prePassConfiguration=new pe,r.getRenderTargetTextures=function(){return r._renderTargets.reset(),n.ReflectionTextureEnabled&&r._reflectionTexture&&r._reflectionTexture.isRenderTarget&&r._renderTargets.push(r._reflectionTexture),n.RefractionTextureEnabled&&r._refractionTexture&&r._refractionTexture.isRenderTarget&&r._renderTargets.push(r._refractionTexture),r._eventInfo.renderTargets=r._renderTargets,r._callbackPluginEventFillRenderTargetTextures(r._eventInfo),r._renderTargets},r}return(0,A.Z)(n,[{key:"imageProcessingConfiguration",get:function(){return this._imageProcessingConfiguration},set:function(e){this._attachImageProcessingConfiguration(e),this._markAllSubMeshesAsTexturesDirty()}},{key:"_attachImageProcessingConfiguration",value:function(e){var t=this;e!==this._imageProcessingConfiguration&&(this._imageProcessingConfiguration&&this._imageProcessingObserver&&this._imageProcessingConfiguration.onUpdateParameters.remove(this._imageProcessingObserver),this._imageProcessingConfiguration=e||this.getScene().imageProcessingConfiguration,this._imageProcessingConfiguration&&(this._imageProcessingObserver=this._imageProcessingConfiguration.onUpdateParameters.add((function(){t._markAllSubMeshesAsImageProcessingDirty()}))))}},{key:"isPrePassCapable",get:function(){return!this.disableDepthWrite}},{key:"cameraColorCurvesEnabled",get:function(){return this.imageProcessingConfiguration.colorCurvesEnabled},set:function(e){this.imageProcessingConfiguration.colorCurvesEnabled=e}},{key:"cameraColorGradingEnabled",get:function(){return this.imageProcessingConfiguration.colorGradingEnabled},set:function(e){this.imageProcessingConfiguration.colorGradingEnabled=e}},{key:"cameraToneMappingEnabled",get:function(){return this._imageProcessingConfiguration.toneMappingEnabled},set:function(e){this._imageProcessingConfiguration.toneMappingEnabled=e}},{key:"cameraExposure",get:function(){return this._imageProcessingConfiguration.exposure},set:function(e){this._imageProcessingConfiguration.exposure=e}},{key:"cameraContrast",get:function(){return this._imageProcessingConfiguration.contrast},set:function(e){this._imageProcessingConfiguration.contrast=e}},{key:"cameraColorGradingTexture",get:function(){return this._imageProcessingConfiguration.colorGradingTexture},set:function(e){this._imageProcessingConfiguration.colorGradingTexture=e}},{key:"cameraColorCurves",get:function(){return this._imageProcessingConfiguration.colorCurves},set:function(e){this._imageProcessingConfiguration.colorCurves=e}},{key:"canRenderToMRT",get:function(){return!0}},{key:"hasRenderTargetTextures",get:function(){return!!(n.ReflectionTextureEnabled&&this._reflectionTexture&&this._reflectionTexture.isRenderTarget)||(!!(n.RefractionTextureEnabled&&this._refractionTexture&&this._refractionTexture.isRenderTarget)||this._cacheHasRenderTargetTextures)}},{key:"getClassName",value:function(){return"StandardMaterial"}},{key:"useLogarithmicDepth",get:function(){return this._useLogarithmicDepth},set:function(e){this._useLogarithmicDepth=e&&this.getScene().getEngine().getCaps().fragmentDepthSupported,this._markAllSubMeshesAsMiscDirty()}},{key:"needAlphaBlending",value:function(){return!this._disableAlphaBlending&&(this.alpha<1||null!=this._opacityTexture||this._shouldUseAlphaFromDiffuseTexture()||this._opacityFresnelParameters&&this._opacityFresnelParameters.isEnabled)}},{key:"needAlphaTesting",value:function(){return!!this._forceAlphaTest||this._hasAlphaChannel()&&(null==this._transparencyMode||this._transparencyMode===me.F.MATERIAL_ALPHATEST)}},{key:"_shouldUseAlphaFromDiffuseTexture",value:function(){return null!=this._diffuseTexture&&this._diffuseTexture.hasAlpha&&this._useAlphaFromDiffuseTexture&&this._transparencyMode!==me.F.MATERIAL_OPAQUE}},{key:"_hasAlphaChannel",value:function(){return null!=this._diffuseTexture&&this._diffuseTexture.hasAlpha||null!=this._opacityTexture}},{key:"getAlphaTestTexture",value:function(){return this._diffuseTexture}},{key:"isReadyForSubMesh",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this._uniformBufferLayoutBuilt||this.buildUniformLayout(),t.effect&&this.isFrozen&&t.effect._wasPreviouslyReady&&t.effect._wasPreviouslyUsingInstances===i)return!0;t.materialDefines||(this._callbackPluginEventGeneric(ge.S.GetDefineNames,this._eventInfo),t.materialDefines=new sn(this._eventInfo.defineNames));var r=this.getScene(),o=t.materialDefines;if(this._isReadyForSubMesh(t))return!0;var s=r.getEngine();o._needNormals=Ae.G.PrepareDefinesForLights(r,e,o,!0,this._maxSimultaneousLights,this._disableLighting),Ae.G.PrepareDefinesForMultiview(r,o);var u=this.needAlphaBlendingForMesh(e)&&this.getScene().useOrderIndependentTransparency;if(Ae.G.PrepareDefinesForPrePass(r,o,this.canRenderToMRT&&!u),Ae.G.PrepareDefinesForOIT(r,o,u),o._areTexturesDirty){this._eventInfo.hasRenderTargetTextures=!1,this._callbackPluginEventHasRenderTargetTextures(this._eventInfo),this._cacheHasRenderTargetTextures=this._eventInfo.hasRenderTargetTextures,o._needUVs=!1;for(var l=1;l<=6;++l)o["MAINUV"+l]=!1;if(r.texturesEnabled){if(o.DIFFUSEDIRECTUV=0,o.BUMPDIRECTUV=0,o.AMBIENTDIRECTUV=0,o.OPACITYDIRECTUV=0,o.EMISSIVEDIRECTUV=0,o.SPECULARDIRECTUV=0,o.LIGHTMAPDIRECTUV=0,this._diffuseTexture&&n.DiffuseTextureEnabled){if(!this._diffuseTexture.isReadyOrNotBlocking())return!1;Ae.G.PrepareDefinesForMergedUV(this._diffuseTexture,o,"DIFFUSE")}else o.DIFFUSE=!1;if(this._ambientTexture&&n.AmbientTextureEnabled){if(!this._ambientTexture.isReadyOrNotBlocking())return!1;Ae.G.PrepareDefinesForMergedUV(this._ambientTexture,o,"AMBIENT")}else o.AMBIENT=!1;if(this._opacityTexture&&n.OpacityTextureEnabled){if(!this._opacityTexture.isReadyOrNotBlocking())return!1;Ae.G.PrepareDefinesForMergedUV(this._opacityTexture,o,"OPACITY"),o.OPACITYRGB=this._opacityTexture.getAlphaFromRGB}else o.OPACITY=!1;if(this._reflectionTexture&&n.ReflectionTextureEnabled){if(!this._reflectionTexture.isReadyOrNotBlocking())return!1;switch(o._needNormals=!0,o.REFLECTION=!0,o.ROUGHNESS=this._roughness>0,o.REFLECTIONOVERALPHA=this._useReflectionOverAlpha,o.INVERTCUBICMAP=this._reflectionTexture.coordinatesMode===Be.INVCUBIC_MODE,o.REFLECTIONMAP_3D=this._reflectionTexture.isCube,o.REFLECTIONMAP_OPPOSITEZ=o.REFLECTIONMAP_3D&&this.getScene().useRightHandedSystem?!this._reflectionTexture.invertZ:this._reflectionTexture.invertZ,o.RGBDREFLECTION=this._reflectionTexture.isRGBD,this._reflectionTexture.coordinatesMode){case Be.EXPLICIT_MODE:o.setReflectionMode("REFLECTIONMAP_EXPLICIT");break;case Be.PLANAR_MODE:o.setReflectionMode("REFLECTIONMAP_PLANAR");break;case Be.PROJECTION_MODE:o.setReflectionMode("REFLECTIONMAP_PROJECTION");break;case Be.SKYBOX_MODE:o.setReflectionMode("REFLECTIONMAP_SKYBOX");break;case Be.SPHERICAL_MODE:o.setReflectionMode("REFLECTIONMAP_SPHERICAL");break;case Be.EQUIRECTANGULAR_MODE:o.setReflectionMode("REFLECTIONMAP_EQUIRECTANGULAR");break;case Be.FIXED_EQUIRECTANGULAR_MODE:o.setReflectionMode("REFLECTIONMAP_EQUIRECTANGULAR_FIXED");break;case Be.FIXED_EQUIRECTANGULAR_MIRRORED_MODE:o.setReflectionMode("REFLECTIONMAP_MIRROREDEQUIRECTANGULAR_FIXED");break;case Be.CUBIC_MODE:case Be.INVCUBIC_MODE:default:o.setReflectionMode("REFLECTIONMAP_CUBIC")}o.USE_LOCAL_REFLECTIONMAP_CUBIC=!!this._reflectionTexture.boundingBoxSize}else o.REFLECTION=!1,o.REFLECTIONMAP_OPPOSITEZ=!1;if(this._emissiveTexture&&n.EmissiveTextureEnabled){if(!this._emissiveTexture.isReadyOrNotBlocking())return!1;Ae.G.PrepareDefinesForMergedUV(this._emissiveTexture,o,"EMISSIVE")}else o.EMISSIVE=!1;if(this._lightmapTexture&&n.LightmapTextureEnabled){if(!this._lightmapTexture.isReadyOrNotBlocking())return!1;Ae.G.PrepareDefinesForMergedUV(this._lightmapTexture,o,"LIGHTMAP"),o.USELIGHTMAPASSHADOWMAP=this._useLightmapAsShadowmap,o.RGBDLIGHTMAP=this._lightmapTexture.isRGBD}else o.LIGHTMAP=!1;if(this._specularTexture&&n.SpecularTextureEnabled){if(!this._specularTexture.isReadyOrNotBlocking())return!1;Ae.G.PrepareDefinesForMergedUV(this._specularTexture,o,"SPECULAR"),o.GLOSSINESS=this._useGlossinessFromSpecularMapAlpha}else o.SPECULAR=!1;if(r.getEngine().getCaps().standardDerivatives&&this._bumpTexture&&n.BumpTextureEnabled){if(!this._bumpTexture.isReady())return!1;Ae.G.PrepareDefinesForMergedUV(this._bumpTexture,o,"BUMP"),o.PARALLAX=this._useParallax,o.PARALLAXOCCLUSION=this._useParallaxOcclusion,o.OBJECTSPACE_NORMALMAP=this._useObjectSpaceNormalMap}else o.BUMP=!1,o.PARALLAX=!1,o.PARALLAXOCCLUSION=!1;if(this._refractionTexture&&n.RefractionTextureEnabled){if(!this._refractionTexture.isReadyOrNotBlocking())return!1;o._needUVs=!0,o.REFRACTION=!0,o.REFRACTIONMAP_3D=this._refractionTexture.isCube,o.RGBDREFRACTION=this._refractionTexture.isRGBD,o.USE_LOCAL_REFRACTIONMAP_CUBIC=!!this._refractionTexture.boundingBoxSize}else o.REFRACTION=!1;o.TWOSIDEDLIGHTING=!this._backFaceCulling&&this._twoSidedLighting}else o.DIFFUSE=!1,o.AMBIENT=!1,o.OPACITY=!1,o.REFLECTION=!1,o.EMISSIVE=!1,o.LIGHTMAP=!1,o.BUMP=!1,o.REFRACTION=!1;o.ALPHAFROMDIFFUSE=this._shouldUseAlphaFromDiffuseTexture(),o.EMISSIVEASILLUMINATION=this._useEmissiveAsIllumination,o.LINKEMISSIVEWITHDIFFUSE=this._linkEmissiveWithDiffuse,o.SPECULAROVERALPHA=this._useSpecularOverAlpha,o.PREMULTIPLYALPHA=7===this.alphaMode||8===this.alphaMode,o.ALPHATEST_AFTERALLALPHACOMPUTATIONS=null!==this.transparencyMode,o.ALPHABLEND=null===this.transparencyMode||this.needAlphaBlendingForMesh(e)}if(this._eventInfo.isReadyForSubMesh=!0,this._eventInfo.defines=o,this._callbackPluginEventIsReadyForSubMesh(this._eventInfo),!this._eventInfo.isReadyForSubMesh)return!1;if(o._areImageProcessingDirty&&this._imageProcessingConfiguration){if(!this._imageProcessingConfiguration.isReady())return!1;this._imageProcessingConfiguration.prepareDefines(o),o.IS_REFLECTION_LINEAR=null!=this.reflectionTexture&&!this.reflectionTexture.gammaSpace,o.IS_REFRACTION_LINEAR=null!=this.refractionTexture&&!this.refractionTexture.gammaSpace}if(o._areFresnelDirty&&(n.FresnelEnabled?(this._diffuseFresnelParameters||this._opacityFresnelParameters||this._emissiveFresnelParameters||this._refractionFresnelParameters||this._reflectionFresnelParameters)&&(o.DIFFUSEFRESNEL=this._diffuseFresnelParameters&&this._diffuseFresnelParameters.isEnabled,o.OPACITYFRESNEL=this._opacityFresnelParameters&&this._opacityFresnelParameters.isEnabled,o.REFLECTIONFRESNEL=this._reflectionFresnelParameters&&this._reflectionFresnelParameters.isEnabled,o.REFLECTIONFRESNELFROMSPECULAR=this._useReflectionFresnelFromSpecular,o.REFRACTIONFRESNEL=this._refractionFresnelParameters&&this._refractionFresnelParameters.isEnabled,o.EMISSIVEFRESNEL=this._emissiveFresnelParameters&&this._emissiveFresnelParameters.isEnabled,o._needNormals=!0,o.FRESNEL=!0):o.FRESNEL=!1),Ae.G.PrepareDefinesForMisc(e,r,this._useLogarithmicDepth,this.pointsCloud,this.fogEnabled,this._shouldTurnAlphaTestOn(e)||this._forceAlphaTest,o),Ae.G.PrepareDefinesForFrameBoundValues(r,s,o,i,null,t.getRenderingMesh().hasThinInstances),this._eventInfo.defines=o,this._eventInfo.mesh=e,this._callbackPluginEventPrepareDefinesBeforeAttributes(this._eventInfo),Ae.G.PrepareDefinesForAttributes(e,o,!0,!0,!0),this._callbackPluginEventPrepareDefines(this._eventInfo),o.isDirty){var c=o._areLightsDisposed;o.markAsProcessed();var h=new Kt;o.REFLECTION&&h.addFallback(0,"REFLECTION"),o.SPECULAR&&h.addFallback(0,"SPECULAR"),o.BUMP&&h.addFallback(0,"BUMP"),o.PARALLAX&&h.addFallback(1,"PARALLAX"),o.PARALLAXOCCLUSION&&h.addFallback(0,"PARALLAXOCCLUSION"),o.SPECULAROVERALPHA&&h.addFallback(0,"SPECULAROVERALPHA"),o.FOG&&h.addFallback(1,"FOG"),o.POINTSIZE&&h.addFallback(0,"POINTSIZE"),o.LOGARITHMICDEPTH&&h.addFallback(0,"LOGARITHMICDEPTH"),Ae.G.HandleFallbacksForShadows(o,h,this._maxSimultaneousLights),o.SPECULARTERM&&h.addFallback(0,"SPECULARTERM"),o.DIFFUSEFRESNEL&&h.addFallback(1,"DIFFUSEFRESNEL"),o.OPACITYFRESNEL&&h.addFallback(2,"OPACITYFRESNEL"),o.REFLECTIONFRESNEL&&h.addFallback(3,"REFLECTIONFRESNEL"),o.EMISSIVEFRESNEL&&h.addFallback(4,"EMISSIVEFRESNEL"),o.FRESNEL&&h.addFallback(4,"FRESNEL"),o.MULTIVIEW&&h.addFallback(0,"MULTIVIEW");var f=[de.o.PositionKind];o.NORMAL&&f.push(de.o.NormalKind),o.TANGENT&&f.push(de.o.TangentKind);for(var d=1;d<=6;++d)o["UV"+d]&&f.push("uv".concat(1===d?"":d));o.VERTEXCOLOR&&f.push(de.o.ColorKind),Ae.G.PrepareAttributesForBones(f,e,o,h),Ae.G.PrepareAttributesForInstances(f,o),Ae.G.PrepareAttributesForMorphTargets(f,e,o),Ae.G.PrepareAttributesForBakedVertexAnimation(f,e,o);var p="default",v=["world","view","viewProjection","vEyePosition","vLightsType","vAmbientColor","vDiffuseColor","vSpecularColor","vEmissiveColor","visibility","vFogInfos","vFogColor","pointSize","vDiffuseInfos","vAmbientInfos","vOpacityInfos","vReflectionInfos","vEmissiveInfos","vSpecularInfos","vBumpInfos","vLightmapInfos","vRefractionInfos","mBones","vClipPlane","vClipPlane2","vClipPlane3","vClipPlane4","vClipPlane5","vClipPlane6","diffuseMatrix","ambientMatrix","opacityMatrix","reflectionMatrix","emissiveMatrix","specularMatrix","bumpMatrix","normalMatrix","lightmapMatrix","refractionMatrix","diffuseLeftColor","diffuseRightColor","opacityParts","reflectionLeftColor","reflectionRightColor","emissiveLeftColor","emissiveRightColor","refractionLeftColor","refractionRightColor","vReflectionPosition","vReflectionSize","vRefractionPosition","vRefractionSize","logarithmicDepthConstant","vTangentSpaceParams","alphaCutOff","boneTextureWidth","morphTargetTextureInfo","morphTargetTextureIndices"],m=["diffuseSampler","ambientSampler","opacitySampler","reflectionCubeSampler","reflection2DSampler","emissiveSampler","specularSampler","bumpSampler","lightmapSampler","refractionCubeSampler","refraction2DSampler","boneSampler","morphTargets","oitDepthSampler","oitFrontColorSampler"],g=["Material","Scene","Mesh"];this._eventInfo.fallbacks=h,this._eventInfo.fallbackRank=0,this._eventInfo.defines=o,this._eventInfo.uniforms=v,this._eventInfo.attributes=f,this._eventInfo.samplers=m,this._eventInfo.uniformBuffersNames=g,this._eventInfo.customCode=void 0,this._eventInfo.mesh=e,this._callbackPluginEventGeneric(ge.S.PrepareEffect,this._eventInfo),pe.AddUniforms(v),pe.AddSamplers(m),ve.$&&(ve.$.PrepareUniforms(v,o),ve.$.PrepareSamplers(m,o)),Ae.G.PrepareUniformsAndSamplersList({uniformsNames:v,uniformBuffersNames:g,samplers:m,defines:o,maxSimultaneousLights:this._maxSimultaneousLights});var _={};this.customShaderNameResolve&&(p=this.customShaderNameResolve(p,v,g,m,o,f,_));var y=o.toString(),E=t.effect,A=r.getEngine().createEffect(p,{attributes:f,uniformsNames:v,uniformBuffersNames:g,samplers:m,defines:y,fallbacks:h,onCompiled:this.onCompiled,onError:this.onError,indexParameters:{maxSimultaneousLights:this._maxSimultaneousLights,maxSimultaneousMorphTargets:o.NUM_MORPH_INFLUENCERS},processFinalCode:_.processFinalCode,processCodeAfterIncludes:this._eventInfo.customCode,multiTarget:o.PREPASS},s);if(A)if(this._onEffectCreatedObservable&&(on.effect=A,on.subMesh=t,this._onEffectCreatedObservable.notifyObservers(on)),this.allowShaderHotSwapping&&E&&!A.isReady()){if(A=E,o.markAsUnprocessed(),c)return o._areLightsDisposed=!0,!1}else r.resetCachedMaterial(),t.setEffect(A,o,this._materialContext)}return!(!t.effect||!t.effect.isReady())&&(o._renderId=r.getRenderId(),t.effect._wasPreviouslyReady=!0,t.effect._wasPreviouslyUsingInstances=i,r.performancePriority!==a.a.BackwardCompatible&&(this.checkReadyOnlyOnce=!0),!0)}},{key:"buildUniformLayout",value:function(){var e=this._uniformBuffer;e.addUniform("diffuseLeftColor",4),e.addUniform("diffuseRightColor",4),e.addUniform("opacityParts",4),e.addUniform("reflectionLeftColor",4),e.addUniform("reflectionRightColor",4),e.addUniform("refractionLeftColor",4),e.addUniform("refractionRightColor",4),e.addUniform("emissiveLeftColor",4),e.addUniform("emissiveRightColor",4),e.addUniform("vDiffuseInfos",2),e.addUniform("vAmbientInfos",2),e.addUniform("vOpacityInfos",2),e.addUniform("vReflectionInfos",2),e.addUniform("vReflectionPosition",3),e.addUniform("vReflectionSize",3),e.addUniform("vEmissiveInfos",2),e.addUniform("vLightmapInfos",2),e.addUniform("vSpecularInfos",2),e.addUniform("vBumpInfos",3),e.addUniform("diffuseMatrix",16),e.addUniform("ambientMatrix",16),e.addUniform("opacityMatrix",16),e.addUniform("reflectionMatrix",16),e.addUniform("emissiveMatrix",16),e.addUniform("lightmapMatrix",16),e.addUniform("specularMatrix",16),e.addUniform("bumpMatrix",16),e.addUniform("vTangentSpaceParams",2),e.addUniform("pointSize",1),e.addUniform("alphaCutOff",1),e.addUniform("refractionMatrix",16),e.addUniform("vRefractionInfos",4),e.addUniform("vRefractionPosition",3),e.addUniform("vRefractionSize",3),e.addUniform("vSpecularColor",4),e.addUniform("vEmissiveColor",3),e.addUniform("vDiffuseColor",4),e.addUniform("vAmbientColor",3),(0,M.Z)((0,x.Z)(n.prototype),"buildUniformLayout",this).call(this)}},{key:"bindForSubMesh",value:function(e,t,i){var r=this.getScene(),o=i.materialDefines;if(o){var s=i.effect;if(s){this._activeEffect=s,t.getMeshUniformBuffer().bindToEffect(s,"Mesh"),t.transferToEffect(e),this._uniformBuffer.bindToEffect(s,"Material"),this.prePassConfiguration.bindForSubMesh(this._activeEffect,r,t,e,this.isFrozen),this._eventInfo.subMesh=i,this._callbackPluginEventHardBindForSubMesh(this._eventInfo),o.OBJECTSPACE_NORMALMAP&&(e.toNormalMatrix(this._normalMatrix),this.bindOnlyNormalMatrix(this._normalMatrix));var u=this._mustRebind(r,s,t.visibility);Ae.G.BindBonesParameters(t,s);var l=this._uniformBuffer;if(u){if(this.bindViewProjection(s),!l.useUbo||!this.isFrozen||!l.isSync){if(n.FresnelEnabled&&o.FRESNEL&&(this.diffuseFresnelParameters&&this.diffuseFresnelParameters.isEnabled&&(l.updateColor4("diffuseLeftColor",this.diffuseFresnelParameters.leftColor,this.diffuseFresnelParameters.power),l.updateColor4("diffuseRightColor",this.diffuseFresnelParameters.rightColor,this.diffuseFresnelParameters.bias)),this.opacityFresnelParameters&&this.opacityFresnelParameters.isEnabled&&l.updateColor4("opacityParts",new f.Wo(this.opacityFresnelParameters.leftColor.toLuminance(),this.opacityFresnelParameters.rightColor.toLuminance(),this.opacityFresnelParameters.bias),this.opacityFresnelParameters.power),this.reflectionFresnelParameters&&this.reflectionFresnelParameters.isEnabled&&(l.updateColor4("reflectionLeftColor",this.reflectionFresnelParameters.leftColor,this.reflectionFresnelParameters.power),l.updateColor4("reflectionRightColor",this.reflectionFresnelParameters.rightColor,this.reflectionFresnelParameters.bias)),this.refractionFresnelParameters&&this.refractionFresnelParameters.isEnabled&&(l.updateColor4("refractionLeftColor",this.refractionFresnelParameters.leftColor,this.refractionFresnelParameters.power),l.updateColor4("refractionRightColor",this.refractionFresnelParameters.rightColor,this.refractionFresnelParameters.bias)),this.emissiveFresnelParameters&&this.emissiveFresnelParameters.isEnabled&&(l.updateColor4("emissiveLeftColor",this.emissiveFresnelParameters.leftColor,this.emissiveFresnelParameters.power),l.updateColor4("emissiveRightColor",this.emissiveFresnelParameters.rightColor,this.emissiveFresnelParameters.bias))),r.texturesEnabled){if(this._diffuseTexture&&n.DiffuseTextureEnabled&&(l.updateFloat2("vDiffuseInfos",this._diffuseTexture.coordinatesIndex,this._diffuseTexture.level),Ae.G.BindTextureMatrix(this._diffuseTexture,l,"diffuse")),this._ambientTexture&&n.AmbientTextureEnabled&&(l.updateFloat2("vAmbientInfos",this._ambientTexture.coordinatesIndex,this._ambientTexture.level),Ae.G.BindTextureMatrix(this._ambientTexture,l,"ambient")),this._opacityTexture&&n.OpacityTextureEnabled&&(l.updateFloat2("vOpacityInfos",this._opacityTexture.coordinatesIndex,this._opacityTexture.level),Ae.G.BindTextureMatrix(this._opacityTexture,l,"opacity")),this._hasAlphaChannel()&&l.updateFloat("alphaCutOff",this.alphaCutOff),this._reflectionTexture&&n.ReflectionTextureEnabled&&(l.updateFloat2("vReflectionInfos",this._reflectionTexture.level,this.roughness),l.updateMatrix("reflectionMatrix",this._reflectionTexture.getReflectionTextureMatrix()),this._reflectionTexture.boundingBoxSize)){var c=this._reflectionTexture;l.updateVector3("vReflectionPosition",c.boundingBoxPosition),l.updateVector3("vReflectionSize",c.boundingBoxSize)}if(this._emissiveTexture&&n.EmissiveTextureEnabled&&(l.updateFloat2("vEmissiveInfos",this._emissiveTexture.coordinatesIndex,this._emissiveTexture.level),Ae.G.BindTextureMatrix(this._emissiveTexture,l,"emissive")),this._lightmapTexture&&n.LightmapTextureEnabled&&(l.updateFloat2("vLightmapInfos",this._lightmapTexture.coordinatesIndex,this._lightmapTexture.level),Ae.G.BindTextureMatrix(this._lightmapTexture,l,"lightmap")),this._specularTexture&&n.SpecularTextureEnabled&&(l.updateFloat2("vSpecularInfos",this._specularTexture.coordinatesIndex,this._specularTexture.level),Ae.G.BindTextureMatrix(this._specularTexture,l,"specular")),this._bumpTexture&&r.getEngine().getCaps().standardDerivatives&&n.BumpTextureEnabled&&(l.updateFloat3("vBumpInfos",this._bumpTexture.coordinatesIndex,1/this._bumpTexture.level,this.parallaxScaleBias),Ae.G.BindTextureMatrix(this._bumpTexture,l,"bump"),r._mirroredCameraPosition?l.updateFloat2("vTangentSpaceParams",this._invertNormalMapX?1:-1,this._invertNormalMapY?1:-1):l.updateFloat2("vTangentSpaceParams",this._invertNormalMapX?-1:1,this._invertNormalMapY?-1:1)),this._refractionTexture&&n.RefractionTextureEnabled){var h=1;if(this._refractionTexture.isCube||(l.updateMatrix("refractionMatrix",this._refractionTexture.getReflectionTextureMatrix()),this._refractionTexture.depth&&(h=this._refractionTexture.depth)),l.updateFloat4("vRefractionInfos",this._refractionTexture.level,this.indexOfRefraction,h,this.invertRefractionY?-1:1),this._refractionTexture.boundingBoxSize){var d=this._refractionTexture;l.updateVector3("vRefractionPosition",d.boundingBoxPosition),l.updateVector3("vRefractionSize",d.boundingBoxSize)}}}this.pointsCloud&&l.updateFloat("pointSize",this.pointSize),o.SPECULARTERM&&l.updateColor4("vSpecularColor",this.specularColor,this.specularPower),l.updateColor3("vEmissiveColor",n.EmissiveTextureEnabled?this.emissiveColor:f.Wo.BlackReadOnly),l.updateColor4("vDiffuseColor",this.diffuseColor,this.alpha),r.ambientColor.multiplyToRef(this.ambientColor,this._globalAmbientColor),l.updateColor3("vAmbientColor",this._globalAmbientColor)}r.texturesEnabled&&(this._diffuseTexture&&n.DiffuseTextureEnabled&&s.setTexture("diffuseSampler",this._diffuseTexture),this._ambientTexture&&n.AmbientTextureEnabled&&s.setTexture("ambientSampler",this._ambientTexture),this._opacityTexture&&n.OpacityTextureEnabled&&s.setTexture("opacitySampler",this._opacityTexture),this._reflectionTexture&&n.ReflectionTextureEnabled&&(this._reflectionTexture.isCube?s.setTexture("reflectionCubeSampler",this._reflectionTexture):s.setTexture("reflection2DSampler",this._reflectionTexture)),this._emissiveTexture&&n.EmissiveTextureEnabled&&s.setTexture("emissiveSampler",this._emissiveTexture),this._lightmapTexture&&n.LightmapTextureEnabled&&s.setTexture("lightmapSampler",this._lightmapTexture),this._specularTexture&&n.SpecularTextureEnabled&&s.setTexture("specularSampler",this._specularTexture),this._bumpTexture&&r.getEngine().getCaps().standardDerivatives&&n.BumpTextureEnabled&&s.setTexture("bumpSampler",this._bumpTexture),this._refractionTexture&&n.RefractionTextureEnabled&&(this._refractionTexture.isCube?s.setTexture("refractionCubeSampler",this._refractionTexture):s.setTexture("refraction2DSampler",this._refractionTexture))),this.getScene().useOrderIndependentTransparency&&this.needAlphaBlendingForMesh(t)&&this.getScene().depthPeelingRenderer.bind(s),this._eventInfo.subMesh=i,this._callbackPluginEventBindForSubMesh(this._eventInfo),Ae.G.BindClipPlane(s,r),this.bindEyePosition(s)}else r.getEngine()._features.needToAlwaysBindUniformBuffers&&(this._needToBindSceneUbo=!0);if(u||!this.isFrozen){var p;if(r.lightsEnabled&&!this._disableLighting&&Ae.G.BindLights(r,t,s,o,this._maxSimultaneousLights),(r.fogEnabled&&t.applyFog&&r.fogMode!==a.x.FOGMODE_NONE||this._reflectionTexture||this._refractionTexture||t.receiveShadows||o.PREPASS)&&this.bindView(s),Ae.G.BindFogParameters(r,t,s),o.NUM_MORPH_INFLUENCERS&&Ae.G.BindMorphTargetParameters(t,s),o.BAKED_VERTEX_ANIMATION_TEXTURE)null===(p=t.bakedVertexAnimationManager)||void 0===p||p.bind(s,o.INSTANCES);this.useLogarithmicDepth&&Ae.G.BindLogDepth(o,s,r),this._imageProcessingConfiguration&&!this._imageProcessingConfiguration.applyByPostProcess&&this._imageProcessingConfiguration.bind(this._activeEffect)}this._afterBind(t,this._activeEffect),l.update()}}}},{key:"getAnimatables",value:function(){var e=(0,M.Z)((0,x.Z)(n.prototype),"getAnimatables",this).call(this);return this._diffuseTexture&&this._diffuseTexture.animations&&this._diffuseTexture.animations.length>0&&e.push(this._diffuseTexture),this._ambientTexture&&this._ambientTexture.animations&&this._ambientTexture.animations.length>0&&e.push(this._ambientTexture),this._opacityTexture&&this._opacityTexture.animations&&this._opacityTexture.animations.length>0&&e.push(this._opacityTexture),this._reflectionTexture&&this._reflectionTexture.animations&&this._reflectionTexture.animations.length>0&&e.push(this._reflectionTexture),this._emissiveTexture&&this._emissiveTexture.animations&&this._emissiveTexture.animations.length>0&&e.push(this._emissiveTexture),this._specularTexture&&this._specularTexture.animations&&this._specularTexture.animations.length>0&&e.push(this._specularTexture),this._bumpTexture&&this._bumpTexture.animations&&this._bumpTexture.animations.length>0&&e.push(this._bumpTexture),this._lightmapTexture&&this._lightmapTexture.animations&&this._lightmapTexture.animations.length>0&&e.push(this._lightmapTexture),this._refractionTexture&&this._refractionTexture.animations&&this._refractionTexture.animations.length>0&&e.push(this._refractionTexture),e}},{key:"getActiveTextures",value:function(){var e=(0,M.Z)((0,x.Z)(n.prototype),"getActiveTextures",this).call(this);return this._diffuseTexture&&e.push(this._diffuseTexture),this._ambientTexture&&e.push(this._ambientTexture),this._opacityTexture&&e.push(this._opacityTexture),this._reflectionTexture&&e.push(this._reflectionTexture),this._emissiveTexture&&e.push(this._emissiveTexture),this._specularTexture&&e.push(this._specularTexture),this._bumpTexture&&e.push(this._bumpTexture),this._lightmapTexture&&e.push(this._lightmapTexture),this._refractionTexture&&e.push(this._refractionTexture),e}},{key:"hasTexture",value:function(e){return!!(0,M.Z)((0,x.Z)(n.prototype),"hasTexture",this).call(this,e)||(this._diffuseTexture===e||(this._ambientTexture===e||(this._opacityTexture===e||(this._reflectionTexture===e||(this._emissiveTexture===e||(this._specularTexture===e||(this._bumpTexture===e||(this._lightmapTexture===e||this._refractionTexture===e))))))))}},{key:"dispose",value:function(e,t){var i,r,a,o,s,u,l,c,h;t&&(null===(i=this._diffuseTexture)||void 0===i||i.dispose(),null===(r=this._ambientTexture)||void 0===r||r.dispose(),null===(a=this._opacityTexture)||void 0===a||a.dispose(),null===(o=this._reflectionTexture)||void 0===o||o.dispose(),null===(s=this._emissiveTexture)||void 0===s||s.dispose(),null===(u=this._specularTexture)||void 0===u||u.dispose(),null===(l=this._bumpTexture)||void 0===l||l.dispose(),null===(c=this._lightmapTexture)||void 0===c||c.dispose(),null===(h=this._refractionTexture)||void 0===h||h.dispose());this._imageProcessingConfiguration&&this._imageProcessingObserver&&this._imageProcessingConfiguration.onUpdateParameters.remove(this._imageProcessingObserver),(0,M.Z)((0,x.Z)(n.prototype),"dispose",this).call(this,e,t)}},{key:"clone",value:function(e){var t=this,i=P.p4.Clone((function(){return new n(e,t.getScene())}),this);return i.name=e,i.id=e,this.stencil.copyTo(i.stencil),i}}],[{key:"Parse",value:function(e,t,i){var r=P.p4.Parse((function(){return new n(e.name,t)}),e,t,i);return e.stencil&&r.stencil.parse(e.stencil,t,i),r}},{key:"DiffuseTextureEnabled",get:function(){return Ue.DiffuseTextureEnabled},set:function(e){Ue.DiffuseTextureEnabled=e}},{key:"DetailTextureEnabled",get:function(){return Ue.DetailTextureEnabled},set:function(e){Ue.DetailTextureEnabled=e}},{key:"AmbientTextureEnabled",get:function(){return Ue.AmbientTextureEnabled},set:function(e){Ue.AmbientTextureEnabled=e}},{key:"OpacityTextureEnabled",get:function(){return Ue.OpacityTextureEnabled},set:function(e){Ue.OpacityTextureEnabled=e}},{key:"ReflectionTextureEnabled",get:function(){return Ue.ReflectionTextureEnabled},set:function(e){Ue.ReflectionTextureEnabled=e}},{key:"EmissiveTextureEnabled",get:function(){return Ue.EmissiveTextureEnabled},set:function(e){Ue.EmissiveTextureEnabled=e}},{key:"SpecularTextureEnabled",get:function(){return Ue.SpecularTextureEnabled},set:function(e){Ue.SpecularTextureEnabled=e}},{key:"BumpTextureEnabled",get:function(){return Ue.BumpTextureEnabled},set:function(e){Ue.BumpTextureEnabled=e}},{key:"LightmapTextureEnabled",get:function(){return Ue.LightmapTextureEnabled},set:function(e){Ue.LightmapTextureEnabled=e}},{key:"RefractionTextureEnabled",get:function(){return Ue.RefractionTextureEnabled},set:function(e){Ue.RefractionTextureEnabled=e}},{key:"ColorGradingTextureEnabled",get:function(){return Ue.ColorGradingTextureEnabled},set:function(e){Ue.ColorGradingTextureEnabled=e}},{key:"FresnelEnabled",get:function(){return Ue.FresnelEnabled},set:function(e){Ue.FresnelEnabled=e}}]),n}(Ee);(0,C.gn)([(0,P.oU)("diffuseTexture")],un.prototype,"_diffuseTexture",void 0),(0,C.gn)([(0,P.wz)("_markAllSubMeshesAsTexturesAndMiscDirty")],un.prototype,"diffuseTexture",void 0),(0,C.gn)([(0,P.oU)("ambientTexture")],un.prototype,"_ambientTexture",void 0),(0,C.gn)([(0,P.wz)("_markAllSubMeshesAsTexturesDirty")],un.prototype,"ambientTexture",void 0),(0,C.gn)([(0,P.oU)("opacityTexture")],un.prototype,"_opacityTexture",void 0),(0,C.gn)([(0,P.wz)("_markAllSubMeshesAsTexturesAndMiscDirty")],un.prototype,"opacityTexture",void 0),(0,C.gn)([(0,P.oU)("reflectionTexture")],un.prototype,"_reflectionTexture",void 0),(0,C.gn)([(0,P.wz)("_markAllSubMeshesAsTexturesDirty")],un.prototype,"reflectionTexture",void 0),(0,C.gn)([(0,P.oU)("emissiveTexture")],un.prototype,"_emissiveTexture",void 0),(0,C.gn)([(0,P.wz)("_markAllSubMeshesAsTexturesDirty")],un.prototype,"emissiveTexture",void 0),(0,C.gn)([(0,P.oU)("specularTexture")],un.prototype,"_specularTexture",void 0),(0,C.gn)([(0,P.wz)("_markAllSubMeshesAsTexturesDirty")],un.prototype,"specularTexture",void 0),(0,C.gn)([(0,P.oU)("bumpTexture")],un.prototype,"_bumpTexture",void 0),(0,C.gn)([(0,P.wz)("_markAllSubMeshesAsTexturesDirty")],un.prototype,"bumpTexture",void 0),(0,C.gn)([(0,P.oU)("lightmapTexture")],un.prototype,"_lightmapTexture",void 0),(0,C.gn)([(0,P.wz)("_markAllSubMeshesAsTexturesDirty")],un.prototype,"lightmapTexture",void 0),(0,C.gn)([(0,P.oU)("refractionTexture")],un.prototype,"_refractionTexture",void 0),(0,C.gn)([(0,P.wz)("_markAllSubMeshesAsTexturesDirty")],un.prototype,"refractionTexture",void 0),(0,C.gn)([(0,P.n9)("ambient")],un.prototype,"ambientColor",void 0),(0,C.gn)([(0,P.n9)("diffuse")],un.prototype,"diffuseColor",void 0),(0,C.gn)([(0,P.n9)("specular")],un.prototype,"specularColor",void 0),(0,C.gn)([(0,P.n9)("emissive")],un.prototype,"emissiveColor",void 0),(0,C.gn)([(0,P.qC)()],un.prototype,"specularPower",void 0),(0,C.gn)([(0,P.qC)("useAlphaFromDiffuseTexture")],un.prototype,"_useAlphaFromDiffuseTexture",void 0),(0,C.gn)([(0,P.wz)("_markAllSubMeshesAsTexturesAndMiscDirty")],un.prototype,"useAlphaFromDiffuseTexture",void 0),(0,C.gn)([(0,P.qC)("useEmissiveAsIllumination")],un.prototype,"_useEmissiveAsIllumination",void 0),(0,C.gn)([(0,P.wz)("_markAllSubMeshesAsTexturesDirty")],un.prototype,"useEmissiveAsIllumination",void 0),(0,C.gn)([(0,P.qC)("linkEmissiveWithDiffuse")],un.prototype,"_linkEmissiveWithDiffuse",void 0),(0,C.gn)([(0,P.wz)("_markAllSubMeshesAsTexturesDirty")],un.prototype,"linkEmissiveWithDiffuse",void 0),(0,C.gn)([(0,P.qC)("useSpecularOverAlpha")],un.prototype,"_useSpecularOverAlpha",void 0),(0,C.gn)([(0,P.wz)("_markAllSubMeshesAsTexturesDirty")],un.prototype,"useSpecularOverAlpha",void 0),(0,C.gn)([(0,P.qC)("useReflectionOverAlpha")],un.prototype,"_useReflectionOverAlpha",void 0),(0,C.gn)([(0,P.wz)("_markAllSubMeshesAsTexturesDirty")],un.prototype,"useReflectionOverAlpha",void 0),(0,C.gn)([(0,P.qC)("disableLighting")],un.prototype,"_disableLighting",void 0),(0,C.gn)([(0,P.wz)("_markAllSubMeshesAsLightsDirty")],un.prototype,"disableLighting",void 0),(0,C.gn)([(0,P.qC)("useObjectSpaceNormalMap")],un.prototype,"_useObjectSpaceNormalMap",void 0),(0,C.gn)([(0,P.wz)("_markAllSubMeshesAsTexturesDirty")],un.prototype,"useObjectSpaceNormalMap",void 0),(0,C.gn)([(0,P.qC)("useParallax")],un.prototype,"_useParallax",void 0),(0,C.gn)([(0,P.wz)("_markAllSubMeshesAsTexturesDirty")],un.prototype,"useParallax",void 0),(0,C.gn)([(0,P.qC)("useParallaxOcclusion")],un.prototype,"_useParallaxOcclusion",void 0),(0,C.gn)([(0,P.wz)("_markAllSubMeshesAsTexturesDirty")],un.prototype,"useParallaxOcclusion",void 0),(0,C.gn)([(0,P.qC)()],un.prototype,"parallaxScaleBias",void 0),(0,C.gn)([(0,P.qC)("roughness")],un.prototype,"_roughness",void 0),(0,C.gn)([(0,P.wz)("_markAllSubMeshesAsTexturesDirty")],un.prototype,"roughness",void 0),(0,C.gn)([(0,P.qC)()],un.prototype,"indexOfRefraction",void 0),(0,C.gn)([(0,P.qC)()],un.prototype,"invertRefractionY",void 0),(0,C.gn)([(0,P.qC)()],un.prototype,"alphaCutOff",void 0),(0,C.gn)([(0,P.qC)("useLightmapAsShadowmap")],un.prototype,"_useLightmapAsShadowmap",void 0),(0,C.gn)([(0,P.wz)("_markAllSubMeshesAsTexturesDirty")],un.prototype,"useLightmapAsShadowmap",void 0),(0,C.gn)([(0,P.qQ)("diffuseFresnelParameters")],un.prototype,"_diffuseFresnelParameters",void 0),(0,C.gn)([(0,P.wz)("_markAllSubMeshesAsFresnelDirty")],un.prototype,"diffuseFresnelParameters",void 0),(0,C.gn)([(0,P.qQ)("opacityFresnelParameters")],un.prototype,"_opacityFresnelParameters",void 0),(0,C.gn)([(0,P.wz)("_markAllSubMeshesAsFresnelAndMiscDirty")],un.prototype,"opacityFresnelParameters",void 0),(0,C.gn)([(0,P.qQ)("reflectionFresnelParameters")],un.prototype,"_reflectionFresnelParameters",void 0),(0,C.gn)([(0,P.wz)("_markAllSubMeshesAsFresnelDirty")],un.prototype,"reflectionFresnelParameters",void 0),(0,C.gn)([(0,P.qQ)("refractionFresnelParameters")],un.prototype,"_refractionFresnelParameters",void 0),(0,C.gn)([(0,P.wz)("_markAllSubMeshesAsFresnelDirty")],un.prototype,"refractionFresnelParameters",void 0),(0,C.gn)([(0,P.qQ)("emissiveFresnelParameters")],un.prototype,"_emissiveFresnelParameters",void 0),(0,C.gn)([(0,P.wz)("_markAllSubMeshesAsFresnelDirty")],un.prototype,"emissiveFresnelParameters",void 0),(0,C.gn)([(0,P.qC)("useReflectionFresnelFromSpecular")],un.prototype,"_useReflectionFresnelFromSpecular",void 0),(0,C.gn)([(0,P.wz)("_markAllSubMeshesAsFresnelDirty")],un.prototype,"useReflectionFresnelFromSpecular",void 0),(0,C.gn)([(0,P.qC)("useGlossinessFromSpecularMapAlpha")],un.prototype,"_useGlossinessFromSpecularMapAlpha",void 0),(0,C.gn)([(0,P.wz)("_markAllSubMeshesAsTexturesDirty")],un.prototype,"useGlossinessFromSpecularMapAlpha",void 0),(0,C.gn)([(0,P.qC)("maxSimultaneousLights")],un.prototype,"_maxSimultaneousLights",void 0),(0,C.gn)([(0,P.wz)("_markAllSubMeshesAsLightsDirty")],un.prototype,"maxSimultaneousLights",void 0),(0,C.gn)([(0,P.qC)("invertNormalMapX")],un.prototype,"_invertNormalMapX",void 0),(0,C.gn)([(0,P.wz)("_markAllSubMeshesAsTexturesDirty")],un.prototype,"invertNormalMapX",void 0),(0,C.gn)([(0,P.qC)("invertNormalMapY")],un.prototype,"_invertNormalMapY",void 0),(0,C.gn)([(0,P.wz)("_markAllSubMeshesAsTexturesDirty")],un.prototype,"invertNormalMapY",void 0),(0,C.gn)([(0,P.qC)("twoSidedLighting")],un.prototype,"_twoSidedLighting",void 0),(0,C.gn)([(0,P.wz)("_markAllSubMeshesAsTexturesDirty")],un.prototype,"twoSidedLighting",void 0),(0,C.gn)([(0,P.qC)()],un.prototype,"useLogarithmicDepth",null),(0,V.H)("BABYLON.StandardMaterial",un),a.x.DefaultMaterialFactory=function(e){return new un("default material",e)};var ln=n(2668),cn=n(9370),hn=n(3192);function fn(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return dn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return dn(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function dn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function pn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,x.Z)(e);if(t){var r=(0,x.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,I.Z)(this,n)}}o.Kj._instancedMeshFactory=function(e,t){var n=new vn(e,t);if(t.instancedBuffers)for(var i in n.instancedBuffers={},t.instancedBuffers)n.instancedBuffers[i]=t.instancedBuffers[i];return n};var vn=function(e){(0,S.Z)(n,e);var t=pn(n);function n(e,i){var r;(0,E.Z)(this,n),(r=t.call(this,e,i.getScene()))._indexInSourceMeshInstanceArray=-1,r._distanceToCamera=0,i.addInstance((0,T.Z)(r)),r._sourceMesh=i,r._unIndexed=i._unIndexed,r.position.copyFrom(i.position),r.rotation.copyFrom(i.rotation),r.scaling.copyFrom(i.scaling),i.rotationQuaternion&&(r.rotationQuaternion=i.rotationQuaternion.clone()),r.animations=i.animations.slice();var a,o=fn(i.getAnimationRanges());try{for(o.s();!(a=o.n()).done;){var s=a.value;null!=s&&r.createAnimationRange(s.name,s.from,s.to)}}catch(u){o.e(u)}finally{o.f()}return r.infiniteDistance=i.infiniteDistance,r.setPivotMatrix(i.getPivotMatrix()),r.refreshBoundingInfo(!0,!0),r._syncSubMeshes(),r}return(0,A.Z)(n,[{key:"getClassName",value:function(){return"InstancedMesh"}},{key:"lightSources",get:function(){return this._sourceMesh._lightSources}},{key:"_resyncLightSources",value:function(){}},{key:"_resyncLightSource",value:function(){}},{key:"_removeLightSource",value:function(){}},{key:"receiveShadows",get:function(){return this._sourceMesh.receiveShadows}},{key:"material",get:function(){return this._sourceMesh.material}},{key:"visibility",get:function(){return this._sourceMesh.visibility}},{key:"skeleton",get:function(){return this._sourceMesh.skeleton}},{key:"renderingGroupId",get:function(){return this._sourceMesh.renderingGroupId},set:function(e){this._sourceMesh&&e!==this._sourceMesh.renderingGroupId&&Q.Y.Warn("Note - setting renderingGroupId of an instanced mesh has no effect on the scene")}},{key:"getTotalVertices",value:function(){return this._sourceMesh?this._sourceMesh.getTotalVertices():0}},{key:"getTotalIndices",value:function(){return this._sourceMesh.getTotalIndices()}},{key:"sourceMesh",get:function(){return this._sourceMesh}},{key:"createInstance",value:function(e){return this._sourceMesh.createInstance(e)}},{key:"isReady",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._sourceMesh.isReady(e,!0)}},{key:"getVerticesData",value:function(e,t){return this._sourceMesh.getVerticesData(e,t)}},{key:"setVerticesData",value:function(e,t,n,i){return this.sourceMesh&&this.sourceMesh.setVerticesData(e,t,n,i),this.sourceMesh}},{key:"updateVerticesData",value:function(e,t,n,i){return this.sourceMesh&&this.sourceMesh.updateVerticesData(e,t,n,i),this.sourceMesh}},{key:"setIndices",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.sourceMesh&&this.sourceMesh.setIndices(e,t),this.sourceMesh}},{key:"isVerticesDataPresent",value:function(e){return this._sourceMesh.isVerticesDataPresent(e)}},{key:"getIndices",value:function(){return this._sourceMesh.getIndices()}},{key:"_positions",get:function(){return this._sourceMesh._positions}},{key:"refreshBoundingInfo",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.hasBoundingInfo&&this.getBoundingInfo().isLocked)return this;var n=this._sourceMesh.geometry?this._sourceMesh.geometry.boundingBias:null;return this._refreshBoundingInfo(this._sourceMesh._getPositionData(e,t),n),this}},{key:"_preActivate",value:function(){return this._currentLOD&&this._currentLOD._preActivate(),this}},{key:"_activate",value:function(e,t){if((0,M.Z)((0,x.Z)(n.prototype),"_activate",this).call(this,e,t),this._sourceMesh.subMeshes||Q.Y.Warn("Instances should only be created for meshes with geometry."),this._currentLOD){if(this._currentLOD._getWorldMatrixDeterminant()>=0!=this._getWorldMatrixDeterminant()>=0)return this._internalAbstractMeshDataInfo._actAsRegularMesh=!0,!0;if(this._internalAbstractMeshDataInfo._actAsRegularMesh=!1,this._currentLOD._registerInstanceForRenderId(this,e),t){if(!this._currentLOD._internalAbstractMeshDataInfo._isActiveIntermediate)return this._currentLOD._internalAbstractMeshDataInfo._onlyForInstancesIntermediate=!0,!0}else if(!this._currentLOD._internalAbstractMeshDataInfo._isActive)return this._currentLOD._internalAbstractMeshDataInfo._onlyForInstances=!0,!0}return!1}},{key:"_postActivate",value:function(){this._sourceMesh.edgesShareWithInstances&&this._sourceMesh._edgesRenderer&&this._sourceMesh._edgesRenderer.isEnabled&&this._sourceMesh._renderingGroup?(this._sourceMesh._renderingGroup._edgesRenderers.pushNoDuplicate(this._sourceMesh._edgesRenderer),this._sourceMesh._edgesRenderer.customInstances.push(this.getWorldMatrix())):this._edgesRenderer&&this._edgesRenderer.isEnabled&&this._sourceMesh._renderingGroup&&this._sourceMesh._renderingGroup._edgesRenderers.push(this._edgesRenderer)}},{key:"getWorldMatrix",value:function(){if(this._currentLOD&&this._currentLOD.billboardMode!==ln.Y.BILLBOARDMODE_NONE&&this._currentLOD._masterMesh!==this){this._billboardWorldMatrix||(this._billboardWorldMatrix=new h.y3);var e=this._currentLOD._masterMesh;return this._currentLOD._masterMesh=this,h.jp.Vector3[7].copyFrom(this._currentLOD.position),this._currentLOD.position.set(0,0,0),this._billboardWorldMatrix.copyFrom(this._currentLOD.computeWorldMatrix(!0)),this._currentLOD.position.copyFrom(h.jp.Vector3[7]),this._currentLOD._masterMesh=e,this._billboardWorldMatrix}return(0,M.Z)((0,x.Z)(n.prototype),"getWorldMatrix",this).call(this)}},{key:"isAnInstance",get:function(){return!0}},{key:"getLOD",value:function(e){if(!e)return this;var t=this.sourceMesh.getLODLevels();if(t&&0!==t.length){var n=this.getBoundingInfo();this._currentLOD=this.sourceMesh.getLOD(e,n.boundingSphere)}else this._currentLOD=this.sourceMesh;return this._currentLOD}},{key:"_preActivateForIntermediateRendering",value:function(e){return this.sourceMesh._preActivateForIntermediateRendering(e)}},{key:"_syncSubMeshes",value:function(){if(this.releaseSubMeshes(),this._sourceMesh.subMeshes)for(var e=0;e<this._sourceMesh.subMeshes.length;e++)this._sourceMesh.subMeshes[e].clone(this,this._sourceMesh);return this}},{key:"_generatePointsArray",value:function(){return this._sourceMesh._generatePointsArray()}},{key:"_updateBoundingInfo",value:function(){return this.hasBoundingInfo?this.getBoundingInfo().update(this.worldMatrixFromCache):this.buildBoundingInfo(this.absolutePosition,this.absolutePosition,this.worldMatrixFromCache),this._updateSubMeshesBoundingInfo(this.worldMatrixFromCache),this}},{key:"clone",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,r=(i||this._sourceMesh).createInstance(e);if(hn.j.DeepCopy(this,r,["name","subMeshes","uniqueId","parent","lightSources","receiveShadows","material","visibility","skeleton","sourceMesh","isAnInstance","facetNb","isFacetDataEnabled","isBlocked","useBones","hasInstances","collider","edgesRenderer","forward","up","right","absolutePosition","absoluteScaling","absoluteRotationQuaternion","isWorldMatrixFrozen","nonUniformScaling","behaviors","worldMatrixFromCache","hasThinInstances","hasBoundingInfo"],[]),this.refreshBoundingInfo(),t&&(r.parent=t),!n)for(var a=0;a<this.getScene().meshes.length;a++){var o=this.getScene().meshes[a];o.parent===this&&o.clone(o.name,r)}return r.computeWorldMatrix(!0),this.onClonedObservable.notifyObservers(r),r}},{key:"dispose",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._sourceMesh.removeInstance(this),(0,M.Z)((0,x.Z)(n.prototype),"dispose",this).call(this,e,t)}},{key:"_serializeAsParent",value:function(e){(0,M.Z)((0,x.Z)(n.prototype),"_serializeAsParent",this).call(this,e),e.parentId=this._sourceMesh.uniqueId,e.parentInstanceIndex=this._indexInSourceMeshInstanceArray}},{key:"instantiateHierarchy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,i=this.clone("Clone of "+(this.name||this.id),e||this.parent,!0,t&&t.newSourcedMesh);i&&n&&n(this,i);var r,a=fn(this.getChildTransformNodes(!0));try{for(a.s();!(r=a.n()).done;){var o=r.value;o.instantiateHierarchy(i,t,n)}}catch(s){a.e(s)}finally{a.f()}return i}}]),n}(cn.x);o.Kj.prototype.registerInstancedBuffer=function(e,t){var n,i;if(null===(n=this._userInstancedBuffersStorage)||void 0===n||null===(i=n.vertexBuffers[e])||void 0===i||i.dispose(),!this.instancedBuffers){this.instancedBuffers={};var r,a=fn(this.instances);try{for(a.s();!(r=a.n()).done;){r.value.instancedBuffers={}}}catch(u){a.e(u)}finally{a.f()}this._userInstancedBuffersStorage||(this._userInstancedBuffersStorage={data:{},vertexBuffers:{},strides:{},sizes:{},vertexArrayObjects:this.getEngine().getCaps().vertexArrayObject?{}:void 0})}this.instancedBuffers[e]=null,this._userInstancedBuffersStorage.strides[e]=t,this._userInstancedBuffersStorage.sizes[e]=32*t,this._userInstancedBuffersStorage.data[e]=new Float32Array(this._userInstancedBuffersStorage.sizes[e]),this._userInstancedBuffersStorage.vertexBuffers[e]=new de.o(this.getEngine(),this._userInstancedBuffersStorage.data[e],e,!0,!1,t,!0);var o,s=fn(this.instances);try{for(s.s();!(o=s.n()).done;){o.value.instancedBuffers[e]=null}}catch(u){s.e(u)}finally{s.f()}this._invalidateInstanceVertexArrayObject(),this._markSubMeshesAsAttributesDirty()},o.Kj.prototype._processInstancedBuffers=function(e,t){var n=e.length;for(var i in this.instancedBuffers){for(var r=this._userInstancedBuffersStorage.sizes[i],a=this._userInstancedBuffersStorage.strides[i],o=(n+1)*a;r<o;)r*=2;this._userInstancedBuffersStorage.data[i].length!=r&&(this._userInstancedBuffersStorage.data[i]=new Float32Array(r),this._userInstancedBuffersStorage.sizes[i]=r,this._userInstancedBuffersStorage.vertexBuffers[i]&&(this._userInstancedBuffersStorage.vertexBuffers[i].dispose(),this._userInstancedBuffersStorage.vertexBuffers[i]=null));var s=this._userInstancedBuffersStorage.data[i],u=0;if(t){var l=this.instancedBuffers[i];l.toArray?l.toArray(s,u):l.copyToArray?l.copyToArray(s,u):s[u]=l,u+=a}for(var c=0;c<n;c++){var h=e[c].instancedBuffers[i];h.toArray?h.toArray(s,u):h.copyToArray?h.copyToArray(s,u):s[u]=h,u+=a}this._userInstancedBuffersStorage.vertexBuffers[i]?this._userInstancedBuffersStorage.vertexBuffers[i].updateDirectly(s,0):(this._userInstancedBuffersStorage.vertexBuffers[i]=new de.o(this.getEngine(),this._userInstancedBuffersStorage.data[i],i,!0,!1,a,!0),this._invalidateInstanceVertexArrayObject())}},o.Kj.prototype._invalidateInstanceVertexArrayObject=function(){if(this._userInstancedBuffersStorage&&void 0!==this._userInstancedBuffersStorage.vertexArrayObjects){for(var e in this._userInstancedBuffersStorage.vertexArrayObjects)this.getEngine().releaseVertexArrayObject(this._userInstancedBuffersStorage.vertexArrayObjects[e]);this._userInstancedBuffersStorage.vertexArrayObjects={}}},o.Kj.prototype._disposeInstanceSpecificData=function(){for(this._instanceDataStorage.instancesBuffer&&(this._instanceDataStorage.instancesBuffer.dispose(),this._instanceDataStorage.instancesBuffer=null);this.instances.length;)this.instances[0].dispose();for(var e in this.instancedBuffers)this._userInstancedBuffersStorage.vertexBuffers[e]&&this._userInstancedBuffersStorage.vertexBuffers[e].dispose();this._invalidateInstanceVertexArrayObject(),this.instancedBuffers={}};var mn=n(1952),gn=n(1221);function _n(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return yn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return yn(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function yn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function En(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,x.Z)(e);if(t){var r=(0,x.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,I.Z)(this,n)}}var An=function(e){(0,S.Z)(n,e);var t=En(n);function n(e,i){var r;return(0,E.Z)(this,n),(r=t.call(this,e,i)).diffuse=new f.Wo(1,1,1),r.specular=new f.Wo(1,1,1),r.falloffType=n.FALLOFF_DEFAULT,r.intensity=1,r._range=Number.MAX_VALUE,r._inverseSquaredRange=0,r._photometricScale=1,r._intensityMode=n.INTENSITYMODE_AUTOMATIC,r._radius=1e-5,r.renderPriority=0,r._shadowEnabled=!0,r._excludeWithLayerMask=0,r._includeOnlyWithLayerMask=0,r._lightmapMode=0,r._excludedMeshesIds=new Array,r._includedOnlyMeshesIds=new Array,r._isLight=!0,r.getScene().addLight((0,T.Z)(r)),r._uniformBuffer=new mn.M(r.getScene().getEngine(),void 0,void 0,e),r._buildUniformLayout(),r.includedOnlyMeshes=new Array,r.excludedMeshes=new Array,r._resyncMeshes(),r}return(0,A.Z)(n,[{key:"range",get:function(){return this._range},set:function(e){this._range=e,this._inverseSquaredRange=1/(this.range*this.range)}},{key:"intensityMode",get:function(){return this._intensityMode},set:function(e){this._intensityMode=e,this._computePhotometricScale()}},{key:"radius",get:function(){return this._radius},set:function(e){this._radius=e,this._computePhotometricScale()}},{key:"shadowEnabled",get:function(){return this._shadowEnabled},set:function(e){this._shadowEnabled!==e&&(this._shadowEnabled=e,this._markMeshesAsLightDirty())}},{key:"includedOnlyMeshes",get:function(){return this._includedOnlyMeshes},set:function(e){this._includedOnlyMeshes=e,this._hookArrayForIncludedOnly(e)}},{key:"excludedMeshes",get:function(){return this._excludedMeshes},set:function(e){this._excludedMeshes=e,this._hookArrayForExcluded(e)}},{key:"excludeWithLayerMask",get:function(){return this._excludeWithLayerMask},set:function(e){this._excludeWithLayerMask=e,this._resyncMeshes()}},{key:"includeOnlyWithLayerMask",get:function(){return this._includeOnlyWithLayerMask},set:function(e){this._includeOnlyWithLayerMask=e,this._resyncMeshes()}},{key:"lightmapMode",get:function(){return this._lightmapMode},set:function(e){this._lightmapMode!==e&&(this._lightmapMode=e,this._markMeshesAsLightDirty())}},{key:"transferTexturesToEffect",value:function(e,t){return this}},{key:"_bindLight",value:function(e,t,n,i){var r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=e.toString(),o=!1;if(this._uniformBuffer.bindToEffect(n,"Light"+a),this._renderId!==t.getRenderId()||this._lastUseSpecular!==i||!this._uniformBuffer.useUbo){this._renderId=t.getRenderId(),this._lastUseSpecular=i;var s=this.getScaledIntensity();this.transferToEffect(n,a),this.diffuse.scaleToRef(s,f.zZ.Color3[0]),this._uniformBuffer.updateColor4("vLightDiffuse",f.zZ.Color3[0],this.range,a),i&&(this.specular.scaleToRef(s,f.zZ.Color3[1]),this._uniformBuffer.updateColor4("vLightSpecular",f.zZ.Color3[1],this.radius,a)),o=!0}if(this.transferTexturesToEffect(n,a),t.shadowsEnabled&&this.shadowEnabled&&r){var u=this.getShadowGenerator();u&&(u.bindShadowLight(a,n),o=!0)}o?this._uniformBuffer.update():this._uniformBuffer.bindUniformBuffer()}},{key:"getClassName",value:function(){return"Light"}},{key:"toString",value:function(e){var t="Name: "+this.name;if(t+=", type: "+["Point","Directional","Spot","Hemispheric"][this.getTypeID()],this.animations)for(var n=0;n<this.animations.length;n++)t+=", animation[0]: "+this.animations[n].toString(e);return t}},{key:"_syncParentEnabledState",value:function(){(0,M.Z)((0,x.Z)(n.prototype),"_syncParentEnabledState",this).call(this),this.isDisposed()||this._resyncMeshes()}},{key:"setEnabled",value:function(e){(0,M.Z)((0,x.Z)(n.prototype),"setEnabled",this).call(this,e),this._resyncMeshes()}},{key:"getShadowGenerator",value:function(){return this._shadowGenerator}},{key:"getAbsolutePosition",value:function(){return h.P.Zero()}},{key:"canAffectMesh",value:function(e){return!e||!(this.includedOnlyMeshes&&this.includedOnlyMeshes.length>0&&-1===this.includedOnlyMeshes.indexOf(e))&&(!(this.excludedMeshes&&this.excludedMeshes.length>0&&-1!==this.excludedMeshes.indexOf(e))&&((0===this.includeOnlyWithLayerMask||0!=(this.includeOnlyWithLayerMask&e.layerMask))&&!(0!==this.excludeWithLayerMask&&this.excludeWithLayerMask&e.layerMask)))}},{key:"dispose",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this._shadowGenerator&&(this._shadowGenerator.dispose(),this._shadowGenerator=null),this.getScene().stopAnimation(this),this._parentContainer){var i=this._parentContainer.lights.indexOf(this);i>-1&&this._parentContainer.lights.splice(i,1),this._parentContainer=null}var r,a=_n(this.getScene().meshes);try{for(a.s();!(r=a.n()).done;){var o=r.value;o._removeLightSource(this,!0)}}catch(s){a.e(s)}finally{a.f()}this._uniformBuffer.dispose(),this.getScene().removeLight(this),(0,M.Z)((0,x.Z)(n.prototype),"dispose",this).call(this,e,t)}},{key:"getTypeID",value:function(){return 0}},{key:"getScaledIntensity",value:function(){return this._photometricScale*this.intensity}},{key:"clone",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=n.GetConstructorFromName(this.getTypeID(),e,this.getScene());if(!i)return null;var r=P.p4.Clone(i,this);return e&&(r.name=e),t&&(r.parent=t),r.setEnabled(this.isEnabled()),this.onClonedObservable.notifyObservers(r),r}},{key:"serialize",value:function(){var e=P.p4.Serialize(this);return e.uniqueId=this.uniqueId,e.type=this.getTypeID(),this.parent&&this.parent._serializeAsParent(e),this.excludedMeshes.length>0&&(e.excludedMeshesIds=[],this.excludedMeshes.forEach((function(t){e.excludedMeshesIds.push(t.id)}))),this.includedOnlyMeshes.length>0&&(e.includedOnlyMeshesIds=[],this.includedOnlyMeshes.forEach((function(t){e.includedOnlyMeshesIds.push(t.id)}))),P.p4.AppendSerializedAnimations(this,e),e.ranges=this.serializeAnimationRanges(),e.isEnabled=this.isEnabled(),e}},{key:"_hookArrayForExcluded",value:function(e){var t=this,n=e.push;e.push=function(){for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];for(var o=n.apply(e,r),s=0,u=r;s<u.length;s++){var l=u[s];l._resyncLightSource(t)}return o};var i=e.splice;e.splice=function(n,r){var a,o=i.apply(e,[n,r]),s=_n(o);try{for(s.s();!(a=s.n()).done;){a.value._resyncLightSource(t)}}catch(u){s.e(u)}finally{s.f()}return o};var r,a=_n(e);try{for(a.s();!(r=a.n()).done;){r.value._resyncLightSource(this)}}catch(o){a.e(o)}finally{a.f()}}},{key:"_hookArrayForIncludedOnly",value:function(e){var t=this,n=e.push;e.push=function(){for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];var o=n.apply(e,r);return t._resyncMeshes(),o};var i=e.splice;e.splice=function(n,r){var a=i.apply(e,[n,r]);return t._resyncMeshes(),a},this._resyncMeshes()}},{key:"_resyncMeshes",value:function(){var e,t=_n(this.getScene().meshes);try{for(t.s();!(e=t.n()).done;){e.value._resyncLightSource(this)}}catch(n){t.e(n)}finally{t.f()}}},{key:"_markMeshesAsLightDirty",value:function(){var e,t=_n(this.getScene().meshes);try{for(t.s();!(e=t.n()).done;){var n=e.value;-1!==n.lightSources.indexOf(this)&&n._markSubMeshesAsLightDirty()}}catch(i){t.e(i)}finally{t.f()}}},{key:"_computePhotometricScale",value:function(){this._photometricScale=this._getPhotometricScale(),this.getScene().resetCachedMaterial()}},{key:"_getPhotometricScale",value:function(){var e=0,t=this.getTypeID(),i=this.intensityMode;switch(i===n.INTENSITYMODE_AUTOMATIC&&(i=t===n.LIGHTTYPEID_DIRECTIONALLIGHT?n.INTENSITYMODE_ILLUMINANCE:n.INTENSITYMODE_LUMINOUSINTENSITY),t){case n.LIGHTTYPEID_POINTLIGHT:case n.LIGHTTYPEID_SPOTLIGHT:switch(i){case n.INTENSITYMODE_LUMINOUSPOWER:e=1/(4*Math.PI);break;case n.INTENSITYMODE_LUMINOUSINTENSITY:e=1;break;case n.INTENSITYMODE_LUMINANCE:e=this.radius*this.radius}break;case n.LIGHTTYPEID_DIRECTIONALLIGHT:switch(i){case n.INTENSITYMODE_ILLUMINANCE:e=1;break;case n.INTENSITYMODE_LUMINANCE:var r=this.radius;r=Math.max(r,.001),e=2*Math.PI*(1-Math.cos(r))}break;case n.LIGHTTYPEID_HEMISPHERICLIGHT:e=1}return e}},{key:"_reorderLightsInScene",value:function(){var e=this.getScene();0!=this._renderPriority&&(e.requireLightSorting=!0),this.getScene().sortLightsByPriority()}}],[{key:"GetConstructorFromName",value:function(e,t,n){var i=R.N.Construct("Light_Type_"+e,t,n);return i||null}},{key:"Parse",value:function(e,t){var i=n.GetConstructorFromName(e.type,e.name,t);if(!i)return null;var r=P.p4.Parse(i,e,t);if(e.excludedMeshesIds&&(r._excludedMeshesIds=e.excludedMeshesIds),e.includedOnlyMeshesIds&&(r._includedOnlyMeshesIds=e.includedOnlyMeshesIds),void 0!==e.parentId&&(r._waitingParentId=e.parentId),void 0!==e.parentInstanceIndex&&(r._waitingParentInstanceIndex=e.parentInstanceIndex),void 0!==e.falloffType&&(r.falloffType=e.falloffType),void 0!==e.lightmapMode&&(r.lightmapMode=e.lightmapMode),e.animations){for(var a=0;a<e.animations.length;a++){var o=e.animations[a],s=(0,V.q)("BABYLON.Animation");s&&r.animations.push(s.Parse(o))}R.N.ParseAnimationRanges(r,e,t)}return e.autoAnimate&&t.beginAnimation(r,e.autoAnimateFrom,e.autoAnimateTo,e.autoAnimateLoop,e.autoAnimateSpeed||1),void 0!==e.isEnabled&&r.setEnabled(e.isEnabled),r}}]),n}(R.N);function bn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,x.Z)(e);if(t){var r=(0,x.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,I.Z)(this,n)}}An.FALLOFF_DEFAULT=gn.m.FALLOFF_DEFAULT,An.FALLOFF_PHYSICAL=gn.m.FALLOFF_PHYSICAL,An.FALLOFF_GLTF=gn.m.FALLOFF_GLTF,An.FALLOFF_STANDARD=gn.m.FALLOFF_STANDARD,An.LIGHTMAP_DEFAULT=gn.m.LIGHTMAP_DEFAULT,An.LIGHTMAP_SPECULAR=gn.m.LIGHTMAP_SPECULAR,An.LIGHTMAP_SHADOWSONLY=gn.m.LIGHTMAP_SHADOWSONLY,An.INTENSITYMODE_AUTOMATIC=gn.m.INTENSITYMODE_AUTOMATIC,An.INTENSITYMODE_LUMINOUSPOWER=gn.m.INTENSITYMODE_LUMINOUSPOWER,An.INTENSITYMODE_LUMINOUSINTENSITY=gn.m.INTENSITYMODE_LUMINOUSINTENSITY,An.INTENSITYMODE_ILLUMINANCE=gn.m.INTENSITYMODE_ILLUMINANCE,An.INTENSITYMODE_LUMINANCE=gn.m.INTENSITYMODE_LUMINANCE,An.LIGHTTYPEID_POINTLIGHT=gn.m.LIGHTTYPEID_POINTLIGHT,An.LIGHTTYPEID_DIRECTIONALLIGHT=gn.m.LIGHTTYPEID_DIRECTIONALLIGHT,An.LIGHTTYPEID_SPOTLIGHT=gn.m.LIGHTTYPEID_SPOTLIGHT,An.LIGHTTYPEID_HEMISPHERICLIGHT=gn.m.LIGHTTYPEID_HEMISPHERICLIGHT,(0,C.gn)([(0,P.n9)()],An.prototype,"diffuse",void 0),(0,C.gn)([(0,P.n9)()],An.prototype,"specular",void 0),(0,C.gn)([(0,P.qC)()],An.prototype,"falloffType",void 0),(0,C.gn)([(0,P.qC)()],An.prototype,"intensity",void 0),(0,C.gn)([(0,P.qC)()],An.prototype,"range",null),(0,C.gn)([(0,P.qC)()],An.prototype,"intensityMode",null),(0,C.gn)([(0,P.qC)()],An.prototype,"radius",null),(0,C.gn)([(0,P.qC)()],An.prototype,"_renderPriority",void 0),(0,C.gn)([(0,P.wz)("_reorderLightsInScene")],An.prototype,"renderPriority",void 0),(0,C.gn)([(0,P.qC)("shadowEnabled")],An.prototype,"_shadowEnabled",void 0),(0,C.gn)([(0,P.qC)("excludeWithLayerMask")],An.prototype,"_excludeWithLayerMask",void 0),(0,C.gn)([(0,P.qC)("includeOnlyWithLayerMask")],An.prototype,"_includeOnlyWithLayerMask",void 0),(0,C.gn)([(0,P.qC)("lightmapMode")],An.prototype,"_lightmapMode",void 0),R.N.AddNodeConstructor("Light_Type_3",(function(e,t){return function(){return new Tn(e,h.P.Zero(),t)}}));var Tn=function(e){(0,S.Z)(n,e);var t=bn(n);function n(e,i,r){var a;return(0,E.Z)(this,n),(a=t.call(this,e,r)).groundColor=new f.Wo(0,0,0),a.direction=i||h.P.Up(),a}return(0,A.Z)(n,[{key:"_buildUniformLayout",value:function(){this._uniformBuffer.addUniform("vLightData",4),this._uniformBuffer.addUniform("vLightDiffuse",4),this._uniformBuffer.addUniform("vLightSpecular",4),this._uniformBuffer.addUniform("vLightGround",3),this._uniformBuffer.addUniform("shadowsInfo",3),this._uniformBuffer.addUniform("depthValues",2),this._uniformBuffer.create()}},{key:"getClassName",value:function(){return"HemisphericLight"}},{key:"setDirectionToTarget",value:function(e){return this.direction=h.P.Normalize(e.subtract(h.P.Zero())),this.direction}},{key:"getShadowGenerator",value:function(){return null}},{key:"transferToEffect",value:function(e,t){var n=h.P.Normalize(this.direction);return this._uniformBuffer.updateFloat4("vLightData",n.x,n.y,n.z,0,t),this._uniformBuffer.updateColor3("vLightGround",this.groundColor.scale(this.intensity),t),this}},{key:"transferToNodeMaterialEffect",value:function(e,t){var n=h.P.Normalize(this.direction);return e.setFloat3(t,n.x,n.y,n.z),this}},{key:"computeWorldMatrix",value:function(){return this._worldMatrix||(this._worldMatrix=h.y3.Identity()),this._worldMatrix}},{key:"getTypeID",value:function(){return An.LIGHTTYPEID_HEMISPHERICLIGHT}},{key:"prepareLightSpecificDefines",value:function(e,t){e["HEMILIGHT"+t]=!0}}]),n}(An);function Mn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,x.Z)(e);if(t){var r=(0,x.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,I.Z)(this,n)}}(0,C.gn)([(0,P.n9)()],Tn.prototype,"groundColor",void 0),(0,C.gn)([(0,P.hd)()],Tn.prototype,"direction",void 0);var Sn=function(e){(0,S.Z)(n,e);var t=Mn(n);function n(){var e;return(0,E.Z)(this,n),(e=t.apply(this,arguments))._needProjectionMatrixCompute=!0,e}return(0,A.Z)(n,[{key:"_setPosition",value:function(e){this._position=e}},{key:"position",get:function(){return this._position},set:function(e){this._setPosition(e)}},{key:"_setDirection",value:function(e){this._direction=e}},{key:"direction",get:function(){return this._direction},set:function(e){this._setDirection(e)}},{key:"shadowMinZ",get:function(){return this._shadowMinZ},set:function(e){this._shadowMinZ=e,this.forceProjectionMatrixCompute()}},{key:"shadowMaxZ",get:function(){return this._shadowMaxZ},set:function(e){this._shadowMaxZ=e,this.forceProjectionMatrixCompute()}},{key:"computeTransformedInformation",value:function(){return!(!this.parent||!this.parent.getWorldMatrix)&&(this.transformedPosition||(this.transformedPosition=h.P.Zero()),h.P.TransformCoordinatesToRef(this.position,this.parent.getWorldMatrix(),this.transformedPosition),this.direction&&(this.transformedDirection||(this.transformedDirection=h.P.Zero()),h.P.TransformNormalToRef(this.direction,this.parent.getWorldMatrix(),this.transformedDirection)),!0)}},{key:"getDepthScale",value:function(){return 50}},{key:"getShadowDirection",value:function(e){return this.transformedDirection?this.transformedDirection:this.direction}},{key:"getAbsolutePosition",value:function(){return this.transformedPosition?this.transformedPosition:this.position}},{key:"setDirectionToTarget",value:function(e){return this.direction=h.P.Normalize(e.subtract(this.position)),this.direction}},{key:"getRotation",value:function(){this.direction.normalize();var e=h.P.Cross(this.direction,m.RD.Y),t=h.P.Cross(e,this.direction);return h.P.RotationFromAxis(e,t,this.direction)}},{key:"needCube",value:function(){return!1}},{key:"needProjectionMatrixCompute",value:function(){return this._needProjectionMatrixCompute}},{key:"forceProjectionMatrixCompute",value:function(){this._needProjectionMatrixCompute=!0}},{key:"_initCache",value:function(){(0,M.Z)((0,x.Z)(n.prototype),"_initCache",this).call(this),this._cache.position=h.P.Zero()}},{key:"_isSynchronized",value:function(){return!!this._cache.position.equals(this.position)}},{key:"computeWorldMatrix",value:function(e){return!e&&this.isSynchronized()?(this._currentRenderId=this.getScene().getRenderId(),this._worldMatrix):(this._updateCache(),this._cache.position.copyFrom(this.position),this._worldMatrix||(this._worldMatrix=h.y3.Identity()),h.y3.TranslationToRef(this.position.x,this.position.y,this.position.z,this._worldMatrix),this.parent&&this.parent.getWorldMatrix&&(this._worldMatrix.multiplyToRef(this.parent.getWorldMatrix(),this._worldMatrix),this._markSyncedWithParent()),this._worldMatrixDeterminantIsDirty=!0,this._worldMatrix)}},{key:"getDepthMinZ",value:function(e){return void 0!==this.shadowMinZ?this.shadowMinZ:e.minZ}},{key:"getDepthMaxZ",value:function(e){return void 0!==this.shadowMaxZ?this.shadowMaxZ:e.maxZ}},{key:"setShadowProjectionMatrix",value:function(e,t,n){return this.customProjectionMatrixBuilder?this.customProjectionMatrixBuilder(t,n,e):this._setDefaultShadowProjectionMatrix(e,t,n),this}},{key:"_syncParentEnabledState",value:function(){(0,M.Z)((0,x.Z)(n.prototype),"_syncParentEnabledState",this).call(this),this.parent&&this.parent.getWorldMatrix||(this.transformedPosition=null,this.transformedDirection=null)}}]),n}(An);function In(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,x.Z)(e);if(t){var r=(0,x.Z)(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return(0,I.Z)(this,n)}}(0,C.gn)([(0,P.hd)()],Sn.prototype,"position",null),(0,C.gn)([(0,P.hd)()],Sn.prototype,"direction",null),(0,C.gn)([(0,P.qC)()],Sn.prototype,"shadowMinZ",null),(0,C.gn)([(0,P.qC)()],Sn.prototype,"shadowMaxZ",null),R.N.AddNodeConstructor("Light_Type_0",(function(e,t){return function(){return new xn(e,h.P.Zero(),t)}}));var xn=function(e){(0,S.Z)(n,e);var t=In(n);function n(e,i,r){var a;return(0,E.Z)(this,n),(a=t.call(this,e,r))._shadowAngle=Math.PI/2,a.position=i,a}return(0,A.Z)(n,[{key:"shadowAngle",get:function(){return this._shadowAngle},set:function(e){this._shadowAngle=e,this.forceProjectionMatrixCompute()}},{key:"direction",get:function(){return this._direction},set:function(e){var t=this.needCube();this._direction=e,this.needCube()!==t&&this._shadowGenerator&&this._shadowGenerator.recreateShadowMap()}},{key:"getClassName",value:function(){return"PointLight"}},{key:"getTypeID",value:function(){return An.LIGHTTYPEID_POINTLIGHT}},{key:"needCube",value:function(){return!this.direction}},{key:"getShadowDirection",value:function(e){if(this.direction)return(0,M.Z)((0,x.Z)(n.prototype),"getShadowDirection",this).call(this,e);switch(e){case 0:return new h.P(1,0,0);case 1:return new h.P(-1,0,0);case 2:return new h.P(0,-1,0);case 3:return new h.P(0,1,0);case 4:return new h.P(0,0,1);case 5:return new h.P(0,0,-1)}return h.P.Zero()}},{key:"_setDefaultShadowProjectionMatrix",value:function(e,t,n){var i=this.getScene().activeCamera;if(i){var r=void 0!==this.shadowMinZ?this.shadowMinZ:i.minZ,a=void 0!==this.shadowMaxZ?this.shadowMaxZ:i.maxZ,o=this.getScene().getEngine().useReverseDepthBuffer;h.y3.PerspectiveFovLHToRef(this.shadowAngle,1,o?a:r,o?r:a,e,!0,this._scene.getEngine().isNDCHalfZRange,void 0,o)}}},{key:"_buildUniformLayout",value:function(){this._uniformBuffer.addUniform("vLightData",4),this._uniformBuffer.addUniform("vLightDiffuse",4),this._uniformBuffer.addUniform("vLightSpecular",4),this._uniformBuffer.addUniform("vLightFalloff",4),this._uniformBuffer.addUniform("shadowsInfo",3),this._uniformBuffer.addUniform("depthValues",2),this._uniformBuffer.create()}},{key:"transferToEffect",value:function(e,t){return this.computeTransformedInformation()?this._uniformBuffer.updateFloat4("vLightData",this.transformedPosition.x,this.transformedPosition.y,this.transformedPosition.z,0,t):this._uniformBuffer.updateFloat4("vLightData",this.position.x,this.position.y,this.position.z,0,t),this._uniformBuffer.updateFloat4("vLightFalloff",this.range,this._inverseSquaredRange,0,0,t),this}},{key:"transferToNodeMaterialEffect",value:function(e,t){return this.computeTransformedInformation()?e.setFloat3(t,this.transformedPosition.x,this.transformedPosition.y,this.transformedPosition.z):e.setFloat3(t,this.position.x,this.position.y,this.position.z),this}},{key:"prepareLightSpecificDefines",value:function(e,t){e["POINTLIGHT"+t]=!0}}]),n}(Sn);(0,C.gn)([(0,P.qC)()],xn.prototype,"shadowAngle",null);var Cn=1.5,Pn=1.5,Dn=.5,Rn=6,kn=-4,On=-6,Nn=1.2,wn=[[0,0,0,0,0,0,1,1,1],[0,0,0,1,1,1,1,1,1],[0,0,0,1,1,1,1,1,1],[0,0,0,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1,1],[0,0,0,1,1,1,1,1,1],[0,0,0,1,1,1,1,1,1]],Ln=function(e){return e+"-"+Math.random().toString(36).slice(2)},Fn=function(){function e(e,t){var n=this;this.engine=null,this.scene=null,this.camera=null,this.viewportRatio=Nn,this.nodes=[],this.frameCount=0,this.onFrame=function(){for(var e=n.frameCount,t=0;t<n.nodes.length;t++)for(var i=n.nodes[t],r=0;r<i.length;r++){var a=i[r];a&&(a.position.y=Cn*(Math.sin(e*Pn*.01-.2*r+(e*Pn*.006+.3*t))/10+Math.sin(e*Pn*.01-r*t*.2)/10+Math.cos(e*Pn*.02-.2*r)/8-.25))}n.frameCount=e+1,n.scene.render()},this.canvas=e,this.engine=new r.D(e,!0,{stencil:!0}),this.dark=t,this.createScene(),this.populateScene(),this.engine.runRenderLoop(this.onFrame)}var t=e.prototype;return t.createScene=function(){this.scene=new a.x(this.engine),this.camera=new he("cam",0,0,0,h.P.Zero(),this.scene,!0),this.camera.minZ=.1,this.camera.setPosition(new h.P(5,5,-5)),this.camera.mode=1,this.camera.orthoTop=Rn,this.camera.orthoBottom=-Rn,this.camera.orthoLeft=-Rn*this.viewportRatio,this.camera.orthoRight=Rn*this.viewportRatio},t.createBlock=function(e){var t={faceUV:[new h.Lt(0,0,1,1),new h.Lt(0,0,.9,.9),new h.Lt(0,0,1,.9),new h.Lt(0,0,1,1),new h.Lt(0,0,1,1),new h.Lt(0,0,1,0)],wrap:!0},n=new un(Ln("mat"));n.emissiveColor=f.Wo.White(),n.diffuseColor=f.Wo.White(),n.emissiveColor=f.Wo.White(),n.diffuseTexture=e;var i=p(Ln("box"),Object.assign({size:1,height:2},t),this.scene);return i.material=n,i},t.populateScene=function(){var e=c("foor",{size:150},this.scene);e.material=new un(Ln("mat")),this.dark?e.material.emissiveColor=new f.Wo(.08,.12,.19):e.material.emissiveColor=f.Wo.White(),e.rotation.x=Math.PI/2,e.position.y=0;var t=new ln.Y("root");t.position.x=kn,t.position.z=On;var n=new Be(this.dark?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQQAAAEECAIAAABBat1dAAAAAXNSR0IArs4c6QAAAoxJREFUeJzt1bENg0AQAMG3RTdEiAJcAkVQr+XI/ThZITp4BzPRXXbJ6h6v4xzAGM/ZB8C/EANEDJDlvnw/71l3wBTrtl+zzwARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMEDFAxAARA0QMkOW+rNs+6w6YzmeAiAEiBsgPeloGjEmClbsAAAAASUVORK5CYII=":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQQAAAEECAYAAADOCEoKAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAALkSURBVHgB7dZBCoJgFEbRvxAaRPvfZybkqBzIBd2C58zeW8Dlu70/398A2NwHwE4QgAgCkOn8eD0fA7iGeVkPt4UARBCACAIQQQAiCEAEAYggABEEIIIARBCACAIQQQAiCEAEAYggABEEIIIARBCACAIQQQAiCEAEAYggABEEIIIARBCACAIQQQAiCEAEAYggABEEIIIARBCACAIQQQAiCEAEAYggABEEIIIARBCACAIQQQAiCEAEAYggABEEIIIARBCACAIQQQAiCEAEAYggABEEIIIARBCACAIQQQAiCEAEAYggABEEIIIARBCACAIQQQAiCEAEAYggABEEIIIARBCACAIQQQAiCEAEAYggABEEIIIARBCACAIQQQAiCEAEAYggABEEIIIARBCACAIQQQAiCEAEAYggABEEIIIARBCACAIQQQAiCEAEAYggABEEIIIARBCACAIQQQAiCEAEAYggABEEIIIARBCACAIQQQAiCEAEAYggABEEIIIARBCACAIQQQAiCEAEAYggABEEIIIARBCACAIQQQAiCEAEAYggABEEIIIARBCACAIQQQAiCEAEAYggABEEIIIARBCACAIQQQAiCEAEAYggABEEIIIARBCACAIQQQAiCEAEAYggABEEIIIARBCACAIQQQAiCEAEAYggABEEIIIARBCACAIQQQAiCEAEAYggABEEIIIARBCACAIQQQAiCEAEAYggABEEIIIARBCACAIQQQAiCEAEAYggABEEIIIARBCACAIQQQAiCEAEAYggABEEIIIARBCACAIQQQAiCEAEAYggABEEIIIARBCACAIQQQAiCEAEAYggABEEIIIARBCACAIQQQAiCEAEAYggABEEIIIARBCACAIQQQAiCEAEAYggABEEIIIARBCACAIQQQAiCEAEAYggABEEIIIARBCACAIQQQAiCEAEAYggABEEIIIARBCACAKQ6fyYl3UA12QhABEEIIIA5A+i5AvKlGhYggAAAABJRU5ErkJggg=="),i=this.createBlock(n);i.parent=t,i.setEnabled(!1),window.floor=e,window.root=t;for(var r=0;r<9;r++){var a=[];this.nodes[r]=a;for(var o=0;o<9;o++)if(wn[r][o]){var s=i.createInstance();s.position.x=(1+Dn)*r,s.position.z=(1+Dn)*o,s.parent=t,s.setEnabled(!0),a[o]=s}else a[o]=!1}},t.onResize=function(){this.engine.resize()},t.dispose=function(){this.camera.dispose(),this.scene.dispose(),this.engine.dispose()},e}(),Bn=function(e){var t=e.dark,n=void 0!==t&&t,r=(0,i.useRef)(null);return(0,i.useEffect)((function(){if(r.current){var e=new Fn(r.current,n);r.current.classList.add("visible");var t=function(){return e.onResize()};return window.addEventListener("resize",t),function(){e.dispose(),window.removeEventListener("resize",t)}}}),[r]),i.createElement("div",{className:"animated-grid"},i.createElement("canvas",{className:"viewport",ref:r}))}},6553:function(e,t,n){"use strict";var i=n(7294),r=n(1562),a=n(6733);t.Z=function(e){var t=(0,a.W)();if(e.to&&e.to.startsWith("http"))return i.createElement(r.ZP,e);var n=t(e.to);return i.createElement(r.ZP,Object.assign({},e,{to:n}))}},6448:function(e,t,n){"use strict";var i=n(7294),r=n(5900),a=n.n(r),o=n(3698);t.Z=function(e){var t=e.label,n=e.disabled,r=e.clear,s=void 0!==r&&r,u=e.children,l=e.icon,c=(0,o.Z)(),h=a()("button",{"is-clear":s,"is-disabled":n}),f=i.createElement("div",{className:"button-content"},l?i.createElement("span",{className:"icon"},l):null,t?i.createElement("span",{className:"button-text"},c(t)):null,i.createElement("span",{className:"button-shadow"}));return i.createElement(i.Fragment,null,u({buttonClasses:h,buttonContent:f}))}},1819:function(e,t,n){"use strict";n.d(t,{Z:function(){return h}});var i=n(7294),r=n(78),a=n(3964),o=n.n(a),s=n(8157),u=n(1597);var l=function(e,t){var n=(0,s.TG)(t);return e!==s.ZW?"/"+e+n:n};var c=function(e,t,n){var i=function(){if("undefined"!=typeof window)return localStorage.getItem("content-language")}(),r=(0,s.Q3)(),a=(0,s.E5)(n||s.ZW),o=a.messages,c=a.locale,h=e?"/":t.pathname||window.location.pathname;return void 0===n||n===i||e||(console.log("--\x3e Removed forced locale"),localStorage.removeItem("content-language")),!n&&i&&i!==c?(console.log("--\x3e Redirect! (A)"),(0,u.navigate)(l(i,h),{replace:!0})):n||i||c===r||e||(console.log("--\x3e Redirect! (B)"),(0,u.navigate)(l(r,h),{replace:!0})),{messages:o,locale:c}},h=function(e){var t,n=e.children,a=e.location,s=void 0===a?{}:a,u=e.lang,l="undefined"==typeof window,h=c(l,s,u),f=h.messages,d=h.locale;return"en"!==d&&o().locale(d,{months:null===(t=f.months)||void 0===t?void 0:t.split("")}),(0,i.useEffect)((function(){document.querySelector("html").setAttribute("lang",d),document.body.classList.value=d}),[d]),i.createElement(r.Z,{messages:f,locale:d,textComponent:i.Fragment},n)}},7061:function(e,t,n){var i=n(8698).default;function r(){"use strict";e.exports=r=function(){return t},e.exports.__esModule=!0,e.exports.default=e.exports;var t={},n=Object.prototype,a=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",u=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(P){c=function(e,t,n){return e[t]=n}}function h(e,t,n,i){var r=t&&t.prototype instanceof p?t:p,a=Object.create(r.prototype),o=new I(i||[]);return a._invoke=function(e,t,n){var i="suspendedStart";return function(r,a){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===r)throw a;return C()}for(n.method=r,n.arg=a;;){var o=n.delegate;if(o){var s=T(o,n);if(s){if(s===d)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===i)throw i="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i="executing";var u=f(e,t,n);if("normal"===u.type){if(i=n.done?"completed":"suspendedYield",u.arg===d)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(i="completed",n.method="throw",n.arg=u.arg)}}}(e,n,o),a}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(P){return{type:"throw",arg:P}}}t.wrap=h;var d={};function p(){}function v(){}function m(){}var g={};c(g,s,(function(){return this}));var _=Object.getPrototypeOf,y=_&&_(_(x([])));y&&y!==n&&a.call(y,s)&&(g=y);var E=m.prototype=p.prototype=Object.create(g);function A(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function b(e,t){function n(r,o,s,u){var l=f(e[r],e,o);if("throw"!==l.type){var c=l.arg,h=c.value;return h&&"object"==i(h)&&a.call(h,"__await")?t.resolve(h.__await).then((function(e){n("next",e,s,u)}),(function(e){n("throw",e,s,u)})):t.resolve(h).then((function(e){c.value=e,s(c)}),(function(e){return n("throw",e,s,u)}))}u(l.arg)}var r;this._invoke=function(e,i){function a(){return new t((function(t,r){n(e,i,t,r)}))}return r=r?r.then(a,a):a()}}function T(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,T(e,t),"throw"===t.method))return d;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return d}var i=f(n,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,d;var r=i.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function M(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function I(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(M,this),this.reset(!0)}function x(e){if(e){var t=e[s];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function t(){for(;++n<e.length;)if(a.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:C}}function C(){return{value:void 0,done:!0}}return v.prototype=m,c(E,"constructor",m),c(m,"constructor",v),v.displayName=c(m,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,c(e,l,"GeneratorFunction")),e.prototype=Object.create(E),e},t.awrap=function(e){return{__await:e}},A(b.prototype),c(b.prototype,u,(function(){return this})),t.AsyncIterator=b,t.async=function(e,n,i,r,a){void 0===a&&(a=Promise);var o=new b(h(e,n,i,r),a);return t.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},A(E),c(E,l,"Generator"),c(E,s,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var i=t.pop();if(i in e)return n.value=i,n.done=!1,n}return n.done=!0,n}},t.values=x,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!e)for(var t in this)"t"===t.charAt(0)&&a.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,i){return o.type="throw",o.arg=e,t.next=n,i&&(t.method="next",t.arg=void 0),!!i}for(var i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i],o=r.completion;if("root"===r.tryLoc)return n("end");if(r.tryLoc<=this.prev){var s=a.call(r,"catchLoc"),u=a.call(r,"finallyLoc");if(s&&u){if(this.prev<r.catchLoc)return n(r.catchLoc,!0);if(this.prev<r.finallyLoc)return n(r.finallyLoc)}else if(s){if(this.prev<r.catchLoc)return n(r.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return n(r.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&a.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var o=r?r.completion:{};return o.type=e,o.arg=t,r?(this.method="next",this.next=r.finallyLoc,d):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),S(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var r=i.arg;S(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:x(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},t}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports},8698:function(e){function t(n){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},4687:function(e,t,n){var i=n(7061)();e.exports=i;try{regeneratorRuntime=i}catch(r){"object"==typeof globalThis?globalThis.regeneratorRuntime=i:Function("r","regeneratorRuntime = r")(i)}},7326:function(e,t,n){"use strict";function i(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}n.d(t,{Z:function(){return i}})},531:function(e,t,n){"use strict";function i(e,t,n,i,r,a,o){try{var s=e[a](o),u=s.value}catch(l){return void n(l)}s.done?t(u):Promise.resolve(u).then(i,r)}function r(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function s(e){i(o,r,a,s,u,"next",e)}function u(e){i(o,r,a,s,u,"throw",e)}s(void 0)}))}}n.d(t,{Z:function(){return r}})},5671:function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,{Z:function(){return i}})},3144:function(e,t,n){"use strict";function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function r(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}n.d(t,{Z:function(){return r}})},4942:function(e,t,n){"use strict";function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,{Z:function(){return i}})},1752:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var i=n(1120);function r(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=(0,i.Z)(e)););return e}function a(){return a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var i=r(e,t);if(i){var a=Object.getOwnPropertyDescriptor(i,t);return a.get?a.get.call(arguments.length<3?e:n):a.value}},a.apply(this,arguments)}},1120:function(e,t,n){"use strict";function i(e){return i=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},i(e)}n.d(t,{Z:function(){return i}})},136:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});var i=n(9611);function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&(0,i.Z)(e,t)}},3366:function(e,t,n){"use strict";function i(e,t){if(null==e)return{};var n,i,r={},a=Object.keys(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||(r[n]=e[n]);return r}n.d(t,{Z:function(){return i}})},6215:function(e,t,n){"use strict";function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}n.d(t,{Z:function(){return a}});var r=n(7326);function a(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return(0,r.Z)(e)}},885:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});var i=n(181);function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,a=[],o=!0,s=!1;try{for(n=n.call(e);!(o=(i=n.next()).done)&&(a.push(i.value),!t||a.length!==t);o=!0);}catch(u){s=!0,r=u}finally{try{o||null==n.return||n.return()}finally{if(s)throw r}}return a}}(e,t)||(0,i.Z)(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},2407:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var i=n(1120),r=n(9611);function a(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function o(e,t,n){return o=a()?Reflect.construct.bind():function(e,t,n){var i=[null];i.push.apply(i,t);var a=new(Function.bind.apply(e,i));return n&&(0,r.Z)(a,n.prototype),a},o.apply(null,arguments)}function s(e){var t="function"==typeof Map?new Map:void 0;return s=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,a)}function a(){return o(e,arguments,(0,i.Z)(this).constructor)}return a.prototype=Object.create(e.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),(0,r.Z)(a,e)},s(e)}}}]);
//# sourceMappingURL=commons-036957bd5ce801731e4e.js.map